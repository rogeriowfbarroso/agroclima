var Uie=Object.defineProperty;var g6=e=>{throw TypeError(e)};var $ie=(e,t,r)=>t in e?Uie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var _6=(e,t,r)=>$ie(e,typeof t!="symbol"?t+"":t,r),gO=(e,t,r)=>t.has(e)||g6("Cannot "+r);var fr=(e,t,r)=>(gO(e,t,"read from private field"),r?r.call(e):t.get(e)),Li=(e,t,r)=>t.has(e)?g6("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Gn=(e,t,r,n)=>(gO(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ys=(e,t,r)=>(gO(e,t,"access private method"),r);var bS=(e,t,r,n)=>({set _(o){Gn(e,t,o,r)},get _(){return fr(e,t,n)}});function Vie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const u=Object.getOwnPropertyDescriptor(n,o);u&&Object.defineProperty(e,o,u.get?u:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function r(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(o){if(o.ep)return;o.ep=!0;const u=r(o);fetch(o.href,u)}})();var K1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var X9={exports:{}},FC={},Z9={exports:{}},_i={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yb=Symbol.for("react.element"),Wie=Symbol.for("react.portal"),Gie=Symbol.for("react.fragment"),Hie=Symbol.for("react.strict_mode"),qie=Symbol.for("react.profiler"),Xie=Symbol.for("react.provider"),Zie=Symbol.for("react.context"),Yie=Symbol.for("react.forward_ref"),Kie=Symbol.for("react.suspense"),Jie=Symbol.for("react.memo"),Qie=Symbol.for("react.lazy"),y6=Symbol.iterator;function eae(e){return e===null||typeof e!="object"?null:(e=y6&&e[y6]||e["@@iterator"],typeof e=="function"?e:null)}var Y9={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K9=Object.assign,J9={};function hv(e,t,r){this.props=e,this.context=t,this.refs=J9,this.updater=r||Y9}hv.prototype.isReactComponent={};hv.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hv.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Q9(){}Q9.prototype=hv.prototype;function ZD(e,t,r){this.props=e,this.context=t,this.refs=J9,this.updater=r||Y9}var YD=ZD.prototype=new Q9;YD.constructor=ZD;K9(YD,hv.prototype);YD.isPureReactComponent=!0;var v6=Array.isArray,eW=Object.prototype.hasOwnProperty,KD={current:null},tW={key:!0,ref:!0,__self:!0,__source:!0};function rW(e,t,r){var n,o={},u=null,d=null;if(t!=null)for(n in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(u=""+t.key),t)eW.call(t,n)&&!tW.hasOwnProperty(n)&&(o[n]=t[n]);var i=arguments.length-2;if(i===1)o.children=r;else if(1<i){for(var v=Array(i),w=0;w<i;w++)v[w]=arguments[w+2];o.children=v}if(e&&e.defaultProps)for(n in i=e.defaultProps,i)o[n]===void 0&&(o[n]=i[n]);return{$$typeof:Yb,type:e,key:u,ref:d,props:o,_owner:KD.current}}function tae(e,t){return{$$typeof:Yb,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function JD(e){return typeof e=="object"&&e!==null&&e.$$typeof===Yb}function rae(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var x6=/\/+/g;function _O(e,t){return typeof e=="object"&&e!==null&&e.key!=null?rae(""+e.key):t.toString(36)}function xE(e,t,r,n,o){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(u){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case Yb:case Wie:d=!0}}if(d)return d=e,o=o(d),e=n===""?"."+_O(d,0):n,v6(o)?(r="",e!=null&&(r=e.replace(x6,"$&/")+"/"),xE(o,t,r,"",function(w){return w})):o!=null&&(JD(o)&&(o=tae(o,r+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(x6,"$&/")+"/")+e)),t.push(o)),1;if(d=0,n=n===""?".":n+":",v6(e))for(var i=0;i<e.length;i++){u=e[i];var v=n+_O(u,i);d+=xE(u,t,r,v,o)}else if(v=eae(e),typeof v=="function")for(e=v.call(e),i=0;!(u=e.next()).done;)u=u.value,v=n+_O(u,i++),d+=xE(u,t,r,v,o);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function TS(e,t,r){if(e==null)return e;var n=[],o=0;return xE(e,n,"","",function(u){return t.call(r,u,o++)}),n}function nae(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var rl={current:null},wE={transition:null},iae={ReactCurrentDispatcher:rl,ReactCurrentBatchConfig:wE,ReactCurrentOwner:KD};function nW(){throw Error("act(...) is not supported in production builds of React.")}_i.Children={map:TS,forEach:function(e,t,r){TS(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return TS(e,function(){t++}),t},toArray:function(e){return TS(e,function(t){return t})||[]},only:function(e){if(!JD(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_i.Component=hv;_i.Fragment=Gie;_i.Profiler=qie;_i.PureComponent=ZD;_i.StrictMode=Hie;_i.Suspense=Kie;_i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iae;_i.act=nW;_i.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=K9({},e.props),o=e.key,u=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,d=KD.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(v in t)eW.call(t,v)&&!tW.hasOwnProperty(v)&&(n[v]=t[v]===void 0&&i!==void 0?i[v]:t[v])}var v=arguments.length-2;if(v===1)n.children=r;else if(1<v){i=Array(v);for(var w=0;w<v;w++)i[w]=arguments[w+2];n.children=i}return{$$typeof:Yb,type:e.type,key:o,ref:u,props:n,_owner:d}};_i.createContext=function(e){return e={$$typeof:Zie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Xie,_context:e},e.Consumer=e};_i.createElement=rW;_i.createFactory=function(e){var t=rW.bind(null,e);return t.type=e,t};_i.createRef=function(){return{current:null}};_i.forwardRef=function(e){return{$$typeof:Yie,render:e}};_i.isValidElement=JD;_i.lazy=function(e){return{$$typeof:Qie,_payload:{_status:-1,_result:e},_init:nae}};_i.memo=function(e,t){return{$$typeof:Jie,type:e,compare:t===void 0?null:t}};_i.startTransition=function(e){var t=wE.transition;wE.transition={};try{e()}finally{wE.transition=t}};_i.unstable_act=nW;_i.useCallback=function(e,t){return rl.current.useCallback(e,t)};_i.useContext=function(e){return rl.current.useContext(e)};_i.useDebugValue=function(){};_i.useDeferredValue=function(e){return rl.current.useDeferredValue(e)};_i.useEffect=function(e,t){return rl.current.useEffect(e,t)};_i.useId=function(){return rl.current.useId()};_i.useImperativeHandle=function(e,t,r){return rl.current.useImperativeHandle(e,t,r)};_i.useInsertionEffect=function(e,t){return rl.current.useInsertionEffect(e,t)};_i.useLayoutEffect=function(e,t){return rl.current.useLayoutEffect(e,t)};_i.useMemo=function(e,t){return rl.current.useMemo(e,t)};_i.useReducer=function(e,t,r){return rl.current.useReducer(e,t,r)};_i.useRef=function(e){return rl.current.useRef(e)};_i.useState=function(e){return rl.current.useState(e)};_i.useSyncExternalStore=function(e,t,r){return rl.current.useSyncExternalStore(e,t,r)};_i.useTransition=function(){return rl.current.useTransition()};_i.version="18.3.1";Z9.exports=_i;var ue=Z9.exports;const it=Qi(ue),QD=Vie({__proto__:null,default:it},[ue]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aae=ue,oae=Symbol.for("react.element"),sae=Symbol.for("react.fragment"),lae=Object.prototype.hasOwnProperty,cae=aae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uae={key:!0,ref:!0,__self:!0,__source:!0};function iW(e,t,r){var n,o={},u=null,d=null;r!==void 0&&(u=""+r),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(d=t.ref);for(n in t)lae.call(t,n)&&!uae.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:oae,type:e,key:u,ref:d,props:o,_owner:cae.current}}FC.Fragment=sae;FC.jsx=iW;FC.jsxs=iW;X9.exports=FC;var be=X9.exports,aW={exports:{}},Ql={},oW={exports:{}},sW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ft,Ue){var It=ft.length;ft.push(Ue);e:for(;0<It;){var Rt=It-1>>>1,_e=ft[Rt];if(0<o(_e,Ue))ft[Rt]=Ue,ft[It]=_e,It=Rt;else break e}}function r(ft){return ft.length===0?null:ft[0]}function n(ft){if(ft.length===0)return null;var Ue=ft[0],It=ft.pop();if(It!==Ue){ft[0]=It;e:for(var Rt=0,_e=ft.length,Ge=_e>>>1;Rt<Ge;){var qe=2*(Rt+1)-1,Xe=ft[qe],yt=qe+1,Dt=ft[yt];if(0>o(Xe,It))yt<_e&&0>o(Dt,Xe)?(ft[Rt]=Dt,ft[yt]=It,Rt=yt):(ft[Rt]=Xe,ft[qe]=It,Rt=qe);else if(yt<_e&&0>o(Dt,It))ft[Rt]=Dt,ft[yt]=It,Rt=yt;else break e}}return Ue}function o(ft,Ue){var It=ft.sortIndex-Ue.sortIndex;return It!==0?It:ft.id-Ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var d=Date,i=d.now();e.unstable_now=function(){return d.now()-i}}var v=[],w=[],S=1,C=null,k=3,O=!1,L=!1,R=!1,N=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(ft){for(var Ue=r(w);Ue!==null;){if(Ue.callback===null)n(w);else if(Ue.startTime<=ft)n(w),Ue.sortIndex=Ue.expirationTime,t(v,Ue);else break;Ue=r(w)}}function J(ft){if(R=!1,U(ft),!L)if(r(v)!==null)L=!0,at(Z);else{var Ue=r(w);Ue!==null&&pt(J,Ue.startTime-ft)}}function Z(ft,Ue){L=!1,R&&(R=!1,V(ge),ge=-1),O=!0;var It=k;try{for(U(Ue),C=r(v);C!==null&&(!(C.expirationTime>Ue)||ft&&!Ie());){var Rt=C.callback;if(typeof Rt=="function"){C.callback=null,k=C.priorityLevel;var _e=Rt(C.expirationTime<=Ue);Ue=e.unstable_now(),typeof _e=="function"?C.callback=_e:C===r(v)&&n(v),U(Ue)}else n(v);C=r(v)}if(C!==null)var Ge=!0;else{var qe=r(w);qe!==null&&pt(J,qe.startTime-Ue),Ge=!1}return Ge}finally{C=null,k=It,O=!1}}var K=!1,re=null,ge=-1,ve=5,$e=-1;function Ie(){return!(e.unstable_now()-$e<ve)}function ke(){if(re!==null){var ft=e.unstable_now();$e=ft;var Ue=!0;try{Ue=re(!0,ft)}finally{Ue?tt():(K=!1,re=null)}}else K=!1}var tt;if(typeof G=="function")tt=function(){G(ke)};else if(typeof MessageChannel<"u"){var Je=new MessageChannel,et=Je.port2;Je.port1.onmessage=ke,tt=function(){et.postMessage(null)}}else tt=function(){N(ke,0)};function at(ft){re=ft,K||(K=!0,tt())}function pt(ft,Ue){ge=N(function(){ft(e.unstable_now())},Ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ft){ft.callback=null},e.unstable_continueExecution=function(){L||O||(L=!0,at(Z))},e.unstable_forceFrameRate=function(ft){0>ft||125<ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ve=0<ft?Math.floor(1e3/ft):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return r(v)},e.unstable_next=function(ft){switch(k){case 1:case 2:case 3:var Ue=3;break;default:Ue=k}var It=k;k=Ue;try{return ft()}finally{k=It}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ft,Ue){switch(ft){case 1:case 2:case 3:case 4:case 5:break;default:ft=3}var It=k;k=ft;try{return Ue()}finally{k=It}},e.unstable_scheduleCallback=function(ft,Ue,It){var Rt=e.unstable_now();switch(typeof It=="object"&&It!==null?(It=It.delay,It=typeof It=="number"&&0<It?Rt+It:Rt):It=Rt,ft){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=It+_e,ft={id:S++,callback:Ue,priorityLevel:ft,startTime:It,expirationTime:_e,sortIndex:-1},It>Rt?(ft.sortIndex=It,t(w,ft),r(v)===null&&ft===r(w)&&(R?(V(ge),ge=-1):R=!0,pt(J,It-Rt))):(ft.sortIndex=_e,t(v,ft),L||O||(L=!0,at(Z))),ft},e.unstable_shouldYield=Ie,e.unstable_wrapCallback=function(ft){var Ue=k;return function(){var It=k;k=Ue;try{return ft.apply(this,arguments)}finally{k=It}}}})(sW);oW.exports=sW;var hae=oW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fae=ue,Zl=hae;function Cr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lW=new Set,Ow={};function R0(e,t){Py(e,t),Py(e+"Capture",t)}function Py(e,t){for(Ow[e]=t,e=0;e<t.length;e++)lW.add(t[e])}var If=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),JM=Object.prototype.hasOwnProperty,dae=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w6={},b6={};function pae(e){return JM.call(b6,e)?!0:JM.call(w6,e)?!1:dae.test(e)?b6[e]=!0:(w6[e]=!0,!1)}function mae(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gae(e,t,r,n){if(t===null||typeof t>"u"||mae(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function nl(e,t,r,n,o,u,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=d}var hs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){hs[e]=new nl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];hs[t]=new nl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){hs[e]=new nl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){hs[e]=new nl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){hs[e]=new nl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){hs[e]=new nl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){hs[e]=new nl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){hs[e]=new nl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){hs[e]=new nl(e,5,!1,e.toLowerCase(),null,!1,!1)});var eF=/[\-:]([a-z])/g;function tF(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eF,tF);hs[t]=new nl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eF,tF);hs[t]=new nl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eF,tF);hs[t]=new nl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){hs[e]=new nl(e,1,!1,e.toLowerCase(),null,!1,!1)});hs.xlinkHref=new nl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){hs[e]=new nl(e,1,!1,e.toLowerCase(),null,!0,!0)});function rF(e,t,r,n){var o=hs.hasOwnProperty(t)?hs[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(gae(t,r,o,n)&&(r=null),n||o===null?pae(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var zf=fae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,SS=Symbol.for("react.element"),z_=Symbol.for("react.portal"),j_=Symbol.for("react.fragment"),nF=Symbol.for("react.strict_mode"),QM=Symbol.for("react.profiler"),cW=Symbol.for("react.provider"),uW=Symbol.for("react.context"),iF=Symbol.for("react.forward_ref"),eR=Symbol.for("react.suspense"),tR=Symbol.for("react.suspense_list"),aF=Symbol.for("react.memo"),$d=Symbol.for("react.lazy"),hW=Symbol.for("react.offscreen"),T6=Symbol.iterator;function C1(e){return e===null||typeof e!="object"?null:(e=T6&&e[T6]||e["@@iterator"],typeof e=="function"?e:null)}var Ga=Object.assign,yO;function J1(e){if(yO===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);yO=t&&t[1]||""}return`
`+yO+e}var vO=!1;function xO(e,t){if(!e||vO)return"";vO=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var n=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){n=w}e.call(t.prototype)}else{try{throw Error()}catch(w){n=w}e()}}catch(w){if(w&&n&&typeof w.stack=="string"){for(var o=w.stack.split(`
`),u=n.stack.split(`
`),d=o.length-1,i=u.length-1;1<=d&&0<=i&&o[d]!==u[i];)i--;for(;1<=d&&0<=i;d--,i--)if(o[d]!==u[i]){if(d!==1||i!==1)do if(d--,i--,0>i||o[d]!==u[i]){var v=`
`+o[d].replace(" at new "," at ");return e.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",e.displayName)),v}while(1<=d&&0<=i);break}}}finally{vO=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?J1(e):""}function _ae(e){switch(e.tag){case 5:return J1(e.type);case 16:return J1("Lazy");case 13:return J1("Suspense");case 19:return J1("SuspenseList");case 0:case 2:case 15:return e=xO(e.type,!1),e;case 11:return e=xO(e.type.render,!1),e;case 1:return e=xO(e.type,!0),e;default:return""}}function rR(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case j_:return"Fragment";case z_:return"Portal";case QM:return"Profiler";case nF:return"StrictMode";case eR:return"Suspense";case tR:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case uW:return(e.displayName||"Context")+".Consumer";case cW:return(e._context.displayName||"Context")+".Provider";case iF:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case aF:return t=e.displayName||null,t!==null?t:rR(e.type)||"Memo";case $d:t=e._payload,e=e._init;try{return rR(e(t))}catch{}}return null}function yae(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rR(t);case 8:return t===nF?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function wp(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fW(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function vae(e){var t=fW(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,u=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(d){n=""+d,u.call(this,d)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(d){n=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ES(e){e._valueTracker||(e._valueTracker=vae(e))}function dW(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=fW(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function jE(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function nR(e,t){var r=t.checked;return Ga({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function S6(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=wp(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function pW(e,t){t=t.checked,t!=null&&rF(e,"checked",t,!1)}function iR(e,t){pW(e,t);var r=wp(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?aR(e,t.type,r):t.hasOwnProperty("defaultValue")&&aR(e,t.type,wp(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function E6(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function aR(e,t,r){(t!=="number"||jE(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Q1=Array.isArray;function ry(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+wp(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function oR(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Cr(91));return Ga({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function A6(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Cr(92));if(Q1(r)){if(1<r.length)throw Error(Cr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:wp(r)}}function mW(e,t){var r=wp(t.value),n=wp(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function C6(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gW(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sR(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gW(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var AS,_W=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(AS=AS||document.createElement("div"),AS.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=AS.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mw(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var sw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xae=["Webkit","ms","Moz","O"];Object.keys(sw).forEach(function(e){xae.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),sw[t]=sw[e]})});function yW(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||sw.hasOwnProperty(e)&&sw[e]?(""+t).trim():t+"px"}function vW(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=yW(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var wae=Ga({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lR(e,t){if(t){if(wae[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Cr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Cr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Cr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Cr(62))}}function cR(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uR=null;function oF(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hR=null,ny=null,iy=null;function P6(e){if(e=Qb(e)){if(typeof hR!="function")throw Error(Cr(280));var t=e.stateNode;t&&(t=jC(t),hR(e.stateNode,e.type,t))}}function xW(e){ny?iy?iy.push(e):iy=[e]:ny=e}function wW(){if(ny){var e=ny,t=iy;if(iy=ny=null,P6(e),t)for(e=0;e<t.length;e++)P6(t[e])}}function bW(e,t){return e(t)}function TW(){}var wO=!1;function SW(e,t,r){if(wO)return e(t,r);wO=!0;try{return bW(e,t,r)}finally{wO=!1,(ny!==null||iy!==null)&&(TW(),wW())}}function Rw(e,t){var r=e.stateNode;if(r===null)return null;var n=jC(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Cr(231,t,typeof r));return r}var fR=!1;if(If)try{var P1={};Object.defineProperty(P1,"passive",{get:function(){fR=!0}}),window.addEventListener("test",P1,P1),window.removeEventListener("test",P1,P1)}catch{fR=!1}function bae(e,t,r,n,o,u,d,i,v){var w=Array.prototype.slice.call(arguments,3);try{t.apply(r,w)}catch(S){this.onError(S)}}var lw=!1,UE=null,$E=!1,dR=null,Tae={onError:function(e){lw=!0,UE=e}};function Sae(e,t,r,n,o,u,d,i,v){lw=!1,UE=null,bae.apply(Tae,arguments)}function Eae(e,t,r,n,o,u,d,i,v){if(Sae.apply(this,arguments),lw){if(lw){var w=UE;lw=!1,UE=null}else throw Error(Cr(198));$E||($E=!0,dR=w)}}function D0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function EW(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function I6(e){if(D0(e)!==e)throw Error(Cr(188))}function Aae(e){var t=e.alternate;if(!t){if(t=D0(e),t===null)throw Error(Cr(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var u=o.alternate;if(u===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===r)return I6(o),e;if(u===n)return I6(o),t;u=u.sibling}throw Error(Cr(188))}if(r.return!==n.return)r=o,n=u;else{for(var d=!1,i=o.child;i;){if(i===r){d=!0,r=o,n=u;break}if(i===n){d=!0,n=o,r=u;break}i=i.sibling}if(!d){for(i=u.child;i;){if(i===r){d=!0,r=u,n=o;break}if(i===n){d=!0,n=u,r=o;break}i=i.sibling}if(!d)throw Error(Cr(189))}}if(r.alternate!==n)throw Error(Cr(190))}if(r.tag!==3)throw Error(Cr(188));return r.stateNode.current===r?e:t}function AW(e){return e=Aae(e),e!==null?CW(e):null}function CW(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=CW(e);if(t!==null)return t;e=e.sibling}return null}var PW=Zl.unstable_scheduleCallback,k6=Zl.unstable_cancelCallback,Cae=Zl.unstable_shouldYield,Pae=Zl.unstable_requestPaint,so=Zl.unstable_now,Iae=Zl.unstable_getCurrentPriorityLevel,sF=Zl.unstable_ImmediatePriority,IW=Zl.unstable_UserBlockingPriority,VE=Zl.unstable_NormalPriority,kae=Zl.unstable_LowPriority,kW=Zl.unstable_IdlePriority,LC=null,yh=null;function Oae(e){if(yh&&typeof yh.onCommitFiberRoot=="function")try{yh.onCommitFiberRoot(LC,e,void 0,(e.current.flags&128)===128)}catch{}}var yu=Math.clz32?Math.clz32:Dae,Mae=Math.log,Rae=Math.LN2;function Dae(e){return e>>>=0,e===0?32:31-(Mae(e)/Rae|0)|0}var CS=64,PS=4194304;function ew(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function WE(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,u=e.pingedLanes,d=r&268435455;if(d!==0){var i=d&~o;i!==0?n=ew(i):(u&=d,u!==0&&(n=ew(u)))}else d=r&~o,d!==0?n=ew(d):u!==0&&(n=ew(u));if(n===0)return 0;if(t!==0&&t!==n&&!(t&o)&&(o=n&-n,u=t&-t,o>=u||o===16&&(u&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-yu(t),o=1<<r,n|=e[r],t&=~o;return n}function Fae(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lae(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes;0<u;){var d=31-yu(u),i=1<<d,v=o[d];v===-1?(!(i&r)||i&n)&&(o[d]=Fae(i,t)):v<=t&&(e.expiredLanes|=i),u&=~i}}function pR(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function OW(){var e=CS;return CS<<=1,!(CS&4194240)&&(CS=64),e}function bO(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Kb(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-yu(t),e[t]=r}function Nae(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-yu(r),u=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~u}}function lF(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-yu(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var Ji=0;function MW(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var RW,cF,DW,FW,LW,mR=!1,IS=[],lp=null,cp=null,up=null,Dw=new Map,Fw=new Map,Gd=[],Bae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function O6(e,t){switch(e){case"focusin":case"focusout":lp=null;break;case"dragenter":case"dragleave":cp=null;break;case"mouseover":case"mouseout":up=null;break;case"pointerover":case"pointerout":Dw.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fw.delete(t.pointerId)}}function I1(e,t,r,n,o,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:u,targetContainers:[o]},t!==null&&(t=Qb(t),t!==null&&cF(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function zae(e,t,r,n,o){switch(t){case"focusin":return lp=I1(lp,e,t,r,n,o),!0;case"dragenter":return cp=I1(cp,e,t,r,n,o),!0;case"mouseover":return up=I1(up,e,t,r,n,o),!0;case"pointerover":var u=o.pointerId;return Dw.set(u,I1(Dw.get(u)||null,e,t,r,n,o)),!0;case"gotpointercapture":return u=o.pointerId,Fw.set(u,I1(Fw.get(u)||null,e,t,r,n,o)),!0}return!1}function NW(e){var t=$m(e.target);if(t!==null){var r=D0(t);if(r!==null){if(t=r.tag,t===13){if(t=EW(r),t!==null){e.blockedOn=t,LW(e.priority,function(){DW(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bE(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=gR(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);uR=n,r.target.dispatchEvent(n),uR=null}else return t=Qb(r),t!==null&&cF(t),e.blockedOn=r,!1;t.shift()}return!0}function M6(e,t,r){bE(e)&&r.delete(t)}function jae(){mR=!1,lp!==null&&bE(lp)&&(lp=null),cp!==null&&bE(cp)&&(cp=null),up!==null&&bE(up)&&(up=null),Dw.forEach(M6),Fw.forEach(M6)}function k1(e,t){e.blockedOn===t&&(e.blockedOn=null,mR||(mR=!0,Zl.unstable_scheduleCallback(Zl.unstable_NormalPriority,jae)))}function Lw(e){function t(o){return k1(o,e)}if(0<IS.length){k1(IS[0],e);for(var r=1;r<IS.length;r++){var n=IS[r];n.blockedOn===e&&(n.blockedOn=null)}}for(lp!==null&&k1(lp,e),cp!==null&&k1(cp,e),up!==null&&k1(up,e),Dw.forEach(t),Fw.forEach(t),r=0;r<Gd.length;r++)n=Gd[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Gd.length&&(r=Gd[0],r.blockedOn===null);)NW(r),r.blockedOn===null&&Gd.shift()}var ay=zf.ReactCurrentBatchConfig,GE=!0;function Uae(e,t,r,n){var o=Ji,u=ay.transition;ay.transition=null;try{Ji=1,uF(e,t,r,n)}finally{Ji=o,ay.transition=u}}function $ae(e,t,r,n){var o=Ji,u=ay.transition;ay.transition=null;try{Ji=4,uF(e,t,r,n)}finally{Ji=o,ay.transition=u}}function uF(e,t,r,n){if(GE){var o=gR(e,t,r,n);if(o===null)MO(e,t,n,HE,r),O6(e,n);else if(zae(o,e,t,r,n))n.stopPropagation();else if(O6(e,n),t&4&&-1<Bae.indexOf(e)){for(;o!==null;){var u=Qb(o);if(u!==null&&RW(u),u=gR(e,t,r,n),u===null&&MO(e,t,n,HE,r),u===o)break;o=u}o!==null&&n.stopPropagation()}else MO(e,t,n,null,r)}}var HE=null;function gR(e,t,r,n){if(HE=null,e=oF(n),e=$m(e),e!==null)if(t=D0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=EW(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return HE=e,null}function BW(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Iae()){case sF:return 1;case IW:return 4;case VE:case kae:return 16;case kW:return 536870912;default:return 16}default:return 16}}var Qd=null,hF=null,TE=null;function zW(){if(TE)return TE;var e,t=hF,r=t.length,n,o="value"in Qd?Qd.value:Qd.textContent,u=o.length;for(e=0;e<r&&t[e]===o[e];e++);var d=r-e;for(n=1;n<=d&&t[r-n]===o[u-n];n++);return TE=o.slice(e,1<n?1-n:void 0)}function SE(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function kS(){return!0}function R6(){return!1}function ec(e){function t(r,n,o,u,d){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=u,this.target=d,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],this[i]=r?r(u):u[i]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?kS:R6,this.isPropagationStopped=R6,this}return Ga(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=kS)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=kS)},persist:function(){},isPersistent:kS}),t}var fv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fF=ec(fv),Jb=Ga({},fv,{view:0,detail:0}),Vae=ec(Jb),TO,SO,O1,NC=Ga({},Jb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dF,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==O1&&(O1&&e.type==="mousemove"?(TO=e.screenX-O1.screenX,SO=e.screenY-O1.screenY):SO=TO=0,O1=e),TO)},movementY:function(e){return"movementY"in e?e.movementY:SO}}),D6=ec(NC),Wae=Ga({},NC,{dataTransfer:0}),Gae=ec(Wae),Hae=Ga({},Jb,{relatedTarget:0}),EO=ec(Hae),qae=Ga({},fv,{animationName:0,elapsedTime:0,pseudoElement:0}),Xae=ec(qae),Zae=Ga({},fv,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Yae=ec(Zae),Kae=Ga({},fv,{data:0}),F6=ec(Kae),Jae={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eoe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function toe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=eoe[e])?!!t[e]:!1}function dF(){return toe}var roe=Ga({},Jb,{key:function(e){if(e.key){var t=Jae[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=SE(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qae[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dF,charCode:function(e){return e.type==="keypress"?SE(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?SE(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),noe=ec(roe),ioe=Ga({},NC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L6=ec(ioe),aoe=Ga({},Jb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dF}),ooe=ec(aoe),soe=Ga({},fv,{propertyName:0,elapsedTime:0,pseudoElement:0}),loe=ec(soe),coe=Ga({},NC,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),uoe=ec(coe),hoe=[9,13,27,32],pF=If&&"CompositionEvent"in window,cw=null;If&&"documentMode"in document&&(cw=document.documentMode);var foe=If&&"TextEvent"in window&&!cw,jW=If&&(!pF||cw&&8<cw&&11>=cw),N6=" ",B6=!1;function UW(e,t){switch(e){case"keyup":return hoe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $W(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var U_=!1;function doe(e,t){switch(e){case"compositionend":return $W(t);case"keypress":return t.which!==32?null:(B6=!0,N6);case"textInput":return e=t.data,e===N6&&B6?null:e;default:return null}}function poe(e,t){if(U_)return e==="compositionend"||!pF&&UW(e,t)?(e=zW(),TE=hF=Qd=null,U_=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jW&&t.locale!=="ko"?null:t.data;default:return null}}var moe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z6(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!moe[e.type]:t==="textarea"}function VW(e,t,r,n){xW(n),t=qE(t,"onChange"),0<t.length&&(r=new fF("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var uw=null,Nw=null;function goe(e){eG(e,0)}function BC(e){var t=W_(e);if(dW(t))return e}function _oe(e,t){if(e==="change")return t}var WW=!1;if(If){var AO;if(If){var CO="oninput"in document;if(!CO){var j6=document.createElement("div");j6.setAttribute("oninput","return;"),CO=typeof j6.oninput=="function"}AO=CO}else AO=!1;WW=AO&&(!document.documentMode||9<document.documentMode)}function U6(){uw&&(uw.detachEvent("onpropertychange",GW),Nw=uw=null)}function GW(e){if(e.propertyName==="value"&&BC(Nw)){var t=[];VW(t,Nw,e,oF(e)),SW(goe,t)}}function yoe(e,t,r){e==="focusin"?(U6(),uw=t,Nw=r,uw.attachEvent("onpropertychange",GW)):e==="focusout"&&U6()}function voe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return BC(Nw)}function xoe(e,t){if(e==="click")return BC(t)}function woe(e,t){if(e==="input"||e==="change")return BC(t)}function boe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tu=typeof Object.is=="function"?Object.is:boe;function Bw(e,t){if(Tu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!JM.call(t,o)||!Tu(e[o],t[o]))return!1}return!0}function $6(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function V6(e,t){var r=$6(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$6(r)}}function HW(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?HW(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qW(){for(var e=window,t=jE();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=jE(e.document)}return t}function mF(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Toe(e){var t=qW(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&HW(r.ownerDocument.documentElement,r)){if(n!==null&&mF(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,u=Math.min(n.start,o);n=n.end===void 0?u:Math.min(n.end,o),!e.extend&&u>n&&(o=n,n=u,u=o),o=V6(r,u);var d=V6(r,n);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),u>n?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Soe=If&&"documentMode"in document&&11>=document.documentMode,$_=null,_R=null,hw=null,yR=!1;function W6(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yR||$_==null||$_!==jE(n)||(n=$_,"selectionStart"in n&&mF(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),hw&&Bw(hw,n)||(hw=n,n=qE(_R,"onSelect"),0<n.length&&(t=new fF("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$_)))}function OS(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var V_={animationend:OS("Animation","AnimationEnd"),animationiteration:OS("Animation","AnimationIteration"),animationstart:OS("Animation","AnimationStart"),transitionend:OS("Transition","TransitionEnd")},PO={},XW={};If&&(XW=document.createElement("div").style,"AnimationEvent"in window||(delete V_.animationend.animation,delete V_.animationiteration.animation,delete V_.animationstart.animation),"TransitionEvent"in window||delete V_.transitionend.transition);function zC(e){if(PO[e])return PO[e];if(!V_[e])return e;var t=V_[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in XW)return PO[e]=t[r];return e}var ZW=zC("animationend"),YW=zC("animationiteration"),KW=zC("animationstart"),JW=zC("transitionend"),QW=new Map,G6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kp(e,t){QW.set(e,t),R0(t,[e])}for(var IO=0;IO<G6.length;IO++){var kO=G6[IO],Eoe=kO.toLowerCase(),Aoe=kO[0].toUpperCase()+kO.slice(1);kp(Eoe,"on"+Aoe)}kp(ZW,"onAnimationEnd");kp(YW,"onAnimationIteration");kp(KW,"onAnimationStart");kp("dblclick","onDoubleClick");kp("focusin","onFocus");kp("focusout","onBlur");kp(JW,"onTransitionEnd");Py("onMouseEnter",["mouseout","mouseover"]);Py("onMouseLeave",["mouseout","mouseover"]);Py("onPointerEnter",["pointerout","pointerover"]);Py("onPointerLeave",["pointerout","pointerover"]);R0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));R0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));R0("onBeforeInput",["compositionend","keypress","textInput","paste"]);R0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));R0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));R0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Coe=new Set("cancel close invalid load scroll toggle".split(" ").concat(tw));function H6(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Eae(n,t,void 0,e),e.currentTarget=null}function eG(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var u=void 0;if(t)for(var d=n.length-1;0<=d;d--){var i=n[d],v=i.instance,w=i.currentTarget;if(i=i.listener,v!==u&&o.isPropagationStopped())break e;H6(o,i,w),u=v}else for(d=0;d<n.length;d++){if(i=n[d],v=i.instance,w=i.currentTarget,i=i.listener,v!==u&&o.isPropagationStopped())break e;H6(o,i,w),u=v}}}if($E)throw e=dR,$E=!1,dR=null,e}function Aa(e,t){var r=t[TR];r===void 0&&(r=t[TR]=new Set);var n=e+"__bubble";r.has(n)||(tG(t,e,2,!1),r.add(n))}function OO(e,t,r){var n=0;t&&(n|=4),tG(r,e,n,t)}var MS="_reactListening"+Math.random().toString(36).slice(2);function zw(e){if(!e[MS]){e[MS]=!0,lW.forEach(function(r){r!=="selectionchange"&&(Coe.has(r)||OO(r,!1,e),OO(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[MS]||(t[MS]=!0,OO("selectionchange",!1,t))}}function tG(e,t,r,n){switch(BW(t)){case 1:var o=Uae;break;case 4:o=$ae;break;default:o=uF}r=o.bind(null,t,r,e),o=void 0,!fR||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function MO(e,t,r,n,o){var u=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var d=n.tag;if(d===3||d===4){var i=n.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(d===4)for(d=n.return;d!==null;){var v=d.tag;if((v===3||v===4)&&(v=d.stateNode.containerInfo,v===o||v.nodeType===8&&v.parentNode===o))return;d=d.return}for(;i!==null;){if(d=$m(i),d===null)return;if(v=d.tag,v===5||v===6){n=u=d;continue e}i=i.parentNode}}n=n.return}SW(function(){var w=u,S=oF(r),C=[];e:{var k=QW.get(e);if(k!==void 0){var O=fF,L=e;switch(e){case"keypress":if(SE(r)===0)break e;case"keydown":case"keyup":O=noe;break;case"focusin":L="focus",O=EO;break;case"focusout":L="blur",O=EO;break;case"beforeblur":case"afterblur":O=EO;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":O=D6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":O=Gae;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":O=ooe;break;case ZW:case YW:case KW:O=Xae;break;case JW:O=loe;break;case"scroll":O=Vae;break;case"wheel":O=uoe;break;case"copy":case"cut":case"paste":O=Yae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":O=L6}var R=(t&4)!==0,N=!R&&e==="scroll",V=R?k!==null?k+"Capture":null:k;R=[];for(var G=w,U;G!==null;){U=G;var J=U.stateNode;if(U.tag===5&&J!==null&&(U=J,V!==null&&(J=Rw(G,V),J!=null&&R.push(jw(G,J,U)))),N)break;G=G.return}0<R.length&&(k=new O(k,L,null,r,S),C.push({event:k,listeners:R}))}}if(!(t&7)){e:{if(k=e==="mouseover"||e==="pointerover",O=e==="mouseout"||e==="pointerout",k&&r!==uR&&(L=r.relatedTarget||r.fromElement)&&($m(L)||L[kf]))break e;if((O||k)&&(k=S.window===S?S:(k=S.ownerDocument)?k.defaultView||k.parentWindow:window,O?(L=r.relatedTarget||r.toElement,O=w,L=L?$m(L):null,L!==null&&(N=D0(L),L!==N||L.tag!==5&&L.tag!==6)&&(L=null)):(O=null,L=w),O!==L)){if(R=D6,J="onMouseLeave",V="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(R=L6,J="onPointerLeave",V="onPointerEnter",G="pointer"),N=O==null?k:W_(O),U=L==null?k:W_(L),k=new R(J,G+"leave",O,r,S),k.target=N,k.relatedTarget=U,J=null,$m(S)===w&&(R=new R(V,G+"enter",L,r,S),R.target=U,R.relatedTarget=N,J=R),N=J,O&&L)t:{for(R=O,V=L,G=0,U=R;U;U=b_(U))G++;for(U=0,J=V;J;J=b_(J))U++;for(;0<G-U;)R=b_(R),G--;for(;0<U-G;)V=b_(V),U--;for(;G--;){if(R===V||V!==null&&R===V.alternate)break t;R=b_(R),V=b_(V)}R=null}else R=null;O!==null&&q6(C,k,O,R,!1),L!==null&&N!==null&&q6(C,N,L,R,!0)}}e:{if(k=w?W_(w):window,O=k.nodeName&&k.nodeName.toLowerCase(),O==="select"||O==="input"&&k.type==="file")var Z=_oe;else if(z6(k))if(WW)Z=woe;else{Z=voe;var K=yoe}else(O=k.nodeName)&&O.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(Z=xoe);if(Z&&(Z=Z(e,w))){VW(C,Z,r,S);break e}K&&K(e,k,w),e==="focusout"&&(K=k._wrapperState)&&K.controlled&&k.type==="number"&&aR(k,"number",k.value)}switch(K=w?W_(w):window,e){case"focusin":(z6(K)||K.contentEditable==="true")&&($_=K,_R=w,hw=null);break;case"focusout":hw=_R=$_=null;break;case"mousedown":yR=!0;break;case"contextmenu":case"mouseup":case"dragend":yR=!1,W6(C,r,S);break;case"selectionchange":if(Soe)break;case"keydown":case"keyup":W6(C,r,S)}var re;if(pF)e:{switch(e){case"compositionstart":var ge="onCompositionStart";break e;case"compositionend":ge="onCompositionEnd";break e;case"compositionupdate":ge="onCompositionUpdate";break e}ge=void 0}else U_?UW(e,r)&&(ge="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ge="onCompositionStart");ge&&(jW&&r.locale!=="ko"&&(U_||ge!=="onCompositionStart"?ge==="onCompositionEnd"&&U_&&(re=zW()):(Qd=S,hF="value"in Qd?Qd.value:Qd.textContent,U_=!0)),K=qE(w,ge),0<K.length&&(ge=new F6(ge,e,null,r,S),C.push({event:ge,listeners:K}),re?ge.data=re:(re=$W(r),re!==null&&(ge.data=re)))),(re=foe?doe(e,r):poe(e,r))&&(w=qE(w,"onBeforeInput"),0<w.length&&(S=new F6("onBeforeInput","beforeinput",null,r,S),C.push({event:S,listeners:w}),S.data=re))}eG(C,t)})}function jw(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qE(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,u=o.stateNode;o.tag===5&&u!==null&&(o=u,u=Rw(e,r),u!=null&&n.unshift(jw(e,u,o)),u=Rw(e,t),u!=null&&n.push(jw(e,u,o))),e=e.return}return n}function b_(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function q6(e,t,r,n,o){for(var u=t._reactName,d=[];r!==null&&r!==n;){var i=r,v=i.alternate,w=i.stateNode;if(v!==null&&v===n)break;i.tag===5&&w!==null&&(i=w,o?(v=Rw(r,u),v!=null&&d.unshift(jw(r,v,i))):o||(v=Rw(r,u),v!=null&&d.push(jw(r,v,i)))),r=r.return}d.length!==0&&e.push({event:t,listeners:d})}var Poe=/\r\n?/g,Ioe=/\u0000|\uFFFD/g;function X6(e){return(typeof e=="string"?e:""+e).replace(Poe,`
`).replace(Ioe,"")}function RS(e,t,r){if(t=X6(t),X6(e)!==t&&r)throw Error(Cr(425))}function XE(){}var vR=null,xR=null;function wR(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bR=typeof setTimeout=="function"?setTimeout:void 0,koe=typeof clearTimeout=="function"?clearTimeout:void 0,Z6=typeof Promise=="function"?Promise:void 0,Ooe=typeof queueMicrotask=="function"?queueMicrotask:typeof Z6<"u"?function(e){return Z6.resolve(null).then(e).catch(Moe)}:bR;function Moe(e){setTimeout(function(){throw e})}function RO(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),Lw(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);Lw(t)}function hp(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Y6(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var dv=Math.random().toString(36).slice(2),uh="__reactFiber$"+dv,Uw="__reactProps$"+dv,kf="__reactContainer$"+dv,TR="__reactEvents$"+dv,Roe="__reactListeners$"+dv,Doe="__reactHandles$"+dv;function $m(e){var t=e[uh];if(t)return t;for(var r=e.parentNode;r;){if(t=r[kf]||r[uh]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Y6(e);e!==null;){if(r=e[uh])return r;e=Y6(e)}return t}e=r,r=e.parentNode}return null}function Qb(e){return e=e[uh]||e[kf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function W_(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Cr(33))}function jC(e){return e[Uw]||null}var SR=[],G_=-1;function Op(e){return{current:e}}function ka(e){0>G_||(e.current=SR[G_],SR[G_]=null,G_--)}function xa(e,t){G_++,SR[G_]=e.current,e.current=t}var bp={},Rs=Op(bp),fl=Op(!1),h0=bp;function Iy(e,t){var r=e.type.contextTypes;if(!r)return bp;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},u;for(u in r)o[u]=t[u];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function dl(e){return e=e.childContextTypes,e!=null}function ZE(){ka(fl),ka(Rs)}function K6(e,t,r){if(Rs.current!==bp)throw Error(Cr(168));xa(Rs,t),xa(fl,r)}function rG(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(Cr(108,yae(e)||"Unknown",o));return Ga({},r,n)}function YE(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bp,h0=Rs.current,xa(Rs,e),xa(fl,fl.current),!0}function J6(e,t,r){var n=e.stateNode;if(!n)throw Error(Cr(169));r?(e=rG(e,t,h0),n.__reactInternalMemoizedMergedChildContext=e,ka(fl),ka(Rs),xa(Rs,e)):ka(fl),xa(fl,r)}var pf=null,UC=!1,DO=!1;function nG(e){pf===null?pf=[e]:pf.push(e)}function Foe(e){UC=!0,nG(e)}function Mp(){if(!DO&&pf!==null){DO=!0;var e=0,t=Ji;try{var r=pf;for(Ji=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}pf=null,UC=!1}catch(o){throw pf!==null&&(pf=pf.slice(e+1)),PW(sF,Mp),o}finally{Ji=t,DO=!1}}return null}var H_=[],q_=0,KE=null,JE=0,Tc=[],Sc=0,f0=null,gf=1,_f="";function Fm(e,t){H_[q_++]=JE,H_[q_++]=KE,KE=e,JE=t}function iG(e,t,r){Tc[Sc++]=gf,Tc[Sc++]=_f,Tc[Sc++]=f0,f0=e;var n=gf;e=_f;var o=32-yu(n)-1;n&=~(1<<o),r+=1;var u=32-yu(t)+o;if(30<u){var d=o-o%5;u=(n&(1<<d)-1).toString(32),n>>=d,o-=d,gf=1<<32-yu(t)+o|r<<o|n,_f=u+e}else gf=1<<u|r<<o|n,_f=e}function gF(e){e.return!==null&&(Fm(e,1),iG(e,1,0))}function _F(e){for(;e===KE;)KE=H_[--q_],H_[q_]=null,JE=H_[--q_],H_[q_]=null;for(;e===f0;)f0=Tc[--Sc],Tc[Sc]=null,_f=Tc[--Sc],Tc[Sc]=null,gf=Tc[--Sc],Tc[Sc]=null}var Hl=null,Gl=null,za=!1,hu=null;function aG(e,t){var r=Ac(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Q6(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hl=e,Gl=hp(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hl=e,Gl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=f0!==null?{id:gf,overflow:_f}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ac(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Hl=e,Gl=null,!0):!1;default:return!1}}function ER(e){return(e.mode&1)!==0&&(e.flags&128)===0}function AR(e){if(za){var t=Gl;if(t){var r=t;if(!Q6(e,t)){if(ER(e))throw Error(Cr(418));t=hp(r.nextSibling);var n=Hl;t&&Q6(e,t)?aG(n,r):(e.flags=e.flags&-4097|2,za=!1,Hl=e)}}else{if(ER(e))throw Error(Cr(418));e.flags=e.flags&-4097|2,za=!1,Hl=e}}}function e8(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hl=e}function DS(e){if(e!==Hl)return!1;if(!za)return e8(e),za=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!wR(e.type,e.memoizedProps)),t&&(t=Gl)){if(ER(e))throw oG(),Error(Cr(418));for(;t;)aG(e,t),t=hp(t.nextSibling)}if(e8(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Cr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Gl=hp(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Gl=null}}else Gl=Hl?hp(e.stateNode.nextSibling):null;return!0}function oG(){for(var e=Gl;e;)e=hp(e.nextSibling)}function ky(){Gl=Hl=null,za=!1}function yF(e){hu===null?hu=[e]:hu.push(e)}var Loe=zf.ReactCurrentBatchConfig;function M1(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Cr(309));var n=r.stateNode}if(!n)throw Error(Cr(147,e));var o=n,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(d){var i=o.refs;d===null?delete i[u]:i[u]=d},t._stringRef=u,t)}if(typeof e!="string")throw Error(Cr(284));if(!r._owner)throw Error(Cr(290,e))}return e}function FS(e,t){throw e=Object.prototype.toString.call(t),Error(Cr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function t8(e){var t=e._init;return t(e._payload)}function sG(e){function t(V,G){if(e){var U=V.deletions;U===null?(V.deletions=[G],V.flags|=16):U.push(G)}}function r(V,G){if(!e)return null;for(;G!==null;)t(V,G),G=G.sibling;return null}function n(V,G){for(V=new Map;G!==null;)G.key!==null?V.set(G.key,G):V.set(G.index,G),G=G.sibling;return V}function o(V,G){return V=mp(V,G),V.index=0,V.sibling=null,V}function u(V,G,U){return V.index=U,e?(U=V.alternate,U!==null?(U=U.index,U<G?(V.flags|=2,G):U):(V.flags|=2,G)):(V.flags|=1048576,G)}function d(V){return e&&V.alternate===null&&(V.flags|=2),V}function i(V,G,U,J){return G===null||G.tag!==6?(G=UO(U,V.mode,J),G.return=V,G):(G=o(G,U),G.return=V,G)}function v(V,G,U,J){var Z=U.type;return Z===j_?S(V,G,U.props.children,J,U.key):G!==null&&(G.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===$d&&t8(Z)===G.type)?(J=o(G,U.props),J.ref=M1(V,G,U),J.return=V,J):(J=OE(U.type,U.key,U.props,null,V.mode,J),J.ref=M1(V,G,U),J.return=V,J)}function w(V,G,U,J){return G===null||G.tag!==4||G.stateNode.containerInfo!==U.containerInfo||G.stateNode.implementation!==U.implementation?(G=$O(U,V.mode,J),G.return=V,G):(G=o(G,U.children||[]),G.return=V,G)}function S(V,G,U,J,Z){return G===null||G.tag!==7?(G=r0(U,V.mode,J,Z),G.return=V,G):(G=o(G,U),G.return=V,G)}function C(V,G,U){if(typeof G=="string"&&G!==""||typeof G=="number")return G=UO(""+G,V.mode,U),G.return=V,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case SS:return U=OE(G.type,G.key,G.props,null,V.mode,U),U.ref=M1(V,null,G),U.return=V,U;case z_:return G=$O(G,V.mode,U),G.return=V,G;case $d:var J=G._init;return C(V,J(G._payload),U)}if(Q1(G)||C1(G))return G=r0(G,V.mode,U,null),G.return=V,G;FS(V,G)}return null}function k(V,G,U,J){var Z=G!==null?G.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return Z!==null?null:i(V,G,""+U,J);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case SS:return U.key===Z?v(V,G,U,J):null;case z_:return U.key===Z?w(V,G,U,J):null;case $d:return Z=U._init,k(V,G,Z(U._payload),J)}if(Q1(U)||C1(U))return Z!==null?null:S(V,G,U,J,null);FS(V,U)}return null}function O(V,G,U,J,Z){if(typeof J=="string"&&J!==""||typeof J=="number")return V=V.get(U)||null,i(G,V,""+J,Z);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case SS:return V=V.get(J.key===null?U:J.key)||null,v(G,V,J,Z);case z_:return V=V.get(J.key===null?U:J.key)||null,w(G,V,J,Z);case $d:var K=J._init;return O(V,G,U,K(J._payload),Z)}if(Q1(J)||C1(J))return V=V.get(U)||null,S(G,V,J,Z,null);FS(G,J)}return null}function L(V,G,U,J){for(var Z=null,K=null,re=G,ge=G=0,ve=null;re!==null&&ge<U.length;ge++){re.index>ge?(ve=re,re=null):ve=re.sibling;var $e=k(V,re,U[ge],J);if($e===null){re===null&&(re=ve);break}e&&re&&$e.alternate===null&&t(V,re),G=u($e,G,ge),K===null?Z=$e:K.sibling=$e,K=$e,re=ve}if(ge===U.length)return r(V,re),za&&Fm(V,ge),Z;if(re===null){for(;ge<U.length;ge++)re=C(V,U[ge],J),re!==null&&(G=u(re,G,ge),K===null?Z=re:K.sibling=re,K=re);return za&&Fm(V,ge),Z}for(re=n(V,re);ge<U.length;ge++)ve=O(re,V,ge,U[ge],J),ve!==null&&(e&&ve.alternate!==null&&re.delete(ve.key===null?ge:ve.key),G=u(ve,G,ge),K===null?Z=ve:K.sibling=ve,K=ve);return e&&re.forEach(function(Ie){return t(V,Ie)}),za&&Fm(V,ge),Z}function R(V,G,U,J){var Z=C1(U);if(typeof Z!="function")throw Error(Cr(150));if(U=Z.call(U),U==null)throw Error(Cr(151));for(var K=Z=null,re=G,ge=G=0,ve=null,$e=U.next();re!==null&&!$e.done;ge++,$e=U.next()){re.index>ge?(ve=re,re=null):ve=re.sibling;var Ie=k(V,re,$e.value,J);if(Ie===null){re===null&&(re=ve);break}e&&re&&Ie.alternate===null&&t(V,re),G=u(Ie,G,ge),K===null?Z=Ie:K.sibling=Ie,K=Ie,re=ve}if($e.done)return r(V,re),za&&Fm(V,ge),Z;if(re===null){for(;!$e.done;ge++,$e=U.next())$e=C(V,$e.value,J),$e!==null&&(G=u($e,G,ge),K===null?Z=$e:K.sibling=$e,K=$e);return za&&Fm(V,ge),Z}for(re=n(V,re);!$e.done;ge++,$e=U.next())$e=O(re,V,ge,$e.value,J),$e!==null&&(e&&$e.alternate!==null&&re.delete($e.key===null?ge:$e.key),G=u($e,G,ge),K===null?Z=$e:K.sibling=$e,K=$e);return e&&re.forEach(function(ke){return t(V,ke)}),za&&Fm(V,ge),Z}function N(V,G,U,J){if(typeof U=="object"&&U!==null&&U.type===j_&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case SS:e:{for(var Z=U.key,K=G;K!==null;){if(K.key===Z){if(Z=U.type,Z===j_){if(K.tag===7){r(V,K.sibling),G=o(K,U.props.children),G.return=V,V=G;break e}}else if(K.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===$d&&t8(Z)===K.type){r(V,K.sibling),G=o(K,U.props),G.ref=M1(V,K,U),G.return=V,V=G;break e}r(V,K);break}else t(V,K);K=K.sibling}U.type===j_?(G=r0(U.props.children,V.mode,J,U.key),G.return=V,V=G):(J=OE(U.type,U.key,U.props,null,V.mode,J),J.ref=M1(V,G,U),J.return=V,V=J)}return d(V);case z_:e:{for(K=U.key;G!==null;){if(G.key===K)if(G.tag===4&&G.stateNode.containerInfo===U.containerInfo&&G.stateNode.implementation===U.implementation){r(V,G.sibling),G=o(G,U.children||[]),G.return=V,V=G;break e}else{r(V,G);break}else t(V,G);G=G.sibling}G=$O(U,V.mode,J),G.return=V,V=G}return d(V);case $d:return K=U._init,N(V,G,K(U._payload),J)}if(Q1(U))return L(V,G,U,J);if(C1(U))return R(V,G,U,J);FS(V,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,G!==null&&G.tag===6?(r(V,G.sibling),G=o(G,U),G.return=V,V=G):(r(V,G),G=UO(U,V.mode,J),G.return=V,V=G),d(V)):r(V,G)}return N}var Oy=sG(!0),lG=sG(!1),QE=Op(null),eA=null,X_=null,vF=null;function xF(){vF=X_=eA=null}function wF(e){var t=QE.current;ka(QE),e._currentValue=t}function CR(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function oy(e,t){eA=e,vF=X_=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ul=!0),e.firstContext=null)}function Dc(e){var t=e._currentValue;if(vF!==e)if(e={context:e,memoizedValue:t,next:null},X_===null){if(eA===null)throw Error(Cr(308));X_=e,eA.dependencies={lanes:0,firstContext:e}}else X_=X_.next=e;return t}var Vm=null;function bF(e){Vm===null?Vm=[e]:Vm.push(e)}function cG(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,bF(t)):(r.next=o.next,o.next=r),t.interleaved=r,Of(e,n)}function Of(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Vd=!1;function TF(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uG(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function bf(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fp(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Mi&2){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Of(e,r)}return o=n.interleaved,o===null?(t.next=t,bF(n)):(t.next=o.next,o.next=t),n.interleaved=t,Of(e,r)}function EE(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lF(e,r)}}function r8(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,u=null;if(r=r.firstBaseUpdate,r!==null){do{var d={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};u===null?o=u=d:u=u.next=d,r=r.next}while(r!==null);u===null?o=u=t:u=u.next=t}else o=u=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function tA(e,t,r,n){var o=e.updateQueue;Vd=!1;var u=o.firstBaseUpdate,d=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var v=i,w=v.next;v.next=null,d===null?u=w:d.next=w,d=v;var S=e.alternate;S!==null&&(S=S.updateQueue,i=S.lastBaseUpdate,i!==d&&(i===null?S.firstBaseUpdate=w:i.next=w,S.lastBaseUpdate=v))}if(u!==null){var C=o.baseState;d=0,S=w=v=null,i=u;do{var k=i.lane,O=i.eventTime;if((n&k)===k){S!==null&&(S=S.next={eventTime:O,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var L=e,R=i;switch(k=t,O=r,R.tag){case 1:if(L=R.payload,typeof L=="function"){C=L.call(O,C,k);break e}C=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=R.payload,k=typeof L=="function"?L.call(O,C,k):L,k==null)break e;C=Ga({},C,k);break e;case 2:Vd=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,k=o.effects,k===null?o.effects=[i]:k.push(i))}else O={eventTime:O,lane:k,tag:i.tag,payload:i.payload,callback:i.callback,next:null},S===null?(w=S=O,v=C):S=S.next=O,d|=k;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;k=i,i=k.next,k.next=null,o.lastBaseUpdate=k,o.shared.pending=null}}while(!0);if(S===null&&(v=C),o.baseState=v,o.firstBaseUpdate=w,o.lastBaseUpdate=S,t=o.shared.interleaved,t!==null){o=t;do d|=o.lane,o=o.next;while(o!==t)}else u===null&&(o.shared.lanes=0);p0|=d,e.lanes=d,e.memoizedState=C}}function n8(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(Cr(191,o));o.call(n)}}}var e2={},vh=Op(e2),$w=Op(e2),Vw=Op(e2);function Wm(e){if(e===e2)throw Error(Cr(174));return e}function SF(e,t){switch(xa(Vw,t),xa($w,e),xa(vh,e2),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:sR(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=sR(t,e)}ka(vh),xa(vh,t)}function My(){ka(vh),ka($w),ka(Vw)}function hG(e){Wm(Vw.current);var t=Wm(vh.current),r=sR(t,e.type);t!==r&&(xa($w,e),xa(vh,r))}function EF(e){$w.current===e&&(ka(vh),ka($w))}var $a=Op(0);function rA(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var FO=[];function AF(){for(var e=0;e<FO.length;e++)FO[e]._workInProgressVersionPrimary=null;FO.length=0}var AE=zf.ReactCurrentDispatcher,LO=zf.ReactCurrentBatchConfig,d0=0,Wa=null,Mo=null,Xo=null,nA=!1,fw=!1,Ww=0,Noe=0;function vs(){throw Error(Cr(321))}function CF(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Tu(e[r],t[r]))return!1;return!0}function PF(e,t,r,n,o,u){if(d0=u,Wa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,AE.current=e===null||e.memoizedState===null?Uoe:$oe,e=r(n,o),fw){u=0;do{if(fw=!1,Ww=0,25<=u)throw Error(Cr(301));u+=1,Xo=Mo=null,t.updateQueue=null,AE.current=Voe,e=r(n,o)}while(fw)}if(AE.current=iA,t=Mo!==null&&Mo.next!==null,d0=0,Xo=Mo=Wa=null,nA=!1,t)throw Error(Cr(300));return e}function IF(){var e=Ww!==0;return Ww=0,e}function oh(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xo===null?Wa.memoizedState=Xo=e:Xo=Xo.next=e,Xo}function Fc(){if(Mo===null){var e=Wa.alternate;e=e!==null?e.memoizedState:null}else e=Mo.next;var t=Xo===null?Wa.memoizedState:Xo.next;if(t!==null)Xo=t,Mo=e;else{if(e===null)throw Error(Cr(310));Mo=e,e={memoizedState:Mo.memoizedState,baseState:Mo.baseState,baseQueue:Mo.baseQueue,queue:Mo.queue,next:null},Xo===null?Wa.memoizedState=Xo=e:Xo=Xo.next=e}return Xo}function Gw(e,t){return typeof t=="function"?t(e):t}function NO(e){var t=Fc(),r=t.queue;if(r===null)throw Error(Cr(311));r.lastRenderedReducer=e;var n=Mo,o=n.baseQueue,u=r.pending;if(u!==null){if(o!==null){var d=o.next;o.next=u.next,u.next=d}n.baseQueue=o=u,r.pending=null}if(o!==null){u=o.next,n=n.baseState;var i=d=null,v=null,w=u;do{var S=w.lane;if((d0&S)===S)v!==null&&(v=v.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),n=w.hasEagerState?w.eagerState:e(n,w.action);else{var C={lane:S,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};v===null?(i=v=C,d=n):v=v.next=C,Wa.lanes|=S,p0|=S}w=w.next}while(w!==null&&w!==u);v===null?d=n:v.next=i,Tu(n,t.memoizedState)||(ul=!0),t.memoizedState=n,t.baseState=d,t.baseQueue=v,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do u=o.lane,Wa.lanes|=u,p0|=u,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function BO(e){var t=Fc(),r=t.queue;if(r===null)throw Error(Cr(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,u=t.memoizedState;if(o!==null){r.pending=null;var d=o=o.next;do u=e(u,d.action),d=d.next;while(d!==o);Tu(u,t.memoizedState)||(ul=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),r.lastRenderedState=u}return[u,n]}function fG(){}function dG(e,t){var r=Wa,n=Fc(),o=t(),u=!Tu(n.memoizedState,o);if(u&&(n.memoizedState=o,ul=!0),n=n.queue,kF(gG.bind(null,r,n,e),[e]),n.getSnapshot!==t||u||Xo!==null&&Xo.memoizedState.tag&1){if(r.flags|=2048,Hw(9,mG.bind(null,r,n,o,t),void 0,null),Jo===null)throw Error(Cr(349));d0&30||pG(r,t,o)}return o}function pG(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Wa.updateQueue,t===null?(t={lastEffect:null,stores:null},Wa.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function mG(e,t,r,n){t.value=r,t.getSnapshot=n,_G(t)&&yG(e)}function gG(e,t,r){return r(function(){_G(t)&&yG(e)})}function _G(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Tu(e,r)}catch{return!0}}function yG(e){var t=Of(e,1);t!==null&&vu(t,e,1,-1)}function i8(e){var t=oh();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gw,lastRenderedState:e},t.queue=e,e=e.dispatch=joe.bind(null,Wa,e),[t.memoizedState,e]}function Hw(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Wa.updateQueue,t===null?(t={lastEffect:null,stores:null},Wa.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function vG(){return Fc().memoizedState}function CE(e,t,r,n){var o=oh();Wa.flags|=e,o.memoizedState=Hw(1|t,r,void 0,n===void 0?null:n)}function $C(e,t,r,n){var o=Fc();n=n===void 0?null:n;var u=void 0;if(Mo!==null){var d=Mo.memoizedState;if(u=d.destroy,n!==null&&CF(n,d.deps)){o.memoizedState=Hw(t,r,u,n);return}}Wa.flags|=e,o.memoizedState=Hw(1|t,r,u,n)}function a8(e,t){return CE(8390656,8,e,t)}function kF(e,t){return $C(2048,8,e,t)}function xG(e,t){return $C(4,2,e,t)}function wG(e,t){return $C(4,4,e,t)}function bG(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function TG(e,t,r){return r=r!=null?r.concat([e]):null,$C(4,4,bG.bind(null,t,e),r)}function OF(){}function SG(e,t){var r=Fc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&CF(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function EG(e,t){var r=Fc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&CF(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function AG(e,t,r){return d0&21?(Tu(r,t)||(r=OW(),Wa.lanes|=r,p0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ul=!0),e.memoizedState=r)}function Boe(e,t){var r=Ji;Ji=r!==0&&4>r?r:4,e(!0);var n=LO.transition;LO.transition={};try{e(!1),t()}finally{Ji=r,LO.transition=n}}function CG(){return Fc().memoizedState}function zoe(e,t,r){var n=pp(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},PG(e))IG(t,r);else if(r=cG(e,t,r,n),r!==null){var o=el();vu(r,e,n,o),kG(r,t,n)}}function joe(e,t,r){var n=pp(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(PG(e))IG(t,o);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var d=t.lastRenderedState,i=u(d,r);if(o.hasEagerState=!0,o.eagerState=i,Tu(i,d)){var v=t.interleaved;v===null?(o.next=o,bF(t)):(o.next=v.next,v.next=o),t.interleaved=o;return}}catch{}finally{}r=cG(e,t,o,n),r!==null&&(o=el(),vu(r,e,n,o),kG(r,t,n))}}function PG(e){var t=e.alternate;return e===Wa||t!==null&&t===Wa}function IG(e,t){fw=nA=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function kG(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lF(e,r)}}var iA={readContext:Dc,useCallback:vs,useContext:vs,useEffect:vs,useImperativeHandle:vs,useInsertionEffect:vs,useLayoutEffect:vs,useMemo:vs,useReducer:vs,useRef:vs,useState:vs,useDebugValue:vs,useDeferredValue:vs,useTransition:vs,useMutableSource:vs,useSyncExternalStore:vs,useId:vs,unstable_isNewReconciler:!1},Uoe={readContext:Dc,useCallback:function(e,t){return oh().memoizedState=[e,t===void 0?null:t],e},useContext:Dc,useEffect:a8,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,CE(4194308,4,bG.bind(null,t,e),r)},useLayoutEffect:function(e,t){return CE(4194308,4,e,t)},useInsertionEffect:function(e,t){return CE(4,2,e,t)},useMemo:function(e,t){var r=oh();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=oh();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=zoe.bind(null,Wa,e),[n.memoizedState,e]},useRef:function(e){var t=oh();return e={current:e},t.memoizedState=e},useState:i8,useDebugValue:OF,useDeferredValue:function(e){return oh().memoizedState=e},useTransition:function(){var e=i8(!1),t=e[0];return e=Boe.bind(null,e[1]),oh().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Wa,o=oh();if(za){if(r===void 0)throw Error(Cr(407));r=r()}else{if(r=t(),Jo===null)throw Error(Cr(349));d0&30||pG(n,t,r)}o.memoizedState=r;var u={value:r,getSnapshot:t};return o.queue=u,a8(gG.bind(null,n,u,e),[e]),n.flags|=2048,Hw(9,mG.bind(null,n,u,r,t),void 0,null),r},useId:function(){var e=oh(),t=Jo.identifierPrefix;if(za){var r=_f,n=gf;r=(n&~(1<<32-yu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ww++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Noe++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$oe={readContext:Dc,useCallback:SG,useContext:Dc,useEffect:kF,useImperativeHandle:TG,useInsertionEffect:xG,useLayoutEffect:wG,useMemo:EG,useReducer:NO,useRef:vG,useState:function(){return NO(Gw)},useDebugValue:OF,useDeferredValue:function(e){var t=Fc();return AG(t,Mo.memoizedState,e)},useTransition:function(){var e=NO(Gw)[0],t=Fc().memoizedState;return[e,t]},useMutableSource:fG,useSyncExternalStore:dG,useId:CG,unstable_isNewReconciler:!1},Voe={readContext:Dc,useCallback:SG,useContext:Dc,useEffect:kF,useImperativeHandle:TG,useInsertionEffect:xG,useLayoutEffect:wG,useMemo:EG,useReducer:BO,useRef:vG,useState:function(){return BO(Gw)},useDebugValue:OF,useDeferredValue:function(e){var t=Fc();return Mo===null?t.memoizedState=e:AG(t,Mo.memoizedState,e)},useTransition:function(){var e=BO(Gw)[0],t=Fc().memoizedState;return[e,t]},useMutableSource:fG,useSyncExternalStore:dG,useId:CG,unstable_isNewReconciler:!1};function iu(e,t){if(e&&e.defaultProps){t=Ga({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function PR(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ga({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var VC={isMounted:function(e){return(e=e._reactInternals)?D0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=el(),o=pp(e),u=bf(n,o);u.payload=t,r!=null&&(u.callback=r),t=fp(e,u,o),t!==null&&(vu(t,e,o,n),EE(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=el(),o=pp(e),u=bf(n,o);u.tag=1,u.payload=t,r!=null&&(u.callback=r),t=fp(e,u,o),t!==null&&(vu(t,e,o,n),EE(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=el(),n=pp(e),o=bf(r,n);o.tag=2,t!=null&&(o.callback=t),t=fp(e,o,n),t!==null&&(vu(t,e,n,r),EE(t,e,n))}};function o8(e,t,r,n,o,u,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,u,d):t.prototype&&t.prototype.isPureReactComponent?!Bw(r,n)||!Bw(o,u):!0}function OG(e,t,r){var n=!1,o=bp,u=t.contextType;return typeof u=="object"&&u!==null?u=Dc(u):(o=dl(t)?h0:Rs.current,n=t.contextTypes,u=(n=n!=null)?Iy(e,o):bp),t=new t(r,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=VC,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=u),t}function s8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&VC.enqueueReplaceState(t,t.state,null)}function IR(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},TF(e);var u=t.contextType;typeof u=="object"&&u!==null?o.context=Dc(u):(u=dl(t)?h0:Rs.current,o.context=Iy(e,u)),o.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(PR(e,t,u,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&VC.enqueueReplaceState(o,o.state,null),tA(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ry(e,t){try{var r="",n=t;do r+=_ae(n),n=n.return;while(n);var o=r}catch(u){o=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:o,digest:null}}function zO(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function kR(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Woe=typeof WeakMap=="function"?WeakMap:Map;function MG(e,t,r){r=bf(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){oA||(oA=!0,jR=n),kR(e,t)},r}function RG(e,t,r){r=bf(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){kR(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(r.callback=function(){kR(e,t),typeof n!="function"&&(dp===null?dp=new Set([this]):dp.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),r}function l8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Woe;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=ise.bind(null,e,t,r),t.then(e,e))}function c8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function u8(e,t,r,n,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=bf(-1,1),t.tag=2,fp(r,t,1))),r.lanes|=1),e)}var Goe=zf.ReactCurrentOwner,ul=!1;function Zs(e,t,r,n){t.child=e===null?lG(t,null,r,n):Oy(t,e.child,r,n)}function h8(e,t,r,n,o){r=r.render;var u=t.ref;return oy(t,o),n=PF(e,t,r,n,u,o),r=IF(),e!==null&&!ul?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Mf(e,t,o)):(za&&r&&gF(t),t.flags|=1,Zs(e,t,n,o),t.child)}function f8(e,t,r,n,o){if(e===null){var u=r.type;return typeof u=="function"&&!zF(u)&&u.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=u,DG(e,t,u,n,o)):(e=OE(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&o)){var d=u.memoizedProps;if(r=r.compare,r=r!==null?r:Bw,r(d,n)&&e.ref===t.ref)return Mf(e,t,o)}return t.flags|=1,e=mp(u,n),e.ref=t.ref,e.return=t,t.child=e}function DG(e,t,r,n,o){if(e!==null){var u=e.memoizedProps;if(Bw(u,n)&&e.ref===t.ref)if(ul=!1,t.pendingProps=n=u,(e.lanes&o)!==0)e.flags&131072&&(ul=!0);else return t.lanes=e.lanes,Mf(e,t,o)}return OR(e,t,r,n,o)}function FG(e,t,r){var n=t.pendingProps,o=n.children,u=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xa(Y_,Bl),Bl|=r;else{if(!(r&1073741824))return e=u!==null?u.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xa(Y_,Bl),Bl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=u!==null?u.baseLanes:r,xa(Y_,Bl),Bl|=n}else u!==null?(n=u.baseLanes|r,t.memoizedState=null):n=r,xa(Y_,Bl),Bl|=n;return Zs(e,t,o,r),t.child}function LG(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function OR(e,t,r,n,o){var u=dl(r)?h0:Rs.current;return u=Iy(t,u),oy(t,o),r=PF(e,t,r,n,u,o),n=IF(),e!==null&&!ul?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Mf(e,t,o)):(za&&n&&gF(t),t.flags|=1,Zs(e,t,r,o),t.child)}function d8(e,t,r,n,o){if(dl(r)){var u=!0;YE(t)}else u=!1;if(oy(t,o),t.stateNode===null)PE(e,t),OG(t,r,n),IR(t,r,n,o),n=!0;else if(e===null){var d=t.stateNode,i=t.memoizedProps;d.props=i;var v=d.context,w=r.contextType;typeof w=="object"&&w!==null?w=Dc(w):(w=dl(r)?h0:Rs.current,w=Iy(t,w));var S=r.getDerivedStateFromProps,C=typeof S=="function"||typeof d.getSnapshotBeforeUpdate=="function";C||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(i!==n||v!==w)&&s8(t,d,n,w),Vd=!1;var k=t.memoizedState;d.state=k,tA(t,n,d,o),v=t.memoizedState,i!==n||k!==v||fl.current||Vd?(typeof S=="function"&&(PR(t,r,S,n),v=t.memoizedState),(i=Vd||o8(t,r,i,n,k,v,w))?(C||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=v),d.props=n,d.state=v,d.context=w,n=i):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{d=t.stateNode,uG(e,t),i=t.memoizedProps,w=t.type===t.elementType?i:iu(t.type,i),d.props=w,C=t.pendingProps,k=d.context,v=r.contextType,typeof v=="object"&&v!==null?v=Dc(v):(v=dl(r)?h0:Rs.current,v=Iy(t,v));var O=r.getDerivedStateFromProps;(S=typeof O=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(i!==C||k!==v)&&s8(t,d,n,v),Vd=!1,k=t.memoizedState,d.state=k,tA(t,n,d,o);var L=t.memoizedState;i!==C||k!==L||fl.current||Vd?(typeof O=="function"&&(PR(t,r,O,n),L=t.memoizedState),(w=Vd||o8(t,r,w,n,k,L,v)||!1)?(S||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(n,L,v),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(n,L,v)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=L),d.props=n,d.state=L,d.context=v,n=w):(typeof d.componentDidUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),n=!1)}return MR(e,t,r,n,u,o)}function MR(e,t,r,n,o,u){LG(e,t);var d=(t.flags&128)!==0;if(!n&&!d)return o&&J6(t,r,!1),Mf(e,t,u);n=t.stateNode,Goe.current=t;var i=d&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&d?(t.child=Oy(t,e.child,null,u),t.child=Oy(t,null,i,u)):Zs(e,t,i,u),t.memoizedState=n.state,o&&J6(t,r,!0),t.child}function NG(e){var t=e.stateNode;t.pendingContext?K6(e,t.pendingContext,t.pendingContext!==t.context):t.context&&K6(e,t.context,!1),SF(e,t.containerInfo)}function p8(e,t,r,n,o){return ky(),yF(o),t.flags|=256,Zs(e,t,r,n),t.child}var RR={dehydrated:null,treeContext:null,retryLane:0};function DR(e){return{baseLanes:e,cachePool:null,transitions:null}}function BG(e,t,r){var n=t.pendingProps,o=$a.current,u=!1,d=(t.flags&128)!==0,i;if((i=d)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),xa($a,o&1),e===null)return AR(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=n.children,e=n.fallback,u?(n=t.mode,u=t.child,d={mode:"hidden",children:d},!(n&1)&&u!==null?(u.childLanes=0,u.pendingProps=d):u=HC(d,n,0,null),e=r0(e,n,r,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=DR(r),t.memoizedState=RR,e):MF(t,d));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return Hoe(e,t,d,n,i,o,r);if(u){u=n.fallback,d=t.mode,o=e.child,i=o.sibling;var v={mode:"hidden",children:n.children};return!(d&1)&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=v,t.deletions=null):(n=mp(o,v),n.subtreeFlags=o.subtreeFlags&14680064),i!==null?u=mp(i,u):(u=r0(u,d,r,null),u.flags|=2),u.return=t,n.return=t,n.sibling=u,t.child=n,n=u,u=t.child,d=e.child.memoizedState,d=d===null?DR(r):{baseLanes:d.baseLanes|r,cachePool:null,transitions:d.transitions},u.memoizedState=d,u.childLanes=e.childLanes&~r,t.memoizedState=RR,n}return u=e.child,e=u.sibling,n=mp(u,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function MF(e,t){return t=HC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function LS(e,t,r,n){return n!==null&&yF(n),Oy(t,e.child,null,r),e=MF(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hoe(e,t,r,n,o,u,d){if(r)return t.flags&256?(t.flags&=-257,n=zO(Error(Cr(422))),LS(e,t,d,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=n.fallback,o=t.mode,n=HC({mode:"visible",children:n.children},o,0,null),u=r0(u,o,d,null),u.flags|=2,n.return=t,u.return=t,n.sibling=u,t.child=n,t.mode&1&&Oy(t,e.child,null,d),t.child.memoizedState=DR(d),t.memoizedState=RR,u);if(!(t.mode&1))return LS(e,t,d,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var i=n.dgst;return n=i,u=Error(Cr(419)),n=zO(u,n,void 0),LS(e,t,d,n)}if(i=(d&e.childLanes)!==0,ul||i){if(n=Jo,n!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(n.suspendedLanes|d)?0:o,o!==0&&o!==u.retryLane&&(u.retryLane=o,Of(e,o),vu(n,e,o,-1))}return BF(),n=zO(Error(Cr(421))),LS(e,t,d,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=ase.bind(null,e),o._reactRetry=t,null):(e=u.treeContext,Gl=hp(o.nextSibling),Hl=t,za=!0,hu=null,e!==null&&(Tc[Sc++]=gf,Tc[Sc++]=_f,Tc[Sc++]=f0,gf=e.id,_f=e.overflow,f0=t),t=MF(t,n.children),t.flags|=4096,t)}function m8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),CR(e.return,t,r)}function jO(e,t,r,n,o){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=n,u.tail=r,u.tailMode=o)}function zG(e,t,r){var n=t.pendingProps,o=n.revealOrder,u=n.tail;if(Zs(e,t,n.children,r),n=$a.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&m8(e,r,t);else if(e.tag===19)m8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(xa($a,n),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&rA(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),jO(t,!1,o,r,u);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&rA(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}jO(t,!0,r,null,u);break;case"together":jO(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function PE(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Mf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),p0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Cr(153));if(t.child!==null){for(e=t.child,r=mp(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=mp(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function qoe(e,t,r){switch(t.tag){case 3:NG(t),ky();break;case 5:hG(t);break;case 1:dl(t.type)&&YE(t);break;case 4:SF(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;xa(QE,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(xa($a,$a.current&1),t.flags|=128,null):r&t.child.childLanes?BG(e,t,r):(xa($a,$a.current&1),e=Mf(e,t,r),e!==null?e.sibling:null);xa($a,$a.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return zG(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),xa($a,$a.current),n)break;return null;case 22:case 23:return t.lanes=0,FG(e,t,r)}return Mf(e,t,r)}var jG,FR,UG,$G;jG=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};FR=function(){};UG=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,Wm(vh.current);var u=null;switch(r){case"input":o=nR(e,o),n=nR(e,n),u=[];break;case"select":o=Ga({},o,{value:void 0}),n=Ga({},n,{value:void 0}),u=[];break;case"textarea":o=oR(e,o),n=oR(e,n),u=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=XE)}lR(r,n);var d;r=null;for(w in o)if(!n.hasOwnProperty(w)&&o.hasOwnProperty(w)&&o[w]!=null)if(w==="style"){var i=o[w];for(d in i)i.hasOwnProperty(d)&&(r||(r={}),r[d]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(Ow.hasOwnProperty(w)?u||(u=[]):(u=u||[]).push(w,null));for(w in n){var v=n[w];if(i=o!=null?o[w]:void 0,n.hasOwnProperty(w)&&v!==i&&(v!=null||i!=null))if(w==="style")if(i){for(d in i)!i.hasOwnProperty(d)||v&&v.hasOwnProperty(d)||(r||(r={}),r[d]="");for(d in v)v.hasOwnProperty(d)&&i[d]!==v[d]&&(r||(r={}),r[d]=v[d])}else r||(u||(u=[]),u.push(w,r)),r=v;else w==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,i=i?i.__html:void 0,v!=null&&i!==v&&(u=u||[]).push(w,v)):w==="children"?typeof v!="string"&&typeof v!="number"||(u=u||[]).push(w,""+v):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(Ow.hasOwnProperty(w)?(v!=null&&w==="onScroll"&&Aa("scroll",e),u||i===v||(u=[])):(u=u||[]).push(w,v))}r&&(u=u||[]).push("style",r);var w=u;(t.updateQueue=w)&&(t.flags|=4)}};$G=function(e,t,r,n){r!==n&&(t.flags|=4)};function R1(e,t){if(!za)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xs(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Xoe(e,t,r){var n=t.pendingProps;switch(_F(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xs(t),null;case 1:return dl(t.type)&&ZE(),xs(t),null;case 3:return n=t.stateNode,My(),ka(fl),ka(Rs),AF(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(DS(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,hu!==null&&(VR(hu),hu=null))),FR(e,t),xs(t),null;case 5:EF(t);var o=Wm(Vw.current);if(r=t.type,e!==null&&t.stateNode!=null)UG(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Cr(166));return xs(t),null}if(e=Wm(vh.current),DS(t)){n=t.stateNode,r=t.type;var u=t.memoizedProps;switch(n[uh]=t,n[Uw]=u,e=(t.mode&1)!==0,r){case"dialog":Aa("cancel",n),Aa("close",n);break;case"iframe":case"object":case"embed":Aa("load",n);break;case"video":case"audio":for(o=0;o<tw.length;o++)Aa(tw[o],n);break;case"source":Aa("error",n);break;case"img":case"image":case"link":Aa("error",n),Aa("load",n);break;case"details":Aa("toggle",n);break;case"input":S6(n,u),Aa("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!u.multiple},Aa("invalid",n);break;case"textarea":A6(n,u),Aa("invalid",n)}lR(r,u),o=null;for(var d in u)if(u.hasOwnProperty(d)){var i=u[d];d==="children"?typeof i=="string"?n.textContent!==i&&(u.suppressHydrationWarning!==!0&&RS(n.textContent,i,e),o=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(u.suppressHydrationWarning!==!0&&RS(n.textContent,i,e),o=["children",""+i]):Ow.hasOwnProperty(d)&&i!=null&&d==="onScroll"&&Aa("scroll",n)}switch(r){case"input":ES(n),E6(n,u,!0);break;case"textarea":ES(n),C6(n);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(n.onclick=XE)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gW(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=d.createElement(r,{is:n.is}):(e=d.createElement(r),r==="select"&&(d=e,n.multiple?d.multiple=!0:n.size&&(d.size=n.size))):e=d.createElementNS(e,r),e[uh]=t,e[Uw]=n,jG(e,t,!1,!1),t.stateNode=e;e:{switch(d=cR(r,n),r){case"dialog":Aa("cancel",e),Aa("close",e),o=n;break;case"iframe":case"object":case"embed":Aa("load",e),o=n;break;case"video":case"audio":for(o=0;o<tw.length;o++)Aa(tw[o],e);o=n;break;case"source":Aa("error",e),o=n;break;case"img":case"image":case"link":Aa("error",e),Aa("load",e),o=n;break;case"details":Aa("toggle",e),o=n;break;case"input":S6(e,n),o=nR(e,n),Aa("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=Ga({},n,{value:void 0}),Aa("invalid",e);break;case"textarea":A6(e,n),o=oR(e,n),Aa("invalid",e);break;default:o=n}lR(r,o),i=o;for(u in i)if(i.hasOwnProperty(u)){var v=i[u];u==="style"?vW(e,v):u==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&_W(e,v)):u==="children"?typeof v=="string"?(r!=="textarea"||v!=="")&&Mw(e,v):typeof v=="number"&&Mw(e,""+v):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ow.hasOwnProperty(u)?v!=null&&u==="onScroll"&&Aa("scroll",e):v!=null&&rF(e,u,v,d))}switch(r){case"input":ES(e),E6(e,n,!1);break;case"textarea":ES(e),C6(e);break;case"option":n.value!=null&&e.setAttribute("value",""+wp(n.value));break;case"select":e.multiple=!!n.multiple,u=n.value,u!=null?ry(e,!!n.multiple,u,!1):n.defaultValue!=null&&ry(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=XE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xs(t),null;case 6:if(e&&t.stateNode!=null)$G(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Cr(166));if(r=Wm(Vw.current),Wm(vh.current),DS(t)){if(n=t.stateNode,r=t.memoizedProps,n[uh]=t,(u=n.nodeValue!==r)&&(e=Hl,e!==null))switch(e.tag){case 3:RS(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&RS(n.nodeValue,r,(e.mode&1)!==0)}u&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[uh]=t,t.stateNode=n}return xs(t),null;case 13:if(ka($a),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(za&&Gl!==null&&t.mode&1&&!(t.flags&128))oG(),ky(),t.flags|=98560,u=!1;else if(u=DS(t),n!==null&&n.dehydrated!==null){if(e===null){if(!u)throw Error(Cr(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(Cr(317));u[uh]=t}else ky(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xs(t),u=!1}else hu!==null&&(VR(hu),hu=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||$a.current&1?Do===0&&(Do=3):BF())),t.updateQueue!==null&&(t.flags|=4),xs(t),null);case 4:return My(),FR(e,t),e===null&&zw(t.stateNode.containerInfo),xs(t),null;case 10:return wF(t.type._context),xs(t),null;case 17:return dl(t.type)&&ZE(),xs(t),null;case 19:if(ka($a),u=t.memoizedState,u===null)return xs(t),null;if(n=(t.flags&128)!==0,d=u.rendering,d===null)if(n)R1(u,!1);else{if(Do!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=rA(e),d!==null){for(t.flags|=128,R1(u,!1),n=d.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)u=r,e=n,u.flags&=14680066,d=u.alternate,d===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=d.childLanes,u.lanes=d.lanes,u.child=d.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=d.memoizedProps,u.memoizedState=d.memoizedState,u.updateQueue=d.updateQueue,u.type=d.type,e=d.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return xa($a,$a.current&1|2),t.child}e=e.sibling}u.tail!==null&&so()>Dy&&(t.flags|=128,n=!0,R1(u,!1),t.lanes=4194304)}else{if(!n)if(e=rA(d),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),R1(u,!0),u.tail===null&&u.tailMode==="hidden"&&!d.alternate&&!za)return xs(t),null}else 2*so()-u.renderingStartTime>Dy&&r!==1073741824&&(t.flags|=128,n=!0,R1(u,!1),t.lanes=4194304);u.isBackwards?(d.sibling=t.child,t.child=d):(r=u.last,r!==null?r.sibling=d:t.child=d,u.last=d)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=so(),t.sibling=null,r=$a.current,xa($a,n?r&1|2:r&1),t):(xs(t),null);case 22:case 23:return NF(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Bl&1073741824&&(xs(t),t.subtreeFlags&6&&(t.flags|=8192)):xs(t),null;case 24:return null;case 25:return null}throw Error(Cr(156,t.tag))}function Zoe(e,t){switch(_F(t),t.tag){case 1:return dl(t.type)&&ZE(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return My(),ka(fl),ka(Rs),AF(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return EF(t),null;case 13:if(ka($a),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Cr(340));ky()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ka($a),null;case 4:return My(),null;case 10:return wF(t.type._context),null;case 22:case 23:return NF(),null;case 24:return null;default:return null}}var NS=!1,As=!1,Yoe=typeof WeakSet=="function"?WeakSet:Set,ln=null;function Z_(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ya(e,t,n)}else r.current=null}function LR(e,t,r){try{r()}catch(n){Ya(e,t,n)}}var g8=!1;function Koe(e,t){if(vR=GE,e=qW(),mF(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,u=n.focusNode;n=n.focusOffset;try{r.nodeType,u.nodeType}catch{r=null;break e}var d=0,i=-1,v=-1,w=0,S=0,C=e,k=null;t:for(;;){for(var O;C!==r||o!==0&&C.nodeType!==3||(i=d+o),C!==u||n!==0&&C.nodeType!==3||(v=d+n),C.nodeType===3&&(d+=C.nodeValue.length),(O=C.firstChild)!==null;)k=C,C=O;for(;;){if(C===e)break t;if(k===r&&++w===o&&(i=d),k===u&&++S===n&&(v=d),(O=C.nextSibling)!==null)break;C=k,k=C.parentNode}C=O}r=i===-1||v===-1?null:{start:i,end:v}}else r=null}r=r||{start:0,end:0}}else r=null;for(xR={focusedElem:e,selectionRange:r},GE=!1,ln=t;ln!==null;)if(t=ln,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ln=e;else for(;ln!==null;){t=ln;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var R=L.memoizedProps,N=L.memoizedState,V=t.stateNode,G=V.getSnapshotBeforeUpdate(t.elementType===t.type?R:iu(t.type,R),N);V.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Cr(163))}}catch(J){Ya(t,t.return,J)}if(e=t.sibling,e!==null){e.return=t.return,ln=e;break}ln=t.return}return L=g8,g8=!1,L}function dw(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var u=o.destroy;o.destroy=void 0,u!==void 0&&LR(t,r,u)}o=o.next}while(o!==n)}}function WC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function NR(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function VG(e){var t=e.alternate;t!==null&&(e.alternate=null,VG(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[uh],delete t[Uw],delete t[TR],delete t[Roe],delete t[Doe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function WG(e){return e.tag===5||e.tag===3||e.tag===4}function _8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||WG(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function BR(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=XE));else if(n!==4&&(e=e.child,e!==null))for(BR(e,t,r),e=e.sibling;e!==null;)BR(e,t,r),e=e.sibling}function zR(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zR(e,t,r),e=e.sibling;e!==null;)zR(e,t,r),e=e.sibling}var os=null,lu=!1;function Fd(e,t,r){for(r=r.child;r!==null;)GG(e,t,r),r=r.sibling}function GG(e,t,r){if(yh&&typeof yh.onCommitFiberUnmount=="function")try{yh.onCommitFiberUnmount(LC,r)}catch{}switch(r.tag){case 5:As||Z_(r,t);case 6:var n=os,o=lu;os=null,Fd(e,t,r),os=n,lu=o,os!==null&&(lu?(e=os,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):os.removeChild(r.stateNode));break;case 18:os!==null&&(lu?(e=os,r=r.stateNode,e.nodeType===8?RO(e.parentNode,r):e.nodeType===1&&RO(e,r),Lw(e)):RO(os,r.stateNode));break;case 4:n=os,o=lu,os=r.stateNode.containerInfo,lu=!0,Fd(e,t,r),os=n,lu=o;break;case 0:case 11:case 14:case 15:if(!As&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var u=o,d=u.destroy;u=u.tag,d!==void 0&&(u&2||u&4)&&LR(r,t,d),o=o.next}while(o!==n)}Fd(e,t,r);break;case 1:if(!As&&(Z_(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(i){Ya(r,t,i)}Fd(e,t,r);break;case 21:Fd(e,t,r);break;case 22:r.mode&1?(As=(n=As)||r.memoizedState!==null,Fd(e,t,r),As=n):Fd(e,t,r);break;default:Fd(e,t,r)}}function y8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Yoe),t.forEach(function(n){var o=ose.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function eu(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var u=e,d=t,i=d;e:for(;i!==null;){switch(i.tag){case 5:os=i.stateNode,lu=!1;break e;case 3:os=i.stateNode.containerInfo,lu=!0;break e;case 4:os=i.stateNode.containerInfo,lu=!0;break e}i=i.return}if(os===null)throw Error(Cr(160));GG(u,d,o),os=null,lu=!1;var v=o.alternate;v!==null&&(v.return=null),o.return=null}catch(w){Ya(o,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)HG(t,e),t=t.sibling}function HG(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(eu(t,e),rh(e),n&4){try{dw(3,e,e.return),WC(3,e)}catch(R){Ya(e,e.return,R)}try{dw(5,e,e.return)}catch(R){Ya(e,e.return,R)}}break;case 1:eu(t,e),rh(e),n&512&&r!==null&&Z_(r,r.return);break;case 5:if(eu(t,e),rh(e),n&512&&r!==null&&Z_(r,r.return),e.flags&32){var o=e.stateNode;try{Mw(o,"")}catch(R){Ya(e,e.return,R)}}if(n&4&&(o=e.stateNode,o!=null)){var u=e.memoizedProps,d=r!==null?r.memoizedProps:u,i=e.type,v=e.updateQueue;if(e.updateQueue=null,v!==null)try{i==="input"&&u.type==="radio"&&u.name!=null&&pW(o,u),cR(i,d);var w=cR(i,u);for(d=0;d<v.length;d+=2){var S=v[d],C=v[d+1];S==="style"?vW(o,C):S==="dangerouslySetInnerHTML"?_W(o,C):S==="children"?Mw(o,C):rF(o,S,C,w)}switch(i){case"input":iR(o,u);break;case"textarea":mW(o,u);break;case"select":var k=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!u.multiple;var O=u.value;O!=null?ry(o,!!u.multiple,O,!1):k!==!!u.multiple&&(u.defaultValue!=null?ry(o,!!u.multiple,u.defaultValue,!0):ry(o,!!u.multiple,u.multiple?[]:"",!1))}o[Uw]=u}catch(R){Ya(e,e.return,R)}}break;case 6:if(eu(t,e),rh(e),n&4){if(e.stateNode===null)throw Error(Cr(162));o=e.stateNode,u=e.memoizedProps;try{o.nodeValue=u}catch(R){Ya(e,e.return,R)}}break;case 3:if(eu(t,e),rh(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Lw(t.containerInfo)}catch(R){Ya(e,e.return,R)}break;case 4:eu(t,e),rh(e);break;case 13:eu(t,e),rh(e),o=e.child,o.flags&8192&&(u=o.memoizedState!==null,o.stateNode.isHidden=u,!u||o.alternate!==null&&o.alternate.memoizedState!==null||(FF=so())),n&4&&y8(e);break;case 22:if(S=r!==null&&r.memoizedState!==null,e.mode&1?(As=(w=As)||S,eu(t,e),As=w):eu(t,e),rh(e),n&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!S&&e.mode&1)for(ln=e,S=e.child;S!==null;){for(C=ln=S;ln!==null;){switch(k=ln,O=k.child,k.tag){case 0:case 11:case 14:case 15:dw(4,k,k.return);break;case 1:Z_(k,k.return);var L=k.stateNode;if(typeof L.componentWillUnmount=="function"){n=k,r=k.return;try{t=n,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(R){Ya(n,r,R)}}break;case 5:Z_(k,k.return);break;case 22:if(k.memoizedState!==null){x8(C);continue}}O!==null?(O.return=k,ln=O):x8(C)}S=S.sibling}e:for(S=null,C=e;;){if(C.tag===5){if(S===null){S=C;try{o=C.stateNode,w?(u=o.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(i=C.stateNode,v=C.memoizedProps.style,d=v!=null&&v.hasOwnProperty("display")?v.display:null,i.style.display=yW("display",d))}catch(R){Ya(e,e.return,R)}}}else if(C.tag===6){if(S===null)try{C.stateNode.nodeValue=w?"":C.memoizedProps}catch(R){Ya(e,e.return,R)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;S===C&&(S=null),C=C.return}S===C&&(S=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:eu(t,e),rh(e),n&4&&y8(e);break;case 21:break;default:eu(t,e),rh(e)}}function rh(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(WG(r)){var n=r;break e}r=r.return}throw Error(Cr(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(Mw(o,""),n.flags&=-33);var u=_8(e);zR(e,u,o);break;case 3:case 4:var d=n.stateNode.containerInfo,i=_8(e);BR(e,i,d);break;default:throw Error(Cr(161))}}catch(v){Ya(e,e.return,v)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Joe(e,t,r){ln=e,qG(e)}function qG(e,t,r){for(var n=(e.mode&1)!==0;ln!==null;){var o=ln,u=o.child;if(o.tag===22&&n){var d=o.memoizedState!==null||NS;if(!d){var i=o.alternate,v=i!==null&&i.memoizedState!==null||As;i=NS;var w=As;if(NS=d,(As=v)&&!w)for(ln=o;ln!==null;)d=ln,v=d.child,d.tag===22&&d.memoizedState!==null?w8(o):v!==null?(v.return=d,ln=v):w8(o);for(;u!==null;)ln=u,qG(u),u=u.sibling;ln=o,NS=i,As=w}v8(e)}else o.subtreeFlags&8772&&u!==null?(u.return=o,ln=u):v8(e)}}function v8(e){for(;ln!==null;){var t=ln;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:As||WC(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!As)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:iu(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&n8(t,u,n);break;case 3:var d=t.updateQueue;if(d!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}n8(t,d,r)}break;case 5:var i=t.stateNode;if(r===null&&t.flags&4){r=i;var v=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&r.focus();break;case"img":v.src&&(r.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var S=w.memoizedState;if(S!==null){var C=S.dehydrated;C!==null&&Lw(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Cr(163))}As||t.flags&512&&NR(t)}catch(k){Ya(t,t.return,k)}}if(t===e){ln=null;break}if(r=t.sibling,r!==null){r.return=t.return,ln=r;break}ln=t.return}}function x8(e){for(;ln!==null;){var t=ln;if(t===e){ln=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ln=r;break}ln=t.return}}function w8(e){for(;ln!==null;){var t=ln;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{WC(4,t)}catch(v){Ya(t,r,v)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(v){Ya(t,o,v)}}var u=t.return;try{NR(t)}catch(v){Ya(t,u,v)}break;case 5:var d=t.return;try{NR(t)}catch(v){Ya(t,d,v)}}}catch(v){Ya(t,t.return,v)}if(t===e){ln=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ln=i;break}ln=t.return}}var Qoe=Math.ceil,aA=zf.ReactCurrentDispatcher,RF=zf.ReactCurrentOwner,kc=zf.ReactCurrentBatchConfig,Mi=0,Jo=null,xo=null,us=0,Bl=0,Y_=Op(0),Do=0,qw=null,p0=0,GC=0,DF=0,pw=null,cl=null,FF=0,Dy=1/0,df=null,oA=!1,jR=null,dp=null,BS=!1,ep=null,sA=0,mw=0,UR=null,IE=-1,kE=0;function el(){return Mi&6?so():IE!==-1?IE:IE=so()}function pp(e){return e.mode&1?Mi&2&&us!==0?us&-us:Loe.transition!==null?(kE===0&&(kE=OW()),kE):(e=Ji,e!==0||(e=window.event,e=e===void 0?16:BW(e.type)),e):1}function vu(e,t,r,n){if(50<mw)throw mw=0,UR=null,Error(Cr(185));Kb(e,r,n),(!(Mi&2)||e!==Jo)&&(e===Jo&&(!(Mi&2)&&(GC|=r),Do===4&&Hd(e,us)),pl(e,n),r===1&&Mi===0&&!(t.mode&1)&&(Dy=so()+500,UC&&Mp()))}function pl(e,t){var r=e.callbackNode;Lae(e,t);var n=WE(e,e===Jo?us:0);if(n===0)r!==null&&k6(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&k6(r),t===1)e.tag===0?Foe(b8.bind(null,e)):nG(b8.bind(null,e)),Ooe(function(){!(Mi&6)&&Mp()}),r=null;else{switch(MW(n)){case 1:r=sF;break;case 4:r=IW;break;case 16:r=VE;break;case 536870912:r=kW;break;default:r=VE}r=tH(r,XG.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function XG(e,t){if(IE=-1,kE=0,Mi&6)throw Error(Cr(327));var r=e.callbackNode;if(sy()&&e.callbackNode!==r)return null;var n=WE(e,e===Jo?us:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=lA(e,n);else{t=n;var o=Mi;Mi|=2;var u=YG();(Jo!==e||us!==t)&&(df=null,Dy=so()+500,t0(e,t));do try{rse();break}catch(i){ZG(e,i)}while(!0);xF(),aA.current=u,Mi=o,xo!==null?t=0:(Jo=null,us=0,t=Do)}if(t!==0){if(t===2&&(o=pR(e),o!==0&&(n=o,t=$R(e,o))),t===1)throw r=qw,t0(e,0),Hd(e,n),pl(e,so()),r;if(t===6)Hd(e,n);else{if(o=e.current.alternate,!(n&30)&&!ese(o)&&(t=lA(e,n),t===2&&(u=pR(e),u!==0&&(n=u,t=$R(e,u))),t===1))throw r=qw,t0(e,0),Hd(e,n),pl(e,so()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(Cr(345));case 2:Lm(e,cl,df);break;case 3:if(Hd(e,n),(n&130023424)===n&&(t=FF+500-so(),10<t)){if(WE(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){el(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=bR(Lm.bind(null,e,cl,df),t);break}Lm(e,cl,df);break;case 4:if(Hd(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var d=31-yu(n);u=1<<d,d=t[d],d>o&&(o=d),n&=~u}if(n=o,n=so()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Qoe(n/1960))-n,10<n){e.timeoutHandle=bR(Lm.bind(null,e,cl,df),n);break}Lm(e,cl,df);break;case 5:Lm(e,cl,df);break;default:throw Error(Cr(329))}}}return pl(e,so()),e.callbackNode===r?XG.bind(null,e):null}function $R(e,t){var r=pw;return e.current.memoizedState.isDehydrated&&(t0(e,t).flags|=256),e=lA(e,t),e!==2&&(t=cl,cl=r,t!==null&&VR(t)),e}function VR(e){cl===null?cl=e:cl.push.apply(cl,e)}function ese(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],u=o.getSnapshot;o=o.value;try{if(!Tu(u(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hd(e,t){for(t&=~DF,t&=~GC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-yu(t),n=1<<r;e[r]=-1,t&=~n}}function b8(e){if(Mi&6)throw Error(Cr(327));sy();var t=WE(e,0);if(!(t&1))return pl(e,so()),null;var r=lA(e,t);if(e.tag!==0&&r===2){var n=pR(e);n!==0&&(t=n,r=$R(e,n))}if(r===1)throw r=qw,t0(e,0),Hd(e,t),pl(e,so()),r;if(r===6)throw Error(Cr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Lm(e,cl,df),pl(e,so()),null}function LF(e,t){var r=Mi;Mi|=1;try{return e(t)}finally{Mi=r,Mi===0&&(Dy=so()+500,UC&&Mp())}}function m0(e){ep!==null&&ep.tag===0&&!(Mi&6)&&sy();var t=Mi;Mi|=1;var r=kc.transition,n=Ji;try{if(kc.transition=null,Ji=1,e)return e()}finally{Ji=n,kc.transition=r,Mi=t,!(Mi&6)&&Mp()}}function NF(){Bl=Y_.current,ka(Y_)}function t0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,koe(r)),xo!==null)for(r=xo.return;r!==null;){var n=r;switch(_F(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ZE();break;case 3:My(),ka(fl),ka(Rs),AF();break;case 5:EF(n);break;case 4:My();break;case 13:ka($a);break;case 19:ka($a);break;case 10:wF(n.type._context);break;case 22:case 23:NF()}r=r.return}if(Jo=e,xo=e=mp(e.current,null),us=Bl=t,Do=0,qw=null,DF=GC=p0=0,cl=pw=null,Vm!==null){for(t=0;t<Vm.length;t++)if(r=Vm[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,u=r.pending;if(u!==null){var d=u.next;u.next=o,n.next=d}r.pending=n}Vm=null}return e}function ZG(e,t){do{var r=xo;try{if(xF(),AE.current=iA,nA){for(var n=Wa.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}nA=!1}if(d0=0,Xo=Mo=Wa=null,fw=!1,Ww=0,RF.current=null,r===null||r.return===null){Do=1,qw=t,xo=null;break}e:{var u=e,d=r.return,i=r,v=t;if(t=us,i.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var w=v,S=i,C=S.tag;if(!(S.mode&1)&&(C===0||C===11||C===15)){var k=S.alternate;k?(S.updateQueue=k.updateQueue,S.memoizedState=k.memoizedState,S.lanes=k.lanes):(S.updateQueue=null,S.memoizedState=null)}var O=c8(d);if(O!==null){O.flags&=-257,u8(O,d,i,u,t),O.mode&1&&l8(u,w,t),t=O,v=w;var L=t.updateQueue;if(L===null){var R=new Set;R.add(v),t.updateQueue=R}else L.add(v);break e}else{if(!(t&1)){l8(u,w,t),BF();break e}v=Error(Cr(426))}}else if(za&&i.mode&1){var N=c8(d);if(N!==null){!(N.flags&65536)&&(N.flags|=256),u8(N,d,i,u,t),yF(Ry(v,i));break e}}u=v=Ry(v,i),Do!==4&&(Do=2),pw===null?pw=[u]:pw.push(u),u=d;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var V=MG(u,v,t);r8(u,V);break e;case 1:i=v;var G=u.type,U=u.stateNode;if(!(u.flags&128)&&(typeof G.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(dp===null||!dp.has(U)))){u.flags|=65536,t&=-t,u.lanes|=t;var J=RG(u,i,t);r8(u,J);break e}}u=u.return}while(u!==null)}JG(r)}catch(Z){t=Z,xo===r&&r!==null&&(xo=r=r.return);continue}break}while(!0)}function YG(){var e=aA.current;return aA.current=iA,e===null?iA:e}function BF(){(Do===0||Do===3||Do===2)&&(Do=4),Jo===null||!(p0&268435455)&&!(GC&268435455)||Hd(Jo,us)}function lA(e,t){var r=Mi;Mi|=2;var n=YG();(Jo!==e||us!==t)&&(df=null,t0(e,t));do try{tse();break}catch(o){ZG(e,o)}while(!0);if(xF(),Mi=r,aA.current=n,xo!==null)throw Error(Cr(261));return Jo=null,us=0,Do}function tse(){for(;xo!==null;)KG(xo)}function rse(){for(;xo!==null&&!Cae();)KG(xo)}function KG(e){var t=eH(e.alternate,e,Bl);e.memoizedProps=e.pendingProps,t===null?JG(e):xo=t,RF.current=null}function JG(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Zoe(r,t),r!==null){r.flags&=32767,xo=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Do=6,xo=null;return}}else if(r=Xoe(r,t,Bl),r!==null){xo=r;return}if(t=t.sibling,t!==null){xo=t;return}xo=t=e}while(t!==null);Do===0&&(Do=5)}function Lm(e,t,r){var n=Ji,o=kc.transition;try{kc.transition=null,Ji=1,nse(e,t,r,n)}finally{kc.transition=o,Ji=n}return null}function nse(e,t,r,n){do sy();while(ep!==null);if(Mi&6)throw Error(Cr(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Cr(177));e.callbackNode=null,e.callbackPriority=0;var u=r.lanes|r.childLanes;if(Nae(e,u),e===Jo&&(xo=Jo=null,us=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||BS||(BS=!0,tH(VE,function(){return sy(),null})),u=(r.flags&15990)!==0,r.subtreeFlags&15990||u){u=kc.transition,kc.transition=null;var d=Ji;Ji=1;var i=Mi;Mi|=4,RF.current=null,Koe(e,r),HG(r,e),Toe(xR),GE=!!vR,xR=vR=null,e.current=r,Joe(r),Pae(),Mi=i,Ji=d,kc.transition=u}else e.current=r;if(BS&&(BS=!1,ep=e,sA=o),u=e.pendingLanes,u===0&&(dp=null),Oae(r.stateNode),pl(e,so()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(oA)throw oA=!1,e=jR,jR=null,e;return sA&1&&e.tag!==0&&sy(),u=e.pendingLanes,u&1?e===UR?mw++:(mw=0,UR=e):mw=0,Mp(),null}function sy(){if(ep!==null){var e=MW(sA),t=kc.transition,r=Ji;try{if(kc.transition=null,Ji=16>e?16:e,ep===null)var n=!1;else{if(e=ep,ep=null,sA=0,Mi&6)throw Error(Cr(331));var o=Mi;for(Mi|=4,ln=e.current;ln!==null;){var u=ln,d=u.child;if(ln.flags&16){var i=u.deletions;if(i!==null){for(var v=0;v<i.length;v++){var w=i[v];for(ln=w;ln!==null;){var S=ln;switch(S.tag){case 0:case 11:case 15:dw(8,S,u)}var C=S.child;if(C!==null)C.return=S,ln=C;else for(;ln!==null;){S=ln;var k=S.sibling,O=S.return;if(VG(S),S===w){ln=null;break}if(k!==null){k.return=O,ln=k;break}ln=O}}}var L=u.alternate;if(L!==null){var R=L.child;if(R!==null){L.child=null;do{var N=R.sibling;R.sibling=null,R=N}while(R!==null)}}ln=u}}if(u.subtreeFlags&2064&&d!==null)d.return=u,ln=d;else e:for(;ln!==null;){if(u=ln,u.flags&2048)switch(u.tag){case 0:case 11:case 15:dw(9,u,u.return)}var V=u.sibling;if(V!==null){V.return=u.return,ln=V;break e}ln=u.return}}var G=e.current;for(ln=G;ln!==null;){d=ln;var U=d.child;if(d.subtreeFlags&2064&&U!==null)U.return=d,ln=U;else e:for(d=G;ln!==null;){if(i=ln,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:WC(9,i)}}catch(Z){Ya(i,i.return,Z)}if(i===d){ln=null;break e}var J=i.sibling;if(J!==null){J.return=i.return,ln=J;break e}ln=i.return}}if(Mi=o,Mp(),yh&&typeof yh.onPostCommitFiberRoot=="function")try{yh.onPostCommitFiberRoot(LC,e)}catch{}n=!0}return n}finally{Ji=r,kc.transition=t}}return!1}function T8(e,t,r){t=Ry(r,t),t=MG(e,t,1),e=fp(e,t,1),t=el(),e!==null&&(Kb(e,1,t),pl(e,t))}function Ya(e,t,r){if(e.tag===3)T8(e,e,r);else for(;t!==null;){if(t.tag===3){T8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(dp===null||!dp.has(n))){e=Ry(r,e),e=RG(t,e,1),t=fp(t,e,1),e=el(),t!==null&&(Kb(t,1,e),pl(t,e));break}}t=t.return}}function ise(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&r,Jo===e&&(us&r)===r&&(Do===4||Do===3&&(us&130023424)===us&&500>so()-FF?t0(e,0):DF|=r),pl(e,t)}function QG(e,t){t===0&&(e.mode&1?(t=PS,PS<<=1,!(PS&130023424)&&(PS=4194304)):t=1);var r=el();e=Of(e,t),e!==null&&(Kb(e,t,r),pl(e,r))}function ase(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),QG(e,r)}function ose(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Cr(314))}n!==null&&n.delete(t),QG(e,r)}var eH;eH=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fl.current)ul=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ul=!1,qoe(e,t,r);ul=!!(e.flags&131072)}else ul=!1,za&&t.flags&1048576&&iG(t,JE,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;PE(e,t),e=t.pendingProps;var o=Iy(t,Rs.current);oy(t,r),o=PF(null,t,n,e,o,r);var u=IF();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dl(n)?(u=!0,YE(t)):u=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,TF(t),o.updater=VC,t.stateNode=o,o._reactInternals=t,IR(t,n,e,r),t=MR(null,t,n,!0,u,r)):(t.tag=0,za&&u&&gF(t),Zs(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(PE(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=lse(n),e=iu(n,e),o){case 0:t=OR(null,t,n,e,r);break e;case 1:t=d8(null,t,n,e,r);break e;case 11:t=h8(null,t,n,e,r);break e;case 14:t=f8(null,t,n,iu(n.type,e),r);break e}throw Error(Cr(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:iu(n,o),OR(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:iu(n,o),d8(e,t,n,o,r);case 3:e:{if(NG(t),e===null)throw Error(Cr(387));n=t.pendingProps,u=t.memoizedState,o=u.element,uG(e,t),tA(t,n,null,r);var d=t.memoizedState;if(n=d.element,u.isDehydrated)if(u={element:n,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){o=Ry(Error(Cr(423)),t),t=p8(e,t,n,r,o);break e}else if(n!==o){o=Ry(Error(Cr(424)),t),t=p8(e,t,n,r,o);break e}else for(Gl=hp(t.stateNode.containerInfo.firstChild),Hl=t,za=!0,hu=null,r=lG(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ky(),n===o){t=Mf(e,t,r);break e}Zs(e,t,n,r)}t=t.child}return t;case 5:return hG(t),e===null&&AR(t),n=t.type,o=t.pendingProps,u=e!==null?e.memoizedProps:null,d=o.children,wR(n,o)?d=null:u!==null&&wR(n,u)&&(t.flags|=32),LG(e,t),Zs(e,t,d,r),t.child;case 6:return e===null&&AR(t),null;case 13:return BG(e,t,r);case 4:return SF(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Oy(t,null,n,r):Zs(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:iu(n,o),h8(e,t,n,o,r);case 7:return Zs(e,t,t.pendingProps,r),t.child;case 8:return Zs(e,t,t.pendingProps.children,r),t.child;case 12:return Zs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,u=t.memoizedProps,d=o.value,xa(QE,n._currentValue),n._currentValue=d,u!==null)if(Tu(u.value,d)){if(u.children===o.children&&!fl.current){t=Mf(e,t,r);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var i=u.dependencies;if(i!==null){d=u.child;for(var v=i.firstContext;v!==null;){if(v.context===n){if(u.tag===1){v=bf(-1,r&-r),v.tag=2;var w=u.updateQueue;if(w!==null){w=w.shared;var S=w.pending;S===null?v.next=v:(v.next=S.next,S.next=v),w.pending=v}}u.lanes|=r,v=u.alternate,v!==null&&(v.lanes|=r),CR(u.return,r,t),i.lanes|=r;break}v=v.next}}else if(u.tag===10)d=u.type===t.type?null:u.child;else if(u.tag===18){if(d=u.return,d===null)throw Error(Cr(341));d.lanes|=r,i=d.alternate,i!==null&&(i.lanes|=r),CR(d,r,t),d=u.sibling}else d=u.child;if(d!==null)d.return=u;else for(d=u;d!==null;){if(d===t){d=null;break}if(u=d.sibling,u!==null){u.return=d.return,d=u;break}d=d.return}u=d}Zs(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,oy(t,r),o=Dc(o),n=n(o),t.flags|=1,Zs(e,t,n,r),t.child;case 14:return n=t.type,o=iu(n,t.pendingProps),o=iu(n.type,o),f8(e,t,n,o,r);case 15:return DG(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:iu(n,o),PE(e,t),t.tag=1,dl(n)?(e=!0,YE(t)):e=!1,oy(t,r),OG(t,n,o),IR(t,n,o,r),MR(null,t,n,!0,e,r);case 19:return zG(e,t,r);case 22:return FG(e,t,r)}throw Error(Cr(156,t.tag))};function tH(e,t){return PW(e,t)}function sse(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,r,n){return new sse(e,t,r,n)}function zF(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lse(e){if(typeof e=="function")return zF(e)?1:0;if(e!=null){if(e=e.$$typeof,e===iF)return 11;if(e===aF)return 14}return 2}function mp(e,t){var r=e.alternate;return r===null?(r=Ac(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function OE(e,t,r,n,o,u){var d=2;if(n=e,typeof e=="function")zF(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case j_:return r0(r.children,o,u,t);case nF:d=8,o|=8;break;case QM:return e=Ac(12,r,t,o|2),e.elementType=QM,e.lanes=u,e;case eR:return e=Ac(13,r,t,o),e.elementType=eR,e.lanes=u,e;case tR:return e=Ac(19,r,t,o),e.elementType=tR,e.lanes=u,e;case hW:return HC(r,o,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case cW:d=10;break e;case uW:d=9;break e;case iF:d=11;break e;case aF:d=14;break e;case $d:d=16,n=null;break e}throw Error(Cr(130,e==null?e:typeof e,""))}return t=Ac(d,r,t,o),t.elementType=e,t.type=n,t.lanes=u,t}function r0(e,t,r,n){return e=Ac(7,e,n,t),e.lanes=r,e}function HC(e,t,r,n){return e=Ac(22,e,n,t),e.elementType=hW,e.lanes=r,e.stateNode={isHidden:!1},e}function UO(e,t,r){return e=Ac(6,e,null,t),e.lanes=r,e}function $O(e,t,r){return t=Ac(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function cse(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bO(0),this.expirationTimes=bO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bO(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function jF(e,t,r,n,o,u,d,i,v){return e=new cse(e,t,r,i,v),t===1?(t=1,u===!0&&(t|=8)):t=0,u=Ac(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},TF(u),e}function use(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z_,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function rH(e){if(!e)return bp;e=e._reactInternals;e:{if(D0(e)!==e||e.tag!==1)throw Error(Cr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Cr(171))}if(e.tag===1){var r=e.type;if(dl(r))return rG(e,r,t)}return t}function nH(e,t,r,n,o,u,d,i,v){return e=jF(r,n,!0,e,o,u,d,i,v),e.context=rH(null),r=e.current,n=el(),o=pp(r),u=bf(n,o),u.callback=t??null,fp(r,u,o),e.current.lanes=o,Kb(e,o,n),pl(e,n),e}function qC(e,t,r,n){var o=t.current,u=el(),d=pp(o);return r=rH(r),t.context===null?t.context=r:t.pendingContext=r,t=bf(u,d),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=fp(o,t,d),e!==null&&(vu(e,o,d,u),EE(e,o,d)),d}function cA(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function S8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function UF(e,t){S8(e,t),(e=e.alternate)&&S8(e,t)}function hse(){return null}var iH=typeof reportError=="function"?reportError:function(e){console.error(e)};function $F(e){this._internalRoot=e}XC.prototype.render=$F.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Cr(409));qC(e,t,null,null)};XC.prototype.unmount=$F.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;m0(function(){qC(null,e,null,null)}),t[kf]=null}};function XC(e){this._internalRoot=e}XC.prototype.unstable_scheduleHydration=function(e){if(e){var t=FW();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gd.length&&t!==0&&t<Gd[r].priority;r++);Gd.splice(r,0,e),r===0&&NW(e)}};function VF(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ZC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function E8(){}function fse(e,t,r,n,o){if(o){if(typeof n=="function"){var u=n;n=function(){var w=cA(d);u.call(w)}}var d=nH(t,n,e,0,null,!1,!1,"",E8);return e._reactRootContainer=d,e[kf]=d.current,zw(e.nodeType===8?e.parentNode:e),m0(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var i=n;n=function(){var w=cA(v);i.call(w)}}var v=jF(e,0,!1,null,null,!1,!1,"",E8);return e._reactRootContainer=v,e[kf]=v.current,zw(e.nodeType===8?e.parentNode:e),m0(function(){qC(t,v,r,n)}),v}function YC(e,t,r,n,o){var u=r._reactRootContainer;if(u){var d=u;if(typeof o=="function"){var i=o;o=function(){var v=cA(d);i.call(v)}}qC(t,d,e,o)}else d=fse(r,t,e,o,n);return cA(d)}RW=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ew(t.pendingLanes);r!==0&&(lF(t,r|1),pl(t,so()),!(Mi&6)&&(Dy=so()+500,Mp()))}break;case 13:m0(function(){var n=Of(e,1);if(n!==null){var o=el();vu(n,e,1,o)}}),UF(e,1)}};cF=function(e){if(e.tag===13){var t=Of(e,134217728);if(t!==null){var r=el();vu(t,e,134217728,r)}UF(e,134217728)}};DW=function(e){if(e.tag===13){var t=pp(e),r=Of(e,t);if(r!==null){var n=el();vu(r,e,t,n)}UF(e,t)}};FW=function(){return Ji};LW=function(e,t){var r=Ji;try{return Ji=e,t()}finally{Ji=r}};hR=function(e,t,r){switch(t){case"input":if(iR(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=jC(n);if(!o)throw Error(Cr(90));dW(n),iR(n,o)}}}break;case"textarea":mW(e,r);break;case"select":t=r.value,t!=null&&ry(e,!!r.multiple,t,!1)}};bW=LF;TW=m0;var dse={usingClientEntryPoint:!1,Events:[Qb,W_,jC,xW,wW,LF]},D1={findFiberByHostInstance:$m,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pse={bundleType:D1.bundleType,version:D1.version,rendererPackageName:D1.rendererPackageName,rendererConfig:D1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=AW(e),e===null?null:e.stateNode},findFiberByHostInstance:D1.findFiberByHostInstance||hse,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zS.isDisabled&&zS.supportsFiber)try{LC=zS.inject(pse),yh=zS}catch{}}Ql.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dse;Ql.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!VF(t))throw Error(Cr(200));return use(e,t,null,r)};Ql.createRoot=function(e,t){if(!VF(e))throw Error(Cr(299));var r=!1,n="",o=iH;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=jF(e,1,!1,null,null,r,!1,n,o),e[kf]=t.current,zw(e.nodeType===8?e.parentNode:e),new $F(t)};Ql.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Cr(188)):(e=Object.keys(e).join(","),Error(Cr(268,e)));return e=AW(t),e=e===null?null:e.stateNode,e};Ql.flushSync=function(e){return m0(e)};Ql.hydrate=function(e,t,r){if(!ZC(t))throw Error(Cr(200));return YC(null,e,t,!0,r)};Ql.hydrateRoot=function(e,t,r){if(!VF(e))throw Error(Cr(405));var n=r!=null&&r.hydratedSources||null,o=!1,u="",d=iH;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),t=nH(t,null,e,1,r??null,o,!1,u,d),e[kf]=t.current,zw(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new XC(t)};Ql.render=function(e,t,r){if(!ZC(t))throw Error(Cr(200));return YC(null,e,t,!1,r)};Ql.unmountComponentAtNode=function(e){if(!ZC(e))throw Error(Cr(40));return e._reactRootContainer?(m0(function(){YC(null,null,e,!1,function(){e._reactRootContainer=null,e[kf]=null})}),!0):!1};Ql.unstable_batchedUpdates=LF;Ql.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ZC(r))throw Error(Cr(200));if(e==null||e._reactInternals===void 0)throw Error(Cr(38));return YC(e,t,r,!1,n)};Ql.version="18.3.1-next-f1338f8080-20240426";function aH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aH)}catch(e){console.error(e)}}aH(),aW.exports=Ql;var t2=aW.exports;const oH=Qi(t2);var sH,A8=t2;sH=A8.createRoot,A8.hydrateRoot;const mse=1,gse=1e6;let VO=0;function _se(){return VO=(VO+1)%Number.MAX_SAFE_INTEGER,VO.toString()}const WO=new Map,C8=e=>{if(WO.has(e))return;const t=setTimeout(()=>{WO.delete(e),gw({type:"REMOVE_TOAST",toastId:e})},gse);WO.set(e,t)},yse=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,mse)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?C8(r):e.toasts.forEach(n=>{C8(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},ME=[];let RE={toasts:[]};function gw(e){RE=yse(RE,e),ME.forEach(t=>{t(RE)})}function vse({...e}){const t=_se(),r=o=>gw({type:"UPDATE_TOAST",toast:{...o,id:t}}),n=()=>gw({type:"DISMISS_TOAST",toastId:t});return gw({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||n()}}}),{id:t,dismiss:n,update:r}}function r2(){const[e,t]=ue.useState(RE);return ue.useEffect(()=>(ME.push(t),()=>{const r=ME.indexOf(t);r>-1&&ME.splice(r,1)}),[e]),{...e,toast:vse,dismiss:r=>gw({type:"DISMISS_TOAST",toastId:r})}}function Bi(e,t,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e==null||e(o),r===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function P8(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function g0(...e){return t=>{let r=!1;const n=e.map(o=>{const u=P8(o,t);return!r&&typeof u=="function"&&(r=!0),u});if(r)return()=>{for(let o=0;o<n.length;o++){const u=n[o];typeof u=="function"?u():P8(e[o],null)}}}}function bo(...e){return ue.useCallback(g0(...e),e)}function xse(e,t){const r=ue.createContext(t),n=u=>{const{children:d,...i}=u,v=ue.useMemo(()=>i,Object.values(i));return be.jsx(r.Provider,{value:v,children:d})};n.displayName=e+"Provider";function o(u){const d=ue.useContext(r);if(d)return d;if(t!==void 0)return t;throw new Error(`\`${u}\` must be used within \`${e}\``)}return[n,o]}function Rp(e,t=[]){let r=[];function n(u,d){const i=ue.createContext(d),v=r.length;r=[...r,d];const w=C=>{var V;const{scope:k,children:O,...L}=C,R=((V=k==null?void 0:k[e])==null?void 0:V[v])||i,N=ue.useMemo(()=>L,Object.values(L));return be.jsx(R.Provider,{value:N,children:O})};w.displayName=u+"Provider";function S(C,k){var R;const O=((R=k==null?void 0:k[e])==null?void 0:R[v])||i,L=ue.useContext(O);if(L)return L;if(d!==void 0)return d;throw new Error(`\`${C}\` must be used within \`${u}\``)}return[w,S]}const o=()=>{const u=r.map(d=>ue.createContext(d));return function(i){const v=(i==null?void 0:i[e])||u;return ue.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return o.scopeName=e,[n,wse(o,...t)]}function wse(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(u){const d=n.reduce((i,{useScope:v,scopeName:w})=>{const C=v(u)[`__scope${w}`];return{...i,...C}},{});return ue.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}function Fy(e){const t=Tse(e),r=ue.forwardRef((n,o)=>{const{children:u,...d}=n,i=ue.Children.toArray(u),v=i.find(Ese);if(v){const w=v.props.children,S=i.map(C=>C===v?ue.Children.count(w)>1?ue.Children.only(null):ue.isValidElement(w)?w.props.children:null:C);return be.jsx(t,{...d,ref:o,children:ue.isValidElement(w)?ue.cloneElement(w,void 0,S):null})}return be.jsx(t,{...d,ref:o,children:u})});return r.displayName=`${e}.Slot`,r}var bse=Fy("Slot");function Tse(e){const t=ue.forwardRef((r,n)=>{const{children:o,...u}=r;if(ue.isValidElement(o)){const d=Cse(o),i=Ase(u,o.props);return o.type!==ue.Fragment&&(i.ref=n?g0(n,d):d),ue.cloneElement(o,i)}return ue.Children.count(o)>1?ue.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var lH=Symbol("radix.slottable");function Sse(e){const t=({children:r})=>be.jsx(be.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=lH,t}function Ese(e){return ue.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===lH}function Ase(e,t){const r={...t};for(const n in t){const o=e[n],u=t[n];/^on[A-Z]/.test(n)?o&&u?r[n]=(...i)=>{const v=u(...i);return o(...i),v}:o&&(r[n]=o):n==="style"?r[n]={...o,...u}:n==="className"&&(r[n]=[o,u].filter(Boolean).join(" "))}return{...e,...r}}function Cse(e){var n,o;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Pse(e){const t=e+"CollectionProvider",[r,n]=Rp(t),[o,u]=r(t,{collectionRef:{current:null},itemMap:new Map}),d=R=>{const{scope:N,children:V}=R,G=it.useRef(null),U=it.useRef(new Map).current;return be.jsx(o,{scope:N,itemMap:U,collectionRef:G,children:V})};d.displayName=t;const i=e+"CollectionSlot",v=Fy(i),w=it.forwardRef((R,N)=>{const{scope:V,children:G}=R,U=u(i,V),J=bo(N,U.collectionRef);return be.jsx(v,{ref:J,children:G})});w.displayName=i;const S=e+"CollectionItemSlot",C="data-radix-collection-item",k=Fy(S),O=it.forwardRef((R,N)=>{const{scope:V,children:G,...U}=R,J=it.useRef(null),Z=bo(N,J),K=u(S,V);return it.useEffect(()=>(K.itemMap.set(J,{ref:J,...U}),()=>void K.itemMap.delete(J))),be.jsx(k,{[C]:"",ref:Z,children:G})});O.displayName=S;function L(R){const N=u(e+"CollectionConsumer",R);return it.useCallback(()=>{const G=N.collectionRef.current;if(!G)return[];const U=Array.from(G.querySelectorAll(`[${C}]`));return Array.from(N.itemMap.values()).sort((K,re)=>U.indexOf(K.ref.current)-U.indexOf(re.ref.current))},[N.collectionRef,N.itemMap])}return[{Provider:d,Slot:w,ItemSlot:O},L,n]}var Ise=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],yi=Ise.reduce((e,t)=>{const r=Fy(`Primitive.${t}`),n=ue.forwardRef((o,u)=>{const{asChild:d,...i}=o,v=d?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),be.jsx(v,{...i,ref:u})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function cH(e,t){e&&t2.flushSync(()=>e.dispatchEvent(t))}function Sh(e){const t=ue.useRef(e);return ue.useEffect(()=>{t.current=e}),ue.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function kse(e,t=globalThis==null?void 0:globalThis.document){const r=Sh(e);ue.useEffect(()=>{const n=o=>{o.key==="Escape"&&r(o)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Ose="DismissableLayer",WR="dismissableLayer.update",Mse="dismissableLayer.pointerDownOutside",Rse="dismissableLayer.focusOutside",I8,uH=ue.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),n2=ue.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:u,onInteractOutside:d,onDismiss:i,...v}=e,w=ue.useContext(uH),[S,C]=ue.useState(null),k=(S==null?void 0:S.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,O]=ue.useState({}),L=bo(t,re=>C(re)),R=Array.from(w.layers),[N]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),V=R.indexOf(N),G=S?R.indexOf(S):-1,U=w.layersWithOutsidePointerEventsDisabled.size>0,J=G>=V,Z=Fse(re=>{const ge=re.target,ve=[...w.branches].some($e=>$e.contains(ge));!J||ve||(o==null||o(re),d==null||d(re),re.defaultPrevented||i==null||i())},k),K=Lse(re=>{const ge=re.target;[...w.branches].some($e=>$e.contains(ge))||(u==null||u(re),d==null||d(re),re.defaultPrevented||i==null||i())},k);return kse(re=>{G===w.layers.size-1&&(n==null||n(re),!re.defaultPrevented&&i&&(re.preventDefault(),i()))},k),ue.useEffect(()=>{if(S)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(I8=k.body.style.pointerEvents,k.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(S)),w.layers.add(S),k8(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(k.body.style.pointerEvents=I8)}},[S,k,r,w]),ue.useEffect(()=>()=>{S&&(w.layers.delete(S),w.layersWithOutsidePointerEventsDisabled.delete(S),k8())},[S,w]),ue.useEffect(()=>{const re=()=>O({});return document.addEventListener(WR,re),()=>document.removeEventListener(WR,re)},[]),be.jsx(yi.div,{...v,ref:L,style:{pointerEvents:U?J?"auto":"none":void 0,...e.style},onFocusCapture:Bi(e.onFocusCapture,K.onFocusCapture),onBlurCapture:Bi(e.onBlurCapture,K.onBlurCapture),onPointerDownCapture:Bi(e.onPointerDownCapture,Z.onPointerDownCapture)})});n2.displayName=Ose;var Dse="DismissableLayerBranch",hH=ue.forwardRef((e,t)=>{const r=ue.useContext(uH),n=ue.useRef(null),o=bo(t,n);return ue.useEffect(()=>{const u=n.current;if(u)return r.branches.add(u),()=>{r.branches.delete(u)}},[r.branches]),be.jsx(yi.div,{...e,ref:o})});hH.displayName=Dse;function Fse(e,t=globalThis==null?void 0:globalThis.document){const r=Sh(e),n=ue.useRef(!1),o=ue.useRef(()=>{});return ue.useEffect(()=>{const u=i=>{if(i.target&&!n.current){let v=function(){fH(Mse,r,w,{discrete:!0})};const w={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=v,t.addEventListener("click",o.current,{once:!0})):v()}else t.removeEventListener("click",o.current);n.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",u),t.removeEventListener("click",o.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Lse(e,t=globalThis==null?void 0:globalThis.document){const r=Sh(e),n=ue.useRef(!1);return ue.useEffect(()=>{const o=u=>{u.target&&!n.current&&fH(Rse,r,{originalEvent:u},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function k8(){const e=new CustomEvent(WR);document.dispatchEvent(e)}function fH(e,t,r,{discrete:n}){const o=r.originalEvent.target,u=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?cH(o,u):o.dispatchEvent(u)}var Nse=n2,Bse=hH,Eh=globalThis!=null&&globalThis.document?ue.useLayoutEffect:()=>{},zse="Portal",KC=ue.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[o,u]=ue.useState(!1);Eh(()=>u(!0),[]);const d=r||o&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return d?oH.createPortal(be.jsx(yi.div,{...n,ref:t}),d):null});KC.displayName=zse;function jse(e,t){return ue.useReducer((r,n)=>t[r][n]??r,e)}var Ih=e=>{const{present:t,children:r}=e,n=Use(t),o=typeof r=="function"?r({present:n.isPresent}):ue.Children.only(r),u=bo(n.ref,$se(o));return typeof r=="function"||n.isPresent?ue.cloneElement(o,{ref:u}):null};Ih.displayName="Presence";function Use(e){const[t,r]=ue.useState(),n=ue.useRef(null),o=ue.useRef(e),u=ue.useRef("none"),d=e?"mounted":"unmounted",[i,v]=jse(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return ue.useEffect(()=>{const w=jS(n.current);u.current=i==="mounted"?w:"none"},[i]),Eh(()=>{const w=n.current,S=o.current;if(S!==e){const k=u.current,O=jS(w);e?v("MOUNT"):O==="none"||(w==null?void 0:w.display)==="none"?v("UNMOUNT"):v(S&&k!==O?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,v]),Eh(()=>{if(t){let w;const S=t.ownerDocument.defaultView??window,C=O=>{const R=jS(n.current).includes(O.animationName);if(O.target===t&&R&&(v("ANIMATION_END"),!o.current)){const N=t.style.animationFillMode;t.style.animationFillMode="forwards",w=S.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=N)})}},k=O=>{O.target===t&&(u.current=jS(n.current))};return t.addEventListener("animationstart",k),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{S.clearTimeout(w),t.removeEventListener("animationstart",k),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else v("ANIMATION_END")},[t,v]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:ue.useCallback(w=>{n.current=w?getComputedStyle(w):null,r(w)},[])}}function jS(e){return(e==null?void 0:e.animationName)||"none"}function $se(e){var n,o;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Vse=QD[" useInsertionEffect ".trim().toString()]||Eh;function i2({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[o,u,d]=Wse({defaultProp:t,onChange:r}),i=e!==void 0,v=i?e:o;{const S=ue.useRef(e!==void 0);ue.useEffect(()=>{const C=S.current;C!==i&&console.warn(`${n} is changing from ${C?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),S.current=i},[i,n])}const w=ue.useCallback(S=>{var C;if(i){const k=Gse(S)?S(e):S;k!==e&&((C=d.current)==null||C.call(d,k))}else u(S)},[i,e,u,d]);return[v,w]}function Wse({defaultProp:e,onChange:t}){const[r,n]=ue.useState(e),o=ue.useRef(r),u=ue.useRef(t);return Vse(()=>{u.current=t},[t]),ue.useEffect(()=>{var d;o.current!==r&&((d=u.current)==null||d.call(u,r),o.current=r)},[r,o]),[r,n,u]}function Gse(e){return typeof e=="function"}var Hse=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qse="VisuallyHidden",JC=ue.forwardRef((e,t)=>be.jsx(yi.span,{...e,ref:t,style:{...Hse,...e.style}}));JC.displayName=qse;var Xse=JC,WF="ToastProvider",[GF,Zse,Yse]=Pse("Toast"),[dH,kqe]=Rp("Toast",[Yse]),[Kse,QC]=dH(WF),pH=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:o="right",swipeThreshold:u=50,children:d}=e,[i,v]=ue.useState(null),[w,S]=ue.useState(0),C=ue.useRef(!1),k=ue.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${WF}\`. Expected non-empty \`string\`.`),be.jsx(GF.Provider,{scope:t,children:be.jsx(Kse,{scope:t,label:r,duration:n,swipeDirection:o,swipeThreshold:u,toastCount:w,viewport:i,onViewportChange:v,onToastAdd:ue.useCallback(()=>S(O=>O+1),[]),onToastRemove:ue.useCallback(()=>S(O=>O-1),[]),isFocusedToastEscapeKeyDownRef:C,isClosePausedRef:k,children:d})})};pH.displayName=WF;var mH="ToastViewport",Jse=["F8"],GR="toast.viewportPause",HR="toast.viewportResume",gH=ue.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Jse,label:o="Notifications ({hotkey})",...u}=e,d=QC(mH,r),i=Zse(r),v=ue.useRef(null),w=ue.useRef(null),S=ue.useRef(null),C=ue.useRef(null),k=bo(t,C,d.onViewportChange),O=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=d.toastCount>0;ue.useEffect(()=>{const N=V=>{var U;n.length!==0&&n.every(J=>V[J]||V.code===J)&&((U=C.current)==null||U.focus())};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[n]),ue.useEffect(()=>{const N=v.current,V=C.current;if(L&&N&&V){const G=()=>{if(!d.isClosePausedRef.current){const K=new CustomEvent(GR);V.dispatchEvent(K),d.isClosePausedRef.current=!0}},U=()=>{if(d.isClosePausedRef.current){const K=new CustomEvent(HR);V.dispatchEvent(K),d.isClosePausedRef.current=!1}},J=K=>{!N.contains(K.relatedTarget)&&U()},Z=()=>{N.contains(document.activeElement)||U()};return N.addEventListener("focusin",G),N.addEventListener("focusout",J),N.addEventListener("pointermove",G),N.addEventListener("pointerleave",Z),window.addEventListener("blur",G),window.addEventListener("focus",U),()=>{N.removeEventListener("focusin",G),N.removeEventListener("focusout",J),N.removeEventListener("pointermove",G),N.removeEventListener("pointerleave",Z),window.removeEventListener("blur",G),window.removeEventListener("focus",U)}}},[L,d.isClosePausedRef]);const R=ue.useCallback(({tabbingDirection:N})=>{const G=i().map(U=>{const J=U.ref.current,Z=[J,...hle(J)];return N==="forwards"?Z:Z.reverse()});return(N==="forwards"?G.reverse():G).flat()},[i]);return ue.useEffect(()=>{const N=C.current;if(N){const V=G=>{var Z,K,re;const U=G.altKey||G.ctrlKey||G.metaKey;if(G.key==="Tab"&&!U){const ge=document.activeElement,ve=G.shiftKey;if(G.target===N&&ve){(Z=w.current)==null||Z.focus();return}const ke=R({tabbingDirection:ve?"backwards":"forwards"}),tt=ke.findIndex(Je=>Je===ge);GO(ke.slice(tt+1))?G.preventDefault():ve?(K=w.current)==null||K.focus():(re=S.current)==null||re.focus()}};return N.addEventListener("keydown",V),()=>N.removeEventListener("keydown",V)}},[i,R]),be.jsxs(Bse,{ref:v,role:"region","aria-label":o.replace("{hotkey}",O),tabIndex:-1,style:{pointerEvents:L?void 0:"none"},children:[L&&be.jsx(qR,{ref:w,onFocusFromOutsideViewport:()=>{const N=R({tabbingDirection:"forwards"});GO(N)}}),be.jsx(GF.Slot,{scope:r,children:be.jsx(yi.ol,{tabIndex:-1,...u,ref:k})}),L&&be.jsx(qR,{ref:S,onFocusFromOutsideViewport:()=>{const N=R({tabbingDirection:"backwards"});GO(N)}})]})});gH.displayName=mH;var _H="ToastFocusProxy",qR=ue.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...o}=e,u=QC(_H,r);return be.jsx(JC,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:d=>{var w;const i=d.relatedTarget;!((w=u.viewport)!=null&&w.contains(i))&&n()}})});qR.displayName=_H;var a2="Toast",Qse="toast.swipeStart",ele="toast.swipeMove",tle="toast.swipeCancel",rle="toast.swipeEnd",yH=ue.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:o,onOpenChange:u,...d}=e,[i,v]=i2({prop:n,defaultProp:o??!0,onChange:u,caller:a2});return be.jsx(Ih,{present:r||i,children:be.jsx(ale,{open:i,...d,ref:t,onClose:()=>v(!1),onPause:Sh(e.onPause),onResume:Sh(e.onResume),onSwipeStart:Bi(e.onSwipeStart,w=>{w.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Bi(e.onSwipeMove,w=>{const{x:S,y:C}=w.detail.delta;w.currentTarget.setAttribute("data-swipe","move"),w.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${S}px`),w.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${C}px`)}),onSwipeCancel:Bi(e.onSwipeCancel,w=>{w.currentTarget.setAttribute("data-swipe","cancel"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),w.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Bi(e.onSwipeEnd,w=>{const{x:S,y:C}=w.detail.delta;w.currentTarget.setAttribute("data-swipe","end"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),w.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${S}px`),w.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${C}px`),v(!1)})})})});yH.displayName=a2;var[nle,ile]=dH(a2,{onClose(){}}),ale=ue.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:o,open:u,onClose:d,onEscapeKeyDown:i,onPause:v,onResume:w,onSwipeStart:S,onSwipeMove:C,onSwipeCancel:k,onSwipeEnd:O,...L}=e,R=QC(a2,r),[N,V]=ue.useState(null),G=bo(t,Je=>V(Je)),U=ue.useRef(null),J=ue.useRef(null),Z=o||R.duration,K=ue.useRef(0),re=ue.useRef(Z),ge=ue.useRef(0),{onToastAdd:ve,onToastRemove:$e}=R,Ie=Sh(()=>{var et;(N==null?void 0:N.contains(document.activeElement))&&((et=R.viewport)==null||et.focus()),d()}),ke=ue.useCallback(Je=>{!Je||Je===1/0||(window.clearTimeout(ge.current),K.current=new Date().getTime(),ge.current=window.setTimeout(Ie,Je))},[Ie]);ue.useEffect(()=>{const Je=R.viewport;if(Je){const et=()=>{ke(re.current),w==null||w()},at=()=>{const pt=new Date().getTime()-K.current;re.current=re.current-pt,window.clearTimeout(ge.current),v==null||v()};return Je.addEventListener(GR,at),Je.addEventListener(HR,et),()=>{Je.removeEventListener(GR,at),Je.removeEventListener(HR,et)}}},[R.viewport,Z,v,w,ke]),ue.useEffect(()=>{u&&!R.isClosePausedRef.current&&ke(Z)},[u,Z,R.isClosePausedRef,ke]),ue.useEffect(()=>(ve(),()=>$e()),[ve,$e]);const tt=ue.useMemo(()=>N?EH(N):null,[N]);return R.viewport?be.jsxs(be.Fragment,{children:[tt&&be.jsx(ole,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:tt}),be.jsx(nle,{scope:r,onClose:Ie,children:t2.createPortal(be.jsx(GF.ItemSlot,{scope:r,children:be.jsx(Nse,{asChild:!0,onEscapeKeyDown:Bi(i,()=>{R.isFocusedToastEscapeKeyDownRef.current||Ie(),R.isFocusedToastEscapeKeyDownRef.current=!1}),children:be.jsx(yi.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":u?"open":"closed","data-swipe-direction":R.swipeDirection,...L,ref:G,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Bi(e.onKeyDown,Je=>{Je.key==="Escape"&&(i==null||i(Je.nativeEvent),Je.nativeEvent.defaultPrevented||(R.isFocusedToastEscapeKeyDownRef.current=!0,Ie()))}),onPointerDown:Bi(e.onPointerDown,Je=>{Je.button===0&&(U.current={x:Je.clientX,y:Je.clientY})}),onPointerMove:Bi(e.onPointerMove,Je=>{if(!U.current)return;const et=Je.clientX-U.current.x,at=Je.clientY-U.current.y,pt=!!J.current,ft=["left","right"].includes(R.swipeDirection),Ue=["left","up"].includes(R.swipeDirection)?Math.min:Math.max,It=ft?Ue(0,et):0,Rt=ft?0:Ue(0,at),_e=Je.pointerType==="touch"?10:2,Ge={x:It,y:Rt},qe={originalEvent:Je,delta:Ge};pt?(J.current=Ge,US(ele,C,qe,{discrete:!1})):O8(Ge,R.swipeDirection,_e)?(J.current=Ge,US(Qse,S,qe,{discrete:!1}),Je.target.setPointerCapture(Je.pointerId)):(Math.abs(et)>_e||Math.abs(at)>_e)&&(U.current=null)}),onPointerUp:Bi(e.onPointerUp,Je=>{const et=J.current,at=Je.target;if(at.hasPointerCapture(Je.pointerId)&&at.releasePointerCapture(Je.pointerId),J.current=null,U.current=null,et){const pt=Je.currentTarget,ft={originalEvent:Je,delta:et};O8(et,R.swipeDirection,R.swipeThreshold)?US(rle,O,ft,{discrete:!0}):US(tle,k,ft,{discrete:!0}),pt.addEventListener("click",Ue=>Ue.preventDefault(),{once:!0})}})})})}),R.viewport)})]}):null}),ole=e=>{const{__scopeToast:t,children:r,...n}=e,o=QC(a2,t),[u,d]=ue.useState(!1),[i,v]=ue.useState(!1);return cle(()=>d(!0)),ue.useEffect(()=>{const w=window.setTimeout(()=>v(!0),1e3);return()=>window.clearTimeout(w)},[]),i?null:be.jsx(KC,{asChild:!0,children:be.jsx(JC,{...n,children:u&&be.jsxs(be.Fragment,{children:[o.label," ",r]})})})},sle="ToastTitle",vH=ue.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return be.jsx(yi.div,{...n,ref:t})});vH.displayName=sle;var lle="ToastDescription",xH=ue.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return be.jsx(yi.div,{...n,ref:t})});xH.displayName=lle;var wH="ToastAction",bH=ue.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?be.jsx(SH,{altText:r,asChild:!0,children:be.jsx(HF,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${wH}\`. Expected non-empty \`string\`.`),null)});bH.displayName=wH;var TH="ToastClose",HF=ue.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,o=ile(TH,r);return be.jsx(SH,{asChild:!0,children:be.jsx(yi.button,{type:"button",...n,ref:t,onClick:Bi(e.onClick,o.onClose)})})});HF.displayName=TH;var SH=ue.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...o}=e;return be.jsx(yi.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...o,ref:t})});function EH(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),ule(n)){const o=n.ariaHidden||n.hidden||n.style.display==="none",u=n.dataset.radixToastAnnounceExclude==="";if(!o)if(u){const d=n.dataset.radixToastAnnounceAlt;d&&t.push(d)}else t.push(...EH(n))}}),t}function US(e,t,r,{discrete:n}){const o=r.originalEvent.currentTarget,u=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?cH(o,u):o.dispatchEvent(u)}var O8=(e,t,r=0)=>{const n=Math.abs(e.x),o=Math.abs(e.y),u=n>o;return t==="left"||t==="right"?u&&n>r:!u&&o>r};function cle(e=()=>{}){const t=Sh(e);Eh(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function ule(e){return e.nodeType===e.ELEMENT_NODE}function hle(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function GO(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var fle=pH,AH=gH,CH=yH,PH=vH,IH=xH,kH=bH,OH=HF;function MH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=MH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Ai(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=MH(e))&&(n&&(n+=" "),n+=t);return n}const M8=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,R8=Ai,o2=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return R8(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:o,defaultVariants:u}=t,d=Object.keys(o).map(w=>{const S=r==null?void 0:r[w],C=u==null?void 0:u[w];if(S===null)return null;const k=M8(S)||M8(C);return o[w][k]}),i=r&&Object.entries(r).reduce((w,S)=>{let[C,k]=S;return k===void 0||(w[C]=k),w},{}),v=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((w,S)=>{let{class:C,className:k,...O}=S;return Object.entries(O).every(L=>{let[R,N]=L;return Array.isArray(N)?N.includes({...u,...i}[R]):{...u,...i}[R]===N})?[...w,C,k]:w},[]);return R8(e,d,v,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dle=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),RH=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ple={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mle=ue.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:o="",children:u,iconNode:d,...i},v)=>ue.createElement("svg",{ref:v,...ple,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:RH("lucide",o),...i},[...d.map(([w,S])=>ue.createElement(w,S)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=(e,t)=>{const r=ue.forwardRef(({className:n,...o},u)=>ue.createElement(mle,{ref:u,iconNode:t,className:RH(`lucide-${dle(e)}`,n),...o}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gle=Qo("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DH=Qo("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _le=Qo("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yle=Qo("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vle=Qo("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xle=Qo("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=Qo("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=Qo("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=Qo("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wle=Qo("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=Qo("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=Qo("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=Qo("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Qo("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Qo("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ble=Qo("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tle=Qo("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FH=Qo("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),XF="-",Sle=e=>{const t=Ale(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:d=>{const i=d.split(XF);return i[0]===""&&i.length!==1&&i.shift(),LH(i,t)||Ele(d)},getConflictingClassGroupIds:(d,i)=>{const v=r[d]||[];return i&&n[d]?[...v,...n[d]]:v}}},LH=(e,t)=>{var d;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),o=n?LH(e.slice(1),n):void 0;if(o)return o;if(t.validators.length===0)return;const u=e.join(XF);return(d=t.validators.find(({validator:i})=>i(u)))==null?void 0:d.classGroupId},F8=/^\[(.+)\]$/,Ele=e=>{if(F8.test(e)){const t=F8.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Ale=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Ple(Object.entries(e.classGroups),r).forEach(([u,d])=>{ZR(d,n,u,t)}),n},ZR=(e,t,r,n)=>{e.forEach(o=>{if(typeof o=="string"){const u=o===""?t:L8(t,o);u.classGroupId=r;return}if(typeof o=="function"){if(Cle(o)){ZR(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(([u,d])=>{ZR(d,L8(t,u),r,n)})})},L8=(e,t)=>{let r=e;return t.split(XF).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Cle=e=>e.isThemeGetter,Ple=(e,t)=>t?e.map(([r,n])=>{const o=n.map(u=>typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(([d,i])=>[t+d,i])):u);return[r,o]}):e,Ile=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const o=(u,d)=>{r.set(u,d),t++,t>e&&(t=0,n=r,r=new Map)};return{get(u){let d=r.get(u);if(d!==void 0)return d;if((d=n.get(u))!==void 0)return o(u,d),d},set(u,d){r.has(u)?r.set(u,d):o(u,d)}}},NH="!",kle=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,o=t[0],u=t.length,d=i=>{const v=[];let w=0,S=0,C;for(let N=0;N<i.length;N++){let V=i[N];if(w===0){if(V===o&&(n||i.slice(N,N+u)===t)){v.push(i.slice(S,N)),S=N+u;continue}if(V==="/"){C=N;continue}}V==="["?w++:V==="]"&&w--}const k=v.length===0?i:i.substring(S),O=k.startsWith(NH),L=O?k.substring(1):k,R=C&&C>S?C-S:void 0;return{modifiers:v,hasImportantModifier:O,baseClassName:L,maybePostfixModifierPosition:R}};return r?i=>r({className:i,parseClassName:d}):d},Ole=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Mle=e=>({cache:Ile(e.cacheSize),parseClassName:kle(e),...Sle(e)}),Rle=/\s+/,Dle=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o}=t,u=[],d=e.trim().split(Rle);let i="";for(let v=d.length-1;v>=0;v-=1){const w=d[v],{modifiers:S,hasImportantModifier:C,baseClassName:k,maybePostfixModifierPosition:O}=r(w);let L=!!O,R=n(L?k.substring(0,O):k);if(!R){if(!L){i=w+(i.length>0?" "+i:i);continue}if(R=n(k),!R){i=w+(i.length>0?" "+i:i);continue}L=!1}const N=Ole(S).join(":"),V=C?N+NH:N,G=V+R;if(u.includes(G))continue;u.push(G);const U=o(R,L);for(let J=0;J<U.length;++J){const Z=U[J];u.push(V+Z)}i=w+(i.length>0?" "+i:i)}return i};function Fle(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=BH(t))&&(n&&(n+=" "),n+=r);return n}const BH=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=BH(e[n]))&&(r&&(r+=" "),r+=t);return r};function Lle(e,...t){let r,n,o,u=d;function d(v){const w=t.reduce((S,C)=>C(S),e());return r=Mle(w),n=r.cache.get,o=r.cache.set,u=i,i(v)}function i(v){const w=n(v);if(w)return w;const S=Dle(v,r);return o(v,S),S}return function(){return u(Fle.apply(null,arguments))}}const Ea=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},zH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Nle=/^\d+\/\d+$/,Ble=new Set(["px","full","screen"]),zle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jle=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ule=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,$le=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Vle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,cf=e=>ly(e)||Ble.has(e)||Nle.test(e),Ld=e=>pv(e,"length",Kle),ly=e=>!!e&&!Number.isNaN(Number(e)),XO=e=>pv(e,"number",ly),F1=e=>!!e&&Number.isInteger(Number(e)),Wle=e=>e.endsWith("%")&&ly(e.slice(0,-1)),Xn=e=>zH.test(e),Nd=e=>zle.test(e),Gle=new Set(["length","size","percentage"]),Hle=e=>pv(e,Gle,jH),qle=e=>pv(e,"position",jH),Xle=new Set(["image","url"]),Zle=e=>pv(e,Xle,Qle),Yle=e=>pv(e,"",Jle),L1=()=>!0,pv=(e,t,r)=>{const n=zH.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Kle=e=>jle.test(e)&&!Ule.test(e),jH=()=>!1,Jle=e=>$le.test(e),Qle=e=>Vle.test(e),ece=()=>{const e=Ea("colors"),t=Ea("spacing"),r=Ea("blur"),n=Ea("brightness"),o=Ea("borderColor"),u=Ea("borderRadius"),d=Ea("borderSpacing"),i=Ea("borderWidth"),v=Ea("contrast"),w=Ea("grayscale"),S=Ea("hueRotate"),C=Ea("invert"),k=Ea("gap"),O=Ea("gradientColorStops"),L=Ea("gradientColorStopPositions"),R=Ea("inset"),N=Ea("margin"),V=Ea("opacity"),G=Ea("padding"),U=Ea("saturate"),J=Ea("scale"),Z=Ea("sepia"),K=Ea("skew"),re=Ea("space"),ge=Ea("translate"),ve=()=>["auto","contain","none"],$e=()=>["auto","hidden","clip","visible","scroll"],Ie=()=>["auto",Xn,t],ke=()=>[Xn,t],tt=()=>["",cf,Ld],Je=()=>["auto",ly,Xn],et=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],at=()=>["solid","dashed","dotted","double","none"],pt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ft=()=>["start","end","center","between","around","evenly","stretch"],Ue=()=>["","0",Xn],It=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Rt=()=>[ly,Xn];return{cacheSize:500,separator:":",theme:{colors:[L1],spacing:[cf,Ld],blur:["none","",Nd,Xn],brightness:Rt(),borderColor:[e],borderRadius:["none","","full",Nd,Xn],borderSpacing:ke(),borderWidth:tt(),contrast:Rt(),grayscale:Ue(),hueRotate:Rt(),invert:Ue(),gap:ke(),gradientColorStops:[e],gradientColorStopPositions:[Wle,Ld],inset:Ie(),margin:Ie(),opacity:Rt(),padding:ke(),saturate:Rt(),scale:Rt(),sepia:Ue(),skew:Rt(),space:ke(),translate:ke()},classGroups:{aspect:[{aspect:["auto","square","video",Xn]}],container:["container"],columns:[{columns:[Nd]}],"break-after":[{"break-after":It()}],"break-before":[{"break-before":It()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...et(),Xn]}],overflow:[{overflow:$e()}],"overflow-x":[{"overflow-x":$e()}],"overflow-y":[{"overflow-y":$e()}],overscroll:[{overscroll:ve()}],"overscroll-x":[{"overscroll-x":ve()}],"overscroll-y":[{"overscroll-y":ve()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[R]}],"inset-x":[{"inset-x":[R]}],"inset-y":[{"inset-y":[R]}],start:[{start:[R]}],end:[{end:[R]}],top:[{top:[R]}],right:[{right:[R]}],bottom:[{bottom:[R]}],left:[{left:[R]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",F1,Xn]}],basis:[{basis:Ie()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Xn]}],grow:[{grow:Ue()}],shrink:[{shrink:Ue()}],order:[{order:["first","last","none",F1,Xn]}],"grid-cols":[{"grid-cols":[L1]}],"col-start-end":[{col:["auto",{span:["full",F1,Xn]},Xn]}],"col-start":[{"col-start":Je()}],"col-end":[{"col-end":Je()}],"grid-rows":[{"grid-rows":[L1]}],"row-start-end":[{row:["auto",{span:[F1,Xn]},Xn]}],"row-start":[{"row-start":Je()}],"row-end":[{"row-end":Je()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Xn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Xn]}],gap:[{gap:[k]}],"gap-x":[{"gap-x":[k]}],"gap-y":[{"gap-y":[k]}],"justify-content":[{justify:["normal",...ft()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ft(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ft(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[G]}],px:[{px:[G]}],py:[{py:[G]}],ps:[{ps:[G]}],pe:[{pe:[G]}],pt:[{pt:[G]}],pr:[{pr:[G]}],pb:[{pb:[G]}],pl:[{pl:[G]}],m:[{m:[N]}],mx:[{mx:[N]}],my:[{my:[N]}],ms:[{ms:[N]}],me:[{me:[N]}],mt:[{mt:[N]}],mr:[{mr:[N]}],mb:[{mb:[N]}],ml:[{ml:[N]}],"space-x":[{"space-x":[re]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[re]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Xn,t]}],"min-w":[{"min-w":[Xn,t,"min","max","fit"]}],"max-w":[{"max-w":[Xn,t,"none","full","min","max","fit","prose",{screen:[Nd]},Nd]}],h:[{h:[Xn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Xn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Xn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Xn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Nd,Ld]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",XO]}],"font-family":[{font:[L1]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Xn]}],"line-clamp":[{"line-clamp":["none",ly,XO]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",cf,Xn]}],"list-image":[{"list-image":["none",Xn]}],"list-style-type":[{list:["none","disc","decimal",Xn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[V]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[V]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...at(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",cf,Ld]}],"underline-offset":[{"underline-offset":["auto",cf,Xn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ke()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Xn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Xn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[V]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...et(),qle]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Hle]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Zle]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[L]}],"gradient-via-pos":[{via:[L]}],"gradient-to-pos":[{to:[L]}],"gradient-from":[{from:[O]}],"gradient-via":[{via:[O]}],"gradient-to":[{to:[O]}],rounded:[{rounded:[u]}],"rounded-s":[{"rounded-s":[u]}],"rounded-e":[{"rounded-e":[u]}],"rounded-t":[{"rounded-t":[u]}],"rounded-r":[{"rounded-r":[u]}],"rounded-b":[{"rounded-b":[u]}],"rounded-l":[{"rounded-l":[u]}],"rounded-ss":[{"rounded-ss":[u]}],"rounded-se":[{"rounded-se":[u]}],"rounded-ee":[{"rounded-ee":[u]}],"rounded-es":[{"rounded-es":[u]}],"rounded-tl":[{"rounded-tl":[u]}],"rounded-tr":[{"rounded-tr":[u]}],"rounded-br":[{"rounded-br":[u]}],"rounded-bl":[{"rounded-bl":[u]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[V]}],"border-style":[{border:[...at(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[V]}],"divide-style":[{divide:at()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...at()]}],"outline-offset":[{"outline-offset":[cf,Xn]}],"outline-w":[{outline:[cf,Ld]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:tt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[V]}],"ring-offset-w":[{"ring-offset":[cf,Ld]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Nd,Yle]}],"shadow-color":[{shadow:[L1]}],opacity:[{opacity:[V]}],"mix-blend":[{"mix-blend":[...pt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":pt()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[v]}],"drop-shadow":[{"drop-shadow":["","none",Nd,Xn]}],grayscale:[{grayscale:[w]}],"hue-rotate":[{"hue-rotate":[S]}],invert:[{invert:[C]}],saturate:[{saturate:[U]}],sepia:[{sepia:[Z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[v]}],"backdrop-grayscale":[{"backdrop-grayscale":[w]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[S]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[V]}],"backdrop-saturate":[{"backdrop-saturate":[U]}],"backdrop-sepia":[{"backdrop-sepia":[Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Xn]}],duration:[{duration:Rt()}],ease:[{ease:["linear","in","out","in-out",Xn]}],delay:[{delay:Rt()}],animate:[{animate:["none","spin","ping","pulse","bounce",Xn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[J]}],"scale-x":[{"scale-x":[J]}],"scale-y":[{"scale-y":[J]}],rotate:[{rotate:[F1,Xn]}],"translate-x":[{"translate-x":[ge]}],"translate-y":[{"translate-y":[ge]}],"skew-x":[{"skew-x":[K]}],"skew-y":[{"skew-y":[K]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Xn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Xn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ke()}],"scroll-mx":[{"scroll-mx":ke()}],"scroll-my":[{"scroll-my":ke()}],"scroll-ms":[{"scroll-ms":ke()}],"scroll-me":[{"scroll-me":ke()}],"scroll-mt":[{"scroll-mt":ke()}],"scroll-mr":[{"scroll-mr":ke()}],"scroll-mb":[{"scroll-mb":ke()}],"scroll-ml":[{"scroll-ml":ke()}],"scroll-p":[{"scroll-p":ke()}],"scroll-px":[{"scroll-px":ke()}],"scroll-py":[{"scroll-py":ke()}],"scroll-ps":[{"scroll-ps":ke()}],"scroll-pe":[{"scroll-pe":ke()}],"scroll-pt":[{"scroll-pt":ke()}],"scroll-pr":[{"scroll-pr":ke()}],"scroll-pb":[{"scroll-pb":ke()}],"scroll-pl":[{"scroll-pl":ke()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Xn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[cf,Ld,XO]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},tce=Lle(ece);function Ci(...e){return tce(Ai(e))}const rce=fle,UH=ue.forwardRef(({className:e,...t},r)=>be.jsx(AH,{ref:r,className:Ci("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));UH.displayName=AH.displayName;const nce=o2("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),$H=ue.forwardRef(({className:e,variant:t,...r},n)=>be.jsx(CH,{ref:n,className:Ci(nce({variant:t}),e),...r}));$H.displayName=CH.displayName;const ice=ue.forwardRef(({className:e,...t},r)=>be.jsx(kH,{ref:r,className:Ci("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));ice.displayName=kH.displayName;const VH=ue.forwardRef(({className:e,...t},r)=>be.jsx(OH,{ref:r,className:Ci("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:be.jsx(FH,{className:"h-4 w-4"})}));VH.displayName=OH.displayName;const WH=ue.forwardRef(({className:e,...t},r)=>be.jsx(PH,{ref:r,className:Ci("text-sm font-semibold",e),...t}));WH.displayName=PH.displayName;const GH=ue.forwardRef(({className:e,...t},r)=>be.jsx(IH,{ref:r,className:Ci("text-sm opacity-90",e),...t}));GH.displayName=IH.displayName;function ace(){const{toasts:e}=r2();return be.jsxs(rce,{children:[e.map(function({id:t,title:r,description:n,action:o,...u}){return be.jsxs($H,{...u,children:[be.jsxs("div",{className:"grid gap-1",children:[r&&be.jsx(WH,{children:r}),n&&be.jsx(GH,{children:n})]}),o,be.jsx(VH,{})]},t)}),be.jsx(UH,{})]})}var N8=["light","dark"],oce="(prefers-color-scheme: dark)",sce=ue.createContext(void 0),lce={setTheme:e=>{},themes:[]},cce=()=>{var e;return(e=ue.useContext(sce))!=null?e:lce};ue.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:o,defaultTheme:u,value:d,attrs:i,nonce:v})=>{let w=u==="system",S=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${i.map(L=>`'${L}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,C=o?N8.includes(u)&&u?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${u}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",k=(L,R=!1,N=!0)=>{let V=d?d[L]:L,G=R?L+"|| ''":`'${V}'`,U="";return o&&N&&!R&&N8.includes(L)&&(U+=`d.style.colorScheme = '${L}';`),r==="class"?R||V?U+=`c.add(${G})`:U+="null":V&&(U+=`d[s](n,${G})`),U},O=e?`!function(){${S}${k(e)}}()`:n?`!function(){try{${S}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${w})){var t='${oce}',m=window.matchMedia(t);if(m.media!==t||m.matches){${k("dark")}}else{${k("light")}}}else if(e){${d?`var x=${JSON.stringify(d)};`:""}${k(d?"x[e]":"e",!0)}}${w?"":"else{"+k(u,!1,!1)+"}"}${C}}catch(e){}}()`:`!function(){try{${S}var e=localStorage.getItem('${t}');if(e){${d?`var x=${JSON.stringify(d)};`:""}${k(d?"x[e]":"e",!0)}}else{${k(u,!1,!1)};}${C}}catch(t){}}();`;return ue.createElement("script",{nonce:v,dangerouslySetInnerHTML:{__html:O}})});var uce=e=>{switch(e){case"success":return dce;case"info":return mce;case"warning":return pce;case"error":return gce;default:return null}},hce=Array(12).fill(0),fce=({visible:e,className:t})=>it.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},it.createElement("div",{className:"sonner-spinner"},hce.map((r,n)=>it.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),dce=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),pce=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),mce=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),gce=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),_ce=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},it.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),it.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),yce=()=>{let[e,t]=it.useState(document.hidden);return it.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},YR=1,vce=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,o=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:YR++,u=this.toasts.find(i=>i.id===o),d=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),u?this.toasts=this.toasts.map(i=>i.id===o?(this.publish({...i,...e,id:o,title:r}),{...i,...e,id:o,dismissible:d,title:r}):i):this.addToast({title:r,...n,dismissible:d,id:o}),o},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),o=r!==void 0,u,d=n.then(async v=>{if(u=["resolve",v],it.isValidElement(v))o=!1,this.create({id:r,type:"default",message:v});else if(wce(v)&&!v.ok){o=!1;let w=typeof t.error=="function"?await t.error(`HTTP error! status: ${v.status}`):t.error,S=typeof t.description=="function"?await t.description(`HTTP error! status: ${v.status}`):t.description;this.create({id:r,type:"error",message:w,description:S})}else if(t.success!==void 0){o=!1;let w=typeof t.success=="function"?await t.success(v):t.success,S=typeof t.description=="function"?await t.description(v):t.description;this.create({id:r,type:"success",message:w,description:S})}}).catch(async v=>{if(u=["reject",v],t.error!==void 0){o=!1;let w=typeof t.error=="function"?await t.error(v):t.error,S=typeof t.description=="function"?await t.description(v):t.description;this.create({id:r,type:"error",message:w,description:S})}}).finally(()=>{var v;o&&(this.dismiss(r),r=void 0),(v=t.finally)==null||v.call(t)}),i=()=>new Promise((v,w)=>d.then(()=>u[0]==="reject"?w(u[1]):v(u[1])).catch(w));return typeof r!="string"&&typeof r!="number"?{unwrap:i}:Object.assign(r,{unwrap:i})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||YR++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},sl=new vce,xce=(e,t)=>{let r=(t==null?void 0:t.id)||YR++;return sl.addToast({title:e,...t,id:r}),r},wce=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",bce=xce,Tce=()=>sl.toasts,Sce=()=>sl.getActiveToasts();Object.assign(bce,{success:sl.success,info:sl.info,warning:sl.warning,error:sl.error,custom:sl.custom,message:sl.message,promise:sl.promise,dismiss:sl.dismiss,loading:sl.loading},{getHistory:Tce,getToasts:Sce});function Ece(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Ece(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function $S(e){return e.label!==void 0}var Ace=3,Cce="32px",Pce="16px",B8=4e3,Ice=356,kce=14,Oce=20,Mce=200;function tu(...e){return e.filter(Boolean).join(" ")}function Rce(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var Dce=e=>{var t,r,n,o,u,d,i,v,w,S,C;let{invert:k,toast:O,unstyled:L,interacting:R,setHeights:N,visibleToasts:V,heights:G,index:U,toasts:J,expanded:Z,removeToast:K,defaultRichColors:re,closeButton:ge,style:ve,cancelButtonStyle:$e,actionButtonStyle:Ie,className:ke="",descriptionClassName:tt="",duration:Je,position:et,gap:at,loadingIcon:pt,expandByDefault:ft,classNames:Ue,icons:It,closeButtonAriaLabel:Rt="Close toast",pauseWhenPageIsHidden:_e}=e,[Ge,qe]=it.useState(null),[Xe,yt]=it.useState(null),[Dt,Yt]=it.useState(!1),[St,Mt]=it.useState(!1),[Sr,Ne]=it.useState(!1),[un,kr]=it.useState(!1),[Br,Yr]=it.useState(!1),[Tr,jn]=it.useState(0),[Un,Wi]=it.useState(0),Yn=it.useRef(O.duration||Je||B8),ta=it.useRef(null),Di=it.useRef(null),ra=U===0,Ra=U+1<=V,ei=O.type,na=O.dismissible!==!1,wa=O.className||"",Da=O.descriptionClassName||"",_n=it.useMemo(()=>G.findIndex(yn=>yn.toastId===O.id)||0,[G,O.id]),Nn=it.useMemo(()=>{var yn;return(yn=O.closeButton)!=null?yn:ge},[O.closeButton,ge]),Gi=it.useMemo(()=>O.duration||Je||B8,[O.duration,Je]),ji=it.useRef(0),ba=it.useRef(0),Bo=it.useRef(0),uo=it.useRef(null),[xl,ti]=et.split("-"),ia=it.useMemo(()=>G.reduce((yn,Pt,si)=>si>=_n?yn:yn+Pt.height,0),[G,_n]),wl=yce(),bl=O.invert||k,To=ei==="loading";ba.current=it.useMemo(()=>_n*at+ia,[_n,ia]),it.useEffect(()=>{Yn.current=Gi},[Gi]),it.useEffect(()=>{Yt(!0)},[]),it.useEffect(()=>{let yn=Di.current;if(yn){let Pt=yn.getBoundingClientRect().height;return Wi(Pt),N(si=>[{toastId:O.id,height:Pt,position:O.position},...si]),()=>N(si=>si.filter(So=>So.toastId!==O.id))}},[N,O.id]),it.useLayoutEffect(()=>{if(!Dt)return;let yn=Di.current,Pt=yn.style.height;yn.style.height="auto";let si=yn.getBoundingClientRect().height;yn.style.height=Pt,Wi(si),N(So=>So.find(Ha=>Ha.toastId===O.id)?So.map(Ha=>Ha.toastId===O.id?{...Ha,height:si}:Ha):[{toastId:O.id,height:si,position:O.position},...So])},[Dt,O.title,O.description,N,O.id]);let ro=it.useCallback(()=>{Mt(!0),jn(ba.current),N(yn=>yn.filter(Pt=>Pt.toastId!==O.id)),setTimeout(()=>{K(O)},Mce)},[O,K,N,ba]);it.useEffect(()=>{if(O.promise&&ei==="loading"||O.duration===1/0||O.type==="loading")return;let yn;return Z||R||_e&&wl?(()=>{if(Bo.current<ji.current){let Pt=new Date().getTime()-ji.current;Yn.current=Yn.current-Pt}Bo.current=new Date().getTime()})():Yn.current!==1/0&&(ji.current=new Date().getTime(),yn=setTimeout(()=>{var Pt;(Pt=O.onAutoClose)==null||Pt.call(O,O),ro()},Yn.current)),()=>clearTimeout(yn)},[Z,R,O,ei,_e,wl,ro]),it.useEffect(()=>{O.delete&&ro()},[ro,O.delete]);function jc(){var yn,Pt,si;return It!=null&&It.loading?it.createElement("div",{className:tu(Ue==null?void 0:Ue.loader,(yn=O==null?void 0:O.classNames)==null?void 0:yn.loader,"sonner-loader"),"data-visible":ei==="loading"},It.loading):pt?it.createElement("div",{className:tu(Ue==null?void 0:Ue.loader,(Pt=O==null?void 0:O.classNames)==null?void 0:Pt.loader,"sonner-loader"),"data-visible":ei==="loading"},pt):it.createElement(fce,{className:tu(Ue==null?void 0:Ue.loader,(si=O==null?void 0:O.classNames)==null?void 0:si.loader),visible:ei==="loading"})}return it.createElement("li",{tabIndex:0,ref:Di,className:tu(ke,wa,Ue==null?void 0:Ue.toast,(t=O==null?void 0:O.classNames)==null?void 0:t.toast,Ue==null?void 0:Ue.default,Ue==null?void 0:Ue[ei],(r=O==null?void 0:O.classNames)==null?void 0:r[ei]),"data-sonner-toast":"","data-rich-colors":(n=O.richColors)!=null?n:re,"data-styled":!(O.jsx||O.unstyled||L),"data-mounted":Dt,"data-promise":!!O.promise,"data-swiped":Br,"data-removed":St,"data-visible":Ra,"data-y-position":xl,"data-x-position":ti,"data-index":U,"data-front":ra,"data-swiping":Sr,"data-dismissible":na,"data-type":ei,"data-invert":bl,"data-swipe-out":un,"data-swipe-direction":Xe,"data-expanded":!!(Z||ft&&Dt),style:{"--index":U,"--toasts-before":U,"--z-index":J.length-U,"--offset":`${St?Tr:ba.current}px`,"--initial-height":ft?"auto":`${Un}px`,...ve,...O.style},onDragEnd:()=>{Ne(!1),qe(null),uo.current=null},onPointerDown:yn=>{To||!na||(ta.current=new Date,jn(ba.current),yn.target.setPointerCapture(yn.pointerId),yn.target.tagName!=="BUTTON"&&(Ne(!0),uo.current={x:yn.clientX,y:yn.clientY}))},onPointerUp:()=>{var yn,Pt,si,So;if(un||!na)return;uo.current=null;let Ha=Number(((yn=Di.current)==null?void 0:yn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Qe=Number(((Pt=Di.current)==null?void 0:Pt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),se=new Date().getTime()-((si=ta.current)==null?void 0:si.getTime()),he=Ge==="x"?Ha:Qe,Pe=Math.abs(he)/se;if(Math.abs(he)>=Oce||Pe>.11){jn(ba.current),(So=O.onDismiss)==null||So.call(O,O),yt(Ge==="x"?Ha>0?"right":"left":Qe>0?"down":"up"),ro(),kr(!0),Yr(!1);return}Ne(!1),qe(null)},onPointerMove:yn=>{var Pt,si,So,Ha;if(!uo.current||!na||((Pt=window.getSelection())==null?void 0:Pt.toString().length)>0)return;let Qe=yn.clientY-uo.current.y,se=yn.clientX-uo.current.x,he=(si=e.swipeDirections)!=null?si:Rce(et);!Ge&&(Math.abs(se)>1||Math.abs(Qe)>1)&&qe(Math.abs(se)>Math.abs(Qe)?"x":"y");let Pe={x:0,y:0};Ge==="y"?(he.includes("top")||he.includes("bottom"))&&(he.includes("top")&&Qe<0||he.includes("bottom")&&Qe>0)&&(Pe.y=Qe):Ge==="x"&&(he.includes("left")||he.includes("right"))&&(he.includes("left")&&se<0||he.includes("right")&&se>0)&&(Pe.x=se),(Math.abs(Pe.x)>0||Math.abs(Pe.y)>0)&&Yr(!0),(So=Di.current)==null||So.style.setProperty("--swipe-amount-x",`${Pe.x}px`),(Ha=Di.current)==null||Ha.style.setProperty("--swipe-amount-y",`${Pe.y}px`)}},Nn&&!O.jsx?it.createElement("button",{"aria-label":Rt,"data-disabled":To,"data-close-button":!0,onClick:To||!na?()=>{}:()=>{var yn;ro(),(yn=O.onDismiss)==null||yn.call(O,O)},className:tu(Ue==null?void 0:Ue.closeButton,(o=O==null?void 0:O.classNames)==null?void 0:o.closeButton)},(u=It==null?void 0:It.close)!=null?u:_ce):null,O.jsx||ue.isValidElement(O.title)?O.jsx?O.jsx:typeof O.title=="function"?O.title():O.title:it.createElement(it.Fragment,null,ei||O.icon||O.promise?it.createElement("div",{"data-icon":"",className:tu(Ue==null?void 0:Ue.icon,(d=O==null?void 0:O.classNames)==null?void 0:d.icon)},O.promise||O.type==="loading"&&!O.icon?O.icon||jc():null,O.type!=="loading"?O.icon||(It==null?void 0:It[ei])||uce(ei):null):null,it.createElement("div",{"data-content":"",className:tu(Ue==null?void 0:Ue.content,(i=O==null?void 0:O.classNames)==null?void 0:i.content)},it.createElement("div",{"data-title":"",className:tu(Ue==null?void 0:Ue.title,(v=O==null?void 0:O.classNames)==null?void 0:v.title)},typeof O.title=="function"?O.title():O.title),O.description?it.createElement("div",{"data-description":"",className:tu(tt,Da,Ue==null?void 0:Ue.description,(w=O==null?void 0:O.classNames)==null?void 0:w.description)},typeof O.description=="function"?O.description():O.description):null),ue.isValidElement(O.cancel)?O.cancel:O.cancel&&$S(O.cancel)?it.createElement("button",{"data-button":!0,"data-cancel":!0,style:O.cancelButtonStyle||$e,onClick:yn=>{var Pt,si;$S(O.cancel)&&na&&((si=(Pt=O.cancel).onClick)==null||si.call(Pt,yn),ro())},className:tu(Ue==null?void 0:Ue.cancelButton,(S=O==null?void 0:O.classNames)==null?void 0:S.cancelButton)},O.cancel.label):null,ue.isValidElement(O.action)?O.action:O.action&&$S(O.action)?it.createElement("button",{"data-button":!0,"data-action":!0,style:O.actionButtonStyle||Ie,onClick:yn=>{var Pt,si;$S(O.action)&&((si=(Pt=O.action).onClick)==null||si.call(Pt,yn),!yn.defaultPrevented&&ro())},className:tu(Ue==null?void 0:Ue.actionButton,(C=O==null?void 0:O.classNames)==null?void 0:C.actionButton)},O.action.label):null))};function z8(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Fce(e,t){let r={};return[e,t].forEach((n,o)=>{let u=o===1,d=u?"--mobile-offset":"--offset",i=u?Pce:Cce;function v(w){["top","right","bottom","left"].forEach(S=>{r[`${d}-${S}`]=typeof w=="number"?`${w}px`:w})}typeof n=="number"||typeof n=="string"?v(n):typeof n=="object"?["top","right","bottom","left"].forEach(w=>{n[w]===void 0?r[`${d}-${w}`]=i:r[`${d}-${w}`]=typeof n[w]=="number"?`${n[w]}px`:n[w]}):v(i)}),r}var Lce=ue.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:o=["altKey","KeyT"],expand:u,closeButton:d,className:i,offset:v,mobileOffset:w,theme:S="light",richColors:C,duration:k,style:O,visibleToasts:L=Ace,toastOptions:R,dir:N=z8(),gap:V=kce,loadingIcon:G,icons:U,containerAriaLabel:J="Notifications",pauseWhenPageIsHidden:Z}=e,[K,re]=it.useState([]),ge=it.useMemo(()=>Array.from(new Set([n].concat(K.filter(_e=>_e.position).map(_e=>_e.position)))),[K,n]),[ve,$e]=it.useState([]),[Ie,ke]=it.useState(!1),[tt,Je]=it.useState(!1),[et,at]=it.useState(S!=="system"?S:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),pt=it.useRef(null),ft=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),Ue=it.useRef(null),It=it.useRef(!1),Rt=it.useCallback(_e=>{re(Ge=>{var qe;return(qe=Ge.find(Xe=>Xe.id===_e.id))!=null&&qe.delete||sl.dismiss(_e.id),Ge.filter(({id:Xe})=>Xe!==_e.id)})},[]);return it.useEffect(()=>sl.subscribe(_e=>{if(_e.dismiss){re(Ge=>Ge.map(qe=>qe.id===_e.id?{...qe,delete:!0}:qe));return}setTimeout(()=>{oH.flushSync(()=>{re(Ge=>{let qe=Ge.findIndex(Xe=>Xe.id===_e.id);return qe!==-1?[...Ge.slice(0,qe),{...Ge[qe],..._e},...Ge.slice(qe+1)]:[_e,...Ge]})})})}),[]),it.useEffect(()=>{if(S!=="system"){at(S);return}if(S==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?at("dark"):at("light")),typeof window>"u")return;let _e=window.matchMedia("(prefers-color-scheme: dark)");try{_e.addEventListener("change",({matches:Ge})=>{at(Ge?"dark":"light")})}catch{_e.addListener(({matches:qe})=>{try{at(qe?"dark":"light")}catch(Xe){console.error(Xe)}})}},[S]),it.useEffect(()=>{K.length<=1&&ke(!1)},[K]),it.useEffect(()=>{let _e=Ge=>{var qe,Xe;o.every(yt=>Ge[yt]||Ge.code===yt)&&(ke(!0),(qe=pt.current)==null||qe.focus()),Ge.code==="Escape"&&(document.activeElement===pt.current||(Xe=pt.current)!=null&&Xe.contains(document.activeElement))&&ke(!1)};return document.addEventListener("keydown",_e),()=>document.removeEventListener("keydown",_e)},[o]),it.useEffect(()=>{if(pt.current)return()=>{Ue.current&&(Ue.current.focus({preventScroll:!0}),Ue.current=null,It.current=!1)}},[pt.current]),it.createElement("section",{ref:t,"aria-label":`${J} ${ft}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ge.map((_e,Ge)=>{var qe;let[Xe,yt]=_e.split("-");return K.length?it.createElement("ol",{key:_e,dir:N==="auto"?z8():N,tabIndex:-1,ref:pt,className:i,"data-sonner-toaster":!0,"data-theme":et,"data-y-position":Xe,"data-lifted":Ie&&K.length>1&&!u,"data-x-position":yt,style:{"--front-toast-height":`${((qe=ve[0])==null?void 0:qe.height)||0}px`,"--width":`${Ice}px`,"--gap":`${V}px`,...O,...Fce(v,w)},onBlur:Dt=>{It.current&&!Dt.currentTarget.contains(Dt.relatedTarget)&&(It.current=!1,Ue.current&&(Ue.current.focus({preventScroll:!0}),Ue.current=null))},onFocus:Dt=>{Dt.target instanceof HTMLElement&&Dt.target.dataset.dismissible==="false"||It.current||(It.current=!0,Ue.current=Dt.relatedTarget)},onMouseEnter:()=>ke(!0),onMouseMove:()=>ke(!0),onMouseLeave:()=>{tt||ke(!1)},onDragEnd:()=>ke(!1),onPointerDown:Dt=>{Dt.target instanceof HTMLElement&&Dt.target.dataset.dismissible==="false"||Je(!0)},onPointerUp:()=>Je(!1)},K.filter(Dt=>!Dt.position&&Ge===0||Dt.position===_e).map((Dt,Yt)=>{var St,Mt;return it.createElement(Dce,{key:Dt.id,icons:U,index:Yt,toast:Dt,defaultRichColors:C,duration:(St=R==null?void 0:R.duration)!=null?St:k,className:R==null?void 0:R.className,descriptionClassName:R==null?void 0:R.descriptionClassName,invert:r,visibleToasts:L,closeButton:(Mt=R==null?void 0:R.closeButton)!=null?Mt:d,interacting:tt,position:_e,style:R==null?void 0:R.style,unstyled:R==null?void 0:R.unstyled,classNames:R==null?void 0:R.classNames,cancelButtonStyle:R==null?void 0:R.cancelButtonStyle,actionButtonStyle:R==null?void 0:R.actionButtonStyle,removeToast:Rt,toasts:K.filter(Sr=>Sr.position==Dt.position),heights:ve.filter(Sr=>Sr.position==Dt.position),setHeights:$e,expandByDefault:u,gap:V,loadingIcon:G,expanded:Ie,pauseWhenPageIsHidden:Z,swipeDirections:e.swipeDirections})})):null}))});const Nce=({...e})=>{const{theme:t="system"}=cce();return be.jsx(Lce,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Bce=QD[" useId ".trim().toString()]||(()=>{}),zce=0;function xu(e){const[t,r]=ue.useState(Bce());return Eh(()=>{r(n=>n??String(zce++))},[e]),t?`radix-${t}`:""}const jce=["top","right","bottom","left"],Tp=Math.min,jl=Math.max,hA=Math.round,VS=Math.floor,xh=e=>({x:e,y:e}),Uce={left:"right",right:"left",bottom:"top",top:"bottom"},$ce={start:"end",end:"start"};function KR(e,t,r){return jl(e,Tp(t,r))}function Rf(e,t){return typeof e=="function"?e(t):e}function Df(e){return e.split("-")[0]}function mv(e){return e.split("-")[1]}function ZF(e){return e==="x"?"y":"x"}function YF(e){return e==="y"?"height":"width"}const Vce=new Set(["top","bottom"]);function ph(e){return Vce.has(Df(e))?"y":"x"}function KF(e){return ZF(ph(e))}function Wce(e,t,r){r===void 0&&(r=!1);const n=mv(e),o=KF(e),u=YF(o);let d=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(d=fA(d)),[d,fA(d)]}function Gce(e){const t=fA(e);return[JR(e),t,JR(t)]}function JR(e){return e.replace(/start|end/g,t=>$ce[t])}const j8=["left","right"],U8=["right","left"],Hce=["top","bottom"],qce=["bottom","top"];function Xce(e,t,r){switch(e){case"top":case"bottom":return r?t?U8:j8:t?j8:U8;case"left":case"right":return t?Hce:qce;default:return[]}}function Zce(e,t,r,n){const o=mv(e);let u=Xce(Df(e),r==="start",n);return o&&(u=u.map(d=>d+"-"+o),t&&(u=u.concat(u.map(JR)))),u}function fA(e){return e.replace(/left|right|bottom|top/g,t=>Uce[t])}function Yce(e){return{top:0,right:0,bottom:0,left:0,...e}}function HH(e){return typeof e!="number"?Yce(e):{top:e,right:e,bottom:e,left:e}}function dA(e){const{x:t,y:r,width:n,height:o}=e;return{width:n,height:o,top:r,left:t,right:t+n,bottom:r+o,x:t,y:r}}function $8(e,t,r){let{reference:n,floating:o}=e;const u=ph(t),d=KF(t),i=YF(d),v=Df(t),w=u==="y",S=n.x+n.width/2-o.width/2,C=n.y+n.height/2-o.height/2,k=n[i]/2-o[i]/2;let O;switch(v){case"top":O={x:S,y:n.y-o.height};break;case"bottom":O={x:S,y:n.y+n.height};break;case"right":O={x:n.x+n.width,y:C};break;case"left":O={x:n.x-o.width,y:C};break;default:O={x:n.x,y:n.y}}switch(mv(t)){case"start":O[d]-=k*(r&&w?-1:1);break;case"end":O[d]+=k*(r&&w?-1:1);break}return O}const Kce=async(e,t,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:u=[],platform:d}=r,i=u.filter(Boolean),v=await(d.isRTL==null?void 0:d.isRTL(t));let w=await d.getElementRects({reference:e,floating:t,strategy:o}),{x:S,y:C}=$8(w,n,v),k=n,O={},L=0;for(let R=0;R<i.length;R++){const{name:N,fn:V}=i[R],{x:G,y:U,data:J,reset:Z}=await V({x:S,y:C,initialPlacement:n,placement:k,strategy:o,middlewareData:O,rects:w,platform:d,elements:{reference:e,floating:t}});S=G??S,C=U??C,O={...O,[N]:{...O[N],...J}},Z&&L<=50&&(L++,typeof Z=="object"&&(Z.placement&&(k=Z.placement),Z.rects&&(w=Z.rects===!0?await d.getElementRects({reference:e,floating:t,strategy:o}):Z.rects),{x:S,y:C}=$8(w,k,v)),R=-1)}return{x:S,y:C,placement:k,strategy:o,middlewareData:O}};async function Xw(e,t){var r;t===void 0&&(t={});const{x:n,y:o,platform:u,rects:d,elements:i,strategy:v}=e,{boundary:w="clippingAncestors",rootBoundary:S="viewport",elementContext:C="floating",altBoundary:k=!1,padding:O=0}=Rf(t,e),L=HH(O),N=i[k?C==="floating"?"reference":"floating":C],V=dA(await u.getClippingRect({element:(r=await(u.isElement==null?void 0:u.isElement(N)))==null||r?N:N.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(i.floating)),boundary:w,rootBoundary:S,strategy:v})),G=C==="floating"?{x:n,y:o,width:d.floating.width,height:d.floating.height}:d.reference,U=await(u.getOffsetParent==null?void 0:u.getOffsetParent(i.floating)),J=await(u.isElement==null?void 0:u.isElement(U))?await(u.getScale==null?void 0:u.getScale(U))||{x:1,y:1}:{x:1,y:1},Z=dA(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:G,offsetParent:U,strategy:v}):G);return{top:(V.top-Z.top+L.top)/J.y,bottom:(Z.bottom-V.bottom+L.bottom)/J.y,left:(V.left-Z.left+L.left)/J.x,right:(Z.right-V.right+L.right)/J.x}}const Jce=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:o,rects:u,platform:d,elements:i,middlewareData:v}=t,{element:w,padding:S=0}=Rf(e,t)||{};if(w==null)return{};const C=HH(S),k={x:r,y:n},O=KF(o),L=YF(O),R=await d.getDimensions(w),N=O==="y",V=N?"top":"left",G=N?"bottom":"right",U=N?"clientHeight":"clientWidth",J=u.reference[L]+u.reference[O]-k[O]-u.floating[L],Z=k[O]-u.reference[O],K=await(d.getOffsetParent==null?void 0:d.getOffsetParent(w));let re=K?K[U]:0;(!re||!await(d.isElement==null?void 0:d.isElement(K)))&&(re=i.floating[U]||u.floating[L]);const ge=J/2-Z/2,ve=re/2-R[L]/2-1,$e=Tp(C[V],ve),Ie=Tp(C[G],ve),ke=$e,tt=re-R[L]-Ie,Je=re/2-R[L]/2+ge,et=KR(ke,Je,tt),at=!v.arrow&&mv(o)!=null&&Je!==et&&u.reference[L]/2-(Je<ke?$e:Ie)-R[L]/2<0,pt=at?Je<ke?Je-ke:Je-tt:0;return{[O]:k[O]+pt,data:{[O]:et,centerOffset:Je-et-pt,...at&&{alignmentOffset:pt}},reset:at}}}),Qce=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:o,middlewareData:u,rects:d,initialPlacement:i,platform:v,elements:w}=t,{mainAxis:S=!0,crossAxis:C=!0,fallbackPlacements:k,fallbackStrategy:O="bestFit",fallbackAxisSideDirection:L="none",flipAlignment:R=!0,...N}=Rf(e,t);if((r=u.arrow)!=null&&r.alignmentOffset)return{};const V=Df(o),G=ph(i),U=Df(i)===i,J=await(v.isRTL==null?void 0:v.isRTL(w.floating)),Z=k||(U||!R?[fA(i)]:Gce(i)),K=L!=="none";!k&&K&&Z.push(...Zce(i,R,L,J));const re=[i,...Z],ge=await Xw(t,N),ve=[];let $e=((n=u.flip)==null?void 0:n.overflows)||[];if(S&&ve.push(ge[V]),C){const Je=Wce(o,d,J);ve.push(ge[Je[0]],ge[Je[1]])}if($e=[...$e,{placement:o,overflows:ve}],!ve.every(Je=>Je<=0)){var Ie,ke;const Je=(((Ie=u.flip)==null?void 0:Ie.index)||0)+1,et=re[Je];if(et&&(!(C==="alignment"?G!==ph(et):!1)||$e.every(ft=>ft.overflows[0]>0&&ph(ft.placement)===G)))return{data:{index:Je,overflows:$e},reset:{placement:et}};let at=(ke=$e.filter(pt=>pt.overflows[0]<=0).sort((pt,ft)=>pt.overflows[1]-ft.overflows[1])[0])==null?void 0:ke.placement;if(!at)switch(O){case"bestFit":{var tt;const pt=(tt=$e.filter(ft=>{if(K){const Ue=ph(ft.placement);return Ue===G||Ue==="y"}return!0}).map(ft=>[ft.placement,ft.overflows.filter(Ue=>Ue>0).reduce((Ue,It)=>Ue+It,0)]).sort((ft,Ue)=>ft[1]-Ue[1])[0])==null?void 0:tt[0];pt&&(at=pt);break}case"initialPlacement":at=i;break}if(o!==at)return{reset:{placement:at}}}return{}}}};function V8(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function W8(e){return jce.some(t=>e[t]>=0)}const eue=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...o}=Rf(e,t);switch(n){case"referenceHidden":{const u=await Xw(t,{...o,elementContext:"reference"}),d=V8(u,r.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:W8(d)}}}case"escaped":{const u=await Xw(t,{...o,altBoundary:!0}),d=V8(u,r.floating);return{data:{escapedOffsets:d,escaped:W8(d)}}}default:return{}}}}},qH=new Set(["left","top"]);async function tue(e,t){const{placement:r,platform:n,elements:o}=e,u=await(n.isRTL==null?void 0:n.isRTL(o.floating)),d=Df(r),i=mv(r),v=ph(r)==="y",w=qH.has(d)?-1:1,S=u&&v?-1:1,C=Rf(t,e);let{mainAxis:k,crossAxis:O,alignmentAxis:L}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return i&&typeof L=="number"&&(O=i==="end"?L*-1:L),v?{x:O*S,y:k*w}:{x:k*w,y:O*S}}const rue=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:o,y:u,placement:d,middlewareData:i}=t,v=await tue(t,e);return d===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:o+v.x,y:u+v.y,data:{...v,placement:d}}}}},nue=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:o}=t,{mainAxis:u=!0,crossAxis:d=!1,limiter:i={fn:N=>{let{x:V,y:G}=N;return{x:V,y:G}}},...v}=Rf(e,t),w={x:r,y:n},S=await Xw(t,v),C=ph(Df(o)),k=ZF(C);let O=w[k],L=w[C];if(u){const N=k==="y"?"top":"left",V=k==="y"?"bottom":"right",G=O+S[N],U=O-S[V];O=KR(G,O,U)}if(d){const N=C==="y"?"top":"left",V=C==="y"?"bottom":"right",G=L+S[N],U=L-S[V];L=KR(G,L,U)}const R=i.fn({...t,[k]:O,[C]:L});return{...R,data:{x:R.x-r,y:R.y-n,enabled:{[k]:u,[C]:d}}}}}},iue=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:o,rects:u,middlewareData:d}=t,{offset:i=0,mainAxis:v=!0,crossAxis:w=!0}=Rf(e,t),S={x:r,y:n},C=ph(o),k=ZF(C);let O=S[k],L=S[C];const R=Rf(i,t),N=typeof R=="number"?{mainAxis:R,crossAxis:0}:{mainAxis:0,crossAxis:0,...R};if(v){const U=k==="y"?"height":"width",J=u.reference[k]-u.floating[U]+N.mainAxis,Z=u.reference[k]+u.reference[U]-N.mainAxis;O<J?O=J:O>Z&&(O=Z)}if(w){var V,G;const U=k==="y"?"width":"height",J=qH.has(Df(o)),Z=u.reference[C]-u.floating[U]+(J&&((V=d.offset)==null?void 0:V[C])||0)+(J?0:N.crossAxis),K=u.reference[C]+u.reference[U]+(J?0:((G=d.offset)==null?void 0:G[C])||0)-(J?N.crossAxis:0);L<Z?L=Z:L>K&&(L=K)}return{[k]:O,[C]:L}}}},aue=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:o,rects:u,platform:d,elements:i}=t,{apply:v=()=>{},...w}=Rf(e,t),S=await Xw(t,w),C=Df(o),k=mv(o),O=ph(o)==="y",{width:L,height:R}=u.floating;let N,V;C==="top"||C==="bottom"?(N=C,V=k===(await(d.isRTL==null?void 0:d.isRTL(i.floating))?"start":"end")?"left":"right"):(V=C,N=k==="end"?"top":"bottom");const G=R-S.top-S.bottom,U=L-S.left-S.right,J=Tp(R-S[N],G),Z=Tp(L-S[V],U),K=!t.middlewareData.shift;let re=J,ge=Z;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ge=U),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(re=G),K&&!k){const $e=jl(S.left,0),Ie=jl(S.right,0),ke=jl(S.top,0),tt=jl(S.bottom,0);O?ge=L-2*($e!==0||Ie!==0?$e+Ie:jl(S.left,S.right)):re=R-2*(ke!==0||tt!==0?ke+tt:jl(S.top,S.bottom))}await v({...t,availableWidth:ge,availableHeight:re});const ve=await d.getDimensions(i.floating);return L!==ve.width||R!==ve.height?{reset:{rects:!0}}:{}}}};function eP(){return typeof window<"u"}function gv(e){return XH(e)?(e.nodeName||"").toLowerCase():"#document"}function ql(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function kh(e){var t;return(t=(XH(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function XH(e){return eP()?e instanceof Node||e instanceof ql(e).Node:!1}function Su(e){return eP()?e instanceof Element||e instanceof ql(e).Element:!1}function Ah(e){return eP()?e instanceof HTMLElement||e instanceof ql(e).HTMLElement:!1}function G8(e){return!eP()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ql(e).ShadowRoot}const oue=new Set(["inline","contents"]);function s2(e){const{overflow:t,overflowX:r,overflowY:n,display:o}=Eu(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!oue.has(o)}const sue=new Set(["table","td","th"]);function lue(e){return sue.has(gv(e))}const cue=[":popover-open",":modal"];function tP(e){return cue.some(t=>{try{return e.matches(t)}catch{return!1}})}const uue=["transform","translate","scale","rotate","perspective"],hue=["transform","translate","scale","rotate","perspective","filter"],fue=["paint","layout","strict","content"];function JF(e){const t=QF(),r=Su(e)?Eu(e):e;return uue.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||hue.some(n=>(r.willChange||"").includes(n))||fue.some(n=>(r.contain||"").includes(n))}function due(e){let t=Sp(e);for(;Ah(t)&&!Ly(t);){if(JF(t))return t;if(tP(t))return null;t=Sp(t)}return null}function QF(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const pue=new Set(["html","body","#document"]);function Ly(e){return pue.has(gv(e))}function Eu(e){return ql(e).getComputedStyle(e)}function rP(e){return Su(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Sp(e){if(gv(e)==="html")return e;const t=e.assignedSlot||e.parentNode||G8(e)&&e.host||kh(e);return G8(t)?t.host:t}function ZH(e){const t=Sp(e);return Ly(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ah(t)&&s2(t)?t:ZH(t)}function Zw(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const o=ZH(e),u=o===((n=e.ownerDocument)==null?void 0:n.body),d=ql(o);if(u){const i=QR(d);return t.concat(d,d.visualViewport||[],s2(o)?o:[],i&&r?Zw(i):[])}return t.concat(o,Zw(o,[],r))}function QR(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function YH(e){const t=Eu(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const o=Ah(e),u=o?e.offsetWidth:r,d=o?e.offsetHeight:n,i=hA(r)!==u||hA(n)!==d;return i&&(r=u,n=d),{width:r,height:n,$:i}}function e4(e){return Su(e)?e:e.contextElement}function cy(e){const t=e4(e);if(!Ah(t))return xh(1);const r=t.getBoundingClientRect(),{width:n,height:o,$:u}=YH(t);let d=(u?hA(r.width):r.width)/n,i=(u?hA(r.height):r.height)/o;return(!d||!Number.isFinite(d))&&(d=1),(!i||!Number.isFinite(i))&&(i=1),{x:d,y:i}}const mue=xh(0);function KH(e){const t=ql(e);return!QF()||!t.visualViewport?mue:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function gue(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ql(e)?!1:t}function _0(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const o=e.getBoundingClientRect(),u=e4(e);let d=xh(1);t&&(n?Su(n)&&(d=cy(n)):d=cy(e));const i=gue(u,r,n)?KH(u):xh(0);let v=(o.left+i.x)/d.x,w=(o.top+i.y)/d.y,S=o.width/d.x,C=o.height/d.y;if(u){const k=ql(u),O=n&&Su(n)?ql(n):n;let L=k,R=QR(L);for(;R&&n&&O!==L;){const N=cy(R),V=R.getBoundingClientRect(),G=Eu(R),U=V.left+(R.clientLeft+parseFloat(G.paddingLeft))*N.x,J=V.top+(R.clientTop+parseFloat(G.paddingTop))*N.y;v*=N.x,w*=N.y,S*=N.x,C*=N.y,v+=U,w+=J,L=ql(R),R=QR(L)}}return dA({width:S,height:C,x:v,y:w})}function t4(e,t){const r=rP(e).scrollLeft;return t?t.left+r:_0(kh(e)).left+r}function JH(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),o=n.left+t.scrollLeft-(r?0:t4(e,n)),u=n.top+t.scrollTop;return{x:o,y:u}}function _ue(e){let{elements:t,rect:r,offsetParent:n,strategy:o}=e;const u=o==="fixed",d=kh(n),i=t?tP(t.floating):!1;if(n===d||i&&u)return r;let v={scrollLeft:0,scrollTop:0},w=xh(1);const S=xh(0),C=Ah(n);if((C||!C&&!u)&&((gv(n)!=="body"||s2(d))&&(v=rP(n)),Ah(n))){const O=_0(n);w=cy(n),S.x=O.x+n.clientLeft,S.y=O.y+n.clientTop}const k=d&&!C&&!u?JH(d,v,!0):xh(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-v.scrollLeft*w.x+S.x+k.x,y:r.y*w.y-v.scrollTop*w.y+S.y+k.y}}function yue(e){return Array.from(e.getClientRects())}function vue(e){const t=kh(e),r=rP(e),n=e.ownerDocument.body,o=jl(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),u=jl(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let d=-r.scrollLeft+t4(e);const i=-r.scrollTop;return Eu(n).direction==="rtl"&&(d+=jl(t.clientWidth,n.clientWidth)-o),{width:o,height:u,x:d,y:i}}function xue(e,t){const r=ql(e),n=kh(e),o=r.visualViewport;let u=n.clientWidth,d=n.clientHeight,i=0,v=0;if(o){u=o.width,d=o.height;const w=QF();(!w||w&&t==="fixed")&&(i=o.offsetLeft,v=o.offsetTop)}return{width:u,height:d,x:i,y:v}}const wue=new Set(["absolute","fixed"]);function bue(e,t){const r=_0(e,!0,t==="fixed"),n=r.top+e.clientTop,o=r.left+e.clientLeft,u=Ah(e)?cy(e):xh(1),d=e.clientWidth*u.x,i=e.clientHeight*u.y,v=o*u.x,w=n*u.y;return{width:d,height:i,x:v,y:w}}function H8(e,t,r){let n;if(t==="viewport")n=xue(e,r);else if(t==="document")n=vue(kh(e));else if(Su(t))n=bue(t,r);else{const o=KH(e);n={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return dA(n)}function QH(e,t){const r=Sp(e);return r===t||!Su(r)||Ly(r)?!1:Eu(r).position==="fixed"||QH(r,t)}function Tue(e,t){const r=t.get(e);if(r)return r;let n=Zw(e,[],!1).filter(i=>Su(i)&&gv(i)!=="body"),o=null;const u=Eu(e).position==="fixed";let d=u?Sp(e):e;for(;Su(d)&&!Ly(d);){const i=Eu(d),v=JF(d);!v&&i.position==="fixed"&&(o=null),(u?!v&&!o:!v&&i.position==="static"&&!!o&&wue.has(o.position)||s2(d)&&!v&&QH(e,d))?n=n.filter(S=>S!==d):o=i,d=Sp(d)}return t.set(e,n),n}function Sue(e){let{element:t,boundary:r,rootBoundary:n,strategy:o}=e;const d=[...r==="clippingAncestors"?tP(t)?[]:Tue(t,this._c):[].concat(r),n],i=d[0],v=d.reduce((w,S)=>{const C=H8(t,S,o);return w.top=jl(C.top,w.top),w.right=Tp(C.right,w.right),w.bottom=Tp(C.bottom,w.bottom),w.left=jl(C.left,w.left),w},H8(t,i,o));return{width:v.right-v.left,height:v.bottom-v.top,x:v.left,y:v.top}}function Eue(e){const{width:t,height:r}=YH(e);return{width:t,height:r}}function Aue(e,t,r){const n=Ah(t),o=kh(t),u=r==="fixed",d=_0(e,!0,u,t);let i={scrollLeft:0,scrollTop:0};const v=xh(0);function w(){v.x=t4(o)}if(n||!n&&!u)if((gv(t)!=="body"||s2(o))&&(i=rP(t)),n){const O=_0(t,!0,u,t);v.x=O.x+t.clientLeft,v.y=O.y+t.clientTop}else o&&w();u&&!n&&o&&w();const S=o&&!n&&!u?JH(o,i):xh(0),C=d.left+i.scrollLeft-v.x-S.x,k=d.top+i.scrollTop-v.y-S.y;return{x:C,y:k,width:d.width,height:d.height}}function ZO(e){return Eu(e).position==="static"}function q8(e,t){if(!Ah(e)||Eu(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return kh(e)===r&&(r=r.ownerDocument.body),r}function eq(e,t){const r=ql(e);if(tP(e))return r;if(!Ah(e)){let o=Sp(e);for(;o&&!Ly(o);){if(Su(o)&&!ZO(o))return o;o=Sp(o)}return r}let n=q8(e,t);for(;n&&lue(n)&&ZO(n);)n=q8(n,t);return n&&Ly(n)&&ZO(n)&&!JF(n)?r:n||due(e)||r}const Cue=async function(e){const t=this.getOffsetParent||eq,r=this.getDimensions,n=await r(e.floating);return{reference:Aue(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Pue(e){return Eu(e).direction==="rtl"}const Iue={convertOffsetParentRelativeRectToViewportRelativeRect:_ue,getDocumentElement:kh,getClippingRect:Sue,getOffsetParent:eq,getElementRects:Cue,getClientRects:yue,getDimensions:Eue,getScale:cy,isElement:Su,isRTL:Pue};function tq(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function kue(e,t){let r=null,n;const o=kh(e);function u(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function d(i,v){i===void 0&&(i=!1),v===void 0&&(v=1),u();const w=e.getBoundingClientRect(),{left:S,top:C,width:k,height:O}=w;if(i||t(),!k||!O)return;const L=VS(C),R=VS(o.clientWidth-(S+k)),N=VS(o.clientHeight-(C+O)),V=VS(S),U={rootMargin:-L+"px "+-R+"px "+-N+"px "+-V+"px",threshold:jl(0,Tp(1,v))||1};let J=!0;function Z(K){const re=K[0].intersectionRatio;if(re!==v){if(!J)return d();re?d(!1,re):n=setTimeout(()=>{d(!1,1e-7)},1e3)}re===1&&!tq(w,e.getBoundingClientRect())&&d(),J=!1}try{r=new IntersectionObserver(Z,{...U,root:o.ownerDocument})}catch{r=new IntersectionObserver(Z,U)}r.observe(e)}return d(!0),u}function Oue(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:u=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:v=!1}=n,w=e4(e),S=o||u?[...w?Zw(w):[],...Zw(t)]:[];S.forEach(V=>{o&&V.addEventListener("scroll",r,{passive:!0}),u&&V.addEventListener("resize",r)});const C=w&&i?kue(w,r):null;let k=-1,O=null;d&&(O=new ResizeObserver(V=>{let[G]=V;G&&G.target===w&&O&&(O.unobserve(t),cancelAnimationFrame(k),k=requestAnimationFrame(()=>{var U;(U=O)==null||U.observe(t)})),r()}),w&&!v&&O.observe(w),O.observe(t));let L,R=v?_0(e):null;v&&N();function N(){const V=_0(e);R&&!tq(R,V)&&r(),R=V,L=requestAnimationFrame(N)}return r(),()=>{var V;S.forEach(G=>{o&&G.removeEventListener("scroll",r),u&&G.removeEventListener("resize",r)}),C==null||C(),(V=O)==null||V.disconnect(),O=null,v&&cancelAnimationFrame(L)}}const Mue=rue,Rue=nue,Due=Qce,Fue=aue,Lue=eue,X8=Jce,Nue=iue,Bue=(e,t,r)=>{const n=new Map,o={platform:Iue,...r},u={...o.platform,_c:n};return Kce(e,t,{...o,platform:u})};var zue=typeof document<"u",jue=function(){},FE=zue?ue.useLayoutEffect:jue;function pA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!pA(e[n],t[n]))return!1;return!0}if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,o[n]))return!1;for(n=r;n--!==0;){const u=o[n];if(!(u==="_owner"&&e.$$typeof)&&!pA(e[u],t[u]))return!1}return!0}return e!==e&&t!==t}function rq(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Z8(e,t){const r=rq(e);return Math.round(t*r)/r}function YO(e){const t=ue.useRef(e);return FE(()=>{t.current=e}),t}function Uue(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:o,elements:{reference:u,floating:d}={},transform:i=!0,whileElementsMounted:v,open:w}=e,[S,C]=ue.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[k,O]=ue.useState(n);pA(k,n)||O(n);const[L,R]=ue.useState(null),[N,V]=ue.useState(null),G=ue.useCallback(ft=>{ft!==K.current&&(K.current=ft,R(ft))},[]),U=ue.useCallback(ft=>{ft!==re.current&&(re.current=ft,V(ft))},[]),J=u||L,Z=d||N,K=ue.useRef(null),re=ue.useRef(null),ge=ue.useRef(S),ve=v!=null,$e=YO(v),Ie=YO(o),ke=YO(w),tt=ue.useCallback(()=>{if(!K.current||!re.current)return;const ft={placement:t,strategy:r,middleware:k};Ie.current&&(ft.platform=Ie.current),Bue(K.current,re.current,ft).then(Ue=>{const It={...Ue,isPositioned:ke.current!==!1};Je.current&&!pA(ge.current,It)&&(ge.current=It,t2.flushSync(()=>{C(It)}))})},[k,t,r,Ie,ke]);FE(()=>{w===!1&&ge.current.isPositioned&&(ge.current.isPositioned=!1,C(ft=>({...ft,isPositioned:!1})))},[w]);const Je=ue.useRef(!1);FE(()=>(Je.current=!0,()=>{Je.current=!1}),[]),FE(()=>{if(J&&(K.current=J),Z&&(re.current=Z),J&&Z){if($e.current)return $e.current(J,Z,tt);tt()}},[J,Z,tt,$e,ve]);const et=ue.useMemo(()=>({reference:K,floating:re,setReference:G,setFloating:U}),[G,U]),at=ue.useMemo(()=>({reference:J,floating:Z}),[J,Z]),pt=ue.useMemo(()=>{const ft={position:r,left:0,top:0};if(!at.floating)return ft;const Ue=Z8(at.floating,S.x),It=Z8(at.floating,S.y);return i?{...ft,transform:"translate("+Ue+"px, "+It+"px)",...rq(at.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Ue,top:It}},[r,i,at.floating,S.x,S.y]);return ue.useMemo(()=>({...S,update:tt,refs:et,elements:at,floatingStyles:pt}),[S,tt,et,at,pt])}const $ue=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:o}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?X8({element:n.current,padding:o}).fn(r):{}:n?X8({element:n,padding:o}).fn(r):{}}}},Vue=(e,t)=>({...Mue(e),options:[e,t]}),Wue=(e,t)=>({...Rue(e),options:[e,t]}),Gue=(e,t)=>({...Nue(e),options:[e,t]}),Hue=(e,t)=>({...Due(e),options:[e,t]}),que=(e,t)=>({...Fue(e),options:[e,t]}),Xue=(e,t)=>({...Lue(e),options:[e,t]}),Zue=(e,t)=>({...$ue(e),options:[e,t]});var Yue="Arrow",nq=ue.forwardRef((e,t)=>{const{children:r,width:n=10,height:o=5,...u}=e;return be.jsx(yi.svg,{...u,ref:t,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:be.jsx("polygon",{points:"0,0 30,0 15,10"})})});nq.displayName=Yue;var Kue=nq;function iq(e){const[t,r]=ue.useState(void 0);return Eh(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const u=o[0];let d,i;if("borderBoxSize"in u){const v=u.borderBoxSize,w=Array.isArray(v)?v[0]:v;d=w.inlineSize,i=w.blockSize}else d=e.offsetWidth,i=e.offsetHeight;r({width:d,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var r4="Popper",[aq,nP]=Rp(r4),[Jue,oq]=aq(r4),sq=e=>{const{__scopePopper:t,children:r}=e,[n,o]=ue.useState(null);return be.jsx(Jue,{scope:t,anchor:n,onAnchorChange:o,children:r})};sq.displayName=r4;var lq="PopperAnchor",cq=ue.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...o}=e,u=oq(lq,r),d=ue.useRef(null),i=bo(t,d);return ue.useEffect(()=>{u.onAnchorChange((n==null?void 0:n.current)||d.current)}),n?null:be.jsx(yi.div,{...o,ref:i})});cq.displayName=lq;var n4="PopperContent",[Que,ehe]=aq(n4),uq=ue.forwardRef((e,t)=>{var Dt,Yt,St,Mt,Sr,Ne;const{__scopePopper:r,side:n="bottom",sideOffset:o=0,align:u="center",alignOffset:d=0,arrowPadding:i=0,avoidCollisions:v=!0,collisionBoundary:w=[],collisionPadding:S=0,sticky:C="partial",hideWhenDetached:k=!1,updatePositionStrategy:O="optimized",onPlaced:L,...R}=e,N=oq(n4,r),[V,G]=ue.useState(null),U=bo(t,un=>G(un)),[J,Z]=ue.useState(null),K=iq(J),re=(K==null?void 0:K.width)??0,ge=(K==null?void 0:K.height)??0,ve=n+(u!=="center"?"-"+u:""),$e=typeof S=="number"?S:{top:0,right:0,bottom:0,left:0,...S},Ie=Array.isArray(w)?w:[w],ke=Ie.length>0,tt={padding:$e,boundary:Ie.filter(rhe),altBoundary:ke},{refs:Je,floatingStyles:et,placement:at,isPositioned:pt,middlewareData:ft}=Uue({strategy:"fixed",placement:ve,whileElementsMounted:(...un)=>Oue(...un,{animationFrame:O==="always"}),elements:{reference:N.anchor},middleware:[Vue({mainAxis:o+ge,alignmentAxis:d}),v&&Wue({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?Gue():void 0,...tt}),v&&Hue({...tt}),que({...tt,apply:({elements:un,rects:kr,availableWidth:Br,availableHeight:Yr})=>{const{width:Tr,height:jn}=kr.reference,Un=un.floating.style;Un.setProperty("--radix-popper-available-width",`${Br}px`),Un.setProperty("--radix-popper-available-height",`${Yr}px`),Un.setProperty("--radix-popper-anchor-width",`${Tr}px`),Un.setProperty("--radix-popper-anchor-height",`${jn}px`)}}),J&&Zue({element:J,padding:i}),nhe({arrowWidth:re,arrowHeight:ge}),k&&Xue({strategy:"referenceHidden",...tt})]}),[Ue,It]=dq(at),Rt=Sh(L);Eh(()=>{pt&&(Rt==null||Rt())},[pt,Rt]);const _e=(Dt=ft.arrow)==null?void 0:Dt.x,Ge=(Yt=ft.arrow)==null?void 0:Yt.y,qe=((St=ft.arrow)==null?void 0:St.centerOffset)!==0,[Xe,yt]=ue.useState();return Eh(()=>{V&&yt(window.getComputedStyle(V).zIndex)},[V]),be.jsx("div",{ref:Je.setFloating,"data-radix-popper-content-wrapper":"",style:{...et,transform:pt?et.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Xe,"--radix-popper-transform-origin":[(Mt=ft.transformOrigin)==null?void 0:Mt.x,(Sr=ft.transformOrigin)==null?void 0:Sr.y].join(" "),...((Ne=ft.hide)==null?void 0:Ne.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:be.jsx(Que,{scope:r,placedSide:Ue,onArrowChange:Z,arrowX:_e,arrowY:Ge,shouldHideArrow:qe,children:be.jsx(yi.div,{"data-side":Ue,"data-align":It,...R,ref:U,style:{...R.style,animation:pt?void 0:"none"}})})})});uq.displayName=n4;var hq="PopperArrow",the={top:"bottom",right:"left",bottom:"top",left:"right"},fq=ue.forwardRef(function(t,r){const{__scopePopper:n,...o}=t,u=ehe(hq,n),d=the[u.placedSide];return be.jsx("span",{ref:u.onArrowChange,style:{position:"absolute",left:u.arrowX,top:u.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[u.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[u.placedSide],visibility:u.shouldHideArrow?"hidden":void 0},children:be.jsx(Kue,{...o,ref:r,style:{...o.style,display:"block"}})})});fq.displayName=hq;function rhe(e){return e!==null}var nhe=e=>({name:"transformOrigin",options:e,fn(t){var N,V,G;const{placement:r,rects:n,middlewareData:o}=t,d=((N=o.arrow)==null?void 0:N.centerOffset)!==0,i=d?0:e.arrowWidth,v=d?0:e.arrowHeight,[w,S]=dq(r),C={start:"0%",center:"50%",end:"100%"}[S],k=(((V=o.arrow)==null?void 0:V.x)??0)+i/2,O=(((G=o.arrow)==null?void 0:G.y)??0)+v/2;let L="",R="";return w==="bottom"?(L=d?C:`${k}px`,R=`${-v}px`):w==="top"?(L=d?C:`${k}px`,R=`${n.floating.height+v}px`):w==="right"?(L=`${-v}px`,R=d?C:`${O}px`):w==="left"&&(L=`${n.floating.width+v}px`,R=d?C:`${O}px`),{data:{x:L,y:R}}}});function dq(e){const[t,r="center"]=e.split("-");return[t,r]}var ihe=sq,i4=cq,pq=uq,mq=fq,[iP,Oqe]=Rp("Tooltip",[nP]),a4=nP(),gq="TooltipProvider",ahe=700,Y8="tooltip.open",[ohe,_q]=iP(gq),yq=e=>{const{__scopeTooltip:t,delayDuration:r=ahe,skipDelayDuration:n=300,disableHoverableContent:o=!1,children:u}=e,d=ue.useRef(!0),i=ue.useRef(!1),v=ue.useRef(0);return ue.useEffect(()=>{const w=v.current;return()=>window.clearTimeout(w)},[]),be.jsx(ohe,{scope:t,isOpenDelayedRef:d,delayDuration:r,onOpen:ue.useCallback(()=>{window.clearTimeout(v.current),d.current=!1},[]),onClose:ue.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>d.current=!0,n)},[n]),isPointerInTransitRef:i,onPointerInTransitChange:ue.useCallback(w=>{i.current=w},[]),disableHoverableContent:o,children:u})};yq.displayName=gq;var vq="Tooltip",[Mqe,aP]=iP(vq),e3="TooltipTrigger",she=ue.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,o=aP(e3,r),u=_q(e3,r),d=a4(r),i=ue.useRef(null),v=bo(t,i,o.onTriggerChange),w=ue.useRef(!1),S=ue.useRef(!1),C=ue.useCallback(()=>w.current=!1,[]);return ue.useEffect(()=>()=>document.removeEventListener("pointerup",C),[C]),be.jsx(i4,{asChild:!0,...d,children:be.jsx(yi.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...n,ref:v,onPointerMove:Bi(e.onPointerMove,k=>{k.pointerType!=="touch"&&!S.current&&!u.isPointerInTransitRef.current&&(o.onTriggerEnter(),S.current=!0)}),onPointerLeave:Bi(e.onPointerLeave,()=>{o.onTriggerLeave(),S.current=!1}),onPointerDown:Bi(e.onPointerDown,()=>{o.open&&o.onClose(),w.current=!0,document.addEventListener("pointerup",C,{once:!0})}),onFocus:Bi(e.onFocus,()=>{w.current||o.onOpen()}),onBlur:Bi(e.onBlur,o.onClose),onClick:Bi(e.onClick,o.onClose)})})});she.displayName=e3;var lhe="TooltipPortal",[Rqe,che]=iP(lhe,{forceMount:void 0}),Ny="TooltipContent",xq=ue.forwardRef((e,t)=>{const r=che(Ny,e.__scopeTooltip),{forceMount:n=r.forceMount,side:o="top",...u}=e,d=aP(Ny,e.__scopeTooltip);return be.jsx(Ih,{present:n||d.open,children:d.disableHoverableContent?be.jsx(wq,{side:o,...u,ref:t}):be.jsx(uhe,{side:o,...u,ref:t})})}),uhe=ue.forwardRef((e,t)=>{const r=aP(Ny,e.__scopeTooltip),n=_q(Ny,e.__scopeTooltip),o=ue.useRef(null),u=bo(t,o),[d,i]=ue.useState(null),{trigger:v,onClose:w}=r,S=o.current,{onPointerInTransitChange:C}=n,k=ue.useCallback(()=>{i(null),C(!1)},[C]),O=ue.useCallback((L,R)=>{const N=L.currentTarget,V={x:L.clientX,y:L.clientY},G=mhe(V,N.getBoundingClientRect()),U=ghe(V,G),J=_he(R.getBoundingClientRect()),Z=vhe([...U,...J]);i(Z),C(!0)},[C]);return ue.useEffect(()=>()=>k(),[k]),ue.useEffect(()=>{if(v&&S){const L=N=>O(N,S),R=N=>O(N,v);return v.addEventListener("pointerleave",L),S.addEventListener("pointerleave",R),()=>{v.removeEventListener("pointerleave",L),S.removeEventListener("pointerleave",R)}}},[v,S,O,k]),ue.useEffect(()=>{if(d){const L=R=>{const N=R.target,V={x:R.clientX,y:R.clientY},G=(v==null?void 0:v.contains(N))||(S==null?void 0:S.contains(N)),U=!yhe(V,d);G?k():U&&(k(),w())};return document.addEventListener("pointermove",L),()=>document.removeEventListener("pointermove",L)}},[v,S,d,w,k]),be.jsx(wq,{...e,ref:u})}),[hhe,fhe]=iP(vq,{isInside:!1}),dhe=Sse("TooltipContent"),wq=ue.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":o,onEscapeKeyDown:u,onPointerDownOutside:d,...i}=e,v=aP(Ny,r),w=a4(r),{onClose:S}=v;return ue.useEffect(()=>(document.addEventListener(Y8,S),()=>document.removeEventListener(Y8,S)),[S]),ue.useEffect(()=>{if(v.trigger){const C=k=>{const O=k.target;O!=null&&O.contains(v.trigger)&&S()};return window.addEventListener("scroll",C,{capture:!0}),()=>window.removeEventListener("scroll",C,{capture:!0})}},[v.trigger,S]),be.jsx(n2,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:C=>C.preventDefault(),onDismiss:S,children:be.jsxs(pq,{"data-state":v.stateAttribute,...w,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[be.jsx(dhe,{children:n}),be.jsx(hhe,{scope:r,isInside:!0,children:be.jsx(Xse,{id:v.contentId,role:"tooltip",children:o||n})})]})})});xq.displayName=Ny;var bq="TooltipArrow",phe=ue.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,o=a4(r);return fhe(bq,r).isInside?null:be.jsx(mq,{...o,...n,ref:t})});phe.displayName=bq;function mhe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),u=Math.abs(t.left-e.x);switch(Math.min(r,n,o,u)){case u:return"left";case o:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function ghe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function _he(e){const{top:t,right:r,bottom:n,left:o}=e;return[{x:o,y:t},{x:r,y:t},{x:r,y:n},{x:o,y:n}]}function yhe(e,t){const{x:r,y:n}=e;let o=!1;for(let u=0,d=t.length-1;u<t.length;d=u++){const i=t[u],v=t[d],w=i.x,S=i.y,C=v.x,k=v.y;S>n!=k>n&&r<(C-w)*(n-S)/(k-S)+w&&(o=!o)}return o}function vhe(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),xhe(t)}function xhe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const o=e[n];for(;t.length>=2;){const u=t[t.length-1],d=t[t.length-2];if((u.x-d.x)*(o.y-d.y)>=(u.y-d.y)*(o.x-d.x))t.pop();else break}t.push(o)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const o=e[n];for(;r.length>=2;){const u=r[r.length-1],d=r[r.length-2];if((u.x-d.x)*(o.y-d.y)>=(u.y-d.y)*(o.x-d.x))r.pop();else break}r.push(o)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var whe=yq,Tq=xq;const bhe=whe,The=ue.forwardRef(({className:e,sideOffset:t=4,...r},n)=>be.jsx(Tq,{ref:n,sideOffset:t,className:Ci("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));The.displayName=Tq.displayName;var oP=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},sP=typeof window>"u"||"Deno"in globalThis;function au(){}function She(e,t){return typeof e=="function"?e(t):e}function Ehe(e){return typeof e=="number"&&e>=0&&e!==1/0}function Ahe(e,t){return Math.max(e+(t||0)-Date.now(),0)}function t3(e,t){return typeof e=="function"?e(t):e}function Che(e,t){return typeof e=="function"?e(t):e}function K8(e,t){const{type:r="all",exact:n,fetchStatus:o,predicate:u,queryKey:d,stale:i}=e;if(d){if(n){if(t.queryHash!==o4(d,t.options))return!1}else if(!Kw(t.queryKey,d))return!1}if(r!=="all"){const v=t.isActive();if(r==="active"&&!v||r==="inactive"&&v)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||o&&o!==t.state.fetchStatus||u&&!u(t))}function J8(e,t){const{exact:r,status:n,predicate:o,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(r){if(Yw(t.options.mutationKey)!==Yw(u))return!1}else if(!Kw(t.options.mutationKey,u))return!1}return!(n&&t.state.status!==n||o&&!o(t))}function o4(e,t){return((t==null?void 0:t.queryKeyHashFn)||Yw)(e)}function Yw(e){return JSON.stringify(e,(t,r)=>r3(r)?Object.keys(r).sort().reduce((n,o)=>(n[o]=r[o],n),{}):r)}function Kw(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Kw(e[r],t[r])):!1}function Sq(e,t){if(e===t)return e;const r=Q8(e)&&Q8(t);if(r||r3(e)&&r3(t)){const n=r?e:Object.keys(e),o=n.length,u=r?t:Object.keys(t),d=u.length,i=r?[]:{},v=new Set(n);let w=0;for(let S=0;S<d;S++){const C=r?S:u[S];(!r&&v.has(C)||r)&&e[C]===void 0&&t[C]===void 0?(i[C]=void 0,w++):(i[C]=Sq(e[C],t[C]),i[C]===e[C]&&e[C]!==void 0&&w++)}return o===d&&w===o?e:i}return t}function Q8(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function r3(e){if(!ej(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!ej(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ej(e){return Object.prototype.toString.call(e)==="[object Object]"}function Phe(e){return new Promise(t=>{setTimeout(t,e)})}function Ihe(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Sq(e,t):t}function khe(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function Ohe(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var s4=Symbol();function Eq(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===s4?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Zm,Xd,xy,j9,Mhe=(j9=class extends oP{constructor(){super();Li(this,Zm);Li(this,Xd);Li(this,xy);Gn(this,xy,t=>{if(!sP&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){fr(this,Xd)||this.setEventListener(fr(this,xy))}onUnsubscribe(){var t;this.hasListeners()||((t=fr(this,Xd))==null||t.call(this),Gn(this,Xd,void 0))}setEventListener(t){var r;Gn(this,xy,t),(r=fr(this,Xd))==null||r.call(this),Gn(this,Xd,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){fr(this,Zm)!==t&&(Gn(this,Zm,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof fr(this,Zm)=="boolean"?fr(this,Zm):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Zm=new WeakMap,Xd=new WeakMap,xy=new WeakMap,j9),Aq=new Mhe,wy,Zd,by,U9,Rhe=(U9=class extends oP{constructor(){super();Li(this,wy,!0);Li(this,Zd);Li(this,by);Gn(this,by,t=>{if(!sP&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){fr(this,Zd)||this.setEventListener(fr(this,by))}onUnsubscribe(){var t;this.hasListeners()||((t=fr(this,Zd))==null||t.call(this),Gn(this,Zd,void 0))}setEventListener(t){var r;Gn(this,by,t),(r=fr(this,Zd))==null||r.call(this),Gn(this,Zd,t(this.setOnline.bind(this)))}setOnline(t){fr(this,wy)!==t&&(Gn(this,wy,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return fr(this,wy)}},wy=new WeakMap,Zd=new WeakMap,by=new WeakMap,U9),mA=new Rhe;function Dhe(){let e,t;const r=new Promise((o,u)=>{e=o,t=u});r.status="pending",r.catch(()=>{});function n(o){Object.assign(r,o),delete r.resolve,delete r.reject}return r.resolve=o=>{n({status:"fulfilled",value:o}),e(o)},r.reject=o=>{n({status:"rejected",reason:o}),t(o)},r}function Fhe(e){return Math.min(1e3*2**e,3e4)}function Cq(e){return(e??"online")==="online"?mA.isOnline():!0}var Pq=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function KO(e){return e instanceof Pq}function Iq(e){let t=!1,r=0,n=!1,o;const u=Dhe(),d=R=>{var N;n||(k(new Pq(R)),(N=e.abort)==null||N.call(e))},i=()=>{t=!0},v=()=>{t=!1},w=()=>Aq.isFocused()&&(e.networkMode==="always"||mA.isOnline())&&e.canRun(),S=()=>Cq(e.networkMode)&&e.canRun(),C=R=>{var N;n||(n=!0,(N=e.onSuccess)==null||N.call(e,R),o==null||o(),u.resolve(R))},k=R=>{var N;n||(n=!0,(N=e.onError)==null||N.call(e,R),o==null||o(),u.reject(R))},O=()=>new Promise(R=>{var N;o=V=>{(n||w())&&R(V)},(N=e.onPause)==null||N.call(e)}).then(()=>{var R;o=void 0,n||(R=e.onContinue)==null||R.call(e)}),L=()=>{if(n)return;let R;const N=r===0?e.initialPromise:void 0;try{R=N??e.fn()}catch(V){R=Promise.reject(V)}Promise.resolve(R).then(C).catch(V=>{var K;if(n)return;const G=e.retry??(sP?0:3),U=e.retryDelay??Fhe,J=typeof U=="function"?U(r,V):U,Z=G===!0||typeof G=="number"&&r<G||typeof G=="function"&&G(r,V);if(t||!Z){k(V);return}r++,(K=e.onFail)==null||K.call(e,r,V),Phe(J).then(()=>w()?void 0:O()).then(()=>{t?k(V):L()})})};return{promise:u,cancel:d,continue:()=>(o==null||o(),u),cancelRetry:i,continueRetry:v,canStart:S,start:()=>(S()?L():O().then(L),u)}}var Lhe=e=>setTimeout(e,0);function Nhe(){let e=[],t=0,r=i=>{i()},n=i=>{i()},o=Lhe;const u=i=>{t?e.push(i):o(()=>{r(i)})},d=()=>{const i=e;e=[],i.length&&o(()=>{n(()=>{i.forEach(v=>{r(v)})})})};return{batch:i=>{let v;t++;try{v=i()}finally{t--,t||d()}return v},batchCalls:i=>(...v)=>{u(()=>{i(...v)})},schedule:u,setNotifyFunction:i=>{r=i},setBatchNotifyFunction:i=>{n=i},setScheduler:i=>{o=i}}}var Js=Nhe(),Ym,$9,kq=($9=class{constructor(){Li(this,Ym)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ehe(this.gcTime)&&Gn(this,Ym,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(sP?1/0:5*60*1e3))}clearGcTimeout(){fr(this,Ym)&&(clearTimeout(fr(this,Ym)),Gn(this,Ym,void 0))}},Ym=new WeakMap,$9),Ty,Km,xc,Jm,bs,Xb,Qm,ou,hf,V9,Bhe=(V9=class extends kq{constructor(t){super();Li(this,ou);Li(this,Ty);Li(this,Km);Li(this,xc);Li(this,Jm);Li(this,bs);Li(this,Xb);Li(this,Qm);Gn(this,Qm,!1),Gn(this,Xb,t.defaultOptions),this.setOptions(t.options),this.observers=[],Gn(this,Jm,t.client),Gn(this,xc,fr(this,Jm).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Gn(this,Ty,jhe(this.options)),this.state=t.state??fr(this,Ty),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=fr(this,bs))==null?void 0:t.promise}setOptions(t){this.options={...fr(this,Xb),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&fr(this,xc).remove(this)}setData(t,r){const n=Ihe(this.state.data,t,this.options);return ys(this,ou,hf).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ys(this,ou,hf).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,o;const r=(n=fr(this,bs))==null?void 0:n.promise;return(o=fr(this,bs))==null||o.cancel(t),r?r.then(au).catch(au):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(fr(this,Ty))}isActive(){return this.observers.some(t=>Che(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===s4||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>t3(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Ahe(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=fr(this,bs))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=fr(this,bs))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),fr(this,xc).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(fr(this,bs)&&(fr(this,Qm)?fr(this,bs).cancel({revert:!0}):fr(this,bs).cancelRetry()),this.scheduleGc()),fr(this,xc).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ys(this,ou,hf).call(this,{type:"invalidate"})}fetch(t,r){var w,S,C;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(fr(this,bs))return fr(this,bs).continueRetry(),fr(this,bs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const k=this.observers.find(O=>O.options.queryFn);k&&this.setOptions(k.options)}const n=new AbortController,o=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(Gn(this,Qm,!0),n.signal)})},u=()=>{const k=Eq(this.options,r),L=(()=>{const R={client:fr(this,Jm),queryKey:this.queryKey,meta:this.meta};return o(R),R})();return Gn(this,Qm,!1),this.options.persister?this.options.persister(k,L,this):k(L)},i=(()=>{const k={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:fr(this,Jm),state:this.state,fetchFn:u};return o(k),k})();(w=this.options.behavior)==null||w.onFetch(i,this),Gn(this,Km,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((S=i.fetchOptions)==null?void 0:S.meta))&&ys(this,ou,hf).call(this,{type:"fetch",meta:(C=i.fetchOptions)==null?void 0:C.meta});const v=k=>{var O,L,R,N;KO(k)&&k.silent||ys(this,ou,hf).call(this,{type:"error",error:k}),KO(k)||((L=(O=fr(this,xc).config).onError)==null||L.call(O,k,this),(N=(R=fr(this,xc).config).onSettled)==null||N.call(R,this.state.data,k,this)),this.scheduleGc()};return Gn(this,bs,Iq({initialPromise:r==null?void 0:r.initialPromise,fn:i.fetchFn,abort:n.abort.bind(n),onSuccess:k=>{var O,L,R,N;if(k===void 0){v(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(k)}catch(V){v(V);return}(L=(O=fr(this,xc).config).onSuccess)==null||L.call(O,k,this),(N=(R=fr(this,xc).config).onSettled)==null||N.call(R,k,this.state.error,this),this.scheduleGc()},onError:v,onFail:(k,O)=>{ys(this,ou,hf).call(this,{type:"failed",failureCount:k,error:O})},onPause:()=>{ys(this,ou,hf).call(this,{type:"pause"})},onContinue:()=>{ys(this,ou,hf).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),fr(this,bs).start()}},Ty=new WeakMap,Km=new WeakMap,xc=new WeakMap,Jm=new WeakMap,bs=new WeakMap,Xb=new WeakMap,Qm=new WeakMap,ou=new WeakSet,hf=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...zhe(n.data,this.options),fetchMeta:t.meta??null};case"success":return Gn(this,Km,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return KO(o)&&o.revert&&fr(this,Km)?{...fr(this,Km),fetchStatus:"idle"}:{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Js.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),fr(this,xc).notify({query:this,type:"updated",action:t})})},V9);function zhe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Cq(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function jhe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var sh,W9,Uhe=(W9=class extends oP{constructor(t={}){super();Li(this,sh);this.config=t,Gn(this,sh,new Map)}build(t,r,n){const o=r.queryKey,u=r.queryHash??o4(o,r);let d=this.get(u);return d||(d=new Bhe({client:t,queryKey:o,queryHash:u,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(o)}),this.add(d)),d}add(t){fr(this,sh).has(t.queryHash)||(fr(this,sh).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=fr(this,sh).get(t.queryHash);r&&(t.destroy(),r===t&&fr(this,sh).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Js.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return fr(this,sh).get(t)}getAll(){return[...fr(this,sh).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>K8(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>K8(t,n)):r}notify(t){Js.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Js.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Js.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},sh=new WeakMap,W9),lh,Xs,e0,ch,jd,G9,$he=(G9=class extends kq{constructor(t){super();Li(this,ch);Li(this,lh);Li(this,Xs);Li(this,e0);this.mutationId=t.mutationId,Gn(this,Xs,t.mutationCache),Gn(this,lh,[]),this.state=t.state||Vhe(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){fr(this,lh).includes(t)||(fr(this,lh).push(t),this.clearGcTimeout(),fr(this,Xs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Gn(this,lh,fr(this,lh).filter(r=>r!==t)),this.scheduleGc(),fr(this,Xs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){fr(this,lh).length||(this.state.status==="pending"?this.scheduleGc():fr(this,Xs).remove(this))}continue(){var t;return((t=fr(this,e0))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var u,d,i,v,w,S,C,k,O,L,R,N,V,G,U,J,Z,K,re,ge;const r=()=>{ys(this,ch,jd).call(this,{type:"continue"})};Gn(this,e0,Iq({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(ve,$e)=>{ys(this,ch,jd).call(this,{type:"failed",failureCount:ve,error:$e})},onPause:()=>{ys(this,ch,jd).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>fr(this,Xs).canRun(this)}));const n=this.state.status==="pending",o=!fr(this,e0).canStart();try{if(n)r();else{ys(this,ch,jd).call(this,{type:"pending",variables:t,isPaused:o}),await((d=(u=fr(this,Xs).config).onMutate)==null?void 0:d.call(u,t,this));const $e=await((v=(i=this.options).onMutate)==null?void 0:v.call(i,t));$e!==this.state.context&&ys(this,ch,jd).call(this,{type:"pending",context:$e,variables:t,isPaused:o})}const ve=await fr(this,e0).start();return await((S=(w=fr(this,Xs).config).onSuccess)==null?void 0:S.call(w,ve,t,this.state.context,this)),await((k=(C=this.options).onSuccess)==null?void 0:k.call(C,ve,t,this.state.context)),await((L=(O=fr(this,Xs).config).onSettled)==null?void 0:L.call(O,ve,null,this.state.variables,this.state.context,this)),await((N=(R=this.options).onSettled)==null?void 0:N.call(R,ve,null,t,this.state.context)),ys(this,ch,jd).call(this,{type:"success",data:ve}),ve}catch(ve){try{throw await((G=(V=fr(this,Xs).config).onError)==null?void 0:G.call(V,ve,t,this.state.context,this)),await((J=(U=this.options).onError)==null?void 0:J.call(U,ve,t,this.state.context)),await((K=(Z=fr(this,Xs).config).onSettled)==null?void 0:K.call(Z,void 0,ve,this.state.variables,this.state.context,this)),await((ge=(re=this.options).onSettled)==null?void 0:ge.call(re,void 0,ve,t,this.state.context)),ve}finally{ys(this,ch,jd).call(this,{type:"error",error:ve})}}finally{fr(this,Xs).runNext(this)}}},lh=new WeakMap,Xs=new WeakMap,e0=new WeakMap,ch=new WeakSet,jd=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Js.batch(()=>{fr(this,lh).forEach(n=>{n.onMutationUpdate(t)}),fr(this,Xs).notify({mutation:this,type:"updated",action:t})})},G9);function Vhe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var mf,su,Zb,H9,Whe=(H9=class extends oP{constructor(t={}){super();Li(this,mf);Li(this,su);Li(this,Zb);this.config=t,Gn(this,mf,new Set),Gn(this,su,new Map),Gn(this,Zb,0)}build(t,r,n){const o=new $he({mutationCache:this,mutationId:++bS(this,Zb)._,options:t.defaultMutationOptions(r),state:n});return this.add(o),o}add(t){fr(this,mf).add(t);const r=WS(t);if(typeof r=="string"){const n=fr(this,su).get(r);n?n.push(t):fr(this,su).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(fr(this,mf).delete(t)){const r=WS(t);if(typeof r=="string"){const n=fr(this,su).get(r);if(n)if(n.length>1){const o=n.indexOf(t);o!==-1&&n.splice(o,1)}else n[0]===t&&fr(this,su).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=WS(t);if(typeof r=="string"){const n=fr(this,su).get(r),o=n==null?void 0:n.find(u=>u.state.status==="pending");return!o||o===t}else return!0}runNext(t){var n;const r=WS(t);if(typeof r=="string"){const o=(n=fr(this,su).get(r))==null?void 0:n.find(u=>u!==t&&u.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Js.batch(()=>{fr(this,mf).forEach(t=>{this.notify({type:"removed",mutation:t})}),fr(this,mf).clear(),fr(this,su).clear()})}getAll(){return Array.from(fr(this,mf))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>J8(r,n))}findAll(t={}){return this.getAll().filter(r=>J8(t,r))}notify(t){Js.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Js.batch(()=>Promise.all(t.map(r=>r.continue().catch(au))))}},mf=new WeakMap,su=new WeakMap,Zb=new WeakMap,H9);function WS(e){var t;return(t=e.options.scope)==null?void 0:t.id}function tj(e){return{onFetch:(t,r)=>{var S,C,k,O,L;const n=t.options,o=(k=(C=(S=t.fetchOptions)==null?void 0:S.meta)==null?void 0:C.fetchMore)==null?void 0:k.direction,u=((O=t.state.data)==null?void 0:O.pages)||[],d=((L=t.state.data)==null?void 0:L.pageParams)||[];let i={pages:[],pageParams:[]},v=0;const w=async()=>{let R=!1;const N=U=>{Object.defineProperty(U,"signal",{enumerable:!0,get:()=>(t.signal.aborted?R=!0:t.signal.addEventListener("abort",()=>{R=!0}),t.signal)})},V=Eq(t.options,t.fetchOptions),G=async(U,J,Z)=>{if(R)return Promise.reject();if(J==null&&U.pages.length)return Promise.resolve(U);const re=(()=>{const Ie={client:t.client,queryKey:t.queryKey,pageParam:J,direction:Z?"backward":"forward",meta:t.options.meta};return N(Ie),Ie})(),ge=await V(re),{maxPages:ve}=t.options,$e=Z?Ohe:khe;return{pages:$e(U.pages,ge,ve),pageParams:$e(U.pageParams,J,ve)}};if(o&&u.length){const U=o==="backward",J=U?Ghe:rj,Z={pages:u,pageParams:d},K=J(n,Z);i=await G(Z,K,U)}else{const U=e??u.length;do{const J=v===0?d[0]??n.initialPageParam:rj(n,i);if(v>0&&J==null)break;i=await G(i,J),v++}while(v<U)}return i};t.options.persister?t.fetchFn=()=>{var R,N;return(N=(R=t.options).persister)==null?void 0:N.call(R,w,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=w}}}function rj(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Ghe(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Za,Yd,Kd,Sy,Ey,Jd,Ay,Cy,q9,Hhe=(q9=class{constructor(e={}){Li(this,Za);Li(this,Yd);Li(this,Kd);Li(this,Sy);Li(this,Ey);Li(this,Jd);Li(this,Ay);Li(this,Cy);Gn(this,Za,e.queryCache||new Uhe),Gn(this,Yd,e.mutationCache||new Whe),Gn(this,Kd,e.defaultOptions||{}),Gn(this,Sy,new Map),Gn(this,Ey,new Map),Gn(this,Jd,0)}mount(){bS(this,Jd)._++,fr(this,Jd)===1&&(Gn(this,Ay,Aq.subscribe(async e=>{e&&(await this.resumePausedMutations(),fr(this,Za).onFocus())})),Gn(this,Cy,mA.subscribe(async e=>{e&&(await this.resumePausedMutations(),fr(this,Za).onOnline())})))}unmount(){var e,t;bS(this,Jd)._--,fr(this,Jd)===0&&((e=fr(this,Ay))==null||e.call(this),Gn(this,Ay,void 0),(t=fr(this,Cy))==null||t.call(this),Gn(this,Cy,void 0))}isFetching(e){return fr(this,Za).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return fr(this,Yd).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=fr(this,Za).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=fr(this,Za).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(t3(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return fr(this,Za).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),o=fr(this,Za).get(n.queryHash),u=o==null?void 0:o.state.data,d=She(t,u);if(d!==void 0)return fr(this,Za).build(this,n).setData(d,{...r,manual:!0})}setQueriesData(e,t,r){return Js.batch(()=>fr(this,Za).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=fr(this,Za).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=fr(this,Za);Js.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=fr(this,Za);return Js.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Js.batch(()=>fr(this,Za).findAll(e).map(o=>o.cancel(r)));return Promise.all(n).then(au).catch(au)}invalidateQueries(e,t={}){return Js.batch(()=>(fr(this,Za).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Js.batch(()=>fr(this,Za).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let u=o.fetch(void 0,r);return r.throwOnError||(u=u.catch(au)),o.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(n).then(au)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=fr(this,Za).build(this,t);return r.isStaleByTime(t3(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(au).catch(au)}fetchInfiniteQuery(e){return e.behavior=tj(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(au).catch(au)}ensureInfiniteQueryData(e){return e.behavior=tj(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return mA.isOnline()?fr(this,Yd).resumePausedMutations():Promise.resolve()}getQueryCache(){return fr(this,Za)}getMutationCache(){return fr(this,Yd)}getDefaultOptions(){return fr(this,Kd)}setDefaultOptions(e){Gn(this,Kd,e)}setQueryDefaults(e,t){fr(this,Sy).set(Yw(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...fr(this,Sy).values()],r={};return t.forEach(n=>{Kw(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){fr(this,Ey).set(Yw(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...fr(this,Ey).values()],r={};return t.forEach(n=>{Kw(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...fr(this,Kd).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=o4(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===s4&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...fr(this,Kd).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){fr(this,Za).clear(),fr(this,Yd).clear()}},Za=new WeakMap,Yd=new WeakMap,Kd=new WeakMap,Sy=new WeakMap,Ey=new WeakMap,Jd=new WeakMap,Ay=new WeakMap,Cy=new WeakMap,q9),qhe=ue.createContext(void 0),Xhe=({client:e,children:t})=>(ue.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),be.jsx(qhe.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gA(){return gA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gA.apply(this,arguments)}var rp;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(rp||(rp={}));const nj="popstate";function Zhe(e){e===void 0&&(e={});function t(n,o){let{pathname:u,search:d,hash:i}=n.location;return n3("",{pathname:u,search:d,hash:i},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(n,o){return typeof o=="string"?o:Mq(o)}return Khe(t,r,null,e)}function _l(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Oq(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Yhe(){return Math.random().toString(36).substr(2,8)}function ij(e,t){return{usr:e.state,key:e.key,idx:t}}function n3(e,t,r,n){return r===void 0&&(r=null),gA({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?lP(t):t,{state:r,key:t&&t.key||n||Yhe()})}function Mq(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function lP(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Khe(e,t,r,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:u=!1}=n,d=o.history,i=rp.Pop,v=null,w=S();w==null&&(w=0,d.replaceState(gA({},d.state,{idx:w}),""));function S(){return(d.state||{idx:null}).idx}function C(){i=rp.Pop;let N=S(),V=N==null?null:N-w;w=N,v&&v({action:i,location:R.location,delta:V})}function k(N,V){i=rp.Push;let G=n3(R.location,N,V);w=S()+1;let U=ij(G,w),J=R.createHref(G);try{d.pushState(U,"",J)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;o.location.assign(J)}u&&v&&v({action:i,location:R.location,delta:1})}function O(N,V){i=rp.Replace;let G=n3(R.location,N,V);w=S();let U=ij(G,w),J=R.createHref(G);d.replaceState(U,"",J),u&&v&&v({action:i,location:R.location,delta:0})}function L(N){let V=o.location.origin!=="null"?o.location.origin:o.location.href,G=typeof N=="string"?N:Mq(N);return G=G.replace(/ $/,"%20"),_l(V,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,V)}let R={get action(){return i},get location(){return e(o,d)},listen(N){if(v)throw new Error("A history only accepts one active listener");return o.addEventListener(nj,C),v=N,()=>{o.removeEventListener(nj,C),v=null}},createHref(N){return t(o,N)},createURL:L,encodeLocation(N){let V=L(N);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:k,replace:O,go(N){return d.go(N)}};return R}var aj;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(aj||(aj={}));function Jhe(e,t,r){return r===void 0&&(r="/"),Qhe(e,t,r,!1)}function Qhe(e,t,r,n){let o=typeof t=="string"?lP(t):t,u=Fq(o.pathname||"/",r);if(u==null)return null;let d=Rq(e);efe(d);let i=null;for(let v=0;i==null&&v<d.length;++v){let w=hfe(u);i=cfe(d[v],w,n)}return i}function Rq(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let o=(u,d,i)=>{let v={relativePath:i===void 0?u.path||"":i,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};v.relativePath.startsWith("/")&&(_l(v.relativePath.startsWith(n),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(n.length));let w=uy([n,v.relativePath]),S=r.concat(v);u.children&&u.children.length>0&&(_l(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),Rq(u.children,t,S,w)),!(u.path==null&&!u.index)&&t.push({path:w,score:sfe(w,u.index),routesMeta:S})};return e.forEach((u,d)=>{var i;if(u.path===""||!((i=u.path)!=null&&i.includes("?")))o(u,d);else for(let v of Dq(u.path))o(u,d,v)}),t}function Dq(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,o=r.endsWith("?"),u=r.replace(/\?$/,"");if(n.length===0)return o?[u,""]:[u];let d=Dq(n.join("/")),i=[];return i.push(...d.map(v=>v===""?u:[u,v].join("/"))),o&&i.push(...d),i.map(v=>e.startsWith("/")&&v===""?"/":v)}function efe(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:lfe(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const tfe=/^:[\w-]+$/,rfe=3,nfe=2,ife=1,afe=10,ofe=-2,oj=e=>e==="*";function sfe(e,t){let r=e.split("/"),n=r.length;return r.some(oj)&&(n+=ofe),t&&(n+=nfe),r.filter(o=>!oj(o)).reduce((o,u)=>o+(tfe.test(u)?rfe:u===""?ife:afe),n)}function lfe(e,t){return e.length===t.length&&e.slice(0,-1).every((n,o)=>n===t[o])?e[e.length-1]-t[t.length-1]:0}function cfe(e,t,r){let{routesMeta:n}=e,o={},u="/",d=[];for(let i=0;i<n.length;++i){let v=n[i],w=i===n.length-1,S=u==="/"?t:t.slice(u.length)||"/",C=sj({path:v.relativePath,caseSensitive:v.caseSensitive,end:w},S),k=v.route;if(!C&&w&&r&&!n[n.length-1].route.index&&(C=sj({path:v.relativePath,caseSensitive:v.caseSensitive,end:!1},S)),!C)return null;Object.assign(o,C.params),d.push({params:o,pathname:uy([u,C.pathname]),pathnameBase:ffe(uy([u,C.pathnameBase])),route:k}),C.pathnameBase!=="/"&&(u=uy([u,C.pathnameBase]))}return d}function sj(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=ufe(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),i=o.slice(1);return{params:n.reduce((w,S,C)=>{let{paramName:k,isOptional:O}=S;if(k==="*"){let R=i[C]||"";d=u.slice(0,u.length-R.length).replace(/(.)\/+$/,"$1")}const L=i[C];return O&&!L?w[k]=void 0:w[k]=(L||"").replace(/%2F/g,"/"),w},{}),pathname:u,pathnameBase:d,pattern:e}}function ufe(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Oq(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,i,v)=>(n.push({paramName:i,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}function hfe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Oq(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Fq(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const uy=e=>e.join("/").replace(/\/\/+/g,"/"),ffe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function dfe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Lq=["post","put","patch","delete"];new Set(Lq);const pfe=["get",...Lq];new Set(pfe);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _A(){return _A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_A.apply(this,arguments)}const mfe=ue.createContext(null),gfe=ue.createContext(null),Nq=ue.createContext(null),cP=ue.createContext(null),uP=ue.createContext({outlet:null,matches:[],isDataRoute:!1}),Bq=ue.createContext(null);function l4(){return ue.useContext(cP)!=null}function zq(){return l4()||_l(!1),ue.useContext(cP).location}function _fe(e,t){return yfe(e,t)}function yfe(e,t,r,n){l4()||_l(!1);let{navigator:o}=ue.useContext(Nq),{matches:u}=ue.useContext(uP),d=u[u.length-1],i=d?d.params:{};d&&d.pathname;let v=d?d.pathnameBase:"/";d&&d.route;let w=zq(),S;if(t){var C;let N=typeof t=="string"?lP(t):t;v==="/"||(C=N.pathname)!=null&&C.startsWith(v)||_l(!1),S=N}else S=w;let k=S.pathname||"/",O=k;if(v!=="/"){let N=v.replace(/^\//,"").split("/");O="/"+k.replace(/^\//,"").split("/").slice(N.length).join("/")}let L=Jhe(e,{pathname:O}),R=Tfe(L&&L.map(N=>Object.assign({},N,{params:Object.assign({},i,N.params),pathname:uy([v,o.encodeLocation?o.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?v:uy([v,o.encodeLocation?o.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),u,r,n);return t&&R?ue.createElement(cP.Provider,{value:{location:_A({pathname:"/",search:"",hash:"",state:null,key:"default"},S),navigationType:rp.Pop}},R):R}function vfe(){let e=Cfe(),t=dfe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ue.createElement(ue.Fragment,null,ue.createElement("h2",null,"Unexpected Application Error!"),ue.createElement("h3",{style:{fontStyle:"italic"}},t),r?ue.createElement("pre",{style:o},r):null,null)}const xfe=ue.createElement(vfe,null);class wfe extends ue.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ue.createElement(uP.Provider,{value:this.props.routeContext},ue.createElement(Bq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bfe(e){let{routeContext:t,match:r,children:n}=e,o=ue.useContext(mfe);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),ue.createElement(uP.Provider,{value:t},n)}function Tfe(e,t,r,n){var o;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var u;if(!r)return null;if(r.errors)e=r.matches;else if((u=n)!=null&&u.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let d=e,i=(o=r)==null?void 0:o.errors;if(i!=null){let S=d.findIndex(C=>C.route.id&&(i==null?void 0:i[C.route.id])!==void 0);S>=0||_l(!1),d=d.slice(0,Math.min(d.length,S+1))}let v=!1,w=-1;if(r&&n&&n.v7_partialHydration)for(let S=0;S<d.length;S++){let C=d[S];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(w=S),C.route.id){let{loaderData:k,errors:O}=r,L=C.route.loader&&k[C.route.id]===void 0&&(!O||O[C.route.id]===void 0);if(C.route.lazy||L){v=!0,w>=0?d=d.slice(0,w+1):d=[d[0]];break}}}return d.reduceRight((S,C,k)=>{let O,L=!1,R=null,N=null;r&&(O=i&&C.route.id?i[C.route.id]:void 0,R=C.route.errorElement||xfe,v&&(w<0&&k===0?(L=!0,N=null):w===k&&(L=!0,N=C.route.hydrateFallbackElement||null)));let V=t.concat(d.slice(0,k+1)),G=()=>{let U;return O?U=R:L?U=N:C.route.Component?U=ue.createElement(C.route.Component,null):C.route.element?U=C.route.element:U=S,ue.createElement(bfe,{match:C,routeContext:{outlet:S,matches:V,isDataRoute:r!=null},children:U})};return r&&(C.route.ErrorBoundary||C.route.errorElement||k===0)?ue.createElement(wfe,{location:r.location,revalidation:r.revalidation,component:R,error:O,children:G(),routeContext:{outlet:null,matches:V,isDataRoute:!0}}):G()},null)}var i3=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(i3||{});function Sfe(e){let t=ue.useContext(gfe);return t||_l(!1),t}function Efe(e){let t=ue.useContext(uP);return t||_l(!1),t}function Afe(e){let t=Efe(),r=t.matches[t.matches.length-1];return r.route.id||_l(!1),r.route.id}function Cfe(){var e;let t=ue.useContext(Bq),r=Sfe(i3.UseRouteError),n=Afe(i3.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Pfe(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function a3(e){_l(!1)}function Ife(e){let{basename:t="/",children:r=null,location:n,navigationType:o=rp.Pop,navigator:u,static:d=!1,future:i}=e;l4()&&_l(!1);let v=t.replace(/^\/*/,"/"),w=ue.useMemo(()=>({basename:v,navigator:u,static:d,future:_A({v7_relativeSplatPath:!1},i)}),[v,i,u,d]);typeof n=="string"&&(n=lP(n));let{pathname:S="/",search:C="",hash:k="",state:O=null,key:L="default"}=n,R=ue.useMemo(()=>{let N=Fq(S,v);return N==null?null:{location:{pathname:N,search:C,hash:k,state:O,key:L},navigationType:o}},[v,S,C,k,O,L,o]);return R==null?null:ue.createElement(Nq.Provider,{value:w},ue.createElement(cP.Provider,{children:r,value:R}))}function kfe(e){let{children:t,location:r}=e;return _fe(o3(t),r)}new Promise(()=>{});function o3(e,t){t===void 0&&(t=[]);let r=[];return ue.Children.forEach(e,(n,o)=>{if(!ue.isValidElement(n))return;let u=[...t,o];if(n.type===ue.Fragment){r.push.apply(r,o3(n.props.children,u));return}n.type!==a3&&_l(!1),!n.props.index||!n.props.children||_l(!1);let d={id:n.props.id||u.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(d.children=o3(n.props.children,u)),r.push(d)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Ofe="6";try{window.__reactRouterVersion=Ofe}catch{}const Mfe="startTransition",lj=QD[Mfe];function Rfe(e){let{basename:t,children:r,future:n,window:o}=e,u=ue.useRef();u.current==null&&(u.current=Zhe({window:o,v5Compat:!0}));let d=u.current,[i,v]=ue.useState({action:d.action,location:d.location}),{v7_startTransition:w}=n||{},S=ue.useCallback(C=>{w&&lj?lj(()=>v(C)):v(C)},[v,w]);return ue.useLayoutEffect(()=>d.listen(S),[d,S]),ue.useEffect(()=>Pfe(n),[n]),ue.createElement(Ife,{basename:t,children:r,location:i.location,navigationType:i.action,navigator:d,future:n})}var cj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(cj||(cj={}));var uj;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(uj||(uj={}));const Dfe=o2("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ec=ue.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...o},u)=>{const d=n?bse:"button";return be.jsx(d,{className:Ci(Dfe({variant:t,size:r,className:e})),ref:u,...o})});Ec.displayName="Button";const rw=ue.forwardRef(({className:e,type:t,...r},n)=>be.jsx("input",{type:t,className:Ci("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));rw.displayName="Input";const Cc=ue.forwardRef(({className:e,...t},r)=>be.jsx("div",{ref:r,className:Ci("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Cc.displayName="Card";const pu=ue.forwardRef(({className:e,...t},r)=>be.jsx("div",{ref:r,className:Ci("flex flex-col space-y-1.5 p-6",e),...t}));pu.displayName="CardHeader";const mh=ue.forwardRef(({className:e,...t},r)=>be.jsx("h3",{ref:r,className:Ci("text-2xl font-semibold leading-none tracking-tight",e),...t}));mh.displayName="CardTitle";const Ffe=ue.forwardRef(({className:e,...t},r)=>be.jsx("p",{ref:r,className:Ci("text-sm text-muted-foreground",e),...t}));Ffe.displayName="CardDescription";const mu=ue.forwardRef(({className:e,...t},r)=>be.jsx("div",{ref:r,className:Ci("p-6 pt-0",e),...t}));mu.displayName="CardContent";const Lfe=ue.forwardRef(({className:e,...t},r)=>be.jsx("div",{ref:r,className:Ci("flex items-center p-6 pt-0",e),...t}));Lfe.displayName="CardFooter";function Nfe(e){const t=ue.useRef({value:e,previous:e});return ue.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var hP="Checkbox",[Bfe,Dqe]=Rp(hP),[zfe,c4]=Bfe(hP);function jfe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:o,disabled:u,form:d,name:i,onCheckedChange:v,required:w,value:S="on",internal_do_not_use_render:C}=e,[k,O]=i2({prop:r,defaultProp:o??!1,onChange:v,caller:hP}),[L,R]=ue.useState(null),[N,V]=ue.useState(null),G=ue.useRef(!1),U=L?!!d||!!L.closest("form"):!0,J={checked:k,disabled:u,setChecked:O,control:L,setControl:R,name:i,form:d,value:S,hasConsumerStoppedPropagationRef:G,required:w,defaultChecked:gp(o)?!1:o,isFormControl:U,bubbleInput:N,setBubbleInput:V};return be.jsx(zfe,{scope:t,...J,children:Ufe(C)?C(J):n})}var jq="CheckboxTrigger",Uq=ue.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},o)=>{const{control:u,value:d,disabled:i,checked:v,required:w,setControl:S,setChecked:C,hasConsumerStoppedPropagationRef:k,isFormControl:O,bubbleInput:L}=c4(jq,e),R=bo(o,S),N=ue.useRef(v);return ue.useEffect(()=>{const V=u==null?void 0:u.form;if(V){const G=()=>C(N.current);return V.addEventListener("reset",G),()=>V.removeEventListener("reset",G)}},[u,C]),be.jsx(yi.button,{type:"button",role:"checkbox","aria-checked":gp(v)?"mixed":v,"aria-required":w,"data-state":Hq(v),"data-disabled":i?"":void 0,disabled:i,value:d,...n,ref:R,onKeyDown:Bi(t,V=>{V.key==="Enter"&&V.preventDefault()}),onClick:Bi(r,V=>{C(G=>gp(G)?!0:!G),L&&O&&(k.current=V.isPropagationStopped(),k.current||V.stopPropagation())})})});Uq.displayName=jq;var u4=ue.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:o,defaultChecked:u,required:d,disabled:i,value:v,onCheckedChange:w,form:S,...C}=e;return be.jsx(jfe,{__scopeCheckbox:r,checked:o,defaultChecked:u,disabled:i,required:d,onCheckedChange:w,name:n,form:S,value:v,internal_do_not_use_render:({isFormControl:k})=>be.jsxs(be.Fragment,{children:[be.jsx(Uq,{...C,ref:t,__scopeCheckbox:r}),k&&be.jsx(Gq,{__scopeCheckbox:r})]})})});u4.displayName=hP;var $q="CheckboxIndicator",Vq=ue.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...o}=e,u=c4($q,r);return be.jsx(Ih,{present:n||gp(u.checked)||u.checked===!0,children:be.jsx(yi.span,{"data-state":Hq(u.checked),"data-disabled":u.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});Vq.displayName=$q;var Wq="CheckboxBubbleInput",Gq=ue.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:u,defaultChecked:d,required:i,disabled:v,name:w,value:S,form:C,bubbleInput:k,setBubbleInput:O}=c4(Wq,e),L=bo(r,O),R=Nfe(u),N=iq(n);ue.useEffect(()=>{const G=k;if(!G)return;const U=window.HTMLInputElement.prototype,Z=Object.getOwnPropertyDescriptor(U,"checked").set,K=!o.current;if(R!==u&&Z){const re=new Event("click",{bubbles:K});G.indeterminate=gp(u),Z.call(G,gp(u)?!1:u),G.dispatchEvent(re)}},[k,R,u,o]);const V=ue.useRef(gp(u)?!1:u);return be.jsx(yi.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??V.current,required:i,disabled:v,name:w,value:S,form:C,...t,tabIndex:-1,ref:L,style:{...t.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Gq.displayName=Wq;function Ufe(e){return typeof e=="function"}function gp(e){return e==="indeterminate"}function Hq(e){return gp(e)?"indeterminate":e?"checked":"unchecked"}const qq=ue.forwardRef(({className:e,...t},r)=>be.jsx(u4,{ref:r,className:Ci("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:be.jsx(Vq,{className:Ci("flex items-center justify-center text-current"),children:be.jsx(DH,{className:"h-4 w-4"})})}));qq.displayName=u4.displayName;var $fe="Label",Xq=ue.forwardRef((e,t)=>be.jsx(yi.label,{...e,ref:t,onMouseDown:r=>{var o;r.target.closest("button, input, select, textarea")||((o=e.onMouseDown)==null||o.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Xq.displayName=$fe;var Zq=Xq;const Vfe=o2("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ff=ue.forwardRef(({className:e,...t},r)=>be.jsx(Zq,{ref:r,className:Ci(Vfe(),e),...t}));ff.displayName=Zq.displayName;class Wfe{constructor(){_6(this,"BASE_URL","https://power.larc.nasa.gov/api/temporal/daily/point")}async getClimateData(t,r,n=["T2M","PRECTOTCORR"],o="2001-01-01",u="2020-12-31"){const d=n.join(","),i=new URL(this.BASE_URL);i.searchParams.set("start",o.replace(/-/g,"")),i.searchParams.set("end",u.replace(/-/g,"")),i.searchParams.set("latitude",t.toString()),i.searchParams.set("longitude",r.toString()),i.searchParams.set("community","RE"),i.searchParams.set("parameters",d),i.searchParams.set("format","JSON"),i.searchParams.set("user","anonymous");try{console.log("Fetching NASA POWER data from:",i.toString());const v=await fetch(i.toString());if(!v.ok)throw new Error(`NASA POWER API error: ${v.status} ${v.statusText}`);const w=await v.json();console.log("NASA POWER API response:",w);const S={};for(const k of n)S[k]=w.properties.parameter[k]?Object.values(w.properties.parameter[k]):[];return{location:{latitude:t,longitude:r},geometry:w.geometry,parameters:S,selectedParameters:n,dateRange:{start:o,end:u},rawData:w}}catch(v){throw console.error("Error fetching NASA POWER data:",v),new Error("Failed to fetch climate data from NASA POWER API")}}}const Gfe=new Wfe;var hj=1,Hfe=.9,qfe=.8,Xfe=.17,JO=.1,QO=.999,Zfe=.9999,Yfe=.99,Kfe=/[\\\/_+.#"@\[\(\{&]/,Jfe=/[\\\/_+.#"@\[\(\{&]/g,Qfe=/[\s-]/,Yq=/[\s-]/g;function s3(e,t,r,n,o,u,d){if(u===t.length)return o===e.length?hj:Yfe;var i=`${o},${u}`;if(d[i]!==void 0)return d[i];for(var v=n.charAt(u),w=r.indexOf(v,o),S=0,C,k,O,L;w>=0;)C=s3(e,t,r,n,w+1,u+1,d),C>S&&(w===o?C*=hj:Kfe.test(e.charAt(w-1))?(C*=qfe,O=e.slice(o,w-1).match(Jfe),O&&o>0&&(C*=Math.pow(QO,O.length))):Qfe.test(e.charAt(w-1))?(C*=Hfe,L=e.slice(o,w-1).match(Yq),L&&o>0&&(C*=Math.pow(QO,L.length))):(C*=Xfe,o>0&&(C*=Math.pow(QO,w-o))),e.charAt(w)!==t.charAt(u)&&(C*=Zfe)),(C<JO&&r.charAt(w-1)===n.charAt(u+1)||n.charAt(u+1)===n.charAt(u)&&r.charAt(w-1)!==n.charAt(u))&&(k=s3(e,t,r,n,w+1,u+2,d),k*JO>C&&(C=k*JO)),C>S&&(S=C),w=r.indexOf(v,w+1);return d[i]=S,S}function fj(e){return e.toLowerCase().replace(Yq," ")}function ede(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,s3(e,t,fj(e),fj(t),0,0,{})}var eM="focusScope.autoFocusOnMount",tM="focusScope.autoFocusOnUnmount",dj={bubbles:!1,cancelable:!0},tde="FocusScope",h4=ue.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:u,...d}=e,[i,v]=ue.useState(null),w=Sh(o),S=Sh(u),C=ue.useRef(null),k=bo(t,R=>v(R)),O=ue.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;ue.useEffect(()=>{if(n){let R=function(U){if(O.paused||!i)return;const J=U.target;i.contains(J)?C.current=J:Ud(C.current,{select:!0})},N=function(U){if(O.paused||!i)return;const J=U.relatedTarget;J!==null&&(i.contains(J)||Ud(C.current,{select:!0}))},V=function(U){if(document.activeElement===document.body)for(const Z of U)Z.removedNodes.length>0&&Ud(i)};document.addEventListener("focusin",R),document.addEventListener("focusout",N);const G=new MutationObserver(V);return i&&G.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",R),document.removeEventListener("focusout",N),G.disconnect()}}},[n,i,O.paused]),ue.useEffect(()=>{if(i){mj.add(O);const R=document.activeElement;if(!i.contains(R)){const V=new CustomEvent(eM,dj);i.addEventListener(eM,w),i.dispatchEvent(V),V.defaultPrevented||(rde(sde(Kq(i)),{select:!0}),document.activeElement===R&&Ud(i))}return()=>{i.removeEventListener(eM,w),setTimeout(()=>{const V=new CustomEvent(tM,dj);i.addEventListener(tM,S),i.dispatchEvent(V),V.defaultPrevented||Ud(R??document.body,{select:!0}),i.removeEventListener(tM,S),mj.remove(O)},0)}}},[i,w,S,O]);const L=ue.useCallback(R=>{if(!r&&!n||O.paused)return;const N=R.key==="Tab"&&!R.altKey&&!R.ctrlKey&&!R.metaKey,V=document.activeElement;if(N&&V){const G=R.currentTarget,[U,J]=nde(G);U&&J?!R.shiftKey&&V===J?(R.preventDefault(),r&&Ud(U,{select:!0})):R.shiftKey&&V===U&&(R.preventDefault(),r&&Ud(J,{select:!0})):V===G&&R.preventDefault()}},[r,n,O.paused]);return be.jsx(yi.div,{tabIndex:-1,...d,ref:k,onKeyDown:L})});h4.displayName=tde;function rde(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ud(n,{select:t}),document.activeElement!==r)return}function nde(e){const t=Kq(e),r=pj(t,e),n=pj(t.reverse(),e);return[r,n]}function Kq(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function pj(e,t){for(const r of e)if(!ide(r,{upTo:t}))return r}function ide(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ade(e){return e instanceof HTMLInputElement&&"select"in e}function Ud(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&ade(e)&&t&&e.select()}}var mj=ode();function ode(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=gj(e,t),e.unshift(t)},remove(t){var r;e=gj(e,t),(r=e[0])==null||r.resume()}}}function gj(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function sde(e){return e.filter(t=>t.tagName!=="A")}var rM=0;function Jq(){ue.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_j()),document.body.insertAdjacentElement("beforeend",e[1]??_j()),rM++,()=>{rM===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),rM--}},[])}function _j(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var hh=function(){return hh=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},hh.apply(this,arguments)};function Qq(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function lde(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,u;n<o;n++)(u||!(n in t))&&(u||(u=Array.prototype.slice.call(t,0,n)),u[n]=t[n]);return e.concat(u||Array.prototype.slice.call(t))}var LE="right-scroll-bar-position",NE="width-before-scroll-bar",cde="with-scroll-bars-hidden",ude="--removed-body-scroll-bar-size";function nM(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function hde(e,t){var r=ue.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}})[0];return r.callback=t,r.facade}var fde=typeof window<"u"?ue.useLayoutEffect:ue.useEffect,yj=new WeakMap;function dde(e,t){var r=hde(null,function(n){return e.forEach(function(o){return nM(o,n)})});return fde(function(){var n=yj.get(r);if(n){var o=new Set(n),u=new Set(e),d=r.current;o.forEach(function(i){u.has(i)||nM(i,null)}),u.forEach(function(i){o.has(i)||nM(i,d)})}yj.set(r,e)},[e]),r}function pde(e){return e}function mde(e,t){t===void 0&&(t=pde);var r=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(u){var d=t(u,n);return r.push(d),function(){r=r.filter(function(i){return i!==d})}},assignSyncMedium:function(u){for(n=!0;r.length;){var d=r;r=[],d.forEach(u)}r={push:function(i){return u(i)},filter:function(){return r}}},assignMedium:function(u){n=!0;var d=[];if(r.length){var i=r;r=[],i.forEach(u),d=r}var v=function(){var S=d;d=[],S.forEach(u)},w=function(){return Promise.resolve().then(v)};w(),r={push:function(S){d.push(S),w()},filter:function(S){return d=d.filter(S),r}}}};return o}function gde(e){e===void 0&&(e={});var t=mde(null);return t.options=hh({async:!0,ssr:!1},e),t}var eX=function(e){var t=e.sideCar,r=Qq(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return ue.createElement(n,hh({},r))};eX.isSideCarExport=!0;function _de(e,t){return e.useMedium(t),eX}var tX=gde(),iM=function(){},fP=ue.forwardRef(function(e,t){var r=ue.useRef(null),n=ue.useState({onScrollCapture:iM,onWheelCapture:iM,onTouchMoveCapture:iM}),o=n[0],u=n[1],d=e.forwardProps,i=e.children,v=e.className,w=e.removeScrollBar,S=e.enabled,C=e.shards,k=e.sideCar,O=e.noRelative,L=e.noIsolation,R=e.inert,N=e.allowPinchZoom,V=e.as,G=V===void 0?"div":V,U=e.gapMode,J=Qq(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Z=k,K=dde([r,t]),re=hh(hh({},J),o);return ue.createElement(ue.Fragment,null,S&&ue.createElement(Z,{sideCar:tX,removeScrollBar:w,shards:C,noRelative:O,noIsolation:L,inert:R,setCallbacks:u,allowPinchZoom:!!N,lockRef:r,gapMode:U}),d?ue.cloneElement(ue.Children.only(i),hh(hh({},re),{ref:K})):ue.createElement(G,hh({},re,{className:v,ref:K}),i))});fP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};fP.classNames={fullWidth:NE,zeroRight:LE};var yde=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function vde(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=yde();return t&&e.setAttribute("nonce",t),e}function xde(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function wde(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var bde=function(){var e=0,t=null;return{add:function(r){e==0&&(t=vde())&&(xde(t,r),wde(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Tde=function(){var e=bde();return function(t,r){ue.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},rX=function(){var e=Tde(),t=function(r){var n=r.styles,o=r.dynamic;return e(n,o),null};return t},Sde={left:0,top:0,right:0,gap:0},aM=function(e){return parseInt(e||"",10)||0},Ede=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[aM(r),aM(n),aM(o)]},Ade=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Sde;var t=Ede(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Cde=rX(),hy="data-scroll-locked",Pde=function(e,t,r,n){var o=e.left,u=e.top,d=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(cde,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(hy,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(u,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(LE,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(NE,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(LE," .").concat(LE,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(NE," .").concat(NE,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(hy,`] {
    `).concat(ude,": ").concat(i,`px;
  }
`)},vj=function(){var e=parseInt(document.body.getAttribute(hy)||"0",10);return isFinite(e)?e:0},Ide=function(){ue.useEffect(function(){return document.body.setAttribute(hy,(vj()+1).toString()),function(){var e=vj()-1;e<=0?document.body.removeAttribute(hy):document.body.setAttribute(hy,e.toString())}},[])},kde=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,o=n===void 0?"margin":n;Ide();var u=ue.useMemo(function(){return Ade(o)},[o]);return ue.createElement(Cde,{styles:Pde(u,!t,o,r?"":"!important")})},l3=!1;if(typeof window<"u")try{var GS=Object.defineProperty({},"passive",{get:function(){return l3=!0,!0}});window.addEventListener("test",GS,GS),window.removeEventListener("test",GS,GS)}catch{l3=!1}var T_=l3?{passive:!1}:!1,Ode=function(e){return e.tagName==="TEXTAREA"},nX=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Ode(e)&&r[t]==="visible")},Mde=function(e){return nX(e,"overflowY")},Rde=function(e){return nX(e,"overflowX")},xj=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=iX(e,n);if(o){var u=aX(e,n),d=u[1],i=u[2];if(d>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Dde=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Fde=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},iX=function(e,t){return e==="v"?Mde(t):Rde(t)},aX=function(e,t){return e==="v"?Dde(t):Fde(t)},Lde=function(e,t){return e==="h"&&t==="rtl"?-1:1},Nde=function(e,t,r,n,o){var u=Lde(e,window.getComputedStyle(t).direction),d=u*n,i=r.target,v=t.contains(i),w=!1,S=d>0,C=0,k=0;do{if(!i)break;var O=aX(e,i),L=O[0],R=O[1],N=O[2],V=R-N-u*L;(L||V)&&iX(e,i)&&(C+=V,k+=L);var G=i.parentNode;i=G&&G.nodeType===Node.DOCUMENT_FRAGMENT_NODE?G.host:G}while(!v&&i!==document.body||v&&(t.contains(i)||t===i));return(S&&(Math.abs(C)<1||!o)||!S&&(Math.abs(k)<1||!o))&&(w=!0),w},HS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},wj=function(e){return[e.deltaX,e.deltaY]},bj=function(e){return e&&"current"in e?e.current:e},Bde=function(e,t){return e[0]===t[0]&&e[1]===t[1]},zde=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},jde=0,S_=[];function Ude(e){var t=ue.useRef([]),r=ue.useRef([0,0]),n=ue.useRef(),o=ue.useState(jde++)[0],u=ue.useState(rX)[0],d=ue.useRef(e);ue.useEffect(function(){d.current=e},[e]),ue.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var R=lde([e.lockRef.current],(e.shards||[]).map(bj),!0).filter(Boolean);return R.forEach(function(N){return N.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),R.forEach(function(N){return N.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var i=ue.useCallback(function(R,N){if("touches"in R&&R.touches.length===2||R.type==="wheel"&&R.ctrlKey)return!d.current.allowPinchZoom;var V=HS(R),G=r.current,U="deltaX"in R?R.deltaX:G[0]-V[0],J="deltaY"in R?R.deltaY:G[1]-V[1],Z,K=R.target,re=Math.abs(U)>Math.abs(J)?"h":"v";if("touches"in R&&re==="h"&&K.type==="range")return!1;var ge=xj(re,K);if(!ge)return!0;if(ge?Z=re:(Z=re==="v"?"h":"v",ge=xj(re,K)),!ge)return!1;if(!n.current&&"changedTouches"in R&&(U||J)&&(n.current=Z),!Z)return!0;var ve=n.current||Z;return Nde(ve,N,R,ve==="h"?U:J,!0)},[]),v=ue.useCallback(function(R){var N=R;if(!(!S_.length||S_[S_.length-1]!==u)){var V="deltaY"in N?wj(N):HS(N),G=t.current.filter(function(Z){return Z.name===N.type&&(Z.target===N.target||N.target===Z.shadowParent)&&Bde(Z.delta,V)})[0];if(G&&G.should){N.cancelable&&N.preventDefault();return}if(!G){var U=(d.current.shards||[]).map(bj).filter(Boolean).filter(function(Z){return Z.contains(N.target)}),J=U.length>0?i(N,U[0]):!d.current.noIsolation;J&&N.cancelable&&N.preventDefault()}}},[]),w=ue.useCallback(function(R,N,V,G){var U={name:R,delta:N,target:V,should:G,shadowParent:$de(V)};t.current.push(U),setTimeout(function(){t.current=t.current.filter(function(J){return J!==U})},1)},[]),S=ue.useCallback(function(R){r.current=HS(R),n.current=void 0},[]),C=ue.useCallback(function(R){w(R.type,wj(R),R.target,i(R,e.lockRef.current))},[]),k=ue.useCallback(function(R){w(R.type,HS(R),R.target,i(R,e.lockRef.current))},[]);ue.useEffect(function(){return S_.push(u),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:k}),document.addEventListener("wheel",v,T_),document.addEventListener("touchmove",v,T_),document.addEventListener("touchstart",S,T_),function(){S_=S_.filter(function(R){return R!==u}),document.removeEventListener("wheel",v,T_),document.removeEventListener("touchmove",v,T_),document.removeEventListener("touchstart",S,T_)}},[]);var O=e.removeScrollBar,L=e.inert;return ue.createElement(ue.Fragment,null,L?ue.createElement(u,{styles:zde(o)}):null,O?ue.createElement(kde,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function $de(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Vde=_de(tX,Ude);var f4=ue.forwardRef(function(e,t){return ue.createElement(fP,hh({},e,{ref:t,sideCar:Vde}))});f4.classNames=fP.classNames;var Wde=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},E_=new WeakMap,qS=new WeakMap,XS={},oM=0,oX=function(e){return e&&(e.host||oX(e.parentNode))},Gde=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=oX(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Hde=function(e,t,r,n){var o=Gde(t,Array.isArray(e)?e:[e]);XS[r]||(XS[r]=new WeakMap);var u=XS[r],d=[],i=new Set,v=new Set(o),w=function(C){!C||i.has(C)||(i.add(C),w(C.parentNode))};o.forEach(w);var S=function(C){!C||v.has(C)||Array.prototype.forEach.call(C.children,function(k){if(i.has(k))S(k);else try{var O=k.getAttribute(n),L=O!==null&&O!=="false",R=(E_.get(k)||0)+1,N=(u.get(k)||0)+1;E_.set(k,R),u.set(k,N),d.push(k),R===1&&L&&qS.set(k,!0),N===1&&k.setAttribute(r,"true"),L||k.setAttribute(n,"true")}catch(V){console.error("aria-hidden: cannot operate on ",k,V)}})};return S(t),i.clear(),oM++,function(){d.forEach(function(C){var k=E_.get(C)-1,O=u.get(C)-1;E_.set(C,k),u.set(C,O),k||(qS.has(C)||C.removeAttribute(n),qS.delete(C)),O||C.removeAttribute(r)}),oM--,oM||(E_=new WeakMap,E_=new WeakMap,qS=new WeakMap,XS={})}},sX=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),o=Wde(e);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live]"))),Hde(n,o,r,"aria-hidden")):function(){return null}},dP="Dialog",[lX,Fqe]=Rp(dP),[qde,Au]=lX(dP),cX=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:o,onOpenChange:u,modal:d=!0}=e,i=ue.useRef(null),v=ue.useRef(null),[w,S]=i2({prop:n,defaultProp:o??!1,onChange:u,caller:dP});return be.jsx(qde,{scope:t,triggerRef:i,contentRef:v,contentId:xu(),titleId:xu(),descriptionId:xu(),open:w,onOpenChange:S,onOpenToggle:ue.useCallback(()=>S(C=>!C),[S]),modal:d,children:r})};cX.displayName=dP;var uX="DialogTrigger",Xde=ue.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=Au(uX,r),u=bo(t,o.triggerRef);return be.jsx(yi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":m4(o.open),...n,ref:u,onClick:Bi(e.onClick,o.onOpenToggle)})});Xde.displayName=uX;var d4="DialogPortal",[Zde,hX]=lX(d4,{forceMount:void 0}),fX=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:o}=e,u=Au(d4,t);return be.jsx(Zde,{scope:t,forceMount:r,children:ue.Children.map(n,d=>be.jsx(Ih,{present:r||u.open,children:be.jsx(KC,{asChild:!0,container:o,children:d})}))})};fX.displayName=d4;var yA="DialogOverlay",dX=ue.forwardRef((e,t)=>{const r=hX(yA,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,u=Au(yA,e.__scopeDialog);return u.modal?be.jsx(Ih,{present:n||u.open,children:be.jsx(Kde,{...o,ref:t})}):null});dX.displayName=yA;var Yde=Fy("DialogOverlay.RemoveScroll"),Kde=ue.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=Au(yA,r);return be.jsx(f4,{as:Yde,allowPinchZoom:!0,shards:[o.contentRef],children:be.jsx(yi.div,{"data-state":m4(o.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),y0="DialogContent",pX=ue.forwardRef((e,t)=>{const r=hX(y0,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,u=Au(y0,e.__scopeDialog);return be.jsx(Ih,{present:n||u.open,children:u.modal?be.jsx(Jde,{...o,ref:t}):be.jsx(Qde,{...o,ref:t})})});pX.displayName=y0;var Jde=ue.forwardRef((e,t)=>{const r=Au(y0,e.__scopeDialog),n=ue.useRef(null),o=bo(t,r.contentRef,n);return ue.useEffect(()=>{const u=n.current;if(u)return sX(u)},[]),be.jsx(mX,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Bi(e.onCloseAutoFocus,u=>{var d;u.preventDefault(),(d=r.triggerRef.current)==null||d.focus()}),onPointerDownOutside:Bi(e.onPointerDownOutside,u=>{const d=u.detail.originalEvent,i=d.button===0&&d.ctrlKey===!0;(d.button===2||i)&&u.preventDefault()}),onFocusOutside:Bi(e.onFocusOutside,u=>u.preventDefault())})}),Qde=ue.forwardRef((e,t)=>{const r=Au(y0,e.__scopeDialog),n=ue.useRef(!1),o=ue.useRef(!1);return be.jsx(mX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var d,i;(d=e.onCloseAutoFocus)==null||d.call(e,u),u.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),u.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:u=>{var v,w;(v=e.onInteractOutside)==null||v.call(e,u),u.defaultPrevented||(n.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const d=u.target;((w=r.triggerRef.current)==null?void 0:w.contains(d))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),mX=ue.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:u,...d}=e,i=Au(y0,r),v=ue.useRef(null),w=bo(t,v);return Jq(),be.jsxs(be.Fragment,{children:[be.jsx(h4,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:u,children:be.jsx(n2,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":m4(i.open),...d,ref:w,onDismiss:()=>i.onOpenChange(!1)})}),be.jsxs(be.Fragment,{children:[be.jsx(epe,{titleId:i.titleId}),be.jsx(rpe,{contentRef:v,descriptionId:i.descriptionId})]})]})}),p4="DialogTitle",gX=ue.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=Au(p4,r);return be.jsx(yi.h2,{id:o.titleId,...n,ref:t})});gX.displayName=p4;var _X="DialogDescription",yX=ue.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=Au(_X,r);return be.jsx(yi.p,{id:o.descriptionId,...n,ref:t})});yX.displayName=_X;var vX="DialogClose",xX=ue.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=Au(vX,r);return be.jsx(yi.button,{type:"button",...n,ref:t,onClick:Bi(e.onClick,()=>o.onOpenChange(!1))})});xX.displayName=vX;function m4(e){return e?"open":"closed"}var wX="DialogTitleWarning",[Lqe,bX]=xse(wX,{contentName:y0,titleName:p4,docsSlug:"dialog"}),epe=({titleId:e})=>{const t=bX(wX),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return ue.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},tpe="DialogDescriptionWarning",rpe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bX(tpe).contentName}}.`;return ue.useEffect(()=>{var u;const o=(u=e.current)==null?void 0:u.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},npe=cX,TX=fX,g4=dX,_4=pX,SX=gX,EX=yX,ipe=xX,N1='[cmdk-group=""]',sM='[cmdk-group-items=""]',ape='[cmdk-group-heading=""]',AX='[cmdk-item=""]',Tj=`${AX}:not([aria-disabled="true"])`,c3="cmdk-item-select",L_="data-value",ope=(e,t,r)=>ede(e,t,r),CX=ue.createContext(void 0),l2=()=>ue.useContext(CX),PX=ue.createContext(void 0),y4=()=>ue.useContext(PX),IX=ue.createContext(void 0),kX=ue.forwardRef((e,t)=>{let r=N_(()=>{var _e,Ge;return{search:"",value:(Ge=(_e=e.value)!=null?_e:e.defaultValue)!=null?Ge:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=N_(()=>new Set),o=N_(()=>new Map),u=N_(()=>new Map),d=N_(()=>new Set),i=OX(e),{label:v,children:w,value:S,onValueChange:C,filter:k,shouldFilter:O,loop:L,disablePointerSelection:R=!1,vimBindings:N=!0,...V}=e,G=xu(),U=xu(),J=xu(),Z=ue.useRef(null),K=_pe();v0(()=>{if(S!==void 0){let _e=S.trim();r.current.value=_e,re.emit()}},[S]),v0(()=>{K(6,tt)},[]);let re=ue.useMemo(()=>({subscribe:_e=>(d.current.add(_e),()=>d.current.delete(_e)),snapshot:()=>r.current,setState:(_e,Ge,qe)=>{var Xe,yt,Dt,Yt;if(!Object.is(r.current[_e],Ge)){if(r.current[_e]=Ge,_e==="search")ke(),$e(),K(1,Ie);else if(_e==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let St=document.getElementById(J);St?St.focus():(Xe=document.getElementById(G))==null||Xe.focus()}if(K(7,()=>{var St;r.current.selectedItemId=(St=Je())==null?void 0:St.id,re.emit()}),qe||K(5,tt),((yt=i.current)==null?void 0:yt.value)!==void 0){let St=Ge??"";(Yt=(Dt=i.current).onValueChange)==null||Yt.call(Dt,St);return}}re.emit()}},emit:()=>{d.current.forEach(_e=>_e())}}),[]),ge=ue.useMemo(()=>({value:(_e,Ge,qe)=>{var Xe;Ge!==((Xe=u.current.get(_e))==null?void 0:Xe.value)&&(u.current.set(_e,{value:Ge,keywords:qe}),r.current.filtered.items.set(_e,ve(Ge,qe)),K(2,()=>{$e(),re.emit()}))},item:(_e,Ge)=>(n.current.add(_e),Ge&&(o.current.has(Ge)?o.current.get(Ge).add(_e):o.current.set(Ge,new Set([_e]))),K(3,()=>{ke(),$e(),r.current.value||Ie(),re.emit()}),()=>{u.current.delete(_e),n.current.delete(_e),r.current.filtered.items.delete(_e);let qe=Je();K(4,()=>{ke(),(qe==null?void 0:qe.getAttribute("id"))===_e&&Ie(),re.emit()})}),group:_e=>(o.current.has(_e)||o.current.set(_e,new Set),()=>{u.current.delete(_e),o.current.delete(_e)}),filter:()=>i.current.shouldFilter,label:v||e["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:G,inputId:J,labelId:U,listInnerRef:Z}),[]);function ve(_e,Ge){var qe,Xe;let yt=(Xe=(qe=i.current)==null?void 0:qe.filter)!=null?Xe:ope;return _e?yt(_e,r.current.search,Ge):0}function $e(){if(!r.current.search||i.current.shouldFilter===!1)return;let _e=r.current.filtered.items,Ge=[];r.current.filtered.groups.forEach(Xe=>{let yt=o.current.get(Xe),Dt=0;yt.forEach(Yt=>{let St=_e.get(Yt);Dt=Math.max(St,Dt)}),Ge.push([Xe,Dt])});let qe=Z.current;et().sort((Xe,yt)=>{var Dt,Yt;let St=Xe.getAttribute("id"),Mt=yt.getAttribute("id");return((Dt=_e.get(Mt))!=null?Dt:0)-((Yt=_e.get(St))!=null?Yt:0)}).forEach(Xe=>{let yt=Xe.closest(sM);yt?yt.appendChild(Xe.parentElement===yt?Xe:Xe.closest(`${sM} > *`)):qe.appendChild(Xe.parentElement===qe?Xe:Xe.closest(`${sM} > *`))}),Ge.sort((Xe,yt)=>yt[1]-Xe[1]).forEach(Xe=>{var yt;let Dt=(yt=Z.current)==null?void 0:yt.querySelector(`${N1}[${L_}="${encodeURIComponent(Xe[0])}"]`);Dt==null||Dt.parentElement.appendChild(Dt)})}function Ie(){let _e=et().find(qe=>qe.getAttribute("aria-disabled")!=="true"),Ge=_e==null?void 0:_e.getAttribute(L_);re.setState("value",Ge||void 0)}function ke(){var _e,Ge,qe,Xe;if(!r.current.search||i.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let yt=0;for(let Dt of n.current){let Yt=(Ge=(_e=u.current.get(Dt))==null?void 0:_e.value)!=null?Ge:"",St=(Xe=(qe=u.current.get(Dt))==null?void 0:qe.keywords)!=null?Xe:[],Mt=ve(Yt,St);r.current.filtered.items.set(Dt,Mt),Mt>0&&yt++}for(let[Dt,Yt]of o.current)for(let St of Yt)if(r.current.filtered.items.get(St)>0){r.current.filtered.groups.add(Dt);break}r.current.filtered.count=yt}function tt(){var _e,Ge,qe;let Xe=Je();Xe&&(((_e=Xe.parentElement)==null?void 0:_e.firstChild)===Xe&&((qe=(Ge=Xe.closest(N1))==null?void 0:Ge.querySelector(ape))==null||qe.scrollIntoView({block:"nearest"})),Xe.scrollIntoView({block:"nearest"}))}function Je(){var _e;return(_e=Z.current)==null?void 0:_e.querySelector(`${AX}[aria-selected="true"]`)}function et(){var _e;return Array.from(((_e=Z.current)==null?void 0:_e.querySelectorAll(Tj))||[])}function at(_e){let Ge=et()[_e];Ge&&re.setState("value",Ge.getAttribute(L_))}function pt(_e){var Ge;let qe=Je(),Xe=et(),yt=Xe.findIndex(Yt=>Yt===qe),Dt=Xe[yt+_e];(Ge=i.current)!=null&&Ge.loop&&(Dt=yt+_e<0?Xe[Xe.length-1]:yt+_e===Xe.length?Xe[0]:Xe[yt+_e]),Dt&&re.setState("value",Dt.getAttribute(L_))}function ft(_e){let Ge=Je(),qe=Ge==null?void 0:Ge.closest(N1),Xe;for(;qe&&!Xe;)qe=_e>0?mpe(qe,N1):gpe(qe,N1),Xe=qe==null?void 0:qe.querySelector(Tj);Xe?re.setState("value",Xe.getAttribute(L_)):pt(_e)}let Ue=()=>at(et().length-1),It=_e=>{_e.preventDefault(),_e.metaKey?Ue():_e.altKey?ft(1):pt(1)},Rt=_e=>{_e.preventDefault(),_e.metaKey?at(0):_e.altKey?ft(-1):pt(-1)};return ue.createElement(yi.div,{ref:t,tabIndex:-1,...V,"cmdk-root":"",onKeyDown:_e=>{var Ge;(Ge=V.onKeyDown)==null||Ge.call(V,_e);let qe=_e.nativeEvent.isComposing||_e.keyCode===229;if(!(_e.defaultPrevented||qe))switch(_e.key){case"n":case"j":{N&&_e.ctrlKey&&It(_e);break}case"ArrowDown":{It(_e);break}case"p":case"k":{N&&_e.ctrlKey&&Rt(_e);break}case"ArrowUp":{Rt(_e);break}case"Home":{_e.preventDefault(),at(0);break}case"End":{_e.preventDefault(),Ue();break}case"Enter":{_e.preventDefault();let Xe=Je();if(Xe){let yt=new Event(c3);Xe.dispatchEvent(yt)}}}}},ue.createElement("label",{"cmdk-label":"",htmlFor:ge.inputId,id:ge.labelId,style:vpe},v),pP(e,_e=>ue.createElement(PX.Provider,{value:re},ue.createElement(CX.Provider,{value:ge},_e))))}),spe=ue.forwardRef((e,t)=>{var r,n;let o=xu(),u=ue.useRef(null),d=ue.useContext(IX),i=l2(),v=OX(e),w=(n=(r=v.current)==null?void 0:r.forceMount)!=null?n:d==null?void 0:d.forceMount;v0(()=>{if(!w)return i.item(o,d==null?void 0:d.id)},[w]);let S=MX(o,u,[e.value,e.children,u],e.keywords),C=y4(),k=Ep(K=>K.value&&K.value===S.current),O=Ep(K=>w||i.filter()===!1?!0:K.search?K.filtered.items.get(o)>0:!0);ue.useEffect(()=>{let K=u.current;if(!(!K||e.disabled))return K.addEventListener(c3,L),()=>K.removeEventListener(c3,L)},[O,e.onSelect,e.disabled]);function L(){var K,re;R(),(re=(K=v.current).onSelect)==null||re.call(K,S.current)}function R(){C.setState("value",S.current,!0)}if(!O)return null;let{disabled:N,value:V,onSelect:G,forceMount:U,keywords:J,...Z}=e;return ue.createElement(yi.div,{ref:g0(u,t),...Z,id:o,"cmdk-item":"",role:"option","aria-disabled":!!N,"aria-selected":!!k,"data-disabled":!!N,"data-selected":!!k,onPointerMove:N||i.getDisablePointerSelection()?void 0:R,onClick:N?void 0:L},e.children)}),lpe=ue.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:o,...u}=e,d=xu(),i=ue.useRef(null),v=ue.useRef(null),w=xu(),S=l2(),C=Ep(O=>o||S.filter()===!1?!0:O.search?O.filtered.groups.has(d):!0);v0(()=>S.group(d),[]),MX(d,i,[e.value,e.heading,v]);let k=ue.useMemo(()=>({id:d,forceMount:o}),[o]);return ue.createElement(yi.div,{ref:g0(i,t),...u,"cmdk-group":"",role:"presentation",hidden:C?void 0:!0},r&&ue.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:w},r),pP(e,O=>ue.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?w:void 0},ue.createElement(IX.Provider,{value:k},O))))}),cpe=ue.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,o=ue.useRef(null),u=Ep(d=>!d.search);return!r&&!u?null:ue.createElement(yi.div,{ref:g0(o,t),...n,"cmdk-separator":"",role:"separator"})}),upe=ue.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,o=e.value!=null,u=y4(),d=Ep(w=>w.search),i=Ep(w=>w.selectedItemId),v=l2();return ue.useEffect(()=>{e.value!=null&&u.setState("search",e.value)},[e.value]),ue.createElement(yi.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":i,id:v.inputId,type:"text",value:o?e.value:d,onChange:w=>{o||u.setState("search",w.target.value),r==null||r(w.target.value)}})}),hpe=ue.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...o}=e,u=ue.useRef(null),d=ue.useRef(null),i=Ep(w=>w.selectedItemId),v=l2();return ue.useEffect(()=>{if(d.current&&u.current){let w=d.current,S=u.current,C,k=new ResizeObserver(()=>{C=requestAnimationFrame(()=>{let O=w.offsetHeight;S.style.setProperty("--cmdk-list-height",O.toFixed(1)+"px")})});return k.observe(w),()=>{cancelAnimationFrame(C),k.unobserve(w)}}},[]),ue.createElement(yi.div,{ref:g0(u,t),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":i,"aria-label":n,id:v.listId},pP(e,w=>ue.createElement("div",{ref:g0(d,v.listInnerRef),"cmdk-list-sizer":""},w)))}),fpe=ue.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:o,contentClassName:u,container:d,...i}=e;return ue.createElement(npe,{open:r,onOpenChange:n},ue.createElement(TX,{container:d},ue.createElement(g4,{"cmdk-overlay":"",className:o}),ue.createElement(_4,{"aria-label":e.label,"cmdk-dialog":"",className:u},ue.createElement(kX,{ref:t,...i}))))}),dpe=ue.forwardRef((e,t)=>Ep(r=>r.filtered.count===0)?ue.createElement(yi.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),ppe=ue.forwardRef((e,t)=>{let{progress:r,children:n,label:o="Loading...",...u}=e;return ue.createElement(yi.div,{ref:t,...u,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},pP(e,d=>ue.createElement("div",{"aria-hidden":!0},d)))}),yl=Object.assign(kX,{List:hpe,Item:spe,Input:upe,Group:lpe,Separator:cpe,Dialog:fpe,Empty:dpe,Loading:ppe});function mpe(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function gpe(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function OX(e){let t=ue.useRef(e);return v0(()=>{t.current=e}),t}var v0=typeof window>"u"?ue.useEffect:ue.useLayoutEffect;function N_(e){let t=ue.useRef();return t.current===void 0&&(t.current=e()),t}function Ep(e){let t=y4(),r=()=>e(t.snapshot());return ue.useSyncExternalStore(t.subscribe,r,r)}function MX(e,t,r,n=[]){let o=ue.useRef(),u=l2();return v0(()=>{var d;let i=(()=>{var w;for(let S of r){if(typeof S=="string")return S.trim();if(typeof S=="object"&&"current"in S)return S.current?(w=S.current.textContent)==null?void 0:w.trim():o.current}})(),v=n.map(w=>w.trim());u.value(e,i,v),(d=t.current)==null||d.setAttribute(L_,i),o.current=i}),o}var _pe=()=>{let[e,t]=ue.useState(),r=N_(()=>new Map);return v0(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,o)=>{r.current.set(n,o),t({})}};function ype(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function pP({asChild:e,children:t},r){return e&&ue.isValidElement(t)?ue.cloneElement(ype(t),{ref:t.ref},r(t.props.children)):r(t)}var vpe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const xpe=TX,RX=ue.forwardRef(({className:e,...t},r)=>be.jsx(g4,{ref:r,className:Ci("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));RX.displayName=g4.displayName;const wpe=ue.forwardRef(({className:e,children:t,...r},n)=>be.jsxs(xpe,{children:[be.jsx(RX,{}),be.jsxs(_4,{ref:n,className:Ci("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,be.jsxs(ipe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[be.jsx(FH,{className:"h-4 w-4"}),be.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));wpe.displayName=_4.displayName;const bpe=ue.forwardRef(({className:e,...t},r)=>be.jsx(SX,{ref:r,className:Ci("text-lg font-semibold leading-none tracking-tight",e),...t}));bpe.displayName=SX.displayName;const Tpe=ue.forwardRef(({className:e,...t},r)=>be.jsx(EX,{ref:r,className:Ci("text-sm text-muted-foreground",e),...t}));Tpe.displayName=EX.displayName;const DX=ue.forwardRef(({className:e,...t},r)=>be.jsx(yl,{ref:r,className:Ci("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));DX.displayName=yl.displayName;const FX=ue.forwardRef(({className:e,...t},r)=>be.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[be.jsx(XR,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),be.jsx(yl.Input,{ref:r,className:Ci("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));FX.displayName=yl.Input.displayName;const LX=ue.forwardRef(({className:e,...t},r)=>be.jsx(yl.List,{ref:r,className:Ci("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));LX.displayName=yl.List.displayName;const NX=ue.forwardRef((e,t)=>be.jsx(yl.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));NX.displayName=yl.Empty.displayName;const BX=ue.forwardRef(({className:e,...t},r)=>be.jsx(yl.Group,{ref:r,className:Ci("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));BX.displayName=yl.Group.displayName;const Spe=ue.forwardRef(({className:e,...t},r)=>be.jsx(yl.Separator,{ref:r,className:Ci("-mx-1 h-px bg-border",e),...t}));Spe.displayName=yl.Separator.displayName;const zX=ue.forwardRef(({className:e,...t},r)=>be.jsx(yl.Item,{ref:r,className:Ci("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));zX.displayName=yl.Item.displayName;var mP="Popover",[jX,Nqe]=Rp(mP,[nP]),c2=nP(),[Epe,Dp]=jX(mP),UX=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:o,onOpenChange:u,modal:d=!1}=e,i=c2(t),v=ue.useRef(null),[w,S]=ue.useState(!1),[C,k]=i2({prop:n,defaultProp:o??!1,onChange:u,caller:mP});return be.jsx(ihe,{...i,children:be.jsx(Epe,{scope:t,contentId:xu(),triggerRef:v,open:C,onOpenChange:k,onOpenToggle:ue.useCallback(()=>k(O=>!O),[k]),hasCustomAnchor:w,onCustomAnchorAdd:ue.useCallback(()=>S(!0),[]),onCustomAnchorRemove:ue.useCallback(()=>S(!1),[]),modal:d,children:r})})};UX.displayName=mP;var $X="PopoverAnchor",Ape=ue.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=Dp($X,r),u=c2(r),{onCustomAnchorAdd:d,onCustomAnchorRemove:i}=o;return ue.useEffect(()=>(d(),()=>i()),[d,i]),be.jsx(i4,{...u,...n,ref:t})});Ape.displayName=$X;var VX="PopoverTrigger",WX=ue.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=Dp(VX,r),u=c2(r),d=bo(t,o.triggerRef),i=be.jsx(yi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ZX(o.open),...n,ref:d,onClick:Bi(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?i:be.jsx(i4,{asChild:!0,...u,children:i})});WX.displayName=VX;var v4="PopoverPortal",[Cpe,Ppe]=jX(v4,{forceMount:void 0}),GX=e=>{const{__scopePopover:t,forceMount:r,children:n,container:o}=e,u=Dp(v4,t);return be.jsx(Cpe,{scope:t,forceMount:r,children:be.jsx(Ih,{present:r||u.open,children:be.jsx(KC,{asChild:!0,container:o,children:n})})})};GX.displayName=v4;var By="PopoverContent",HX=ue.forwardRef((e,t)=>{const r=Ppe(By,e.__scopePopover),{forceMount:n=r.forceMount,...o}=e,u=Dp(By,e.__scopePopover);return be.jsx(Ih,{present:n||u.open,children:u.modal?be.jsx(kpe,{...o,ref:t}):be.jsx(Ope,{...o,ref:t})})});HX.displayName=By;var Ipe=Fy("PopoverContent.RemoveScroll"),kpe=ue.forwardRef((e,t)=>{const r=Dp(By,e.__scopePopover),n=ue.useRef(null),o=bo(t,n),u=ue.useRef(!1);return ue.useEffect(()=>{const d=n.current;if(d)return sX(d)},[]),be.jsx(f4,{as:Ipe,allowPinchZoom:!0,children:be.jsx(qX,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Bi(e.onCloseAutoFocus,d=>{var i;d.preventDefault(),u.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Bi(e.onPointerDownOutside,d=>{const i=d.detail.originalEvent,v=i.button===0&&i.ctrlKey===!0,w=i.button===2||v;u.current=w},{checkForDefaultPrevented:!1}),onFocusOutside:Bi(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ope=ue.forwardRef((e,t)=>{const r=Dp(By,e.__scopePopover),n=ue.useRef(!1),o=ue.useRef(!1);return be.jsx(qX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var d,i;(d=e.onCloseAutoFocus)==null||d.call(e,u),u.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),u.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:u=>{var v,w;(v=e.onInteractOutside)==null||v.call(e,u),u.defaultPrevented||(n.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const d=u.target;((w=r.triggerRef.current)==null?void 0:w.contains(d))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),qX=ue.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:d,onEscapeKeyDown:i,onPointerDownOutside:v,onFocusOutside:w,onInteractOutside:S,...C}=e,k=Dp(By,r),O=c2(r);return Jq(),be.jsx(h4,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:u,children:be.jsx(n2,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:S,onEscapeKeyDown:i,onPointerDownOutside:v,onFocusOutside:w,onDismiss:()=>k.onOpenChange(!1),children:be.jsx(pq,{"data-state":ZX(k.open),role:"dialog",id:k.contentId,...O,...C,ref:t,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),XX="PopoverClose",Mpe=ue.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=Dp(XX,r);return be.jsx(yi.button,{type:"button",...n,ref:t,onClick:Bi(e.onClick,()=>o.onOpenChange(!1))})});Mpe.displayName=XX;var Rpe="PopoverArrow",Dpe=ue.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=c2(r);return be.jsx(mq,{...o,...n,ref:t})});Dpe.displayName=Rpe;function ZX(e){return e?"open":"closed"}var Fpe=UX,Lpe=WX,Npe=GX,YX=HX;const Bpe=Fpe,zpe=Lpe,KX=ue.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},o)=>be.jsx(Npe,{children:be.jsx(YX,{ref:o,align:t,sideOffset:r,className:Ci("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));KX.displayName=YX.displayName;const jpe=[{name:"So Sebastio do Anta",latitude:-19.50010709,longitude:-41.9795989},{name:"Paraispolis",latitude:-22.55519277,longitude:-45.78170353},{name:"Bueno Brando",latitude:-22.43616701,longitude:-46.35338809},{name:"Ibituruna",latitude:-21.14648501,longitude:-44.73846359},{name:"So Gonalo do Rio Abaixo",latitude:-19.8318007,longitude:-43.34804002},{name:"Maria da F",latitude:-22.30721878,longitude:-45.37105369},{name:"Ouro Preto",latitude:-20.38677637,longitude:-43.50644752},{name:"Conceio das Pedras",latitude:-22.16117571,longitude:-45.45367946},{name:"Carvalhpolis",latitude:-21.77607292,longitude:-45.84563918},{name:"Monsenhor Paulo",latitude:-21.76177214,longitude:-45.54507414},{name:"Jequitinhonha",latitude:-16.44176894,longitude:-41.00711544},{name:"Crrego Danta",latitude:-19.82641002,longitude:-45.89847103},{name:"Santa Rita do Sapuca",latitude:-22.25332983,longitude:-45.70398819},{name:"Arceburgo",latitude:-21.36018148,longitude:-46.94435413},{name:"Carrancas",latitude:-21.49162562,longitude:-44.64360902},{name:"Poos de Caldas",latitude:-21.78736358,longitude:-46.56641004},{name:"Lavras",latitude:-21.24287024,longitude:-44.99993111},{name:"Piumhi",latitude:-20.47088287,longitude:-45.96056867},{name:"Datas",latitude:-18.45330265,longitude:-43.65671464},{name:"Turvolndia",latitude:-21.87938901,longitude:-45.79673579},{name:"So Joo del Rei",latitude:-21.13550897,longitude:-44.26097273},{name:"Bom Sucesso",latitude:-21.03041609,longitude:-44.75550272},{name:"Alto Capara",latitude:-20.44436112,longitude:-41.87308374},{name:"Ribeiro Vermelho",latitude:-21.19041433,longitude:-45.06478211},{name:"Jequeri",latitude:-20.44630304,longitude:-42.68226368},{name:"Jacutinga",latitude:-22.28663803,longitude:-46.61234117},{name:"Itajub",latitude:-22.43060057,longitude:-45.4645825},{name:"Caldas",latitude:-21.92333596,longitude:-46.38778911},{name:"Luminrias",latitude:-21.5123199,longitude:-44.90610648},{name:"Manhumirim",latitude:-20.36399911,longitude:-41.96267981},{name:"Campo do Meio",latitude:-21.10932572,longitude:-45.83075714},{name:"Carmo da Cachoeira",latitude:-21.46106043,longitude:-45.22462309},{name:"Coqueiral",latitude:-21.18657452,longitude:-45.44080557},{name:"Bandeira do Sul",latitude:-21.72486854,longitude:-46.38526298},{name:"Luisburgo",latitude:-20.43837611,longitude:-42.1064719},{name:"So Domingos das Dores",latitude:-19.52944607,longitude:-42.009508},{name:"Senhora dos Remdios",latitude:-21.03308296,longitude:-43.58638195},{name:"Guaxup",latitude:-21.30378146,longitude:-46.71353723},{name:"Paraguau",latitude:-21.54731603,longitude:-45.73269547},{name:"So Joo Batista do Glria",latitude:-20.63903685,longitude:-46.50346147},{name:"Passos",latitude:-20.7192119,longitude:-46.61141257},{name:"Candeias",latitude:-20.77035004,longitude:-45.2768567},{name:"So Toms de Aquino",latitude:-20.78499439,longitude:-47.09678297},{name:"Jacu",latitude:-21.01760216,longitude:-46.74201038},{name:"Cludio",latitude:-20.44457466,longitude:-44.76842253},{name:"Malacacheta",latitude:-17.84162254,longitude:-42.0760767},{name:"Nepomuceno",latitude:-21.23457694,longitude:-45.23742912},{name:"Conceio do Rio Verde",latitude:-21.87766556,longitude:-45.08376887},{name:"Senhora de Oliveira",latitude:-20.79389976,longitude:-43.33773199},{name:"Congonhal",latitude:-22.52089456,longitude:-46.0247475},{name:"Coimbra",latitude:-20.85865953,longitude:-42.8059391},{name:"Arapu",latitude:-19.03385529,longitude:-46.15459777},{name:"Varginha",latitude:-20.90267754,longitude:-42.3955896},{name:"Oliveira",latitude:-20.69751578,longitude:-44.82641087},{name:"Vargem Bonita",latitude:-19.23781971,longitude:-44.12063788},{name:"Bambu",latitude:-20.01189169,longitude:-45.97904481},{name:"Alterosa",latitude:-21.25586995,longitude:-46.14532056},{name:"So Bento Abade",latitude:-21.57904802,longitude:-45.07536063},{name:"So Sebastio do Paraso",latitude:-20.91806545,longitude:-46.98647183},{name:"Ibi",latitude:-19.47511172,longitude:-46.53861142},{name:"Cssia",latitude:-20.58285602,longitude:-46.92403586},{name:"Aguanil",latitude:-20.9374322,longitude:-45.38946534},{name:"Trs Coraes",latitude:-21.69596578,longitude:-45.25493687},{name:"Muzambinho",latitude:-21.37301275,longitude:-46.52680469},{name:"Crrego Fundo",latitude:-20.45552532,longitude:-45.55339545},{name:"Pedralva",latitude:-22.254226,longitude:-45.46597152},{name:"Inga",latitude:-21.40371681,longitude:-44.92242264},{name:"Pedrinpolis",latitude:-19.22772041,longitude:-47.46061739},{name:"Senador Firmino",latitude:-20.9180596,longitude:-43.10413039},{name:"Perdes",latitude:-21.09451887,longitude:-45.09308783},{name:"Santo Antnio do Amparo",latitude:-20.94624857,longitude:-44.91867494},{name:"Machado",latitude:-17.10406388,longitude:-42.20684977},{name:"So Gonalo do Sapuca",latitude:-21.89190514,longitude:-45.59463779},{name:"Passa Tempo",latitude:-20.65238775,longitude:-44.4934172},{name:"Botelhos",latitude:-21.65166388,longitude:-46.39549315},{name:"Santana da Vargem",latitude:-21.24896218,longitude:-45.50712105},{name:"Campestre",latitude:-21.71145483,longitude:-46.24815851},{name:"Cristais",latitude:-20.87523315,longitude:-45.51850385},{name:"Monte Belo",latitude:-17.51404511,longitude:-42.88818193},{name:"Sacramento",latitude:-19.59155569,longitude:-44.97987411},{name:"Berizal",latitude:-15.61078365,longitude:-41.74678509},{name:"Cachoeira de Minas",latitude:-22.35398406,longitude:-45.78213751},{name:"Monte Santo de Minas",latitude:-21.19047484,longitude:-46.97711855},{name:"Divisa Nova",latitude:-21.51726446,longitude:-46.20294111},{name:"Trs Pontas",latitude:-21.36876992,longitude:-45.5154748},{name:"Tapira",latitude:-19.88580561,longitude:-46.01857021},{name:"Pratinha",latitude:-19.75694525,longitude:-46.37844864},{name:"Guaransia",latitude:-21.30556037,longitude:-46.79549122},{name:"Arax",latitude:-19.5913298,longitude:-46.94000989},{name:"So Gotardo",latitude:-19.31270019,longitude:-46.05314404},{name:"Nova Era",latitude:-19.76442307,longitude:-43.03545685},{name:"Juruaia",latitude:-21.24935594,longitude:-46.58059648},{name:"Inconfidentes",latitude:-22.32148713,longitude:-46.3338014},{name:"So Loureno",latitude:-22.11776867,longitude:-45.0533731},{name:"Guarani",latitude:-21.36266919,longitude:-43.04645668},{name:"Martins Soares",latitude:-20.2582292,longitude:-41.87579091},{name:"So Jos da Barra",latitude:-20.72209097,longitude:-46.31932957},{name:"Nova Ponte",latitude:-19.16889165,longitude:-47.67057075},{name:"Nazareno",latitude:-21.21769697,longitude:-44.61723466},{name:"Andradas",latitude:-22.07280734,longitude:-46.575583},{name:"Nova Porteirinha",latitude:-15.8022102,longitude:-43.30255123},{name:"Campos Altos",latitude:-19.69889584,longitude:-46.17370992},{name:"Guap",latitude:-20.75672451,longitude:-45.91838386},{name:"Perdizes",latitude:-19.33865752,longitude:-47.29200845},{name:"Rio Paranaba",latitude:-19.1912383,longitude:-46.24275309},{name:"Durand",latitude:-20.20723888,longitude:-41.79426165},{name:"So Pedro da Unio",latitude:-21.1334585,longitude:-46.62132689},{name:"Boa Esperana",latitude:-21.09053108,longitude:-45.56440893},{name:"Itamogi",latitude:-21.07844336,longitude:-47.04746778},{name:"Piranga",latitude:-20.68514382,longitude:-43.28734555},{name:"Pimenta",latitude:-20.20212617,longitude:-43.0830748},{name:"Matutina",latitude:-19.22661206,longitude:-45.98351703},{name:"Medeiros",latitude:-19.6468397,longitude:-44.44710504},{name:"Tapira",latitude:-19.92557922,longitude:-46.82191536},{name:"Carmpolis de Minas",latitude:-20.53964217,longitude:-44.63252771},{name:"Areado",latitude:-21.35838236,longitude:-46.14655947},{name:"Mar de Espanha",latitude:-21.86689338,longitude:-43.00840675},{name:"Soledade de Minas",latitude:-22.05920641,longitude:-45.04102264},{name:"Guimarnia",latitude:-18.83801922,longitude:-46.79726503},{name:"Conceio da Barra de Minas",latitude:-21.13176937,longitude:-44.47780821},{name:"Ibitira de Minas",latitude:-22.05705516,longitude:-46.43760328},{name:"Ritpolis",latitude:-21.02325327,longitude:-44.32347752},{name:"Patrocnio",latitude:-18.94081296,longitude:-46.99743824},{name:"Campos Gerais",latitude:-21.23869791,longitude:-45.75690737},{name:"Santa Rita de Caldas",latitude:-22.02643549,longitude:-46.33862578},{name:"Estrela do Indai",latitude:-19.52023782,longitude:-45.79243256},{name:"Senador Modestino Gonalves",latitude:-17.94602467,longitude:-43.22297547},{name:"Desterro de Entre Rios",latitude:-20.65463068,longitude:-44.34366601},{name:"Guiricema",latitude:-21.01067337,longitude:-42.71881247},{name:"Pratpolis",latitude:-20.74418445,longitude:-46.86091734},{name:"Alfenas",latitude:-21.42817812,longitude:-45.9489182},{name:"Curral de Dentro",latitude:-15.93932678,longitude:-41.85597978},{name:"Capito Enas",latitude:-16.32091514,longitude:-43.7054129},{name:"Diamantina",latitude:-18.24209272,longitude:-43.59445682},{name:"Ilicnea",latitude:-20.94038902,longitude:-45.82846362},{name:"Capela Nova",latitude:-20.91666791,longitude:-43.61242187},{name:"So Joo do Paraso",latitude:-15.3184381,longitude:-42.01142244},{name:"Esmeraldas",latitude:-19.75920074,longitude:-44.31480692},{name:"Cabo Verde",latitude:-21.46929195,longitude:-46.3999705},{name:"So Tiago",latitude:-15.27716631,longitude:-42.02174901},{name:"Entre Rios de Minas",latitude:-20.6713572,longitude:-44.06708168},{name:"Capetinga",latitude:-20.62049913,longitude:-47.0574368},{name:"Patos de Minas",latitude:-18.59257082,longitude:-46.51591568},{name:"Monte Alegre de Minas",latitude:-18.86916672,longitude:-48.87711691},{name:"Biquinhas",latitude:-18.78475166,longitude:-45.50465172},{name:"Coromandel",latitude:-18.4738506,longitude:-47.20154773},{name:"Lagoa Grande",latitude:-17.83804699,longitude:-46.5179054},{name:"Claraval",latitude:-20.39837608,longitude:-47.28776129},{name:"Divinsia",latitude:-20.99001034,longitude:-43.0110812},{name:"Abadia dos Dourados",latitude:-18.48756496,longitude:-47.39683244},{name:"GuardaMor",latitude:null,longitude:null},{name:"Lagoa Dourada",latitude:-20.91859862,longitude:-44.07111644},{name:"Uberlndia",latitude:-18.91899861,longitude:-48.27795018},{name:"Ibiraci",latitude:-20.47015488,longitude:-47.13080349},{name:"Carmo do Paranaba",latitude:-18.99728903,longitude:-46.31428888},{name:"Tiros",latitude:-19.00391738,longitude:-45.9635511},{name:"Carmo do Rio Claro",latitude:-20.97299653,longitude:-46.12196473},{name:"Serra do Salitre",latitude:-19.11179576,longitude:-46.69210873},{name:"Cruzeiro da Fortaleza",latitude:-18.93864732,longitude:-46.67339265},{name:"Conceio da Aparecida",latitude:-21.09662007,longitude:-46.20312725},{name:"Ira de Minas",latitude:-18.98185835,longitude:-47.46299142},{name:"Urucuia",latitude:-19.64302117,longitude:-44.35784798},{name:"Santa Rosa da Serra",latitude:-19.53262114,longitude:-45.97066443},{name:"Felcio dos Santos",latitude:-18.07756312,longitude:-43.24517093},{name:"Monte Carmelo",latitude:-18.72903844,longitude:-47.49597243},{name:"Estrela do Sul",latitude:-18.74129318,longitude:-47.6889748},{name:"Bocaiva",latitude:-17.11210473,longitude:-43.81444357},{name:"Nova Resende",latitude:-21.12665191,longitude:-46.4170291},{name:"Romaria",latitude:-18.88348003,longitude:-47.5817549},{name:"Bom Jesus da Penha",latitude:-21.01726931,longitude:-46.52354361},{name:"Lagoa Formosa",latitude:-18.77557258,longitude:-46.40652879},{name:"Indianpolis",latitude:-19.04249493,longitude:-47.91799232},{name:"Cascalho Rico",latitude:-18.57859025,longitude:-47.87599878},{name:"Uberaba",latitude:-19.71353461,longitude:-47.9836249},{name:"So Gonalo do Rio Preto",latitude:-18.00639416,longitude:-43.38454373},{name:"Tupaciguara",latitude:-18.59935256,longitude:-48.69373588},{name:"Presidente Olegrio",latitude:-18.41474197,longitude:-46.41778869},{name:"Araguari",latitude:-18.64826953,longitude:-48.19160538},{name:"Alpinpolis",latitude:-20.86185466,longitude:-46.38948253},{name:"Patis",latitude:-16.07927636,longitude:-44.08270531},{name:"Itacambira",latitude:-17.06443518,longitude:-43.31040219},{name:"So Gonalo do Abaet",latitude:-18.34111293,longitude:-45.83424615},{name:"Ibia",latitude:-16.85987245,longitude:-44.91410684},{name:"Rio Pardo de Minas",latitude:-15.61307802,longitude:-42.54123198},{name:"Indaiabira",latitude:-15.49238471,longitude:-42.20358482},{name:"guas Vermelhas",latitude:-15.74531995,longitude:-41.4587883},{name:"Varjo de Minas",latitude:-18.38370446,longitude:-46.03350155},{name:"Bonfinpolis de Minas",latitude:-16.57076479,longitude:-45.98834066},{name:"Lassance",latitude:-17.89511518,longitude:-44.57935856},{name:"Formoso",latitude:-14.9517426,longitude:-46.23997954},{name:"Joo Pinheiro",latitude:-17.74185294,longitude:-46.17546355},{name:"Paracatu",latitude:-17.21974191,longitude:-46.87541889},{name:"Una",latitude:-16.35900849,longitude:-46.8999566},{name:"Taiobeiras",latitude:-15.81152144,longitude:-42.22791555},{name:"Buritizeiro",latitude:-17.35942077,longitude:-44.95519368},{name:"Ninheira",latitude:-15.32380192,longitude:-41.74878896},{name:"Buritis",latitude:-15.62650549,longitude:-46.4240408},{name:"Vrzea da Palma",latitude:-17.59757018,longitude:-44.73034658},{name:"Quartel Geral",latitude:-19.2676901,longitude:-45.55886339},{name:"Pirapora",latitude:-17.3495821,longitude:-44.95106538}];function Upe({value:e,onSelect:t,placeholder:r="Selecione uma cidade..."}){const[n,o]=ue.useState(!1);return be.jsxs(Bpe,{open:n,onOpenChange:o,children:[be.jsx(zpe,{asChild:!0,children:be.jsxs(Ec,{variant:"outline",role:"combobox","aria-expanded":n,className:"w-full justify-between",children:[e||r,be.jsx(yle,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),be.jsx(KX,{className:"w-full p-0 bg-background border border-border shadow-lg z-50",children:be.jsxs(DX,{children:[be.jsx(FX,{placeholder:"Buscar cidade..."}),be.jsxs(LX,{children:[be.jsx(NX,{children:"Nenhuma cidade encontrada."}),be.jsx(BX,{children:jpe.map(u=>be.jsxs(zX,{value:u.name,onSelect:()=>{t(u),o(!1)},className:"cursor-pointer",children:[be.jsx(DH,{className:Ci("mr-2 h-4 w-4",e===u.name?"opacity-100":"opacity-0")}),u.name]},u.name))})]})]})})]})}const Sj=[{id:"T2M",name:"Temperatura a 2 metros (C)",default:!0},{id:"T2M_MAX",name:"Temperatura Mxima a 2 metros (C)",default:!1},{id:"T2M_MIN",name:"Temperatura Mnima a 2 metros (C)",default:!1},{id:"RH2M",name:"Umidade Relativa a 2 metros (%)",default:!1},{id:"PRECTOTCORR",name:"Precipitao pluviomtrica (mm/dia)",default:!0},{id:"PS",name:"Presso atmosfrica (kPa)",default:!1},{id:"WS10M",name:"Velocidade do vento a 10 metros (m/s)",default:!1}],$pe=({onDataReceived:e,onLoadingChange:t})=>{const[r,n]=ue.useState(""),[o,u]=ue.useState(""),[d,i]=ue.useState(""),[v,w]=ue.useState("2020-01-01"),[S,C]=ue.useState(()=>{const U=new Date;return U.setDate(U.getDate()-4),U.toISOString().split("T")[0]}),[k,O]=ue.useState(Sj.filter(U=>U.default).map(U=>U.id)),{toast:L}=r2(),R=(U,J)=>{O(J?Z=>[...Z,U]:Z=>Z.filter(K=>K!==U))},N=U=>{i(U.name),U.latitude!==null&&U.longitude!==null?(n(U.latitude.toFixed(4)),u(U.longitude.toFixed(4)),L({title:"Cidade selecionada!",description:`${U.name} - Coordenadas: ${U.latitude.toFixed(4)}, ${U.longitude.toFixed(4)}`})):(n(""),u(""),L({title:"Cidade selecionada!",description:`${U.name} - Coordenadas no disponveis. Por favor, insira manualmente.`,variant:"destructive"}))},V=async U=>{if(U.preventDefault(),!r||!o){L({title:"Coordenadas em falta",description:"Por favor, insira latitude e longitude ou busque por uma cidade",variant:"destructive"});return}if(k.length===0){L({title:"Selecione parmetros",description:"Por favor, selecione pelo menos um parmetro climtico",variant:"destructive"});return}const J=parseFloat(r),Z=parseFloat(o);if(J<-90||J>90||Z<-180||Z>180){L({title:"Coordenadas invlidas",description:"Latitude deve estar entre -90 e 90, longitude entre -180 e 180",variant:"destructive"});return}t(!0);try{const K=await Gfe.getClimateData(J,Z,k,v,S);e(K),L({title:"Sucesso!",description:"Dados climticos carregados com sucesso"})}catch{L({title:"Erro",description:"Falha ao buscar dados climticos. Tente novamente.",variant:"destructive"})}finally{t(!1)}},G=()=>{if(!navigator.geolocation){L({title:"Geolocation not supported",description:"Your browser doesn't support geolocation",variant:"destructive"});return}navigator.geolocation.getCurrentPosition(U=>{n(U.coords.latitude.toFixed(4)),u(U.coords.longitude.toFixed(4)),L({title:"Location found!",description:"Your coordinates have been set"})},U=>{L({title:"Location error",description:"Failed to get your location",variant:"destructive"})})};return be.jsxs(Cc,{className:"p-8 bg-white/90 backdrop-blur-sm shadow-climate border-white/50 max-w-4xl mx-auto",children:[be.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[be.jsx(XR,{className:"h-6 w-6 text-primary"}),be.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Buscar Dados Climticos"})]}),be.jsxs("form",{onSubmit:V,className:"space-y-6",children:[be.jsxs("div",{className:"space-y-2",children:[be.jsx(ff,{className:"text-sm font-medium text-foreground",children:"Selecionar Cidade de Minas Gerais"}),be.jsx(Upe,{value:d,onSelect:N,placeholder:"Selecione uma cidade de Minas Gerais..."})]}),be.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[be.jsxs("div",{children:[be.jsx(ff,{htmlFor:"latitude",className:"text-sm font-medium text-foreground",children:"Latitude"}),be.jsx(rw,{id:"latitude",type:"number",step:"0.0001",min:"-90",max:"90",value:r,onChange:U=>n(U.target.value),placeholder:"ex: -23.5505",className:"border-primary/20 focus:border-primary"})]}),be.jsxs("div",{children:[be.jsx(ff,{htmlFor:"longitude",className:"text-sm font-medium text-foreground",children:"Longitude"}),be.jsx(rw,{id:"longitude",type:"number",step:"0.0001",min:"-180",max:"180",value:o,onChange:U=>u(U.target.value),placeholder:"ex: -46.6333",className:"border-primary/20 focus:border-primary"})]})]}),be.jsxs("div",{className:"space-y-3",children:[be.jsxs(ff,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[be.jsx(gle,{className:"h-4 w-4"}),"Perodo dos Dados"]}),be.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[be.jsxs("div",{children:[be.jsx(ff,{htmlFor:"startDate",className:"text-xs text-muted-foreground",children:"Data de Incio"}),be.jsx(rw,{id:"startDate",type:"date",value:v,onChange:U=>w(U.target.value),min:"2001-01-01",max:(()=>{const U=new Date;return U.setDate(U.getDate()-4),U.toISOString().split("T")[0]})(),className:"border-primary/20 focus:border-primary"})]}),be.jsxs("div",{children:[be.jsx(ff,{htmlFor:"endDate",className:"text-xs text-muted-foreground",children:"Data de Fim"}),be.jsx(rw,{id:"endDate",type:"date",value:S,onChange:U=>C(U.target.value),min:"2001-01-01",max:(()=>{const U=new Date;return U.setDate(U.getDate()-4),U.toISOString().split("T")[0]})(),className:"border-primary/20 focus:border-primary"})]})]})]}),be.jsxs("div",{className:"space-y-3",children:[be.jsx(ff,{className:"text-sm font-medium text-foreground",children:"Parmetros Climticos"}),be.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Sj.map(U=>be.jsxs("div",{className:"flex items-center space-x-2",children:[be.jsx(qq,{id:U.id,checked:k.includes(U.id),onCheckedChange:J=>R(U.id,J)}),be.jsx(ff,{htmlFor:U.id,className:"text-sm font-normal text-foreground/90 cursor-pointer",children:U.name})]},U.id))})]}),be.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[be.jsxs(Ec,{type:"button",variant:"secondary",onClick:G,className:"flex items-center gap-2",children:[be.jsx(qF,{className:"h-4 w-4"}),"Usar Minha Localizao"]}),be.jsxs(Ec,{type:"submit",className:"flex-1 bg-gradient-ocean hover:opacity-90 shadow-glow",children:[be.jsx(XR,{className:"mr-2 h-4 w-4"}),"Buscar Dados Climticos"]})]})]})]})},Vpe=o2("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function _w({className:e,variant:t,...r}){return be.jsx("div",{className:Ci(Vpe({variant:t}),e),...r})}function ZS({className:e,...t}){return be.jsx("div",{className:Ci("animate-pulse rounded-md bg-muted",e),...t})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jw={};Jw.version="0.18.5";var Xl=1200,x0=1252,Wpe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],x4={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gP=function(e){Wpe.indexOf(e)!=-1&&(x0=x4[0]=e)};function Gpe(){gP(1252)}var Pc=function(e){Xl=e,gP(e)};function _P(){Pc(1200),Gpe()}function vA(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Hpe(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function JX(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var K_=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Hpe(e.slice(2)):t==254&&r==255?JX(e.slice(2)):t==65279?e.slice(1):e},nw=function(t){return String.fromCharCode(t)},u3=function(t){return String.fromCharCode(t)},Pi;function qpe(e){Pi=e,Pc=function(t){Xl=t,gP(t)},K_=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Pi.utils.decode(1200,vA(t.slice(2))):t},nw=function(r){return Xl===1200?String.fromCharCode(r):Pi.utils.decode(Xl,[r&255,r>>8])[0]},u3=function(r){return Pi.utils.decode(x0,[r])[0]},CZ()}var np="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qw(e){for(var t="",r=0,n=0,o=0,u=0,d=0,i=0,v=0,w=0;w<e.length;)r=e.charCodeAt(w++),u=r>>2,n=e.charCodeAt(w++),d=(r&3)<<4|n>>4,o=e.charCodeAt(w++),i=(n&15)<<2|o>>6,v=o&63,isNaN(n)?i=v=64:isNaN(o)&&(v=64),t+=np.charAt(u)+np.charAt(d)+np.charAt(i)+np.charAt(v);return t}function Yl(e){var t="",r=0,n=0,o=0,u=0,d=0,i=0,v=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var w=0;w<e.length;)u=np.indexOf(e.charAt(w++)),d=np.indexOf(e.charAt(w++)),r=u<<2|d>>4,t+=String.fromCharCode(r),i=np.indexOf(e.charAt(w++)),n=(d&15)<<4|i>>2,i!==64&&(t+=String.fromCharCode(n)),v=np.indexOf(e.charAt(w++)),o=(i&3)<<6|v,v!==64&&(t+=String.fromCharCode(o));return t}var oi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),jf=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ap(e){return oi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ej(e){return oi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $l=function(t){return oi?jf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function u2(e){if(typeof ArrayBuffer>"u")return $l(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Fp(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Xpe(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function w4(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return w4(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Yo=oi?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:jf(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),o=0;for(t=0,r=0;t<e.length;r+=o,++t)if(o=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(u){return Array.isArray(u)?u:[].slice.call(u)}))};function Zpe(e){for(var t=[],r=0,n=e.length+250,o=Ap(e.length+255),u=0;u<e.length;++u){var d=e.charCodeAt(u);if(d<128)o[r++]=d;else if(d<2048)o[r++]=192|d>>6&31,o[r++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var i=e.charCodeAt(++u)&1023;o[r++]=240|d>>8&7,o[r++]=128|d>>2&63,o[r++]=128|i>>6&15|(d&3)<<4,o[r++]=128|i&63}else o[r++]=224|d>>12&15,o[r++]=128|d>>6&63,o[r++]=128|d&63;r>n&&(t.push(o.slice(0,r)),r=0,o=Ap(65535),n=65530)}return t.push(o.slice(0,r)),Yo(t)}var Os=/\u0000/g,iw=/[\u0001-\u0006]/g;function fy(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function gu(e,t){var r=""+e;return r.length>=t?r:Ka("0",t-r.length)+r}function b4(e,t){var r=""+e;return r.length>=t?r:Ka(" ",t-r.length)+r}function xA(e,t){var r=""+e;return r.length>=t?r:r+Ka(" ",t-r.length)}function Ype(e,t){var r=""+Math.round(e);return r.length>=t?r:Ka("0",t-r.length)+r}function Kpe(e,t){var r=""+e;return r.length>=t?r:Ka("0",t-r.length)+r}var Aj=Math.pow(2,32);function A_(e,t){if(e>Aj||e<-Aj)return Ype(e,t);var r=Math.round(e);return Kpe(r,t)}function wA(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Cj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lM=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Jpe(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var xn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qpe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bA(e,t,r){for(var n=e<0?-1:1,o=e*n,u=0,d=1,i=0,v=1,w=0,S=0,C=Math.floor(o);w<t&&(C=Math.floor(o),i=C*d+u,S=C*w+v,!(o-C<5e-8));)o=1/(o-C),u=d,d=i,v=w,w=S;if(S>t&&(w>t?(S=v,i=u):(S=w,i=d)),!r)return[0,n*i,S];var k=Math.floor(n*i/S);return[k,n*i-k*S,S]}function ip(e,t,r){if(e>2958465||e<0)return null;var n=e|0,o=Math.floor(86400*(e-n)),u=0,d=[],i={D:n,T:o,u:86400*(e-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(i.u)<1e-6&&(i.u=0),t&&t.date1904&&(n+=1462),i.u>.9999&&(i.u=0,++o==86400&&(i.T=o=0,++n,++i.D)),n===60)d=r?[1317,10,29]:[1900,2,29],u=3;else if(n===0)d=r?[1317,8,29]:[1900,1,0],u=6;else{n>60&&--n;var v=new Date(1900,0,1);v.setDate(v.getDate()+n-1),d=[v.getFullYear(),v.getMonth()+1,v.getDate()],u=v.getDay(),n<60&&(u=(u+6)%7),r&&(u=ame(v,d))}return i.y=d[0],i.m=d[1],i.d=d[2],i.S=o%60,o=Math.floor(o/60),i.M=o%60,o=Math.floor(o/60),i.H=o,i.q=u,i}var QX=new Date(1899,11,31,0,0,0),eme=QX.getTime(),tme=new Date(1900,2,1,0,0,0);function eZ(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=tme&&(r+=24*60*60*1e3),(r-(eme+(e.getTimezoneOffset()-QX.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function T4(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rme(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function nme(e){var t=e<0?12:11,r=T4(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function ime(e){var t=T4(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function eb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=nme(e):t===10?r=e.toFixed(10).substr(0,12):r=ime(e),T4(rme(r.toUpperCase()))}function w0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):eb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kl(14,eZ(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ame(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ome(e,t,r,n){var o="",u=0,d=0,i=r.y,v,w=0;switch(e){case 98:i=r.y+543;case 121:switch(t.length){case 1:case 2:v=i%100,w=2;break;default:v=i%1e4,w=4;break}break;case 109:switch(t.length){case 1:case 2:v=r.m,w=t.length;break;case 3:return lM[r.m-1][1];case 5:return lM[r.m-1][0];default:return lM[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:v=r.d,w=t.length;break;case 3:return Cj[r.q][0];default:return Cj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:v=1+(r.H+11)%12,w=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:v=r.H,w=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:v=r.M,w=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?gu(r.S,t.length):(n>=2?d=n===3?1e3:100:d=n===1?10:1,u=Math.round(d*(r.S+r.u)),u>=60*d&&(u=0),t==="s"?u===0?"0":""+u/d:(o=gu(u,2+n),t==="ss"?o.substr(0,2):"."+o.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":v=r.D*24+r.H;break;case"[m]":case"[mm]":v=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":v=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}w=t.length===3?1:2;break;case 101:v=i,w=1;break}var S=w>0?gu(v,w):"";return S}function ap(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var tZ=/%/g;function sme(e,t,r){var n=t.replace(tZ,""),o=t.length-n.length;return Tf(e,n,r*Math.pow(10,2*o))+Ka("%",o)}function lme(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Tf(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function rZ(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rZ(e,-t);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var u=Math.floor(Math.log(t)*Math.LOG10E)%o;if(u<0&&(u+=o),r=(t/Math.pow(10,u)).toPrecision(n+1+(o+u)%o),r.indexOf("e")===-1){var d=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+u):r+="E+"+(d-u);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,o)+"."+r.substr(2+o),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(i,v,w,S){return v+w+S.substr(0,(o+u)%o)+"."+S.substr(u)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var nZ=/# (\?+)( ?)\/( ?)(\d+)/;function cme(e,t,r){var n=parseInt(e[4],10),o=Math.round(t*n),u=Math.floor(o/n),d=o-u*n,i=n;return r+(u===0?"":""+u)+" "+(d===0?Ka(" ",e[1].length+1+e[4].length):b4(d,e[1].length)+e[2]+"/"+e[3]+gu(i,e[4].length))}function ume(e,t,r){return r+(t===0?"":""+t)+Ka(" ",e[1].length+2+e[4].length)}var iZ=/^#*0*\.([0#]+)/,aZ=/\).*[0#]/,oZ=/\(###\) ###\\?-####/;function Ys(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ij(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function kj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function hme(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function fme(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(aZ)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gc("n",n,r):"("+gc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return lme(e,t,r);if(t.indexOf("%")!==-1)return sme(e,t,r);if(t.indexOf("E")!==-1)return rZ(t,r);if(t.charCodeAt(0)===36)return"$"+gc(e,t.substr(t.charAt(1)==" "?2:1),r);var o,u,d,i,v=Math.abs(r),w=r<0?"-":"";if(t.match(/^00+$/))return w+A_(v,t.length);if(t.match(/^[#?]+$/))return o=A_(r,0),o==="0"&&(o=""),o.length>t.length?o:Ys(t.substr(0,t.length-o.length))+o;if(u=t.match(nZ))return cme(u,v,w);if(t.match(/^#+0+$/))return w+A_(v,t.length-t.indexOf("0"));if(u=t.match(iZ))return o=Ij(r,u[1].length).replace(/^([^\.]+)$/,"$1."+Ys(u[1])).replace(/\.$/,"."+Ys(u[1])).replace(/\.(\d*)$/,function(L,R){return"."+R+Ka("0",Ys(u[1]).length-R.length)}),t.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),u=t.match(/^(0*)\.(#*)$/))return w+Ij(v,u[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=t.match(/^#{1,3},##0(\.?)$/))return w+ap(A_(v,0));if(u=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gc(e,t,-r):ap(""+(Math.floor(r)+hme(r,u[1].length)))+"."+gu(kj(r,u[1].length),u[1].length);if(u=t.match(/^#,#*,#0/))return gc(e,t.replace(/^#,#*,/,""),r);if(u=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=fy(gc(e,t.replace(/[\\-]/g,""),r)),d=0,fy(fy(t.replace(/\\/g,"")).replace(/[0#]/g,function(L){return d<o.length?o.charAt(d++):L==="0"?"0":""}));if(t.match(oZ))return o=gc(e,"##########",r),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var S="";if(u=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(u[4].length,7),i=bA(v,Math.pow(10,d)-1,!1),o=""+w,S=Tf("n",u[1],i[1]),S.charAt(S.length-1)==" "&&(S=S.substr(0,S.length-1)+"0"),o+=S+u[2]+"/"+u[3],S=xA(i[2],d),S.length<u[4].length&&(S=Ys(u[4].substr(u[4].length-S.length))+S),o+=S,o;if(u=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(u[1].length,u[4].length),7),i=bA(v,Math.pow(10,d)-1,!0),w+(i[0]||(i[1]?"":"0"))+" "+(i[1]?b4(i[1],d)+u[2]+"/"+u[3]+xA(i[2],d):Ka(" ",2*d+1+u[2].length+u[3].length));if(u=t.match(/^[#0?]+$/))return o=A_(r,0),t.length<=o.length?o:Ys(t.substr(0,t.length-o.length))+o;if(u=t.match(/^([#0?]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var C=t.indexOf(".")-d,k=t.length-o.length-C;return Ys(t.substr(0,C)+o+t.substr(t.length-k))}if(u=t.match(/^00,000\.([#0]*0)$/))return d=kj(r,u[1].length),r<0?"-"+gc(e,t,-r):ap(fme(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(L){return"00,"+(L.length<3?gu(0,3-L.length):"")+L})+"."+gu(d,u[1].length);switch(t){case"###,##0.00":return gc(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var O=ap(A_(v,0));return O!=="0"?w+O:"";case"###,###.00":return gc(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gc(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function dme(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Tf(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function pme(e,t,r){var n=t.replace(tZ,""),o=t.length-n.length;return Tf(e,n,r*Math.pow(10,2*o))+Ka("%",o)}function sZ(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sZ(e,-t);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var u=Math.floor(Math.log(t)*Math.LOG10E)%o;if(u<0&&(u+=o),r=(t/Math.pow(10,u)).toPrecision(n+1+(o+u)%o),!r.match(/[Ee]/)){var d=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+u):r+="E+"+(d-u),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(i,v,w,S){return v+w+S.substr(0,(o+u)%o)+"."+S.substr(u)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ih(e,t,r){if(e.charCodeAt(0)===40&&!t.match(aZ)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ih("n",n,r):"("+ih("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return dme(e,t,r);if(t.indexOf("%")!==-1)return pme(e,t,r);if(t.indexOf("E")!==-1)return sZ(t,r);if(t.charCodeAt(0)===36)return"$"+ih(e,t.substr(t.charAt(1)==" "?2:1),r);var o,u,d,i,v=Math.abs(r),w=r<0?"-":"";if(t.match(/^00+$/))return w+gu(v,t.length);if(t.match(/^[#?]+$/))return o=""+r,r===0&&(o=""),o.length>t.length?o:Ys(t.substr(0,t.length-o.length))+o;if(u=t.match(nZ))return ume(u,v,w);if(t.match(/^#+0+$/))return w+gu(v,t.length-t.indexOf("0"));if(u=t.match(iZ))return o=(""+r).replace(/^([^\.]+)$/,"$1."+Ys(u[1])).replace(/\.$/,"."+Ys(u[1])),o=o.replace(/\.(\d*)$/,function(L,R){return"."+R+Ka("0",Ys(u[1]).length-R.length)}),t.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),u=t.match(/^(0*)\.(#*)$/))return w+(""+v).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=t.match(/^#{1,3},##0(\.?)$/))return w+ap(""+v);if(u=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ih(e,t,-r):ap(""+r)+"."+Ka("0",u[1].length);if(u=t.match(/^#,#*,#0/))return ih(e,t.replace(/^#,#*,/,""),r);if(u=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=fy(ih(e,t.replace(/[\\-]/g,""),r)),d=0,fy(fy(t.replace(/\\/g,"")).replace(/[0#]/g,function(L){return d<o.length?o.charAt(d++):L==="0"?"0":""}));if(t.match(oZ))return o=ih(e,"##########",r),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var S="";if(u=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(u[4].length,7),i=bA(v,Math.pow(10,d)-1,!1),o=""+w,S=Tf("n",u[1],i[1]),S.charAt(S.length-1)==" "&&(S=S.substr(0,S.length-1)+"0"),o+=S+u[2]+"/"+u[3],S=xA(i[2],d),S.length<u[4].length&&(S=Ys(u[4].substr(u[4].length-S.length))+S),o+=S,o;if(u=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(u[1].length,u[4].length),7),i=bA(v,Math.pow(10,d)-1,!0),w+(i[0]||(i[1]?"":"0"))+" "+(i[1]?b4(i[1],d)+u[2]+"/"+u[3]+xA(i[2],d):Ka(" ",2*d+1+u[2].length+u[3].length));if(u=t.match(/^[#0?]+$/))return o=""+r,t.length<=o.length?o:Ys(t.substr(0,t.length-o.length))+o;if(u=t.match(/^([#0]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var C=t.indexOf(".")-d,k=t.length-o.length-C;return Ys(t.substr(0,C)+o+t.substr(t.length-k))}if(u=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ih(e,t,-r):ap(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(L){return"00,"+(L.length<3?gu(0,3-L.length):"")+L})+"."+gu(0,u[1].length);switch(t){case"###,###":case"##,###":case"#,###":var O=ap(""+v);return O!=="0"?w+O:"";default:if(t.match(/\.[0#?]*$/))return ih(e,t.slice(0,t.lastIndexOf(".")),r)+Ys(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Tf(e,t,r){return(r|0)===r?ih(e,t,r):gc(e,t,r)}function mme(e){for(var t=[],r=!1,n=0,o=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(o,n-o),o=n+1}if(t[t.length]=e.substr(o),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lZ=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function F0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":wA(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(lZ))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function gme(e,t,r,n){for(var o=[],u="",d=0,i="",v="t",w,S,C,k="H";d<e.length;)switch(i=e.charAt(d)){case"G":if(!wA(e,d))throw new Error("unrecognized character "+i+" in "+e);o[o.length]={t:"G",v:"General"},d+=7;break;case'"':for(u="";(C=e.charCodeAt(++d))!==34&&d<e.length;)u+=String.fromCharCode(C);o[o.length]={t:"t",v:u},++d;break;case"\\":var O=e.charAt(++d),L=O==="("||O===")"?O:"t";o[o.length]={t:L,v:O},++d;break;case"_":o[o.length]={t:"t",v:" "},d+=2;break;case"@":o[o.length]={t:"T",v:t},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(w==null&&(w=ip(t,r,e.charAt(d+1)==="2"),w==null))return"";o[o.length]={t:"X",v:e.substr(d,2)},v=i,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":i=i.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||w==null&&(w=ip(t,r),w==null))return"";for(u=i;++d<e.length&&e.charAt(d).toLowerCase()===i;)u+=i;i==="m"&&v.toLowerCase()==="h"&&(i="M"),i==="h"&&(i=k),o[o.length]={t:i,v:u},v=i;break;case"A":case"a":case"":var R={t:i,v:i};if(w==null&&(w=ip(t,r)),e.substr(d,3).toUpperCase()==="A/P"?(w!=null&&(R.v=w.H>=12?"P":"A"),R.t="T",k="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(w!=null&&(R.v=w.H>=12?"PM":"AM"),R.t="T",d+=5,k="h"):e.substr(d,5).toUpperCase()==="/"?(w!=null&&(R.v=w.H>=12?"":""),R.t="T",d+=5,k="h"):(R.t="t",++d),w==null&&R.t==="T")return"";o[o.length]=R,v=i;break;case"[":for(u=i;e.charAt(d++)!=="]"&&d<e.length;)u+=e.charAt(d);if(u.slice(-1)!=="]")throw'unterminated "[" block: |'+u+"|";if(u.match(lZ)){if(w==null&&(w=ip(t,r),w==null))return"";o[o.length]={t:"Z",v:u.toLowerCase()},v=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",F0(e)||(o[o.length]={t:"t",v:u}));break;case".":if(w!=null){for(u=i;++d<e.length&&(i=e.charAt(d))==="0";)u+=i;o[o.length]={t:"s",v:u};break}case"0":case"#":for(u=i;++d<e.length&&"0#?.,E+-%".indexOf(i=e.charAt(d))>-1;)u+=i;o[o.length]={t:"n",v:u};break;case"?":for(u=i;e.charAt(++d)===i;)u+=i;o[o.length]={t:i,v:u},v=i;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":o[o.length]={t:n===1?"t":i,v:i},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=i;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)u+=e.charAt(d);o[o.length]={t:"D",v:u};break;case" ":o[o.length]={t:i,v:i},++d;break;case"$":o[o.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(i)===-1)throw new Error("unrecognized character "+i+" in "+e);o[o.length]={t:"t",v:i},++d;break}var N=0,V=0,G;for(d=o.length-1,v="t";d>=0;--d)switch(o[d].t){case"h":case"H":o[d].t=k,v="h",N<1&&(N=1);break;case"s":(G=o[d].v.match(/\.0+$/))&&(V=Math.max(V,G[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":v=o[d].t;break;case"m":v==="s"&&(o[d].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&o[d].v.match(/[Hh]/)&&(N=1),N<2&&o[d].v.match(/[Mm]/)&&(N=2),N<3&&o[d].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:w.u>=.5&&(w.u=0,++w.S),w.S>=60&&(w.S=0,++w.M),w.M>=60&&(w.M=0,++w.H);break;case 2:w.u>=.5&&(w.u=0,++w.S),w.S>=60&&(w.S=0,++w.M);break}var U="",J;for(d=0;d<o.length;++d)switch(o[d].t){case"t":case"T":case" ":case"D":break;case"X":o[d].v="",o[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[d].v=ome(o[d].t.charCodeAt(0),o[d].v,w,V),o[d].t="t";break;case"n":case"?":for(J=d+1;o[J]!=null&&((i=o[J].t)==="?"||i==="D"||(i===" "||i==="t")&&o[J+1]!=null&&(o[J+1].t==="?"||o[J+1].t==="t"&&o[J+1].v==="/")||o[d].t==="("&&(i===" "||i==="n"||i===")")||i==="t"&&(o[J].v==="/"||o[J].v===" "&&o[J+1]!=null&&o[J+1].t=="?"));)o[d].v+=o[J].v,o[J]={v:"",t:";"},++J;U+=o[d].v,d=J-1;break;case"G":o[d].t="t",o[d].v=w0(t,r);break}var Z="",K,re;if(U.length>0){U.charCodeAt(0)==40?(K=t<0&&U.charCodeAt(0)===45?-t:t,re=Tf("n",U,K)):(K=t<0&&n>1?-t:t,re=Tf("n",U,K),K<0&&o[0]&&o[0].t=="t"&&(re=re.substr(1),o[0].v="-"+o[0].v)),J=re.length-1;var ge=o.length;for(d=0;d<o.length;++d)if(o[d]!=null&&o[d].t!="t"&&o[d].v.indexOf(".")>-1){ge=d;break}var ve=o.length;if(ge===o.length&&re.indexOf("E")===-1){for(d=o.length-1;d>=0;--d)o[d]==null||"n?".indexOf(o[d].t)===-1||(J>=o[d].v.length-1?(J-=o[d].v.length,o[d].v=re.substr(J+1,o[d].v.length)):J<0?o[d].v="":(o[d].v=re.substr(0,J+1),J=-1),o[d].t="t",ve=d);J>=0&&ve<o.length&&(o[ve].v=re.substr(0,J+1)+o[ve].v)}else if(ge!==o.length&&re.indexOf("E")===-1){for(J=re.indexOf(".")-1,d=ge;d>=0;--d)if(!(o[d]==null||"n?".indexOf(o[d].t)===-1)){for(S=o[d].v.indexOf(".")>-1&&d===ge?o[d].v.indexOf(".")-1:o[d].v.length-1,Z=o[d].v.substr(S+1);S>=0;--S)J>=0&&(o[d].v.charAt(S)==="0"||o[d].v.charAt(S)==="#")&&(Z=re.charAt(J--)+Z);o[d].v=Z,o[d].t="t",ve=d}for(J>=0&&ve<o.length&&(o[ve].v=re.substr(0,J+1)+o[ve].v),J=re.indexOf(".")+1,d=ge;d<o.length;++d)if(!(o[d]==null||"n?(".indexOf(o[d].t)===-1&&d!==ge)){for(S=o[d].v.indexOf(".")>-1&&d===ge?o[d].v.indexOf(".")+1:0,Z=o[d].v.substr(0,S);S<o[d].v.length;++S)J<re.length&&(Z+=re.charAt(J++));o[d].v=Z,o[d].t="t",ve=d}}}for(d=0;d<o.length;++d)o[d]!=null&&"n?".indexOf(o[d].t)>-1&&(K=n>1&&t<0&&d>0&&o[d-1].v==="-"?-t:t,o[d].v=Tf(o[d].t,o[d].v,K),o[d].t="t");var $e="";for(d=0;d!==o.length;++d)o[d]!=null&&($e+=o[d].v);return $e}var Oj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _me(e,t){var r=mme(e),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var u=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,u];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var d=r[0].match(Oj),i=r[1].match(Oj);return Mj(t,d)?[n,r[0]]:Mj(t,i)?[n,r[1]]:[n,r[d!=null&&i!=null?2:1]]}return[n,u]}function Kl(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xn)[e],n==null&&(n=r.table&&r.table[Pj[e]]||xn[Pj[e]]),n==null&&(n=Qpe[e]||"General");break}if(wA(n,0))return w0(t,r);t instanceof Date&&(t=eZ(t,r.date1904));var o=_me(n,t);if(wA(o[1]))return w0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return gme(o[1],t,r,o[0])}function wh(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xn[r]==null){t<0&&(t=r);continue}if(xn[r]==e){t=r;break}}t<0&&(t=391)}return xn[t]=e,t}function h2(e){for(var t=0;t!=392;++t)e[t]!==void 0&&wh(e[t],t)}function _v(){xn=Jpe()}var cZ={format:Kl,load:wh,_table:xn,load_table:h2,parse_date_code:ip,is_date:F0,get_table:function(){return cZ._table=xn}},yme={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},uZ=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vme(e){var t=typeof e=="number"?xn[e]:e;return t=t.replace(uZ,"(\\d+)"),new RegExp("^"+t+"$")}function xme(e,t,r){var n=-1,o=-1,u=-1,d=-1,i=-1,v=-1;(t.match(uZ)||[]).forEach(function(C,k){var O=parseInt(r[k+1],10);switch(C.toLowerCase().charAt(0)){case"y":n=O;break;case"d":u=O;break;case"h":d=O;break;case"s":v=O;break;case"m":d>=0?i=O:o=O;break}}),v>=0&&i==-1&&o>=0&&(i=o,o=-1);var w=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(u>=1?u:1)).slice(-2);w.length==7&&(w="0"+w),w.length==8&&(w="20"+w);var S=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(v>=0?v:0)).slice(-2);return d==-1&&i==-1&&v==-1?w:n==-1&&o==-1&&u==-1?S:w+"T"+S}var wme=function(){var e={};e.version="1.2.0";function t(){for(var re=0,ge=new Array(256),ve=0;ve!=256;++ve)re=ve,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,ge[ve]=re;return typeof Int32Array<"u"?new Int32Array(ge):ge}var r=t();function n(re){var ge=0,ve=0,$e=0,Ie=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for($e=0;$e!=256;++$e)Ie[$e]=re[$e];for($e=0;$e!=256;++$e)for(ve=re[$e],ge=256+$e;ge<4096;ge+=256)ve=Ie[ge]=ve>>>8^re[ve&255];var ke=[];for($e=1;$e!=16;++$e)ke[$e-1]=typeof Int32Array<"u"?Ie.subarray($e*256,$e*256+256):Ie.slice($e*256,$e*256+256);return ke}var o=n(r),u=o[0],d=o[1],i=o[2],v=o[3],w=o[4],S=o[5],C=o[6],k=o[7],O=o[8],L=o[9],R=o[10],N=o[11],V=o[12],G=o[13],U=o[14];function J(re,ge){for(var ve=ge^-1,$e=0,Ie=re.length;$e<Ie;)ve=ve>>>8^r[(ve^re.charCodeAt($e++))&255];return~ve}function Z(re,ge){for(var ve=ge^-1,$e=re.length-15,Ie=0;Ie<$e;)ve=U[re[Ie++]^ve&255]^G[re[Ie++]^ve>>8&255]^V[re[Ie++]^ve>>16&255]^N[re[Ie++]^ve>>>24]^R[re[Ie++]]^L[re[Ie++]]^O[re[Ie++]]^k[re[Ie++]]^C[re[Ie++]]^S[re[Ie++]]^w[re[Ie++]]^v[re[Ie++]]^i[re[Ie++]]^d[re[Ie++]]^u[re[Ie++]]^r[re[Ie++]];for($e+=15;Ie<$e;)ve=ve>>>8^r[(ve^re[Ie++])&255];return~ve}function K(re,ge){for(var ve=ge^-1,$e=0,Ie=re.length,ke=0,tt=0;$e<Ie;)ke=re.charCodeAt($e++),ke<128?ve=ve>>>8^r[(ve^ke)&255]:ke<2048?(ve=ve>>>8^r[(ve^(192|ke>>6&31))&255],ve=ve>>>8^r[(ve^(128|ke&63))&255]):ke>=55296&&ke<57344?(ke=(ke&1023)+64,tt=re.charCodeAt($e++)&1023,ve=ve>>>8^r[(ve^(240|ke>>8&7))&255],ve=ve>>>8^r[(ve^(128|ke>>2&63))&255],ve=ve>>>8^r[(ve^(128|tt>>6&15|(ke&3)<<4))&255],ve=ve>>>8^r[(ve^(128|tt&63))&255]):(ve=ve>>>8^r[(ve^(224|ke>>12&15))&255],ve=ve>>>8^r[(ve^(128|ke>>6&63))&255],ve=ve>>>8^r[(ve^(128|ke&63))&255]);return~ve}return e.table=r,e.bstr=J,e.buf=Z,e.str=K,e}(),pn=function(){var t={};t.version="1.2.1";function r(Q,pe){for(var le=Q.split("/"),fe=pe.split("/"),Se=0,Te=0,ot=Math.min(le.length,fe.length);Se<ot;++Se){if(Te=le[Se].length-fe[Se].length)return Te;if(le[Se]!=fe[Se])return le[Se]<fe[Se]?-1:1}return le.length-fe.length}function n(Q){if(Q.charAt(Q.length-1)=="/")return Q.slice(0,-1).indexOf("/")===-1?Q:n(Q.slice(0,-1));var pe=Q.lastIndexOf("/");return pe===-1?Q:Q.slice(0,pe+1)}function o(Q){if(Q.charAt(Q.length-1)=="/")return o(Q.slice(0,-1));var pe=Q.lastIndexOf("/");return pe===-1?Q:Q.slice(pe+1)}function u(Q,pe){typeof pe=="string"&&(pe=new Date(pe));var le=pe.getHours();le=le<<6|pe.getMinutes(),le=le<<5|pe.getSeconds()>>>1,Q.write_shift(2,le);var fe=pe.getFullYear()-1980;fe=fe<<4|pe.getMonth()+1,fe=fe<<5|pe.getDate(),Q.write_shift(2,fe)}function d(Q){var pe=Q.read_shift(2)&65535,le=Q.read_shift(2)&65535,fe=new Date,Se=le&31;le>>>=5;var Te=le&15;le>>>=4,fe.setMilliseconds(0),fe.setFullYear(le+1980),fe.setMonth(Te-1),fe.setDate(Se);var ot=pe&31;pe>>>=5;var wt=pe&63;return pe>>>=6,fe.setHours(pe),fe.setMinutes(wt),fe.setSeconds(ot<<1),fe}function i(Q){ss(Q,0);for(var pe={},le=0;Q.l<=Q.length-4;){var fe=Q.read_shift(2),Se=Q.read_shift(2),Te=Q.l+Se,ot={};switch(fe){case 21589:le=Q.read_shift(1),le&1&&(ot.mtime=Q.read_shift(4)),Se>5&&(le&2&&(ot.atime=Q.read_shift(4)),le&4&&(ot.ctime=Q.read_shift(4))),ot.mtime&&(ot.mt=new Date(ot.mtime*1e3));break}Q.l=Te,pe[fe]=ot}return pe}var v;function w(){return v||(v={})}function S(Q,pe){if(Q[0]==80&&Q[1]==75)return wl(Q,pe);if((Q[0]|32)==109&&(Q[1]|32)==105)return Ha(Q,pe);if(Q.length<512)throw new Error("CFB file size "+Q.length+" < 512");var le=3,fe=512,Se=0,Te=0,ot=0,wt=0,mt=0,bt=[],xt=Q.slice(0,512);ss(xt,0);var Xt=C(xt);switch(le=Xt[0],le){case 3:fe=512;break;case 4:fe=4096;break;case 0:if(Xt[1]==0)return wl(Q,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+le)}fe!==512&&(xt=Q.slice(0,fe),ss(xt,28));var cr=Q.slice(0,fe);k(xt,le);var nr=xt.read_shift(4,"i");if(le===3&&nr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nr);xt.l+=4,ot=xt.read_shift(4,"i"),xt.l+=4,xt.chk("00100000","Mini Stream Cutoff Size: "),wt=xt.read_shift(4,"i"),Se=xt.read_shift(4,"i"),mt=xt.read_shift(4,"i"),Te=xt.read_shift(4,"i");for(var ur=-1,Ar=0;Ar<109&&(ur=xt.read_shift(4,"i"),!(ur<0));++Ar)bt[Ar]=ur;var Kr=O(Q,fe);N(mt,Te,Kr,fe,bt);var an=G(Kr,ot,bt,fe);an[ot].name="!Directory",Se>0&&wt!==tt&&(an[wt].name="!MiniFAT"),an[bt[0]].name="!FAT",an.fat_addrs=bt,an.ssz=fe;var Hr={},En=[],li=[],$n=[];U(ot,an,Kr,En,Se,Hr,li,wt),L(li,$n,En),En.shift();var ca={FileIndex:li,FullPaths:$n};return pe&&pe.raw&&(ca.raw={header:cr,sectors:Kr}),ca}function C(Q){if(Q[Q.l]==80&&Q[Q.l+1]==75)return[0,0];Q.chk(Je,"Header Signature: "),Q.l+=16;var pe=Q.read_shift(2,"u");return[Q.read_shift(2,"u"),pe]}function k(Q,pe){var le=9;switch(Q.l+=2,le=Q.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+le);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+le);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+le)}Q.chk("0600","Mini Sector Shift: "),Q.chk("000000000000","Reserved: ")}function O(Q,pe){for(var le=Math.ceil(Q.length/pe)-1,fe=[],Se=1;Se<le;++Se)fe[Se-1]=Q.slice(Se*pe,(Se+1)*pe);return fe[le-1]=Q.slice(le*pe),fe}function L(Q,pe,le){for(var fe=0,Se=0,Te=0,ot=0,wt=0,mt=le.length,bt=[],xt=[];fe<mt;++fe)bt[fe]=xt[fe]=fe,pe[fe]=le[fe];for(;wt<xt.length;++wt)fe=xt[wt],Se=Q[fe].L,Te=Q[fe].R,ot=Q[fe].C,bt[fe]===fe&&(Se!==-1&&bt[Se]!==Se&&(bt[fe]=bt[Se]),Te!==-1&&bt[Te]!==Te&&(bt[fe]=bt[Te])),ot!==-1&&(bt[ot]=fe),Se!==-1&&fe!=bt[fe]&&(bt[Se]=bt[fe],xt.lastIndexOf(Se)<wt&&xt.push(Se)),Te!==-1&&fe!=bt[fe]&&(bt[Te]=bt[fe],xt.lastIndexOf(Te)<wt&&xt.push(Te));for(fe=1;fe<mt;++fe)bt[fe]===fe&&(Te!==-1&&bt[Te]!==Te?bt[fe]=bt[Te]:Se!==-1&&bt[Se]!==Se&&(bt[fe]=bt[Se]));for(fe=1;fe<mt;++fe)if(Q[fe].type!==0){if(wt=fe,wt!=bt[wt])do wt=bt[wt],pe[fe]=pe[wt]+"/"+pe[fe];while(wt!==0&&bt[wt]!==-1&&wt!=bt[wt]);bt[fe]=-1}for(pe[0]+="/",fe=1;fe<mt;++fe)Q[fe].type!==2&&(pe[fe]+="/")}function R(Q,pe,le){for(var fe=Q.start,Se=Q.size,Te=[],ot=fe;le&&Se>0&&ot>=0;)Te.push(pe.slice(ot*ke,ot*ke+ke)),Se-=ke,ot=Um(le,ot*4);return Te.length===0?rr(0):Yo(Te).slice(0,Q.size)}function N(Q,pe,le,fe,Se){var Te=tt;if(Q===tt){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(Q!==-1){var ot=le[Q],wt=(fe>>>2)-1;if(!ot)return;for(var mt=0;mt<wt&&(Te=Um(ot,mt*4))!==tt;++mt)Se.push(Te);N(Um(ot,fe-4),pe-1,le,fe,Se)}}function V(Q,pe,le,fe,Se){var Te=[],ot=[];Se||(Se=[]);var wt=fe-1,mt=0,bt=0;for(mt=pe;mt>=0;){Se[mt]=!0,Te[Te.length]=mt,ot.push(Q[mt]);var xt=le[Math.floor(mt*4/fe)];if(bt=mt*4&wt,fe<4+bt)throw new Error("FAT boundary crossed: "+mt+" 4 "+fe);if(!Q[xt])break;mt=Um(Q[xt],bt)}return{nodes:Te,data:Wj([ot])}}function G(Q,pe,le,fe){var Se=Q.length,Te=[],ot=[],wt=[],mt=[],bt=fe-1,xt=0,Xt=0,cr=0,nr=0;for(xt=0;xt<Se;++xt)if(wt=[],cr=xt+pe,cr>=Se&&(cr-=Se),!ot[cr]){mt=[];var ur=[];for(Xt=cr;Xt>=0;){ur[Xt]=!0,ot[Xt]=!0,wt[wt.length]=Xt,mt.push(Q[Xt]);var Ar=le[Math.floor(Xt*4/fe)];if(nr=Xt*4&bt,fe<4+nr)throw new Error("FAT boundary crossed: "+Xt+" 4 "+fe);if(!Q[Ar]||(Xt=Um(Q[Ar],nr),ur[Xt]))break}Te[cr]={nodes:wt,data:Wj([mt])}}return Te}function U(Q,pe,le,fe,Se,Te,ot,wt){for(var mt=0,bt=fe.length?2:0,xt=pe[Q].data,Xt=0,cr=0,nr;Xt<xt.length;Xt+=128){var ur=xt.slice(Xt,Xt+128);ss(ur,64),cr=ur.read_shift(2),nr=wP(ur,0,cr-bt),fe.push(nr);var Ar={name:nr,type:ur.read_shift(1),color:ur.read_shift(1),L:ur.read_shift(4,"i"),R:ur.read_shift(4,"i"),C:ur.read_shift(4,"i"),clsid:ur.read_shift(16),state:ur.read_shift(4,"i"),start:0,size:0},Kr=ur.read_shift(2)+ur.read_shift(2)+ur.read_shift(2)+ur.read_shift(2);Kr!==0&&(Ar.ct=J(ur,ur.l-8));var an=ur.read_shift(2)+ur.read_shift(2)+ur.read_shift(2)+ur.read_shift(2);an!==0&&(Ar.mt=J(ur,ur.l-8)),Ar.start=ur.read_shift(4,"i"),Ar.size=ur.read_shift(4,"i"),Ar.size<0&&Ar.start<0&&(Ar.size=Ar.type=0,Ar.start=tt,Ar.name=""),Ar.type===5?(mt=Ar.start,Se>0&&mt!==tt&&(pe[mt].name="!StreamData")):Ar.size>=4096?(Ar.storage="fat",pe[Ar.start]===void 0&&(pe[Ar.start]=V(le,Ar.start,pe.fat_addrs,pe.ssz)),pe[Ar.start].name=Ar.name,Ar.content=pe[Ar.start].data.slice(0,Ar.size)):(Ar.storage="minifat",Ar.size<0?Ar.size=0:mt!==tt&&Ar.start!==tt&&pe[mt]&&(Ar.content=R(Ar,pe[mt].data,(pe[wt]||{}).data))),Ar.content&&ss(Ar.content,0),Te[nr]=Ar,ot.push(Ar)}}function J(Q,pe){return new Date((Zo(Q,pe+4)/1e7*Math.pow(2,32)+Zo(Q,pe)/1e7-11644473600)*1e3)}function Z(Q,pe){return w(),S(v.readFileSync(Q),pe)}function K(Q,pe){var le=pe&&pe.type;switch(le||oi&&Buffer.isBuffer(Q)&&(le="buffer"),le||"base64"){case"file":return Z(Q,pe);case"base64":return S($l(Yl(Q)),pe);case"binary":return S($l(Q),pe)}return S(Q,pe)}function re(Q,pe){var le=pe||{},fe=le.root||"Root Entry";if(Q.FullPaths||(Q.FullPaths=[]),Q.FileIndex||(Q.FileIndex=[]),Q.FullPaths.length!==Q.FileIndex.length)throw new Error("inconsistent CFB structure");Q.FullPaths.length===0&&(Q.FullPaths[0]=fe+"/",Q.FileIndex[0]={name:fe,type:5}),le.CLSID&&(Q.FileIndex[0].clsid=le.CLSID),ge(Q)}function ge(Q){var pe="Sh33tJ5";if(!pn.find(Q,"/"+pe)){var le=rr(4);le[0]=55,le[1]=le[3]=50,le[2]=54,Q.FileIndex.push({name:pe,type:2,content:le,size:4,L:69,R:69,C:69}),Q.FullPaths.push(Q.FullPaths[0]+pe),ve(Q)}}function ve(Q,pe){re(Q);for(var le=!1,fe=!1,Se=Q.FullPaths.length-1;Se>=0;--Se){var Te=Q.FileIndex[Se];switch(Te.type){case 0:fe?le=!0:(Q.FileIndex.pop(),Q.FullPaths.pop());break;case 1:case 2:case 5:fe=!0,isNaN(Te.R*Te.L*Te.C)&&(le=!0),Te.R>-1&&Te.L>-1&&Te.R==Te.L&&(le=!0);break;default:le=!0;break}}if(!(!le&&!pe)){var ot=new Date(1987,1,19),wt=0,mt=Object.create?Object.create(null):{},bt=[];for(Se=0;Se<Q.FullPaths.length;++Se)mt[Q.FullPaths[Se]]=!0,Q.FileIndex[Se].type!==0&&bt.push([Q.FullPaths[Se],Q.FileIndex[Se]]);for(Se=0;Se<bt.length;++Se){var xt=n(bt[Se][0]);fe=mt[xt],fe||(bt.push([xt,{name:o(xt).replace("/",""),type:1,clsid:at,ct:ot,mt:ot,content:null}]),mt[xt]=!0)}for(bt.sort(function(nr,ur){return r(nr[0],ur[0])}),Q.FullPaths=[],Q.FileIndex=[],Se=0;Se<bt.length;++Se)Q.FullPaths[Se]=bt[Se][0],Q.FileIndex[Se]=bt[Se][1];for(Se=0;Se<bt.length;++Se){var Xt=Q.FileIndex[Se],cr=Q.FullPaths[Se];if(Xt.name=o(cr).replace("/",""),Xt.L=Xt.R=Xt.C=-(Xt.color=1),Xt.size=Xt.content?Xt.content.length:0,Xt.start=0,Xt.clsid=Xt.clsid||at,Se===0)Xt.C=bt.length>1?1:-1,Xt.size=0,Xt.type=5;else if(cr.slice(-1)=="/"){for(wt=Se+1;wt<bt.length&&n(Q.FullPaths[wt])!=cr;++wt);for(Xt.C=wt>=bt.length?-1:wt,wt=Se+1;wt<bt.length&&n(Q.FullPaths[wt])!=n(cr);++wt);Xt.R=wt>=bt.length?-1:wt,Xt.type=1}else n(Q.FullPaths[Se+1]||"")==n(cr)&&(Xt.R=Se+1),Xt.type=2}}}function $e(Q,pe){var le=pe||{};if(le.fileType=="mad")return Qe(Q,le);switch(ve(Q),le.fileType){case"zip":return To(Q,le)}var fe=function(nr){for(var ur=0,Ar=0,Kr=0;Kr<nr.FileIndex.length;++Kr){var an=nr.FileIndex[Kr];if(an.content){var Hr=an.content.length;Hr>0&&(Hr<4096?ur+=Hr+63>>6:Ar+=Hr+511>>9)}}for(var En=nr.FullPaths.length+3>>2,li=ur+7>>3,$n=ur+127>>7,ca=li+Ar+En+$n,da=ca+127>>7,Eo=da<=109?0:Math.ceil((da-109)/127);ca+da+Eo+127>>7>da;)Eo=++da<=109?0:Math.ceil((da-109)/127);var no=[1,Eo,da,$n,En,Ar,ur,0];return nr.FileIndex[0].size=ur<<6,no[7]=(nr.FileIndex[0].start=no[0]+no[1]+no[2]+no[3]+no[4]+no[5])+(no[6]+7>>3),no}(Q),Se=rr(fe[7]<<9),Te=0,ot=0;{for(Te=0;Te<8;++Te)Se.write_shift(1,et[Te]);for(Te=0;Te<8;++Te)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Te=0;Te<3;++Te)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,fe[2]),Se.write_shift(4,fe[0]+fe[1]+fe[2]+fe[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,fe[3]?fe[0]+fe[1]+fe[2]-1:tt),Se.write_shift(4,fe[3]),Se.write_shift(-4,fe[1]?fe[0]-1:tt),Se.write_shift(4,fe[1]),Te=0;Te<109;++Te)Se.write_shift(-4,Te<fe[2]?fe[1]+Te:-1)}if(fe[1])for(ot=0;ot<fe[1];++ot){for(;Te<236+ot*127;++Te)Se.write_shift(-4,Te<fe[2]?fe[1]+Te:-1);Se.write_shift(-4,ot===fe[1]-1?tt:ot+1)}var wt=function(nr){for(ot+=nr;Te<ot-1;++Te)Se.write_shift(-4,Te+1);nr&&(++Te,Se.write_shift(-4,tt))};for(ot=Te=0,ot+=fe[1];Te<ot;++Te)Se.write_shift(-4,pt.DIFSECT);for(ot+=fe[2];Te<ot;++Te)Se.write_shift(-4,pt.FATSECT);wt(fe[3]),wt(fe[4]);for(var mt=0,bt=0,xt=Q.FileIndex[0];mt<Q.FileIndex.length;++mt)xt=Q.FileIndex[mt],xt.content&&(bt=xt.content.length,!(bt<4096)&&(xt.start=ot,wt(bt+511>>9)));for(wt(fe[6]+7>>3);Se.l&511;)Se.write_shift(-4,pt.ENDOFCHAIN);for(ot=Te=0,mt=0;mt<Q.FileIndex.length;++mt)xt=Q.FileIndex[mt],xt.content&&(bt=xt.content.length,!(!bt||bt>=4096)&&(xt.start=ot,wt(bt+63>>6)));for(;Se.l&511;)Se.write_shift(-4,pt.ENDOFCHAIN);for(Te=0;Te<fe[4]<<2;++Te){var Xt=Q.FullPaths[Te];if(!Xt||Xt.length===0){for(mt=0;mt<17;++mt)Se.write_shift(4,0);for(mt=0;mt<3;++mt)Se.write_shift(4,-1);for(mt=0;mt<12;++mt)Se.write_shift(4,0);continue}xt=Q.FileIndex[Te],Te===0&&(xt.start=xt.size?xt.start-1:tt);var cr=Te===0&&le.root||xt.name;if(bt=2*(cr.length+1),Se.write_shift(64,cr,"utf16le"),Se.write_shift(2,bt),Se.write_shift(1,xt.type),Se.write_shift(1,xt.color),Se.write_shift(-4,xt.L),Se.write_shift(-4,xt.R),Se.write_shift(-4,xt.C),xt.clsid)Se.write_shift(16,xt.clsid,"hex");else for(mt=0;mt<4;++mt)Se.write_shift(4,0);Se.write_shift(4,xt.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,xt.start),Se.write_shift(4,xt.size),Se.write_shift(4,0)}for(Te=1;Te<Q.FileIndex.length;++Te)if(xt=Q.FileIndex[Te],xt.size>=4096)if(Se.l=xt.start+1<<9,oi&&Buffer.isBuffer(xt.content))xt.content.copy(Se,Se.l,0,xt.size),Se.l+=xt.size+511&-512;else{for(mt=0;mt<xt.size;++mt)Se.write_shift(1,xt.content[mt]);for(;mt&511;++mt)Se.write_shift(1,0)}for(Te=1;Te<Q.FileIndex.length;++Te)if(xt=Q.FileIndex[Te],xt.size>0&&xt.size<4096)if(oi&&Buffer.isBuffer(xt.content))xt.content.copy(Se,Se.l,0,xt.size),Se.l+=xt.size+63&-64;else{for(mt=0;mt<xt.size;++mt)Se.write_shift(1,xt.content[mt]);for(;mt&63;++mt)Se.write_shift(1,0)}if(oi)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function Ie(Q,pe){var le=Q.FullPaths.map(function(mt){return mt.toUpperCase()}),fe=le.map(function(mt){var bt=mt.split("/");return bt[bt.length-(mt.slice(-1)=="/"?2:1)]}),Se=!1;pe.charCodeAt(0)===47?(Se=!0,pe=le[0].slice(0,-1)+pe):Se=pe.indexOf("/")!==-1;var Te=pe.toUpperCase(),ot=Se===!0?le.indexOf(Te):fe.indexOf(Te);if(ot!==-1)return Q.FileIndex[ot];var wt=!Te.match(iw);for(Te=Te.replace(Os,""),wt&&(Te=Te.replace(iw,"!")),ot=0;ot<le.length;++ot)if((wt?le[ot].replace(iw,"!"):le[ot]).replace(Os,"")==Te||(wt?fe[ot].replace(iw,"!"):fe[ot]).replace(Os,"")==Te)return Q.FileIndex[ot];return null}var ke=64,tt=-2,Je="d0cf11e0a1b11ae1",et=[208,207,17,224,161,177,26,225],at="00000000000000000000000000000000",pt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:tt,FREESECT:-1,HEADER_SIGNATURE:Je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:at,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ft(Q,pe,le){w();var fe=$e(Q,le);v.writeFileSync(pe,fe)}function Ue(Q){for(var pe=new Array(Q.length),le=0;le<Q.length;++le)pe[le]=String.fromCharCode(Q[le]);return pe.join("")}function It(Q,pe){var le=$e(Q,pe);switch(pe&&pe.type||"buffer"){case"file":return w(),v.writeFileSync(pe.filename,le),le;case"binary":return typeof le=="string"?le:Ue(le);case"base64":return Qw(typeof le=="string"?le:Ue(le));case"buffer":if(oi)return Buffer.isBuffer(le)?le:jf(le);case"array":return typeof le=="string"?$l(le):le}return le}var Rt;function _e(Q){try{var pe=Q.InflateRaw,le=new pe;if(le._processChunk(new Uint8Array([3,0]),le._finishFlushFlag),le.bytesRead)Rt=Q;else throw new Error("zlib does not expose bytesRead")}catch(fe){console.error("cannot use native zlib: "+(fe.message||fe))}}function Ge(Q,pe){if(!Rt)return ti(Q,pe);var le=Rt.InflateRaw,fe=new le,Se=fe._processChunk(Q.slice(Q.l),fe._finishFlushFlag);return Q.l+=fe.bytesRead,Se}function qe(Q){return Rt?Rt.deflateRawSync(Q):_n(Q)}var Xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],yt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Dt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Yt(Q){var pe=(Q<<1|Q<<11)&139536|(Q<<5|Q<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var St=typeof Uint8Array<"u",Mt=St?new Uint8Array(256):[],Sr=0;Sr<256;++Sr)Mt[Sr]=Yt(Sr);function Ne(Q,pe){var le=Mt[Q&255];return pe<=8?le>>>8-pe:(le=le<<8|Mt[Q>>8&255],pe<=16?le>>>16-pe:(le=le<<8|Mt[Q>>16&255],le>>>24-pe))}function un(Q,pe){var le=pe&7,fe=pe>>>3;return(Q[fe]|(le<=6?0:Q[fe+1]<<8))>>>le&3}function kr(Q,pe){var le=pe&7,fe=pe>>>3;return(Q[fe]|(le<=5?0:Q[fe+1]<<8))>>>le&7}function Br(Q,pe){var le=pe&7,fe=pe>>>3;return(Q[fe]|(le<=4?0:Q[fe+1]<<8))>>>le&15}function Yr(Q,pe){var le=pe&7,fe=pe>>>3;return(Q[fe]|(le<=3?0:Q[fe+1]<<8))>>>le&31}function Tr(Q,pe){var le=pe&7,fe=pe>>>3;return(Q[fe]|(le<=1?0:Q[fe+1]<<8))>>>le&127}function jn(Q,pe,le){var fe=pe&7,Se=pe>>>3,Te=(1<<le)-1,ot=Q[Se]>>>fe;return le<8-fe||(ot|=Q[Se+1]<<8-fe,le<16-fe)||(ot|=Q[Se+2]<<16-fe,le<24-fe)||(ot|=Q[Se+3]<<24-fe),ot&Te}function Un(Q,pe,le){var fe=pe&7,Se=pe>>>3;return fe<=5?Q[Se]|=(le&7)<<fe:(Q[Se]|=le<<fe&255,Q[Se+1]=(le&7)>>8-fe),pe+3}function Wi(Q,pe,le){var fe=pe&7,Se=pe>>>3;return le=(le&1)<<fe,Q[Se]|=le,pe+1}function Yn(Q,pe,le){var fe=pe&7,Se=pe>>>3;return le<<=fe,Q[Se]|=le&255,le>>>=8,Q[Se+1]=le,pe+8}function ta(Q,pe,le){var fe=pe&7,Se=pe>>>3;return le<<=fe,Q[Se]|=le&255,le>>>=8,Q[Se+1]=le&255,Q[Se+2]=le>>>8,pe+16}function Di(Q,pe){var le=Q.length,fe=2*le>pe?2*le:pe+5,Se=0;if(le>=pe)return Q;if(oi){var Te=Ej(fe);if(Q.copy)Q.copy(Te);else for(;Se<Q.length;++Se)Te[Se]=Q[Se];return Te}else if(St){var ot=new Uint8Array(fe);if(ot.set)ot.set(Q);else for(;Se<le;++Se)ot[Se]=Q[Se];return ot}return Q.length=fe,Q}function ra(Q){for(var pe=new Array(Q),le=0;le<Q;++le)pe[le]=0;return pe}function Ra(Q,pe,le){var fe=1,Se=0,Te=0,ot=0,wt=0,mt=Q.length,bt=St?new Uint16Array(32):ra(32);for(Te=0;Te<32;++Te)bt[Te]=0;for(Te=mt;Te<le;++Te)Q[Te]=0;mt=Q.length;var xt=St?new Uint16Array(mt):ra(mt);for(Te=0;Te<mt;++Te)bt[Se=Q[Te]]++,fe<Se&&(fe=Se),xt[Te]=0;for(bt[0]=0,Te=1;Te<=fe;++Te)bt[Te+16]=wt=wt+bt[Te-1]<<1;for(Te=0;Te<mt;++Te)wt=Q[Te],wt!=0&&(xt[Te]=bt[wt+16]++);var Xt=0;for(Te=0;Te<mt;++Te)if(Xt=Q[Te],Xt!=0)for(wt=Ne(xt[Te],fe)>>fe-Xt,ot=(1<<fe+4-Xt)-1;ot>=0;--ot)pe[wt|ot<<Xt]=Xt&15|Te<<4;return fe}var ei=St?new Uint16Array(512):ra(512),na=St?new Uint16Array(32):ra(32);if(!St){for(var wa=0;wa<512;++wa)ei[wa]=0;for(wa=0;wa<32;++wa)na[wa]=0}(function(){for(var Q=[],pe=0;pe<32;pe++)Q.push(5);Ra(Q,na,32);var le=[];for(pe=0;pe<=143;pe++)le.push(8);for(;pe<=255;pe++)le.push(9);for(;pe<=279;pe++)le.push(7);for(;pe<=287;pe++)le.push(8);Ra(le,ei,288)})();var Da=function(){for(var pe=St?new Uint8Array(32768):[],le=0,fe=0;le<Dt.length-1;++le)for(;fe<Dt[le+1];++fe)pe[fe]=le;for(;fe<32768;++fe)pe[fe]=29;var Se=St?new Uint8Array(259):[];for(le=0,fe=0;le<yt.length-1;++le)for(;fe<yt[le+1];++fe)Se[fe]=le;function Te(wt,mt){for(var bt=0;bt<wt.length;){var xt=Math.min(65535,wt.length-bt),Xt=bt+xt==wt.length;for(mt.write_shift(1,+Xt),mt.write_shift(2,xt),mt.write_shift(2,~xt&65535);xt-- >0;)mt[mt.l++]=wt[bt++]}return mt.l}function ot(wt,mt){for(var bt=0,xt=0,Xt=St?new Uint16Array(32768):[];xt<wt.length;){var cr=Math.min(65535,wt.length-xt);if(cr<10){for(bt=Un(mt,bt,+(xt+cr==wt.length)),bt&7&&(bt+=8-(bt&7)),mt.l=bt/8|0,mt.write_shift(2,cr),mt.write_shift(2,~cr&65535);cr-- >0;)mt[mt.l++]=wt[xt++];bt=mt.l*8;continue}bt=Un(mt,bt,+(xt+cr==wt.length)+2);for(var nr=0;cr-- >0;){var ur=wt[xt];nr=(nr<<5^ur)&32767;var Ar=-1,Kr=0;if((Ar=Xt[nr])&&(Ar|=xt&-32768,Ar>xt&&(Ar-=32768),Ar<xt))for(;wt[Ar+Kr]==wt[xt+Kr]&&Kr<250;)++Kr;if(Kr>2){ur=Se[Kr],ur<=22?bt=Yn(mt,bt,Mt[ur+1]>>1)-1:(Yn(mt,bt,3),bt+=5,Yn(mt,bt,Mt[ur-23]>>5),bt+=3);var an=ur<8?0:ur-4>>2;an>0&&(ta(mt,bt,Kr-yt[ur]),bt+=an),ur=pe[xt-Ar],bt=Yn(mt,bt,Mt[ur]>>3),bt-=3;var Hr=ur<4?0:ur-2>>1;Hr>0&&(ta(mt,bt,xt-Ar-Dt[ur]),bt+=Hr);for(var En=0;En<Kr;++En)Xt[nr]=xt&32767,nr=(nr<<5^wt[xt])&32767,++xt;cr-=Kr-1}else ur<=143?ur=ur+48:bt=Wi(mt,bt,1),bt=Yn(mt,bt,Mt[ur]),Xt[nr]=xt&32767,++xt}bt=Yn(mt,bt,0)-1}return mt.l=(bt+7)/8|0,mt.l}return function(mt,bt){return mt.length<8?Te(mt,bt):ot(mt,bt)}}();function _n(Q){var pe=rr(50+Math.floor(Q.length*1.1)),le=Da(Q,pe);return pe.slice(0,le)}var Nn=St?new Uint16Array(32768):ra(32768),Gi=St?new Uint16Array(32768):ra(32768),ji=St?new Uint16Array(128):ra(128),ba=1,Bo=1;function uo(Q,pe){var le=Yr(Q,pe)+257;pe+=5;var fe=Yr(Q,pe)+1;pe+=5;var Se=Br(Q,pe)+4;pe+=4;for(var Te=0,ot=St?new Uint8Array(19):ra(19),wt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],mt=1,bt=St?new Uint8Array(8):ra(8),xt=St?new Uint8Array(8):ra(8),Xt=ot.length,cr=0;cr<Se;++cr)ot[Xe[cr]]=Te=kr(Q,pe),mt<Te&&(mt=Te),bt[Te]++,pe+=3;var nr=0;for(bt[0]=0,cr=1;cr<=mt;++cr)xt[cr]=nr=nr+bt[cr-1]<<1;for(cr=0;cr<Xt;++cr)(nr=ot[cr])!=0&&(wt[cr]=xt[nr]++);var ur=0;for(cr=0;cr<Xt;++cr)if(ur=ot[cr],ur!=0){nr=Mt[wt[cr]]>>8-ur;for(var Ar=(1<<7-ur)-1;Ar>=0;--Ar)ji[nr|Ar<<ur]=ur&7|cr<<3}var Kr=[];for(mt=1;Kr.length<le+fe;)switch(nr=ji[Tr(Q,pe)],pe+=nr&7,nr>>>=3){case 16:for(Te=3+un(Q,pe),pe+=2,nr=Kr[Kr.length-1];Te-- >0;)Kr.push(nr);break;case 17:for(Te=3+kr(Q,pe),pe+=3;Te-- >0;)Kr.push(0);break;case 18:for(Te=11+Tr(Q,pe),pe+=7;Te-- >0;)Kr.push(0);break;default:Kr.push(nr),mt<nr&&(mt=nr);break}var an=Kr.slice(0,le),Hr=Kr.slice(le);for(cr=le;cr<286;++cr)an[cr]=0;for(cr=fe;cr<30;++cr)Hr[cr]=0;return ba=Ra(an,Nn,286),Bo=Ra(Hr,Gi,30),pe}function xl(Q,pe){if(Q[0]==3&&!(Q[1]&3))return[Ap(pe),2];for(var le=0,fe=0,Se=Ej(pe||1<<18),Te=0,ot=Se.length>>>0,wt=0,mt=0;!(fe&1);){if(fe=kr(Q,le),le+=3,fe>>>1)fe>>1==1?(wt=9,mt=5):(le=uo(Q,le),wt=ba,mt=Bo);else{le&7&&(le+=8-(le&7));var bt=Q[le>>>3]|Q[(le>>>3)+1]<<8;if(le+=32,bt>0)for(!pe&&ot<Te+bt&&(Se=Di(Se,Te+bt),ot=Se.length);bt-- >0;)Se[Te++]=Q[le>>>3],le+=8;continue}for(;;){!pe&&ot<Te+32767&&(Se=Di(Se,Te+32767),ot=Se.length);var xt=jn(Q,le,wt),Xt=fe>>>1==1?ei[xt]:Nn[xt];if(le+=Xt&15,Xt>>>=4,!(Xt>>>8&255))Se[Te++]=Xt;else{if(Xt==256)break;Xt-=257;var cr=Xt<8?0:Xt-4>>2;cr>5&&(cr=0);var nr=Te+yt[Xt];cr>0&&(nr+=jn(Q,le,cr),le+=cr),xt=jn(Q,le,mt),Xt=fe>>>1==1?na[xt]:Gi[xt],le+=Xt&15,Xt>>>=4;var ur=Xt<4?0:Xt-2>>1,Ar=Dt[Xt];for(ur>0&&(Ar+=jn(Q,le,ur),le+=ur),!pe&&ot<nr&&(Se=Di(Se,nr+100),ot=Se.length);Te<nr;)Se[Te]=Se[Te-Ar],++Te}}}return pe?[Se,le+7>>>3]:[Se.slice(0,Te),le+7>>>3]}function ti(Q,pe){var le=Q.slice(Q.l||0),fe=xl(le,pe);return Q.l+=fe[1],fe[0]}function ia(Q,pe){if(Q)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function wl(Q,pe){var le=Q;ss(le,0);var fe=[],Se=[],Te={FileIndex:fe,FullPaths:Se};re(Te,{root:pe.root});for(var ot=le.length-4;(le[ot]!=80||le[ot+1]!=75||le[ot+2]!=5||le[ot+3]!=6)&&ot>=0;)--ot;le.l=ot+4,le.l+=4;var wt=le.read_shift(2);le.l+=6;var mt=le.read_shift(4);for(le.l=mt,ot=0;ot<wt;++ot){le.l+=20;var bt=le.read_shift(4),xt=le.read_shift(4),Xt=le.read_shift(2),cr=le.read_shift(2),nr=le.read_shift(2);le.l+=8;var ur=le.read_shift(4),Ar=i(le.slice(le.l+Xt,le.l+Xt+cr));le.l+=Xt+cr+nr;var Kr=le.l;le.l=ur+4,bl(le,bt,xt,Te,Ar),le.l=Kr}return Te}function bl(Q,pe,le,fe,Se){Q.l+=2;var Te=Q.read_shift(2),ot=Q.read_shift(2),wt=d(Q);if(Te&8257)throw new Error("Unsupported ZIP encryption");for(var mt=Q.read_shift(4),bt=Q.read_shift(4),xt=Q.read_shift(4),Xt=Q.read_shift(2),cr=Q.read_shift(2),nr="",ur=0;ur<Xt;++ur)nr+=String.fromCharCode(Q[Q.l++]);if(cr){var Ar=i(Q.slice(Q.l,Q.l+cr));(Ar[21589]||{}).mt&&(wt=Ar[21589].mt),((Se||{})[21589]||{}).mt&&(wt=Se[21589].mt)}Q.l+=cr;var Kr=Q.slice(Q.l,Q.l+bt);switch(ot){case 8:Kr=Ge(Q,xt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ot)}var an=!1;Te&8&&(mt=Q.read_shift(4),mt==134695760&&(mt=Q.read_shift(4),an=!0),bt=Q.read_shift(4),xt=Q.read_shift(4)),bt!=pe&&ia(an,"Bad compressed size: "+pe+" != "+bt),xt!=le&&ia(an,"Bad uncompressed size: "+le+" != "+xt),he(fe,nr,Kr,{unsafe:!0,mt:wt})}function To(Q,pe){var le=pe||{},fe=[],Se=[],Te=rr(1),ot=le.compression?8:0,wt=0,mt=0,bt=0,xt=0,Xt=0,cr=Q.FullPaths[0],nr=cr,ur=Q.FileIndex[0],Ar=[],Kr=0;for(mt=1;mt<Q.FullPaths.length;++mt)if(nr=Q.FullPaths[mt].slice(cr.length),ur=Q.FileIndex[mt],!(!ur.size||!ur.content||nr=="Sh33tJ5")){var an=xt,Hr=rr(nr.length);for(bt=0;bt<nr.length;++bt)Hr.write_shift(1,nr.charCodeAt(bt)&127);Hr=Hr.slice(0,Hr.l),Ar[Xt]=wme.buf(ur.content,0);var En=ur.content;ot==8&&(En=qe(En)),Te=rr(30),Te.write_shift(4,67324752),Te.write_shift(2,20),Te.write_shift(2,wt),Te.write_shift(2,ot),ur.mt?u(Te,ur.mt):Te.write_shift(4,0),Te.write_shift(-4,Ar[Xt]),Te.write_shift(4,En.length),Te.write_shift(4,ur.content.length),Te.write_shift(2,Hr.length),Te.write_shift(2,0),xt+=Te.length,fe.push(Te),xt+=Hr.length,fe.push(Hr),xt+=En.length,fe.push(En),Te=rr(46),Te.write_shift(4,33639248),Te.write_shift(2,0),Te.write_shift(2,20),Te.write_shift(2,wt),Te.write_shift(2,ot),Te.write_shift(4,0),Te.write_shift(-4,Ar[Xt]),Te.write_shift(4,En.length),Te.write_shift(4,ur.content.length),Te.write_shift(2,Hr.length),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(4,0),Te.write_shift(4,an),Kr+=Te.l,Se.push(Te),Kr+=Hr.length,Se.push(Hr),++Xt}return Te=rr(22),Te.write_shift(4,101010256),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,Xt),Te.write_shift(2,Xt),Te.write_shift(4,Kr),Te.write_shift(4,xt),Te.write_shift(2,0),Yo([Yo(fe),Yo(Se),Te])}var ro={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jc(Q,pe){if(Q.ctype)return Q.ctype;var le=Q.name||"",fe=le.match(/\.([^\.]+)$/);return fe&&ro[fe[1]]||pe&&(fe=(le=pe).match(/[\.\\]([^\.\\])+$/),fe&&ro[fe[1]])?ro[fe[1]]:"application/octet-stream"}function yn(Q){for(var pe=Qw(Q),le=[],fe=0;fe<pe.length;fe+=76)le.push(pe.slice(fe,fe+76));return le.join(`\r
`)+`\r
`}function Pt(Q){var pe=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(bt){var xt=bt.charCodeAt(0).toString(16).toUpperCase();return"="+(xt.length==1?"0"+xt:xt)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var le=[],fe=pe.split(`\r
`),Se=0;Se<fe.length;++Se){var Te=fe[Se];if(Te.length==0){le.push("");continue}for(var ot=0;ot<Te.length;){var wt=76,mt=Te.slice(ot,ot+wt);mt.charAt(wt-1)=="="?wt--:mt.charAt(wt-2)=="="?wt-=2:mt.charAt(wt-3)=="="&&(wt-=3),mt=Te.slice(ot,ot+wt),ot+=wt,ot<Te.length&&(mt+="="),le.push(mt)}}return le.join(`\r
`)}function si(Q){for(var pe=[],le=0;le<Q.length;++le){for(var fe=Q[le];le<=Q.length&&fe.charAt(fe.length-1)=="=";)fe=fe.slice(0,fe.length-1)+Q[++le];pe.push(fe)}for(var Se=0;Se<pe.length;++Se)pe[Se]=pe[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(Te){return String.fromCharCode(parseInt(Te.slice(1),16))});return $l(pe.join(`\r
`))}function So(Q,pe,le){for(var fe="",Se="",Te="",ot,wt=0;wt<10;++wt){var mt=pe[wt];if(!mt||mt.match(/^\s*$/))break;var bt=mt.match(/^(.*?):\s*([^\s].*)$/);if(bt)switch(bt[1].toLowerCase()){case"content-location":fe=bt[2].trim();break;case"content-type":Te=bt[2].trim();break;case"content-transfer-encoding":Se=bt[2].trim();break}}switch(++wt,Se.toLowerCase()){case"base64":ot=$l(Yl(pe.slice(wt).join("")));break;case"quoted-printable":ot=si(pe.slice(wt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var xt=he(Q,fe.slice(le.length),ot,{unsafe:!0});Te&&(xt.ctype=Te)}function Ha(Q,pe){if(Ue(Q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var le=pe&&pe.root||"",fe=(oi&&Buffer.isBuffer(Q)?Q.toString("binary"):Ue(Q)).split(`\r
`),Se=0,Te="";for(Se=0;Se<fe.length;++Se)if(Te=fe[Se],!!/^Content-Location:/i.test(Te)&&(Te=Te.slice(Te.indexOf("file")),le||(le=Te.slice(0,Te.lastIndexOf("/")+1)),Te.slice(0,le.length)!=le))for(;le.length>0&&(le=le.slice(0,le.length-1),le=le.slice(0,le.lastIndexOf("/")+1),Te.slice(0,le.length)!=le););var ot=(fe[1]||"").match(/boundary="(.*?)"/);if(!ot)throw new Error("MAD cannot find boundary");var wt="--"+(ot[1]||""),mt=[],bt=[],xt={FileIndex:mt,FullPaths:bt};re(xt);var Xt,cr=0;for(Se=0;Se<fe.length;++Se){var nr=fe[Se];nr!==wt&&nr!==wt+"--"||(cr++&&So(xt,fe.slice(Xt,Se),le),Xt=Se)}return xt}function Qe(Q,pe){var le=pe||{},fe=le.boundary||"SheetJS";fe="------="+fe;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+fe.slice(2)+'"',"","",""],Te=Q.FullPaths[0],ot=Te,wt=Q.FileIndex[0],mt=1;mt<Q.FullPaths.length;++mt)if(ot=Q.FullPaths[mt].slice(Te.length),wt=Q.FileIndex[mt],!(!wt.size||!wt.content||ot=="Sh33tJ5")){ot=ot.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Kr){return"_x"+Kr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Kr){return"_u"+Kr.charCodeAt(0).toString(16)+"_"});for(var bt=wt.content,xt=oi&&Buffer.isBuffer(bt)?bt.toString("binary"):Ue(bt),Xt=0,cr=Math.min(1024,xt.length),nr=0,ur=0;ur<=cr;++ur)(nr=xt.charCodeAt(ur))>=32&&nr<128&&++Xt;var Ar=Xt>=cr*4/5;Se.push(fe),Se.push("Content-Location: "+(le.root||"file:///C:/SheetJS/")+ot),Se.push("Content-Transfer-Encoding: "+(Ar?"quoted-printable":"base64")),Se.push("Content-Type: "+jc(wt,ot)),Se.push(""),Se.push(Ar?Pt(xt):yn(xt))}return Se.push(fe+`--\r
`),Se.join(`\r
`)}function se(Q){var pe={};return re(pe,Q),pe}function he(Q,pe,le,fe){var Se=fe&&fe.unsafe;Se||re(Q);var Te=!Se&&pn.find(Q,pe);if(!Te){var ot=Q.FullPaths[0];pe.slice(0,ot.length)==ot?ot=pe:(ot.slice(-1)!="/"&&(ot+="/"),ot=(ot+pe).replace("//","/")),Te={name:o(pe),type:2},Q.FileIndex.push(Te),Q.FullPaths.push(ot),Se||pn.utils.cfb_gc(Q)}return Te.content=le,Te.size=le?le.length:0,fe&&(fe.CLSID&&(Te.clsid=fe.CLSID),fe.mt&&(Te.mt=fe.mt),fe.ct&&(Te.ct=fe.ct)),Te}function Pe(Q,pe){re(Q);var le=pn.find(Q,pe);if(le){for(var fe=0;fe<Q.FileIndex.length;++fe)if(Q.FileIndex[fe]==le)return Q.FileIndex.splice(fe,1),Q.FullPaths.splice(fe,1),!0}return!1}function We(Q,pe,le){re(Q);var fe=pn.find(Q,pe);if(fe){for(var Se=0;Se<Q.FileIndex.length;++Se)if(Q.FileIndex[Se]==fe)return Q.FileIndex[Se].name=o(le),Q.FullPaths[Se]=le,!0}return!1}function je(Q){ve(Q,!0)}return t.find=Ie,t.read=K,t.parse=S,t.write=It,t.writeFile=ft,t.utils={cfb_new:se,cfb_add:he,cfb_del:Pe,cfb_mov:We,cfb_gc:je,ReadShift:yw,CheckField:PZ,prep_blob:ss,bconcat:Yo,use_zlib:_e,_deflateRaw:_n,_inflateRaw:ti,consts:pt},t}();let op;function bme(e){op=e}function Tme(e){return typeof e=="string"?u2(e):Array.isArray(e)?Xpe(e):e}function f2(e,t,r){if(typeof op<"u"&&op.writeFileSync)return r?op.writeFileSync(e,t,r):op.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=u2(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?gh(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var o=new Blob([Tme(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var u=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),chrome.downloads.download({url:u,filename:e,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=e,d.href=u,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),u}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var i=File(e);return i.open("w"),i.encoding="binary",Array.isArray(t)&&(t=Fp(t)),i.write(t),i.close(),t}catch(v){if(!v.message||!v.message.match(/onstruct/))throw v}throw new Error("cannot save file "+e)}function Sme(e){if(typeof op<"u")return op.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function to(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Rj(e,t){for(var r=[],n=to(e),o=0;o!==n.length;++o)r[e[n[o]][t]]==null&&(r[e[n[o]][t]]=n[o]);return r}function yP(e){for(var t=[],r=to(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function vP(e){for(var t=[],r=to(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Eme(e){for(var t=[],r=to(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var TA=new Date(1899,11,30,0,0,0);function Lo(e,t){var r=e.getTime(),n=TA.getTime()+(e.getTimezoneOffset()-TA.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var hZ=new Date,Ame=TA.getTime()+(hZ.getTimezoneOffset()-TA.getTimezoneOffset())*6e4,Dj=hZ.getTimezoneOffset();function xP(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Ame),t.getTimezoneOffset()!==Dj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Dj)*6e4),t}function Cme(e){var t=0,r=0,n=!1,o=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!o)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var u=1;u!=o.length;++u)if(o[u]){switch(r=1,u>3&&(n=!0),o[u].slice(o[u].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+o[u].slice(o[u].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(o[u],10)}return t}var Fj=new Date("2017-02-19T19:06:09.000Z"),fZ=isNaN(Fj.getFullYear())?new Date("2/19/17"):Fj,Pme=fZ.getFullYear()==2017;function Ma(e,t){var r=new Date(e);if(Pme)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(fZ.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(u=new Date(u.getTime()-u.getTimezoneOffset()*60*1e3)),u}function b0(e,t){if(oi&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return gh(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return gh(JX(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return gh(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return gh(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(u){return r[u]||u})}catch{}for(var n=[],o=0;o!=e.length;++o)n.push(String.fromCharCode(e[o]));return n.join("")}function fa(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=fa(e[r]));return t}function Ka(e,t){for(var r="";r.length<t;)r+=e;return r}function wu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(o,u){return r=-r,u}),!isNaN(t=Number(n)))?t/r:t}var Ime=["january","february","march","april","may","june","july","august","september","october","november","december"];function zy(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),o=t.getMonth(),u=t.getDate();if(isNaN(u))return r;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&Ime.indexOf(d)==-1)return r}else if(d.match(/[a-z]/))return r;return n<0||n>8099?r:(o>0||u>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var kme=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,o){if(e||typeof n=="string")return r.split(n);for(var u=r.split(n),d=[u[0]],i=1;i<u.length;++i)d.push(o),d.push(u[i]);return d}}();function dZ(e){return e?e.content&&e.type?b0(e.content,!0):e.data?K_(e.data):e.asNodeBuffer&&oi?K_(e.asNodeBuffer().toString("binary")):e.asBinary?K_(e.asBinary()):e._data&&e._data.getContent?K_(b0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function pZ(e){if(!e)return null;if(e.data)return vA(e.data);if(e.asNodeBuffer&&oi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?vA(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Ome(e){return e&&e.name.slice(-4)===".bin"?pZ(e):dZ(e)}function vc(e,t){for(var r=e.FullPaths||to(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),o=n.replace(/\\/g,"/"),u=0;u<r.length;++u){var d=r[u].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==d||o==d)return e.files?e.files[r[u]]:e.FileIndex[u]}return null}function S4(e,t){var r=vc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _o(e,t,r){if(!r)return Ome(S4(e,t));if(!t)return null;try{return _o(e,t)}catch{return null}}function Vl(e,t,r){if(!r)return dZ(S4(e,t));if(!t)return null;try{return Vl(e,t)}catch{return null}}function Mme(e,t,r){return pZ(S4(e,t))}function Lj(e){for(var t=e.FullPaths||to(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Zn(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return oi?n=jf(r):n=Zpe(r),pn.utils.cfb_add(e,t,n)}pn.utils.cfb_add(e,t,r)}else e.file(t,r)}function E4(){return pn.utils.cfb_new()}function mZ(e,t){switch(t.type){case"base64":return pn.read(e,{type:"base64"});case"binary":return pn.read(e,{type:"binary"});case"buffer":case"array":return pn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function aw(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var o=n.shift();o===".."?r.pop():o!=="."&&r.push(o)}return r.join("/")}var co=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Rme=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Nj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Dme=/<[^>]*>/g,Fs=co.match(Nj)?Nj:Dme,Fme=/<\w*:/,Lme=/<(\/?)\w+:/;function kn(e,t,r){for(var n={},o=0,u=0;o!==e.length&&!((u=e.charCodeAt(o))===32||u===10||u===13);++o);if(t||(n[0]=e.slice(0,o)),o===e.length)return n;var d=e.match(Rme),i=0,v="",w=0,S="",C="",k=1;if(d)for(w=0;w!=d.length;++w){for(C=d[w],u=0;u!=C.length&&C.charCodeAt(u)!==61;++u);for(S=C.slice(0,u).trim();C.charCodeAt(u+1)==32;)++u;for(k=(o=C.charCodeAt(u+1))==34||o==39?1:0,v=C.slice(u+1+k,C.length-k),i=0;i!=S.length&&S.charCodeAt(i)!==58;++i);if(i===S.length)S.indexOf("_")>0&&(S=S.slice(0,S.indexOf("_"))),n[S]=v,n[S.toLowerCase()]=v;else{var O=(i===5&&S.slice(0,5)==="xmlns"?"xmlns":"")+S.slice(i+1);if(n[O]&&S.slice(i-3,i)=="ext")continue;n[O]=v,n[O.toLowerCase()]=v}}return n}function Oh(e){return e.replace(Lme,"<$1")}var gZ={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},A4=yP(gZ),Ri=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var o=n+"",u=o.indexOf("<![CDATA[");if(u==-1)return o.replace(e,function(i,v){return gZ[i]||String.fromCharCode(parseInt(v,i.indexOf("x")>-1?16:10))||i}).replace(t,function(i,v){return String.fromCharCode(parseInt(v,16))});var d=o.indexOf("]]>");return r(o.slice(0,u))+o.slice(u+9,d)+r(o.slice(d+3))}}(),C4=/[&<>'"]/g,Nme=/[\u0000-\u0008\u000b-\u001f]/g;function Ki(e){var t=e+"";return t.replace(C4,function(r){return A4[r]}).replace(Nme,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bj(e){return Ki(e).replace(/ /g,"_x0020_")}var _Z=/[\u0000-\u001f]/g;function P4(e){var t=e+"";return t.replace(C4,function(r){return A4[r]}).replace(/\n/g,"<br/>").replace(_Z,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Bme(e){var t=e+"";return t.replace(C4,function(r){return A4[r]}).replace(_Z,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var zj=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function zme(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ia(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cM(e){for(var t="",r=0,n=0,o=0,u=0,d=0,i=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(o=e.charCodeAt(r++),n>191&&n<224){d=(n&31)<<6,d|=o&63,t+=String.fromCharCode(d);continue}if(u=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(o&63)<<6|u&63);continue}d=e.charCodeAt(r++),i=((n&7)<<18|(o&63)<<12|(u&63)<<6|d&63)-65536,t+=String.fromCharCode(55296+(i>>>10&1023)),t+=String.fromCharCode(56320+(i&1023))}return t}function jj(e){var t=Ap(2*e.length),r,n,o=1,u=0,d=0,i;for(n=0;n<e.length;n+=o)o=1,(i=e.charCodeAt(n))<128?r=i:i<224?(r=(i&31)*64+(e.charCodeAt(n+1)&63),o=2):i<240?(r=(i&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),o=3):(o=4,r=(i&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,d=55296+(r>>>10&1023),r=56320+(r&1023)),d!==0&&(t[u++]=d&255,t[u++]=d>>>8,d=0),t[u++]=r%256,t[u++]=r>>>8;return t.slice(0,u).toString("ucs2")}function Uj(e){return jf(e,"binary").toString("utf8")}var YS="foo bar baz",la=oi&&(Uj(YS)==cM(YS)&&Uj||jj(YS)==cM(YS)&&jj)||cM,gh=oi?function(e){return jf(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,o=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,o=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(o>>18&7))),t.push(String.fromCharCode(144+(o>>12&63))),t.push(String.fromCharCode(128+(o>>6&63))),t.push(String.fromCharCode(128+(o&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tb=function(){var e={};return function(r,n){var o=r+"|"+(n||"");return e[o]?e[o]:e[o]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),yZ=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)n=n.replace(e[o][0],e[o][1]);return n}}(),jme=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Ume=/<\/?(?:vt:)?variant>/g,$me=/<(?:vt:)([^>]*)>([\s\S]*)</;function $j(e,t){var r=kn(e),n=e.match(jme(r.baseType))||[],o=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return o}return n.forEach(function(u){var d=u.replace(Ume,"").match($me);d&&o.push({v:la(d[2]),t:d[1]})}),o}var vZ=/(^\s|\s$|\n)/;function ls(e,t){return"<"+e+(t.match(vZ)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function rb(e){return to(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Fr(e,t,r){return"<"+e+(r!=null?rb(r):"")+(t!=null?(t.match(vZ)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function h3(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Vme(e,t){switch(typeof e){case"string":var r=Fr("vt:lpwstr",Ki(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Fr((e|0)==e?"vt:i4":"vt:r8",Ki(String(e)));case"boolean":return Fr("vt:bool",e?"true":"false")}if(e instanceof Date)return Fr("vt:filetime",h3(e));throw new Error("Unable to serialize "+e)}function I4(e){if(oi&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return la(Fp(w4(e)));throw new Error("Bad input format: expected Buffer or string")}var nb=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ro={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},L0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ul={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Wme(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),o=e[t+6]&15,u=5;u>=0;--u)o=o*256+e[t+u];return n==2047?o==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,o+=Math.pow(2,52)),r*Math.pow(2,n-52)*o)}function Gme(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,o=0,u=0,d=n?-t:t;isFinite(d)?d==0?o=u=0:(o=Math.floor(Math.log(d)/Math.LN2),u=d*Math.pow(2,52-o),o<=-1023&&(!isFinite(u)||u<Math.pow(2,52))?o=-1022:(u-=Math.pow(2,52),o+=1023)):(o=2047,u=isNaN(t)?26985:0);for(var i=0;i<=5;++i,u/=256)e[r+i]=u&255;e[r+6]=(o&15)<<4|u&15,e[r+7]=o>>4|n}var Vj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var o=0,u=e[0][n].length;o<u;o+=r)t.push.apply(t,e[0][n].slice(o,o+r));return t},Wj=oi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:jf(t)})):Vj(e)}:Vj,Gj=function(e,t,r){for(var n=[],o=t;o<r;o+=2)n.push(String.fromCharCode(yf(e,o)));return n.join("").replace(Os,"")},wP=oi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Os,""):Gj(e,t,r)}:Gj,Hj=function(e,t,r){for(var n=[],o=t;o<t+r;++o)n.push(("0"+e[o].toString(16)).slice(-2));return n.join("")},xZ=oi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Hj(e,t,r)}:Hj,qj=function(e,t,r){for(var n=[],o=t;o<r;o++)n.push(String.fromCharCode(B_(e,o)));return n.join("")},yv=oi?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):qj(t,r,n)}:qj,wZ=function(e,t){var r=Zo(e,t);return r>0?yv(e,t+4,t+4+r-1):""},k4=wZ,bZ=function(e,t){var r=Zo(e,t);return r>0?yv(e,t+4,t+4+r-1):""},O4=bZ,TZ=function(e,t){var r=2*Zo(e,t);return r>0?yv(e,t+4,t+4+r-1):""},M4=TZ,SZ=function(t,r){var n=Zo(t,r);return n>0?wP(t,r+4,r+4+n):""},R4=SZ,EZ=function(e,t){var r=Zo(e,t);return r>0?yv(e,t+4,t+4+r):""},D4=EZ,AZ=function(e,t){return Wme(e,t)},SA=AZ,F4=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};oi&&(k4=function(t,r){if(!Buffer.isBuffer(t))return wZ(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},O4=function(t,r){if(!Buffer.isBuffer(t))return bZ(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},M4=function(t,r){if(!Buffer.isBuffer(t))return TZ(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},R4=function(t,r){if(!Buffer.isBuffer(t))return SZ(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},D4=function(t,r){if(!Buffer.isBuffer(t))return EZ(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},SA=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):AZ(t,r)},F4=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function CZ(){wP=function(e,t,r){return Pi.utils.decode(1200,e.slice(t,r)).replace(Os,"")},yv=function(e,t,r){return Pi.utils.decode(65001,e.slice(t,r))},k4=function(e,t){var r=Zo(e,t);return r>0?Pi.utils.decode(x0,e.slice(t+4,t+4+r-1)):""},O4=function(e,t){var r=Zo(e,t);return r>0?Pi.utils.decode(Xl,e.slice(t+4,t+4+r-1)):""},M4=function(e,t){var r=2*Zo(e,t);return r>0?Pi.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},R4=function(e,t){var r=Zo(e,t);return r>0?Pi.utils.decode(1200,e.slice(t+4,t+4+r)):""},D4=function(e,t){var r=Zo(e,t);return r>0?Pi.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Pi<"u"&&CZ();var B_=function(e,t){return e[t]},yf=function(e,t){return e[t+1]*256+e[t]},Hme=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Um=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qme=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function yw(e,t){var r="",n,o,u=[],d,i,v,w;switch(t){case"dbcs":if(w=this.l,oi&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(v=0;v<e;++v)r+=String.fromCharCode(yf(this,w)),w+=2;e*=2;break;case"utf8":r=yv(this,this.l,this.l+e);break;case"utf16le":e*=2,r=wP(this,this.l,this.l+e);break;case"wstr":if(typeof Pi<"u")r=Pi.utils.decode(Xl,this.slice(this.l,this.l+2*e));else return yw.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=k4(this,this.l),e=4+Zo(this,this.l);break;case"lpstr-cp":r=O4(this,this.l),e=4+Zo(this,this.l);break;case"lpwstr":r=M4(this,this.l),e=4+2*Zo(this,this.l);break;case"lpp4":e=4+Zo(this,this.l),r=R4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zo(this,this.l),r=D4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(d=B_(this,this.l+e++))!==0;)u.push(nw(d));r=u.join("");break;case"_wstr":for(e=0,r="";(d=yf(this,this.l+e))!==0;)u.push(nw(d)),e+=2;e+=2,r=u.join("");break;case"dbcs-cont":for(r="",w=this.l,v=0;v<e;++v){if(this.lens&&this.lens.indexOf(w)!==-1)return d=B_(this,w),this.l=w+1,i=yw.call(this,e-v,d?"dbcs-cont":"sbcs-cont"),u.join("")+i;u.push(nw(yf(this,w))),w+=2}r=u.join(""),e*=2;break;case"cpstr":if(typeof Pi<"u"){r=Pi.utils.decode(Xl,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",w=this.l,v=0;v!=e;++v){if(this.lens&&this.lens.indexOf(w)!==-1)return d=B_(this,w),this.l=w+1,i=yw.call(this,e-v,d?"dbcs-cont":"sbcs-cont"),u.join("")+i;u.push(nw(B_(this,w))),w+=1}r=u.join("");break;default:switch(e){case 1:return n=B_(this,this.l),this.l++,n;case 2:return n=(t==="i"?Hme:yf)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Um:qme)(this,this.l),this.l+=4,n):(o=Zo(this,this.l),this.l+=4,o);case 8:case-8:if(t==="f")return e==8?o=SA(this,this.l):o=SA([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:r=xZ(this,this.l,e);break}}return this.l+=e,r}var Xme=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Zme=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Yme=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Kme(e,t,r){var n=0,o=0;if(r==="dbcs"){for(o=0;o!=t.length;++o)Yme(this,t.charCodeAt(o),this.l+2*o);n=2*t.length}else if(r==="sbcs"){if(typeof Pi<"u"&&x0==874)for(o=0;o!=t.length;++o){var u=Pi.utils.encode(x0,t.charAt(o));this[this.l+o]=u[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=t.length;++o)this[this.l+o]=t.charCodeAt(o)&255;n=t.length}else if(r==="hex"){for(;o<e;++o)this[this.l++]=parseInt(t.slice(2*o,2*o+2),16)||0;return this}else if(r==="utf16le"){var d=Math.min(this.l+e,this.length);for(o=0;o<Math.min(t.length,e);++o){var i=t.charCodeAt(o);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<d;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Xme(this,t,this.l);break;case 8:if(n=8,r==="f"){Gme(this,t,this.l);break}case 16:break;case-4:n=4,Zme(this,t,this.l);break}return this.l+=n,this}function PZ(e,t){var r=xZ(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ss(e,t){e.l=t,e.read_shift=yw,e.chk=PZ,e.write_shift=Kme}function Ds(e,t){e.l+=t}function rr(e){var t=Ap(e);return ss(t,0),t}function Uf(e,t,r){if(e){var n,o,u;ss(e,e.l||0);for(var d=e.length,i=0,v=0;e.l<d;){i=e.read_shift(1),i&128&&(i=(i&127)+((e.read_shift(1)&127)<<7));var w=cb[i]||cb[65535];for(n=e.read_shift(1),u=n&127,o=1;o<4&&n&128;++o)u+=((n=e.read_shift(1))&127)<<7*o;v=e.l+u;var S=w.f&&w.f(e,u,r);if(e.l=v,t(S,w,i))return}}}function ml(){var e=[],t=oi?256:2048,r=function(w){var S=rr(w);return ss(S,0),S},n=r(t),o=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},u=function(w){return n&&w<n.length-n.l?n:(o(),n=r(Math.max(w+1,t)))},d=function(){return o(),Yo(e)},i=function(w){o(),n=w,n.l==null&&(n.l=n.length),u(t)};return{next:u,push:i,end:d,_bufs:e}}function yr(e,t,r,n){var o=+t,u;if(!isNaN(o)){n||(n=cb[o].p||(r||[]).length||0),u=1+(o>=128?1:0)+1,n>=128&&++u,n>=16384&&++u,n>=2097152&&++u;var d=e.next(u);o<=127?d.write_shift(1,o):(d.write_shift(1,(o&127)+128),d.write_shift(1,o>>7));for(var i=0;i!=4;++i)if(n>=128)d.write_shift(1,(n&127)+128),n>>=7;else{d.write_shift(1,n);break}n>0&&F4(r)&&e.push(r)}}function vw(e,t,r){var n=fa(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xj(e,t,r){var n=fa(e);return n.s=vw(n.s,t.s,r),n.e=vw(n.e,t.s,r),n}function xw(e,t){if(e.cRel&&e.c<0)for(e=fa(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=fa(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Pn(e);return!e.cRel&&e.cRel!=null&&(r=e0e(r)),!e.rRel&&e.rRel!=null&&(r=Jme(r)),r}function uM(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Oa(e.s.c)+":"+(e.e.cRel?"":"$")+Oa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Qa(e.s.r)+":"+(e.e.rRel?"":"$")+Qa(e.e.r):xw(e.s,t.biff)+":"+xw(e.e,t.biff)}function L4(e){return parseInt(Qme(e),10)-1}function Qa(e){return""+(e+1)}function Jme(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Qme(e){return e.replace(/\$(\d+)$/,"$1")}function N4(e){for(var t=t0e(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Oa(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function e0e(e){return e.replace(/^([A-Z])/,"$$$1")}function t0e(e){return e.replace(/^\$([A-Z])/,"$1")}function r0e(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Va(e){for(var t=0,r=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o>=48&&o<=57?t=10*t+(o-48):o>=65&&o<=90&&(r=26*r+(o-64))}return{c:r-1,r:t-1}}function Pn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function tl(e){var t=e.indexOf(":");return t==-1?{s:Va(e),e:Va(e)}:{s:Va(e.slice(0,t)),e:Va(e.slice(t+1))}}function Hn(e,t){return typeof t>"u"||typeof t=="number"?Hn(e.s,e.e):(typeof e!="string"&&(e=Pn(e)),typeof t!="string"&&(t=Pn(t)),e==t?e:e+":"+t)}function wi(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,o=0,u=e.length;for(r=0;n<u&&!((o=e.charCodeAt(n)-64)<1||o>26);++n)r=26*r+o;for(t.s.c=--r,r=0;n<u&&!((o=e.charCodeAt(n)-48)<0||o>9);++n)r=10*r+o;if(t.s.r=--r,n===u||o!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=u&&!((o=e.charCodeAt(n)-64)<1||o>26);++n)r=26*r+o;for(t.e.c=--r,r=0;n!=u&&!((o=e.charCodeAt(n)-48)<0||o>9);++n)r=10*r+o;return t.e.r=--r,t}function Zj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Kl(e.z,r?Lo(t):t)}catch{}try{return e.w=Kl((e.XF||{}).numFmtId||(r?14:0),r?Lo(t):t)}catch{return""+t}}function Ch(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?$f[e.v]||e.v:t==null?Zj(e,e.v):Zj(e,t))}function Lp(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function IZ(e,t,r){var n=r||{},o=e?Array.isArray(e):n.dense,u=e||(o?[]:{}),d=0,i=0;if(u&&n.origin!=null){if(typeof n.origin=="number")d=n.origin;else{var v=typeof n.origin=="string"?Va(n.origin):n.origin;d=v.r,i=v.c}u["!ref"]||(u["!ref"]="A1:A1")}var w={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(u["!ref"]){var S=wi(u["!ref"]);w.s.c=S.s.c,w.s.r=S.s.r,w.e.c=Math.max(w.e.c,S.e.c),w.e.r=Math.max(w.e.r,S.e.r),d==-1&&(w.e.r=d=S.e.r+1)}for(var C=0;C!=t.length;++C)if(t[C]){if(!Array.isArray(t[C]))throw new Error("aoa_to_sheet expects an array of arrays");for(var k=0;k!=t[C].length;++k)if(!(typeof t[C][k]>"u")){var O={v:t[C][k]},L=d+C,R=i+k;if(w.s.r>L&&(w.s.r=L),w.s.c>R&&(w.s.c=R),w.e.r<L&&(w.e.r=L),w.e.c<R&&(w.e.c=R),t[C][k]&&typeof t[C][k]=="object"&&!Array.isArray(t[C][k])&&!(t[C][k]instanceof Date))O=t[C][k];else if(Array.isArray(O.v)&&(O.f=t[C][k][1],O.v=O.v[0]),O.v===null)if(O.f)O.t="n";else if(n.nullError)O.t="e",O.v=0;else if(n.sheetStubs)O.t="z";else continue;else typeof O.v=="number"?O.t="n":typeof O.v=="boolean"?O.t="b":O.v instanceof Date?(O.z=n.dateNF||xn[14],n.cellDates?(O.t="d",O.w=Kl(O.z,Lo(O.v))):(O.t="n",O.v=Lo(O.v),O.w=Kl(O.z,O.v))):O.t="s";if(o)u[L]||(u[L]=[]),u[L][R]&&u[L][R].z&&(O.z=u[L][R].z),u[L][R]=O;else{var N=Pn({c:R,r:L});u[N]&&u[N].z&&(O.z=u[N].z),u[N]=O}}}return w.s.c<1e7&&(u["!ref"]=Hn(w)),u}function vv(e,t){return IZ(null,e,t)}function n0e(e){return e.read_shift(4,"i")}function bu(e,t){return t||(t=rr(4)),t.write_shift(4,e),t}function Ms(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ko(e,t){var r=!1;return t==null&&(r=!0,t=rr(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function i0e(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function a0e(e,t){return t||(t=rr(4)),t.write_shift(2,0),t.write_shift(2,0),t}function B4(e,t){var r=e.l,n=e.read_shift(1),o=Ms(e),u=[],d={t:o,h:o};if(n&1){for(var i=e.read_shift(4),v=0;v!=i;++v)u.push(i0e(e));d.r=u}else d.r=[{ich:0,ifnt:0}];return e.l=r+t,d}function o0e(e,t){var r=!1;return t==null&&(r=!0,t=rr(15+4*e.t.length)),t.write_shift(1,0),Ko(e.t,t),r?t.slice(0,t.l):t}var s0e=B4;function l0e(e,t){var r=!1;return t==null&&(r=!0,t=rr(23+4*e.t.length)),t.write_shift(1,1),Ko(e.t,t),t.write_shift(4,1),a0e({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Nc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function N0(e,t){return t==null&&(t=rr(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function B0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function z0(e,t){return t==null&&(t=rr(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var c0e=Ms,kZ=Ko;function z4(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function EA(e,t){var r=!1;return t==null&&(r=!0,t=rr(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var u0e=Ms,f3=z4,j4=EA;function U4(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var o=n===0?SA([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Um(t,0)>>2;return r?o/100:o}function OZ(e,t){t==null&&(t=rr(4));var r=0,n=0,o=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:o==(o|0)&&o>=-(1<<29)&&o<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?o:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function MZ(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function h0e(e,t){return t||(t=rr(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var j0=MZ,xv=h0e;function ks(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function T0(e,t){return(t||rr(8)).write_shift(8,e,"f")}function f0e(e){var t={},r=e.read_shift(1),n=r>>>1,o=e.read_shift(1),u=e.read_shift(2,"i"),d=e.read_shift(1),i=e.read_shift(1),v=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=o;var w=n0[o];w&&(t.rgb=ab(w));break;case 2:t.rgb=ab([d,i,v]);break;case 3:t.theme=o;break}return u!=0&&(t.tint=u>0?u/32767:u/32768),t}function AA(e,t){if(t||(t=rr(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function d0e(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function p0e(e,t){t||(t=rr(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function RZ(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function m0e(e){return RZ(e,1)}function g0e(e){return RZ(e,2)}var $4=2,ll=3,KS=11,Yj=12,CA=19,JS=64,_0e=65,y0e=71,v0e=4108,x0e=4126,Ho=80,DZ=81,w0e=[Ho,DZ],d3={1:{n:"CodePage",t:$4},2:{n:"Category",t:Ho},3:{n:"PresentationFormat",t:Ho},4:{n:"ByteCount",t:ll},5:{n:"LineCount",t:ll},6:{n:"ParagraphCount",t:ll},7:{n:"SlideCount",t:ll},8:{n:"NoteCount",t:ll},9:{n:"HiddenCount",t:ll},10:{n:"MultimediaClipCount",t:ll},11:{n:"ScaleCrop",t:KS},12:{n:"HeadingPairs",t:v0e},13:{n:"TitlesOfParts",t:x0e},14:{n:"Manager",t:Ho},15:{n:"Company",t:Ho},16:{n:"LinksUpToDate",t:KS},17:{n:"CharacterCount",t:ll},19:{n:"SharedDoc",t:KS},22:{n:"HyperlinksChanged",t:KS},23:{n:"AppVersion",t:ll,p:"version"},24:{n:"DigSig",t:_0e},26:{n:"ContentType",t:Ho},27:{n:"ContentStatus",t:Ho},28:{n:"Language",t:Ho},29:{n:"Version",t:Ho},255:{},2147483648:{n:"Locale",t:CA},2147483651:{n:"Behavior",t:CA},1919054434:{}},p3={1:{n:"CodePage",t:$4},2:{n:"Title",t:Ho},3:{n:"Subject",t:Ho},4:{n:"Author",t:Ho},5:{n:"Keywords",t:Ho},6:{n:"Comments",t:Ho},7:{n:"Template",t:Ho},8:{n:"LastAuthor",t:Ho},9:{n:"RevNumber",t:Ho},10:{n:"EditTime",t:JS},11:{n:"LastPrinted",t:JS},12:{n:"CreatedDate",t:JS},13:{n:"ModifiedDate",t:JS},14:{n:"PageCount",t:ll},15:{n:"WordCount",t:ll},16:{n:"CharCount",t:ll},17:{n:"Thumbnail",t:y0e},18:{n:"Application",t:Ho},19:{n:"DocSecurity",t:ll},255:{},2147483648:{n:"Locale",t:CA},2147483651:{n:"Behavior",t:CA},1919054434:{}},Kj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},b0e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function T0e(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var S0e=T0e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n0=fa(S0e),$f={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},FZ={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},m3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},QS={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function V4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function E0e(e){var t=V4();if(!e||!e.match)return t;var r={};if((e.match(Fs)||[]).forEach(function(n){var o=kn(n);switch(o[0].replace(Fme,"<")){case"<?xml":break;case"<Types":t.xmlns=o["xmlns"+(o[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[o.Extension]=o.ContentType;break;case"<Override":t[m3[o.ContentType]]!==void 0&&t[m3[o.ContentType]].push(o.PartName);break}}),t.xmlns!==Ro.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function LZ(e,t){var r=Eme(m3),n=[],o;n[n.length]=co,n[n.length]=Fr("Types",null,{xmlns:Ro.CT,"xmlns:xsd":Ro.xsd,"xmlns:xsi":Ro.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(v){return Fr("Default",null,{Extension:v[0],ContentType:v[1]})}));var u=function(v){e[v]&&e[v].length>0&&(o=e[v][0],n[n.length]=Fr("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:QS[v][t.bookType]||QS[v].xlsx}))},d=function(v){(e[v]||[]).forEach(function(w){n[n.length]=Fr("Override",null,{PartName:(w[0]=="/"?"":"/")+w,ContentType:QS[v][t.bookType]||QS[v].xlsx})})},i=function(v){(e[v]||[]).forEach(function(w){n[n.length]=Fr("Override",null,{PartName:(w[0]=="/"?"":"/")+w,ContentType:r[v][0]})})};return u("workbooks"),d("sheets"),d("charts"),i("themes"),["strs","styles"].forEach(u),["coreprops","extprops","custprops"].forEach(i),i("vba"),i("comments"),i("threadedcomments"),i("drawings"),d("metadata"),i("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var fi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ib(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ww(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Fs)||[]).forEach(function(o){var u=kn(o);if(u[0]==="<Relationship"){var d={};d.Type=u.Type,d.Target=u.Target,d.Id=u.Id,u.TargetMode&&(d.TargetMode=u.TargetMode);var i=u.TargetMode==="External"?u.Target:aw(u.Target,t);r[i]=d,n[u.Id]=d}}),r["!id"]=n,r}function dy(e){var t=[co,Fr("Relationships",null,{xmlns:Ro.RELS})];return to(e["!id"]).forEach(function(r){t[t.length]=Fr("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Yi(e,t,r,n,o,u){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,o.Id="rId"+t,o.Type=n,o.Target=r,[fi.HLINK,fi.XPATH,fi.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,t}var A0e="application/vnd.oasis.opendocument.spreadsheet";function C0e(e,t){for(var r=I4(e),n,o;n=nb.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(o=kn(n[0],!1),o.path=="/"&&o.type!==A0e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function P0e(e){var t=[co];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Jj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function I0e(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function k0e(e){var t=[co];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Jj(e[r][0],e[r][1])),t.push(I0e("",e[r][0]));return t.push(Jj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function NZ(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Jw.version+"</meta:generator></office:meta></office:document-meta>"}var Oc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],O0e=function(){for(var e=new Array(Oc.length),t=0;t<Oc.length;++t){var r=Oc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function BZ(e){var t={};e=la(e);for(var r=0;r<Oc.length;++r){var n=Oc[r],o=e.match(O0e[r]);o!=null&&o.length>0&&(t[n[1]]=Ri(o[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ma(t[n[1]]))}return t}function hM(e,t,r,n,o){o[e]!=null||t==null||t===""||(o[e]=t,t=Ki(t),n[n.length]=r?Fr(e,t,r):ls(e,t))}function zZ(e,t){var r=t||{},n=[co,Fr("cp:coreProperties",null,{"xmlns:cp":Ro.CORE_PROPS,"xmlns:dc":Ro.dc,"xmlns:dcterms":Ro.dcterms,"xmlns:dcmitype":Ro.dcmitype,"xmlns:xsi":Ro.xsi})],o={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&hM("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:h3(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,o),e.ModifiedDate!=null&&hM("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:h3(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,o));for(var u=0;u!=Oc.length;++u){var d=Oc[u],i=r.Props&&r.Props[d[1]]!=null?r.Props[d[1]]:e?e[d[1]]:null;i===!0?i="1":i===!1?i="0":typeof i=="number"&&(i=String(i)),i!=null&&hM(d[0],i,null,n,o)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var i0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jZ=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function UZ(e,t,r,n){var o=[];if(typeof e=="string")o=$j(e,n);else for(var u=0;u<e.length;++u)o=o.concat(e[u].map(function(S){return{v:S}}));var d=typeof t=="string"?$j(t,n).map(function(S){return S.v}):t,i=0,v=0;if(d.length>0)for(var w=0;w!==o.length;w+=2){switch(v=+o[w+1].v,o[w].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=v,r.SheetNames=d.slice(i,i+v);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=v,r.DefinedNames=d.slice(i,i+v);break;case"Charts":case"Diagramme":r.Chartsheets=v,r.ChartNames=d.slice(i,i+v);break}i+=v}}function M0e(e,t,r){var n={};return t||(t={}),e=la(e),i0.forEach(function(o){var u=(e.match(tb(o[0]))||[])[1];switch(o[2]){case"string":u&&(t[o[1]]=Ri(u));break;case"bool":t[o[1]]=u==="true";break;case"raw":var d=e.match(new RegExp("<"+o[0]+"[^>]*>([\\s\\S]*?)</"+o[0]+">"));d&&d.length>0&&(n[o[1]]=d[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&UZ(n.HeadingPairs,n.TitlesOfParts,t,r),t}function $Z(e){var t=[],r=Fr;return e||(e={}),e.Application="SheetJS",t[t.length]=co,t[t.length]=Fr("Properties",null,{xmlns:Ro.EXT_PROPS,"xmlns:vt":Ro.vt}),i0.forEach(function(n){if(e[n[1]]!==void 0){var o;switch(n[2]){case"string":o=Ki(String(e[n[1]]));break;case"bool":o=e[n[1]]?"true":"false";break}o!==void 0&&(t[t.length]=r(n[0],o))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ki(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var R0e=/<[^>]+>[^<]*/g;function D0e(e,t){var r={},n="",o=e.match(R0e);if(o)for(var u=0;u!=o.length;++u){var d=o[u],i=kn(d);switch(i[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ri(i.name);break;case"</property>":n=null;break;default:if(d.indexOf("<vt:")===0){var v=d.split(">"),w=v[0].slice(4),S=v[1];switch(w){case"lpstr":case"bstr":case"lpwstr":r[n]=Ri(S);break;case"bool":r[n]=Ia(S);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(S,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(S);break;case"filetime":case"date":r[n]=Ma(S);break;case"cy":case"error":r[n]=Ri(S);break;default:if(w.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",d,w,v)}}else if(d.slice(0,2)!=="</"){if(t.WTF)throw new Error(d)}}}return r}function VZ(e){var t=[co,Fr("Properties",null,{xmlns:Ro.CUST_PROPS,"xmlns:vt":Ro.vt})];if(!e)return t.join("");var r=1;return to(e).forEach(function(o){++r,t[t.length]=Fr("property",Vme(e[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ki(o)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var g3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fM;function F0e(e,t,r){fM||(fM=yP(g3)),t=fM[t]||t,e[t]=r}function L0e(e,t){var r=[];return to(g3).map(function(n){for(var o=0;o<Oc.length;++o)if(Oc[o][1]==n)return Oc[o];for(o=0;o<i0.length;++o)if(i0[o][1]==n)return i0[o];throw n}).forEach(function(n){if(e[n[1]]!=null){var o=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":o=new Date(o).toISOString().replace(/\.\d*Z/,"Z");break}typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),r.push(ls(g3[n[1]]||n[1],o))}}),Fr("DocumentProperties",r.join(""),{xmlns:Ul.o})}function N0e(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",o=[];return e&&to(e).forEach(function(u){if(Object.prototype.hasOwnProperty.call(e,u)){for(var d=0;d<Oc.length;++d)if(u==Oc[d][1])return;for(d=0;d<i0.length;++d)if(u==i0[d][1])return;for(d=0;d<r.length;++d)if(u==r[d])return;var i=e[u],v="string";typeof i=="number"?(v="float",i=String(i)):i===!0||i===!1?(v="boolean",i=i?"1":"0"):i=String(i),o.push(Fr(Bj(u),i,{"dt:dt":v}))}}),t&&to(t).forEach(function(u){if(Object.prototype.hasOwnProperty.call(t,u)&&!(e&&Object.prototype.hasOwnProperty.call(e,u))){var d=t[u],i="string";typeof d=="number"?(i="float",d=String(d)):d===!0||d===!1?(i="boolean",d=d?"1":"0"):d instanceof Date?(i="dateTime.tz",d=d.toISOString()):d=String(d),o.push(Fr(Bj(u),d,{"dt:dt":i}))}}),"<"+n+' xmlns="'+Ul.o+'">'+o.join("")+"</"+n+">"}function W4(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function B0e(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),o=(r-n)/Math.pow(2,32);n*=1e7,o*=1e7;var u=n/Math.pow(2,32)|0;u>0&&(n=n%Math.pow(2,32),o+=u);var d=rr(8);return d.write_shift(4,n),d.write_shift(4,o),d}function WZ(e,t,r){var n=e.l,o=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return o}function GZ(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function HZ(e,t,r){return t===31?GZ(e):WZ(e,t,r)}function _3(e,t,r){return HZ(e,t,r===!1?0:4)}function z0e(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HZ(e,t,0)}function j0e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var o=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Os,""),e.l-o&2&&(e.l+=2)}return r}function U0e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Os,"");return r}function $0e(e){var t=e.l,r=PA(e,DZ);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=PA(e,ll);return[r,n]}function V0e(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push($0e(e));return r}function Qj(e,t){for(var r=e.read_shift(4),n={},o=0;o!=r;++o){var u=e.read_shift(4),d=e.read_shift(4);n[u]=e.read_shift(d,t===1200?"utf16le":"utf8").replace(Os,"").replace(iw,"!"),t===1200&&d%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function qZ(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function W0e(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function PA(e,t,r){var n=e.read_shift(2),o,u=r||{};if(e.l+=2,t!==Yj&&n!==t&&w0e.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Yj?n:t){case 2:return o=e.read_shift(2,"i"),u.raw||(e.l+=2),o;case 3:return o=e.read_shift(4,"i"),o;case 11:return e.read_shift(4)!==0;case 19:return o=e.read_shift(4),o;case 30:return WZ(e,n,4).replace(Os,"");case 31:return GZ(e);case 64:return W4(e);case 65:return qZ(e);case 71:return W0e(e);case 80:return _3(e,n,!u.raw).replace(Os,"");case 81:return z0e(e,n).replace(Os,"");case 4108:return V0e(e);case 4126:case 4127:return n==4127?j0e(e):U0e(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function eU(e,t){var r=rr(4),n=rr(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=rr(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=B0e(t);break;case 31:case 80:for(n=rr(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yo([r,n])}function tU(e,t){var r=e.l,n=e.read_shift(4),o=e.read_shift(4),u=[],d=0,i=0,v=-1,w={};for(d=0;d!=o;++d){var S=e.read_shift(4),C=e.read_shift(4);u[d]=[S,C+r]}u.sort(function(G,U){return G[1]-U[1]});var k={};for(d=0;d!=o;++d){if(e.l!==u[d][1]){var O=!0;if(d>0&&t)switch(t[u[d-1][0]].t){case 2:e.l+2===u[d][1]&&(e.l+=2,O=!1);break;case 80:e.l<=u[d][1]&&(e.l=u[d][1],O=!1);break;case 4108:e.l<=u[d][1]&&(e.l=u[d][1],O=!1);break}if((!t||d==0)&&e.l<=u[d][1]&&(O=!1,e.l=u[d][1]),O)throw new Error("Read Error: Expected address "+u[d][1]+" at "+e.l+" :"+d)}if(t){var L=t[u[d][0]];if(k[L.n]=PA(e,L.t,{raw:!0}),L.p==="version"&&(k[L.n]=String(k[L.n]>>16)+"."+("0000"+String(k[L.n]&65535)).slice(-4)),L.n=="CodePage")switch(k[L.n]){case 0:k[L.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Pc(i=k[L.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+k[L.n])}}else if(u[d][0]===1){if(i=k.CodePage=PA(e,$4),Pc(i),v!==-1){var R=e.l;e.l=u[v][1],w=Qj(e,i),e.l=R}}else if(u[d][0]===0){if(i===0){v=d,e.l=u[d+1][1];continue}w=Qj(e,i)}else{var N=w[u[d][0]],V;switch(e[e.l]){case 65:e.l+=4,V=qZ(e);break;case 30:e.l+=4,V=_3(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,V=_3(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,V=e.read_shift(4,"i");break;case 19:e.l+=4,V=e.read_shift(4);break;case 5:e.l+=4,V=e.read_shift(8,"f");break;case 11:e.l+=4,V=oo(e,4);break;case 64:e.l+=4,V=Ma(W4(e));break;default:throw new Error("unparsed value: "+e[e.l])}k[N]=V}}return e.l=r+n,k}var XZ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function G0e(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function rU(e,t,r){var n=rr(8),o=[],u=[],d=8,i=0,v=rr(8),w=rr(8);if(v.write_shift(4,2),v.write_shift(4,1200),w.write_shift(4,1),u.push(v),o.push(w),d+=8+v.length,!t){w=rr(8),w.write_shift(4,0),o.unshift(w);var S=[rr(4)];for(S[0].write_shift(4,e.length),i=0;i<e.length;++i){var C=e[i][0];for(v=rr(8+2*(C.length+1)+(C.length%2?0:2)),v.write_shift(4,i+2),v.write_shift(4,C.length+1),v.write_shift(0,C,"dbcs");v.l!=v.length;)v.write_shift(1,0);S.push(v)}v=Yo(S),u.unshift(v),d+=8+v.length}for(i=0;i<e.length;++i)if(!(t&&!t[e[i][0]])&&!(XZ.indexOf(e[i][0])>-1||jZ.indexOf(e[i][0])>-1)&&e[i][1]!=null){var k=e[i][1],O=0;if(t){O=+t[e[i][0]];var L=r[O];if(L.p=="version"&&typeof k=="string"){var R=k.split(".");k=(+R[0]<<16)+(+R[1]||0)}v=eU(L.t,k)}else{var N=G0e(k);N==-1&&(N=31,k=String(k)),v=eU(N,k)}u.push(v),w=rr(8),w.write_shift(4,t?O:2+i),o.push(w),d+=8+v.length}var V=8*(u.length+1);for(i=0;i<u.length;++i)o[i].write_shift(4,V),V+=u[i].length;return n.write_shift(4,d),n.write_shift(4,u.length),Yo([n].concat(o).concat(u))}function nU(e,t,r){var n=e.content;if(!n)return{};ss(n,0);var o,u,d,i,v=0;n.chk("feff","Byte Order: "),n.read_shift(2);var w=n.read_shift(4),S=n.read_shift(16);if(S!==pn.utils.consts.HEADER_CLSID&&S!==r)throw new Error("Bad PropertySet CLSID "+S);if(o=n.read_shift(4),o!==1&&o!==2)throw new Error("Unrecognized #Sets: "+o);if(u=n.read_shift(16),i=n.read_shift(4),o===1&&i!==n.l)throw new Error("Length mismatch: "+i+" !== "+n.l);o===2&&(d=n.read_shift(16),v=n.read_shift(4));var C=tU(n,t),k={SystemIdentifier:w};for(var O in C)k[O]=C[O];if(k.FMTID=u,o===1)return k;if(v-n.l==2&&(n.l+=2),n.l!==v)throw new Error("Length mismatch 2: "+n.l+" !== "+v);var L;try{L=tU(n,null)}catch{}for(O in L)k[O]=L[O];return k.FMTID=[u,d],k}function iU(e,t,r,n,o,u){var d=rr(o?68:48),i=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,pn.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,o?2:1),d.write_shift(16,t,"hex"),d.write_shift(4,o?68:48);var v=rU(e,r,n);if(i.push(v),o){var w=rU(o,null,null);d.write_shift(16,u,"hex"),d.write_shift(4,68+v.length),i.push(w)}return Yo(i)}function Bd(e,t){return e.read_shift(t),null}function H0e(e,t){t||(t=rr(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function q0e(e,t,r){for(var n=[],o=e.l+t;e.l<o;)n.push(r(e,o-e.l));if(o!==e.l)throw new Error("Slurp error");return n}function oo(e,t){return e.read_shift(t)===1}function Ks(e,t){return t||(t=rr(2)),t.write_shift(2,+!!e),t}function yo(e){return e.read_shift(2,"u")}function wc(e,t){return t||(t=rr(2)),t.write_shift(2,e),t}function ZZ(e,t){return q0e(e,t,yo)}function X0e(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function YZ(e,t,r){return r||(r=rr(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function d2(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),o="sbcs-cont",u=Xl;if(r&&r.biff>=8&&(Xl=1200),!r||r.biff==8){var d=e.read_shift(1);d&&(o="dbcs-cont")}else r.biff==12&&(o="wstr");r.biff>=2&&r.biff<=5&&(o="cpstr");var i=n?e.read_shift(n,o):"";return Xl=u,i}function Z0e(e){var t=Xl;Xl=1200;var r=e.read_shift(2),n=e.read_shift(1),o=n&4,u=n&8,d=1+(n&1),i=0,v,w={};u&&(i=e.read_shift(2)),o&&(v=e.read_shift(4));var S=d==2?"dbcs-cont":"sbcs-cont",C=r===0?"":e.read_shift(r,S);return u&&(e.l+=4*i),o&&(e.l+=v),w.t=C,u||(w.raw="<t>"+w.t+"</t>",w.r=w.t),Xl=t,w}function Y0e(e){var t=e.t||"",r=rr(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=rr(2*t.length);n.write_shift(2*t.length,t,"utf16le");var o=[r,n];return Yo(o)}function S0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var o=e.read_shift(1);return o===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function p2(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):S0(e,n,r)}function U0(e,t,r){if(r.biff>5)return p2(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function KZ(e,t,r){return r||(r=rr(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function K0e(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function J0e(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var o=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Os,"");return n&&(e.l+=24),o}function Q0e(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var o=e.read_shift(4);if(o===0)return r+n.replace(/\\/g,"/");var u=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var d=e.read_shift(u>>1,"utf16le").replace(Os,"");return r+d}function ege(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return J0e(e);case"0303000000000000c000000000000046":return Q0e(e);default:throw new Error("Unsupported Moniker "+r)}}function eE(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Os,""):"";return r}function aU(e,t){t||(t=rr(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function tge(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var o=e.read_shift(2);e.l+=2;var u,d,i,v,w="",S,C;o&16&&(u=eE(e,r-e.l)),o&128&&(d=eE(e,r-e.l)),(o&257)===257&&(i=eE(e,r-e.l)),(o&257)===1&&(v=ege(e,r-e.l)),o&8&&(w=eE(e,r-e.l)),o&32&&(S=e.read_shift(16)),o&64&&(C=W4(e)),e.l=r;var k=d||i||v||"";k&&w&&(k+="#"+w),k||(k="#"+w),o&2&&k.charAt(0)=="/"&&k.charAt(1)!="/"&&(k="file://"+k);var O={Target:k};return S&&(O.guid=S),C&&(O.time=C),u&&(O.Tooltip=u),O}function rge(e){var t=rr(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var o=n.indexOf("#"),u=o>-1?31:23;switch(n.charAt(0)){case"#":u=28;break;case".":u&=-3;break}t.write_shift(4,2),t.write_shift(4,u);var d=[8,6815827,6619237,4849780,83];for(r=0;r<d.length;++r)t.write_shift(4,d[r]);if(u==28)n=n.slice(1),aU(n,t);else if(u&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));var i=o>-1?n.slice(0,o):n;for(t.write_shift(4,2*(i.length+1)),r=0;r<i.length;++r)t.write_shift(2,i.charCodeAt(r));t.write_shift(2,0),u&8&&aU(o>-1?n.slice(o+1):"",t)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));for(var v=0;n.slice(v*3,v*3+3)=="../"||n.slice(v*3,v*3+3)=="..\\";)++v;for(t.write_shift(2,v),t.write_shift(4,n.length-3*v+1),r=0;r<n.length-3*v;++r)t.write_shift(1,n.charCodeAt(r+3*v)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function JZ(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),o=e.read_shift(1);return[t,r,n,o]}function QZ(e,t){var r=JZ(e);return r[3]=0,r}function Mh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function E0(e,t,r,n){return n||(n=rr(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function nge(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ige(e,t,r){return t===0?"":U0(e,t,r)}function age(e,t,r){var n=r.biff>8?4:2,o=e.read_shift(n),u=e.read_shift(n,"i"),d=e.read_shift(n,"i");return[o,u,d]}function eY(e){var t=e.read_shift(2),r=U4(e);return[t,r]}function oge(e,t,r){e.l+=4,t-=4;var n=e.l+t,o=d2(e,t,r),u=e.read_shift(2);if(n-=e.l,u!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+u);return e.l+=u,o}function bP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2);return{s:{c:n,r:t},e:{c:o,r}}}function tY(e,t){return t||(t=rr(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function rY(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),o=e.read_shift(1);return{s:{c:n,r:t},e:{c:o,r}}}var sge=rY;function nY(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function lge(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function cge(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ws(e){e.l+=2,e.l+=e.read_shift(2)}var uge={0:ws,4:ws,5:ws,6:ws,7:cge,8:ws,9:ws,10:ws,11:ws,12:ws,13:lge,14:ws,15:ws,16:ws,17:ws,18:ws,19:ws,20:ws,21:nY};function hge(e,t){for(var r=e.l+t,n=[];e.l<r;){var o=e.read_shift(2);e.l-=2;try{n.push(uge[o](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function tE(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function G4(e,t,r){var n=1536,o=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,o=8;break;case"biff4":n=4,o=6;break;case"biff3":n=3,o=6;break;case"biff2":n=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var u=rr(o);return u.write_shift(2,n),u.write_shift(2,t),o>4&&u.write_shift(2,29282),o>6&&u.write_shift(2,1997),o>8&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function fge(e,t){return t===0||e.read_shift(2),1200}function dge(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,o=U0(e,0,r);return e.read_shift(t+n-e.l),o}function pge(e,t){var r=!t||t.biff==8,n=rr(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function mge(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gge(e,t,r){var n=e.read_shift(4),o=e.read_shift(1)&3,u=e.read_shift(1);switch(u){case 0:u="Worksheet";break;case 1:u="Macrosheet";break;case 2:u="Chartsheet";break;case 6:u="VBAModule";break}var d=d2(e,0,r);return d.length===0&&(d="Sheet1"),{pos:n,hs:o,dt:u,name:d}}function _ge(e,t){var r=!t||t.biff>=8?2:1,n=rr(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var o=n.slice(0,n.l);return o.l=n.l,o}function yge(e,t){for(var r=e.l+t,n=e.read_shift(4),o=e.read_shift(4),u=[],d=0;d!=o&&e.l<r;++d)u.push(Z0e(e));return u.Count=n,u.Unique=o,u}function vge(e,t){var r=rr(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],o=0;o<e.length;++o)n[o]=Y0e(e[o]);var u=Yo([r].concat(n));return u.parts=[r.length].concat(n.map(function(d){return d.length})),u}function xge(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function wge(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function bge(e){var t=nge(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Tge(e){return e.read_shift(2),e.read_shift(4)}function oU(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var o=e.read_shift(2);r&&r.biff==2&&(n=1-(o>>15),o&=32767);var u={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[u,o]}function Sge(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),i=e.read_shift(2),v=e.read_shift(2),w=e.read_shift(2);return{Pos:[t,r],Dim:[n,o],Flags:u,CurTab:d,FirstTab:i,Selected:v,TabRatio:w}}function Ege(){var e=rr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Age(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Cge(e){var t=rr(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Pge(){}function Ige(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=d2(e,0,r),n}function kge(e,t){var r=e.name||"Arial",n=t&&t.biff==5,o=n?15+r.length:16+2*r.length,u=rr(o);return u.write_shift(2,(e.sz||12)*20),u.write_shift(4,0),u.write_shift(2,400),u.write_shift(4,0),u.write_shift(2,0),u.write_shift(1,r.length),n||u.write_shift(1,1),u.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),u}function Oge(e){var t=Mh(e);return t.isst=e.read_shift(4),t}function Mge(e,t,r,n){var o=rr(10);return E0(e,t,n,o),o.write_shift(4,r),o}function Rge(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,o=Mh(e);r.biff==2&&e.l++;var u=p2(e,n-e.l,r);return o.val=u,o}function Dge(e,t,r,n,o){var u=!o||o.biff==8,d=rr(8+ +u+(1+u)*r.length);return E0(e,t,n,d),d.write_shift(2,r.length),u&&d.write_shift(1,1),d.write_shift((1+u)*r.length,r,u?"utf16le":"sbcs"),d}function Fge(e,t,r){var n=e.read_shift(2),o=U0(e,0,r);return[n,o]}function Lge(e,t,r,n){var o=r&&r.biff==5;n||(n=rr(o?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(o?1:2,t.length),o||n.write_shift(1,1),n.write_shift((o?1:2)*t.length,t,o?"sbcs":"utf16le");var u=n.length>n.l?n.slice(0,n.l):n;return u.l==null&&(u.l=u.length),u}var Nge=U0;function sU(e,t,r){var n=e.l+t,o=r.biff==8||!r.biff?4:2,u=e.read_shift(o),d=e.read_shift(o),i=e.read_shift(2),v=e.read_shift(2);return e.l=n,{s:{r:u,c:i},e:{r:d,c:v}}}function Bge(e,t){var r=t.biff==8||!t.biff?4:2,n=rr(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function zge(e){var t=e.read_shift(2),r=e.read_shift(2),n=eY(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function jge(e,t){for(var r=e.l+t-2,n=e.read_shift(2),o=e.read_shift(2),u=[];e.l<r;)u.push(eY(e));if(e.l!==r)throw new Error("MulRK read error");var d=e.read_shift(2);if(u.length!=d-o+1)throw new Error("MulRK length mismatch");return{r:n,c:o,C:d,rkrec:u}}function Uge(e,t){for(var r=e.l+t-2,n=e.read_shift(2),o=e.read_shift(2),u=[];e.l<r;)u.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var d=e.read_shift(2);if(u.length!=d-o+1)throw new Error("MulBlank length mismatch");return{r:n,c:o,C:d,ixfe:u}}function $ge(e,t,r,n){var o={},u=e.read_shift(4),d=e.read_shift(4),i=e.read_shift(4),v=e.read_shift(2);return o.patternType=b0e[i>>26],n.cellStyles&&(o.alc=u&7,o.fWrap=u>>3&1,o.alcV=u>>4&7,o.fJustLast=u>>7&1,o.trot=u>>8&255,o.cIndent=u>>16&15,o.fShrinkToFit=u>>20&1,o.iReadOrder=u>>22&2,o.fAtrNum=u>>26&1,o.fAtrFnt=u>>27&1,o.fAtrAlc=u>>28&1,o.fAtrBdr=u>>29&1,o.fAtrPat=u>>30&1,o.fAtrProt=u>>31&1,o.dgLeft=d&15,o.dgRight=d>>4&15,o.dgTop=d>>8&15,o.dgBottom=d>>12&15,o.icvLeft=d>>16&127,o.icvRight=d>>23&127,o.grbitDiag=d>>30&3,o.icvTop=i&127,o.icvBottom=i>>7&127,o.icvDiag=i>>14&127,o.dgDiag=i>>21&15,o.icvFore=v&127,o.icvBack=v>>7&127,o.fsxButton=v>>14&1),o}function Vge(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=$ge(e,t,n.fStyle,r),n}function lU(e,t,r,n){var o=r&&r.biff==5;n||(n=rr(o?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var u=0;return e.numFmtId>0&&o&&(u|=1024),n.write_shift(4,u),n.write_shift(4,0),o||n.write_shift(4,0),n.write_shift(2,0),n}function Wge(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Gge(e){var t=rr(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function cU(e,t,r){var n=Mh(e);(r.biff==2||t==9)&&++e.l;var o=X0e(e);return n.val=o,n.t=o===!0||o===!1?"b":"e",n}function Hge(e,t,r,n,o,u){var d=rr(8);return E0(e,t,n,d),YZ(r,u,d),d}function qge(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Mh(e),o=ks(e);return n.val=o,n}function Xge(e,t,r,n){var o=rr(14);return E0(e,t,n,o),T0(r,o),o}var uU=ige;function Zge(e,t,r){var n=e.l+t,o=e.read_shift(2),u=e.read_shift(2);if(r.sbcch=u,u==1025||u==14849)return[u,o];if(u<1||u>255)throw new Error("Unexpected SupBook type: "+u);for(var d=S0(e,u),i=[];n>e.l;)i.push(p2(e));return[u,o,d,i]}function hU(e,t,r){var n=e.read_shift(2),o,u={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(o=oge(e,t-2,r)),u.body=o||e.read_shift(t-2),typeof o=="string"&&(u.Name=o),u}var Yge=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function fU(e,t,r){var n=e.l+t,o=e.read_shift(2),u=e.read_shift(1),d=e.read_shift(1),i=e.read_shift(r&&r.biff==2?1:2),v=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),v=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var w=S0(e,d,r);o&32&&(w=Yge[w.charCodeAt(0)]);var S=n-e.l;r&&r.biff==2&&--S;var C=n==e.l||i===0||!(S>0)?[]:h1e(e,S,r,i);return{chKey:u,Name:w,itab:v,rgce:C}}function iY(e,t,r){if(r.biff<8)return Kge(e,t,r);for(var n=[],o=e.l+t,u=e.read_shift(r.biff>8?4:2);u--!==0;)n.push(age(e,r.biff>8?12:6,r));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return n}function Kge(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=d2(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Jge(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),o=e.read_shift(2),u=S0(e,n,r),d=S0(e,o,r);return[u,d]}function Qge(e,t,r){var n=rY(e);e.l++;var o=e.read_shift(1);return t-=8,[f1e(e,t,r),o,n]}function dU(e,t,r){var n=sge(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,c1e(e,t,r)]}function e_e(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function t_e(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),i=U0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:o},i,d,u]}}function r_e(e,t,r){return t_e(e,t,r)}function n_e(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(bP(e));return r}function i_e(e){var t=rr(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)tY(e[r],t);return t}function a_e(e,t,r){if(r&&r.biff<8)return s_e(e,t,r);var n=nY(e),o=hge(e,t-22,n[1]);return{cmo:n,ft:o}}var o_e={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var o=e.read_shift(1);return e.l+=o,e.l=r,{fmt:n}}};function s_e(e,t,r){e.l+=4;var n=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var d=[];return d.push((o_e[n]||Ds)(e,t,r)),{cmo:[o,n,u],ft:d}}function l_e(e,t,r){var n=e.l,o="";try{e.l+=4;var u=(r.lastobj||{cmo:[0,0]}).cmo[1],d;[0,5,7,11,12,14].indexOf(u)==-1?e.l+=6:d=K0e(e,6,r);var i=e.read_shift(2);e.read_shift(2),yo(e,2);var v=e.read_shift(2);e.l+=v;for(var w=1;w<e.lens.length-1;++w){if(e.l-n!=e.lens[w])throw new Error("TxO: bad continue record");var S=e[e.l],C=S0(e,e.lens[w+1]-e.lens[w]-1);if(o+=C,o.length>=(S?i:2*i))break}if(o.length!==i&&o.length!==i*2)throw new Error("cchText: "+i+" != "+o.length);return e.l=n+t,{t:o}}catch{return e.l=n+t,{t:o}}}function c_e(e,t){var r=bP(e);e.l+=16;var n=tge(e,t-24);return[r,n]}function u_e(e){var t=rr(24),r=Va(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)t.write_shift(1,parseInt(n[o],16));return Yo([t,rge(e[1])])}function h_e(e,t){e.read_shift(2);var r=bP(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Os,""),[r,n]}function f_e(e){var t=e[1].Tooltip,r=rr(10+2*(t.length+1));r.write_shift(2,2048);var n=Va(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var o=0;o<t.length;++o)r.write_shift(2,t.charCodeAt(o));return r.write_shift(2,0),r}function d_e(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Kj[r]||r,r=e.read_shift(2),t[1]=Kj[r]||r,t}function p_e(e){return e||(e=rr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function m_e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(QZ(e));return r}function g_e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(QZ(e));return r}function __e(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function aY(e,t,r){if(!r.cellStyles)return Ds(e,t);var n=r&&r.biff>=12?4:2,o=e.read_shift(n),u=e.read_shift(n),d=e.read_shift(n),i=e.read_shift(n),v=e.read_shift(2);n==2&&(e.l+=2);var w={s:o,e:u,w:d,ixfe:i,flags:v};return(r.biff>=5||!r.biff)&&(w.level=v>>8&7),w}function y_e(e,t){var r=rr(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function v_e(e,t){var r={};return t<32||(e.l+=16,r.header=ks(e),r.footer=ks(e),e.l+=2),r}function x_e(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var o=e.read_shift(1);return e.l+=3,o&16&&(n.area=!0),n}function w_e(e){for(var t=rr(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var b_e=Mh,T_e=ZZ,S_e=p2;function E_e(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),o={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,o}function A_e(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Mh(e);++e.l;var o=U0(e,t-7,r);return n.t="str",n.val=o,n}function C_e(e){var t=Mh(e);++e.l;var r=ks(e);return t.t="n",t.val=r,t}function P_e(e,t,r){var n=rr(15);return y2(n,e,t),n.write_shift(8,r,"f"),n}function I_e(e){var t=Mh(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function k_e(e,t,r){var n=rr(9);return y2(n,e,t),n.write_shift(2,r),n}function O_e(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function M_e(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function R_e(e,t,r){var n=e.l+t,o=Mh(e),u=e.read_shift(2),d=S0(e,u,r);return e.l=n,o.t="str",o.val=d,o}var D_e=[2,3,48,49,131,139,140,245],y3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=yP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(i,v){var w=[],S=Ap(1);switch(v.type){case"base64":S=$l(Yl(i));break;case"binary":S=$l(i);break;case"buffer":case"array":S=i;break}ss(S,0);var C=S.read_shift(1),k=!!(C&136),O=!1,L=!1;switch(C){case 2:break;case 3:break;case 48:O=!0,k=!0;break;case 49:O=!0,k=!0;break;case 131:break;case 139:break;case 140:L=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+C.toString(16))}var R=0,N=521;C==2&&(R=S.read_shift(2)),S.l+=3,C!=2&&(R=S.read_shift(4)),R>1048576&&(R=1e6),C!=2&&(N=S.read_shift(2));var V=S.read_shift(2),G=v.codepage||1252;C!=2&&(S.l+=16,S.read_shift(1),S[S.l]!==0&&(G=e[S[S.l]]),S.l+=1,S.l+=2),L&&(S.l+=36);for(var U=[],J={},Z=Math.min(S.length,C==2?521:N-10-(O?264:0)),K=L?32:11;S.l<Z&&S[S.l]!=13;)switch(J={},J.name=Pi.utils.decode(G,S.slice(S.l,S.l+K)).replace(/[\u0000\r\n].*$/g,""),S.l+=K,J.type=String.fromCharCode(S.read_shift(1)),C!=2&&!L&&(J.offset=S.read_shift(4)),J.len=S.read_shift(1),C==2&&(J.offset=S.read_shift(2)),J.dec=S.read_shift(1),J.name.length&&U.push(J),C!=2&&(S.l+=L?13:14),J.type){case"B":(!O||J.len!=8)&&v.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"G":case"P":v.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+J.type)}if(S[S.l]!==13&&(S.l=N-1),S.read_shift(1)!==13)throw new Error("DBF Terminator not found "+S.l+" "+S[S.l]);S.l=N;var re=0,ge=0;for(w[0]=[],ge=0;ge!=U.length;++ge)w[0][ge]=U[ge].name;for(;R-- >0;){if(S[S.l]===42){S.l+=V;continue}for(++S.l,w[++re]=[],ge=0,ge=0;ge!=U.length;++ge){var ve=S.slice(S.l,S.l+U[ge].len);S.l+=U[ge].len,ss(ve,0);var $e=Pi.utils.decode(G,ve);switch(U[ge].type){case"C":$e.trim().length&&(w[re][ge]=$e.replace(/\s+$/,""));break;case"D":$e.length===8?w[re][ge]=new Date(+$e.slice(0,4),+$e.slice(4,6)-1,+$e.slice(6,8)):w[re][ge]=$e;break;case"F":w[re][ge]=parseFloat($e.trim());break;case"+":case"I":w[re][ge]=L?ve.read_shift(-4,"i")^2147483648:ve.read_shift(4,"i");break;case"L":switch($e.trim().toUpperCase()){case"Y":case"T":w[re][ge]=!0;break;case"N":case"F":w[re][ge]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+$e+"|")}break;case"M":if(!k)throw new Error("DBF Unexpected MEMO for type "+C.toString(16));w[re][ge]="##MEMO##"+(L?parseInt($e.trim(),10):ve.read_shift(4));break;case"N":$e=$e.replace(/\u0000/g,"").trim(),$e&&$e!="."&&(w[re][ge]=+$e||0);break;case"@":w[re][ge]=new Date(ve.read_shift(-8,"f")-621356832e5);break;case"T":w[re][ge]=new Date((ve.read_shift(4)-2440588)*864e5+ve.read_shift(4));break;case"Y":w[re][ge]=ve.read_shift(4,"i")/1e4+ve.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":w[re][ge]=-ve.read_shift(-8,"f");break;case"B":if(O&&U[ge].len==8){w[re][ge]=ve.read_shift(8,"f");break}case"G":case"P":ve.l+=U[ge].len;break;case"0":if(U[ge].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+U[ge].type)}}}if(C!=2&&S.l<S.length&&S[S.l++]!=26)throw new Error("DBF EOF Marker missing "+(S.l-1)+" of "+S.length+" "+S[S.l-1].toString(16));return v&&v.sheetRows&&(w=w.slice(0,v.sheetRows)),v.DBF=U,w}function n(i,v){var w=v||{};w.dateNF||(w.dateNF="yyyymmdd");var S=vv(r(i,w),w);return S["!cols"]=w.DBF.map(function(C){return{wch:C.len,DBF:C}}),delete w.DBF,S}function o(i,v){try{return Lp(n(i,v),v)}catch(w){if(v&&v.WTF)throw w}return{SheetNames:[],Sheets:{}}}var u={B:8,C:250,L:1,D:8,"?":0,"":0};function d(i,v){var w=v||{};if(+w.codepage>=0&&Pc(+w.codepage),w.type=="string")throw new Error("Cannot write DBF to JS string");var S=ml(),C=MA(i,{header:1,raw:!0,cellDates:!0}),k=C[0],O=C.slice(1),L=i["!cols"]||[],R=0,N=0,V=0,G=1;for(R=0;R<k.length;++R){if(((L[R]||{}).DBF||{}).name){k[R]=L[R].DBF.name,++V;continue}if(k[R]!=null){if(++V,typeof k[R]=="number"&&(k[R]=k[R].toString(10)),typeof k[R]!="string")throw new Error("DBF Invalid column name "+k[R]+" |"+typeof k[R]+"|");if(k.indexOf(k[R])!==R){for(N=0;N<1024;++N)if(k.indexOf(k[R]+"_"+N)==-1){k[R]+="_"+N;break}}}}var U=wi(i["!ref"]),J=[],Z=[],K=[];for(R=0;R<=U.e.c-U.s.c;++R){var re="",ge="",ve=0,$e=[];for(N=0;N<O.length;++N)O[N][R]!=null&&$e.push(O[N][R]);if($e.length==0||k[R]==null){J[R]="?";continue}for(N=0;N<$e.length;++N){switch(typeof $e[N]){case"number":ge="B";break;case"string":ge="C";break;case"boolean":ge="L";break;case"object":ge=$e[N]instanceof Date?"D":"C";break;default:ge="C"}ve=Math.max(ve,String($e[N]).length),re=re&&re!=ge?"C":ge}ve>250&&(ve=250),ge=((L[R]||{}).DBF||{}).type,ge=="C"&&L[R].DBF.len>ve&&(ve=L[R].DBF.len),re=="B"&&ge=="N"&&(re="N",K[R]=L[R].DBF.dec,ve=L[R].DBF.len),Z[R]=re=="C"||ge=="N"?ve:u[re]||0,G+=Z[R],J[R]=re}var Ie=S.next(32);for(Ie.write_shift(4,318902576),Ie.write_shift(4,O.length),Ie.write_shift(2,296+32*V),Ie.write_shift(2,G),R=0;R<4;++R)Ie.write_shift(4,0);for(Ie.write_shift(4,0|(+t[x0]||3)<<8),R=0,N=0;R<k.length;++R)if(k[R]!=null){var ke=S.next(32),tt=(k[R].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ke.write_shift(1,tt,"sbcs"),ke.write_shift(1,J[R]=="?"?"C":J[R],"sbcs"),ke.write_shift(4,N),ke.write_shift(1,Z[R]||u[J[R]]||0),ke.write_shift(1,K[R]||0),ke.write_shift(1,2),ke.write_shift(4,0),ke.write_shift(1,0),ke.write_shift(4,0),ke.write_shift(4,0),N+=Z[R]||u[J[R]]||0}var Je=S.next(264);for(Je.write_shift(4,13),R=0;R<65;++R)Je.write_shift(4,0);for(R=0;R<O.length;++R){var et=S.next(G);for(et.write_shift(1,0),N=0;N<k.length;++N)if(k[N]!=null)switch(J[N]){case"L":et.write_shift(1,O[R][N]==null?63:O[R][N]?84:70);break;case"B":et.write_shift(8,O[R][N]||0,"f");break;case"N":var at="0";for(typeof O[R][N]=="number"&&(at=O[R][N].toFixed(K[N]||0)),V=0;V<Z[N]-at.length;++V)et.write_shift(1,32);et.write_shift(1,at,"sbcs");break;case"D":O[R][N]?(et.write_shift(4,("0000"+O[R][N].getFullYear()).slice(-4),"sbcs"),et.write_shift(2,("00"+(O[R][N].getMonth()+1)).slice(-2),"sbcs"),et.write_shift(2,("00"+O[R][N].getDate()).slice(-2),"sbcs")):et.write_shift(8,"00000000","sbcs");break;case"C":var pt=String(O[R][N]!=null?O[R][N]:"").slice(0,Z[N]);for(et.write_shift(1,pt,"sbcs"),V=0;V<Z[N]-pt.length;++V)et.write_shift(1,32);break}}return S.next(1).write_shift(1,26),S.end()}return{to_workbook:o,to_sheet:n,from_sheet:d}}(),oY=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+to(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(k,O){var L=e[O];return typeof L=="number"?u3(L):L},n=function(k,O,L){var R=O.charCodeAt(0)-32<<4|L.charCodeAt(0)-48;return R==59?k:u3(R)};e["|"]=254;function o(k,O){switch(O.type){case"base64":return u(Yl(k),O);case"binary":return u(k,O);case"buffer":return u(oi&&Buffer.isBuffer(k)?k.toString("binary"):Fp(k),O);case"array":return u(b0(k),O)}throw new Error("Unrecognized type "+O.type)}function u(k,O){var L=k.split(/[\n\r]+/),R=-1,N=-1,V=0,G=0,U=[],J=[],Z=null,K={},re=[],ge=[],ve=[],$e=0,Ie;for(+O.codepage>=0&&Pc(+O.codepage);V!==L.length;++V){$e=0;var ke=L[V].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),tt=ke.replace(/;;/g,"\0").split(";").map(function(Xe){return Xe.replace(/\u0000/g,";")}),Je=tt[0],et;if(ke.length>0)switch(Je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":tt[1].charAt(0)=="P"&&J.push(ke.slice(3).replace(/;;/g,";"));break;case"C":var at=!1,pt=!1,ft=!1,Ue=!1,It=-1,Rt=-1;for(G=1;G<tt.length;++G)switch(tt[G].charAt(0)){case"A":break;case"X":N=parseInt(tt[G].slice(1))-1,pt=!0;break;case"Y":for(R=parseInt(tt[G].slice(1))-1,pt||(N=0),Ie=U.length;Ie<=R;++Ie)U[Ie]=[];break;case"K":et=tt[G].slice(1),et.charAt(0)==='"'?et=et.slice(1,et.length-1):et==="TRUE"?et=!0:et==="FALSE"?et=!1:isNaN(wu(et))?isNaN(zy(et).getDate())||(et=Ma(et)):(et=wu(et),Z!==null&&F0(Z)&&(et=xP(et))),typeof Pi<"u"&&typeof et=="string"&&(O||{}).type!="string"&&(O||{}).codepage&&(et=Pi.utils.decode(O.codepage,et)),at=!0;break;case"E":Ue=!0;var _e=py(tt[G].slice(1),{r:R,c:N});U[R][N]=[U[R][N],_e];break;case"S":ft=!0,U[R][N]=[U[R][N],"S5S"];break;case"G":break;case"R":It=parseInt(tt[G].slice(1))-1;break;case"C":Rt=parseInt(tt[G].slice(1))-1;break;default:if(O&&O.WTF)throw new Error("SYLK bad record "+ke)}if(at&&(U[R][N]&&U[R][N].length==2?U[R][N][0]=et:U[R][N]=et,Z=null),ft){if(Ue)throw new Error("SYLK shared formula cannot have own formula");var Ge=It>-1&&U[It][Rt];if(!Ge||!Ge[1])throw new Error("SYLK shared formula cannot find base");U[R][N][1]=SY(Ge[1],{r:R-It,c:N-Rt})}break;case"F":var qe=0;for(G=1;G<tt.length;++G)switch(tt[G].charAt(0)){case"X":N=parseInt(tt[G].slice(1))-1,++qe;break;case"Y":for(R=parseInt(tt[G].slice(1))-1,Ie=U.length;Ie<=R;++Ie)U[Ie]=[];break;case"M":$e=parseInt(tt[G].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=J[parseInt(tt[G].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(ve=tt[G].slice(1).split(" "),Ie=parseInt(ve[0],10);Ie<=parseInt(ve[1],10);++Ie)$e=parseInt(ve[2],10),ge[Ie-1]=$e===0?{hidden:!0}:{wch:$e},Cp(ge[Ie-1]);break;case"C":N=parseInt(tt[G].slice(1))-1,ge[N]||(ge[N]={});break;case"R":R=parseInt(tt[G].slice(1))-1,re[R]||(re[R]={}),$e>0?(re[R].hpt=$e,re[R].hpx=Uy($e)):$e===0&&(re[R].hidden=!0);break;default:if(O&&O.WTF)throw new Error("SYLK bad record "+ke)}qe<1&&(Z=null);break;default:if(O&&O.WTF)throw new Error("SYLK bad record "+ke)}}return re.length>0&&(K["!rows"]=re),ge.length>0&&(K["!cols"]=ge),O&&O.sheetRows&&(U=U.slice(0,O.sheetRows)),[U,K]}function d(k,O){var L=o(k,O),R=L[0],N=L[1],V=vv(R,O);return to(N).forEach(function(G){V[G]=N[G]}),V}function i(k,O){return Lp(d(k,O),O)}function v(k,O,L,R){var N="C;Y"+(L+1)+";X"+(R+1)+";K";switch(k.t){case"n":N+=k.v||0,k.f&&!k.F&&(N+=";E"+K4(k.f,{r:L,c:R}));break;case"b":N+=k.v?"TRUE":"FALSE";break;case"e":N+=k.w||k.v;break;case"d":N+='"'+(k.w||k.v)+'"';break;case"s":N+='"'+k.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function w(k,O){O.forEach(function(L,R){var N="F;W"+(R+1)+" "+(R+1)+" ";L.hidden?N+="0":(typeof L.width=="number"&&!L.wpx&&(L.wpx=ob(L.width)),typeof L.wpx=="number"&&!L.wch&&(L.wch=sb(L.wpx)),typeof L.wch=="number"&&(N+=Math.round(L.wch))),N.charAt(N.length-1)!=" "&&k.push(N)})}function S(k,O){O.forEach(function(L,R){var N="F;";L.hidden?N+="M0;":L.hpt?N+="M"+20*L.hpt+";":L.hpx&&(N+="M"+20*lb(L.hpx)+";"),N.length>2&&k.push(N+"R"+(R+1))})}function C(k,O){var L=["ID;PWXL;N;E"],R=[],N=wi(k["!ref"]),V,G=Array.isArray(k),U=`\r
`;L.push("P;PGeneral"),L.push("F;P0;DG0G8;M255"),k["!cols"]&&w(L,k["!cols"]),k["!rows"]&&S(L,k["!rows"]),L.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var J=N.s.r;J<=N.e.r;++J)for(var Z=N.s.c;Z<=N.e.c;++Z){var K=Pn({r:J,c:Z});V=G?(k[J]||[])[Z]:k[K],!(!V||V.v==null&&(!V.f||V.F))&&R.push(v(V,k,J,Z))}return L.join(U)+U+R.join(U)+U+"E"+U}return{to_workbook:i,to_sheet:d,from_sheet:C}}(),sY=function(){function e(u,d){switch(d.type){case"base64":return t(Yl(u),d);case"binary":return t(u,d);case"buffer":return t(oi&&Buffer.isBuffer(u)?u.toString("binary"):Fp(u),d);case"array":return t(b0(u),d)}throw new Error("Unrecognized type "+d.type)}function t(u,d){for(var i=u.split(`
`),v=-1,w=-1,S=0,C=[];S!==i.length;++S){if(i[S].trim()==="BOT"){C[++v]=[],w=0;continue}if(!(v<0)){var k=i[S].trim().split(","),O=k[0],L=k[1];++S;for(var R=i[S]||"";(R.match(/["]/g)||[]).length&1&&S<i.length-1;)R+=`
`+i[++S];switch(R=R.trim(),+O){case-1:if(R==="BOT"){C[++v]=[],w=0;continue}else if(R!=="EOD")throw new Error("Unrecognized DIF special command "+R);break;case 0:R==="TRUE"?C[v][w]=!0:R==="FALSE"?C[v][w]=!1:isNaN(wu(L))?isNaN(zy(L).getDate())?C[v][w]=L:C[v][w]=Ma(L):C[v][w]=wu(L),++w;break;case 1:R=R.slice(1,R.length-1),R=R.replace(/""/g,'"'),R&&R.match(/^=".*"$/)&&(R=R.slice(2,-1)),C[v][w++]=R!==""?R:null;break}if(R==="EOD")break}}return d&&d.sheetRows&&(C=C.slice(0,d.sheetRows)),C}function r(u,d){return vv(e(u,d),d)}function n(u,d){return Lp(r(u,d),d)}var o=function(){var u=function(v,w,S,C,k){v.push(w),v.push(S+","+C),v.push('"'+k.replace(/"/g,'""')+'"')},d=function(v,w,S,C){v.push(w+","+S),v.push(w==1?'"'+C.replace(/"/g,'""')+'"':C)};return function(v){var w=[],S=wi(v["!ref"]),C,k=Array.isArray(v);u(w,"TABLE",0,1,"sheetjs"),u(w,"VECTORS",0,S.e.r-S.s.r+1,""),u(w,"TUPLES",0,S.e.c-S.s.c+1,""),u(w,"DATA",0,0,"");for(var O=S.s.r;O<=S.e.r;++O){d(w,-1,0,"BOT");for(var L=S.s.c;L<=S.e.c;++L){var R=Pn({r:O,c:L});if(C=k?(v[O]||[])[L]:v[R],!C){d(w,1,0,"");continue}switch(C.t){case"n":var N=C.w;!N&&C.v!=null&&(N=C.v),N==null?C.f&&!C.F?d(w,1,0,"="+C.f):d(w,1,0,""):d(w,0,N,"V");break;case"b":d(w,0,C.v?1:0,C.v?"TRUE":"FALSE");break;case"s":d(w,1,0,isNaN(C.v)?C.v:'="'+C.v+'"');break;case"d":C.w||(C.w=Kl(C.z||xn[14],Lo(Ma(C.v)))),d(w,0,C.w,"V");break;default:d(w,1,0,"")}}}d(w,-1,0,"EOD");var V=`\r
`,G=w.join(V);return G}}();return{to_workbook:n,to_sheet:r,from_sheet:o}}(),lY=function(){function e(C){return C.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(C){return C.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(C,k){for(var O=C.split(`
`),L=-1,R=-1,N=0,V=[];N!==O.length;++N){var G=O[N].trim().split(":");if(G[0]==="cell"){var U=Va(G[1]);if(V.length<=U.r)for(L=V.length;L<=U.r;++L)V[L]||(V[L]=[]);switch(L=U.r,R=U.c,G[2]){case"t":V[L][R]=e(G[3]);break;case"v":V[L][R]=+G[3];break;case"vtf":var J=G[G.length-1];case"vtc":switch(G[3]){case"nl":V[L][R]=!!+G[4];break;default:V[L][R]=+G[4];break}G[2]=="vtf"&&(V[L][R]=[V[L][R],J])}}}return k&&k.sheetRows&&(V=V.slice(0,k.sheetRows)),V}function n(C,k){return vv(r(C,k),k)}function o(C,k){return Lp(n(C,k),k)}var u=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),v="--SocialCalcSpreadsheetControlSave--";function w(C){if(!C||!C["!ref"])return"";for(var k=[],O=[],L,R="",N=tl(C["!ref"]),V=Array.isArray(C),G=N.s.r;G<=N.e.r;++G)for(var U=N.s.c;U<=N.e.c;++U)if(R=Pn({r:G,c:U}),L=V?(C[G]||[])[U]:C[R],!(!L||L.v==null||L.t==="z")){switch(O=["cell",R,"t"],L.t){case"s":case"str":O.push(t(L.v));break;case"n":L.f?(O[2]="vtf",O[3]="n",O[4]=L.v,O[5]=t(L.f)):(O[2]="v",O[3]=L.v);break;case"b":O[2]="vt"+(L.f?"f":"c"),O[3]="nl",O[4]=L.v?"1":"0",O[5]=t(L.f||(L.v?"TRUE":"FALSE"));break;case"d":var J=Lo(Ma(L.v));O[2]="vtc",O[3]="nd",O[4]=""+J,O[5]=L.w||Kl(L.z||xn[14],J);break;case"e":continue}k.push(O.join(":"))}return k.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),k.push("valueformat:1:text-wiki"),k.join(`
`)}function S(C){return[u,d,i,d,w(C),v].join(`
`)}return{to_workbook:o,to_sheet:n,from_sheet:S}}(),jy=function(){function e(S,C,k,O,L){L.raw?C[k][O]=S:S===""||(S==="TRUE"?C[k][O]=!0:S==="FALSE"?C[k][O]=!1:isNaN(wu(S))?isNaN(zy(S).getDate())?C[k][O]=S:C[k][O]=Ma(S):C[k][O]=wu(S))}function t(S,C){var k=C||{},O=[];if(!S||S.length===0)return O;for(var L=S.split(/[\r\n]/),R=L.length-1;R>=0&&L[R].length===0;)--R;for(var N=10,V=0,G=0;G<=R;++G)V=L[G].indexOf(" "),V==-1?V=L[G].length:V++,N=Math.max(N,V);for(G=0;G<=R;++G){O[G]=[];var U=0;for(e(L[G].slice(0,N).trim(),O,G,U,k),U=1;U<=(L[G].length-N)/10+1;++U)e(L[G].slice(N+(U-1)*10,N+U*10).trim(),O,G,U,k)}return k.sheetRows&&(O=O.slice(0,k.sheetRows)),O}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function o(S){for(var C={},k=!1,O=0,L=0;O<S.length;++O)(L=S.charCodeAt(O))==34?k=!k:!k&&L in r&&(C[L]=(C[L]||0)+1);L=[];for(O in C)Object.prototype.hasOwnProperty.call(C,O)&&L.push([C[O],O]);if(!L.length){C=n;for(O in C)Object.prototype.hasOwnProperty.call(C,O)&&L.push([C[O],O])}return L.sort(function(R,N){return R[0]-N[0]||n[R[1]]-n[N[1]]}),r[L.pop()[1]]||44}function u(S,C){var k=C||{},O="",L=k.dense?[]:{},R={s:{c:0,r:0},e:{c:0,r:0}};S.slice(0,4)=="sep="?S.charCodeAt(5)==13&&S.charCodeAt(6)==10?(O=S.charAt(4),S=S.slice(7)):S.charCodeAt(5)==13||S.charCodeAt(5)==10?(O=S.charAt(4),S=S.slice(6)):O=o(S.slice(0,1024)):k&&k.FS?O=k.FS:O=o(S.slice(0,1024));var N=0,V=0,G=0,U=0,J=0,Z=O.charCodeAt(0),K=!1,re=0,ge=S.charCodeAt(0);S=S.replace(/\r\n/mg,`
`);var ve=k.dateNF!=null?vme(k.dateNF):null;function $e(){var Ie=S.slice(U,J),ke={};if(Ie.charAt(0)=='"'&&Ie.charAt(Ie.length-1)=='"'&&(Ie=Ie.slice(1,-1).replace(/""/g,'"')),Ie.length===0)ke.t="z";else if(k.raw)ke.t="s",ke.v=Ie;else if(Ie.trim().length===0)ke.t="s",ke.v=Ie;else if(Ie.charCodeAt(0)==61)Ie.charCodeAt(1)==34&&Ie.charCodeAt(Ie.length-1)==34?(ke.t="s",ke.v=Ie.slice(2,-1).replace(/""/g,'"')):Zve(Ie)?(ke.t="n",ke.f=Ie.slice(1)):(ke.t="s",ke.v=Ie);else if(Ie=="TRUE")ke.t="b",ke.v=!0;else if(Ie=="FALSE")ke.t="b",ke.v=!1;else if(!isNaN(G=wu(Ie)))ke.t="n",k.cellText!==!1&&(ke.w=Ie),ke.v=G;else if(!isNaN(zy(Ie).getDate())||ve&&Ie.match(ve)){ke.z=k.dateNF||xn[14];var tt=0;ve&&Ie.match(ve)&&(Ie=xme(Ie,k.dateNF,Ie.match(ve)||[]),tt=1),k.cellDates?(ke.t="d",ke.v=Ma(Ie,tt)):(ke.t="n",ke.v=Lo(Ma(Ie,tt))),k.cellText!==!1&&(ke.w=Kl(ke.z,ke.v instanceof Date?Lo(ke.v):ke.v)),k.cellNF||delete ke.z}else ke.t="s",ke.v=Ie;if(ke.t=="z"||(k.dense?(L[N]||(L[N]=[]),L[N][V]=ke):L[Pn({c:V,r:N})]=ke),U=J+1,ge=S.charCodeAt(U),R.e.c<V&&(R.e.c=V),R.e.r<N&&(R.e.r=N),re==Z)++V;else if(V=0,++N,k.sheetRows&&k.sheetRows<=N)return!0}e:for(;J<S.length;++J)switch(re=S.charCodeAt(J)){case 34:ge===34&&(K=!K);break;case Z:case 10:case 13:if(!K&&$e())break e;break}return J-U>0&&$e(),L["!ref"]=Hn(R),L}function d(S,C){return!(C&&C.PRN)||C.FS||S.slice(0,4)=="sep="||S.indexOf("	")>=0||S.indexOf(",")>=0||S.indexOf(";")>=0?u(S,C):vv(t(S,C),C)}function i(S,C){var k="",O=C.type=="string"?[0,0,0,0]:oL(S,C);switch(C.type){case"base64":k=Yl(S);break;case"binary":k=S;break;case"buffer":C.codepage==65001?k=S.toString("utf8"):C.codepage&&typeof Pi<"u"?k=Pi.utils.decode(C.codepage,S):k=oi&&Buffer.isBuffer(S)?S.toString("binary"):Fp(S);break;case"array":k=b0(S);break;case"string":k=S;break;default:throw new Error("Unrecognized type "+C.type)}return O[0]==239&&O[1]==187&&O[2]==191?k=la(k.slice(3)):C.type!="string"&&C.type!="buffer"&&C.codepage==65001?k=la(k):C.type=="binary"&&typeof Pi<"u"&&C.codepage&&(k=Pi.utils.decode(C.codepage,Pi.utils.encode(28591,k))),k.slice(0,19)=="socialcalc:version:"?lY.to_sheet(C.type=="string"?k:la(k),C):d(k,C)}function v(S,C){return Lp(i(S,C),C)}function w(S){for(var C=[],k=wi(S["!ref"]),O,L=Array.isArray(S),R=k.s.r;R<=k.e.r;++R){for(var N=[],V=k.s.c;V<=k.e.c;++V){var G=Pn({r:R,c:V});if(O=L?(S[R]||[])[V]:S[G],!O||O.v==null){N.push("          ");continue}for(var U=(O.w||(Ch(O),O.w)||"").slice(0,10);U.length<10;)U+=" ";N.push(U+(V===0?" ":""))}C.push(N.join(""))}return C.join(`
`)}return{to_workbook:v,to_sheet:i,from_sheet:w}}();function F_e(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var o=oY.to_workbook(e,r);return r.WTF=n,o}catch(u){if(r.WTF=n,!u.message.match(/SYLK bad record ID/)&&n)throw u;return jy.to_workbook(e,t)}}var a0=function(){function e(_e,Ge,qe){if(_e){ss(_e,_e.l||0);for(var Xe=qe.Enum||It;_e.l<_e.length;){var yt=_e.read_shift(2),Dt=Xe[yt]||Xe[65535],Yt=_e.read_shift(2),St=_e.l+Yt,Mt=Dt.f&&Dt.f(_e,Yt,qe);if(_e.l=St,Ge(Mt,Dt,yt))return}}}function t(_e,Ge){switch(Ge.type){case"base64":return r($l(Yl(_e)),Ge);case"binary":return r($l(_e),Ge);case"buffer":case"array":return r(_e,Ge)}throw"Unsupported type "+Ge.type}function r(_e,Ge){if(!_e)return _e;var qe=Ge||{},Xe=qe.dense?[]:{},yt="Sheet1",Dt="",Yt=0,St={},Mt=[],Sr=[],Ne={s:{r:0,c:0},e:{r:0,c:0}},un=qe.sheetRows||0;if(_e[2]==0&&(_e[3]==8||_e[3]==9)&&_e.length>=16&&_e[14]==5&&_e[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_e[2]==2)qe.Enum=It,e(_e,function(Tr,jn,Un){switch(Un){case 0:qe.vers=Tr,Tr>=4096&&(qe.qpro=!0);break;case 6:Ne=Tr;break;case 204:Tr&&(Dt=Tr);break;case 222:Dt=Tr;break;case 15:case 51:qe.qpro||(Tr[1].v=Tr[1].v.slice(1));case 13:case 14:case 16:Un==14&&(Tr[2]&112)==112&&(Tr[2]&15)>1&&(Tr[2]&15)<15&&(Tr[1].z=qe.dateNF||xn[14],qe.cellDates&&(Tr[1].t="d",Tr[1].v=xP(Tr[1].v))),qe.qpro&&Tr[3]>Yt&&(Xe["!ref"]=Hn(Ne),St[yt]=Xe,Mt.push(yt),Xe=qe.dense?[]:{},Ne={s:{r:0,c:0},e:{r:0,c:0}},Yt=Tr[3],yt=Dt||"Sheet"+(Yt+1),Dt="");var Wi=qe.dense?(Xe[Tr[0].r]||[])[Tr[0].c]:Xe[Pn(Tr[0])];if(Wi){Wi.t=Tr[1].t,Wi.v=Tr[1].v,Tr[1].z!=null&&(Wi.z=Tr[1].z),Tr[1].f!=null&&(Wi.f=Tr[1].f);break}qe.dense?(Xe[Tr[0].r]||(Xe[Tr[0].r]=[]),Xe[Tr[0].r][Tr[0].c]=Tr[1]):Xe[Pn(Tr[0])]=Tr[1];break}},qe);else if(_e[2]==26||_e[2]==14)qe.Enum=Rt,_e[2]==14&&(qe.qpro=!0,_e.l=0),e(_e,function(Tr,jn,Un){switch(Un){case 204:yt=Tr;break;case 22:Tr[1].v=Tr[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Tr[3]>Yt&&(Xe["!ref"]=Hn(Ne),St[yt]=Xe,Mt.push(yt),Xe=qe.dense?[]:{},Ne={s:{r:0,c:0},e:{r:0,c:0}},Yt=Tr[3],yt="Sheet"+(Yt+1)),un>0&&Tr[0].r>=un)break;qe.dense?(Xe[Tr[0].r]||(Xe[Tr[0].r]=[]),Xe[Tr[0].r][Tr[0].c]=Tr[1]):Xe[Pn(Tr[0])]=Tr[1],Ne.e.c<Tr[0].c&&(Ne.e.c=Tr[0].c),Ne.e.r<Tr[0].r&&(Ne.e.r=Tr[0].r);break;case 27:Tr[14e3]&&(Sr[Tr[14e3][0]]=Tr[14e3][1]);break;case 1537:Sr[Tr[0]]=Tr[1],Tr[0]==Yt&&(yt=Tr[1]);break}},qe);else throw new Error("Unrecognized LOTUS BOF "+_e[2]);if(Xe["!ref"]=Hn(Ne),St[Dt||yt]=Xe,Mt.push(Dt||yt),!Sr.length)return{SheetNames:Mt,Sheets:St};for(var kr={},Br=[],Yr=0;Yr<Sr.length;++Yr)St[Mt[Yr]]?(Br.push(Sr[Yr]||Mt[Yr]),kr[Sr[Yr]]=St[Sr[Yr]]||St[Mt[Yr]]):(Br.push(Sr[Yr]),kr[Sr[Yr]]={"!ref":"A1"});return{SheetNames:Br,Sheets:kr}}function n(_e,Ge){var qe=Ge||{};if(+qe.codepage>=0&&Pc(+qe.codepage),qe.type=="string")throw new Error("Cannot write WK1 to JS string");var Xe=ml(),yt=wi(_e["!ref"]),Dt=Array.isArray(_e),Yt=[];Nr(Xe,0,u(1030)),Nr(Xe,6,v(yt));for(var St=Math.min(yt.e.r,8191),Mt=yt.s.r;Mt<=St;++Mt)for(var Sr=Qa(Mt),Ne=yt.s.c;Ne<=yt.e.c;++Ne){Mt===yt.s.r&&(Yt[Ne]=Oa(Ne));var un=Yt[Ne]+Sr,kr=Dt?(_e[Mt]||[])[Ne]:_e[un];if(!(!kr||kr.t=="z"))if(kr.t=="n")(kr.v|0)==kr.v&&kr.v>=-32768&&kr.v<=32767?Nr(Xe,13,O(Mt,Ne,kr.v)):Nr(Xe,14,R(Mt,Ne,kr.v));else{var Br=Ch(kr);Nr(Xe,15,C(Mt,Ne,Br.slice(0,239)))}}return Nr(Xe,1),Xe.end()}function o(_e,Ge){var qe=Ge||{};if(+qe.codepage>=0&&Pc(+qe.codepage),qe.type=="string")throw new Error("Cannot write WK3 to JS string");var Xe=ml();Nr(Xe,0,d(_e));for(var yt=0,Dt=0;yt<_e.SheetNames.length;++yt)(_e.Sheets[_e.SheetNames[yt]]||{})["!ref"]&&Nr(Xe,27,Ue(_e.SheetNames[yt],Dt++));var Yt=0;for(yt=0;yt<_e.SheetNames.length;++yt){var St=_e.Sheets[_e.SheetNames[yt]];if(!(!St||!St["!ref"])){for(var Mt=wi(St["!ref"]),Sr=Array.isArray(St),Ne=[],un=Math.min(Mt.e.r,8191),kr=Mt.s.r;kr<=un;++kr)for(var Br=Qa(kr),Yr=Mt.s.c;Yr<=Mt.e.c;++Yr){kr===Mt.s.r&&(Ne[Yr]=Oa(Yr));var Tr=Ne[Yr]+Br,jn=Sr?(St[kr]||[])[Yr]:St[Tr];if(!(!jn||jn.t=="z"))if(jn.t=="n")Nr(Xe,23,$e(kr,Yr,Yt,jn.v));else{var Un=Ch(jn);Nr(Xe,22,re(kr,Yr,Yt,Un.slice(0,239)))}}++Yt}}return Nr(Xe,1),Xe.end()}function u(_e){var Ge=rr(2);return Ge.write_shift(2,_e),Ge}function d(_e){var Ge=rr(26);Ge.write_shift(2,4096),Ge.write_shift(2,4),Ge.write_shift(4,0);for(var qe=0,Xe=0,yt=0,Dt=0;Dt<_e.SheetNames.length;++Dt){var Yt=_e.SheetNames[Dt],St=_e.Sheets[Yt];if(!(!St||!St["!ref"])){++yt;var Mt=tl(St["!ref"]);qe<Mt.e.r&&(qe=Mt.e.r),Xe<Mt.e.c&&(Xe=Mt.e.c)}}return qe>8191&&(qe=8191),Ge.write_shift(2,qe),Ge.write_shift(1,yt),Ge.write_shift(1,Xe),Ge.write_shift(2,0),Ge.write_shift(2,0),Ge.write_shift(1,1),Ge.write_shift(1,2),Ge.write_shift(4,0),Ge.write_shift(4,0),Ge}function i(_e,Ge,qe){var Xe={s:{c:0,r:0},e:{c:0,r:0}};return Ge==8&&qe.qpro?(Xe.s.c=_e.read_shift(1),_e.l++,Xe.s.r=_e.read_shift(2),Xe.e.c=_e.read_shift(1),_e.l++,Xe.e.r=_e.read_shift(2),Xe):(Xe.s.c=_e.read_shift(2),Xe.s.r=_e.read_shift(2),Ge==12&&qe.qpro&&(_e.l+=2),Xe.e.c=_e.read_shift(2),Xe.e.r=_e.read_shift(2),Ge==12&&qe.qpro&&(_e.l+=2),Xe.s.c==65535&&(Xe.s.c=Xe.e.c=Xe.s.r=Xe.e.r=0),Xe)}function v(_e){var Ge=rr(8);return Ge.write_shift(2,_e.s.c),Ge.write_shift(2,_e.s.r),Ge.write_shift(2,_e.e.c),Ge.write_shift(2,_e.e.r),Ge}function w(_e,Ge,qe){var Xe=[{c:0,r:0},{t:"n",v:0},0,0];return qe.qpro&&qe.vers!=20768?(Xe[0].c=_e.read_shift(1),Xe[3]=_e.read_shift(1),Xe[0].r=_e.read_shift(2),_e.l+=2):(Xe[2]=_e.read_shift(1),Xe[0].c=_e.read_shift(2),Xe[0].r=_e.read_shift(2)),Xe}function S(_e,Ge,qe){var Xe=_e.l+Ge,yt=w(_e,Ge,qe);if(yt[1].t="s",qe.vers==20768){_e.l++;var Dt=_e.read_shift(1);return yt[1].v=_e.read_shift(Dt,"utf8"),yt}return qe.qpro&&_e.l++,yt[1].v=_e.read_shift(Xe-_e.l,"cstr"),yt}function C(_e,Ge,qe){var Xe=rr(7+qe.length);Xe.write_shift(1,255),Xe.write_shift(2,Ge),Xe.write_shift(2,_e),Xe.write_shift(1,39);for(var yt=0;yt<Xe.length;++yt){var Dt=qe.charCodeAt(yt);Xe.write_shift(1,Dt>=128?95:Dt)}return Xe.write_shift(1,0),Xe}function k(_e,Ge,qe){var Xe=w(_e,Ge,qe);return Xe[1].v=_e.read_shift(2,"i"),Xe}function O(_e,Ge,qe){var Xe=rr(7);return Xe.write_shift(1,255),Xe.write_shift(2,Ge),Xe.write_shift(2,_e),Xe.write_shift(2,qe,"i"),Xe}function L(_e,Ge,qe){var Xe=w(_e,Ge,qe);return Xe[1].v=_e.read_shift(8,"f"),Xe}function R(_e,Ge,qe){var Xe=rr(13);return Xe.write_shift(1,255),Xe.write_shift(2,Ge),Xe.write_shift(2,_e),Xe.write_shift(8,qe,"f"),Xe}function N(_e,Ge,qe){var Xe=_e.l+Ge,yt=w(_e,Ge,qe);if(yt[1].v=_e.read_shift(8,"f"),qe.qpro)_e.l=Xe;else{var Dt=_e.read_shift(2);J(_e.slice(_e.l,_e.l+Dt),yt),_e.l+=Dt}return yt}function V(_e,Ge,qe){var Xe=Ge&32768;return Ge&=-32769,Ge=(Xe?_e:0)+(Ge>=8192?Ge-16384:Ge),(Xe?"":"$")+(qe?Oa(Ge):Qa(Ge))}var G={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},U=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function J(_e,Ge){ss(_e,0);for(var qe=[],Xe=0,yt="",Dt="",Yt="",St="";_e.l<_e.length;){var Mt=_e[_e.l++];switch(Mt){case 0:qe.push(_e.read_shift(8,"f"));break;case 1:Dt=V(Ge[0].c,_e.read_shift(2),!0),yt=V(Ge[0].r,_e.read_shift(2),!1),qe.push(Dt+yt);break;case 2:{var Sr=V(Ge[0].c,_e.read_shift(2),!0),Ne=V(Ge[0].r,_e.read_shift(2),!1);Dt=V(Ge[0].c,_e.read_shift(2),!0),yt=V(Ge[0].r,_e.read_shift(2),!1),qe.push(Sr+Ne+":"+Dt+yt)}break;case 3:if(_e.l<_e.length){console.error("WK1 premature formula end");return}break;case 4:qe.push("("+qe.pop()+")");break;case 5:qe.push(_e.read_shift(2));break;case 6:{for(var un="";Mt=_e[_e.l++];)un+=String.fromCharCode(Mt);qe.push('"'+un.replace(/"/g,'""')+'"')}break;case 8:qe.push("-"+qe.pop());break;case 23:qe.push("+"+qe.pop());break;case 22:qe.push("NOT("+qe.pop()+")");break;case 20:case 21:St=qe.pop(),Yt=qe.pop(),qe.push(["AND","OR"][Mt-20]+"("+Yt+","+St+")");break;default:if(Mt<32&&U[Mt])St=qe.pop(),Yt=qe.pop(),qe.push(Yt+U[Mt]+St);else if(G[Mt]){if(Xe=G[Mt][1],Xe==69&&(Xe=_e[_e.l++]),Xe>qe.length){console.error("WK1 bad formula parse 0x"+Mt.toString(16)+":|"+qe.join("|")+"|");return}var kr=qe.slice(-Xe);qe.length-=Xe,qe.push(G[Mt][0]+"("+kr.join(",")+")")}else return Mt<=7?console.error("WK1 invalid opcode "+Mt.toString(16)):Mt<=24?console.error("WK1 unsupported op "+Mt.toString(16)):Mt<=30?console.error("WK1 invalid opcode "+Mt.toString(16)):Mt<=115?console.error("WK1 unsupported function opcode "+Mt.toString(16)):console.error("WK1 unrecognized opcode "+Mt.toString(16))}}qe.length==1?Ge[1].f=""+qe[0]:console.error("WK1 bad formula parse |"+qe.join("|")+"|")}function Z(_e){var Ge=[{c:0,r:0},{t:"n",v:0},0];return Ge[0].r=_e.read_shift(2),Ge[3]=_e[_e.l++],Ge[0].c=_e[_e.l++],Ge}function K(_e,Ge){var qe=Z(_e);return qe[1].t="s",qe[1].v=_e.read_shift(Ge-4,"cstr"),qe}function re(_e,Ge,qe,Xe){var yt=rr(6+Xe.length);yt.write_shift(2,_e),yt.write_shift(1,qe),yt.write_shift(1,Ge),yt.write_shift(1,39);for(var Dt=0;Dt<Xe.length;++Dt){var Yt=Xe.charCodeAt(Dt);yt.write_shift(1,Yt>=128?95:Yt)}return yt.write_shift(1,0),yt}function ge(_e,Ge){var qe=Z(_e);qe[1].v=_e.read_shift(2);var Xe=qe[1].v>>1;if(qe[1].v&1)switch(Xe&7){case 0:Xe=(Xe>>3)*5e3;break;case 1:Xe=(Xe>>3)*500;break;case 2:Xe=(Xe>>3)/20;break;case 3:Xe=(Xe>>3)/200;break;case 4:Xe=(Xe>>3)/2e3;break;case 5:Xe=(Xe>>3)/2e4;break;case 6:Xe=(Xe>>3)/16;break;case 7:Xe=(Xe>>3)/64;break}return qe[1].v=Xe,qe}function ve(_e,Ge){var qe=Z(_e),Xe=_e.read_shift(4),yt=_e.read_shift(4),Dt=_e.read_shift(2);if(Dt==65535)return Xe===0&&yt===3221225472?(qe[1].t="e",qe[1].v=15):Xe===0&&yt===3489660928?(qe[1].t="e",qe[1].v=42):qe[1].v=0,qe;var Yt=Dt&32768;return Dt=(Dt&32767)-16446,qe[1].v=(1-Yt*2)*(yt*Math.pow(2,Dt+32)+Xe*Math.pow(2,Dt)),qe}function $e(_e,Ge,qe,Xe){var yt=rr(14);if(yt.write_shift(2,_e),yt.write_shift(1,qe),yt.write_shift(1,Ge),Xe==0)return yt.write_shift(4,0),yt.write_shift(4,0),yt.write_shift(2,65535),yt;var Dt=0,Yt=0,St=0,Mt=0;return Xe<0&&(Dt=1,Xe=-Xe),Yt=Math.log2(Xe)|0,Xe/=Math.pow(2,Yt-31),Mt=Xe>>>0,Mt&2147483648||(Xe/=2,++Yt,Mt=Xe>>>0),Xe-=Mt,Mt|=2147483648,Mt>>>=0,Xe*=Math.pow(2,32),St=Xe>>>0,yt.write_shift(4,St),yt.write_shift(4,Mt),Yt+=16383+(Dt?32768:0),yt.write_shift(2,Yt),yt}function Ie(_e,Ge){var qe=ve(_e);return _e.l+=Ge-14,qe}function ke(_e,Ge){var qe=Z(_e),Xe=_e.read_shift(4);return qe[1].v=Xe>>6,qe}function tt(_e,Ge){var qe=Z(_e),Xe=_e.read_shift(8,"f");return qe[1].v=Xe,qe}function Je(_e,Ge){var qe=tt(_e);return _e.l+=Ge-10,qe}function et(_e,Ge){return _e[_e.l+Ge-1]==0?_e.read_shift(Ge,"cstr"):""}function at(_e,Ge){var qe=_e[_e.l++];qe>Ge-1&&(qe=Ge-1);for(var Xe="";Xe.length<qe;)Xe+=String.fromCharCode(_e[_e.l++]);return Xe}function pt(_e,Ge,qe){if(!(!qe.qpro||Ge<21)){var Xe=_e.read_shift(1);_e.l+=17,_e.l+=1,_e.l+=2;var yt=_e.read_shift(Ge-21,"cstr");return[Xe,yt]}}function ft(_e,Ge){for(var qe={},Xe=_e.l+Ge;_e.l<Xe;){var yt=_e.read_shift(2);if(yt==14e3){for(qe[yt]=[0,""],qe[yt][0]=_e.read_shift(2);_e[_e.l];)qe[yt][1]+=String.fromCharCode(_e[_e.l]),_e.l++;_e.l++}}return qe}function Ue(_e,Ge){var qe=rr(5+_e.length);qe.write_shift(2,14e3),qe.write_shift(2,Ge);for(var Xe=0;Xe<_e.length;++Xe){var yt=_e.charCodeAt(Xe);qe[qe.l++]=yt>127?95:yt}return qe[qe.l++]=0,qe}var It={0:{n:"BOF",f:yo},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:i},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:k},14:{n:"NUMBER",f:L},15:{n:"LABEL",f:S},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:S},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:et},222:{n:"SHEETNAMELP",f:at},65535:{n:""}},Rt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:ve},24:{n:"NUMBER18",f:ge},25:{n:"FORMULA19",f:Ie},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ft},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ke},38:{n:"??"},39:{n:"NUMBER27",f:tt},40:{n:"FORMULA28",f:Je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:et},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:o,to_workbook:t}}();function L_e(e){var t={},r=e.match(Fs),n=0,o=!1;if(r)for(;n!=r.length;++n){var u=kn(r[n]);switch(u[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!u.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(u.val=="1")break;t.cp=x4[parseInt(u.val,10)];break;case"<outline":if(!u.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=u.val;break;case"<sz":t.sz=u.val;break;case"<strike":if(!u.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!u.val)break;switch(u.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(u.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(u.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":u.rgb&&(t.color=u.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=u.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=u.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(u[0].charCodeAt(1)!==47&&!o)throw new Error("Unrecognized rich format "+u[0])}}return t}var N_e=function(){var e=tb("t"),t=tb("rPr");function r(u){var d=u.match(e);if(!d)return{t:"s",v:""};var i={t:"s",v:Ri(d[1])},v=u.match(t);return v&&(i.s=L_e(v[1])),i}var n=/<(?:\w+:)?r>/g,o=/<\/(?:\w+:)?r>/;return function(d){return d.replace(n,"").split(o).map(r).filter(function(i){return i.v})}}(),B_e=function(){var t=/(\r\n|\n)/g;function r(o,u,d){var i=[];o.u&&i.push("text-decoration: underline;"),o.uval&&i.push("text-underline-style:"+o.uval+";"),o.sz&&i.push("font-size:"+o.sz+"pt;"),o.outline&&i.push("text-effect: outline;"),o.shadow&&i.push("text-shadow: auto;"),u.push('<span style="'+i.join("")+'">'),o.b&&(u.push("<b>"),d.push("</b>")),o.i&&(u.push("<i>"),d.push("</i>")),o.strike&&(u.push("<s>"),d.push("</s>"));var v=o.valign||"";return v=="superscript"||v=="super"?v="sup":v=="subscript"&&(v="sub"),v!=""&&(u.push("<"+v+">"),d.push("</"+v+">")),d.push("</span>"),o}function n(o){var u=[[],o.v,[]];return o.v?(o.s&&r(o.s,u[0],u[2]),u[0].join("")+u[1].replace(t,"<br/>")+u[2].join("")):""}return function(u){return u.map(n).join("")}}(),z_e=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,j_e=/<(?:\w+:)?r>/,U_e=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function H4(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ri(la(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=la(e),r&&(n.h=P4(n.t))):e.match(j_e)&&(n.r=la(e),n.t=Ri(la((e.replace(U_e,"").match(z_e)||[]).join("").replace(Fs,""))),r&&(n.h=B_e(N_e(n.r)))),n):{t:""}}var $_e=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,V_e=/<(?:\w+:)?(?:si|sstItem)>/g,W_e=/<\/(?:\w+:)?(?:si|sstItem)>/;function G_e(e,t){var r=[],n="";if(!e)return r;var o=e.match($_e);if(o){n=o[2].replace(V_e,"").split(W_e);for(var u=0;u!=n.length;++u){var d=H4(n[u].trim(),t);d!=null&&(r[r.length]=d)}o=kn(o[1]),r.Count=o.count,r.Unique=o.uniqueCount}return r}var H_e=/^\s|\s$|[\t\n\r]/;function cY(e,t){if(!t.bookSST)return"";var r=[co];r[r.length]=Fr("sst",null,{xmlns:L0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var o=e[n],u="<si>";o.r?u+=o.r:(u+="<t",o.t||(o.t=""),o.t.match(H_e)&&(u+=' xml:space="preserve"'),u+=">"+Ki(o.t)+"</t>"),u+="</si>",r[r.length]=u}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function q_e(e){return[e.read_shift(4),e.read_shift(4)]}function X_e(e,t){var r=[],n=!1;return Uf(e,function(u,d,i){switch(i){case 159:r.Count=u[0],r.Unique=u[1];break;case 19:r.push(u);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(d.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),r}function Z_e(e,t){return t||(t=rr(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Y_e=o0e;function K_e(e){var t=ml();yr(t,159,Z_e(e));for(var r=0;r<e.length;++r)yr(t,19,Y_e(e[r]));return yr(t,160),t.end()}function uY(e){if(typeof Pi<"u")return Pi.utils.encode(x0,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Sf(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function J_e(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Sf(e,4),t.U=Sf(e,4),t.W=Sf(e,4),t}function Q_e(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},o=e.read_shift(4),u=[];o-- >0;)u.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=u,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function eye(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Q_e(e));return t}function tye(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function rye(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Sf(e,4),t.U=Sf(e,4),t.W=Sf(e,4),t}function nye(e){var t=rye(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function hY(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var o=!1;switch(n.AlgID){case 26126:case 26127:case 26128:o=n.Flags==36;break;case 26625:o=n.Flags==4;break;case 0:o=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!o)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function fY(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function iye(e){var t=Sf(e);switch(t.Minor){case 2:return[t.Minor,aye(e)];case 3:return[t.Minor,oye()];case 4:return[t.Minor,sye(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function aye(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=hY(e,r),o=fY(e,e.length-e.l);return{t:"Std",h:n,v:o}}function oye(){throw new Error("File is password-protected: ECMA-376 Extensible")}function sye(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Fs,function(u){var d=kn(u);switch(Oh(d[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(i){n[i]=d[i]});break;case"<dataIntegrity":n.encryptedHmacKey=d.encryptedHmacKey,n.encryptedHmacValue=d.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=d.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(d);break;default:throw d[0]}}),n}function lye(e,t){var r={},n=r.EncryptionVersionInfo=Sf(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var o=e.read_shift(4);return t-=4,r.EncryptionHeader=hY(e,o),t-=o,r.EncryptionVerifier=fY(e,t),r}function cye(e){var t={},r=t.EncryptionVersionInfo=Sf(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function q4(e){var t=0,r,n=uY(e),o=n.length+1,u,d,i,v,w;for(r=Ap(o),r[0]=n.length,u=1;u!=o;++u)r[u]=n[u-1];for(u=o-1;u>=0;--u)d=r[u],i=t&16384?1:0,v=t<<1&32767,w=i|v,t=w^d;return t^52811}var dY=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(d){return(d/2|d*128)&255},o=function(d,i){return n(d^i)},u=function(d){for(var i=t[d.length-1],v=104,w=d.length-1;w>=0;--w)for(var S=d[w],C=0;C!=7;++C)S&64&&(i^=r[v]),S*=2,--v;return i};return function(d){for(var i=uY(d),v=u(i),w=i.length,S=Ap(16),C=0;C!=16;++C)S[C]=0;var k,O,L;for((w&1)===1&&(k=v>>8,S[w]=o(e[0],k),--w,k=v&255,O=i[i.length-1],S[w]=o(O,k));w>0;)--w,k=v>>8,S[w]=o(i[w],k),--w,k=v&255,S[w]=o(i[w],k);for(w=15,L=15-i.length;L>0;)k=v>>8,S[w]=o(e[L],k),--w,--L,k=v&255,S[w]=o(i[w],k),--w,--L;return S}}(),uye=function(e,t,r,n,o){o||(o=t),n||(n=dY(e));var u,d;for(u=0;u!=t.length;++u)d=t[u],d^=n[r],d=(d>>5|d<<3)&255,o[u]=d,++r;return[o,r,n]},hye=function(e){var t=0,r=dY(e);return function(n){var o=uye("",n,t,r);return t=o[1],o[0]}};function fye(e,t,r,n){var o={key:yo(e),verificationBytes:yo(e)};return r.password&&(o.verifier=q4(r.password)),n.valid=o.verificationBytes===o.verifier,n.valid&&(n.insitu=hye(r.password)),o}function dye(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=cye(e):n.Data=lye(e,t),n}function pye(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?dye(e,t-2,n):fye(e,r.biff>=8?t:t-2,r,n),n}var pY=function(){function e(o,u){switch(u.type){case"base64":return t(Yl(o),u);case"binary":return t(o,u);case"buffer":return t(oi&&Buffer.isBuffer(o)?o.toString("binary"):Fp(o),u);case"array":return t(b0(o),u)}throw new Error("Unrecognized type "+u.type)}function t(o,u){var d=u||{},i=d.dense?[]:{},v=o.match(/\\trowd.*?\\row\b/g);if(!v.length)throw new Error("RTF missing table");var w={s:{c:0,r:0},e:{c:0,r:v.length-1}};return v.forEach(function(S,C){Array.isArray(i)&&(i[C]=[]);for(var k=/\\\w+\b/g,O=0,L,R=-1;L=k.exec(S);){switch(L[0]){case"\\cell":var N=S.slice(O,k.lastIndex-L[0].length);if(N[0]==" "&&(N=N.slice(1)),++R,N.length){var V={v:N,t:"s"};Array.isArray(i)?i[C][R]=V:i[Pn({r:C,c:R})]=V}break}O=k.lastIndex}R>w.e.c&&(w.e.c=R)}),i["!ref"]=Hn(w),i}function r(o,u){return Lp(e(o,u),u)}function n(o){for(var u=["{\\rtf1\\ansi"],d=wi(o["!ref"]),i,v=Array.isArray(o),w=d.s.r;w<=d.e.r;++w){u.push("\\trowd\\trautofit1");for(var S=d.s.c;S<=d.e.c;++S)u.push("\\cellx"+(S+1));for(u.push("\\pard\\intbl"),S=d.s.c;S<=d.e.c;++S){var C=Pn({r:w,c:S});i=v?(o[w]||[])[S]:o[C],!(!i||i.v==null&&(!i.f||i.F))&&(u.push(" "+(i.w||(Ch(i),i.w))),u.push("\\cell"))}u.push("\\pard\\intbl\\row")}return u.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function mye(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ab(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function gye(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,o=Math.max(t,r,n),u=Math.min(t,r,n),d=o-u;if(d===0)return[0,0,t];var i=0,v=0,w=o+u;switch(v=d/(w>1?2-w:w),o){case t:i=((r-n)/d+6)%6;break;case r:i=(n-t)/d+2;break;case n:i=(t-r)/d+4;break}return[i/6,v,w/2]}function _ye(e){var t=e[0],r=e[1],n=e[2],o=r*2*(n<.5?n:1-n),u=n-o/2,d=[u,u,u],i=6*t,v;if(r!==0)switch(i|0){case 0:case 6:v=o*i,d[0]+=o,d[1]+=v;break;case 1:v=o*(2-i),d[0]+=v,d[1]+=o;break;case 2:v=o*(i-2),d[1]+=o,d[2]+=v;break;case 3:v=o*(4-i),d[1]+=v,d[2]+=o;break;case 4:v=o*(i-4),d[2]+=o,d[0]+=v;break;case 5:v=o*(6-i),d[2]+=v,d[0]+=o;break}for(var w=0;w!=3;++w)d[w]=Math.round(d[w]*255);return d}function IA(e,t){if(t===0)return e;var r=gye(mye(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ab(_ye(r))}var mY=6,yye=15,vye=1,Cs=mY;function ob(e){return Math.floor((e+Math.round(128/Cs)/256)*Cs)}function sb(e){return Math.floor((e-5)/Cs*100+.5)/100}function kA(e){return Math.round((e*Cs+5)/Cs*256)/256}function dM(e){return kA(sb(ob(e)))}function X4(e){var t=Math.abs(e-dM(e)),r=Cs;if(t>.005)for(Cs=vye;Cs<yye;++Cs)Math.abs(e-dM(e))<=t&&(t=Math.abs(e-dM(e)),r=Cs);Cs=r}function Cp(e){e.width?(e.wpx=ob(e.width),e.wch=sb(e.wpx),e.MDW=Cs):e.wpx?(e.wch=sb(e.wpx),e.width=kA(e.wch),e.MDW=Cs):typeof e.wch=="number"&&(e.width=kA(e.wch),e.wpx=ob(e.width),e.MDW=Cs),e.customWidth&&delete e.customWidth}var xye=96,gY=xye;function lb(e){return e*96/gY}function Uy(e){return e*gY/96}var wye={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bye(e,t,r,n){t.Borders=[];var o={},u=!1;(e[0].match(Fs)||[]).forEach(function(d){var i=kn(d);switch(Oh(i[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":o={},i.diagonalUp&&(o.diagonalUp=Ia(i.diagonalUp)),i.diagonalDown&&(o.diagonalDown=Ia(i.diagonalDown)),t.Borders.push(o);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(n&&n.WTF&&!u)throw new Error("unrecognized "+i[0]+" in borders")}})}function Tye(e,t,r,n){t.Fills=[];var o={},u=!1;(e[0].match(Fs)||[]).forEach(function(d){var i=kn(d);switch(Oh(i[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":o={},t.Fills.push(o);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(o),o={};break;case"<patternFill":case"<patternFill>":i.patternType&&(o.patternType=i.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":o.bgColor||(o.bgColor={}),i.indexed&&(o.bgColor.indexed=parseInt(i.indexed,10)),i.theme&&(o.bgColor.theme=parseInt(i.theme,10)),i.tint&&(o.bgColor.tint=parseFloat(i.tint)),i.rgb&&(o.bgColor.rgb=i.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":o.fgColor||(o.fgColor={}),i.theme&&(o.fgColor.theme=parseInt(i.theme,10)),i.tint&&(o.fgColor.tint=parseFloat(i.tint)),i.rgb!=null&&(o.fgColor.rgb=i.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(n&&n.WTF&&!u)throw new Error("unrecognized "+i[0]+" in fills")}})}function Sye(e,t,r,n){t.Fonts=[];var o={},u=!1;(e[0].match(Fs)||[]).forEach(function(d){var i=kn(d);switch(Oh(i[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(o),o={};break;case"<name":i.val&&(o.name=la(i.val));break;case"<name/>":case"</name>":break;case"<b":o.bold=i.val?Ia(i.val):1;break;case"<b/>":o.bold=1;break;case"<i":o.italic=i.val?Ia(i.val):1;break;case"<i/>":o.italic=1;break;case"<u":switch(i.val){case"none":o.underline=0;break;case"single":o.underline=1;break;case"double":o.underline=2;break;case"singleAccounting":o.underline=33;break;case"doubleAccounting":o.underline=34;break}break;case"<u/>":o.underline=1;break;case"<strike":o.strike=i.val?Ia(i.val):1;break;case"<strike/>":o.strike=1;break;case"<outline":o.outline=i.val?Ia(i.val):1;break;case"<outline/>":o.outline=1;break;case"<shadow":o.shadow=i.val?Ia(i.val):1;break;case"<shadow/>":o.shadow=1;break;case"<condense":o.condense=i.val?Ia(i.val):1;break;case"<condense/>":o.condense=1;break;case"<extend":o.extend=i.val?Ia(i.val):1;break;case"<extend/>":o.extend=1;break;case"<sz":i.val&&(o.sz=+i.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":i.val&&(o.vertAlign=i.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":i.val&&(o.family=parseInt(i.val,10));break;case"<family/>":case"</family>":break;case"<scheme":i.val&&(o.scheme=i.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(i.val=="1")break;i.codepage=x4[parseInt(i.val,10)];break;case"<color":if(o.color||(o.color={}),i.auto&&(o.color.auto=Ia(i.auto)),i.rgb)o.color.rgb=i.rgb.slice(-6);else if(i.indexed){o.color.index=parseInt(i.indexed,10);var v=n0[o.color.index];o.color.index==81&&(v=n0[1]),v||(v=n0[1]),o.color.rgb=v[0].toString(16)+v[1].toString(16)+v[2].toString(16)}else i.theme&&(o.color.theme=parseInt(i.theme,10),i.tint&&(o.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(o.color.rgb=IA(r.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":u=!0;break;case"</AlternateContent>":u=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(n&&n.WTF&&!u)throw new Error("unrecognized "+i[0]+" in fonts")}})}function Eye(e,t,r){t.NumberFmt=[];for(var n=to(xn),o=0;o<n.length;++o)t.NumberFmt[n[o]]=xn[n[o]];var u=e[0].match(Fs);if(u)for(o=0;o<u.length;++o){var d=kn(u[o]);switch(Oh(d[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var i=Ri(la(d.formatCode)),v=parseInt(d.numFmtId,10);if(t.NumberFmt[v]=i,v>0){if(v>392){for(v=392;v>60&&t.NumberFmt[v]!=null;--v);t.NumberFmt[v]=i}wh(i,v)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+d[0]+" in numFmts")}}}function Aye(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Fr("numFmt",null,{numFmtId:n,formatCode:Ki(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Fr("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var rE=["numFmtId","fillId","fontId","borderId","xfId"],nE=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Cye(e,t,r){t.CellXf=[];var n,o=!1;(e[0].match(Fs)||[]).forEach(function(u){var d=kn(u),i=0;switch(Oh(d[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=d,delete n[0],i=0;i<rE.length;++i)n[rE[i]]&&(n[rE[i]]=parseInt(n[rE[i]],10));for(i=0;i<nE.length;++i)n[nE[i]]&&(n[nE[i]]=Ia(n[nE[i]]));if(t.NumberFmt&&n.numFmtId>392){for(i=392;i>60;--i)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[i]){n.numFmtId=i;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var v={};d.vertical&&(v.vertical=d.vertical),d.horizontal&&(v.horizontal=d.horizontal),d.textRotation!=null&&(v.textRotation=d.textRotation),d.indent&&(v.indent=d.indent),d.wrapText&&(v.wrapText=Ia(d.wrapText)),n.alignment=v;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+d[0]+" in cellXfs")}})}function Pye(e){var t=[];return t[t.length]=Fr("cellXfs",null),e.forEach(function(r){t[t.length]=Fr("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Fr("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Iye=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,o=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,u=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,v,w){var S={};if(!i)return S;i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var C;return(C=i.match(t))&&Eye(C,S,w),(C=i.match(o))&&Sye(C,S,v,w),(C=i.match(n))&&Tye(C,S,v,w),(C=i.match(u))&&bye(C,S,v,w),(C=i.match(r))&&Cye(C,S,w),S}}();function _Y(e,t){var r=[co,Fr("styleSheet",null,{xmlns:L0[0],"xmlns:vt":Ro.vt})],n;return e.SSF&&(n=Aye(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Pye(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function kye(e,t){var r=e.read_shift(2),n=Ms(e);return[r,n]}function Oye(e,t,r){r||(r=rr(6+4*t.length)),r.write_shift(2,e),Ko(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Mye(e,t,r){var n={};n.sz=e.read_shift(2)/20;var o=d0e(e);o.fItalic&&(n.italic=1),o.fCondense&&(n.condense=1),o.fExtend&&(n.extend=1),o.fShadow&&(n.shadow=1),o.fOutline&&(n.outline=1),o.fStrikeout&&(n.strike=1);var u=e.read_shift(2);switch(u===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(n.underline=d);var i=e.read_shift(1);i>0&&(n.family=i);var v=e.read_shift(1);switch(v>0&&(n.charset=v),e.l++,n.color=f0e(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ms(e),n}function Rye(e,t){t||(t=rr(25+4*32)),t.write_shift(2,e.sz*20),p0e(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),AA(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Ko(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Dye=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],pM,Fye=Ds;function pU(e,t){t||(t=rr(4*3+8*7+16*1)),pM||(pM=yP(Dye));var r=pM[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(AA({auto:1},t),AA({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Lye(e,t){var r=e.l+t,n=e.read_shift(2),o=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:o}}function yY(e,t,r){r||(r=rr(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function B1(e,t){return t||(t=rr(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Nye=Ds;function Bye(e,t){return t||(t=rr(51)),t.write_shift(1,0),B1(null,t),B1(null,t),B1(null,t),B1(null,t),B1(null,t),t.length>t.l?t.slice(0,t.l):t}function zye(e,t){return t||(t=rr(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),EA(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function jye(e,t,r){var n=rr(2052);return n.write_shift(4,e),EA(t,n),EA(r,n),n.length>n.l?n.slice(0,n.l):n}function Uye(e,t,r){var n={};n.NumberFmt=[];for(var o in xn)n.NumberFmt[o]=xn[o];n.CellXf=[],n.Fonts=[];var u=[],d=!1;return Uf(e,function(v,w,S){switch(S){case 44:n.NumberFmt[v[0]]=v[1],wh(v[1],v[0]);break;case 43:n.Fonts.push(v),v.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(v.color.rgb=IA(t.themeElements.clrScheme[v.color.theme].rgb,v.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:u[u.length-1]==617&&n.CellXf.push(v);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:u.push(S),d=!0;break;case 38:u.pop(),d=!1;break;default:if(w.T>0)u.push(S);else if(w.T<0)u.pop();else if(!d||r.WTF&&u[u.length-1]!=37)throw new Error("Unexpected record 0x"+S.toString(16))}}),n}function $ye(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var o=n[0];o<=n[1];++o)t[o]!=null&&++r}),r!=0&&(yr(e,615,bu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var o=n[0];o<=n[1];++o)t[o]!=null&&yr(e,44,Oye(o,t[o]))}),yr(e,616))}}function Vye(e){var t=1;yr(e,611,bu(t)),yr(e,43,Rye({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),yr(e,612)}function Wye(e){var t=2;yr(e,603,bu(t)),yr(e,45,pU({patternType:"none"})),yr(e,45,pU({patternType:"gray125"})),yr(e,604)}function Gye(e){var t=1;yr(e,613,bu(t)),yr(e,46,Bye()),yr(e,614)}function Hye(e){var t=1;yr(e,626,bu(t)),yr(e,47,yY({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),yr(e,627)}function qye(e,t){yr(e,617,bu(t.length)),t.forEach(function(r){yr(e,47,yY(r,0))}),yr(e,618)}function Xye(e){var t=1;yr(e,619,bu(t)),yr(e,48,zye({xfId:0,builtinId:0,name:"Normal"})),yr(e,620)}function Zye(e){var t=0;yr(e,505,bu(t)),yr(e,506)}function Yye(e){var t=0;yr(e,508,jye(t,"TableStyleMedium9","PivotStyleMedium4")),yr(e,509)}function Kye(e,t){var r=ml();return yr(r,278),$ye(r,e.SSF),Vye(r),Wye(r),Gye(r),Hye(r),qye(r,t.cellXfs),Xye(r),Zye(r),Yye(r),yr(r,279),r.end()}var Jye=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Qye(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Fs)||[]).forEach(function(o){var u=kn(o);switch(u[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=u.val;break;case"<a:sysClr":n.rgb=u.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":u[0].charAt(1)==="/"?(t.themeElements.clrScheme[Jye.indexOf(u[0])]=n,n={}):n.name=u[0].slice(3,u[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+u[0]+" in clrScheme")}})}function eve(){}function tve(){}var rve=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nve=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ive=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ave(e,t,r){t.themeElements={};var n;[["clrScheme",rve,Qye],["fontScheme",nve,eve],["fmtScheme",ive,tve]].forEach(function(o){if(!(n=e.match(o[1])))throw new Error(o[0]+" not found in themeElements");o[2](n,t,r)})}var ove=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function vY(e,t){(!e||e.length===0)&&(e=Z4());var r,n={};if(!(r=e.match(ove)))throw new Error("themeElements not found in theme");return ave(r[0],n,t),n.raw=e,n}function Z4(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[co];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sve(e,t,r){var n=e.l+t,o=e.read_shift(4);if(o!==124226){if(!r.cellStyles){e.l=n;return}var u=e.slice(e.l);e.l=n;var d;try{d=mZ(u,{type:"array"})}catch{return}var i=Vl(d,"theme/theme/theme1.xml",!0);if(i)return vY(i,r)}}function lve(e){return e.read_shift(4)}function cve(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=uve(e,4);break;case 2:t.xclrValue=JZ(e);break;case 3:t.xclrValue=lve(e);break;case 4:e.l+=4;break}return e.l+=8,t}function uve(e,t){return Ds(e,t)}function hve(e,t){return Ds(e,t)}function fve(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cve(e);break;case 6:n[1]=hve(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function dve(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var o=e.read_shift(2),u=[];o-- >0;)u.push(fve(e,r-e.l));return{ixfe:n,ext:u}}function pve(e,t){t.forEach(function(r){switch(r[0]){}})}function mve(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ms(e)}}function gve(e){var t=rr(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ko(e.name,t),t.slice(0,t.l)}function _ve(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function yve(e){var t=rr(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function vve(e,t){var r=rr(8+2*t.length);return r.write_shift(4,e),Ko(t,r),r.slice(0,r.l)}function xve(e){return e.l+=4,e.read_shift(4)!=0}function wve(e,t){var r=rr(8);return r.write_shift(4,e),r.write_shift(4,1),r}function bve(e,t,r){var n={Types:[],Cell:[],Value:[]},o=r||{},u=[],d=!1,i=2;return Uf(e,function(v,w,S){switch(S){case 335:n.Types.push({name:v.name});break;case 51:v.forEach(function(C){i==1?n.Cell.push({type:n.Types[C[0]-1].name,index:C[1]}):i==0&&n.Value.push({type:n.Types[C[0]-1].name,index:C[1]})});break;case 337:i=v?1:0;break;case 338:i=2;break;case 35:u.push(S),d=!0;break;case 36:u.pop(),d=!1;break;default:if(!w.T){if(!d||o.WTF&&u[u.length-1]!=35)throw new Error("Unexpected record 0x"+S.toString(16))}}}),n}function Tve(){var e=ml();return yr(e,332),yr(e,334,bu(1)),yr(e,335,gve({name:"XLDAPR",version:12e4,flags:3496657072})),yr(e,336),yr(e,339,vve(1,"XLDAPR")),yr(e,52),yr(e,35,bu(514)),yr(e,4096,bu(0)),yr(e,4097,wc(1)),yr(e,36),yr(e,53),yr(e,340),yr(e,337,wve(1)),yr(e,51,yve([[1,0]])),yr(e,338),yr(e,333),e.end()}function Sve(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var o=!1,u=2,d;return e.replace(Fs,function(i){var v=kn(i);switch(Oh(v[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:v.name});break;case"</metadataType>":break;case"<futureMetadata":for(var w=0;w<n.Types.length;++w)n.Types[w].name==v.name&&(d=n.Types[w]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":u==1?n.Cell.push({type:n.Types[v.t-1].name,index:+v.v}):u==0&&n.Value.push({type:n.Types[v.t-1].name,index:+v.v});break;case"</rc>":break;case"<cellMetadata":u=1;break;case"</cellMetadata>":u=2;break;case"<valueMetadata":u=0;break;case"</valueMetadata>":u=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!d)break;d.offsets||(d.offsets=[]),d.offsets.push(+v.i);break;default:if(!o&&r.WTF)throw new Error("unrecognized "+v[0]+" in metadata")}return i}),n}function xY(){var e=[co];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Eve(e){var t=[];if(!e)return t;var r=1;return(e.match(Fs)||[]).forEach(function(n){var o=kn(n);switch(o[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete o[0],o.i?r=o.i:o.i=r,t.push(o);break}}),t}function Ave(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Cve(e,t,r){var n=[];return Uf(e,function(u,d,i){switch(i){case 63:n.push(u);break;default:if(!d.T)throw new Error("Unexpected record 0x"+i.toString(16))}}),n}function Pve(e,t,r,n){if(!e)return e;var o=n||{},u=!1;Uf(e,function(i,v,w){switch(w){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:u=!0;break;case 36:u=!1;break;default:if(!v.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+w.toString(16))}}},o)}function Ive(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var J_=1024;function wY(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),o=[Fr("xml",null,{"xmlns:v":Ul.v,"xmlns:o":Ul.o,"xmlns:x":Ul.x,"xmlns:mv":Ul.mv}).replace(/\/>/,">"),Fr("o:shapelayout",Fr("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Fr("v:shapetype",[Fr("v:stroke",null,{joinstyle:"miter"}),Fr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];J_<e*1e3;)J_+=1e3;return t.forEach(function(u){var d=Va(u[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var v=i.type=="gradient"?Fr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,w=Fr("v:fill",v,i),S={on:"t",obscured:"t"};++J_,o=o.concat(["<v:shape"+rb({id:"_x0000_s"+J_,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(u[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",w,Fr("v:shadow",null,S),Fr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ls("x:Anchor",[d.c+1,0,d.r+1,0,d.c+3,20,d.r+5,20].join(",")),ls("x:AutoFill","False"),ls("x:Row",String(d.r)),ls("x:Column",String(d.c)),u[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function mU(e,t,r,n){var o=Array.isArray(e),u;t.forEach(function(d){var i=Va(d.ref);if(o?(e[i.r]||(e[i.r]=[]),u=e[i.r][i.c]):u=e[d.ref],!u){u={t:"z"},o?e[i.r][i.c]=u:e[d.ref]=u;var v=wi(e["!ref"]||"BDWGO1000001:A1");v.s.r>i.r&&(v.s.r=i.r),v.e.r<i.r&&(v.e.r=i.r),v.s.c>i.c&&(v.s.c=i.c),v.e.c<i.c&&(v.e.c=i.c);var w=Hn(v);w!==e["!ref"]&&(e["!ref"]=w)}u.c||(u.c=[]);var S={a:d.author,t:d.t,r:d.r,T:r};d.h&&(S.h=d.h);for(var C=u.c.length-1;C>=0;--C){if(!r&&u.c[C].T)return;r&&!u.c[C].T&&u.c.splice(C,1)}if(r&&n){for(C=0;C<n.length;++C)if(S.a==n[C].id){S.a=n[C].name||S.a;break}}u.c.push(S)})}function kve(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],o=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);o&&o[1]&&o[1].split(/<\/\w*:?author>/).forEach(function(d){if(!(d===""||d.trim()==="")){var i=d.match(/<(?:\w+:)?author[^>]*>(.*)/);i&&r.push(i[1])}});var u=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return u&&u[1]&&u[1].split(/<\/\w*:?comment>/).forEach(function(d){if(!(d===""||d.trim()==="")){var i=d.match(/<(?:\w+:)?comment[^>]*>/);if(i){var v=kn(i[0]),w={author:v.authorId&&r[v.authorId]||"sheetjsghost",ref:v.ref,guid:v.guid},S=Va(v.ref);if(!(t.sheetRows&&t.sheetRows<=S.r)){var C=d.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),k=!!C&&!!C[1]&&H4(C[1])||{r:"",t:"",h:""};w.r=k.r,k.r=="<t></t>"&&(k.t=k.h=""),w.t=(k.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(w.h=k.h),n.push(w)}}}}),n}function bY(e){var t=[co,Fr("comments",null,{xmlns:L0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(o){var u=Ki(o.a);r.indexOf(u)==-1&&(r.push(u),t.push("<author>"+u+"</author>")),o.T&&o.ID&&r.indexOf("tc="+o.ID)==-1&&(r.push("tc="+o.ID),t.push("<author>tc="+o.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var o=0,u=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?o=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(v){v.a&&(o=r.indexOf(Ki(v.a))),u.push(v.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+o+'"><text>'),u.length<=1)t.push(ls("t",Ki(u[0]||"")));else{for(var d=`Comment:
    `+u[0]+`
`,i=1;i<u.length;++i)d+=`Reply:
    `+u[i]+`
`;t.push(ls("t",Ki(d)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Ove(e,t){var r=[],n=!1,o={},u=0;return e.replace(Fs,function(i,v){var w=kn(i);switch(Oh(w[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":o={author:w.personId,guid:w.id,ref:w.ref,T:1};break;case"</threadedComment>":o.t!=null&&r.push(o);break;case"<text>":case"<text":u=v+i.length;break;case"</text>":o.t=e.slice(u,v).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+w[0]+" in threaded comments")}return i}),r}function Mve(e,t,r){var n=[co,Fr("ThreadedComments",null,{xmlns:Ro.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var u="";(o[1]||[]).forEach(function(d,i){if(!d.T){delete d.ID;return}d.a&&t.indexOf(d.a)==-1&&t.push(d.a);var v={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};i==0?u=v.id:v.parentId=u,d.ID=v.id,d.a&&(v.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(d.a)).slice(-12)+"}"),n.push(Fr("threadedComment",ls("text",d.t||""),v))})}),n.push("</ThreadedComments>"),n.join("")}function Rve(e,t){var r=[],n=!1;return e.replace(Fs,function(u){var d=kn(u);switch(Oh(d[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:d.displayname,id:d.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function Dve(e){var t=[co,Fr("personList",null,{xmlns:Ro.TCMNT,"xmlns:x":L0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Fr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Fve(e){var t={};t.iauthor=e.read_shift(4);var r=j0(e);return t.rfx=r.s,t.ref=Pn(r.s),e.l+=16,t}function Lve(e,t){return t==null&&(t=rr(36)),t.write_shift(4,e[1].iauthor),xv(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Nve=Ms;function Bve(e){return Ko(e.slice(0,54))}function zve(e,t){var r=[],n=[],o={},u=!1;return Uf(e,function(i,v,w){switch(w){case 632:n.push(i);break;case 635:o=i;break;case 637:o.t=i.t,o.h=i.h,o.r=i.r;break;case 636:if(o.author=n[o.iauthor],delete o.iauthor,t.sheetRows&&o.rfx&&t.sheetRows<=o.rfx.r)break;o.t||(o.t=""),delete o.rfx,r.push(o);break;case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!v.T){if(!u||t.WTF)throw new Error("Unexpected record 0x"+w.toString(16))}}}),r}function jve(e){var t=ml(),r=[];return yr(t,628),yr(t,630),e.forEach(function(n){n[1].forEach(function(o){r.indexOf(o.a)>-1||(r.push(o.a.slice(0,54)),yr(t,632,Bve(o.a)))})}),yr(t,631),yr(t,633),e.forEach(function(n){n[1].forEach(function(o){o.iauthor=r.indexOf(o.a);var u={s:Va(n[0]),e:Va(n[0])};yr(t,635,Lve([u,o])),o.t&&o.t.length>0&&yr(t,637,l0e(o)),yr(t,636),delete o.iauthor})}),yr(t,634),yr(t,629),t.end()}var Uve="application/vnd.ms-office.vbaProject";function $ve(e){var t=pn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var o=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pn.utils.cfb_add(t,o,e.FileIndex[n].content)}}),pn.write(t)}function Vve(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var o=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&pn.utils.cfb_add(e,o,t.FileIndex[n].content)}})}var TY=["xlsb","xlsm","xlam","biff8","xla"];function Wve(){return{"!type":"dialog"}}function Gve(){return{"!type":"dialog"}}function Hve(){return{"!type":"macro"}}function qve(){return{"!type":"macro"}}var py=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,o,u,d){var i=!1,v=!1;u.length==0?v=!0:u.charAt(0)=="["&&(v=!0,u=u.slice(1,-1)),d.length==0?i=!0:d.charAt(0)=="["&&(i=!0,d=d.slice(1,-1));var w=u.length>0?parseInt(u,10)|0:0,S=d.length>0?parseInt(d,10)|0:0;return i?S+=t.c:--S,v?w+=t.r:--w,o+(i?"":"$")+Oa(S)+(v?"":"$")+Qa(w)}return function(o,u){return t=u,o.replace(e,r)}}(),Y4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,K4=function(){return function(t,r){return t.replace(Y4,function(n,o,u,d,i,v){var w=N4(d)-(u?0:r.c),S=L4(v)-(i?0:r.r),C=S==0?"":i?S+1:"["+S+"]",k=w==0?"":u?w+1:"["+w+"]";return o+"R"+C+"C"+k})}}();function SY(e,t){return e.replace(Y4,function(r,n,o,u,d,i){return n+(o=="$"?o+u:Oa(N4(u)+t.c))+(d=="$"?d+i:Qa(L4(i)+t.r))})}function Xve(e,t,r){var n=tl(t),o=n.s,u=Va(r),d={r:u.r-o.r,c:u.c-o.c};return SY(e,d)}function Zve(e){return e.length!=1}function gU(e){return e.replace(/_xlfn\./g,"")}function go(e){e.l+=1}function Pp(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function EY(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return AY(e);r.biff==12&&(n=4)}var o=e.read_shift(n),u=e.read_shift(n),d=Pp(e),i=Pp(e);return{s:{r:o,c:d[0],cRel:d[1],rRel:d[2]},e:{r:u,c:i[0],cRel:i[1],rRel:i[2]}}}function AY(e){var t=Pp(e),r=Pp(e),n=e.read_shift(1),o=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:o,cRel:r[1],rRel:r[2]}}}function Yve(e,t,r){if(r.biff<8)return AY(e);var n=e.read_shift(r.biff==12?4:2),o=e.read_shift(r.biff==12?4:2),u=Pp(e),d=Pp(e);return{s:{r:n,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function CY(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Kve(e);var n=e.read_shift(r&&r.biff==12?4:2),o=Pp(e);return{r:n,c:o[0],cRel:o[1],rRel:o[2]}}function Kve(e){var t=Pp(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Jve(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Qve(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return exe(e);var o=e.read_shift(n>=12?4:2),u=e.read_shift(2),d=(u&16384)>>14,i=(u&32768)>>15;if(u&=16383,i==1)for(;o>524287;)o-=1048576;if(d==1)for(;u>8191;)u=u-16384;return{r:o,c:u,cRel:d,rRel:i}}function exe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,o=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),o==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:o,rRel:n}}function txe(e,t,r){var n=(e[e.l++]&96)>>5,o=EY(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,o]}function rxe(e,t,r){var n=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),u=8;if(r)switch(r.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}var d=EY(e,u,r);return[n,o,d]}function nxe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ixe(e,t,r){var n=(e[e.l++]&96)>>5,o=e.read_shift(2),u=8;if(r)switch(r.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}return e.l+=u,[n,o]}function axe(e,t,r){var n=(e[e.l++]&96)>>5,o=Yve(e,t-1,r);return[n,o]}function oxe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _U(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function sxe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),o=[],u=0;u<=n;++u)o.push(e.read_shift(r&&r.biff==2?1:2));return o}function lxe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cxe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function uxe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function hxe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function PY(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function fxe(e){return e.read_shift(2),PY(e)}function dxe(e){return e.read_shift(2),PY(e)}function pxe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var o=CY(e,0,r);return[n,o]}function mxe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var o=Qve(e,0,r);return[n,o]}function gxe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var u=CY(e,0,r);return[n,o,u]}function _xe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(r&&r.biff<=3?1:2);return[x1e[o],OY[o],n]}function yxe(e,t,r){var n=e[e.l++],o=e.read_shift(1),u=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:vxe(e);return[o,(u[0]===0?OY:v1e)[u[1]]]}function vxe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function xxe(e,t,r){e.l+=r&&r.biff==2?3:4}function wxe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),o=e.read_shift(r&&r.biff==2?1:2);return[n,o]}function bxe(e){return e.l++,$f[e.read_shift(1)]}function Txe(e){return e.l++,e.read_shift(2)}function Sxe(e){return e.l++,e.read_shift(1)!==0}function Exe(e){return e.l++,ks(e)}function Axe(e,t,r){return e.l++,d2(e,t-1,r)}function Cxe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=oo(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=$f[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ks(e);break;case 2:r[1]=U0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Pxe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),o=[],u=0;u!=n;++u)o.push((r.biff==12?j0:bP)(e));return o}function Ixe(e,t,r){var n=0,o=0;r.biff==12?(n=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--o==0&&(o=256));for(var u=0,d=[];u!=n&&(d[u]=[]);++u)for(var i=0;i!=o;++i)d[u][i]=Cxe(e,r.biff);return d}function kxe(e,t,r){var n=e.read_shift(1)>>>5&3,o=!r||r.biff>=8?4:2,u=e.read_shift(o);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,u]}function Oxe(e,t,r){if(r.biff==5)return Mxe(e);var n=e.read_shift(1)>>>5&3,o=e.read_shift(2),u=e.read_shift(4);return[n,o,u]}function Mxe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Rxe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var o=e.read_shift(r&&r.biff==2?1:2);return[n,o]}function Dxe(e,t,r){var n=e.read_shift(1)>>>5&3,o=e.read_shift(r&&r.biff==2?1:2);return[n,o]}function Fxe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Lxe(e,t,r){var n=(e[e.l++]&96)>>5,o=e.read_shift(2),u=4;if(r)switch(r.biff){case 5:u=15;break;case 12:u=6;break}return e.l+=u,[n,o]}var Nxe=Ds,Bxe=Ds,zxe=Ds;function m2(e,t,r){return e.l+=2,[Jve(e)]}function J4(e){return e.l+=6,[]}var jxe=m2,Uxe=J4,$xe=J4,Vxe=m2;function IY(e){return e.l+=2,[yo(e),e.read_shift(2)&1]}var Wxe=m2,Gxe=IY,Hxe=J4,qxe=m2,Xxe=m2,Zxe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Yxe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),o=e.read_shift(2),u=e.read_shift(2),d=Zxe[r>>2&31];return{ixti:t,coltype:r&3,rt:d,idx:n,c:o,C:u}}function Kxe(e){return e.l+=2,[e.read_shift(4)]}function Jxe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Qxe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function e1e(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t1e(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function r1e(e){return e.l+=4,[0,0]}var yU={1:{n:"PtgExp",f:wxe},2:{n:"PtgTbl",f:zxe},3:{n:"PtgAdd",f:go},4:{n:"PtgSub",f:go},5:{n:"PtgMul",f:go},6:{n:"PtgDiv",f:go},7:{n:"PtgPower",f:go},8:{n:"PtgConcat",f:go},9:{n:"PtgLt",f:go},10:{n:"PtgLe",f:go},11:{n:"PtgEq",f:go},12:{n:"PtgGe",f:go},13:{n:"PtgGt",f:go},14:{n:"PtgNe",f:go},15:{n:"PtgIsect",f:go},16:{n:"PtgUnion",f:go},17:{n:"PtgRange",f:go},18:{n:"PtgUplus",f:go},19:{n:"PtgUminus",f:go},20:{n:"PtgPercent",f:go},21:{n:"PtgParen",f:go},22:{n:"PtgMissArg",f:go},23:{n:"PtgStr",f:Axe},26:{n:"PtgSheet",f:Jxe},27:{n:"PtgEndSheet",f:Qxe},28:{n:"PtgErr",f:bxe},29:{n:"PtgBool",f:Sxe},30:{n:"PtgInt",f:Txe},31:{n:"PtgNum",f:Exe},32:{n:"PtgArray",f:oxe},33:{n:"PtgFunc",f:_xe},34:{n:"PtgFuncVar",f:yxe},35:{n:"PtgName",f:kxe},36:{n:"PtgRef",f:pxe},37:{n:"PtgArea",f:txe},38:{n:"PtgMemArea",f:Rxe},39:{n:"PtgMemErr",f:Nxe},40:{n:"PtgMemNoMem",f:Bxe},41:{n:"PtgMemFunc",f:Dxe},42:{n:"PtgRefErr",f:Fxe},43:{n:"PtgAreaErr",f:nxe},44:{n:"PtgRefN",f:mxe},45:{n:"PtgAreaN",f:axe},46:{n:"PtgMemAreaN",f:e1e},47:{n:"PtgMemNoMemN",f:t1e},57:{n:"PtgNameX",f:Oxe},58:{n:"PtgRef3d",f:gxe},59:{n:"PtgArea3d",f:rxe},60:{n:"PtgRefErr3d",f:Lxe},61:{n:"PtgAreaErr3d",f:ixe},255:{}},n1e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},i1e={1:{n:"PtgElfLel",f:IY},2:{n:"PtgElfRw",f:qxe},3:{n:"PtgElfCol",f:jxe},6:{n:"PtgElfRwV",f:Xxe},7:{n:"PtgElfColV",f:Vxe},10:{n:"PtgElfRadical",f:Wxe},11:{n:"PtgElfRadicalS",f:Hxe},13:{n:"PtgElfColS",f:Uxe},15:{n:"PtgElfColSV",f:$xe},16:{n:"PtgElfRadicalLel",f:Gxe},25:{n:"PtgList",f:Yxe},29:{n:"PtgSxName",f:Kxe},255:{}},a1e={0:{n:"PtgAttrNoop",f:r1e},1:{n:"PtgAttrSemi",f:hxe},2:{n:"PtgAttrIf",f:cxe},4:{n:"PtgAttrChoose",f:sxe},8:{n:"PtgAttrGoto",f:lxe},16:{n:"PtgAttrSum",f:xxe},32:{n:"PtgAttrBaxcel",f:_U},33:{n:"PtgAttrBaxcel",f:_U},64:{n:"PtgAttrSpace",f:fxe},65:{n:"PtgAttrSpaceSemi",f:dxe},128:{n:"PtgAttrIfError",f:uxe},255:{}};function g2(e,t,r,n){if(n.biff<8)return Ds(e,t);for(var o=e.l+t,u=[],d=0;d!==r.length;++d)switch(r[d][0]){case"PtgArray":r[d][1]=Ixe(e,0,n),u.push(r[d][1]);break;case"PtgMemArea":r[d][2]=Pxe(e,r[d][1],n),u.push(r[d][2]);break;case"PtgExp":n&&n.biff==12&&(r[d][1][1]=e.read_shift(4),u.push(r[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[d][0]}return t=o-e.l,t!==0&&u.push(Ds(e,t)),u}function _2(e,t,r){for(var n=e.l+t,o,u,d=[];n!=e.l;)t=n-e.l,u=e[e.l],o=yU[u]||yU[n1e[u]],(u===24||u===25)&&(o=(u===24?i1e:a1e)[e[e.l+1]]),!o||!o.f?Ds(e,t):d.push([o.n,o.f(e,t,r)]);return d}function o1e(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],o=[],u=0;u<n.length;++u){var d=n[u];if(d)switch(d[0]){case 2:o.push('"'+d[1].replace(/"/g,'""')+'"');break;default:o.push(d[1])}else o.push("")}t.push(o.join(","))}return t.join(";")}var s1e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function l1e(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kY(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var o="";if(r.biff>8)switch(e[n[0]][0]){case 357:return o=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?o:o+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return o=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?o:o+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(u){return u.Name}).join(";;");default:return e[n[0]][0][3]?(o=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?o:o+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function vU(e,t,r){var n=kY(e,t,r);return n=="#REF"?n:l1e(n,r)}function Es(e,t,r,n,o){var u=o&&o.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},i=[],v,w,S,C=0,k=0,O,L="";if(!e[0]||!e[0][0])return"";for(var R=-1,N="",V=0,G=e[0].length;V<G;++V){var U=e[0][V];switch(U[0]){case"PtgUminus":i.push("-"+i.pop());break;case"PtgUplus":i.push("+"+i.pop());break;case"PtgPercent":i.push(i.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(v=i.pop(),w=i.pop(),R>=0){switch(e[0][R][1][0]){case 0:N=Ka(" ",e[0][R][1][1]);break;case 1:N=Ka("\r",e[0][R][1][1]);break;default:if(N="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][R][1][0])}w=w+N,R=-1}i.push(w+s1e[U[0]]+v);break;case"PtgIsect":v=i.pop(),w=i.pop(),i.push(w+" "+v);break;case"PtgUnion":v=i.pop(),w=i.pop(),i.push(w+","+v);break;case"PtgRange":v=i.pop(),w=i.pop(),i.push(w+":"+v);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":S=vw(U[1][1],d,o),i.push(xw(S,u));break;case"PtgRefN":S=r?vw(U[1][1],r,o):U[1][1],i.push(xw(S,u));break;case"PtgRef3d":C=U[1][1],S=vw(U[1][2],d,o),L=vU(n,C,o),i.push(L+"!"+xw(S,u));break;case"PtgFunc":case"PtgFuncVar":var J=U[1][0],Z=U[1][1];J||(J=0),J&=127;var K=J==0?[]:i.slice(-J);i.length-=J,Z==="User"&&(Z=K.shift()),i.push(Z+"("+K.join(",")+")");break;case"PtgBool":i.push(U[1]?"TRUE":"FALSE");break;case"PtgInt":i.push(U[1]);break;case"PtgNum":i.push(String(U[1]));break;case"PtgStr":i.push('"'+U[1].replace(/"/g,'""')+'"');break;case"PtgErr":i.push(U[1]);break;case"PtgAreaN":O=Xj(U[1][1],r?{s:r}:d,o),i.push(uM(O,o));break;case"PtgArea":O=Xj(U[1][1],d,o),i.push(uM(O,o));break;case"PtgArea3d":C=U[1][1],O=U[1][2],L=vU(n,C,o),i.push(L+"!"+uM(O,o));break;case"PtgAttrSum":i.push("SUM("+i.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":k=U[1][2];var re=(n.names||[])[k-1]||(n[0]||[])[k],ge=re?re.Name:"SH33TJSNAME"+String(k);ge&&ge.slice(0,6)=="_xlfn."&&!o.xlfn&&(ge=ge.slice(6)),i.push(ge);break;case"PtgNameX":var ve=U[1][1];k=U[1][2];var $e;if(o.biff<=5)ve<0&&(ve=-ve),n[ve]&&($e=n[ve][k]);else{var Ie="";if(((n[ve]||[])[0]||[])[0]==14849||(((n[ve]||[])[0]||[])[0]==1025?n[ve][k]&&n[ve][k].itab>0&&(Ie=n.SheetNames[n[ve][k].itab-1]+"!"):Ie=n.SheetNames[k-1]+"!"),n[ve]&&n[ve][k])Ie+=n[ve][k].Name;else if(n[0]&&n[0][k])Ie+=n[0][k].Name;else{var ke=(kY(n,ve,o)||"").split(";;");ke[k-1]?Ie=ke[k-1]:Ie+="SH33TJSERRX"}i.push(Ie);break}$e||($e={Name:"SH33TJSERRY"}),i.push($e.Name);break;case"PtgParen":var tt="(",Je=")";if(R>=0){switch(N="",e[0][R][1][0]){case 2:tt=Ka(" ",e[0][R][1][1])+tt;break;case 3:tt=Ka("\r",e[0][R][1][1])+tt;break;case 4:Je=Ka(" ",e[0][R][1][1])+Je;break;case 5:Je=Ka("\r",e[0][R][1][1])+Je;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][R][1][0])}R=-1}i.push(tt+i.pop()+Je);break;case"PtgRefErr":i.push("#REF!");break;case"PtgRefErr3d":i.push("#REF!");break;case"PtgExp":S={c:U[1][1],r:U[1][0]};var et={c:r.c,r:r.r};if(n.sharedf[Pn(S)]){var at=n.sharedf[Pn(S)];i.push(Es(at,d,et,n,o))}else{var pt=!1;for(v=0;v!=n.arrayf.length;++v)if(w=n.arrayf[v],!(S.c<w[0].s.c||S.c>w[0].e.c)&&!(S.r<w[0].s.r||S.r>w[0].e.r)){i.push(Es(w[1],d,et,n,o)),pt=!0;break}pt||i.push(U[1])}break;case"PtgArray":i.push("{"+o1e(U[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":R=V;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":i.push("");break;case"PtgAreaErr":i.push("#REF!");break;case"PtgAreaErr3d":i.push("#REF!");break;case"PtgList":i.push("Table"+U[1].idx+"[#"+U[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(U));default:throw new Error("Unrecognized Formula Token: "+String(U))}var ft=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&R>=0&&ft.indexOf(e[0][V][0])==-1){U=e[0][R];var Ue=!0;switch(U[1][0]){case 4:Ue=!1;case 0:N=Ka(" ",U[1][1]);break;case 5:Ue=!1;case 1:N=Ka("\r",U[1][1]);break;default:if(N="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+U[1][0])}i.push((Ue?N:"")+i.pop()+(Ue?"":N)),R=-1}}if(i.length>1&&o.WTF)throw new Error("bad formula stack");return i[0]}function c1e(e,t,r){var n=e.l+t,o=r.biff==2?1:2,u,d=e.read_shift(o);if(d==65535)return[[],Ds(e,t-2)];var i=_2(e,d,r);return t!==d+o&&(u=g2(e,t-d-o,i,r)),e.l=n,[i,u]}function u1e(e,t,r){var n=e.l+t,o=r.biff==2?1:2,u,d=e.read_shift(o);if(d==65535)return[[],Ds(e,t-2)];var i=_2(e,d,r);return t!==d+o&&(u=g2(e,t-d-o,i,r)),e.l=n,[i,u]}function h1e(e,t,r,n){var o=e.l+t,u=_2(e,n,r),d;return o!==e.l&&(d=g2(e,o-e.l,u,r)),[u,d]}function f1e(e,t,r){var n=e.l+t,o,u=e.read_shift(2),d=_2(e,u,r);return u==65535?[[],Ds(e,t-2)]:(t!==u+2&&(o=g2(e,n-u-2,d,r)),[d,o])}function d1e(e){var t;if(yf(e,e.l+6)!==65535)return[ks(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function p1e(e){if(e==null){var t=rr(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return T0(e);return T0(0)}function mM(e,t,r){var n=e.l+t,o=Mh(e);r.biff==2&&++e.l;var u=d1e(e),d=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var i=u1e(e,n-e.l,r);return{cell:o,val:u[0],formula:i,shared:d>>3&1,tt:u[1]}}function m1e(e,t,r,n,o){var u=E0(t,r,o),d=p1e(e.v),i=rr(6),v=33;i.write_shift(2,v),i.write_shift(4,0);for(var w=rr(e.bf.length),S=0;S<e.bf.length;++S)w[S]=e.bf[S];var C=Yo([u,d,i,w]);return C}function TP(e,t,r){var n=e.read_shift(4),o=_2(e,n,r),u=e.read_shift(4),d=u>0?g2(e,u,o,r):null;return[o,d]}var g1e=TP,SP=TP,_1e=TP,y1e=TP,v1e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},OY={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},x1e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xU(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function w1e(e){var t="of:="+e.replace(Y4,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function gM(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function b1e(e){return e.replace(/\./,"!")}var bw={},my={},Tw=typeof Map<"u";function Q4(e,t,r){var n=0,o=e.length;if(r){if(Tw?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var u=Tw?r.get(t):r[t];n<u.length;++n)if(e[u[n]].t===t)return e.Count++,u[n]}}else for(;n<o;++n)if(e[n].t===t)return e.Count++,n;return e[o]={t},e.Count++,e.Unique++,r&&(Tw?(r.has(t)||r.set(t,[]),r.get(t).push(o)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(o))),o}function EP(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Cs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=sb(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=kA(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function o0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Np(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],o=60,u=e.length;if(n==null&&r.ssf){for(;o<392;++o)if(r.ssf[o]==null){wh(t.z,o),r.ssf[o]=t.z,r.revssf[t.z]=n=o;break}}for(o=0;o!=u;++o)if(e[o].numFmtId===n)return o;return e[u]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},u}function MY(e,t,r,n,o,u){try{n.cellNF&&(e.z=xn[t])}catch(i){if(n.WTF)throw i}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ma(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(xn[t]==null&&wh(yme[t]||"General",t),e.t==="e")e.w=e.w||$f[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eb(e.v);else if(e.t==="d"){var d=Lo(e.v);(d|0)===d?e.w=d.toString(10):e.w=eb(d)}else{if(e.v===void 0)return"";e.w=w0(e.v,my)}else e.t==="d"?e.w=Kl(t,Lo(e.v),my):e.w=Kl(t,e.v,my)}catch(i){if(n.WTF)throw i}if(n.cellStyles&&r!=null)try{e.s=u.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=IA(o.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=o.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=IA(o.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=o.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(i){if(n.WTF&&u.Fills)throw i}}}function T1e(e,t,r){if(e&&e["!ref"]){var n=wi(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function S1e(e,t){var r=wi(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Hn(r))}var E1e=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,A1e=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,C1e=/<(?:\w:)?hyperlink [^>]*>/mg,P1e=/"(\w*:\w*)"/,I1e=/<(?:\w:)?col\b[^>]*[\/]?>/g,k1e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O1e=/<(?:\w:)?pageMargins[^>]*\/>/g,RY=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,M1e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,R1e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function D1e(e,t,r,n,o,u,d){if(!e)return e;n||(n={"!id":{}});var i=t.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},w="",S="",C=e.match(A1e);C?(w=e.slice(0,C.index),S=e.slice(C.index+C[0].length)):w=S=e;var k=w.match(RY);k?eL(k[0],i,o,r):(k=w.match(M1e))&&L1e(k[0],k[1]||"",i,o,r);var O=(w.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(O>0){var L=w.slice(O,O+50).match(P1e);L&&S1e(i,L[1])}var R=w.match(R1e);R&&R[1]&&Z1e(R[1],o);var N=[];if(t.cellStyles){var V=w.match(I1e);V&&W1e(N,V)}C&&J1e(C[1],i,t,v,u,d);var G=S.match(k1e);G&&(i["!autofilter"]=H1e(G[0]));var U=[],J=S.match(E1e);if(J)for(O=0;O!=J.length;++O)U[O]=wi(J[O].slice(J[O].indexOf('"')+1));var Z=S.match(C1e);Z&&U1e(i,Z,n);var K=S.match(O1e);if(K&&(i["!margins"]=$1e(kn(K[0]))),!i["!ref"]&&v.e.c>=v.s.c&&v.e.r>=v.s.r&&(i["!ref"]=Hn(v)),t.sheetRows>0&&i["!ref"]){var re=wi(i["!ref"]);t.sheetRows<=+re.e.r&&(re.e.r=t.sheetRows-1,re.e.r>v.e.r&&(re.e.r=v.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>v.e.c&&(re.e.c=v.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),i["!fullref"]=i["!ref"],i["!ref"]=Hn(re))}return N.length>0&&(i["!cols"]=N),U.length>0&&(i["!merges"]=U),i}function F1e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Hn(e[r])+'"/>';return t+"</mergeCells>"}function eL(e,t,r,n){var o=kn(e);r.Sheets[n]||(r.Sheets[n]={}),o.codeName&&(r.Sheets[n].CodeName=Ri(la(o.codeName)))}function L1e(e,t,r,n,o){eL(e.slice(0,e.indexOf(">")),r,n,o)}function N1e(e,t,r,n,o){var u=!1,d={},i=null;if(n.bookType!=="xlsx"&&t.vbaraw){var v=t.SheetNames[r];try{t.Workbook&&(v=t.Workbook.Sheets[r].CodeName||v)}catch{}u=!0,d.codeName=gh(Ki(v))}if(e&&e["!outline"]){var w={summaryBelow:1,summaryRight:1};e["!outline"].above&&(w.summaryBelow=0),e["!outline"].left&&(w.summaryRight=0),i=(i||"")+Fr("outlinePr",null,w)}!u&&!i||(o[o.length]=Fr("sheetPr",i,d))}var B1e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],z1e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function j1e(e){var t={sheet:1};return B1e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),z1e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=q4(e.password).toString(16).toUpperCase()),Fr("sheetProtection",null,t)}function U1e(e,t,r){for(var n=Array.isArray(e),o=0;o!=t.length;++o){var u=kn(la(t[o]),!0);if(!u.ref)return;var d=((r||{})["!id"]||[])[u.id];d?(u.Target=d.Target,u.location&&(u.Target+="#"+Ri(u.location))):(u.Target="#"+Ri(u.location),d={Target:u.Target,TargetMode:"Internal"}),u.Rel=d,u.tooltip&&(u.Tooltip=u.tooltip,delete u.tooltip);for(var i=wi(u.ref),v=i.s.r;v<=i.e.r;++v)for(var w=i.s.c;w<=i.e.c;++w){var S=Pn({c:w,r:v});n?(e[v]||(e[v]=[]),e[v][w]||(e[v][w]={t:"z",v:void 0}),e[v][w].l=u):(e[S]||(e[S]={t:"z",v:void 0}),e[S].l=u)}}}function $1e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function V1e(e){return o0(e),Fr("pageMargins",null,e)}function W1e(e,t){for(var r=!1,n=0;n!=t.length;++n){var o=kn(t[n],!0);o.hidden&&(o.hidden=Ia(o.hidden));var u=parseInt(o.min,10)-1,d=parseInt(o.max,10)-1;for(o.outlineLevel&&(o.level=+o.outlineLevel||0),delete o.min,delete o.max,o.width=+o.width,!r&&o.width&&(r=!0,X4(o.width)),Cp(o);u<=d;)e[u++]=fa(o)}}function G1e(e,t){for(var r=["<cols>"],n,o=0;o!=t.length;++o)(n=t[o])&&(r[r.length]=Fr("col",null,EP(o,n)));return r[r.length]="</cols>",r.join("")}function H1e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function q1e(e,t,r,n){var o=typeof e.ref=="string"?e.ref:Hn(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var u=r.Workbook.Names,d=tl(o);d.s.r==d.e.r&&(d.e.r=tl(t["!ref"]).e.r,o=Hn(d));for(var i=0;i<u.length;++i){var v=u[i];if(v.Name=="_xlnm._FilterDatabase"&&v.Sheet==n){v.Ref="'"+r.SheetNames[n]+"'!"+o;break}}return i==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Fr("autoFilter",null,{ref:o})}var X1e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Z1e(e,t){t.Views||(t.Views=[{}]),(e.match(X1e)||[]).forEach(function(r,n){var o=kn(r);t.Views[n]||(t.Views[n]={}),+o.zoomScale&&(t.Views[n].zoom=+o.zoomScale),Ia(o.rightToLeft)&&(t.Views[n].RTL=!0)})}function Y1e(e,t,r,n){var o={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Fr("sheetViews",Fr("sheetView",null,o),{})}function K1e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",u=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=$f[e.v];break;case"d":n&&n.cellDates?o=Ma(e.v,-1).toISOString():(e=fa(e),e.t="n",o=""+(e.v=Lo(Ma(e.v)))),typeof e.z>"u"&&(e.z=xn[14]);break;default:o=e.v;break}var i=ls("v",Ki(o)),v={r:t},w=Np(n.cellXfs,e,n);switch(w!==0&&(v.s=w),e.t){case"n":break;case"d":v.t="d";break;case"b":v.t="b";break;case"e":v.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){i=ls("v",""+Q4(n.Strings,e.v,n.revStrings)),v.t="s";break}v.t="str";break}if(e.t!=u&&(e.t=u,e.v=d),typeof e.f=="string"&&e.f){var S=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;i=Fr("f",Ki(e.f),S)+(e.v!=null?i:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(v.cm=1),Fr("c",i,v)}var J1e=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,o=/ref=["']([^"']*)["']/,u=tb("v"),d=tb("f");return function(v,w,S,C,k,O){for(var L=0,R="",N=[],V=[],G=0,U=0,J=0,Z="",K,re,ge=0,ve=0,$e,Ie,ke=0,tt=0,Je=Array.isArray(O.CellXf),et,at=[],pt=[],ft=Array.isArray(w),Ue=[],It={},Rt=!1,_e=!!S.sheetStubs,Ge=v.split(t),qe=0,Xe=Ge.length;qe!=Xe;++qe){R=Ge[qe].trim();var yt=R.length;if(yt!==0){var Dt=0;e:for(L=0;L<yt;++L)switch(R[L]){case">":if(R[L-1]!="/"){++L;break e}if(S&&S.cellStyles){if(re=kn(R.slice(Dt,L),!0),ge=re.r!=null?parseInt(re.r,10):ge+1,ve=-1,S.sheetRows&&S.sheetRows<ge)continue;It={},Rt=!1,re.ht&&(Rt=!0,It.hpt=parseFloat(re.ht),It.hpx=Uy(It.hpt)),re.hidden=="1"&&(Rt=!0,It.hidden=!0),re.outlineLevel!=null&&(Rt=!0,It.level=+re.outlineLevel),Rt&&(Ue[ge-1]=It)}break;case"<":Dt=L;break}if(Dt>=L)break;if(re=kn(R.slice(Dt,L),!0),ge=re.r!=null?parseInt(re.r,10):ge+1,ve=-1,!(S.sheetRows&&S.sheetRows<ge)){C.s.r>ge-1&&(C.s.r=ge-1),C.e.r<ge-1&&(C.e.r=ge-1),S&&S.cellStyles&&(It={},Rt=!1,re.ht&&(Rt=!0,It.hpt=parseFloat(re.ht),It.hpx=Uy(It.hpt)),re.hidden=="1"&&(Rt=!0,It.hidden=!0),re.outlineLevel!=null&&(Rt=!0,It.level=+re.outlineLevel),Rt&&(Ue[ge-1]=It)),N=R.slice(L).split(e);for(var Yt=0;Yt!=N.length&&N[Yt].trim().charAt(0)=="<";++Yt);for(N=N.slice(Yt),L=0;L!=N.length;++L)if(R=N[L].trim(),R.length!==0){if(V=R.match(r),G=L,U=0,J=0,R="<c "+(R.slice(0,1)=="<"?">":"")+R,V!=null&&V.length===2){for(G=0,Z=V[1],U=0;U!=Z.length&&!((J=Z.charCodeAt(U)-64)<1||J>26);++U)G=26*G+J;--G,ve=G}else++ve;for(U=0;U!=R.length&&R.charCodeAt(U)!==62;++U);if(++U,re=kn(R.slice(0,U),!0),re.r||(re.r=Pn({r:ge-1,c:ve})),Z=R.slice(U),K={t:""},(V=Z.match(u))!=null&&V[1]!==""&&(K.v=Ri(V[1])),S.cellFormula){if((V=Z.match(d))!=null&&V[1]!==""){if(K.f=Ri(la(V[1])).replace(/\r\n/g,`
`),S.xlfn||(K.f=gU(K.f)),V[0].indexOf('t="array"')>-1)K.F=(Z.match(o)||[])[1],K.F.indexOf(":")>-1&&at.push([wi(K.F),K.F]);else if(V[0].indexOf('t="shared"')>-1){Ie=kn(V[0]);var St=Ri(la(V[1]));S.xlfn||(St=gU(St)),pt[parseInt(Ie.si,10)]=[Ie,St,re.r]}}else(V=Z.match(/<f[^>]*\/>/))&&(Ie=kn(V[0]),pt[Ie.si]&&(K.f=Xve(pt[Ie.si][1],pt[Ie.si][2],re.r)));var Mt=Va(re.r);for(U=0;U<at.length;++U)Mt.r>=at[U][0].s.r&&Mt.r<=at[U][0].e.r&&Mt.c>=at[U][0].s.c&&Mt.c<=at[U][0].e.c&&(K.F=at[U][1])}if(re.t==null&&K.v===void 0)if(K.f||K.F)K.v=0,K.t="n";else if(_e)K.t="z";else continue;else K.t=re.t||"n";switch(C.s.c>ve&&(C.s.c=ve),C.e.c<ve&&(C.e.c=ve),K.t){case"n":if(K.v==""||K.v==null){if(!_e)continue;K.t="z"}else K.v=parseFloat(K.v);break;case"s":if(typeof K.v>"u"){if(!_e)continue;K.t="z"}else $e=bw[parseInt(K.v,10)],K.v=$e.t,K.r=$e.r,S.cellHTML&&(K.h=$e.h);break;case"str":K.t="s",K.v=K.v!=null?la(K.v):"",S.cellHTML&&(K.h=P4(K.v));break;case"inlineStr":V=Z.match(n),K.t="s",V!=null&&($e=H4(V[1]))?(K.v=$e.t,S.cellHTML&&(K.h=$e.h)):K.v="";break;case"b":K.v=Ia(K.v);break;case"d":S.cellDates?K.v=Ma(K.v,1):(K.v=Lo(Ma(K.v,1)),K.t="n");break;case"e":(!S||S.cellText!==!1)&&(K.w=K.v),K.v=FZ[K.v];break}if(ke=tt=0,et=null,Je&&re.s!==void 0&&(et=O.CellXf[re.s],et!=null&&(et.numFmtId!=null&&(ke=et.numFmtId),S.cellStyles&&et.fillId!=null&&(tt=et.fillId))),MY(K,ke,tt,S,k,O),S.cellDates&&Je&&K.t=="n"&&F0(xn[ke])&&(K.t="d",K.v=xP(K.v)),re.cm&&S.xlmeta){var Sr=(S.xlmeta.Cell||[])[+re.cm-1];Sr&&Sr.type=="XLDAPR"&&(K.D=!0)}if(ft){var Ne=Va(re.r);w[Ne.r]||(w[Ne.r]=[]),w[Ne.r][Ne.c]=K}else w[re.r]=K}}}}Ue.length>0&&(w["!rows"]=Ue)}}();function Q1e(e,t,r,n){var o=[],u=[],d=wi(e["!ref"]),i="",v,w="",S=[],C=0,k=0,O=e["!rows"],L=Array.isArray(e),R={r:w},N,V=-1;for(k=d.s.c;k<=d.e.c;++k)S[k]=Oa(k);for(C=d.s.r;C<=d.e.r;++C){for(u=[],w=Qa(C),k=d.s.c;k<=d.e.c;++k){v=S[k]+w;var G=L?(e[C]||[])[k]:e[v];G!==void 0&&(i=K1e(G,v,e,t))!=null&&u.push(i)}(u.length>0||O&&O[C])&&(R={r:w},O&&O[C]&&(N=O[C],N.hidden&&(R.hidden=1),V=-1,N.hpx?V=lb(N.hpx):N.hpt&&(V=N.hpt),V>-1&&(R.ht=V,R.customHeight=1),N.level&&(R.outlineLevel=N.level)),o[o.length]=Fr("row",u.join(""),R))}if(O)for(;C<O.length;++C)O&&O[C]&&(R={r:C+1},N=O[C],N.hidden&&(R.hidden=1),V=-1,N.hpx?V=lb(N.hpx):N.hpt&&(V=N.hpt),V>-1&&(R.ht=V,R.customHeight=1),N.level&&(R.outlineLevel=N.level),o[o.length]=Fr("row","",R));return o.join("")}function DY(e,t,r,n){var o=[co,Fr("worksheet",null,{xmlns:L0[0],"xmlns:r":Ro.r})],u=r.SheetNames[e],d=0,i="",v=r.Sheets[u];v==null&&(v={});var w=v["!ref"]||"A1",S=wi(w);if(S.e.c>16383||S.e.r>1048575){if(t.WTF)throw new Error("Range "+w+" exceeds format limit A1:XFD1048576");S.e.c=Math.min(S.e.c,16383),S.e.r=Math.min(S.e.c,1048575),w=Hn(S)}n||(n={}),v["!comments"]=[];var C=[];N1e(v,r,e,t,o),o[o.length]=Fr("dimension",null,{ref:w}),o[o.length]=Y1e(v,t,e,r),t.sheetFormat&&(o[o.length]=Fr("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),v["!cols"]!=null&&v["!cols"].length>0&&(o[o.length]=G1e(v,v["!cols"])),o[d=o.length]="<sheetData/>",v["!links"]=[],v["!ref"]!=null&&(i=Q1e(v,t),i.length>0&&(o[o.length]=i)),o.length>d+1&&(o[o.length]="</sheetData>",o[d]=o[d].replace("/>",">")),v["!protect"]&&(o[o.length]=j1e(v["!protect"])),v["!autofilter"]!=null&&(o[o.length]=q1e(v["!autofilter"],v,r,e)),v["!merges"]!=null&&v["!merges"].length>0&&(o[o.length]=F1e(v["!merges"]));var k=-1,O,L=-1;return v["!links"].length>0&&(o[o.length]="<hyperlinks>",v["!links"].forEach(function(R){R[1].Target&&(O={ref:R[0]},R[1].Target.charAt(0)!="#"&&(L=Yi(n,-1,Ki(R[1].Target).replace(/#.*$/,""),fi.HLINK),O["r:id"]="rId"+L),(k=R[1].Target.indexOf("#"))>-1&&(O.location=Ki(R[1].Target.slice(k+1))),R[1].Tooltip&&(O.tooltip=Ki(R[1].Tooltip)),o[o.length]=Fr("hyperlink",null,O))}),o[o.length]="</hyperlinks>"),delete v["!links"],v["!margins"]!=null&&(o[o.length]=V1e(v["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(o[o.length]=ls("ignoredErrors",Fr("ignoredError",null,{numberStoredAsText:1,sqref:w}))),C.length>0&&(L=Yi(n,-1,"../drawings/drawing"+(e+1)+".xml",fi.DRAW),o[o.length]=Fr("drawing",null,{"r:id":"rId"+L}),v["!drawing"]=C),v["!comments"].length>0&&(L=Yi(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",fi.VML),o[o.length]=Fr("legacyDrawing",null,{"r:id":"rId"+L}),v["!legacy"]=L),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function ewe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var u=e.read_shift(1);return e.l=n,u&7&&(r.level=u&7),u&16&&(r.hidden=!0),u&32&&(r.hpt=o/20),r}function twe(e,t,r){var n=rr(145),o=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var u=320;o.hpx?u=lb(o.hpx)*20:o.hpt&&(u=o.hpt*20),n.write_shift(2,u),n.write_shift(1,0);var d=0;o.level&&(d|=o.level),o.hidden&&(d|=16),(o.hpx||o.hpt)&&(d|=32),n.write_shift(1,d),n.write_shift(1,0);var i=0,v=n.l;n.l+=4;for(var w={r:e,c:0},S=0;S<16;++S)if(!(t.s.c>S+1<<10||t.e.c<S<<10)){for(var C=-1,k=-1,O=S<<10;O<S+1<<10;++O){w.c=O;var L=Array.isArray(r)?(r[w.r]||[])[w.c]:r[Pn(w)];L&&(C<0&&(C=O),k=O)}C<0||(++i,n.write_shift(4,C),n.write_shift(4,k))}var R=n.l;return n.l=v,n.write_shift(4,i),n.l=R,n.length>n.l?n.slice(0,n.l):n}function rwe(e,t,r,n){var o=twe(n,r,t);(o.length>17||(t["!rows"]||[])[n])&&yr(e,0,o)}var nwe=j0,iwe=xv;function awe(){}function owe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=c0e(e),r}function swe(e,t,r){r==null&&(r=rr(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var o=1;o<3;++o)r.write_shift(1,0);return AA({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kZ(e,r),r.slice(0,r.l)}function lwe(e){var t=Nc(e);return[t]}function cwe(e,t,r){return r==null&&(r=rr(8)),N0(t,r)}function uwe(e){var t=B0(e);return[t]}function hwe(e,t,r){return r==null&&(r=rr(4)),z0(t,r)}function fwe(e){var t=Nc(e),r=e.read_shift(1);return[t,r,"b"]}function dwe(e,t,r){return r==null&&(r=rr(9)),N0(t,r),r.write_shift(1,e.v?1:0),r}function pwe(e){var t=B0(e),r=e.read_shift(1);return[t,r,"b"]}function mwe(e,t,r){return r==null&&(r=rr(5)),z0(t,r),r.write_shift(1,e.v?1:0),r}function gwe(e){var t=Nc(e),r=e.read_shift(1);return[t,r,"e"]}function _we(e,t,r){return r==null&&(r=rr(9)),N0(t,r),r.write_shift(1,e.v),r}function ywe(e){var t=B0(e),r=e.read_shift(1);return[t,r,"e"]}function vwe(e,t,r){return r==null&&(r=rr(8)),z0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function xwe(e){var t=Nc(e),r=e.read_shift(4);return[t,r,"s"]}function wwe(e,t,r){return r==null&&(r=rr(12)),N0(t,r),r.write_shift(4,t.v),r}function bwe(e){var t=B0(e),r=e.read_shift(4);return[t,r,"s"]}function Twe(e,t,r){return r==null&&(r=rr(8)),z0(t,r),r.write_shift(4,t.v),r}function Swe(e){var t=Nc(e),r=ks(e);return[t,r,"n"]}function Ewe(e,t,r){return r==null&&(r=rr(16)),N0(t,r),T0(e.v,r),r}function FY(e){var t=B0(e),r=ks(e);return[t,r,"n"]}function Awe(e,t,r){return r==null&&(r=rr(12)),z0(t,r),T0(e.v,r),r}function Cwe(e){var t=Nc(e),r=U4(e);return[t,r,"n"]}function Pwe(e,t,r){return r==null&&(r=rr(12)),N0(t,r),OZ(e.v,r),r}function Iwe(e){var t=B0(e),r=U4(e);return[t,r,"n"]}function kwe(e,t,r){return r==null&&(r=rr(8)),z0(t,r),OZ(e.v,r),r}function Owe(e){var t=Nc(e),r=B4(e);return[t,r,"is"]}function Mwe(e){var t=Nc(e),r=Ms(e);return[t,r,"str"]}function Rwe(e,t,r){return r==null&&(r=rr(12+4*e.v.length)),N0(t,r),Ko(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Dwe(e){var t=B0(e),r=Ms(e);return[t,r,"str"]}function Fwe(e,t,r){return r==null&&(r=rr(8+4*e.v.length)),z0(t,r),Ko(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Lwe(e,t,r){var n=e.l+t,o=Nc(e);o.r=r["!row"];var u=e.read_shift(1),d=[o,u,"b"];if(r.cellFormula){e.l+=2;var i=SP(e,n-e.l,r);d[3]=Es(i,null,o,r.supbooks,r)}else e.l=n;return d}function Nwe(e,t,r){var n=e.l+t,o=Nc(e);o.r=r["!row"];var u=e.read_shift(1),d=[o,u,"e"];if(r.cellFormula){e.l+=2;var i=SP(e,n-e.l,r);d[3]=Es(i,null,o,r.supbooks,r)}else e.l=n;return d}function Bwe(e,t,r){var n=e.l+t,o=Nc(e);o.r=r["!row"];var u=ks(e),d=[o,u,"n"];if(r.cellFormula){e.l+=2;var i=SP(e,n-e.l,r);d[3]=Es(i,null,o,r.supbooks,r)}else e.l=n;return d}function zwe(e,t,r){var n=e.l+t,o=Nc(e);o.r=r["!row"];var u=Ms(e),d=[o,u,"str"];if(r.cellFormula){e.l+=2;var i=SP(e,n-e.l,r);d[3]=Es(i,null,o,r.supbooks,r)}else e.l=n;return d}var jwe=j0,Uwe=xv;function $we(e,t){return t==null&&(t=rr(4)),t.write_shift(4,e),t}function Vwe(e,t){var r=e.l+t,n=j0(e),o=z4(e),u=Ms(e),d=Ms(e),i=Ms(e);e.l=r;var v={rfx:n,relId:o,loc:u,display:i};return d&&(v.Tooltip=d),v}function Wwe(e,t){var r=rr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));xv({s:Va(e[0]),e:Va(e[0])},r),j4("rId"+t,r);var n=e[1].Target.indexOf("#"),o=n==-1?"":e[1].Target.slice(n+1);return Ko(o||"",r),Ko(e[1].Tooltip||"",r),Ko("",r),r.slice(0,r.l)}function Gwe(){}function Hwe(e,t,r){var n=e.l+t,o=MZ(e),u=e.read_shift(1),d=[o];if(d[2]=u,r.cellFormula){var i=g1e(e,n-e.l,r);d[1]=i}else e.l=n;return d}function qwe(e,t,r){var n=e.l+t,o=j0(e),u=[o];if(r.cellFormula){var d=y1e(e,n-e.l,r);u[1]=d,e.l=n}else e.l=n;return u}function Xwe(e,t,r){r==null&&(r=rr(18));var n=EP(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var o=0;return t.hidden&&(o|=1),typeof n.width=="number"&&(o|=2),t.level&&(o|=t.level<<8),r.write_shift(2,o),r}var LY=["left","right","top","bottom","header","footer"];function Zwe(e){var t={};return LY.forEach(function(r){t[r]=ks(e)}),t}function Ywe(e,t){return t==null&&(t=rr(6*8)),o0(e),LY.forEach(function(r){T0(e[r],t)}),t}function Kwe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Jwe(e,t,r){r==null&&(r=rr(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Qwe(e){var t=rr(24);return t.write_shift(4,4),t.write_shift(4,1),xv(e,t),t}function ebe(e,t){return t==null&&(t=rr(16*4+2)),t.write_shift(2,e.password?q4(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function tbe(){}function rbe(){}function nbe(e,t,r,n,o,u,d){if(!e)return e;var i=t||{};n||(n={"!id":{}});var v=i.dense?[]:{},w,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=!1,k=!1,O,L,R,N,V,G,U,J,Z,K=[];i.biff=12,i["!row"]=0;var re=0,ge=!1,ve=[],$e={},Ie=i.supbooks||o.supbooks||[[]];if(Ie.sharedf=$e,Ie.arrayf=ve,Ie.SheetNames=o.SheetNames||o.Sheets.map(function(ft){return ft.name}),!i.supbooks&&(i.supbooks=Ie,o.Names))for(var ke=0;ke<o.Names.length;++ke)Ie[0][ke+1]=o.Names[ke];var tt=[],Je=[],et=!1;cb[16]={n:"BrtShortReal",f:FY};var at;if(Uf(e,function(Ue,It,Rt){if(!k)switch(Rt){case 148:w=Ue;break;case 0:O=Ue,i.sheetRows&&i.sheetRows<=O.r&&(k=!0),J=Qa(N=O.r),i["!row"]=O.r,(Ue.hidden||Ue.hpt||Ue.level!=null)&&(Ue.hpt&&(Ue.hpx=Uy(Ue.hpt)),Je[Ue.r]=Ue);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(L={t:Ue[2]},Ue[2]){case"n":L.v=Ue[1];break;case"s":U=bw[Ue[1]],L.v=U.t,L.r=U.r;break;case"b":L.v=!!Ue[1];break;case"e":L.v=Ue[1],i.cellText!==!1&&(L.w=$f[L.v]);break;case"str":L.t="s",L.v=Ue[1];break;case"is":L.t="s",L.v=Ue[1].t;break}if((R=d.CellXf[Ue[0].iStyleRef])&&MY(L,R.numFmtId,null,i,u,d),V=Ue[0].c==-1?V+1:Ue[0].c,i.dense?(v[N]||(v[N]=[]),v[N][V]=L):v[Oa(V)+J]=L,i.cellFormula){for(ge=!1,re=0;re<ve.length;++re){var _e=ve[re];O.r>=_e[0].s.r&&O.r<=_e[0].e.r&&V>=_e[0].s.c&&V<=_e[0].e.c&&(L.F=Hn(_e[0]),ge=!0)}!ge&&Ue.length>3&&(L.f=Ue[3])}if(S.s.r>O.r&&(S.s.r=O.r),S.s.c>V&&(S.s.c=V),S.e.r<O.r&&(S.e.r=O.r),S.e.c<V&&(S.e.c=V),i.cellDates&&R&&L.t=="n"&&F0(xn[R.numFmtId])){var Ge=ip(L.v);Ge&&(L.t="d",L.v=new Date(Ge.y,Ge.m-1,Ge.d,Ge.H,Ge.M,Ge.S,Ge.u))}at&&(at.type=="XLDAPR"&&(L.D=!0),at=void 0);break;case 1:case 12:if(!i.sheetStubs||C)break;L={t:"z",v:void 0},V=Ue[0].c==-1?V+1:Ue[0].c,i.dense?(v[N]||(v[N]=[]),v[N][V]=L):v[Oa(V)+J]=L,S.s.r>O.r&&(S.s.r=O.r),S.s.c>V&&(S.s.c=V),S.e.r<O.r&&(S.e.r=O.r),S.e.c<V&&(S.e.c=V),at&&(at.type=="XLDAPR"&&(L.D=!0),at=void 0);break;case 176:K.push(Ue);break;case 49:at=((i.xlmeta||{}).Cell||[])[Ue-1];break;case 494:var qe=n["!id"][Ue.relId];for(qe?(Ue.Target=qe.Target,Ue.loc&&(Ue.Target+="#"+Ue.loc),Ue.Rel=qe):Ue.relId==""&&(Ue.Target="#"+Ue.loc),N=Ue.rfx.s.r;N<=Ue.rfx.e.r;++N)for(V=Ue.rfx.s.c;V<=Ue.rfx.e.c;++V)i.dense?(v[N]||(v[N]=[]),v[N][V]||(v[N][V]={t:"z",v:void 0}),v[N][V].l=Ue):(G=Pn({c:V,r:N}),v[G]||(v[G]={t:"z",v:void 0}),v[G].l=Ue);break;case 426:if(!i.cellFormula)break;ve.push(Ue),Z=i.dense?v[N][V]:v[Oa(V)+J],Z.f=Es(Ue[1],S,{r:O.r,c:V},Ie,i),Z.F=Hn(Ue[0]);break;case 427:if(!i.cellFormula)break;$e[Pn(Ue[0].s)]=Ue[1],Z=i.dense?v[N][V]:v[Oa(V)+J],Z.f=Es(Ue[1],S,{r:O.r,c:V},Ie,i);break;case 60:if(!i.cellStyles)break;for(;Ue.e>=Ue.s;)tt[Ue.e--]={width:Ue.w/256,hidden:!!(Ue.flags&1),level:Ue.level},et||(et=!0,X4(Ue.w/256)),Cp(tt[Ue.e+1]);break;case 161:v["!autofilter"]={ref:Hn(Ue)};break;case 476:v["!margins"]=Ue;break;case 147:o.Sheets[r]||(o.Sheets[r]={}),Ue.name&&(o.Sheets[r].CodeName=Ue.name),(Ue.above||Ue.left)&&(v["!outline"]={above:Ue.above,left:Ue.left});break;case 137:o.Views||(o.Views=[{}]),o.Views[0]||(o.Views[0]={}),Ue.RTL&&(o.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:C=!0;break;case 36:C=!1;break;case 37:C=!0;break;case 38:C=!1;break;default:if(!It.T){if(!C||i.WTF)throw new Error("Unexpected record 0x"+Rt.toString(16))}}},i),delete i.supbooks,delete i["!row"],!v["!ref"]&&(S.s.r<2e6||w&&(w.e.r>0||w.e.c>0||w.s.r>0||w.s.c>0))&&(v["!ref"]=Hn(w||S)),i.sheetRows&&v["!ref"]){var pt=wi(v["!ref"]);i.sheetRows<=+pt.e.r&&(pt.e.r=i.sheetRows-1,pt.e.r>S.e.r&&(pt.e.r=S.e.r),pt.e.r<pt.s.r&&(pt.s.r=pt.e.r),pt.e.c>S.e.c&&(pt.e.c=S.e.c),pt.e.c<pt.s.c&&(pt.s.c=pt.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Hn(pt))}return K.length>0&&(v["!merges"]=K),tt.length>0&&(v["!cols"]=tt),Je.length>0&&(v["!rows"]=Je),v}function ibe(e,t,r,n,o,u,d){if(t.v===void 0)return!1;var i="";switch(t.t){case"b":i=t.v?"1":"0";break;case"d":t=fa(t),t.z=t.z||xn[14],t.v=Lo(Ma(t.v)),t.t="n";break;case"n":case"e":i=""+t.v;break;default:i=t.v;break}var v={r,c:n};switch(v.s=Np(o.cellXfs,t,o),t.l&&u["!links"].push([Pn(v),t.l]),t.c&&u["!comments"].push([Pn(v),t.c]),t.t){case"s":case"str":return o.bookSST?(i=Q4(o.Strings,t.v,o.revStrings),v.t="s",v.v=i,d?yr(e,18,Twe(t,v)):yr(e,7,wwe(t,v))):(v.t="str",d?yr(e,17,Fwe(t,v)):yr(e,6,Rwe(t,v))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?d?yr(e,13,kwe(t,v)):yr(e,2,Pwe(t,v)):d?yr(e,16,Awe(t,v)):yr(e,5,Ewe(t,v)),!0;case"b":return v.t="b",d?yr(e,15,mwe(t,v)):yr(e,4,dwe(t,v)),!0;case"e":return v.t="e",d?yr(e,14,vwe(t,v)):yr(e,3,_we(t,v)),!0}return d?yr(e,12,hwe(t,v)):yr(e,1,cwe(t,v)),!0}function abe(e,t,r,n){var o=wi(t["!ref"]||"A1"),u,d="",i=[];yr(e,145);var v=Array.isArray(t),w=o.e.r;t["!rows"]&&(w=Math.max(o.e.r,t["!rows"].length-1));for(var S=o.s.r;S<=w;++S){d=Qa(S),rwe(e,t,o,S);var C=!1;if(S<=o.e.r)for(var k=o.s.c;k<=o.e.c;++k){S===o.s.r&&(i[k]=Oa(k)),u=i[k]+d;var O=v?(t[S]||[])[k]:t[u];if(!O){C=!1;continue}C=ibe(e,O,S,k,n,t,C)}}yr(e,146)}function obe(e,t){!t||!t["!merges"]||(yr(e,177,$we(t["!merges"].length)),t["!merges"].forEach(function(r){yr(e,176,Uwe(r))}),yr(e,178))}function sbe(e,t){!t||!t["!cols"]||(yr(e,390),t["!cols"].forEach(function(r,n){r&&yr(e,60,Xwe(n,r))}),yr(e,391))}function lbe(e,t){!t||!t["!ref"]||(yr(e,648),yr(e,649,Qwe(wi(t["!ref"]))),yr(e,650))}function cbe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var o=Yi(r,-1,n[1].Target.replace(/#.*$/,""),fi.HLINK);yr(e,494,Wwe(n,o))}}),delete t["!links"]}function ube(e,t,r,n){if(t["!comments"].length>0){var o=Yi(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",fi.VML);yr(e,551,j4("rId"+o)),t["!legacy"]=o}}function hbe(e,t,r,n){if(t["!autofilter"]){var o=t["!autofilter"],u=typeof o.ref=="string"?o.ref:Hn(o.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var d=r.Workbook.Names,i=tl(u);i.s.r==i.e.r&&(i.e.r=tl(t["!ref"]).e.r,u=Hn(i));for(var v=0;v<d.length;++v){var w=d[v];if(w.Name=="_xlnm._FilterDatabase"&&w.Sheet==n){w.Ref="'"+r.SheetNames[n]+"'!"+u;break}}v==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+u}),yr(e,161,xv(wi(u))),yr(e,162)}}function fbe(e,t,r){yr(e,133),yr(e,137,Jwe(t,r)),yr(e,138),yr(e,134)}function dbe(e,t){t["!protect"]&&yr(e,535,ebe(t["!protect"]))}function pbe(e,t,r,n){var o=ml(),u=r.SheetNames[e],d=r.Sheets[u]||{},i=u;try{r&&r.Workbook&&(i=r.Workbook.Sheets[e].CodeName||i)}catch{}var v=wi(d["!ref"]||"A1");if(v.e.c>16383||v.e.r>1048575){if(t.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],yr(o,129),(r.vbaraw||d["!outline"])&&yr(o,147,swe(i,d["!outline"])),yr(o,148,iwe(v)),fbe(o,d,r.Workbook),sbe(o,d),abe(o,d,e,t),dbe(o,d),hbe(o,d,r,e),obe(o,d),cbe(o,d,n),d["!margins"]&&yr(o,476,Ywe(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lbe(o,d),ube(o,d,e,n),yr(o,130),o.end()}function mbe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(u){var d=u.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);d&&(t[+d[1]]=r?+d[2]:d[2])});var o=Ri((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(u){n=u.replace(/<.*?>/g,"")}),[t,o,n]}function gbe(e,t,r,n,o,u){var d=u||{"!type":"chart"};if(!e)return u;var i=0,v=0,w="A",S={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(C){var k=mbe(C);S.s.r=S.s.c=0,S.e.c=i,w=Oa(i),k[0].forEach(function(O,L){d[w+Qa(L)]={t:"n",v:O,z:k[1]},v=L}),S.e.r<v&&(S.e.r=v),++i}),i>0&&(d["!ref"]=Hn(S)),d}function _be(e,t,r,n,o){if(!e)return e;n||(n={"!id":{}});var u={"!type":"chart","!drawel":null,"!rel":""},d,i=e.match(RY);return i&&eL(i[0],u,o,r),(d=e.match(/drawing r:id="(.*?)"/))&&(u["!rel"]=d[1]),n["!id"][u["!rel"]]&&(u["!drawel"]=n["!id"][u["!rel"]]),u}function ybe(e,t){e.l+=10;var r=Ms(e);return{name:r}}function vbe(e,t,r,n,o){if(!e)return e;n||(n={"!id":{}});var u={"!type":"chart","!drawel":null,"!rel":""},d=!1;return Uf(e,function(v,w,S){switch(S){case 550:u["!rel"]=v;break;case 651:o.Sheets[r]||(o.Sheets[r]={}),v.name&&(o.Sheets[r].CodeName=v.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:break;case 38:break;default:if(!(w.T>0)){if(!(w.T<0)){if(!d||t.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}}}},t),n["!id"][u["!rel"]]&&(u["!drawel"]=n["!id"][u["!rel"]]),u}var tL=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xbe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wbe=[],bbe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wU(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],o=0;o!=t.length;++o){var u=t[o];if(n[u[0]]==null)n[u[0]]=u[1];else switch(u[2]){case"bool":typeof n[u[0]]=="string"&&(n[u[0]]=Ia(n[u[0]]));break;case"int":typeof n[u[0]]=="string"&&(n[u[0]]=parseInt(n[u[0]],10));break}}}function bU(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ia(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function NY(e){bU(e.WBProps,tL),bU(e.CalcPr,bbe),wU(e.WBView,xbe),wU(e.Sheets,wbe),my.date1904=Ia(e.WBProps.date1904)}function Tbe(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ia(e.Workbook.WBProps.date1904)?"true":"false"}var Sbe="][*?/\\".split("");function BY(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Sbe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Ebe(e,t,r){e.forEach(function(n,o){BY(n);for(var u=0;u<o;++u)if(n==e[u])throw new Error("Duplicate Sheet Name: "+n);if(r){var d=t&&t[o]&&t[o].CodeName||n;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function zY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Ebe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)T1e(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Abe=/<\w+:workbook/;function Cbe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,o="xmlns",u={},d=0;if(e.replace(Fs,function(v,w){var S=kn(v);switch(Oh(S[0])){case"<?xml":break;case"<workbook":v.match(Abe)&&(o="xmlns"+v.match(/<(\w+):/)[1]),r.xmlns=S[o];break;case"</workbook>":break;case"<fileVersion":delete S[0],r.AppVersion=S;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":tL.forEach(function(C){if(S[C[0]]!=null)switch(C[2]){case"bool":r.WBProps[C[0]]=Ia(S[C[0]]);break;case"int":r.WBProps[C[0]]=parseInt(S[C[0]],10);break;default:r.WBProps[C[0]]=S[C[0]]}}),S.codeName&&(r.WBProps.CodeName=la(S.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete S[0],r.WBView.push(S);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(S.state){case"hidden":S.Hidden=1;break;case"veryHidden":S.Hidden=2;break;default:S.Hidden=0}delete S.state,S.name=Ri(la(S.name)),delete S[0],r.Sheets.push(S);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":u={},u.Name=la(S.name),S.comment&&(u.Comment=S.comment),S.localSheetId&&(u.Sheet=+S.localSheetId),Ia(S.hidden||"0")&&(u.Hidden=!0),d=w+v.length;break;case"</definedName>":u.Ref=Ri(la(e.slice(d,w))),r.Names.push(u);break;case"<definedName/>":break;case"<calcPr":delete S[0],r.CalcPr=S;break;case"<calcPr/>":delete S[0],r.CalcPr=S;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+S[0]+" in workbook")}return v}),L0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return NY(r),r}function jY(e){var t=[co];t[t.length]=Fr("workbook",null,{xmlns:L0[0],"xmlns:r":Ro.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(tL.forEach(function(i){e.Workbook.WBProps[i[0]]!=null&&e.Workbook.WBProps[i[0]]!=i[1]&&(n[i[0]]=e.Workbook.WBProps[i[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Fr("workbookPr",null,n);var o=e.Workbook&&e.Workbook.Sheets||[],u=0;if(o&&o[0]&&o[0].Hidden){for(t[t.length]="<bookViews>",u=0;u!=e.SheetNames.length&&!(!o[u]||!o[u].Hidden);++u);u==e.SheetNames.length&&(u=0),t[t.length]='<workbookView firstSheet="'+u+'" activeTab="'+u+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",u=0;u!=e.SheetNames.length;++u){var d={name:Ki(e.SheetNames[u].slice(0,31))};if(d.sheetId=""+(u+1),d["r:id"]="rId"+(u+1),o[u])switch(o[u].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}t[t.length]=Fr("sheet",null,d)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(i){var v={name:i.Name};i.Comment&&(v.comment=i.Comment),i.Sheet!=null&&(v.localSheetId=""+i.Sheet),i.Hidden&&(v.hidden="1"),i.Ref&&(t[t.length]=Fr("definedName",Ki(i.Ref),v))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Pbe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=f3(e),r.name=Ms(e),r}function Ibe(e,t){return t||(t=rr(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),j4(e.strRelID,t),Ko(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function kbe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var o=t>8?Ms(e):"";return o.length>0&&(r.CodeName=o),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Obe(e,t){t||(t=rr(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kZ(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Mbe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Rbe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var o=e.read_shift(4),u=u0e(e),d=_1e(e,0,r),i=z4(e);e.l=n;var v={Name:u,Ptg:d};return o<268435455&&(v.Sheet=o),i&&(v.Comment=i),v}function Dbe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],o=!1;t||(t={}),t.biff=12;var u=[],d=[[]];return d.SheetNames=[],d.XTI=[],cb[16]={n:"BrtFRTArchID$",f:Mbe},Uf(e,function(v,w,S){switch(S){case 156:d.SheetNames.push(v.name),r.Sheets.push(v);break;case 153:r.WBProps=v;break;case 39:v.Sheet!=null&&(t.SID=v.Sheet),v.Ref=Es(v.Ptg,null,null,d,t),delete t.SID,delete v.Ptg,u.push(v);break;case 1036:break;case 357:case 358:case 355:case 667:d[0].length?d.push([S,v]):d[0]=[S,v],d[d.length-1].XTI=[];break;case 362:d.length===0&&(d[0]=[],d[0].XTI=[]),d[d.length-1].XTI=d[d.length-1].XTI.concat(v),d.XTI=d.XTI.concat(v);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(S),o=!0;break;case 36:n.pop(),o=!1;break;case 37:n.push(S),o=!0;break;case 38:n.pop(),o=!1;break;case 16:break;default:if(!w.T){if(!o||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+S.toString(16))}}},t),NY(r),r.Names=u,r.supbooks=d,r}function Fbe(e,t){yr(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,o={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};yr(e,156,Ibe(o))}yr(e,144)}function Lbe(e,t){t||(t=rr(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ko("SheetJS",t),Ko(Jw.version,t),Ko(Jw.version,t),Ko("7262",t),t.length>t.l?t.slice(0,t.l):t}function Nbe(e,t){t||(t=rr(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Bbe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,o=-1,u=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&o==-1?o=n:r[n].Hidden==1&&u==-1&&(u=n);u>o||(yr(e,135),yr(e,158,Nbe(o)),yr(e,136))}}function zbe(e,t){var r=ml();return yr(r,131),yr(r,128,Lbe()),yr(r,153,Obe(e.Workbook&&e.Workbook.WBProps||null)),Bbe(r,e),Fbe(r,e),yr(r,132),r.end()}function jbe(e,t,r){return t.slice(-4)===".bin"?Dbe(e,r):Cbe(e,r)}function Ube(e,t,r,n,o,u,d,i){return t.slice(-4)===".bin"?nbe(e,n,r,o,u,d,i):D1e(e,n,r,o,u,d,i)}function $be(e,t,r,n,o,u,d,i){return t.slice(-4)===".bin"?vbe(e,n,r,o,u):_be(e,n,r,o,u)}function Vbe(e,t,r,n,o,u,d,i){return t.slice(-4)===".bin"?Hve():qve()}function Wbe(e,t,r,n,o,u,d,i){return t.slice(-4)===".bin"?Wve():Gve()}function Gbe(e,t,r,n){return t.slice(-4)===".bin"?Uye(e,r,n):Iye(e,r,n)}function Hbe(e,t,r){return vY(e,r)}function qbe(e,t,r){return t.slice(-4)===".bin"?X_e(e,r):G_e(e,r)}function Xbe(e,t,r){return t.slice(-4)===".bin"?zve(e,r):kve(e,r)}function Zbe(e,t,r){return t.slice(-4)===".bin"?Cve(e):Eve(e)}function Ybe(e,t,r,n){return r.slice(-4)===".bin"?Pve(e,t,r,n):void 0}function Kbe(e,t,r){return t.slice(-4)===".bin"?bve(e,t,r):Sve(e,t,r)}function Jbe(e,t,r){return(t.slice(-4)===".bin"?zbe:jY)(e)}function Qbe(e,t,r,n,o){return(t.slice(-4)===".bin"?pbe:DY)(e,r,n,o)}function e2e(e,t,r){return(t.slice(-4)===".bin"?Kye:_Y)(e,r)}function t2e(e,t,r){return(t.slice(-4)===".bin"?K_e:cY)(e,r)}function r2e(e,t,r){return(t.slice(-4)===".bin"?jve:bY)(e)}function n2e(e){return(e.slice(-4)===".bin"?Tve:xY)()}var UY=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$Y=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ru(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var o=e.match(UY),u,d,i,v;if(o)for(v=0;v!=o.length;++v)u=o[v].match($Y),(d=u[1].indexOf(":"))===-1?n[u[1]]=u[2].slice(1,u[2].length-1):(u[1].slice(0,6)==="xmlns:"?i="xmlns"+u[1].slice(6):i=u[1].slice(d+1),n[i]=u[2].slice(1,u[2].length-1));return n}function i2e(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(UY),o,u,d,i;if(n)for(i=0;i!=n.length;++i)o=n[i].match($Y),(u=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?d="xmlns"+o[1].slice(6):d=o[1].slice(u+1),r[d]=o[2].slice(1,o[2].length-1));return r}var Sw;function a2e(e,t){var r=Sw[e]||Ri(e);return r==="General"?w0(t):Kl(r,t)}function o2e(e,t,r,n){var o=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":o=Ia(n);break;case"i2":case"int":o=parseInt(n,10);break;case"r4":case"float":o=parseFloat(n);break;case"date":case"dateTime.tz":o=Ma(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ri(t)]=o}function s2e(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||$f[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eb(e.v):e.w=w0(e.v):e.w=a2e(t||"General",e.v)}catch(u){if(r.WTF)throw u}try{var n=Sw[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&F0(n)){var o=ip(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(u){if(r.WTF)throw u}}}function l2e(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=wye[n.Pattern]||n.Pattern)}e[t.ID]=t}function c2e(e,t,r,n,o,u,d,i,v,w){var S="General",C=n.StyleID,k={};w=w||{};var O=[],L=0;for(C===void 0&&i&&(C=i.StyleID),C===void 0&&d&&(C=d.StyleID);u[C]!==void 0&&(u[C].nf&&(S=u[C].nf),u[C].Interior&&O.push(u[C].Interior),!!u[C].Parent);)C=u[C].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ia(e);break;case"String":n.t="s",n.r=zj(Ri(e)),n.v=e.indexOf("<")>-1?Ri(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ma(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ri(e):n.v<60&&(n.v=n.v-1),(!S||S=="General")&&(S="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=FZ[e],w.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=zj(t||e));break}if(s2e(n,S,w),w.cellFormula!==!1)if(n.Formula){var R=Ri(n.Formula);R.charCodeAt(0)==61&&(R=R.slice(1)),n.f=py(R,o),delete n.Formula,n.ArrayRange=="RC"?n.F=py("RC:RC",o):n.ArrayRange&&(n.F=py(n.ArrayRange,o),v.push([wi(n.F),n.F]))}else for(L=0;L<v.length;++L)o.r>=v[L][0].s.r&&o.r<=v[L][0].e.r&&o.c>=v[L][0].s.c&&o.c<=v[L][0].e.c&&(n.F=v[L][1]);w.cellStyles&&(O.forEach(function(N){!k.patternType&&N.patternType&&(k.patternType=N.patternType)}),n.s=k),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function u2e(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _M(e,t){var r=t||{};_v();var n=K_(I4(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Pi<"u"?n=Pi.utils.decode(65001,vA(n)):n=la(n));var o=n.slice(0,1024).toLowerCase(),u=!1;if(o=o.replace(/".*?"/g,""),(o.indexOf(">")&1023)>Math.min(o.indexOf(",")&1023,o.indexOf(";")&1023)){var d=fa(r);return d.type="string",jy.to_workbook(n,d)}if(o.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(jn){o.indexOf("<"+jn)>=0&&(u=!0)}),u)return H2e(n,r);Sw={"General Number":"General","General Date":xn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xn[15],"Short Date":xn[14],"Long Time":xn[19],"Medium Time":xn[18],"Short Time":xn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xn[2],Standard:xn[4],Percent:xn[10],Scientific:xn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var i,v=[],w,S={},C=[],k=r.dense?[]:{},O="",L={},R={},N=ru('<Data ss:Type="String">'),V=0,G=0,U=0,J={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},K={},re="",ge=0,ve=[],$e={},Ie={},ke=0,tt=[],Je=[],et={},at=[],pt,ft=!1,Ue=[],It=[],Rt={},_e=0,Ge=0,qe={Sheets:[],WBProps:{date1904:!1}},Xe={};nb.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var yt="";i=nb.exec(n);)switch(i[3]=(yt=i[3]).toLowerCase()){case"data":if(yt=="data"){if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&v.push([i[3],!0]);break}if(v[v.length-1][1])break;i[1]==="/"?c2e(n.slice(V,i.index),re,N,v[v.length-1][0]=="comment"?et:L,{c:G,r:U},Z,at[G],R,Ue,r):(re="",N=ru(i[0]),V=i.index+i[0].length);break;case"cell":if(i[1]==="/")if(Je.length>0&&(L.c=Je),(!r.sheetRows||r.sheetRows>U)&&L.v!==void 0&&(r.dense?(k[U]||(k[U]=[]),k[U][G]=L):k[Oa(G)+Qa(U)]=L),L.HRef&&(L.l={Target:Ri(L.HRef)},L.HRefScreenTip&&(L.l.Tooltip=L.HRefScreenTip),delete L.HRef,delete L.HRefScreenTip),(L.MergeAcross||L.MergeDown)&&(_e=G+(parseInt(L.MergeAcross,10)|0),Ge=U+(parseInt(L.MergeDown,10)|0),ve.push({s:{c:G,r:U},e:{c:_e,r:Ge}})),!r.sheetStubs)L.MergeAcross?G=_e+1:++G;else if(L.MergeAcross||L.MergeDown){for(var Dt=G;Dt<=_e;++Dt)for(var Yt=U;Yt<=Ge;++Yt)(Dt>G||Yt>U)&&(r.dense?(k[Yt]||(k[Yt]=[]),k[Yt][Dt]={t:"z"}):k[Oa(Dt)+Qa(Yt)]={t:"z"});G=_e+1}else++G;else L=i2e(i[0]),L.Index&&(G=+L.Index-1),G<J.s.c&&(J.s.c=G),G>J.e.c&&(J.e.c=G),i[0].slice(-2)==="/>"&&++G,Je=[];break;case"row":i[1]==="/"||i[0].slice(-2)==="/>"?(U<J.s.r&&(J.s.r=U),U>J.e.r&&(J.e.r=U),i[0].slice(-2)==="/>"&&(R=ru(i[0]),R.Index&&(U=+R.Index-1)),G=0,++U):(R=ru(i[0]),R.Index&&(U=+R.Index-1),Rt={},(R.AutoFitHeight=="0"||R.Height)&&(Rt.hpx=parseInt(R.Height,10),Rt.hpt=lb(Rt.hpx),It[U]=Rt),R.Hidden=="1"&&(Rt.hidden=!0,It[U]=Rt));break;case"worksheet":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"));C.push(O),J.s.r<=J.e.r&&J.s.c<=J.e.c&&(k["!ref"]=Hn(J),r.sheetRows&&r.sheetRows<=J.e.r&&(k["!fullref"]=k["!ref"],J.e.r=r.sheetRows-1,k["!ref"]=Hn(J))),ve.length&&(k["!merges"]=ve),at.length>0&&(k["!cols"]=at),It.length>0&&(k["!rows"]=It),S[O]=k}else J={s:{r:2e6,c:2e6},e:{r:0,c:0}},U=G=0,v.push([i[3],!1]),w=ru(i[0]),O=Ri(w.Name),k=r.dense?[]:{},ve=[],Ue=[],It=[],Xe={name:O,Hidden:0},qe.Sheets.push(Xe);break;case"table":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else{if(i[0].slice(-2)=="/>")break;v.push([i[3],!1]),at=[],ft=!1}break;case"style":i[1]==="/"?l2e(Z,K,r):K=ru(i[0]);break;case"numberformat":K.nf=Ri(ru(i[0]).Format||"General"),Sw[K.nf]&&(K.nf=Sw[K.nf]);for(var St=0;St!=392&&xn[St]!=K.nf;++St);if(St==392){for(St=57;St!=392;++St)if(xn[St]==null){wh(K.nf,St);break}}break;case"column":if(v[v.length-1][0]!=="table")break;if(pt=ru(i[0]),pt.Hidden&&(pt.hidden=!0,delete pt.Hidden),pt.Width&&(pt.wpx=parseInt(pt.Width,10)),!ft&&pt.wpx>10){ft=!0,Cs=mY;for(var Mt=0;Mt<at.length;++Mt)at[Mt]&&Cp(at[Mt])}ft&&Cp(pt),at[pt.Index-1||at.length]=pt;for(var Sr=0;Sr<+pt.Span;++Sr)at[at.length]=fa(pt);break;case"namedrange":if(i[1]==="/")break;qe.Names||(qe.Names=[]);var Ne=kn(i[0]),un={Name:Ne.Name,Ref:py(Ne.RefersTo.slice(1),{r:0,c:0})};qe.Sheets.length>0&&(un.Sheet=qe.Sheets.length-1),qe.Names.push(un);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(i[0].slice(-2)==="/>")break;i[1]==="/"?re+=n.slice(ge,i.index):ge=i.index+i[0].length;break;case"interior":if(!r.cellStyles)break;K.Interior=ru(i[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(i[0].slice(-2)==="/>")break;i[1]==="/"?F0e($e,yt,n.slice(ke,i.index)):ke=i.index+i[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else v.push([i[3],!1]);break;case"comment":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"));u2e(et),Je.push(et)}else v.push([i[3],!1]),w=ru(i[0]),et={a:w.Author};break;case"autofilter":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else if(i[0].charAt(i[0].length-2)!=="/"){var kr=ru(i[0]);k["!autofilter"]={ref:py(kr.Range).replace(/\$/g,"")},v.push([i[3],!0])}break;case"name":break;case"datavalidation":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&v.push([i[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(i[1]==="/"){if((w=v.pop())[0]!==i[3])throw new Error("Bad state: "+w.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&v.push([i[3],!0]);break;case"null":break;default:if(v.length==0&&i[3]=="document"||v.length==0&&i[3]=="uof")return CU(n,r);var Br=!0;switch(v[v.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Br=!1}break;case"componentoptions":switch(i[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Br=!1}break;case"excelworkbook":switch(i[3]){case"date1904":qe.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Br=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":break;case"height":break;case"width":break;default:Br=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if(i[0].slice(-2)!=="/>")if(i[1]==="/")switch(n.slice(ke,i.index)){case"SheetHidden":Xe.Hidden=1;break;case"SheetVeryHidden":Xe.Hidden=2;break}else ke=i.index+i[0].length;break;case"header":k["!margins"]||o0(k["!margins"]={},"xlml"),isNaN(+kn(i[0]).Margin)||(k["!margins"].header=+kn(i[0]).Margin);break;case"footer":k["!margins"]||o0(k["!margins"]={},"xlml"),isNaN(+kn(i[0]).Margin)||(k["!margins"].footer=+kn(i[0]).Margin);break;case"pagemargins":var Yr=kn(i[0]);k["!margins"]||o0(k["!margins"]={},"xlml"),isNaN(+Yr.Top)||(k["!margins"].top=+Yr.Top),isNaN(+Yr.Left)||(k["!margins"].left=+Yr.Left),isNaN(+Yr.Right)||(k["!margins"].right=+Yr.Right),isNaN(+Yr.Bottom)||(k["!margins"].bottom=+Yr.Bottom);break;case"displayrighttoleft":qe.Views||(qe.Views=[]),qe.Views[0]||(qe.Views[0]={}),qe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Br=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Br=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Br=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Br=!1}break;case"querytable":switch(i[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Br=!1}break;case"datavalidation":switch(i[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Br=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Br=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Br=!1}break;case"smarttags":break;default:Br=!1;break}if(Br||i[3].match(/!\[CDATA/))break;if(!v[v.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+v.join("|");if(v[v.length-1][0]==="customdocumentproperties"){if(i[0].slice(-2)==="/>")break;i[1]==="/"?o2e(Ie,yt,tt,n.slice(ke,i.index)):(tt=i,ke=i.index+i[0].length);break}if(r.WTF)throw"Unrecognized tag: "+i[3]+"|"+v.join("|")}var Tr={};return!r.bookSheets&&!r.bookProps&&(Tr.Sheets=S),Tr.SheetNames=C,Tr.Workbook=qe,Tr.SSF=fa(xn),Tr.Props=$e,Tr.Custprops=Ie,Tr}function v3(e,t){switch(iL(t=t||{}),t.type||"base64"){case"base64":return _M(Yl(e),t);case"binary":case"buffer":case"file":return _M(e,t);case"array":return _M(Fp(e),t)}}function h2e(e,t){var r=[];return e.Props&&r.push(L0e(e.Props,t)),e.Custprops&&r.push(N0e(e.Props,e.Custprops)),r.join("")}function f2e(){return""}function d2e(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,o){var u=[];u.push(Fr("NumberFormat",null,{"ss:Format":Ki(xn[n.numFmtId])}));var d={"ss:ID":"s"+(21+o)};r.push(Fr("Style",u.join(""),d))}),Fr("Styles",r.join(""))}function VY(e){return Fr("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+K4(e.Ref,{r:0,c:0})})}function p2e(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var o=t[n];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||r.push(VY(o)))}return Fr("Names",r.join(""))}function m2e(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var o=n.Workbook.Names,u=[],d=0;d<o.length;++d){var i=o[d];i.Sheet==r&&(i.Name.match(/^_xlfn\./)||u.push(VY(i)))}return u.join("")}function g2e(e,t,r,n){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(Fr("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(Fr("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(Fr("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)o.push(Fr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var u=0;u<r&&!(n.Workbook.Sheets[u]&&!n.Workbook.Sheets[u].Hidden);++u);u==r&&o.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(ls("ProtectContents","True")),e["!protect"].objects&&o.push(ls("ProtectObjects","True")),e["!protect"].scenarios&&o.push(ls("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(ls("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(ls("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){e["!protect"][d[0]]&&o.push("<"+d[1]+"/>")})),o.length==0?"":Fr("WorksheetOptions",o.join(""),{xmlns:Ul.x})}function _2e(e){return e.map(function(t){var r=zme(t.t||""),n=Fr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fr("Comment",n,{"ss:Author":t.a})}).join("")}function y2e(e,t,r,n,o,u,d){if(!e||e.v==null&&e.f==null)return"";var i={};if(e.f&&(i["ss:Formula"]="="+Ki(K4(e.f,d))),e.F&&e.F.slice(0,t.length)==t){var v=Va(e.F.slice(t.length+1));i["ss:ArrayRange"]="RC:R"+(v.r==d.r?"":"["+(v.r-d.r)+"]")+"C"+(v.c==d.c?"":"["+(v.c-d.c)+"]")}if(e.l&&e.l.Target&&(i["ss:HRef"]=Ki(e.l.Target),e.l.Tooltip&&(i["x:HRefScreenTip"]=Ki(e.l.Tooltip))),r["!merges"])for(var w=r["!merges"],S=0;S!=w.length;++S)w[S].s.c!=d.c||w[S].s.r!=d.r||(w[S].e.c>w[S].s.c&&(i["ss:MergeAcross"]=w[S].e.c-w[S].s.c),w[S].e.r>w[S].s.r&&(i["ss:MergeDown"]=w[S].e.r-w[S].s.r));var C="",k="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":C="Number",k=String(e.v);break;case"b":C="Boolean",k=e.v?"1":"0";break;case"e":C="Error",k=$f[e.v];break;case"d":C="DateTime",k=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xn[14]);break;case"s":C="String",k=Bme(e.v||"");break}var O=Np(n.cellXfs,e,n);i["ss:StyleID"]="s"+(21+O),i["ss:Index"]=d.c+1;var L=e.v!=null?k:"",R=e.t=="z"?"":'<Data ss:Type="'+C+'">'+L+"</Data>";return(e.c||[]).length>0&&(R+=_2e(e.c)),Fr("Cell",R,i)}function v2e(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Uy(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function x2e(e,t,r,n){if(!e["!ref"])return"";var o=wi(e["!ref"]),u=e["!merges"]||[],d=0,i=[];e["!cols"]&&e["!cols"].forEach(function(N,V){Cp(N);var G=!!N.width,U=EP(V,N),J={"ss:Index":V+1};G&&(J["ss:Width"]=ob(U.width)),N.hidden&&(J["ss:Hidden"]="1"),i.push(Fr("Column",null,J))});for(var v=Array.isArray(e),w=o.s.r;w<=o.e.r;++w){for(var S=[v2e(w,(e["!rows"]||[])[w])],C=o.s.c;C<=o.e.c;++C){var k=!1;for(d=0;d!=u.length;++d)if(!(u[d].s.c>C)&&!(u[d].s.r>w)&&!(u[d].e.c<C)&&!(u[d].e.r<w)){(u[d].s.c!=C||u[d].s.r!=w)&&(k=!0);break}if(!k){var O={r:w,c:C},L=Pn(O),R=v?(e[w]||[])[C]:e[L];S.push(y2e(R,L,e,t,r,n,O))}}S.push("</Row>"),S.length>2&&i.push(S.join(""))}return i.join("")}function w2e(e,t,r){var n=[],o=r.SheetNames[e],u=r.Sheets[o],d=u?m2e(u,t,e,r):"";return d.length>0&&n.push("<Names>"+d+"</Names>"),d=u?x2e(u,t,e,r):"",d.length>0&&n.push("<Table>"+d+"</Table>"),n.push(g2e(u,t,e,r)),n.join("")}function b2e(e,t){t||(t={}),e.SSF||(e.SSF=fa(xn)),e.SSF&&(_v(),h2(e.SSF),t.revssf=vP(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Np(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(h2e(e,t)),r.push(f2e()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Fr("Worksheet",w2e(n,t,e),{"ss:Name":Ki(e.SheetNames[n])}));return r[2]=d2e(e,t),r[3]=p2e(e),co+Fr("Workbook",r.join(""),{xmlns:Ul.ss,"xmlns:o":Ul.o,"xmlns:x":Ul.x,"xmlns:ss":Ul.ss,"xmlns:dt":Ul.dt,"xmlns:html":Ul.html})}function T2e(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=m0e(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=g0e(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var S2e=[60,1084,2066,2165,2175];function E2e(e,t,r,n,o){var u=n,d=[],i=r.slice(r.l,r.l+u);if(o&&o.enc&&o.enc.insitu&&i.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:o.enc.insitu(i)}d.push(i),r.l+=u;for(var v=yf(r,r.l),w=x3[v],S=0;w!=null&&S2e.indexOf(v)>-1;)u=yf(r,r.l+2),S=r.l+4,v==2066?S+=4:(v==2165||v==2175)&&(S+=12),i=r.slice(S,r.l+4+u),d.push(i),r.l+=4+u,w=x3[v=yf(r,r.l)];var C=Yo(d);ss(C,0);var k=0;C.lens=[];for(var O=0;O<d.length;++O)C.lens.push(k),k+=d[O].length;if(C.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+C.length+" < "+n;return t.f(C,C.length,o)}function nh(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xn[n])}catch(u){if(t.WTF)throw u}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||$f[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eb(e.v):e.w=w0(e.v):e.w=Kl(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(u){if(t.WTF)throw u}if(t.cellDates&&n&&e.t=="n"&&F0(xn[n]||String(n))){var o=ip(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}}function iE(e,t,r){return{v:e,ixfe:t,t:r}}function A2e(e,t){var r={opts:{}},n={},o=t.dense?[]:{},u={},d={},i=null,v=[],w="",S={},C,k="",O,L,R,N,V={},G=[],U,J,Z=[],K=[],re={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ge={},ve=function(_n){return _n<8?n0[_n]:_n<64&&K[_n-8]||n0[_n]},$e=function(_n,Nn,Gi){var ji=Nn.XF.data;if(!(!ji||!ji.patternType||!Gi||!Gi.cellStyles)){Nn.s={},Nn.s.patternType=ji.patternType;var ba;(ba=ab(ve(ji.icvFore)))&&(Nn.s.fgColor={rgb:ba}),(ba=ab(ve(ji.icvBack)))&&(Nn.s.bgColor={rgb:ba})}},Ie=function(_n,Nn,Gi){if(!(Rt>1)&&!(Gi.sheetRows&&_n.r>=Gi.sheetRows)){if(Gi.cellStyles&&Nn.XF&&Nn.XF.data&&$e(_n,Nn,Gi),delete Nn.ixfe,delete Nn.XF,C=_n,k=Pn(_n),(!d||!d.s||!d.e)&&(d={s:{r:0,c:0},e:{r:0,c:0}}),_n.r<d.s.r&&(d.s.r=_n.r),_n.c<d.s.c&&(d.s.c=_n.c),_n.r+1>d.e.r&&(d.e.r=_n.r+1),_n.c+1>d.e.c&&(d.e.c=_n.c+1),Gi.cellFormula&&Nn.f){for(var ji=0;ji<G.length;++ji)if(!(G[ji][0].s.c>_n.c||G[ji][0].s.r>_n.r)&&!(G[ji][0].e.c<_n.c||G[ji][0].e.r<_n.r)){Nn.F=Hn(G[ji][0]),(G[ji][0].s.c!=_n.c||G[ji][0].s.r!=_n.r)&&delete Nn.f,Nn.f&&(Nn.f=""+Es(G[ji][1],d,_n,Ue,ke));break}}Gi.dense?(o[_n.r]||(o[_n.r]=[]),o[_n.r][_n.c]=Nn):o[k]=Nn}},ke={enc:!1,sbcch:0,snames:[],sharedf:V,arrayf:G,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ke.password=t.password);var tt,Je=[],et=[],at=[],pt=[],ft=!1,Ue=[];Ue.SheetNames=ke.snames,Ue.sharedf=ke.sharedf,Ue.arrayf=ke.arrayf,Ue.names=[],Ue.XTI=[];var It=0,Rt=0,_e=0,Ge=[],qe=[],Xe;ke.codepage=1200,Pc(1200);for(var yt=!1;e.l<e.length-1;){var Dt=e.l,Yt=e.read_shift(2);if(Yt===0&&It===10)break;var St=e.l===e.length?0:e.read_shift(2),Mt=x3[Yt];if(Mt&&Mt.f){if(t.bookSheets&&It===133&&Yt!==133)break;if(It=Yt,Mt.r===2||Mt.r==12){var Sr=e.read_shift(2);if(St-=2,!ke.enc&&Sr!==Yt&&((Sr&255)<<8|Sr>>8)!==Yt)throw new Error("rt mismatch: "+Sr+"!="+Yt);Mt.r==12&&(e.l+=10,St-=10)}var Ne={};if(Yt===10?Ne=Mt.f(e,St,ke):Ne=E2e(Yt,Mt,e,St,ke),Rt==0&&[9,521,1033,2057].indexOf(It)===-1)continue;switch(Yt){case 34:r.opts.Date1904=re.WBProps.date1904=Ne;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(ke.enc||(e.l=0),ke.enc=Ne,!t.password)throw new Error("File is password-protected");if(Ne.valid==null)throw new Error("Encryption scheme unsupported");if(!Ne.valid)throw new Error("Password is incorrect");break;case 92:ke.lastuser=Ne;break;case 66:var un=Number(Ne);switch(un){case 21010:un=1200;break;case 32768:un=1e4;break;case 32769:un=1252;break}Pc(ke.codepage=un),yt=!0;break;case 317:ke.rrtabid=Ne;break;case 25:ke.winlocked=Ne;break;case 439:r.opts.RefreshAll=Ne;break;case 12:r.opts.CalcCount=Ne;break;case 16:r.opts.CalcDelta=Ne;break;case 17:r.opts.CalcIter=Ne;break;case 13:r.opts.CalcMode=Ne;break;case 14:r.opts.CalcPrecision=Ne;break;case 95:r.opts.CalcSaveRecalc=Ne;break;case 15:ke.CalcRefMode=Ne;break;case 2211:r.opts.FullCalc=Ne;break;case 129:Ne.fDialog&&(o["!type"]="dialog"),Ne.fBelow||((o["!outline"]||(o["!outline"]={})).above=!0),Ne.fRight||((o["!outline"]||(o["!outline"]={})).left=!0);break;case 224:Z.push(Ne);break;case 430:Ue.push([Ne]),Ue[Ue.length-1].XTI=[];break;case 35:case 547:Ue[Ue.length-1].push(Ne);break;case 24:case 536:Xe={Name:Ne.Name,Ref:Es(Ne.rgce,d,null,Ue,ke)},Ne.itab>0&&(Xe.Sheet=Ne.itab-1),Ue.names.push(Xe),Ue[0]||(Ue[0]=[],Ue[0].XTI=[]),Ue[Ue.length-1].push(Ne),Ne.Name=="_xlnm._FilterDatabase"&&Ne.itab>0&&Ne.rgce&&Ne.rgce[0]&&Ne.rgce[0][0]&&Ne.rgce[0][0][0]=="PtgArea3d"&&(qe[Ne.itab-1]={ref:Hn(Ne.rgce[0][0][1][2])});break;case 22:ke.ExternCount=Ne;break;case 23:Ue.length==0&&(Ue[0]=[],Ue[0].XTI=[]),Ue[Ue.length-1].XTI=Ue[Ue.length-1].XTI.concat(Ne),Ue.XTI=Ue.XTI.concat(Ne);break;case 2196:if(ke.biff<8)break;Xe!=null&&(Xe.Comment=Ne[1]);break;case 18:o["!protect"]=Ne;break;case 19:Ne!==0&&ke.WTF&&console.error("Password verifier: "+Ne);break;case 133:u[Ne.pos]=Ne,ke.snames.push(Ne.name);break;case 10:{if(--Rt)break;if(d.e){if(d.e.r>0&&d.e.c>0){if(d.e.r--,d.e.c--,o["!ref"]=Hn(d),t.sheetRows&&t.sheetRows<=d.e.r){var kr=d.e.r;d.e.r=t.sheetRows-1,o["!fullref"]=o["!ref"],o["!ref"]=Hn(d),d.e.r=kr}d.e.r++,d.e.c++}Je.length>0&&(o["!merges"]=Je),et.length>0&&(o["!objects"]=et),at.length>0&&(o["!cols"]=at),pt.length>0&&(o["!rows"]=pt),re.Sheets.push(ge)}w===""?S=o:n[w]=o,o=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ke.biff===8&&(ke.biff={9:2,521:3,1033:4}[Yt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Ne.BIFFVer]||8),ke.biffguess=Ne.BIFFVer==0,Ne.BIFFVer==0&&Ne.dt==4096&&(ke.biff=5,yt=!0,Pc(ke.codepage=28591)),ke.biff==8&&Ne.BIFFVer==0&&Ne.dt==16&&(ke.biff=2),Rt++)break;if(o=t.dense?[]:{},ke.biff<8&&!yt&&(yt=!0,Pc(ke.codepage=t.codepage||1252)),ke.biff<5||Ne.BIFFVer==0&&Ne.dt==4096){w===""&&(w="Sheet1"),d={s:{r:0,c:0},e:{r:0,c:0}};var Br={pos:e.l-St,name:w};u[Br.pos]=Br,ke.snames.push(w)}else w=(u[Dt]||{name:""}).name;Ne.dt==32&&(o["!type"]="chart"),Ne.dt==64&&(o["!type"]="macro"),Je=[],et=[],ke.arrayf=G=[],at=[],pt=[],ft=!1,ge={Hidden:(u[Dt]||{hs:0}).hs,name:w}}break;case 515:case 3:case 2:o["!type"]=="chart"&&(t.dense?(o[Ne.r]||[])[Ne.c]:o[Pn({c:Ne.c,r:Ne.r})])&&++Ne.c,U={ixfe:Ne.ixfe,XF:Z[Ne.ixfe]||{},v:Ne.val,t:"n"},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t);break;case 5:case 517:U={ixfe:Ne.ixfe,XF:Z[Ne.ixfe],v:Ne.val,t:Ne.t},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t);break;case 638:U={ixfe:Ne.ixfe,XF:Z[Ne.ixfe],v:Ne.rknum,t:"n"},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t);break;case 189:for(var Yr=Ne.c;Yr<=Ne.C;++Yr){var Tr=Ne.rkrec[Yr-Ne.c][0];U={ixfe:Tr,XF:Z[Tr],v:Ne.rkrec[Yr-Ne.c][1],t:"n"},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Yr,r:Ne.r},U,t)}break;case 6:case 518:case 1030:{if(Ne.val=="String"){i=Ne;break}if(U=iE(Ne.val,Ne.cell.ixfe,Ne.tt),U.XF=Z[U.ixfe],t.cellFormula){var jn=Ne.formula;if(jn&&jn[0]&&jn[0][0]&&jn[0][0][0]=="PtgExp"){var Un=jn[0][0][1][0],Wi=jn[0][0][1][1],Yn=Pn({r:Un,c:Wi});V[Yn]?U.f=""+Es(Ne.formula,d,Ne.cell,Ue,ke):U.F=((t.dense?(o[Un]||[])[Wi]:o[Yn])||{}).F}else U.f=""+Es(Ne.formula,d,Ne.cell,Ue,ke)}_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie(Ne.cell,U,t),i=Ne}break;case 7:case 519:if(i)i.val=Ne,U=iE(Ne,i.cell.ixfe,"s"),U.XF=Z[U.ixfe],t.cellFormula&&(U.f=""+Es(i.formula,d,i.cell,Ue,ke)),_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie(i.cell,U,t),i=null;else throw new Error("String record expects Formula");break;case 33:case 545:{G.push(Ne);var ta=Pn(Ne[0].s);if(O=t.dense?(o[Ne[0].s.r]||[])[Ne[0].s.c]:o[ta],t.cellFormula&&O){if(!i||!ta||!O)break;O.f=""+Es(Ne[1],d,Ne[0],Ue,ke),O.F=Hn(Ne[0])}}break;case 1212:{if(!t.cellFormula)break;if(k){if(!i)break;V[Pn(i.cell)]=Ne[0],O=t.dense?(o[i.cell.r]||[])[i.cell.c]:o[Pn(i.cell)],(O||{}).f=""+Es(Ne[0],d,C,Ue,ke)}}break;case 253:U=iE(v[Ne.isst].t,Ne.ixfe,"s"),v[Ne.isst].h&&(U.h=v[Ne.isst].h),U.XF=Z[U.ixfe],_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t);break;case 513:t.sheetStubs&&(U={ixfe:Ne.ixfe,XF:Z[Ne.ixfe],t:"z"},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t));break;case 190:if(t.sheetStubs)for(var Di=Ne.c;Di<=Ne.C;++Di){var ra=Ne.ixfe[Di-Ne.c];U={ixfe:ra,XF:Z[ra],t:"z"},_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Di,r:Ne.r},U,t)}break;case 214:case 516:case 4:U=iE(Ne.val,Ne.ixfe,"s"),U.XF=Z[U.ixfe],_e>0&&(U.z=Ge[U.ixfe>>8&63]),nh(U,t,r.opts.Date1904),Ie({c:Ne.c,r:Ne.r},U,t);break;case 0:case 512:Rt===1&&(d=Ne);break;case 252:v=Ne;break;case 1054:if(ke.biff==4){Ge[_e++]=Ne[1];for(var Ra=0;Ra<_e+163&&xn[Ra]!=Ne[1];++Ra);Ra>=163&&wh(Ne[1],_e+163)}else wh(Ne[1],Ne[0]);break;case 30:{Ge[_e++]=Ne;for(var ei=0;ei<_e+163&&xn[ei]!=Ne;++ei);ei>=163&&wh(Ne,_e+163)}break;case 229:Je=Je.concat(Ne);break;case 93:et[Ne.cmo[0]]=ke.lastobj=Ne;break;case 438:ke.lastobj.TxO=Ne;break;case 127:ke.lastobj.ImData=Ne;break;case 440:for(N=Ne[0].s.r;N<=Ne[0].e.r;++N)for(R=Ne[0].s.c;R<=Ne[0].e.c;++R)O=t.dense?(o[N]||[])[R]:o[Pn({c:R,r:N})],O&&(O.l=Ne[1]);break;case 2048:for(N=Ne[0].s.r;N<=Ne[0].e.r;++N)for(R=Ne[0].s.c;R<=Ne[0].e.c;++R)O=t.dense?(o[N]||[])[R]:o[Pn({c:R,r:N})],O&&O.l&&(O.l.Tooltip=Ne[1]);break;case 28:{if(ke.biff<=5&&ke.biff>=2)break;O=t.dense?(o[Ne[0].r]||[])[Ne[0].c]:o[Pn(Ne[0])];var na=et[Ne[2]];O||(t.dense?(o[Ne[0].r]||(o[Ne[0].r]=[]),O=o[Ne[0].r][Ne[0].c]={t:"z"}):O=o[Pn(Ne[0])]={t:"z"},d.e.r=Math.max(d.e.r,Ne[0].r),d.s.r=Math.min(d.s.r,Ne[0].r),d.e.c=Math.max(d.e.c,Ne[0].c),d.s.c=Math.min(d.s.c,Ne[0].c)),O.c||(O.c=[]),L={a:Ne[1],t:na.TxO.t},O.c.push(L)}break;case 2173:pve(Z[Ne.ixfe],Ne.ext);break;case 125:{if(!ke.cellStyles)break;for(;Ne.e>=Ne.s;)at[Ne.e--]={width:Ne.w/256,level:Ne.level||0,hidden:!!(Ne.flags&1)},ft||(ft=!0,X4(Ne.w/256)),Cp(at[Ne.e+1])}break;case 520:{var wa={};Ne.level!=null&&(pt[Ne.r]=wa,wa.level=Ne.level),Ne.hidden&&(pt[Ne.r]=wa,wa.hidden=!0),Ne.hpt&&(pt[Ne.r]=wa,wa.hpt=Ne.hpt,wa.hpx=Uy(Ne.hpt))}break;case 38:case 39:case 40:case 41:o["!margins"]||o0(o["!margins"]={}),o["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Yt]]=Ne;break;case 161:o["!margins"]||o0(o["!margins"]={}),o["!margins"].header=Ne.header,o["!margins"].footer=Ne.footer;break;case 574:Ne.RTL&&(re.Views[0].RTL=!0);break;case 146:K=Ne;break;case 2198:tt=Ne;break;case 140:J=Ne;break;case 442:w?ge.CodeName=Ne||ge.name:re.WBProps.CodeName=Ne||"ThisWorkbook";break}}else Mt||console.error("Missing Info for XLS Record 0x"+Yt.toString(16)),e.l+=St}return r.SheetNames=to(u).sort(function(Da,_n){return Number(Da)-Number(_n)}).map(function(Da){return u[Da].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&S["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=S)):r.Preamble=S,r.Sheets&&qe.forEach(function(Da,_n){r.Sheets[r.SheetNames[_n]]["!autofilter"]=Da}),r.Strings=v,r.SSF=fa(xn),ke.enc&&(r.Encryption=ke.enc),tt&&(r.Themes=tt),r.Metadata={},J!==void 0&&(r.Metadata.Country=J),Ue.names.length>0&&(re.Names=Ue.names),r.Workbook=re,r}var Ew={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function C2e(e,t,r){var n=pn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var o=nU(n,d3,Ew.DSI);for(var u in o)t[u]=o[u]}catch(w){if(r.WTF)throw w}var d=pn.find(e,"/!SummaryInformation");if(d&&d.size>0)try{var i=nU(d,p3,Ew.SI);for(var v in i)t[v]==null&&(t[v]=i[v])}catch(w){if(r.WTF)throw w}t.HeadingPairs&&t.TitlesOfParts&&(UZ(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function P2e(e,t){var r=[],n=[],o=[],u=0,d,i=Rj(d3,"n"),v=Rj(p3,"n");if(e.Props)for(d=to(e.Props),u=0;u<d.length;++u)(Object.prototype.hasOwnProperty.call(i,d[u])?r:Object.prototype.hasOwnProperty.call(v,d[u])?n:o).push([d[u],e.Props[d[u]]]);if(e.Custprops)for(d=to(e.Custprops),u=0;u<d.length;++u)Object.prototype.hasOwnProperty.call(e.Props||{},d[u])||(Object.prototype.hasOwnProperty.call(i,d[u])?r:Object.prototype.hasOwnProperty.call(v,d[u])?n:o).push([d[u],e.Custprops[d[u]]]);var w=[];for(u=0;u<o.length;++u)XZ.indexOf(o[u][0])>-1||jZ.indexOf(o[u][0])>-1||o[u][1]!=null&&w.push(o[u]);n.length&&pn.utils.cfb_add(t,"/SummaryInformation",iU(n,Ew.SI,v,p3)),(r.length||w.length)&&pn.utils.cfb_add(t,"/DocumentSummaryInformation",iU(r,Ew.DSI,i,d3,w.length?w:null,Ew.UDI))}function rL(e,t){t||(t={}),iL(t),_P(),t.codepage&&gP(t.codepage);var r,n;if(e.FullPaths){if(pn.find(e,"/encryption"))throw new Error("File is password-protected");r=pn.find(e,"!CompObj"),n=pn.find(e,"/Workbook")||pn.find(e,"/Book")}else{switch(t.type){case"base64":e=$l(Yl(e));break;case"binary":e=$l(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ss(e,0),n={content:e}}var o,u;if(r&&T2e(r),t.bookProps&&!t.bookSheets)o={};else{var d=oi?"buffer":"array";if(n&&n.content)o=A2e(n.content,t);else if((u=pn.find(e,"PerfectOffice_MAIN"))&&u.content)o=a0.to_workbook(u.content,(t.type=d,t));else if((u=pn.find(e,"NativeContent_MAIN"))&&u.content)o=a0.to_workbook(u.content,(t.type=d,t));else throw(u=pn.find(e,"MN0"))&&u.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&pn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(o.vbaraw=$ve(e))}var i={};return e.FullPaths&&C2e(e,i,t),o.Props=o.Custprops=i,t.bookFiles&&(o.cfb=e),o}function I2e(e,t){var r=t||{},n=pn.utils.cfb_new({root:"R"}),o="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":o="/Workbook",r.biff=8;break;case"biff5":o="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return pn.utils.cfb_add(n,o,WY(e,r)),r.biff==8&&(e.Props||e.Custprops)&&P2e(e,n),r.biff==8&&e.vbaraw&&Vve(n,pn.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var cb={0:{f:ewe},1:{f:lwe},2:{f:Cwe},3:{f:gwe},4:{f:fwe},5:{f:Swe},6:{f:Mwe},7:{f:xwe},8:{f:zwe},9:{f:Bwe},10:{f:Lwe},11:{f:Nwe},12:{f:uwe},13:{f:Iwe},14:{f:ywe},15:{f:pwe},16:{f:FY},17:{f:Dwe},18:{f:bwe},19:{f:B4},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Rbe},40:{},42:{},43:{f:Mye},44:{f:kye},45:{f:Fye},46:{f:Nye},47:{f:Lye},48:{},49:{f:n0e},50:{},51:{f:_ve},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aY},62:{f:Owe},63:{f:Ave},64:{f:tbe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ds,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Kwe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:owe},148:{f:nwe,p:16},151:{f:Gwe},152:{},153:{f:kbe},154:{},155:{},156:{f:Pbe},157:{},158:{},159:{T:1,f:q_e},160:{T:-1},161:{T:1,f:j0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jwe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:mve},336:{T:-1},337:{f:xve,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:f3},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iY},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Hwe},427:{f:qwe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Zwe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:awe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Vwe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:f3},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Nve},633:{T:1},634:{T:-1},635:{T:1,f:Fve},636:{T:-1},637:{f:s0e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ybe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rbe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},x3={6:{f:mM},10:{f:Bd},12:{f:yo},13:{f:yo},14:{f:oo},15:{f:oo},16:{f:ks},17:{f:oo},18:{f:oo},19:{f:yo},20:{f:uU},21:{f:uU},23:{f:iY},24:{f:fU},25:{f:oo},26:{},27:{},28:{f:r_e},29:{},34:{f:oo},35:{f:hU},38:{f:ks},39:{f:ks},40:{f:ks},41:{f:ks},42:{f:oo},43:{f:oo},47:{f:pye},49:{f:Ige},51:{f:yo},60:{},61:{f:Sge},64:{f:oo},65:{f:Pge},66:{f:yo},77:{},80:{},81:{},82:{},85:{f:yo},89:{},90:{},91:{},92:{f:dge},93:{f:a_e},94:{},95:{f:oo},96:{},97:{},99:{f:oo},125:{f:aY},128:{f:Wge},129:{f:mge},130:{f:yo},131:{f:oo},132:{f:oo},133:{f:gge},134:{},140:{f:d_e},141:{f:yo},144:{},146:{f:g_e},151:{},152:{},153:{},154:{},155:{},156:{f:yo},157:{},158:{},160:{f:T_e},161:{f:v_e},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:jge},190:{f:Uge},193:{f:Bd},197:{},198:{},199:{},200:{},201:{},202:{f:oo},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yo},220:{},221:{f:oo},222:{},224:{f:Vge},225:{f:fge},226:{f:Bd},227:{},229:{f:n_e},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yge},253:{f:Oge},255:{f:xge},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZZ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:oo},353:{f:Bd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Zge},431:{f:oo},432:{},433:{},434:{},437:{},438:{f:l_e},439:{f:oo},440:{f:c_e},441:{},442:{f:p2},443:{},444:{f:yo},445:{},446:{},448:{f:Bd},449:{f:Tge,r:2},450:{f:Bd},512:{f:sU},513:{f:b_e},515:{f:qge},516:{f:Rge},517:{f:cU},519:{f:S_e},520:{f:wge},523:{},545:{f:dU},549:{f:oU},566:{},574:{f:Age},638:{f:zge},659:{},1048:{},1054:{f:Fge},1084:{},1212:{f:Qge},2048:{f:h_e},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tE},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:__e,r:12},2173:{f:dve,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:oo,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Jge,r:12},2197:{},2198:{f:sve,r:12},2199:{},2200:{},2201:{},2202:{f:e_e,r:12},2203:{f:Bd},2204:{},2205:{},2206:{},2207:{},2211:{f:bge},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yo},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:x_e},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:m_e},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sU},1:{},2:{f:I_e},3:{f:C_e},4:{f:A_e},5:{f:cU},7:{f:O_e},8:{},9:{f:tE},11:{},22:{f:yo},30:{f:Nge},31:{},32:{},33:{f:dU},36:{},37:{f:oU},50:{f:M_e},62:{},52:{},67:{},68:{f:yo},69:{},86:{},126:{},127:{f:E_e},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:R_e},223:{},234:{},354:{},421:{},518:{f:mM},521:{f:tE},536:{f:fU},547:{f:hU},561:{},579:{},1030:{f:mM},1033:{f:tE},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Nr(e,t,r,n){var o=t;if(!isNaN(o)){var u=n||(r||[]).length||0,d=e.next(4);d.write_shift(2,o),d.write_shift(2,u),u>0&&F4(r)&&e.push(r)}}function k2e(e,t,r,n){var o=(r||[]).length||0;if(o<=8224)return Nr(e,t,r,o);var u=t;if(!isNaN(u)){for(var d=r.parts||[],i=0,v=0,w=0;w+(d[i]||8224)<=8224;)w+=d[i]||8224,i++;var S=e.next(4);for(S.write_shift(2,u),S.write_shift(2,w),e.push(r.slice(v,v+w)),v+=w;v<o;){for(S=e.next(4),S.write_shift(2,60),w=0;w+(d[i]||8224)<=8224;)w+=d[i]||8224,i++;S.write_shift(2,w),e.push(r.slice(v,v+w)),v+=w}}}function y2(e,t,r){return e||(e=rr(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function O2e(e,t,r,n){var o=rr(9);return y2(o,e,t),YZ(r,n||"b",o),o}function M2e(e,t,r){var n=rr(8+2*r.length);return y2(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function R2e(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var o=t.t=="d"?Lo(Ma(t.v)):t.v;o==(o|0)&&o>=0&&o<65536?Nr(e,2,k_e(r,n,o)):Nr(e,3,P_e(r,n,o));return;case"b":case"e":Nr(e,5,O2e(r,n,t.v,t.t));return;case"s":case"str":Nr(e,4,M2e(r,n,(t.v||"").slice(0,255)));return}Nr(e,1,y2(null,r,n))}function D2e(e,t,r,n){var o=Array.isArray(t),u=wi(t["!ref"]||"A1"),d,i="",v=[];if(u.e.c>255||u.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,16383),d=Hn(u)}for(var w=u.s.r;w<=u.e.r;++w){i=Qa(w);for(var S=u.s.c;S<=u.e.c;++S){w===u.s.r&&(v[S]=Oa(S)),d=v[S]+i;var C=o?(t[w]||[])[S]:t[d];C&&R2e(e,C,w,S)}}}function F2e(e,t){for(var r=t||{},n=ml(),o=0,u=0;u<e.SheetNames.length;++u)e.SheetNames[u]==r.sheet&&(o=u);if(o==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Nr(n,r.biff==4?1033:r.biff==3?521:9,G4(e,16,r)),D2e(n,e.Sheets[e.SheetNames[o]],o,r),Nr(n,10),n.end()}function L2e(e,t,r){Nr(e,49,kge({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function N2e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var o=n[0];o<=n[1];++o)t[o]!=null&&Nr(e,1054,Lge(o,t[o],r))})}function B2e(e,t){var r=rr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Nr(e,2151,r),r=rr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),tY(wi(t["!ref"]||"A1"),r),r.write_shift(4,4),Nr(e,2152,r)}function z2e(e,t){for(var r=0;r<16;++r)Nr(e,224,lU({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Nr(e,224,lU(n,0,t))})}function j2e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Nr(e,440,u_e(n)),n[1].Tooltip&&Nr(e,2048,f_e(n))}delete t["!links"]}function U2e(e,t){if(t){var r=0;t.forEach(function(n,o){++r<=256&&n&&Nr(e,125,y_e(EP(o,n),o))})}}function $2e(e,t,r,n,o){var u=16+Np(o.cellXfs,t,o);if(t.v==null&&!t.bf){Nr(e,513,E0(r,n,u));return}if(t.bf)Nr(e,6,m1e(t,r,n,o,u));else switch(t.t){case"d":case"n":var d=t.t=="d"?Lo(Ma(t.v)):t.v;Nr(e,515,Xge(r,n,d,u));break;case"b":case"e":Nr(e,517,Hge(r,n,t.v,u,o,t.t));break;case"s":case"str":if(o.bookSST){var i=Q4(o.Strings,t.v,o.revStrings);Nr(e,253,Mge(r,n,i,u))}else Nr(e,516,Dge(r,n,(t.v||"").slice(0,255),u,o));break;default:Nr(e,513,E0(r,n,u))}}function V2e(e,t,r){var n=ml(),o=r.SheetNames[e],u=r.Sheets[o]||{},d=(r||{}).Workbook||{},i=(d.Sheets||[])[e]||{},v=Array.isArray(u),w=t.biff==8,S,C="",k=[],O=wi(u["!ref"]||"A1"),L=w?65536:16384;if(O.e.c>255||O.e.r>=L){if(t.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:IV16384");O.e.c=Math.min(O.e.c,255),O.e.r=Math.min(O.e.c,L-1)}Nr(n,2057,G4(r,16,t)),Nr(n,13,wc(1)),Nr(n,12,wc(100)),Nr(n,15,Ks(!0)),Nr(n,17,Ks(!1)),Nr(n,16,T0(.001)),Nr(n,95,Ks(!0)),Nr(n,42,Ks(!1)),Nr(n,43,Ks(!1)),Nr(n,130,wc(1)),Nr(n,128,Gge()),Nr(n,131,Ks(!1)),Nr(n,132,Ks(!1)),w&&U2e(n,u["!cols"]),Nr(n,512,Bge(O,t)),w&&(u["!links"]=[]);for(var R=O.s.r;R<=O.e.r;++R){C=Qa(R);for(var N=O.s.c;N<=O.e.c;++N){R===O.s.r&&(k[N]=Oa(N)),S=k[N]+C;var V=v?(u[R]||[])[N]:u[S];V&&($2e(n,V,R,N,t),w&&V.l&&u["!links"].push([S,V.l]))}}var G=i.CodeName||i.name||o;return w&&Nr(n,574,Cge((d.Views||[])[0])),w&&(u["!merges"]||[]).length&&Nr(n,229,i_e(u["!merges"])),w&&j2e(n,u),Nr(n,442,KZ(G)),w&&B2e(n,u),Nr(n,10),n.end()}function W2e(e,t,r){var n=ml(),o=(e||{}).Workbook||{},u=o.Sheets||[],d=o.WBProps||{},i=r.biff==8,v=r.biff==5;if(Nr(n,2057,G4(e,5,r)),r.bookType=="xla"&&Nr(n,135),Nr(n,225,i?wc(1200):null),Nr(n,193,H0e(2)),v&&Nr(n,191),v&&Nr(n,192),Nr(n,226),Nr(n,92,pge("SheetJS",r)),Nr(n,66,wc(i?1200:1252)),i&&Nr(n,353,wc(0)),i&&Nr(n,448),Nr(n,317,w_e(e.SheetNames.length)),i&&e.vbaraw&&Nr(n,211),i&&e.vbaraw){var w=d.CodeName||"ThisWorkbook";Nr(n,442,KZ(w))}Nr(n,156,wc(17)),Nr(n,25,Ks(!1)),Nr(n,18,Ks(!1)),Nr(n,19,wc(0)),i&&Nr(n,431,Ks(!1)),i&&Nr(n,444,wc(0)),Nr(n,61,Ege()),Nr(n,64,Ks(!1)),Nr(n,141,wc(0)),Nr(n,34,Ks(Tbe(e)=="true")),Nr(n,14,Ks(!0)),i&&Nr(n,439,Ks(!1)),Nr(n,218,wc(0)),L2e(n,e,r),N2e(n,e.SSF,r),z2e(n,r),i&&Nr(n,352,Ks(!1));var S=n.end(),C=ml();i&&Nr(C,140,p_e()),i&&r.Strings&&k2e(C,252,vge(r.Strings)),Nr(C,10);var k=C.end(),O=ml(),L=0,R=0;for(R=0;R<e.SheetNames.length;++R)L+=(i?12:11)+(i?2:1)*e.SheetNames[R].length;var N=S.length+L+k.length;for(R=0;R<e.SheetNames.length;++R){var V=u[R]||{};Nr(O,133,_ge({pos:N,hs:V.Hidden||0,dt:0,name:e.SheetNames[R]},r)),N+=t[R].length}var G=O.end();if(L!=G.length)throw new Error("BS8 "+L+" != "+G.length);var U=[];return S.length&&U.push(S),G.length&&U.push(G),k.length&&U.push(k),Yo(U)}function G2e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=fa(xn)),e&&e.SSF&&(_v(),h2(e.SSF),r.revssf=vP(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,aL(r),r.cellXfs=[],Np(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)n[n.length]=V2e(o,r,e);return n.unshift(W2e(e,n,r)),Yo(n)}function WY(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var o=tl(n["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var u=t||{};switch(u.biff||2){case 8:case 5:return G2e(e,t);case 4:case 3:case 2:return F2e(e,t)}throw new Error("invalid type "+u.bookType+" for BIFF")}function TU(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var o=e.match(/<table/i);if(!o)throw new Error("Invalid HTML: could not find <table>");var u=e.match(/<\/table/i),d=o.index,i=u&&u.index||e.length,v=kme(e.slice(d,i),/(:?<tr[^>]*>)/i,"<tr>"),w=-1,S=0,C=0,k=0,O={s:{r:1e7,c:1e7},e:{r:0,c:0}},L=[];for(d=0;d<v.length;++d){var R=v[d].trim(),N=R.slice(0,3).toLowerCase();if(N=="<tr"){if(++w,r.sheetRows&&r.sheetRows<=w){--w;break}S=0;continue}if(!(N!="<td"&&N!="<th")){var V=R.split(/<\/t[dh]>/i);for(i=0;i<V.length;++i){var G=V[i].trim();if(G.match(/<t[dh]/i)){for(var U=G,J=0;U.charAt(0)=="<"&&(J=U.indexOf(">"))>-1;)U=U.slice(J+1);for(var Z=0;Z<L.length;++Z){var K=L[Z];K.s.c==S&&K.s.r<w&&w<=K.e.r&&(S=K.e.c+1,Z=-1)}var re=kn(G.slice(0,G.indexOf(">")));k=re.colspan?+re.colspan:1,((C=+re.rowspan)>1||k>1)&&L.push({s:{r:w,c:S},e:{r:w+(C||1)-1,c:S+k-1}});var ge=re.t||re["data-t"]||"";if(!U.length){S+=k;continue}if(U=yZ(U),O.s.r>w&&(O.s.r=w),O.e.r<w&&(O.e.r=w),O.s.c>S&&(O.s.c=S),O.e.c<S&&(O.e.c=S),!U.length){S+=k;continue}var ve={t:"s",v:U};r.raw||!U.trim().length||ge=="s"||(U==="TRUE"?ve={t:"b",v:!0}:U==="FALSE"?ve={t:"b",v:!1}:isNaN(wu(U))?isNaN(zy(U).getDate())||(ve={t:"d",v:Ma(U)},r.cellDates||(ve={t:"n",v:Lo(ve.v)}),ve.z=r.dateNF||xn[14]):ve={t:"n",v:wu(U)}),r.dense?(n[w]||(n[w]=[]),n[w][S]=ve):n[Pn({r:w,c:S})]=ve,S+=k}}}}return n["!ref"]=Hn(O),L.length&&(n["!merges"]=L),n}function GY(e,t,r,n){for(var o=e["!merges"]||[],u=[],d=t.s.c;d<=t.e.c;++d){for(var i=0,v=0,w=0;w<o.length;++w)if(!(o[w].s.r>r||o[w].s.c>d)&&!(o[w].e.r<r||o[w].e.c<d)){if(o[w].s.r<r||o[w].s.c<d){i=-1;break}i=o[w].e.r-o[w].s.r+1,v=o[w].e.c-o[w].s.c+1;break}if(!(i<0)){var S=Pn({r,c:d}),C=n.dense?(e[r]||[])[d]:e[S],k=C&&C.v!=null&&(C.h||P4(C.w||(Ch(C),C.w)||""))||"",O={};i>1&&(O.rowspan=i),v>1&&(O.colspan=v),n.editable?k='<span contenteditable="true">'+k+"</span>":C&&(O["data-t"]=C&&C.t||"z",C.v!=null&&(O["data-v"]=C.v),C.z!=null&&(O["data-z"]=C.z),C.l&&(C.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+C.l.Target+'">'+k+"</a>")),O.id=(n.id||"sjs")+"-"+S,u.push(Fr("td",k,O))}}var L="<tr>";return L+u.join("")+"</tr>"}var HY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qY="</body></html>";function H2e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Lp(TU(r[0],t),t);var n=uL();return r.forEach(function(o,u){hL(n,TU(o,t),"Sheet"+(u+1))}),n}function XY(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ZY(e,t){var r=t||{},n=r.header!=null?r.header:HY,o=r.footer!=null?r.footer:qY,u=[n],d=tl(e["!ref"]);r.dense=Array.isArray(e),u.push(XY(e,d,r));for(var i=d.s.r;i<=d.e.r;++i)u.push(GY(e,d,i,r));return u.push("</table>"+o),u.join("")}function YY(e,t,r){var n=r||{},o=0,u=0;if(n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var d=typeof n.origin=="string"?Va(n.origin):n.origin;o=d.r,u=d.c}var i=t.getElementsByTagName("tr"),v=Math.min(n.sheetRows||1e7,i.length),w={s:{r:0,c:0},e:{r:o,c:u}};if(e["!ref"]){var S=tl(e["!ref"]);w.s.r=Math.min(w.s.r,S.s.r),w.s.c=Math.min(w.s.c,S.s.c),w.e.r=Math.max(w.e.r,S.e.r),w.e.c=Math.max(w.e.c,S.e.c),o==-1&&(w.e.r=o=S.e.r+1)}var C=[],k=0,O=e["!rows"]||(e["!rows"]=[]),L=0,R=0,N=0,V=0,G=0,U=0;for(e["!cols"]||(e["!cols"]=[]);L<i.length&&R<v;++L){var J=i[L];if(SU(J)){if(n.display)continue;O[R]={hidden:!0}}var Z=J.children;for(N=V=0;N<Z.length;++N){var K=Z[N];if(!(n.display&&SU(K))){var re=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):yZ(K.innerHTML),ge=K.getAttribute("data-z")||K.getAttribute("z");for(k=0;k<C.length;++k){var ve=C[k];ve.s.c==V+u&&ve.s.r<R+o&&R+o<=ve.e.r&&(V=ve.e.c+1-u,k=-1)}U=+K.getAttribute("colspan")||1,((G=+K.getAttribute("rowspan")||1)>1||U>1)&&C.push({s:{r:R+o,c:V+u},e:{r:R+o+(G||1)-1,c:V+u+(U||1)-1}});var $e={t:"s",v:re},Ie=K.getAttribute("data-t")||K.getAttribute("t")||"";re!=null&&(re.length==0?$e.t=Ie||"z":n.raw||re.trim().length==0||Ie=="s"||(re==="TRUE"?$e={t:"b",v:!0}:re==="FALSE"?$e={t:"b",v:!1}:isNaN(wu(re))?isNaN(zy(re).getDate())||($e={t:"d",v:Ma(re)},n.cellDates||($e={t:"n",v:Lo($e.v)}),$e.z=n.dateNF||xn[14]):$e={t:"n",v:wu(re)})),$e.z===void 0&&ge!=null&&($e.z=ge);var ke="",tt=K.getElementsByTagName("A");if(tt&&tt.length)for(var Je=0;Je<tt.length&&!(tt[Je].hasAttribute("href")&&(ke=tt[Je].getAttribute("href"),ke.charAt(0)!="#"));++Je);ke&&ke.charAt(0)!="#"&&($e.l={Target:ke}),n.dense?(e[R+o]||(e[R+o]=[]),e[R+o][V+u]=$e):e[Pn({c:V+u,r:R+o})]=$e,w.e.c<V+u&&(w.e.c=V+u),V+=U}}++R}return C.length&&(e["!merges"]=(e["!merges"]||[]).concat(C)),w.e.r=Math.max(w.e.r,R-1+o),e["!ref"]=Hn(w),R>=v&&(e["!fullref"]=Hn((w.e.r=i.length-L+R-1+o,w))),e}function KY(e,t){var r=t||{},n=r.dense?[]:{};return YY(n,e,t)}function q2e(e,t){return Lp(KY(e,t),t)}function SU(e){var t="",r=X2e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function X2e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Z2e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,o){return Array(parseInt(o,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ri(t.replace(/<[^>]*>/g,""));return[r]}var EU={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function JY(e,t){var r=t||{},n=I4(e),o=[],u,d,i={name:""},v="",w=0,S,C,k={},O=[],L=r.dense?[]:{},R,N,V={value:""},G="",U=0,J=[],Z=-1,K=-1,re={s:{r:1e6,c:1e7},e:{r:0,c:0}},ge=0,ve={},$e=[],Ie={},ke=0,tt=0,Je=[],et=1,at=1,pt=[],ft={Names:[]},Ue={},It=["",""],Rt=[],_e={},Ge="",qe=0,Xe=!1,yt=!1,Dt=0;for(nb.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");R=nb.exec(n);)switch(R[3]=R[3].replace(/_.*$/,"")){case"table":case"":R[1]==="/"?(re.e.c>=re.s.c&&re.e.r>=re.s.r?L["!ref"]=Hn(re):L["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=re.e.r&&(L["!fullref"]=L["!ref"],re.e.r=r.sheetRows-1,L["!ref"]=Hn(re)),$e.length&&(L["!merges"]=$e),Je.length&&(L["!rows"]=Je),S.name=S.||S.name,typeof JSON<"u"&&JSON.stringify(S),O.push(S.name),k[S.name]=L,yt=!1):R[0].charAt(R[0].length-2)!=="/"&&(S=kn(R[0],!1),Z=K=-1,re.s.r=re.s.c=1e7,re.e.r=re.e.c=0,L=r.dense?[]:{},$e=[],Je=[],yt=!0);break;case"table-row-group":R[1]==="/"?--ge:++ge;break;case"table-row":case"":if(R[1]==="/"){Z+=et,et=1;break}if(C=kn(R[0],!1),C.?Z=C.-1:Z==-1&&(Z=0),et=+C["number-rows-repeated"]||1,et<10)for(Dt=0;Dt<et;++Dt)ge>0&&(Je[Z+Dt]={level:ge});K=-1;break;case"covered-table-cell":R[1]!=="/"&&++K,r.sheetStubs&&(r.dense?(L[Z]||(L[Z]=[]),L[Z][K]={t:"z"}):L[Pn({r:Z,c:K})]={t:"z"}),G="",J=[];break;case"table-cell":case"":if(R[0].charAt(R[0].length-2)==="/")++K,V=kn(R[0],!1),at=parseInt(V["number-columns-repeated"]||"1",10),N={t:"z",v:null},V.formula&&r.cellFormula!=!1&&(N.f=xU(Ri(V.formula))),(V.||V["value-type"])=="string"&&(N.t="s",N.v=Ri(V["string-value"]||""),r.dense?(L[Z]||(L[Z]=[]),L[Z][K]=N):L[Pn({r:Z,c:K})]=N),K+=at-1;else if(R[1]!=="/"){++K,G="",U=0,J=[],at=1;var Yt=et?Z+et-1:Z;if(K>re.e.c&&(re.e.c=K),K<re.s.c&&(re.s.c=K),Z<re.s.r&&(re.s.r=Z),Yt>re.e.r&&(re.e.r=Yt),V=kn(R[0],!1),Rt=[],_e={},N={t:V.||V["value-type"],v:null},r.cellFormula)if(V.formula&&(V.formula=Ri(V.formula)),V["number-matrix-columns-spanned"]&&V["number-matrix-rows-spanned"]&&(ke=parseInt(V["number-matrix-rows-spanned"],10)||0,tt=parseInt(V["number-matrix-columns-spanned"],10)||0,Ie={s:{r:Z,c:K},e:{r:Z+ke-1,c:K+tt-1}},N.F=Hn(Ie),pt.push([Ie,N.F])),V.formula)N.f=xU(V.formula);else for(Dt=0;Dt<pt.length;++Dt)Z>=pt[Dt][0].s.r&&Z<=pt[Dt][0].e.r&&K>=pt[Dt][0].s.c&&K<=pt[Dt][0].e.c&&(N.F=pt[Dt][1]);switch((V["number-columns-spanned"]||V["number-rows-spanned"])&&(ke=parseInt(V["number-rows-spanned"],10)||0,tt=parseInt(V["number-columns-spanned"],10)||0,Ie={s:{r:Z,c:K},e:{r:Z+ke-1,c:K+tt-1}},$e.push(Ie)),V["number-columns-repeated"]&&(at=parseInt(V["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=Ia(V["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(V.value);break;case"percentage":N.t="n",N.v=parseFloat(V.value);break;case"currency":N.t="n",N.v=parseFloat(V.value);break;case"date":N.t="d",N.v=Ma(V["date-value"]),r.cellDates||(N.t="n",N.v=Lo(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=Cme(V["time-value"])/86400,r.cellDates&&(N.t="d",N.v=xP(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(V.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",V["string-value"]!=null&&(G=Ri(V["string-value"]),J=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(Xe=!1,N.t==="s"&&(N.v=G||"",J.length&&(N.R=J),Xe=U==0),Ue.Target&&(N.l=Ue),Rt.length>0&&(N.c=Rt,Rt=[]),G&&r.cellText!==!1&&(N.w=G),Xe&&(N.t="z",delete N.v),(!Xe||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Z))for(var St=0;St<et;++St){if(at=parseInt(V["number-columns-repeated"]||"1",10),r.dense)for(L[Z+St]||(L[Z+St]=[]),L[Z+St][K]=St==0?N:fa(N);--at>0;)L[Z+St][K+at]=fa(N);else for(L[Pn({r:Z+St,c:K})]=N;--at>0;)L[Pn({r:Z+St,c:K+at})]=fa(N);re.e.c<=K&&(re.e.c=K)}at=parseInt(V["number-columns-repeated"]||"1",10),K+=at-1,at=0,N={},G="",J=[]}Ue={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(R[1]==="/"){if((u=o.pop())[0]!==R[3])throw"Bad state: "+u}else R[0].charAt(R[0].length-2)!=="/"&&o.push([R[3],!0]);break;case"annotation":if(R[1]==="/"){if((u=o.pop())[0]!==R[3])throw"Bad state: "+u;_e.t=G,J.length&&(_e.R=J),_e.a=Ge,Rt.push(_e)}else R[0].charAt(R[0].length-2)!=="/"&&o.push([R[3],!1]);Ge="",qe=0,G="",U=0,J=[];break;case"creator":R[1]==="/"?Ge=n.slice(qe,R.index):qe=R.index+R[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(R[1]==="/"){if((u=o.pop())[0]!==R[3])throw"Bad state: "+u}else R[0].charAt(R[0].length-2)!=="/"&&o.push([R[3],!1]);G="",U=0,J=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(R[1]==="/"){if(ve[i.name]=v,(u=o.pop())[0]!==R[3])throw"Bad state: "+u}else R[0].charAt(R[0].length-2)!=="/"&&(v="",i=kn(R[0],!1),o.push([R[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(o[o.length-1][0]){case"time-style":case"date-style":d=kn(R[0],!1),v+=EU[R[3]][d.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(o[o.length-1][0]){case"time-style":case"date-style":d=kn(R[0],!1),v+=EU[R[3]][d.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(R[0].slice(-2)==="/>")break;if(R[1]==="/")switch(o[o.length-1][0]){case"number-style":case"date-style":case"time-style":v+=n.slice(w,R.index);break}else w=R.index+R[0].length;break;case"named-range":d=kn(R[0],!1),It=gM(d["cell-range-address"]);var Mt={Name:d.name,Ref:It[0]+"!"+It[1]};yt&&(Mt.Sheet=O.length),ft.Names.push(Mt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(o[o.length-1][0])>-1)break;if(R[1]==="/"&&(!V||!V["string-value"])){var Sr=Z2e(n.slice(U,R.index));G=(G.length>0?G+`
`:"")+Sr[0]}else kn(R[0],!1),U=R.index+R[0].length;break;case"s":break;case"database-range":if(R[1]==="/")break;try{It=gM(kn(R[0])["target-range-address"]),k[It[0]]["!autofilter"]={ref:It[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(R[1]!=="/"){if(Ue=kn(R[0],!1),!Ue.href)break;Ue.Target=Ri(Ue.href),delete Ue.href,Ue.Target.charAt(0)=="#"&&Ue.Target.indexOf(".")>-1?(It=gM(Ue.Target.slice(1)),Ue.Target="#"+It[0]+"!"+It[1]):Ue.Target.match(/^\.\.[\\\/]/)&&(Ue.Target=Ue.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(R[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(R)}}var Ne={Sheets:k,SheetNames:O,Workbook:ft};return r.bookSheets&&delete Ne.Sheets,Ne}function AU(e,t){t=t||{},vc(e,"META-INF/manifest.xml")&&C0e(_o(e,"META-INF/manifest.xml"),t);var r=Vl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=JY(la(r),t);return vc(e,"meta.xml")&&(n.Props=BZ(_o(e,"meta.xml"))),n}function CU(e,t){return JY(e,t)}var Y2e=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+rb({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return co+t}}(),PU=function(){var e=function(u){return Ki(u).replace(/  +/g,function(d){return'<text:s text:c="'+d.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(u,d,i){var v=[];v.push('      <table:table table:name="'+Ki(d.SheetNames[i])+`" table:style-name="ta1">
`);var w=0,S=0,C=tl(u["!ref"]||"A1"),k=u["!merges"]||[],O=0,L=Array.isArray(u);if(u["!cols"])for(S=0;S<=C.e.c;++S)v.push("        <table:table-column"+(u["!cols"][S]?' table:style-name="co'+u["!cols"][S].ods+'"':"")+`></table:table-column>
`);var R="",N=u["!rows"]||[];for(w=0;w<C.s.r;++w)R=N[w]?' table:style-name="ro'+N[w].ods+'"':"",v.push("        <table:table-row"+R+`></table:table-row>
`);for(;w<=C.e.r;++w){for(R=N[w]?' table:style-name="ro'+N[w].ods+'"':"",v.push("        <table:table-row"+R+`>
`),S=0;S<C.s.c;++S)v.push(t);for(;S<=C.e.c;++S){var V=!1,G={},U="";for(O=0;O!=k.length;++O)if(!(k[O].s.c>S)&&!(k[O].s.r>w)&&!(k[O].e.c<S)&&!(k[O].e.r<w)){(k[O].s.c!=S||k[O].s.r!=w)&&(V=!0),G["table:number-columns-spanned"]=k[O].e.c-k[O].s.c+1,G["table:number-rows-spanned"]=k[O].e.r-k[O].s.r+1;break}if(V){v.push(r);continue}var J=Pn({r:w,c:S}),Z=L?(u[w]||[])[S]:u[J];if(Z&&Z.f&&(G["table:formula"]=Ki(w1e(Z.f)),Z.F&&Z.F.slice(0,J.length)==J)){var K=tl(Z.F);G["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,G["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!Z){v.push(t);continue}switch(Z.t){case"b":U=Z.v?"TRUE":"FALSE",G["office:value-type"]="boolean",G["office:boolean-value"]=Z.v?"true":"false";break;case"n":U=Z.w||String(Z.v||0),G["office:value-type"]="float",G["office:value"]=Z.v||0;break;case"s":case"str":U=Z.v==null?"":Z.v,G["office:value-type"]="string";break;case"d":U=Z.w||Ma(Z.v).toISOString(),G["office:value-type"]="date",G["office:date-value"]=Ma(Z.v).toISOString(),G["table:style-name"]="ce1";break;default:v.push(t);continue}var re=e(U);if(Z.l&&Z.l.Target){var ge=Z.l.Target;ge=ge.charAt(0)=="#"?"#"+b1e(ge.slice(1)):ge,ge.charAt(0)!="#"&&!ge.match(/^\w+:/)&&(ge="../"+ge),re=Fr("text:a",re,{"xlink:href":ge.replace(/&/g,"&amp;")})}v.push("          "+Fr("table:table-cell",Fr("text:p",re,{}),G)+`
`)}v.push(`        </table:table-row>
`)}return v.push(`      </table:table>
`),v.join("")},o=function(u,d){u.push(` <office:automatic-styles>
`),u.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),u.push(`   <number:month number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:day number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:year/>
`),u.push(`  </number:date-style>
`);var i=0;d.SheetNames.map(function(w){return d.Sheets[w]}).forEach(function(w){if(w&&w["!cols"]){for(var S=0;S<w["!cols"].length;++S)if(w["!cols"][S]){var C=w["!cols"][S];if(C.width==null&&C.wpx==null&&C.wch==null)continue;Cp(C),C.ods=i;var k=w["!cols"][S].wpx+"px";u.push('  <style:style style:name="co'+i+`" style:family="table-column">
`),u.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+k+`"/>
`),u.push(`  </style:style>
`),++i}}});var v=0;d.SheetNames.map(function(w){return d.Sheets[w]}).forEach(function(w){if(w&&w["!rows"]){for(var S=0;S<w["!rows"].length;++S)if(w["!rows"][S]){w["!rows"][S].ods=v;var C=w["!rows"][S].hpx+"px";u.push('  <style:style style:name="ro'+v+`" style:family="table-row">
`),u.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+C+`"/>
`),u.push(`  </style:style>
`),++v}}}),u.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),u.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),u.push(`  </style:style>
`),u.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),u.push(` </office:automatic-styles>
`)};return function(d,i){var v=[co],w=rb({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),S=rb({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});i.bookType=="fods"?(v.push("<office:document"+w+S+`>
`),v.push(NZ().replace(/office:document-meta/g,"office:meta"))):v.push("<office:document-content"+w+`>
`),o(v,d),v.push(`  <office:body>
`),v.push(`    <office:spreadsheet>
`);for(var C=0;C!=d.SheetNames.length;++C)v.push(n(d.Sheets[d.SheetNames[C]],d,C));return v.push(`    </office:spreadsheet>
`),v.push(`  </office:body>
`),i.bookType=="fods"?v.push("</office:document>"):v.push("</office:document-content>"),v.join("")}}();function QY(e,t){if(t.bookType=="fods")return PU(e,t);var r=E4(),n="",o=[],u=[];return n="mimetype",Zn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Zn(r,n,PU(e,t)),o.push([n,"text/xml"]),u.push([n,"ContentFile"]),n="styles.xml",Zn(r,n,Y2e(e,t)),o.push([n,"text/xml"]),u.push([n,"StylesFile"]),n="meta.xml",Zn(r,n,co+NZ()),o.push([n,"text/xml"]),u.push([n,"MetadataFile"]),n="manifest.rdf",Zn(r,n,k0e(u)),o.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Zn(r,n,P0e(o)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function A0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function w3(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):la(Fp(e))}function K2e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$l(gh(e))}function J2e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ip(e){var t=e.reduce(function(o,u){return o+u.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(o){r.set(o,n),n+=o.length}),r}function IU(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Q2e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,o=t+13;o>=t;--o)n=n*256+e[o];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function eTe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,o=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var u=0;o>=1;++u,o/=256)e[t+u]=o&255;e[t+15]|=r>=0?0:128}function ub(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Xi(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function eo(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ni(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],o=ub(e,r),u=o&7;o=Math.floor(o/8);var d=0,i;if(o==0)break;switch(u){case 0:{for(var v=r[0];e[r[0]++]>=128;);i=e.slice(v,r[0])}break;case 5:d=4,i=e.slice(r[0],r[0]+d),r[0]+=d;break;case 1:d=8,i=e.slice(r[0],r[0]+d),r[0]+=d;break;case 2:d=ub(e,r),i=e.slice(r[0],r[0]+d),r[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(u," for Field ").concat(o," at offset ").concat(n))}var w={data:i,type:u};t[o]==null?t[o]=[w]:t[o].push(w)}return t}function is(e){var t=[];return e.forEach(function(r,n){r.forEach(function(o){o.data&&(t.push(Xi(n*8+o.type)),o.type==2&&t.push(Xi(o.data.length)),t.push(o.data))})}),Ip(t)}function nL(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _c(e){for(var t,r=[],n=[0];n[0]<e.length;){var o=ub(e,n),u=Ni(e.slice(n[0],n[0]+o));n[0]+=o;var d={id:eo(u[1][0].data),messages:[]};u[2].forEach(function(i){var v=Ni(i.data),w=eo(v[3][0].data);d.messages.push({meta:v,data:e.slice(n[0],n[0]+w)}),n[0]+=w}),(t=u[3])!=null&&t[0]&&(d.merge=eo(u[3][0].data)>>>0>0),r.push(d)}return r}function C_(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Xi(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Xi(+!!r.merge),type:0}]);var o=[];r.messages.forEach(function(d){o.push(d.data),d.meta[3]=[{type:0,data:Xi(d.data.length)}],n[2].push({data:is(d.meta),type:2})});var u=is(n);t.push(Xi(u.length)),t.push(u),o.forEach(function(d){return t.push(d)})}),Ip(t)}function tTe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ub(t,r),o=[];r[0]<t.length;){var u=t[r[0]]&3;if(u==0){var d=t[r[0]++]>>2;if(d<60)++d;else{var i=d-59;d=t[r[0]],i>1&&(d|=t[r[0]+1]<<8),i>2&&(d|=t[r[0]+2]<<16),i>3&&(d|=t[r[0]+3]<<24),d>>>=0,d++,r[0]+=i}o.push(t.slice(r[0],r[0]+d)),r[0]+=d;continue}else{var v=0,w=0;if(u==1?(w=(t[r[0]]>>2&7)+4,v=(t[r[0]++]&224)<<3,v|=t[r[0]++]):(w=(t[r[0]++]>>2)+1,u==2?(v=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(v=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),o=[Ip(o)],v==0)throw new Error("Invalid offset 0");if(v>o[0].length)throw new Error("Invalid offset beyond length");if(w>=v)for(o.push(o[0].slice(-v)),w-=v;w>=o[o.length-1].length;)o.push(o[o.length-1]),w-=o[o.length-1].length;o.push(o[0].slice(-v,-v+w))}}var S=Ip(o);if(S.length!=n)throw new Error("Unexpected length: ".concat(S.length," != ").concat(n));return S}function yc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],o=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tTe(n,e.slice(r,r+o))),r+=o}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ip(t)}function P_(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),o=new Uint8Array(4);t.push(o);var u=Xi(n),d=u.length;t.push(u),n<=60?(d++,t.push(new Uint8Array([n-1<<2]))):n<=256?(d+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(d+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(d+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(d+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),d+=n,o[0]=0,o[1]=d&255,o[2]=d>>8&255,o[3]=d>>16&255,r+=n}return Ip(t)}function rTe(e,t,r,n){var o=A0(e),u=o.getUint32(4,!0),d=(n>1?12:8)+IU(u&(n>1?3470:398))*4,i=-1,v=-1,w=NaN,S=new Date(2001,0,1);u&512&&(i=o.getUint32(d,!0),d+=4),d+=IU(u&(n>1?12288:4096))*4,u&16&&(v=o.getUint32(d,!0),d+=4),u&32&&(w=o.getFloat64(d,!0),d+=8),u&64&&(S.setTime(S.getTime()+o.getFloat64(d,!0)*1e3),d+=8);var C;switch(e[2]){case 0:break;case 2:C={t:"n",v:w};break;case 3:C={t:"s",v:t[v]};break;case 5:C={t:"d",v:S};break;case 6:C={t:"b",v:w>0};break;case 7:C={t:"n",v:w/86400};break;case 8:C={t:"e",v:0};break;case 9:if(i>-1)C={t:"s",v:r[i]};else if(v>-1)C={t:"s",v:t[v]};else if(!isNaN(w))C={t:"n",v:w};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return C}function nTe(e,t,r){var n=A0(e),o=n.getUint32(8,!0),u=12,d=-1,i=-1,v=NaN,w=NaN,S=new Date(2001,0,1);o&1&&(v=Q2e(e,u),u+=16),o&2&&(w=n.getFloat64(u,!0),u+=8),o&4&&(S.setTime(S.getTime()+n.getFloat64(u,!0)*1e3),u+=8),o&8&&(i=n.getUint32(u,!0),u+=4),o&16&&(d=n.getUint32(u,!0),u+=4);var C;switch(e[1]){case 0:break;case 2:C={t:"n",v};break;case 3:C={t:"s",v:t[i]};break;case 5:C={t:"d",v:S};break;case 6:C={t:"b",v:w>0};break;case 7:C={t:"n",v:w/86400};break;case 8:C={t:"e",v:0};break;case 9:if(d>-1)C={t:"s",v:r[d]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)));break;case 10:C={t:"n",v};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)))}return C}function yM(e,t){var r=new Uint8Array(32),n=A0(r),o=12,u=0;switch(r[0]=5,e.t){case"n":r[1]=2,eTe(r,o,e.v),u|=1,o+=16;break;case"b":r[1]=6,n.setFloat64(o,e.v?1:0,!0),u|=2,o+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(o,t.indexOf(e.v),!0),u|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,u,!0),r.slice(0,o)}function vM(e,t){var r=new Uint8Array(32),n=A0(r),o=12,u=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(o,e.v,!0),u|=32,o+=8;break;case"b":r[2]=6,n.setFloat64(o,e.v?1:0,!0),u|=32,o+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(o,t.indexOf(e.v),!0),u|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,u,!0),r.slice(0,o)}function iTe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return rTe(e,t,r,e[0]);case 5:return nTe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ss(e){var t=Ni(e);return ub(t[1][0].data)}function kU(e,t){var r=Ni(t.data),n=eo(r[1][0].data),o=r[3],u=[];return(o||[]).forEach(function(d){var i=Ni(d.data),v=eo(i[1][0].data)>>>0;switch(n){case 1:u[v]=w3(i[3][0].data);break;case 8:{var w=e[Ss(i[9][0].data)][0],S=Ni(w.data),C=e[Ss(S[1][0].data)][0],k=eo(C.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));var O=Ni(C.data);u[v]=O[3].map(function(L){return w3(L.data)}).join("")}break}}),u}function aTe(e,t){var r,n,o,u,d,i,v,w,S,C,k,O,L,R,N=Ni(e),V=eo(N[1][0].data)>>>0,G=eo(N[2][0].data)>>>0,U=((n=(r=N[8])==null?void 0:r[0])==null?void 0:n.data)&&eo(N[8][0].data)>0||!1,J,Z;if((u=(o=N[7])==null?void 0:o[0])!=null&&u.data&&t!=0)J=(i=(d=N[7])==null?void 0:d[0])==null?void 0:i.data,Z=(w=(v=N[6])==null?void 0:v[0])==null?void 0:w.data;else if((C=(S=N[4])==null?void 0:S[0])!=null&&C.data&&t!=1)J=(O=(k=N[4])==null?void 0:k[0])==null?void 0:O.data,Z=(R=(L=N[3])==null?void 0:L[0])==null?void 0:R.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var K=U?4:1,re=A0(J),ge=[],ve=0;ve<J.length/2;++ve){var $e=re.getUint16(ve*2,!0);$e<65535&&ge.push([ve,$e])}if(ge.length!=G)throw"Expected ".concat(G," cells, found ").concat(ge.length);var Ie=[];for(ve=0;ve<ge.length-1;++ve)Ie[ge[ve][0]]=Z.subarray(ge[ve][1]*K,ge[ve+1][1]*K);return ge.length>=1&&(Ie[ge[ge.length-1][0]]=Z.subarray(ge[ge.length-1][1]*K)),{R:V,cells:Ie}}function oTe(e,t){var r,n=Ni(t.data),o=(r=n==null?void 0:n[7])!=null&&r[0]?eo(n[7][0].data)>>>0>0?1:0:-1,u=nL(n[5],function(d){return aTe(d,o)});return{nrows:eo(n[4][0].data)>>>0,data:u.reduce(function(d,i){return d[i.R]||(d[i.R]=[]),i.cells.forEach(function(v,w){if(d[i.R][w])throw new Error("Duplicate cell r=".concat(i.R," c=").concat(w));d[i.R][w]=v}),d},[])}}function sTe(e,t,r){var n,o=Ni(t.data),u={s:{r:0,c:0},e:{r:0,c:0}};if(u.e.r=(eo(o[6][0].data)>>>0)-1,u.e.r<0)throw new Error("Invalid row varint ".concat(o[6][0].data));if(u.e.c=(eo(o[7][0].data)>>>0)-1,u.e.c<0)throw new Error("Invalid col varint ".concat(o[7][0].data));r["!ref"]=Hn(u);var d=Ni(o[4][0].data),i=kU(e,e[Ss(d[4][0].data)][0]),v=(n=d[17])!=null&&n[0]?kU(e,e[Ss(d[17][0].data)][0]):[],w=Ni(d[3][0].data),S=0;w[1].forEach(function(C){var k=Ni(C.data),O=e[Ss(k[2][0].data)][0],L=eo(O.meta[1][0].data);if(L!=6002)throw new Error("6001 unexpected reference to ".concat(L));var R=oTe(e,O);R.data.forEach(function(N,V){N.forEach(function(G,U){var J=Pn({r:S+V,c:U}),Z=iTe(G,i,v);Z&&(r[J]=Z)})}),S+=R.nrows})}function lTe(e,t){var r=Ni(t.data),n={"!ref":"A1"},o=e[Ss(r[2][0].data)],u=eo(o[0].meta[1][0].data);if(u!=6001)throw new Error("6000 unexpected reference to ".concat(u));return sTe(e,o[0],n),n}function cTe(e,t){var r,n=Ni(t.data),o={name:(r=n[1])!=null&&r[0]?w3(n[1][0].data):"",sheets:[]},u=nL(n[2],Ss);return u.forEach(function(d){e[d].forEach(function(i){var v=eo(i.meta[1][0].data);v==6e3&&o.sheets.push(lTe(e,i))})}),o}function uTe(e,t){var r=uL(),n=Ni(t.data),o=nL(n[1],Ss);if(o.forEach(function(u){e[u].forEach(function(d){var i=eo(d.meta[1][0].data);if(i==2){var v=cTe(e,d);v.sheets.forEach(function(w,S){hL(r,w,S==0?v.name:v.name+"_"+S,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xM(e){var t,r,n,o,u={},d=[];if(e.FullPaths.forEach(function(v){if(v.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(v){if(v.name.match(/\.iwa$/)){var w;try{w=yc(v.content)}catch(C){return console.log("?? "+v.content.length+" "+(C.message||C))}var S;try{S=_c(w)}catch(C){return console.log("## "+(C.message||C))}S.forEach(function(C){u[C.id]=C.messages,d.push(C.id)})}}),!d.length)throw new Error("File has no messages");var i=((o=(n=(r=(t=u==null?void 0:u[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:o[0].data)&&eo(u[1][0].meta[1][0].data)==1&&u[1][0];if(i||d.forEach(function(v){u[v].forEach(function(w){var S=eo(w.meta[1][0].data)>>>0;if(S==1)if(!i)i=w;else throw new Error("Document has multiple roots")})}),!i)throw new Error("Cannot find Document root");return uTe(u,i)}function hTe(e,t,r){var n,o,u,d;if(!((n=e[6])!=null&&n[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var i=((d=(u=e[8])==null?void 0:u[0])==null?void 0:d.data)&&eo(e[8][0].data)>0||!1;if(i)throw"Math only works with normal offsets";for(var v=0,w=A0(e[7][0].data),S=0,C=[],k=A0(e[4][0].data),O=0,L=[],R=0;R<t.length;++R){if(t[R]==null){w.setUint16(R*2,65535,!0),k.setUint16(R*2,65535);continue}w.setUint16(R*2,S,!0),k.setUint16(R*2,O,!0);var N,V;switch(typeof t[R]){case"string":N=yM({t:"s",v:t[R]},r),V=vM({t:"s",v:t[R]},r);break;case"number":N=yM({t:"n",v:t[R]},r),V=vM({t:"n",v:t[R]},r);break;case"boolean":N=yM({t:"b",v:t[R]},r),V=vM({t:"b",v:t[R]},r);break;default:throw new Error("Unsupported value "+t[R])}C.push(N),S+=N.length,L.push(V),O+=V.length,++v}for(e[2][0].data=Xi(v);R<e[7][0].data.length/2;++R)w.setUint16(R*2,65535,!0),k.setUint16(R*2,65535,!0);return e[6][0].data=Ip(C),e[3][0].data=Ip(L),v}function fTe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=tl(r["!ref"]);n.s.r=n.s.c=0;var o=!1;n.e.c>9&&(o=!0,n.e.c=9),n.e.r>49&&(o=!0,n.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(Hn(n)));var u=MA(r,{range:n,header:1}),d=["~Sh33tJ5~"];u.forEach(function(Ge){return Ge.forEach(function(qe){typeof qe=="string"&&d.push(qe)})});var i={},v=[],w=pn.read(t.numbers,{type:"base64"});w.FileIndex.map(function(Ge,qe){return[Ge,w.FullPaths[qe]]}).forEach(function(Ge){var qe=Ge[0],Xe=Ge[1];if(qe.type==2&&qe.name.match(/\.iwa/)){var yt=qe.content,Dt=yc(yt),Yt=_c(Dt);Yt.forEach(function(St){v.push(St.id),i[St.id]={deps:[],location:Xe,type:eo(St.messages[0].meta[1][0].data)}})}}),v.sort(function(Ge,qe){return Ge-qe});var S=v.filter(function(Ge){return Ge>1}).map(function(Ge){return[Ge,Xi(Ge)]});w.FileIndex.map(function(Ge,qe){return[Ge,w.FullPaths[qe]]}).forEach(function(Ge){var qe=Ge[0];if(Ge[1],!!qe.name.match(/\.iwa/)){var Xe=_c(yc(qe.content));Xe.forEach(function(yt){yt.messages.forEach(function(Dt){S.forEach(function(Yt){yt.messages.some(function(St){return eo(St.meta[1][0].data)!=11006&&J2e(St.data,Yt[1])})&&i[Yt[0]].deps.push(yt.id)})})})}});for(var C=pn.find(w,i[1].location),k=_c(yc(C.content)),O,L=0;L<k.length;++L){var R=k[L];R.id==1&&(O=R)}var N=Ss(Ni(O.messages[0].data)[1][0].data);for(C=pn.find(w,i[N].location),k=_c(yc(C.content)),L=0;L<k.length;++L)R=k[L],R.id==N&&(O=R);for(N=Ss(Ni(O.messages[0].data)[2][0].data),C=pn.find(w,i[N].location),k=_c(yc(C.content)),L=0;L<k.length;++L)R=k[L],R.id==N&&(O=R);for(N=Ss(Ni(O.messages[0].data)[2][0].data),C=pn.find(w,i[N].location),k=_c(yc(C.content)),L=0;L<k.length;++L)R=k[L],R.id==N&&(O=R);var V=Ni(O.messages[0].data);{V[6][0].data=Xi(n.e.r+1),V[7][0].data=Xi(n.e.c+1);var G=Ss(V[46][0].data),U=pn.find(w,i[G].location),J=_c(yc(U.content));{for(var Z=0;Z<J.length&&J[Z].id!=G;++Z);if(J[Z].id!=G)throw"Bad ColumnRowUIDMapArchive";var K=Ni(J[Z].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var re=0;re<=n.e.c;++re){var ge=[];ge[1]=ge[2]=[{type:0,data:Xi(re+420690)}],K[1].push({type:2,data:is(ge)}),K[2].push({type:0,data:Xi(re)}),K[3].push({type:0,data:Xi(re)})}K[4]=[],K[5]=[],K[6]=[];for(var ve=0;ve<=n.e.r;++ve)ge=[],ge[1]=ge[2]=[{type:0,data:Xi(ve+726270)}],K[4].push({type:2,data:is(ge)}),K[5].push({type:0,data:Xi(ve)}),K[6].push({type:0,data:Xi(ve)});J[Z].messages[0].data=is(K)}U.content=P_(C_(J)),U.size=U.content.length,delete V[46];var $e=Ni(V[4][0].data);{$e[7][0].data=Xi(n.e.r+1);var Ie=Ni($e[1][0].data),ke=Ss(Ie[2][0].data);U=pn.find(w,i[ke].location),J=_c(yc(U.content));{if(J[0].id!=ke)throw"Bad HeaderStorageBucket";var tt=Ni(J[0].messages[0].data);for(ve=0;ve<u.length;++ve){var Je=Ni(tt[2][0].data);Je[1][0].data=Xi(ve),Je[4][0].data=Xi(u[ve].length),tt[2][ve]={type:tt[2][0].type,data:is(Je)}}J[0].messages[0].data=is(tt)}U.content=P_(C_(J)),U.size=U.content.length;var et=Ss($e[2][0].data);U=pn.find(w,i[et].location),J=_c(yc(U.content));{if(J[0].id!=et)throw"Bad HeaderStorageBucket";for(tt=Ni(J[0].messages[0].data),re=0;re<=n.e.c;++re)Je=Ni(tt[2][0].data),Je[1][0].data=Xi(re),Je[4][0].data=Xi(n.e.r+1),tt[2][re]={type:tt[2][0].type,data:is(Je)};J[0].messages[0].data=is(tt)}U.content=P_(C_(J)),U.size=U.content.length;var at=Ss($e[4][0].data);(function(){for(var Ge=pn.find(w,i[at].location),qe=_c(yc(Ge.content)),Xe,yt=0;yt<qe.length;++yt){var Dt=qe[yt];Dt.id==at&&(Xe=Dt)}var Yt=Ni(Xe.messages[0].data);{Yt[3]=[];var St=[];d.forEach(function(Ne,un){St[1]=[{type:0,data:Xi(un)}],St[2]=[{type:0,data:Xi(1)}],St[3]=[{type:2,data:K2e(Ne)}],Yt[3].push({type:2,data:is(St)})})}Xe.messages[0].data=is(Yt);var Mt=C_(qe),Sr=P_(Mt);Ge.content=Sr,Ge.size=Ge.content.length})();var pt=Ni($e[3][0].data);{var ft=pt[1][0];delete pt[2];var Ue=Ni(ft.data);{var It=Ss(Ue[2][0].data);(function(){for(var Ge=pn.find(w,i[It].location),qe=_c(yc(Ge.content)),Xe,yt=0;yt<qe.length;++yt){var Dt=qe[yt];Dt.id==It&&(Xe=Dt)}var Yt=Ni(Xe.messages[0].data);{delete Yt[6],delete pt[7];var St=new Uint8Array(Yt[5][0].data);Yt[5]=[];for(var Mt=0,Sr=0;Sr<=n.e.r;++Sr){var Ne=Ni(St);Mt+=hTe(Ne,u[Sr],d),Ne[1][0].data=Xi(Sr),Yt[5].push({data:is(Ne),type:2})}Yt[1]=[{type:0,data:Xi(n.e.c+1)}],Yt[2]=[{type:0,data:Xi(n.e.r+1)}],Yt[3]=[{type:0,data:Xi(Mt)}],Yt[4]=[{type:0,data:Xi(n.e.r+1)}]}Xe.messages[0].data=is(Yt);var un=C_(qe),kr=P_(un);Ge.content=kr,Ge.size=Ge.content.length})()}ft.data=is(Ue)}$e[3][0].data=is(pt)}V[4][0].data=is($e)}O.messages[0].data=is(V);var Rt=C_(k),_e=P_(Rt);return C.content=_e,C.size=C.content.length,w}function eK(e){return function(r){for(var n=0;n!=e.length;++n){var o=e[n];r[o[0]]===void 0&&(r[o[0]]=o[1]),o[2]==="n"&&(r[o[0]]=Number(r[o[0]]))}}}function iL(e){eK([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function aL(e){eK([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function dTe(e){return fi.WS.indexOf(e)>-1?"sheet":e==fi.CS?"chart":e==fi.DS?"dialog":e==fi.MS?"macro":e&&e.length?e:"sheet"}function pTe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,dTe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mTe(e,t,r,n,o,u,d,i,v,w,S,C){try{u[n]=ww(Vl(e,r,!0),t);var k=_o(e,t),O;switch(i){case"sheet":O=Ube(k,t,o,v,u[n],w,S,C);break;case"chart":if(O=$be(k,t,o,v,u[n],w,S,C),!O||!O["!drawel"])break;var L=aw(O["!drawel"].Target,t),R=ib(L),N=Ive(Vl(e,L,!0),ww(Vl(e,R,!0),L)),V=aw(N,L),G=ib(V);O=gbe(Vl(e,V,!0),V,v,ww(Vl(e,G,!0),V),w,O);break;case"macro":O=Vbe(k,t,o,v,u[n],w,S,C);break;case"dialog":O=Wbe(k,t,o,v,u[n],w,S,C);break;default:throw new Error("Unrecognized sheet type "+i)}d[n]=O;var U=[];u&&u[n]&&to(u[n]).forEach(function(J){var Z="";if(u[n][J].Type==fi.CMNT){Z=aw(u[n][J].Target,t);var K=Xbe(_o(e,Z,!0),Z,v);if(!K||!K.length)return;mU(O,K,!1)}u[n][J].Type==fi.TCMNT&&(Z=aw(u[n][J].Target,t),U=U.concat(Ove(_o(e,Z,!0),v)))}),U&&U.length&&mU(O,U,!0,v.people||[])}catch(J){if(v.WTF)throw J}}function fc(e){return e.charAt(0)=="/"?e.slice(1):e}function tK(e,t){if(_v(),t=t||{},iL(t),vc(e,"META-INF/manifest.xml")||vc(e,"objectdata.xml"))return AU(e,t);if(vc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xM<"u"){if(e.FileIndex)return xM(e);var r=pn.utils.cfb_new();return Lj(e).forEach(function(Je){Zn(r,Je,Mme(e,Je))}),xM(r)}throw new Error("Unsupported NUMBERS file")}if(!vc(e,"[Content_Types].xml"))throw vc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Lj(e),o=E0e(Vl(e,"[Content_Types].xml")),u=!1,d,i;if(o.workbooks.length===0&&(i="xl/workbook.xml",_o(e,i,!0)&&o.workbooks.push(i)),o.workbooks.length===0){if(i="xl/workbook.bin",!_o(e,i,!0))throw new Error("Could not find workbook");o.workbooks.push(i),u=!0}o.workbooks[0].slice(-3)=="bin"&&(u=!0);var v={},w={};if(!t.bookSheets&&!t.bookProps){if(bw=[],o.sst)try{bw=qbe(_o(e,fc(o.sst)),o.sst,t)}catch(Je){if(t.WTF)throw Je}t.cellStyles&&o.themes.length&&(v=Hbe(Vl(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],t)),o.style&&(w=Gbe(_o(e,fc(o.style)),o.style,v,t))}o.links.map(function(Je){try{var et=ww(Vl(e,ib(fc(Je))),Je);return Ybe(_o(e,fc(Je)),et,Je,t)}catch{}});var S=jbe(_o(e,fc(o.workbooks[0])),o.workbooks[0],t),C={},k="";o.coreprops.length&&(k=_o(e,fc(o.coreprops[0]),!0),k&&(C=BZ(k)),o.extprops.length!==0&&(k=_o(e,fc(o.extprops[0]),!0),k&&M0e(k,C,t)));var O={};(!t.bookSheets||t.bookProps)&&o.custprops.length!==0&&(k=Vl(e,fc(o.custprops[0]),!0),k&&(O=D0e(k,t)));var L={};if((t.bookSheets||t.bookProps)&&(S.Sheets?d=S.Sheets.map(function(et){return et.name}):C.Worksheets&&C.SheetNames.length>0&&(d=C.SheetNames),t.bookProps&&(L.Props=C,L.Custprops=O),t.bookSheets&&typeof d<"u"&&(L.SheetNames=d),t.bookSheets?L.SheetNames:t.bookProps))return L;d={};var R={};t.bookDeps&&o.calcchain&&(R=Zbe(_o(e,fc(o.calcchain)),o.calcchain));var N=0,V={},G,U;{var J=S.Sheets;C.Worksheets=J.length,C.SheetNames=[];for(var Z=0;Z!=J.length;++Z)C.SheetNames[Z]=J[Z].name}var K=u?"bin":"xml",re=o.workbooks[0].lastIndexOf("/"),ge=(o.workbooks[0].slice(0,re+1)+"_rels/"+o.workbooks[0].slice(re+1)+".rels").replace(/^\//,"");vc(e,ge)||(ge="xl/_rels/workbook."+K+".rels");var ve=ww(Vl(e,ge,!0),ge.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=Kbe(_o(e,fc(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=Rve(_o(e,fc(o.people[0])),t)),ve&&(ve=pTe(ve,S.Sheets));var $e=_o(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=C.Worksheets;++N){var Ie="sheet";if(ve&&ve[N]?(G="xl/"+ve[N][1].replace(/[\/]?xl\//,""),vc(e,G)||(G=ve[N][1]),vc(e,G)||(G=ge.replace(/_rels\/.*$/,"")+ve[N][1]),Ie=ve[N][2]):(G="xl/worksheets/sheet"+(N+1-$e)+"."+K,G=G.replace(/sheet0\./,"sheet.")),U=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(N!=t.sheets)continue e;break;case"string":if(C.SheetNames[N].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ke=!1,tt=0;tt!=t.sheets.length;++tt)typeof t.sheets[tt]=="number"&&t.sheets[tt]==N&&(ke=1),typeof t.sheets[tt]=="string"&&t.sheets[tt].toLowerCase()==C.SheetNames[N].toLowerCase()&&(ke=1);if(!ke)continue e}}mTe(e,G,U,C.SheetNames[N],N,V,d,Ie,t,S,v,w)}return L={Directory:o,Workbook:S,Props:C,Custprops:O,Deps:R,Sheets:d,SheetNames:C.SheetNames,Strings:bw,Styles:w,Themes:v,SSF:fa(xn)},t&&t.bookFiles&&(e.files?(L.keys=n,L.files=e.files):(L.keys=[],L.files={},e.FullPaths.forEach(function(Je,et){Je=Je.replace(/^Root Entry[\/]/,""),L.keys.push(Je),L.files[Je]=e.FileIndex[et]}))),t&&t.bookVBA&&(o.vba.length>0?L.vbaraw=_o(e,fc(o.vba[0]),!0):o.defaults&&o.defaults.bin===Uve&&(L.vbaraw=_o(e,"xl/vbaProject.bin",!0))),L}function gTe(e,t){var r=t||{},n="Workbook",o=pn.find(e,n);try{if(n="/!DataSpaces/Version",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(J_e(o.content),n="/!DataSpaces/DataSpaceMap",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=eye(o.content);if(u.length!==1||u[0].comps.length!==1||u[0].comps[0].t!==0||u[0].name!=="StrongEncryptionDataSpace"||u[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=tye(o.content);if(d.length!=1||d[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);nye(o.content)}catch{}if(n="/EncryptionInfo",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=iye(o.content);if(n="/EncryptedPackage",o=pn.find(e,n),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(i[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(i[1],o.content,r.password||"",r);if(i[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(i[1],o.content,r.password||"",r);throw new Error("File is password-protected")}function _Te(e,t){return t.bookType=="ods"?QY(e,t):t.bookType=="numbers"?fTe(e,t):t.bookType=="xlsb"?yTe(e,t):rK(e,t)}function yTe(e,t){J_=1024,e&&!e.SSF&&(e.SSF=fa(xn)),e&&e.SSF&&(_v(),h2(e.SSF),t.revssf=vP(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Tw?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=TY.indexOf(t.bookType)>-1,o=V4();aL(t=t||{});var u=E4(),d="",i=0;if(t.cellXfs=[],Np(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",Zn(u,d,zZ(e.Props,t)),o.coreprops.push(d),Yi(t.rels,2,d,fi.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var v=[],w=0;w<e.SheetNames.length;++w)(e.Workbook.Sheets[w]||{}).Hidden!=2&&v.push(e.SheetNames[w]);e.Props.SheetNames=v}for(e.Props.Worksheets=e.Props.SheetNames.length,Zn(u,d,$Z(e.Props)),o.extprops.push(d),Yi(t.rels,3,d,fi.EXT_PROPS),e.Custprops!==e.Props&&to(e.Custprops||{}).length>0&&(d="docProps/custom.xml",Zn(u,d,VZ(e.Custprops)),o.custprops.push(d),Yi(t.rels,4,d,fi.CUST_PROPS)),i=1;i<=e.SheetNames.length;++i){var S={"!id":{}},C=e.Sheets[e.SheetNames[i-1]],k=(C||{})["!type"]||"sheet";switch(k){case"chart":default:d="xl/worksheets/sheet"+i+"."+r,Zn(u,d,Qbe(i-1,d,t,e,S)),o.sheets.push(d),Yi(t.wbrels,-1,"worksheets/sheet"+i+"."+r,fi.WS[0])}if(C){var O=C["!comments"],L=!1,R="";O&&O.length>0&&(R="xl/comments"+i+"."+r,Zn(u,R,r2e(O,R)),o.comments.push(R),Yi(S,-1,"../comments"+i+"."+r,fi.CMNT),L=!0),C["!legacy"]&&L&&Zn(u,"xl/drawings/vmlDrawing"+i+".vml",wY(i,C["!comments"])),delete C["!comments"],delete C["!legacy"]}S["!id"].rId1&&Zn(u,ib(d),dy(S))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,Zn(u,d,t2e(t.Strings,d,t)),o.strs.push(d),Yi(t.wbrels,-1,"sharedStrings."+r,fi.SST)),d="xl/workbook."+r,Zn(u,d,Jbe(e,d)),o.workbooks.push(d),Yi(t.rels,1,d,fi.WB),d="xl/theme/theme1.xml",Zn(u,d,Z4(e.Themes,t)),o.themes.push(d),Yi(t.wbrels,-1,"theme/theme1.xml",fi.THEME),d="xl/styles."+r,Zn(u,d,e2e(e,d,t)),o.styles.push(d),Yi(t.wbrels,-1,"styles."+r,fi.STY),e.vbaraw&&n&&(d="xl/vbaProject.bin",Zn(u,d,e.vbaraw),o.vba.push(d),Yi(t.wbrels,-1,"vbaProject.bin",fi.VBA)),d="xl/metadata."+r,Zn(u,d,n2e(d)),o.metadata.push(d),Yi(t.wbrels,-1,"metadata."+r,fi.XLMETA),Zn(u,"[Content_Types].xml",LZ(o,t)),Zn(u,"_rels/.rels",dy(t.rels)),Zn(u,"xl/_rels/workbook."+r+".rels",dy(t.wbrels)),delete t.revssf,delete t.ssf,u}function rK(e,t){J_=1024,e&&!e.SSF&&(e.SSF=fa(xn)),e&&e.SSF&&(_v(),h2(e.SSF),t.revssf=vP(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Tw?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=TY.indexOf(t.bookType)>-1,o=V4();aL(t=t||{});var u=E4(),d="",i=0;if(t.cellXfs=[],Np(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",Zn(u,d,zZ(e.Props,t)),o.coreprops.push(d),Yi(t.rels,2,d,fi.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var v=[],w=0;w<e.SheetNames.length;++w)(e.Workbook.Sheets[w]||{}).Hidden!=2&&v.push(e.SheetNames[w]);e.Props.SheetNames=v}e.Props.Worksheets=e.Props.SheetNames.length,Zn(u,d,$Z(e.Props)),o.extprops.push(d),Yi(t.rels,3,d,fi.EXT_PROPS),e.Custprops!==e.Props&&to(e.Custprops||{}).length>0&&(d="docProps/custom.xml",Zn(u,d,VZ(e.Custprops)),o.custprops.push(d),Yi(t.rels,4,d,fi.CUST_PROPS));var S=["SheetJ5"];for(t.tcid=0,i=1;i<=e.SheetNames.length;++i){var C={"!id":{}},k=e.Sheets[e.SheetNames[i-1]],O=(k||{})["!type"]||"sheet";switch(O){case"chart":default:d="xl/worksheets/sheet"+i+"."+r,Zn(u,d,DY(i-1,t,e,C)),o.sheets.push(d),Yi(t.wbrels,-1,"worksheets/sheet"+i+"."+r,fi.WS[0])}if(k){var L=k["!comments"],R=!1,N="";if(L&&L.length>0){var V=!1;L.forEach(function(G){G[1].forEach(function(U){U.T==!0&&(V=!0)})}),V&&(N="xl/threadedComments/threadedComment"+i+"."+r,Zn(u,N,Mve(L,S,t)),o.threadedcomments.push(N),Yi(C,-1,"../threadedComments/threadedComment"+i+"."+r,fi.TCMNT)),N="xl/comments"+i+"."+r,Zn(u,N,bY(L)),o.comments.push(N),Yi(C,-1,"../comments"+i+"."+r,fi.CMNT),R=!0}k["!legacy"]&&R&&Zn(u,"xl/drawings/vmlDrawing"+i+".vml",wY(i,k["!comments"])),delete k["!comments"],delete k["!legacy"]}C["!id"].rId1&&Zn(u,ib(d),dy(C))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,Zn(u,d,cY(t.Strings,t)),o.strs.push(d),Yi(t.wbrels,-1,"sharedStrings."+r,fi.SST)),d="xl/workbook."+r,Zn(u,d,jY(e)),o.workbooks.push(d),Yi(t.rels,1,d,fi.WB),d="xl/theme/theme1.xml",Zn(u,d,Z4(e.Themes,t)),o.themes.push(d),Yi(t.wbrels,-1,"theme/theme1.xml",fi.THEME),d="xl/styles."+r,Zn(u,d,_Y(e,t)),o.styles.push(d),Yi(t.wbrels,-1,"styles."+r,fi.STY),e.vbaraw&&n&&(d="xl/vbaProject.bin",Zn(u,d,e.vbaraw),o.vba.push(d),Yi(t.wbrels,-1,"vbaProject.bin",fi.VBA)),d="xl/metadata."+r,Zn(u,d,xY()),o.metadata.push(d),Yi(t.wbrels,-1,"metadata."+r,fi.XLMETA),S.length>1&&(d="xl/persons/person.xml",Zn(u,d,Dve(S)),o.people.push(d),Yi(t.wbrels,-1,"persons/person.xml",fi.PEOPLE)),Zn(u,"[Content_Types].xml",LZ(o,t)),Zn(u,"_rels/.rels",dy(t.rels)),Zn(u,"xl/_rels/workbook."+r+".rels",dy(t.wbrels)),delete t.revssf,delete t.ssf,u}function oL(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yl(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function vTe(e,t){return pn.find(e,"EncryptedPackage")?gTe(e,t):rL(e,t)}function xTe(e,t){var r,n=e,o=t||{};return o.type||(o.type=oi&&Buffer.isBuffer(e)?"buffer":"base64"),r=mZ(n,o),tK(r,o)}function nK(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return v3(e.slice(r),t);default:break e}return jy.to_workbook(e,t)}function wTe(e,t){var r="",n=oL(e,t);switch(t.type){case"base64":r=Yl(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=b0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=la(r)),t.type="binary",nK(r,t)}function bTe(e,t){var r=e;return t.type=="base64"&&(r=Yl(r)),r=Pi.utils.decode(1200,r.slice(2),"str"),t.type="binary",nK(r,t)}function TTe(e){return e.match(/[^\x00-\x7F]/)?gh(e):e}function wM(e,t,r,n){return n?(r.type="string",jy.to_workbook(e,r)):jy.to_workbook(t,r)}function OA(e,t){_P();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return OA(new Uint8Array(e),(r=fa(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,o=[0,0,0,0],u=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),my={},r.dateNF&&(my.dateNF=r.dateNF),r.type||(r.type=oi&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=oi?"buffer":"binary",n=Sme(e),typeof Uint8Array<"u"&&!oi&&(r.type="array")),r.type=="string"&&(u=!0,r.type="binary",r.codepage=65001,n=TTe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var d=new ArrayBuffer(3),i=new Uint8Array(d);if(i.foo="bar",!i.foo)return r=fa(r),r.type="array",OA(w4(n),r)}switch((o=oL(n,r))[0]){case 208:if(o[1]===207&&o[2]===17&&o[3]===224&&o[4]===161&&o[5]===177&&o[6]===26&&o[7]===225)return vTe(pn.read(n,r),r);break;case 9:if(o[1]<=8)return rL(n,r);break;case 60:return v3(n,r);case 73:if(o[1]===73&&o[2]===42&&o[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(o[1]===68)return F_e(n,r);break;case 84:if(o[1]===65&&o[2]===66&&o[3]===76)return sY.to_workbook(n,r);break;case 80:return o[1]===75&&o[2]<9&&o[3]<9?xTe(n,r):wM(e,n,r,u);case 239:return o[3]===60?v3(n,r):wM(e,n,r,u);case 255:if(o[1]===254)return bTe(n,r);if(o[1]===0&&o[2]===2&&o[3]===0)return a0.to_workbook(n,r);break;case 0:if(o[1]===0&&(o[2]>=2&&o[3]===0||o[2]===0&&(o[3]===8||o[3]===9)))return a0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return y3.to_workbook(n,r);case 123:if(o[1]===92&&o[2]===114&&o[3]===116)return pY.to_workbook(n,r);break;case 10:case 13:case 32:return wTe(n,r);case 137:if(o[1]===80&&o[2]===78&&o[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return D_e.indexOf(o[0])>-1&&o[2]<=12&&o[3]<=31?y3.to_workbook(n,r):wM(e,n,r,u)}function OU(e,t){var r=t||{};return r.type="file",OA(e,r)}function iK(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return f2(t.file,pn.write(e,{type:oi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return pn.write(e,t)}function STe(e,t){var r=fa(t||{}),n=_Te(e,r);return aK(n,r)}function ETe(e,t){var r=fa(t||{}),n=rK(e,r);return aK(n,r)}function aK(e,t){var r={},n=oi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var o=e.FullPaths?pn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof o=="string"){if(t.type=="binary"||t.type=="base64")return o;o=new Uint8Array(u2(o))}return t.password&&typeof encrypt_agile<"u"?iK(encrypt_agile(o,t.password),t):t.type==="file"?f2(t.file,o):t.type=="string"?la(o):o}function ATe(e,t){var r=t||{},n=I2e(e,r);return iK(n,r)}function ah(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Qw(gh(n));case"binary":return gh(n);case"string":return e;case"file":return f2(t.file,n,"utf8");case"buffer":return oi?jf(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ah(n,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function CTe(e,t){switch(t.type){case"base64":return Qw(e);case"binary":return e;case"string":return e;case"file":return f2(t.file,e,"binary");case"buffer":return oi?jf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function aE(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Qw(r):t.type=="string"?la(r):r;case"file":return f2(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sL(e,t){_P(),zY(e);var r=fa(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=sL(e,r);return r.type="array",u2(n)}return ETe(e,r)}function v2(e,t){_P(),zY(e);var r=fa(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=v2(e,r);return r.type="array",u2(n)}var o=0;if(r.sheet&&(typeof r.sheet=="number"?o=r.sheet:o=e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ah(b2e(e,r),r);case"slk":case"sylk":return ah(oY.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"htm":case"html":return ah(ZY(e.Sheets[e.SheetNames[o]],r),r);case"txt":return CTe(lK(e.Sheets[e.SheetNames[o]],r),r);case"csv":return ah(cL(e.Sheets[e.SheetNames[o]],r),r,"\uFEFF");case"dif":return ah(sY.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return aE(y3.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return ah(jy.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return ah(pY.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"eth":return ah(lY.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return ah(QY(e,r),r);case"wk1":return aE(a0.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return aE(a0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),aE(WY(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ATe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return STe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function lL(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function b3(e,t,r){var n=r||{};return n.type="file",n.file=t,lL(n),v2(e,n)}function PTe(e,t,r){var n=r||{};return n.type="file",n.file=t,lL(n),sL(e,n)}function ITe(e,t,r,n){var o=r||{};o.type="file",o.file=e,lL(o),o.type="buffer";var u=n;return u instanceof Function||(u=r),op.writeFile(e,v2(t,o),u)}function oK(e,t,r,n,o,u,d,i){var v=Qa(r),w=i.defval,S=i.raw||!Object.prototype.hasOwnProperty.call(i,"raw"),C=!0,k=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(k,"__rowNum__",{value:r,enumerable:!1})}catch{k.__rowNum__=r}else k.__rowNum__=r;if(!d||e[r])for(var O=t.s.c;O<=t.e.c;++O){var L=d?e[r][O]:e[n[O]+v];if(L===void 0||L.t===void 0){if(w===void 0)continue;u[O]!=null&&(k[u[O]]=w);continue}var R=L.v;switch(L.t){case"z":if(R==null)break;continue;case"e":R=R==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+L.t)}if(u[O]!=null){if(R==null)if(L.t=="e"&&R===null)k[u[O]]=null;else if(w!==void 0)k[u[O]]=w;else if(S&&R===null)k[u[O]]=null;else continue;else k[u[O]]=S&&(L.t!=="n"||L.t==="n"&&i.rawNumbers!==!1)?R:Ch(L,R,i);R!=null&&(C=!1)}}return{row:k,isempty:C}}function MA(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,o=1,u=[],d=0,i="",v={s:{r:0,c:0},e:{r:0,c:0}},w=t||{},S=w.range!=null?w.range:e["!ref"];switch(w.header===1?n=1:w.header==="A"?n=2:Array.isArray(w.header)?n=3:w.header==null&&(n=0),typeof S){case"string":v=wi(S);break;case"number":v=wi(e["!ref"]),v.s.r=S;break;default:v=S}n>0&&(o=0);var C=Qa(v.s.r),k=[],O=[],L=0,R=0,N=Array.isArray(e),V=v.s.r,G=0,U={};N&&!e[V]&&(e[V]=[]);var J=w.skipHidden&&e["!cols"]||[],Z=w.skipHidden&&e["!rows"]||[];for(G=v.s.c;G<=v.e.c;++G)if(!(J[G]||{}).hidden)switch(k[G]=Oa(G),r=N?e[V][G]:e[k[G]+C],n){case 1:u[G]=G-v.s.c;break;case 2:u[G]=k[G];break;case 3:u[G]=w.header[G-v.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),i=d=Ch(r,null,w),R=U[d]||0,!R)U[d]=1;else{do i=d+"_"+R++;while(U[i]);U[d]=R,U[i]=1}u[G]=i}for(V=v.s.r+o;V<=v.e.r;++V)if(!(Z[V]||{}).hidden){var K=oK(e,v,V,k,n,u,N,w);(K.isempty===!1||(n===1?w.blankrows!==!1:w.blankrows))&&(O[L++]=K.row)}return O.length=L,O}var MU=/"/g;function sK(e,t,r,n,o,u,d,i){for(var v=!0,w=[],S="",C=Qa(r),k=t.s.c;k<=t.e.c;++k)if(n[k]){var O=i.dense?(e[r]||[])[k]:e[n[k]+C];if(O==null)S="";else if(O.v!=null){v=!1,S=""+(i.rawNumbers&&O.t=="n"?O.v:Ch(O,null,i));for(var L=0,R=0;L!==S.length;++L)if((R=S.charCodeAt(L))===o||R===u||R===34||i.forceQuotes){S='"'+S.replace(MU,'""')+'"';break}S=="ID"&&(S='"ID"')}else O.f!=null&&!O.F?(v=!1,S="="+O.f,S.indexOf(",")>=0&&(S='"'+S.replace(MU,'""')+'"')):S="";w.push(S)}return i.blankrows===!1&&v?null:w.join(d)}function cL(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var o=wi(e["!ref"]),u=n.FS!==void 0?n.FS:",",d=u.charCodeAt(0),i=n.RS!==void 0?n.RS:`
`,v=i.charCodeAt(0),w=new RegExp((u=="|"?"\\|":u)+"+$"),S="",C=[];n.dense=Array.isArray(e);for(var k=n.skipHidden&&e["!cols"]||[],O=n.skipHidden&&e["!rows"]||[],L=o.s.c;L<=o.e.c;++L)(k[L]||{}).hidden||(C[L]=Oa(L));for(var R=0,N=o.s.r;N<=o.e.r;++N)(O[N]||{}).hidden||(S=sK(e,o,N,C,d,v,u,n),S!=null&&(n.strip&&(S=S.replace(w,"")),(S||n.blankrows!==!1)&&r.push((R++?i:"")+S)));return delete n.dense,r.join("")}function lK(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=cL(e,t);if(typeof Pi>"u"||t.type=="string")return r;var n=Pi.utils.encode(1200,r,"str");return""+n}function kTe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var o=wi(e["!ref"]),u="",d=[],i,v=[],w=Array.isArray(e);for(i=o.s.c;i<=o.e.c;++i)d[i]=Oa(i);for(var S=o.s.r;S<=o.e.r;++S)for(u=Qa(S),i=o.s.c;i<=o.e.c;++i)if(t=d[i]+u,r=w?(e[S]||[])[i]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}v[v.length]=t+"="+n}return v}function cK(e,t,r){var n=r||{},o=+!n.skipHeader,u=e||{},d=0,i=0;if(u&&n.origin!=null)if(typeof n.origin=="number")d=n.origin;else{var v=typeof n.origin=="string"?Va(n.origin):n.origin;d=v.r,i=v.c}var w,S={s:{c:0,r:0},e:{c:i,r:d+t.length-1+o}};if(u["!ref"]){var C=wi(u["!ref"]);S.e.c=Math.max(S.e.c,C.e.c),S.e.r=Math.max(S.e.r,C.e.r),d==-1&&(d=C.e.r+1,S.e.r=d+t.length-1+o)}else d==-1&&(d=0,S.e.r=t.length-1+o);var k=n.header||[],O=0;t.forEach(function(R,N){to(R).forEach(function(V){(O=k.indexOf(V))==-1&&(k[O=k.length]=V);var G=R[V],U="z",J="",Z=Pn({c:i+O,r:d+N+o});w=hb(u,Z),G&&typeof G=="object"&&!(G instanceof Date)?u[Z]=G:(typeof G=="number"?U="n":typeof G=="boolean"?U="b":typeof G=="string"?U="s":G instanceof Date?(U="d",n.cellDates||(U="n",G=Lo(G)),J=n.dateNF||xn[14]):G===null&&n.nullError&&(U="e",G=0),w?(w.t=U,w.v=G,delete w.w,delete w.R,J&&(w.z=J)):u[Z]=w={t:U,v:G},J&&(w.z=J))})}),S.e.c=Math.max(S.e.c,i+k.length-1);var L=Qa(d);if(o)for(O=0;O<k.length;++O)u[Oa(O+i)+L]={t:"s",v:k[O]};return u["!ref"]=Hn(S),u}function OTe(e,t){return cK(null,e,t)}function hb(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Va(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?hb(e,Pn(t)):hb(e,Pn({r:t,c:r||0}))}function MTe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function uL(){return{SheetNames:[],Sheets:{}}}function hL(e,t,r,n){var o=1;if(!r)for(;o<=65535&&e.SheetNames.indexOf(r="Sheet"+o)!=-1;++o,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var u=r.match(/(^.*?)(\d+)$/);o=u&&+u[2]||0;var d=u&&u[1]||r;for(++o;o<=65535&&e.SheetNames.indexOf(r=d+o)!=-1;++o);}if(BY(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function RTe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=MTe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function DTe(e,t){return e.z=t,e}function uK(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function FTe(e,t,r){return uK(e,"#"+t,r)}function LTe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function NTe(e,t,r,n){for(var o=typeof t!="string"?t:wi(t),u=typeof t=="string"?t:Hn(t),d=o.s.r;d<=o.e.r;++d)for(var i=o.s.c;i<=o.e.c;++i){var v=hb(e,d,i);v.t="n",v.F=u,delete v.v,d==o.s.r&&i==o.s.c&&(v.f=r,n&&(v.D=!0))}return e}var BE={encode_col:Oa,encode_row:Qa,encode_cell:Pn,encode_range:Hn,decode_col:N4,decode_row:L4,split_cell:r0e,decode_cell:Va,decode_range:tl,format_cell:Ch,sheet_add_aoa:IZ,sheet_add_json:cK,sheet_add_dom:YY,aoa_to_sheet:vv,json_to_sheet:OTe,table_to_sheet:KY,table_to_book:q2e,sheet_to_csv:cL,sheet_to_txt:lK,sheet_to_json:MA,sheet_to_html:ZY,sheet_to_formulae:kTe,sheet_to_row_object_array:MA,sheet_get_cell:hb,book_new:uL,book_append_sheet:hL,book_set_sheet_visibility:RTe,cell_set_number_format:DTe,cell_set_hyperlink:uK,cell_set_internal_link:FTe,cell_add_comment:LTe,sheet_set_array_formula:NTe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},AP;function BTe(e){AP=e}function zTe(e,t){var r=AP(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var o=wi(e["!ref"]),u=n.FS!==void 0?n.FS:",",d=u.charCodeAt(0),i=n.RS!==void 0?n.RS:`
`,v=i.charCodeAt(0),w=new RegExp((u=="|"?"\\|":u)+"+$"),S="",C=[];n.dense=Array.isArray(e);for(var k=n.skipHidden&&e["!cols"]||[],O=n.skipHidden&&e["!rows"]||[],L=o.s.c;L<=o.e.c;++L)(k[L]||{}).hidden||(C[L]=Oa(L));var R=o.s.r,N=!1,V=0;return r._read=function(){if(!N)return N=!0,r.push("\uFEFF");for(;R<=o.e.r;)if(++R,!(O[R-1]||{}).hidden&&(S=sK(e,o,R-1,C,d,v,u,n),S!=null&&(n.strip&&(S=S.replace(w,"")),S||n.blankrows!==!1)))return r.push((V++?i:"")+S);return r.push(null)},r}function jTe(e,t){var r=AP(),n=t||{},o=n.header!=null?n.header:HY,u=n.footer!=null?n.footer:qY;r.push(o);var d=tl(e["!ref"]);n.dense=Array.isArray(e),r.push(XY(e,d,n));var i=d.s.r,v=!1;return r._read=function(){if(i>d.e.r)return v||(v=!0,r.push("</table>"+u)),r.push(null);for(;i<=d.e.r;){r.push(GY(e,d,i,n)),++i;break}},r}function UTe(e,t){var r=AP({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},o=0,u=1,d=[],i=0,v="",w={s:{r:0,c:0},e:{r:0,c:0}},S=t||{},C=S.range!=null?S.range:e["!ref"];switch(S.header===1?o=1:S.header==="A"?o=2:Array.isArray(S.header)&&(o=3),typeof C){case"string":w=wi(C);break;case"number":w=wi(e["!ref"]),w.s.r=C;break;default:w=C}o>0&&(u=0);var k=Qa(w.s.r),O=[],L=0,R=Array.isArray(e),N=w.s.r,V=0,G={};R&&!e[N]&&(e[N]=[]);var U=S.skipHidden&&e["!cols"]||[],J=S.skipHidden&&e["!rows"]||[];for(V=w.s.c;V<=w.e.c;++V)if(!(U[V]||{}).hidden)switch(O[V]=Oa(V),n=R?e[N][V]:e[O[V]+k],o){case 1:d[V]=V-w.s.c;break;case 2:d[V]=O[V];break;case 3:d[V]=S.header[V-w.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),v=i=Ch(n,null,S),L=G[i]||0,!L)G[i]=1;else{do v=i+"_"+L++;while(G[v]);G[i]=L,G[v]=1}d[V]=v}return N=w.s.r+u,r._read=function(){for(;N<=w.e.r;)if(!(J[N-1]||{}).hidden){var Z=oK(e,w,N,O,o,d,R,S);if(++N,Z.isempty===!1||(o===1?S.blankrows!==!1:S.blankrows)){r.push(Z.row);return}}return r.push(null)},r}var $Te={to_json:UTe,to_html:jTe,to_csv:zTe,set_readable:BTe};const VTe=Jw.version,WTe=Object.freeze(Object.defineProperty({__proto__:null,CFB:pn,SSF:cZ,parse_xlscfb:rL,parse_zip:tK,read:OA,readFile:OU,readFileSync:OU,set_cptable:qpe,set_fs:bme,stream:$Te,utils:BE,version:VTe,write:v2,writeFile:b3,writeFileAsync:ITe,writeFileSync:b3,writeFileXLSX:PTe,writeXLSX:sL},Symbol.toStringTag,{value:"Module"})),GTe=e=>{var t;try{if(console.log("Starting Excel export with data:",e),!e||!e.selectedParameters||e.selectedParameters.length===0)return console.error("No data or parameters selected for export"),!1;if(typeof WTe>"u")return console.error("XLSX library not loaded"),!1;const r=BE.book_new(),n=[],o=e.selectedParameters[0],u=((t=e.parameters[o])==null?void 0:t.length)||0;if(console.log("Data length:",u,"First param:",o),u===0)return console.error("No data points available for export"),!1;const d=HTe(e.dateRange.start,e.dateRange.end);for(let S=0;S<u;S++){const C={ndice:S+1,Data:d[S]||"N/A",Latitude:e.location.latitude,Longitude:e.location.longitude};e.selectedParameters.forEach(k=>{var L;const O=qTe(k);C[O]=((L=e.parameters[k])==null?void 0:L[S])||"N/A"}),n.push(C)}console.log("Export data prepared:",n.length,"rows");const i=BE.json_to_sheet(n);BE.book_append_sheet(r,i,"Dados Climticos");const v=new Date,w=`dados_climaticos_${v.getFullYear()}_${(v.getMonth()+1).toString().padStart(2,"0")}_${v.getDate().toString().padStart(2,"0")}.xlsx`;console.log("Attempting to save file:",w);try{b3(r,w)}catch(S){console.warn("writeFile failed, using blob fallback:",S);const C=v2(r,{bookType:"xlsx",type:"array"}),k=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),O=URL.createObjectURL(k),L=document.createElement("a");L.href=O,L.download=w,document.body.appendChild(L),L.click(),setTimeout(()=>{document.body.removeChild(L),URL.revokeObjectURL(O)},0)}return console.log("Excel export completed successfully"),!0}catch(r){return console.error("Error exporting to Excel:",r),console.error("Error details:",r instanceof Error?r.message:r),!1}},HTe=(e,t)=>{const r=[],n=new Date(e),o=new Date(t),u=new Date(n);for(;u<=o;)r.push(u.toISOString().split("T")[0]),u.setDate(u.getDate()+1);return r},qTe=e=>({T2M:"Temperatura a 2m (C)",T2M_MAX:"Temperatura Mxima a 2m (C)",T2M_MIN:"Temperatura Mnima a 2m (C)",RH2M:"Umidade Relativa a 2m (%)",PRECTOTCORR:"Precipitao (mm/dia)",PS:"Presso Atmosfrica (kPa)",WS10M:"Velocidade do Vento a 10m (m/s)",ALLSKY_SFC_SW_DWN:"Radiao Solar (kWh/m/dia)"})[e]||e;var XTe=Array.isArray,vl=XTe,ZTe=typeof K1=="object"&&K1&&K1.Object===Object&&K1,hK=ZTe,YTe=hK,KTe=typeof self=="object"&&self&&self.Object===Object&&self,JTe=YTe||KTe||Function("return this")(),Rh=JTe,QTe=Rh,eSe=QTe.Symbol,x2=eSe,RU=x2,fK=Object.prototype,tSe=fK.hasOwnProperty,rSe=fK.toString,z1=RU?RU.toStringTag:void 0;function nSe(e){var t=tSe.call(e,z1),r=e[z1];try{e[z1]=void 0;var n=!0}catch{}var o=rSe.call(e);return n&&(t?e[z1]=r:delete e[z1]),o}var iSe=nSe,aSe=Object.prototype,oSe=aSe.toString;function sSe(e){return oSe.call(e)}var lSe=sSe,DU=x2,cSe=iSe,uSe=lSe,hSe="[object Null]",fSe="[object Undefined]",FU=DU?DU.toStringTag:void 0;function dSe(e){return e==null?e===void 0?fSe:hSe:FU&&FU in Object(e)?cSe(e):uSe(e)}var Vf=dSe;function pSe(e){return e!=null&&typeof e=="object"}var Wf=pSe,mSe=Vf,gSe=Wf,_Se="[object Symbol]";function ySe(e){return typeof e=="symbol"||gSe(e)&&mSe(e)==_Se}var wv=ySe,vSe=vl,xSe=wv,wSe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bSe=/^\w*$/;function TSe(e,t){if(vSe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||xSe(e)?!0:bSe.test(e)||!wSe.test(e)||t!=null&&e in Object(t)}var fL=TSe;function SSe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Bp=SSe;const bv=Qi(Bp);var ESe=Vf,ASe=Bp,CSe="[object AsyncFunction]",PSe="[object Function]",ISe="[object GeneratorFunction]",kSe="[object Proxy]";function OSe(e){if(!ASe(e))return!1;var t=ESe(e);return t==PSe||t==ISe||t==CSe||t==kSe}var dL=OSe;const ai=Qi(dL);var MSe=Rh,RSe=MSe["__core-js_shared__"],DSe=RSe,bM=DSe,LU=function(){var e=/[^.]+$/.exec(bM&&bM.keys&&bM.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function FSe(e){return!!LU&&LU in e}var LSe=FSe,NSe=Function.prototype,BSe=NSe.toString;function zSe(e){if(e!=null){try{return BSe.call(e)}catch{}try{return e+""}catch{}}return""}var dK=zSe,jSe=dL,USe=LSe,$Se=Bp,VSe=dK,WSe=/[\\^$.*+?()[\]{}|]/g,GSe=/^\[object .+?Constructor\]$/,HSe=Function.prototype,qSe=Object.prototype,XSe=HSe.toString,ZSe=qSe.hasOwnProperty,YSe=RegExp("^"+XSe.call(ZSe).replace(WSe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function KSe(e){if(!$Se(e)||USe(e))return!1;var t=jSe(e)?YSe:GSe;return t.test(VSe(e))}var JSe=KSe;function QSe(e,t){return e==null?void 0:e[t]}var eEe=QSe,tEe=JSe,rEe=eEe;function nEe(e,t){var r=rEe(e,t);return tEe(r)?r:void 0}var $0=nEe,iEe=$0,aEe=iEe(Object,"create"),CP=aEe,NU=CP;function oEe(){this.__data__=NU?NU(null):{},this.size=0}var sEe=oEe;function lEe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var cEe=lEe,uEe=CP,hEe="__lodash_hash_undefined__",fEe=Object.prototype,dEe=fEe.hasOwnProperty;function pEe(e){var t=this.__data__;if(uEe){var r=t[e];return r===hEe?void 0:r}return dEe.call(t,e)?t[e]:void 0}var mEe=pEe,gEe=CP,_Ee=Object.prototype,yEe=_Ee.hasOwnProperty;function vEe(e){var t=this.__data__;return gEe?t[e]!==void 0:yEe.call(t,e)}var xEe=vEe,wEe=CP,bEe="__lodash_hash_undefined__";function TEe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=wEe&&t===void 0?bEe:t,this}var SEe=TEe,EEe=sEe,AEe=cEe,CEe=mEe,PEe=xEe,IEe=SEe;function Tv(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Tv.prototype.clear=EEe;Tv.prototype.delete=AEe;Tv.prototype.get=CEe;Tv.prototype.has=PEe;Tv.prototype.set=IEe;var kEe=Tv;function OEe(){this.__data__=[],this.size=0}var MEe=OEe;function REe(e,t){return e===t||e!==e&&t!==t}var pL=REe,DEe=pL;function FEe(e,t){for(var r=e.length;r--;)if(DEe(e[r][0],t))return r;return-1}var PP=FEe,LEe=PP,NEe=Array.prototype,BEe=NEe.splice;function zEe(e){var t=this.__data__,r=LEe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():BEe.call(t,r,1),--this.size,!0}var jEe=zEe,UEe=PP;function $Ee(e){var t=this.__data__,r=UEe(t,e);return r<0?void 0:t[r][1]}var VEe=$Ee,WEe=PP;function GEe(e){return WEe(this.__data__,e)>-1}var HEe=GEe,qEe=PP;function XEe(e,t){var r=this.__data__,n=qEe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var ZEe=XEe,YEe=MEe,KEe=jEe,JEe=VEe,QEe=HEe,eAe=ZEe;function Sv(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Sv.prototype.clear=YEe;Sv.prototype.delete=KEe;Sv.prototype.get=JEe;Sv.prototype.has=QEe;Sv.prototype.set=eAe;var IP=Sv,tAe=$0,rAe=Rh,nAe=tAe(rAe,"Map"),mL=nAe,BU=kEe,iAe=IP,aAe=mL;function oAe(){this.size=0,this.__data__={hash:new BU,map:new(aAe||iAe),string:new BU}}var sAe=oAe;function lAe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var cAe=lAe,uAe=cAe;function hAe(e,t){var r=e.__data__;return uAe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var kP=hAe,fAe=kP;function dAe(e){var t=fAe(this,e).delete(e);return this.size-=t?1:0,t}var pAe=dAe,mAe=kP;function gAe(e){return mAe(this,e).get(e)}var _Ae=gAe,yAe=kP;function vAe(e){return yAe(this,e).has(e)}var xAe=vAe,wAe=kP;function bAe(e,t){var r=wAe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var TAe=bAe,SAe=sAe,EAe=pAe,AAe=_Ae,CAe=xAe,PAe=TAe;function Ev(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ev.prototype.clear=SAe;Ev.prototype.delete=EAe;Ev.prototype.get=AAe;Ev.prototype.has=CAe;Ev.prototype.set=PAe;var gL=Ev,pK=gL,IAe="Expected a function";function _L(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(IAe);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],u=r.cache;if(u.has(o))return u.get(o);var d=e.apply(this,n);return r.cache=u.set(o,d)||u,d};return r.cache=new(_L.Cache||pK),r}_L.Cache=pK;var mK=_L;const kAe=Qi(mK);var OAe=mK,MAe=500;function RAe(e){var t=OAe(e,function(n){return r.size===MAe&&r.clear(),n}),r=t.cache;return t}var DAe=RAe,FAe=DAe,LAe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,NAe=/\\(\\)?/g,BAe=FAe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(LAe,function(r,n,o,u){t.push(o?u.replace(NAe,"$1"):n||r)}),t}),zAe=BAe;function jAe(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var yL=jAe,zU=x2,UAe=yL,$Ae=vl,VAe=wv,WAe=1/0,jU=zU?zU.prototype:void 0,UU=jU?jU.toString:void 0;function gK(e){if(typeof e=="string")return e;if($Ae(e))return UAe(e,gK)+"";if(VAe(e))return UU?UU.call(e):"";var t=e+"";return t=="0"&&1/e==-WAe?"-0":t}var GAe=gK,HAe=GAe;function qAe(e){return e==null?"":HAe(e)}var _K=qAe,XAe=vl,ZAe=fL,YAe=zAe,KAe=_K;function JAe(e,t){return XAe(e)?e:ZAe(e,t)?[e]:YAe(KAe(e))}var yK=JAe,QAe=wv,eCe=1/0;function tCe(e){if(typeof e=="string"||QAe(e))return e;var t=e+"";return t=="0"&&1/e==-eCe?"-0":t}var OP=tCe,rCe=yK,nCe=OP;function iCe(e,t){t=rCe(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[nCe(t[r++])];return r&&r==n?e:void 0}var vL=iCe,aCe=vL;function oCe(e,t,r){var n=e==null?void 0:aCe(e,t);return n===void 0?r:n}var vK=oCe;const Mc=Qi(vK);function sCe(e){return e==null}var lCe=sCe;const gi=Qi(lCe);var cCe=Vf,uCe=vl,hCe=Wf,fCe="[object String]";function dCe(e){return typeof e=="string"||!uCe(e)&&hCe(e)&&cCe(e)==fCe}var pCe=dCe;const C0=Qi(pCe);var xK={exports:{}},ea={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xL=Symbol.for("react.element"),wL=Symbol.for("react.portal"),MP=Symbol.for("react.fragment"),RP=Symbol.for("react.strict_mode"),DP=Symbol.for("react.profiler"),FP=Symbol.for("react.provider"),LP=Symbol.for("react.context"),mCe=Symbol.for("react.server_context"),NP=Symbol.for("react.forward_ref"),BP=Symbol.for("react.suspense"),zP=Symbol.for("react.suspense_list"),jP=Symbol.for("react.memo"),UP=Symbol.for("react.lazy"),gCe=Symbol.for("react.offscreen"),wK;wK=Symbol.for("react.module.reference");function Bc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case xL:switch(e=e.type,e){case MP:case DP:case RP:case BP:case zP:return e;default:switch(e=e&&e.$$typeof,e){case mCe:case LP:case NP:case UP:case jP:case FP:return e;default:return t}}case wL:return t}}}ea.ContextConsumer=LP;ea.ContextProvider=FP;ea.Element=xL;ea.ForwardRef=NP;ea.Fragment=MP;ea.Lazy=UP;ea.Memo=jP;ea.Portal=wL;ea.Profiler=DP;ea.StrictMode=RP;ea.Suspense=BP;ea.SuspenseList=zP;ea.isAsyncMode=function(){return!1};ea.isConcurrentMode=function(){return!1};ea.isContextConsumer=function(e){return Bc(e)===LP};ea.isContextProvider=function(e){return Bc(e)===FP};ea.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===xL};ea.isForwardRef=function(e){return Bc(e)===NP};ea.isFragment=function(e){return Bc(e)===MP};ea.isLazy=function(e){return Bc(e)===UP};ea.isMemo=function(e){return Bc(e)===jP};ea.isPortal=function(e){return Bc(e)===wL};ea.isProfiler=function(e){return Bc(e)===DP};ea.isStrictMode=function(e){return Bc(e)===RP};ea.isSuspense=function(e){return Bc(e)===BP};ea.isSuspenseList=function(e){return Bc(e)===zP};ea.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===MP||e===DP||e===RP||e===BP||e===zP||e===gCe||typeof e=="object"&&e!==null&&(e.$$typeof===UP||e.$$typeof===jP||e.$$typeof===FP||e.$$typeof===LP||e.$$typeof===NP||e.$$typeof===wK||e.getModuleId!==void 0)};ea.typeOf=Bc;xK.exports=ea;var _Ce=xK.exports,yCe=Vf,vCe=Wf,xCe="[object Number]";function wCe(e){return typeof e=="number"||vCe(e)&&yCe(e)==xCe}var bK=wCe;const bCe=Qi(bK);var TCe=bK;function SCe(e){return TCe(e)&&e!=+e}var ECe=SCe;const w2=Qi(ECe);var _u=function(t){return t===0?0:t>0?1:-1},Gm=function(t){return C0(t)&&t.indexOf("%")===t.length-1},Ur=function(t){return bCe(t)&&!w2(t)},ACe=function(t){return gi(t)},Fo=function(t){return Ur(t)||C0(t)},CCe=0,b2=function(t){var r=++CCe;return"".concat(t||"").concat(r)},P0=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ur(t)&&!C0(t))return n;var u;if(Gm(t)){var d=t.indexOf("%");u=r*parseFloat(t.slice(0,d))/100}else u=+t;return w2(u)&&(u=n),o&&u>r&&(u=r),u},qd=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},PCe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},o=0;o<r;o++)if(!n[t[o]])n[t[o]]=!0;else return!0;return!1},fu=function(t,r){return Ur(t)&&Ur(r)?function(n){return t+n*(r-t)}:function(){return r}};function RA(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Mc(n,t))===r})}var ICe=function(t,r){return Ur(t)&&Ur(r)?t-r:C0(t)&&C0(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function gy(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function T3(e){"@babel/helpers - typeof";return T3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T3(e)}var kCe=["viewBox","children"],OCe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],$U=["points","pathLength"],TM={svg:kCe,polygon:$U,polyline:$U},bL=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],DA=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(ue.isValidElement(t)&&(n=t.props),!bv(n))return null;var o={};return Object.keys(n).forEach(function(u){bL.includes(u)&&(o[u]=r||function(d){return n[u](n,d)})}),o},MCe=function(t,r,n){return function(o){return t(r,n,o),null}},FA=function(t,r,n){if(!bv(t)||T3(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(u){var d=t[u];bL.includes(u)&&typeof d=="function"&&(o||(o={}),o[u]=MCe(d,r,n))}),o},RCe=["children"],DCe=["children"];function VU(e,t){if(e==null)return{};var r=FCe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function FCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S3(e){"@babel/helpers - typeof";return S3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S3(e)}var WU={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Ef=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},GU=null,SM=null,TL=function e(t){if(t===GU&&Array.isArray(SM))return SM;var r=[];return ue.Children.forEach(t,function(n){gi(n)||(_Ce.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),SM=r,GU=t,r};function Rc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(o){return Ef(o)}):n=[Ef(t)],TL(e).forEach(function(o){var u=Mc(o,"type.displayName")||Mc(o,"type.name");n.indexOf(u)!==-1&&r.push(o)}),r}function zl(e,t){var r=Rc(e,t);return r&&r[0]}var HU=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,o=r.height;return!(!Ur(n)||n<=0||!Ur(o)||o<=0)},LCe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],NCe=function(t){return t&&t.type&&C0(t.type)&&LCe.indexOf(t.type)>=0},BCe=function(t){return t&&S3(t)==="object"&&"clipDot"in t},zCe=function(t,r,n,o){var u,d=(u=TM==null?void 0:TM[o])!==null&&u!==void 0?u:[];return r.startsWith("data-")||!ai(t)&&(o&&d.includes(r)||OCe.includes(r))||n&&bL.includes(r)},Ei=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(ue.isValidElement(t)&&(o=t.props),!bv(o))return null;var u={};return Object.keys(o).forEach(function(d){var i;zCe((i=o)===null||i===void 0?void 0:i[d],d,r,n)&&(u[d]=o[d])}),u},E3=function e(t,r){if(t===r)return!0;var n=ue.Children.count(t);if(n!==ue.Children.count(r))return!1;if(n===0)return!0;if(n===1)return qU(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var o=0;o<n;o++){var u=t[o],d=r[o];if(Array.isArray(u)||Array.isArray(d)){if(!e(u,d))return!1}else if(!qU(u,d))return!1}return!0},qU=function(t,r){if(gi(t)&&gi(r))return!0;if(!gi(t)&&!gi(r)){var n=t.props||{},o=n.children,u=VU(n,RCe),d=r.props||{},i=d.children,v=VU(d,DCe);return o&&i?gy(u,v)&&E3(o,i):!o&&!i?gy(u,v):!1}return!1},XU=function(t,r){var n=[],o={};return TL(t).forEach(function(u,d){if(NCe(u))n.push(u);else if(u){var i=Ef(u.type),v=r[i]||{},w=v.handler,S=v.once;if(w&&(!S||!o[i])){var C=w(u,i,d);n.push(C),o[i]=!0}}}),n},jCe=function(t){var r=t&&t.type;return r&&WU[r]?WU[r]:null},UCe=function(t,r){return TL(r).indexOf(t)},$Ce=["children","width","height","viewBox","className","style","title","desc"];function A3(){return A3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A3.apply(this,arguments)}function VCe(e,t){if(e==null)return{};var r=WCe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function C3(e){var t=e.children,r=e.width,n=e.height,o=e.viewBox,u=e.className,d=e.style,i=e.title,v=e.desc,w=VCe(e,$Ce),S=o||{width:r,height:n,x:0,y:0},C=Ai("recharts-surface",u);return it.createElement("svg",A3({},Ei(w,!0,"svg"),{className:C,width:r,height:n,style:d,viewBox:"".concat(S.x," ").concat(S.y," ").concat(S.width," ").concat(S.height)}),it.createElement("title",null,i),it.createElement("desc",null,v),t)}var GCe=["children","className"];function P3(){return P3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P3.apply(this,arguments)}function HCe(e,t){if(e==null)return{};var r=qCe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var lo=it.forwardRef(function(e,t){var r=e.children,n=e.className,o=HCe(e,GCe),u=Ai("recharts-layer",n);return it.createElement("g",P3({className:u},Ei(o,!0),{ref:t}),r)}),Af=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),u=2;u<n;u++)o[u-2]=arguments[u]};function XCe(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var u=Array(o);++n<o;)u[n]=e[n+t];return u}var ZCe=XCe,YCe=ZCe;function KCe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:YCe(e,t,r)}var JCe=KCe,QCe="\\ud800-\\udfff",ePe="\\u0300-\\u036f",tPe="\\ufe20-\\ufe2f",rPe="\\u20d0-\\u20ff",nPe=ePe+tPe+rPe,iPe="\\ufe0e\\ufe0f",aPe="\\u200d",oPe=RegExp("["+aPe+QCe+nPe+iPe+"]");function sPe(e){return oPe.test(e)}var TK=sPe;function lPe(e){return e.split("")}var cPe=lPe,SK="\\ud800-\\udfff",uPe="\\u0300-\\u036f",hPe="\\ufe20-\\ufe2f",fPe="\\u20d0-\\u20ff",dPe=uPe+hPe+fPe,pPe="\\ufe0e\\ufe0f",mPe="["+SK+"]",I3="["+dPe+"]",k3="\\ud83c[\\udffb-\\udfff]",gPe="(?:"+I3+"|"+k3+")",EK="[^"+SK+"]",AK="(?:\\ud83c[\\udde6-\\uddff]){2}",CK="[\\ud800-\\udbff][\\udc00-\\udfff]",_Pe="\\u200d",PK=gPe+"?",IK="["+pPe+"]?",yPe="(?:"+_Pe+"(?:"+[EK,AK,CK].join("|")+")"+IK+PK+")*",vPe=IK+PK+yPe,xPe="(?:"+[EK+I3+"?",I3,AK,CK,mPe].join("|")+")",wPe=RegExp(k3+"(?="+k3+")|"+xPe+vPe,"g");function bPe(e){return e.match(wPe)||[]}var TPe=bPe,SPe=cPe,EPe=TK,APe=TPe;function CPe(e){return EPe(e)?APe(e):SPe(e)}var PPe=CPe,IPe=JCe,kPe=TK,OPe=PPe,MPe=_K;function RPe(e){return function(t){t=MPe(t);var r=kPe(t)?OPe(t):void 0,n=r?r[0]:t.charAt(0),o=r?IPe(r,1).join(""):t.slice(1);return n[e]()+o}}var DPe=RPe,FPe=DPe,LPe=FPe("toUpperCase"),NPe=LPe;const $P=Qi(NPe);function va(e){return function(){return e}}const kK=Math.cos,LA=Math.sin,Cu=Math.sqrt,NA=Math.PI,VP=2*NA,O3=Math.PI,M3=2*O3,Nm=1e-6,BPe=M3-Nm;function OK(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function zPe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return OK;const r=10**t;return function(n){this._+=n[0];for(let o=1,u=n.length;o<u;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class jPe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?OK:zPe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,u,d){this._append`C${+t},${+r},${+n},${+o},${this._x1=+u},${this._y1=+d}`}arcTo(t,r,n,o,u){if(t=+t,r=+r,n=+n,o=+o,u=+u,u<0)throw new Error(`negative radius: ${u}`);let d=this._x1,i=this._y1,v=n-t,w=o-r,S=d-t,C=i-r,k=S*S+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(k>Nm)if(!(Math.abs(C*v-w*S)>Nm)||!u)this._append`L${this._x1=t},${this._y1=r}`;else{let O=n-d,L=o-i,R=v*v+w*w,N=O*O+L*L,V=Math.sqrt(R),G=Math.sqrt(k),U=u*Math.tan((O3-Math.acos((R+k-N)/(2*V*G)))/2),J=U/G,Z=U/V;Math.abs(J-1)>Nm&&this._append`L${t+J*S},${r+J*C}`,this._append`A${u},${u},0,0,${+(C*O>S*L)},${this._x1=t+Z*v},${this._y1=r+Z*w}`}}arc(t,r,n,o,u,d){if(t=+t,r=+r,n=+n,d=!!d,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(o),v=n*Math.sin(o),w=t+i,S=r+v,C=1^d,k=d?o-u:u-o;this._x1===null?this._append`M${w},${S}`:(Math.abs(this._x1-w)>Nm||Math.abs(this._y1-S)>Nm)&&this._append`L${w},${S}`,n&&(k<0&&(k=k%M3+M3),k>BPe?this._append`A${n},${n},0,1,${C},${t-i},${r-v}A${n},${n},0,1,${C},${this._x1=w},${this._y1=S}`:k>Nm&&this._append`A${n},${n},0,${+(k>=O3)},${C},${this._x1=t+n*Math.cos(u)},${this._y1=r+n*Math.sin(u)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function SL(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new jPe(t)}function EL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function MK(e){this._context=e}MK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function WP(e){return new MK(e)}function RK(e){return e[0]}function DK(e){return e[1]}function FK(e,t){var r=va(!0),n=null,o=WP,u=null,d=SL(i);e=typeof e=="function"?e:e===void 0?RK:va(e),t=typeof t=="function"?t:t===void 0?DK:va(t);function i(v){var w,S=(v=EL(v)).length,C,k=!1,O;for(n==null&&(u=o(O=d())),w=0;w<=S;++w)!(w<S&&r(C=v[w],w,v))===k&&((k=!k)?u.lineStart():u.lineEnd()),k&&u.point(+e(C,w,v),+t(C,w,v));if(O)return u=null,O+""||null}return i.x=function(v){return arguments.length?(e=typeof v=="function"?v:va(+v),i):e},i.y=function(v){return arguments.length?(t=typeof v=="function"?v:va(+v),i):t},i.defined=function(v){return arguments.length?(r=typeof v=="function"?v:va(!!v),i):r},i.curve=function(v){return arguments.length?(o=v,n!=null&&(u=o(n)),i):o},i.context=function(v){return arguments.length?(v==null?n=u=null:u=o(n=v),i):n},i}function oE(e,t,r){var n=null,o=va(!0),u=null,d=WP,i=null,v=SL(w);e=typeof e=="function"?e:e===void 0?RK:va(+e),t=typeof t=="function"?t:va(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?DK:va(+r);function w(C){var k,O,L,R=(C=EL(C)).length,N,V=!1,G,U=new Array(R),J=new Array(R);for(u==null&&(i=d(G=v())),k=0;k<=R;++k){if(!(k<R&&o(N=C[k],k,C))===V)if(V=!V)O=k,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),L=k-1;L>=O;--L)i.point(U[L],J[L]);i.lineEnd(),i.areaEnd()}V&&(U[k]=+e(N,k,C),J[k]=+t(N,k,C),i.point(n?+n(N,k,C):U[k],r?+r(N,k,C):J[k]))}if(G)return i=null,G+""||null}function S(){return FK().defined(o).curve(d).context(u)}return w.x=function(C){return arguments.length?(e=typeof C=="function"?C:va(+C),n=null,w):e},w.x0=function(C){return arguments.length?(e=typeof C=="function"?C:va(+C),w):e},w.x1=function(C){return arguments.length?(n=C==null?null:typeof C=="function"?C:va(+C),w):n},w.y=function(C){return arguments.length?(t=typeof C=="function"?C:va(+C),r=null,w):t},w.y0=function(C){return arguments.length?(t=typeof C=="function"?C:va(+C),w):t},w.y1=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:va(+C),w):r},w.lineX0=w.lineY0=function(){return S().x(e).y(t)},w.lineY1=function(){return S().x(e).y(r)},w.lineX1=function(){return S().x(n).y(t)},w.defined=function(C){return arguments.length?(o=typeof C=="function"?C:va(!!C),w):o},w.curve=function(C){return arguments.length?(d=C,u!=null&&(i=d(u)),w):d},w.context=function(C){return arguments.length?(C==null?u=i=null:i=d(u=C),w):u},w}class LK{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function UPe(e){return new LK(e,!0)}function $Pe(e){return new LK(e,!1)}const AL={draw(e,t){const r=Cu(t/NA);e.moveTo(r,0),e.arc(0,0,r,0,VP)}},VPe={draw(e,t){const r=Cu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},NK=Cu(1/3),WPe=NK*2,GPe={draw(e,t){const r=Cu(t/WPe),n=r*NK;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},HPe={draw(e,t){const r=Cu(t),n=-r/2;e.rect(n,n,r,r)}},qPe=.8908130915292852,BK=LA(NA/10)/LA(7*NA/10),XPe=LA(VP/10)*BK,ZPe=-kK(VP/10)*BK,YPe={draw(e,t){const r=Cu(t*qPe),n=XPe*r,o=ZPe*r;e.moveTo(0,-r),e.lineTo(n,o);for(let u=1;u<5;++u){const d=VP*u/5,i=kK(d),v=LA(d);e.lineTo(v*r,-i*r),e.lineTo(i*n-v*o,v*n+i*o)}e.closePath()}},EM=Cu(3),KPe={draw(e,t){const r=-Cu(t/(EM*3));e.moveTo(0,r*2),e.lineTo(-EM*r,-r),e.lineTo(EM*r,-r),e.closePath()}},dc=-.5,pc=Cu(3)/2,R3=1/Cu(12),JPe=(R3/2+1)*3,QPe={draw(e,t){const r=Cu(t/JPe),n=r/2,o=r*R3,u=n,d=r*R3+r,i=-u,v=d;e.moveTo(n,o),e.lineTo(u,d),e.lineTo(i,v),e.lineTo(dc*n-pc*o,pc*n+dc*o),e.lineTo(dc*u-pc*d,pc*u+dc*d),e.lineTo(dc*i-pc*v,pc*i+dc*v),e.lineTo(dc*n+pc*o,dc*o-pc*n),e.lineTo(dc*u+pc*d,dc*d-pc*u),e.lineTo(dc*i+pc*v,dc*v-pc*i),e.closePath()}};function eIe(e,t){let r=null,n=SL(o);e=typeof e=="function"?e:va(e||AL),t=typeof t=="function"?t:va(t===void 0?64:+t);function o(){let u;if(r||(r=u=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),u)return r=null,u+""||null}return o.type=function(u){return arguments.length?(e=typeof u=="function"?u:va(u),o):e},o.size=function(u){return arguments.length?(t=typeof u=="function"?u:va(+u),o):t},o.context=function(u){return arguments.length?(r=u??null,o):r},o}function BA(){}function zA(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function zK(e){this._context=e}zK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:zA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:zA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tIe(e){return new zK(e)}function jK(e){this._context=e}jK.prototype={areaStart:BA,areaEnd:BA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:zA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rIe(e){return new jK(e)}function UK(e){this._context=e}UK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:zA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nIe(e){return new UK(e)}function $K(e){this._context=e}$K.prototype={areaStart:BA,areaEnd:BA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function iIe(e){return new $K(e)}function ZU(e){return e<0?-1:1}function YU(e,t,r){var n=e._x1-e._x0,o=t-e._x1,u=(e._y1-e._y0)/(n||o<0&&-0),d=(r-e._y1)/(o||n<0&&-0),i=(u*o+d*n)/(n+o);return(ZU(u)+ZU(d))*Math.min(Math.abs(u),Math.abs(d),.5*Math.abs(i))||0}function KU(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function AM(e,t,r){var n=e._x0,o=e._y0,u=e._x1,d=e._y1,i=(u-n)/3;e._context.bezierCurveTo(n+i,o+i*t,u-i,d-i*r,u,d)}function jA(e){this._context=e}jA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AM(this,this._t0,KU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,AM(this,KU(this,r=YU(this,e,t)),r);break;default:AM(this,this._t0,r=YU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function VK(e){this._context=new WK(e)}(VK.prototype=Object.create(jA.prototype)).point=function(e,t){jA.prototype.point.call(this,t,e)};function WK(e){this._context=e}WK.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,u){this._context.bezierCurveTo(t,e,n,r,u,o)}};function aIe(e){return new jA(e)}function oIe(e){return new VK(e)}function GK(e){this._context=e}GK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=JU(e),o=JU(t),u=0,d=1;d<r;++u,++d)this._context.bezierCurveTo(n[0][u],o[0][u],n[1][u],o[1][u],e[d],t[d]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function JU(e){var t,r=e.length-1,n,o=new Array(r),u=new Array(r),d=new Array(r);for(o[0]=0,u[0]=2,d[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,u[t]=4,d[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,u[r-1]=7,d[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/u[t-1],u[t]-=n,d[t]-=n*d[t-1];for(o[r-1]=d[r-1]/u[r-1],t=r-2;t>=0;--t)o[t]=(d[t]-o[t+1])/u[t];for(u[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)u[t]=2*e[t+1]-o[t+1];return[o,u]}function sIe(e){return new GK(e)}function GP(e,t){this._context=e,this._t=t}GP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function lIe(e){return new GP(e,.5)}function cIe(e){return new GP(e,0)}function uIe(e){return new GP(e,1)}function $y(e,t){if((d=e.length)>1)for(var r=1,n,o,u=e[t[0]],d,i=u.length;r<d;++r)for(o=u,u=e[t[r]],n=0;n<i;++n)u[n][1]+=u[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}function D3(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function hIe(e,t){return e[t]}function fIe(e){const t=[];return t.key=e,t}function dIe(){var e=va([]),t=D3,r=$y,n=hIe;function o(u){var d=Array.from(e.apply(this,arguments),fIe),i,v=d.length,w=-1,S;for(const C of u)for(i=0,++w;i<v;++i)(d[i][w]=[0,+n(C,d[i].key,w,u)]).data=C;for(i=0,S=EL(t(d));i<v;++i)d[S[i]].index=i;return r(d,S),d}return o.keys=function(u){return arguments.length?(e=typeof u=="function"?u:va(Array.from(u)),o):e},o.value=function(u){return arguments.length?(n=typeof u=="function"?u:va(+u),o):n},o.order=function(u){return arguments.length?(t=u==null?D3:typeof u=="function"?u:va(Array.from(u)),o):t},o.offset=function(u){return arguments.length?(r=u??$y,o):r},o}function pIe(e,t){if((n=e.length)>0){for(var r,n,o=0,u=e[0].length,d;o<u;++o){for(d=r=0;r<n;++r)d+=e[r][o][1]||0;if(d)for(r=0;r<n;++r)e[r][o][1]/=d}$y(e,t)}}function mIe(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,u=n.length;r<u;++r){for(var d=0,i=0;d<o;++d)i+=e[d][r][1]||0;n[r][1]+=n[r][0]=-i/2}$y(e,t)}}function gIe(e,t){if(!(!((d=e.length)>0)||!((u=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,u,d;n<u;++n){for(var i=0,v=0,w=0;i<d;++i){for(var S=e[t[i]],C=S[n][1]||0,k=S[n-1][1]||0,O=(C-k)/2,L=0;L<i;++L){var R=e[t[L]],N=R[n][1]||0,V=R[n-1][1]||0;O+=N-V}v+=C,w+=O*C}o[n-1][1]+=o[n-1][0]=r,v&&(r-=w/v)}o[n-1][1]+=o[n-1][0]=r,$y(e,t)}}function fb(e){"@babel/helpers - typeof";return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(e)}var _Ie=["type","size","sizeType"];function F3(){return F3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F3.apply(this,arguments)}function QU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function e$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QU(Object(r),!0).forEach(function(n){yIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yIe(e,t,r){return t=vIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vIe(e){var t=xIe(e,"string");return fb(t)=="symbol"?t:t+""}function xIe(e,t){if(fb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wIe(e,t){if(e==null)return{};var r=bIe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var HK={symbolCircle:AL,symbolCross:VPe,symbolDiamond:GPe,symbolSquare:HPe,symbolStar:YPe,symbolTriangle:KPe,symbolWye:QPe},TIe=Math.PI/180,SIe=function(t){var r="symbol".concat($P(t));return HK[r]||AL},EIe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*TIe;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},AIe=function(t,r){HK["symbol".concat($P(t))]=r},CL=function(t){var r=t.type,n=r===void 0?"circle":r,o=t.size,u=o===void 0?64:o,d=t.sizeType,i=d===void 0?"area":d,v=wIe(t,_Ie),w=e$(e$({},v),{},{type:n,size:u,sizeType:i}),S=function(){var N=SIe(n),V=eIe().type(N).size(EIe(u,i,n));return V()},C=w.className,k=w.cx,O=w.cy,L=Ei(w,!0);return k===+k&&O===+O&&u===+u?it.createElement("path",F3({},L,{className:Ai("recharts-symbols",C),transform:"translate(".concat(k,", ").concat(O,")"),d:S()})):null};CL.registerSymbol=AIe;function Vy(e){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(e)}function L3(){return L3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L3.apply(this,arguments)}function t$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function CIe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t$(Object(r),!0).forEach(function(n){db(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XK(n.key),n)}}function kIe(e,t,r){return t&&IIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function OIe(e,t,r){return t=UA(t),MIe(e,qK()?Reflect.construct(t,r||[],UA(e).constructor):t.apply(e,r))}function MIe(e,t){if(t&&(Vy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RIe(e)}function RIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qK=function(){return!!e})()}function UA(e){return UA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UA(e)}function DIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N3(e,t)}function N3(e,t){return N3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N3(e,t)}function db(e,t,r){return t=XK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XK(e){var t=FIe(e,"string");return Vy(t)=="symbol"?t:t+""}function FIe(e,t){if(Vy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mc=32,PL=function(e){function t(){return PIe(this,t),OIe(this,t,arguments)}return DIe(t,e),kIe(t,[{key:"renderIcon",value:function(n){var o=this.props.inactiveColor,u=mc/2,d=mc/6,i=mc/3,v=n.inactive?o:n.color;if(n.type==="plainline")return it.createElement("line",{strokeWidth:4,fill:"none",stroke:v,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:u,x2:mc,y2:u,className:"recharts-legend-icon"});if(n.type==="line")return it.createElement("path",{strokeWidth:4,fill:"none",stroke:v,d:"M0,".concat(u,"h").concat(i,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*i,",").concat(u,`
            H`).concat(mc,"M").concat(2*i,",").concat(u,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(i,",").concat(u),className:"recharts-legend-icon"});if(n.type==="rect")return it.createElement("path",{stroke:"none",fill:v,d:"M0,".concat(mc/8,"h").concat(mc,"v").concat(mc*3/4,"h").concat(-mc,"z"),className:"recharts-legend-icon"});if(it.isValidElement(n.legendIcon)){var w=CIe({},n);return delete w.legendIcon,it.cloneElement(n.legendIcon,w)}return it.createElement(CL,{fill:v,cx:u,cy:u,size:mc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,o=this.props,u=o.payload,d=o.iconSize,i=o.layout,v=o.formatter,w=o.inactiveColor,S={x:0,y:0,width:mc,height:mc},C={display:i==="horizontal"?"inline-block":"block",marginRight:10},k={display:"inline-block",verticalAlign:"middle",marginRight:4};return u.map(function(O,L){var R=O.formatter||v,N=Ai(db(db({"recharts-legend-item":!0},"legend-item-".concat(L),!0),"inactive",O.inactive));if(O.type==="none")return null;var V=ai(O.value)?null:O.value;Af(!ai(O.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var G=O.inactive?w:O.color;return it.createElement("li",L3({className:N,style:C,key:"legend-item-".concat(L)},FA(n.props,O,L)),it.createElement(C3,{width:d,height:d,viewBox:S,style:k},n.renderIcon(O)),it.createElement("span",{className:"recharts-legend-item-text",style:{color:G}},R?R(V,O,L):V))})}},{key:"render",value:function(){var n=this.props,o=n.payload,u=n.layout,d=n.align;if(!o||!o.length)return null;var i={padding:0,margin:0,textAlign:u==="horizontal"?d:"left"};return it.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(ue.PureComponent);db(PL,"displayName","Legend");db(PL,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var LIe=IP;function NIe(){this.__data__=new LIe,this.size=0}var BIe=NIe;function zIe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var jIe=zIe;function UIe(e){return this.__data__.get(e)}var $Ie=UIe;function VIe(e){return this.__data__.has(e)}var WIe=VIe,GIe=IP,HIe=mL,qIe=gL,XIe=200;function ZIe(e,t){var r=this.__data__;if(r instanceof GIe){var n=r.__data__;if(!HIe||n.length<XIe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new qIe(n)}return r.set(e,t),this.size=r.size,this}var YIe=ZIe,KIe=IP,JIe=BIe,QIe=jIe,eke=$Ie,tke=WIe,rke=YIe;function Av(e){var t=this.__data__=new KIe(e);this.size=t.size}Av.prototype.clear=JIe;Av.prototype.delete=QIe;Av.prototype.get=eke;Av.prototype.has=tke;Av.prototype.set=rke;var ZK=Av,nke="__lodash_hash_undefined__";function ike(e){return this.__data__.set(e,nke),this}var ake=ike;function oke(e){return this.__data__.has(e)}var ske=oke,lke=gL,cke=ake,uke=ske;function $A(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new lke;++t<r;)this.add(e[t])}$A.prototype.add=$A.prototype.push=cke;$A.prototype.has=uke;var YK=$A;function hke(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var KK=hke;function fke(e,t){return e.has(t)}var JK=fke,dke=YK,pke=KK,mke=JK,gke=1,_ke=2;function yke(e,t,r,n,o,u){var d=r&gke,i=e.length,v=t.length;if(i!=v&&!(d&&v>i))return!1;var w=u.get(e),S=u.get(t);if(w&&S)return w==t&&S==e;var C=-1,k=!0,O=r&_ke?new dke:void 0;for(u.set(e,t),u.set(t,e);++C<i;){var L=e[C],R=t[C];if(n)var N=d?n(R,L,C,t,e,u):n(L,R,C,e,t,u);if(N!==void 0){if(N)continue;k=!1;break}if(O){if(!pke(t,function(V,G){if(!mke(O,G)&&(L===V||o(L,V,r,n,u)))return O.push(G)})){k=!1;break}}else if(!(L===R||o(L,R,r,n,u))){k=!1;break}}return u.delete(e),u.delete(t),k}var QK=yke,vke=Rh,xke=vke.Uint8Array,wke=xke;function bke(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var Tke=bke;function Ske(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var IL=Ske,r$=x2,n$=wke,Eke=pL,Ake=QK,Cke=Tke,Pke=IL,Ike=1,kke=2,Oke="[object Boolean]",Mke="[object Date]",Rke="[object Error]",Dke="[object Map]",Fke="[object Number]",Lke="[object RegExp]",Nke="[object Set]",Bke="[object String]",zke="[object Symbol]",jke="[object ArrayBuffer]",Uke="[object DataView]",i$=r$?r$.prototype:void 0,CM=i$?i$.valueOf:void 0;function $ke(e,t,r,n,o,u,d){switch(r){case Uke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case jke:return!(e.byteLength!=t.byteLength||!u(new n$(e),new n$(t)));case Oke:case Mke:case Fke:return Eke(+e,+t);case Rke:return e.name==t.name&&e.message==t.message;case Lke:case Bke:return e==t+"";case Dke:var i=Cke;case Nke:var v=n&Ike;if(i||(i=Pke),e.size!=t.size&&!v)return!1;var w=d.get(e);if(w)return w==t;n|=kke,d.set(e,t);var S=Ake(i(e),i(t),n,o,u,d);return d.delete(e),S;case zke:if(CM)return CM.call(e)==CM.call(t)}return!1}var Vke=$ke;function Wke(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var eJ=Wke,Gke=eJ,Hke=vl;function qke(e,t,r){var n=t(e);return Hke(e)?n:Gke(n,r(e))}var Xke=qke;function Zke(e,t){for(var r=-1,n=e==null?0:e.length,o=0,u=[];++r<n;){var d=e[r];t(d,r,e)&&(u[o++]=d)}return u}var Yke=Zke;function Kke(){return[]}var Jke=Kke,Qke=Yke,eOe=Jke,tOe=Object.prototype,rOe=tOe.propertyIsEnumerable,a$=Object.getOwnPropertySymbols,nOe=a$?function(e){return e==null?[]:(e=Object(e),Qke(a$(e),function(t){return rOe.call(e,t)}))}:eOe,iOe=nOe;function aOe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var oOe=aOe,sOe=Vf,lOe=Wf,cOe="[object Arguments]";function uOe(e){return lOe(e)&&sOe(e)==cOe}var hOe=uOe,o$=hOe,fOe=Wf,tJ=Object.prototype,dOe=tJ.hasOwnProperty,pOe=tJ.propertyIsEnumerable,mOe=o$(function(){return arguments}())?o$:function(e){return fOe(e)&&dOe.call(e,"callee")&&!pOe.call(e,"callee")},kL=mOe,VA={exports:{}};function gOe(){return!1}var _Oe=gOe;VA.exports;(function(e,t){var r=Rh,n=_Oe,o=t&&!t.nodeType&&t,u=o&&!0&&e&&!e.nodeType&&e,d=u&&u.exports===o,i=d?r.Buffer:void 0,v=i?i.isBuffer:void 0,w=v||n;e.exports=w})(VA,VA.exports);var rJ=VA.exports,yOe=9007199254740991,vOe=/^(?:0|[1-9]\d*)$/;function xOe(e,t){var r=typeof e;return t=t??yOe,!!t&&(r=="number"||r!="symbol"&&vOe.test(e))&&e>-1&&e%1==0&&e<t}var OL=xOe,wOe=9007199254740991;function bOe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=wOe}var ML=bOe,TOe=Vf,SOe=ML,EOe=Wf,AOe="[object Arguments]",COe="[object Array]",POe="[object Boolean]",IOe="[object Date]",kOe="[object Error]",OOe="[object Function]",MOe="[object Map]",ROe="[object Number]",DOe="[object Object]",FOe="[object RegExp]",LOe="[object Set]",NOe="[object String]",BOe="[object WeakMap]",zOe="[object ArrayBuffer]",jOe="[object DataView]",UOe="[object Float32Array]",$Oe="[object Float64Array]",VOe="[object Int8Array]",WOe="[object Int16Array]",GOe="[object Int32Array]",HOe="[object Uint8Array]",qOe="[object Uint8ClampedArray]",XOe="[object Uint16Array]",ZOe="[object Uint32Array]",Ca={};Ca[UOe]=Ca[$Oe]=Ca[VOe]=Ca[WOe]=Ca[GOe]=Ca[HOe]=Ca[qOe]=Ca[XOe]=Ca[ZOe]=!0;Ca[AOe]=Ca[COe]=Ca[zOe]=Ca[POe]=Ca[jOe]=Ca[IOe]=Ca[kOe]=Ca[OOe]=Ca[MOe]=Ca[ROe]=Ca[DOe]=Ca[FOe]=Ca[LOe]=Ca[NOe]=Ca[BOe]=!1;function YOe(e){return EOe(e)&&SOe(e.length)&&!!Ca[TOe(e)]}var KOe=YOe;function JOe(e){return function(t){return e(t)}}var nJ=JOe,WA={exports:{}};WA.exports;(function(e,t){var r=hK,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,u=o&&o.exports===n,d=u&&r.process,i=function(){try{var v=o&&o.require&&o.require("util").types;return v||d&&d.binding&&d.binding("util")}catch{}}();e.exports=i})(WA,WA.exports);var QOe=WA.exports,eMe=KOe,tMe=nJ,s$=QOe,l$=s$&&s$.isTypedArray,rMe=l$?tMe(l$):eMe,iJ=rMe,nMe=oOe,iMe=kL,aMe=vl,oMe=rJ,sMe=OL,lMe=iJ,cMe=Object.prototype,uMe=cMe.hasOwnProperty;function hMe(e,t){var r=aMe(e),n=!r&&iMe(e),o=!r&&!n&&oMe(e),u=!r&&!n&&!o&&lMe(e),d=r||n||o||u,i=d?nMe(e.length,String):[],v=i.length;for(var w in e)(t||uMe.call(e,w))&&!(d&&(w=="length"||o&&(w=="offset"||w=="parent")||u&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||sMe(w,v)))&&i.push(w);return i}var fMe=hMe,dMe=Object.prototype;function pMe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||dMe;return e===r}var mMe=pMe;function gMe(e,t){return function(r){return e(t(r))}}var aJ=gMe,_Me=aJ,yMe=_Me(Object.keys,Object),vMe=yMe,xMe=mMe,wMe=vMe,bMe=Object.prototype,TMe=bMe.hasOwnProperty;function SMe(e){if(!xMe(e))return wMe(e);var t=[];for(var r in Object(e))TMe.call(e,r)&&r!="constructor"&&t.push(r);return t}var EMe=SMe,AMe=dL,CMe=ML;function PMe(e){return e!=null&&CMe(e.length)&&!AMe(e)}var T2=PMe,IMe=fMe,kMe=EMe,OMe=T2;function MMe(e){return OMe(e)?IMe(e):kMe(e)}var HP=MMe,RMe=Xke,DMe=iOe,FMe=HP;function LMe(e){return RMe(e,FMe,DMe)}var NMe=LMe,c$=NMe,BMe=1,zMe=Object.prototype,jMe=zMe.hasOwnProperty;function UMe(e,t,r,n,o,u){var d=r&BMe,i=c$(e),v=i.length,w=c$(t),S=w.length;if(v!=S&&!d)return!1;for(var C=v;C--;){var k=i[C];if(!(d?k in t:jMe.call(t,k)))return!1}var O=u.get(e),L=u.get(t);if(O&&L)return O==t&&L==e;var R=!0;u.set(e,t),u.set(t,e);for(var N=d;++C<v;){k=i[C];var V=e[k],G=t[k];if(n)var U=d?n(G,V,k,t,e,u):n(V,G,k,e,t,u);if(!(U===void 0?V===G||o(V,G,r,n,u):U)){R=!1;break}N||(N=k=="constructor")}if(R&&!N){var J=e.constructor,Z=t.constructor;J!=Z&&"constructor"in e&&"constructor"in t&&!(typeof J=="function"&&J instanceof J&&typeof Z=="function"&&Z instanceof Z)&&(R=!1)}return u.delete(e),u.delete(t),R}var $Me=UMe,VMe=$0,WMe=Rh,GMe=VMe(WMe,"DataView"),HMe=GMe,qMe=$0,XMe=Rh,ZMe=qMe(XMe,"Promise"),YMe=ZMe,KMe=$0,JMe=Rh,QMe=KMe(JMe,"Set"),oJ=QMe,eRe=$0,tRe=Rh,rRe=eRe(tRe,"WeakMap"),nRe=rRe,B3=HMe,z3=mL,j3=YMe,U3=oJ,$3=nRe,sJ=Vf,Cv=dK,u$="[object Map]",iRe="[object Object]",h$="[object Promise]",f$="[object Set]",d$="[object WeakMap]",p$="[object DataView]",aRe=Cv(B3),oRe=Cv(z3),sRe=Cv(j3),lRe=Cv(U3),cRe=Cv($3),Bm=sJ;(B3&&Bm(new B3(new ArrayBuffer(1)))!=p$||z3&&Bm(new z3)!=u$||j3&&Bm(j3.resolve())!=h$||U3&&Bm(new U3)!=f$||$3&&Bm(new $3)!=d$)&&(Bm=function(e){var t=sJ(e),r=t==iRe?e.constructor:void 0,n=r?Cv(r):"";if(n)switch(n){case aRe:return p$;case oRe:return u$;case sRe:return h$;case lRe:return f$;case cRe:return d$}return t});var uRe=Bm,PM=ZK,hRe=QK,fRe=Vke,dRe=$Me,m$=uRe,g$=vl,_$=rJ,pRe=iJ,mRe=1,y$="[object Arguments]",v$="[object Array]",sE="[object Object]",gRe=Object.prototype,x$=gRe.hasOwnProperty;function _Re(e,t,r,n,o,u){var d=g$(e),i=g$(t),v=d?v$:m$(e),w=i?v$:m$(t);v=v==y$?sE:v,w=w==y$?sE:w;var S=v==sE,C=w==sE,k=v==w;if(k&&_$(e)){if(!_$(t))return!1;d=!0,S=!1}if(k&&!S)return u||(u=new PM),d||pRe(e)?hRe(e,t,r,n,o,u):fRe(e,t,v,r,n,o,u);if(!(r&mRe)){var O=S&&x$.call(e,"__wrapped__"),L=C&&x$.call(t,"__wrapped__");if(O||L){var R=O?e.value():e,N=L?t.value():t;return u||(u=new PM),o(R,N,r,n,u)}}return k?(u||(u=new PM),dRe(e,t,r,n,o,u)):!1}var yRe=_Re,vRe=yRe,w$=Wf;function lJ(e,t,r,n,o){return e===t?!0:e==null||t==null||!w$(e)&&!w$(t)?e!==e&&t!==t:vRe(e,t,r,n,lJ,o)}var RL=lJ,xRe=ZK,wRe=RL,bRe=1,TRe=2;function SRe(e,t,r,n){var o=r.length,u=o,d=!n;if(e==null)return!u;for(e=Object(e);o--;){var i=r[o];if(d&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++o<u;){i=r[o];var v=i[0],w=e[v],S=i[1];if(d&&i[2]){if(w===void 0&&!(v in e))return!1}else{var C=new xRe;if(n)var k=n(w,S,v,e,t,C);if(!(k===void 0?wRe(S,w,bRe|TRe,n,C):k))return!1}}return!0}var ERe=SRe,ARe=Bp;function CRe(e){return e===e&&!ARe(e)}var cJ=CRe,PRe=cJ,IRe=HP;function kRe(e){for(var t=IRe(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,PRe(o)]}return t}var ORe=kRe;function MRe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var uJ=MRe,RRe=ERe,DRe=ORe,FRe=uJ;function LRe(e){var t=DRe(e);return t.length==1&&t[0][2]?FRe(t[0][0],t[0][1]):function(r){return r===e||RRe(r,e,t)}}var NRe=LRe;function BRe(e,t){return e!=null&&t in Object(e)}var zRe=BRe,jRe=yK,URe=kL,$Re=vl,VRe=OL,WRe=ML,GRe=OP;function HRe(e,t,r){t=jRe(t,e);for(var n=-1,o=t.length,u=!1;++n<o;){var d=GRe(t[n]);if(!(u=e!=null&&r(e,d)))break;e=e[d]}return u||++n!=o?u:(o=e==null?0:e.length,!!o&&WRe(o)&&VRe(d,o)&&($Re(e)||URe(e)))}var qRe=HRe,XRe=zRe,ZRe=qRe;function YRe(e,t){return e!=null&&ZRe(e,t,XRe)}var KRe=YRe,JRe=RL,QRe=vK,e3e=KRe,t3e=fL,r3e=cJ,n3e=uJ,i3e=OP,a3e=1,o3e=2;function s3e(e,t){return t3e(e)&&r3e(t)?n3e(i3e(e),t):function(r){var n=QRe(r,e);return n===void 0&&n===t?e3e(r,e):JRe(t,n,a3e|o3e)}}var l3e=s3e;function c3e(e){return e}var Pv=c3e;function u3e(e){return function(t){return t==null?void 0:t[e]}}var h3e=u3e,f3e=vL;function d3e(e){return function(t){return f3e(t,e)}}var p3e=d3e,m3e=h3e,g3e=p3e,_3e=fL,y3e=OP;function v3e(e){return _3e(e)?m3e(y3e(e)):g3e(e)}var x3e=v3e,w3e=NRe,b3e=l3e,T3e=Pv,S3e=vl,E3e=x3e;function A3e(e){return typeof e=="function"?e:e==null?T3e:typeof e=="object"?S3e(e)?b3e(e[0],e[1]):w3e(e):E3e(e)}var zp=A3e;function C3e(e,t,r,n){for(var o=e.length,u=r+(n?1:-1);n?u--:++u<o;)if(t(e[u],u,e))return u;return-1}var hJ=C3e;function P3e(e){return e!==e}var I3e=P3e;function k3e(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var O3e=k3e,M3e=hJ,R3e=I3e,D3e=O3e;function F3e(e,t,r){return t===t?D3e(e,t,r):M3e(e,R3e,r)}var L3e=F3e,N3e=L3e;function B3e(e,t){var r=e==null?0:e.length;return!!r&&N3e(e,t,0)>-1}var z3e=B3e;function j3e(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var U3e=j3e;function $3e(){}var V3e=$3e,IM=oJ,W3e=V3e,G3e=IL,H3e=1/0,q3e=IM&&1/G3e(new IM([,-0]))[1]==H3e?function(e){return new IM(e)}:W3e,X3e=q3e,Z3e=YK,Y3e=z3e,K3e=U3e,J3e=JK,Q3e=X3e,eDe=IL,tDe=200;function rDe(e,t,r){var n=-1,o=Y3e,u=e.length,d=!0,i=[],v=i;if(r)d=!1,o=K3e;else if(u>=tDe){var w=t?null:Q3e(e);if(w)return eDe(w);d=!1,o=J3e,v=new Z3e}else v=t?[]:i;e:for(;++n<u;){var S=e[n],C=t?t(S):S;if(S=r||S!==0?S:0,d&&C===C){for(var k=v.length;k--;)if(v[k]===C)continue e;t&&v.push(C),i.push(S)}else o(v,C,r)||(v!==i&&v.push(C),i.push(S))}return i}var nDe=rDe,iDe=zp,aDe=nDe;function oDe(e,t){return e&&e.length?aDe(e,iDe(t)):[]}var sDe=oDe;const b$=Qi(sDe);function fJ(e,t,r){return t===!0?b$(e,r):ai(t)?b$(e,t):e}function Wy(e){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}var lDe=["ref"];function T$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T$(Object(r),!0).forEach(function(n){qP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pJ(n.key),n)}}function uDe(e,t,r){return t&&S$(e.prototype,t),r&&S$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hDe(e,t,r){return t=GA(t),fDe(e,dJ()?Reflect.construct(t,r||[],GA(e).constructor):t.apply(e,r))}function fDe(e,t){if(t&&(Wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dDe(e)}function dDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dJ=function(){return!!e})()}function GA(e){return GA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GA(e)}function pDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V3(e,t)}function V3(e,t){return V3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V3(e,t)}function qP(e,t,r){return t=pJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pJ(e){var t=mDe(e,"string");return Wy(t)=="symbol"?t:t+""}function mDe(e,t){if(Wy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gDe(e,t){if(e==null)return{};var r=_De(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _De(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yDe(e){return e.value}function vDe(e,t){if(it.isValidElement(e))return it.cloneElement(e,t);if(typeof e=="function")return it.createElement(e,t);t.ref;var r=gDe(t,lDe);return it.createElement(PL,r)}var E$=1,_p=function(e){function t(){var r;cDe(this,t);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return r=hDe(this,t,[].concat(o)),qP(r,"lastBoundingBox",{width:-1,height:-1}),r}return pDe(t,e),uDe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>E$||Math.abs(o.height-this.lastBoundingBox.height)>E$)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,n&&n(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?uf({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var o=this.props,u=o.layout,d=o.align,i=o.verticalAlign,v=o.margin,w=o.chartWidth,S=o.chartHeight,C,k;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(d==="center"&&u==="vertical"){var O=this.getBBoxSnapshot();C={left:((w||0)-O.width)/2}}else C=d==="right"?{right:v&&v.right||0}:{left:v&&v.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var L=this.getBBoxSnapshot();k={top:((S||0)-L.height)/2}}else k=i==="bottom"?{bottom:v&&v.bottom||0}:{top:v&&v.top||0};return uf(uf({},C),k)}},{key:"render",value:function(){var n=this,o=this.props,u=o.content,d=o.width,i=o.height,v=o.wrapperStyle,w=o.payloadUniqBy,S=o.payload,C=uf(uf({position:"absolute",width:d||"auto",height:i||"auto"},this.getDefaultPosition(v)),v);return it.createElement("div",{className:"recharts-legend-wrapper",style:C,ref:function(O){n.wrapperNode=O}},vDe(u,uf(uf({},this.props),{},{payload:fJ(S,w,yDe)})))}}],[{key:"getWithHeight",value:function(n,o){var u=uf(uf({},this.defaultProps),n.props),d=u.layout;return d==="vertical"&&Ur(n.props.height)?{height:n.props.height}:d==="horizontal"?{width:n.props.width||o}:null}}])}(ue.PureComponent);qP(_p,"displayName","Legend");qP(_p,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var A$=x2,xDe=kL,wDe=vl,C$=A$?A$.isConcatSpreadable:void 0;function bDe(e){return wDe(e)||xDe(e)||!!(C$&&e&&e[C$])}var TDe=bDe,SDe=eJ,EDe=TDe;function mJ(e,t,r,n,o){var u=-1,d=e.length;for(r||(r=EDe),o||(o=[]);++u<d;){var i=e[u];t>0&&r(i)?t>1?mJ(i,t-1,r,n,o):SDe(o,i):n||(o[o.length]=i)}return o}var gJ=mJ;function ADe(e){return function(t,r,n){for(var o=-1,u=Object(t),d=n(t),i=d.length;i--;){var v=d[e?i:++o];if(r(u[v],v,u)===!1)break}return t}}var CDe=ADe,PDe=CDe,IDe=PDe(),kDe=IDe,ODe=kDe,MDe=HP;function RDe(e,t){return e&&ODe(e,t,MDe)}var _J=RDe,DDe=T2;function FDe(e,t){return function(r,n){if(r==null)return r;if(!DDe(r))return e(r,n);for(var o=r.length,u=t?o:-1,d=Object(r);(t?u--:++u<o)&&n(d[u],u,d)!==!1;);return r}}var LDe=FDe,NDe=_J,BDe=LDe,zDe=BDe(NDe),DL=zDe,jDe=DL,UDe=T2;function $De(e,t){var r=-1,n=UDe(e)?Array(e.length):[];return jDe(e,function(o,u,d){n[++r]=t(o,u,d)}),n}var yJ=$De;function VDe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var WDe=VDe,P$=wv;function GDe(e,t){if(e!==t){var r=e!==void 0,n=e===null,o=e===e,u=P$(e),d=t!==void 0,i=t===null,v=t===t,w=P$(t);if(!i&&!w&&!u&&e>t||u&&d&&v&&!i&&!w||n&&d&&v||!r&&v||!o)return 1;if(!n&&!u&&!w&&e<t||w&&r&&o&&!n&&!u||i&&r&&o||!d&&o||!v)return-1}return 0}var HDe=GDe,qDe=HDe;function XDe(e,t,r){for(var n=-1,o=e.criteria,u=t.criteria,d=o.length,i=r.length;++n<d;){var v=qDe(o[n],u[n]);if(v){if(n>=i)return v;var w=r[n];return v*(w=="desc"?-1:1)}}return e.index-t.index}var ZDe=XDe,kM=yL,YDe=vL,KDe=zp,JDe=yJ,QDe=WDe,eFe=nJ,tFe=ZDe,rFe=Pv,nFe=vl;function iFe(e,t,r){t.length?t=kM(t,function(u){return nFe(u)?function(d){return YDe(d,u.length===1?u[0]:u)}:u}):t=[rFe];var n=-1;t=kM(t,eFe(KDe));var o=JDe(e,function(u,d,i){var v=kM(t,function(w){return w(u)});return{criteria:v,index:++n,value:u}});return QDe(o,function(u,d){return tFe(u,d,r)})}var aFe=iFe;function oFe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var sFe=oFe,lFe=sFe,I$=Math.max;function cFe(e,t,r){return t=I$(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,u=I$(n.length-t,0),d=Array(u);++o<u;)d[o]=n[t+o];o=-1;for(var i=Array(t+1);++o<t;)i[o]=n[o];return i[t]=r(d),lFe(e,this,i)}}var uFe=cFe;function hFe(e){return function(){return e}}var fFe=hFe,dFe=$0,pFe=function(){try{var e=dFe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),vJ=pFe,mFe=fFe,k$=vJ,gFe=Pv,_Fe=k$?function(e,t){return k$(e,"toString",{configurable:!0,enumerable:!1,value:mFe(t),writable:!0})}:gFe,yFe=_Fe,vFe=800,xFe=16,wFe=Date.now;function bFe(e){var t=0,r=0;return function(){var n=wFe(),o=xFe-(n-r);if(r=n,o>0){if(++t>=vFe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var TFe=bFe,SFe=yFe,EFe=TFe,AFe=EFe(SFe),CFe=AFe,PFe=Pv,IFe=uFe,kFe=CFe;function OFe(e,t){return kFe(IFe(e,t,PFe),e+"")}var MFe=OFe,RFe=pL,DFe=T2,FFe=OL,LFe=Bp;function NFe(e,t,r){if(!LFe(r))return!1;var n=typeof t;return(n=="number"?DFe(r)&&FFe(t,r.length):n=="string"&&t in r)?RFe(r[t],e):!1}var XP=NFe,BFe=gJ,zFe=aFe,jFe=MFe,O$=XP,UFe=jFe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&O$(e,t[0],t[1])?t=[]:r>2&&O$(t[0],t[1],t[2])&&(t=[t[0]]),zFe(e,BFe(t,1),[])}),$Fe=UFe;const FL=Qi($Fe);function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function W3(){return W3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W3.apply(this,arguments)}function VFe(e,t){return qFe(e)||HFe(e,t)||GFe(e,t)||WFe()}function WFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(e,t){if(e){if(typeof e=="string")return M$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M$(e,t)}}function M$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function qFe(e){if(Array.isArray(e))return e}function R$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function OM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R$(Object(r),!0).forEach(function(n){XFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XFe(e,t,r){return t=ZFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZFe(e){var t=YFe(e,"string");return pb(t)=="symbol"?t:t+""}function YFe(e,t){if(pb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KFe(e){return Array.isArray(e)&&Fo(e[0])&&Fo(e[1])?e.join(" ~ "):e}var JFe=function(t){var r=t.separator,n=r===void 0?" : ":r,o=t.contentStyle,u=o===void 0?{}:o,d=t.itemStyle,i=d===void 0?{}:d,v=t.labelStyle,w=v===void 0?{}:v,S=t.payload,C=t.formatter,k=t.itemSorter,O=t.wrapperClassName,L=t.labelClassName,R=t.label,N=t.labelFormatter,V=t.accessibilityLayer,G=V===void 0?!1:V,U=function(){if(S&&S.length){var ke={padding:0,margin:0},tt=(k?FL(S,k):S).map(function(Je,et){if(Je.type==="none")return null;var at=OM({display:"block",paddingTop:4,paddingBottom:4,color:Je.color||"#000"},i),pt=Je.formatter||C||KFe,ft=Je.value,Ue=Je.name,It=ft,Rt=Ue;if(pt&&It!=null&&Rt!=null){var _e=pt(ft,Ue,Je,et,S);if(Array.isArray(_e)){var Ge=VFe(_e,2);It=Ge[0],Rt=Ge[1]}else It=_e}return it.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(et),style:at},Fo(Rt)?it.createElement("span",{className:"recharts-tooltip-item-name"},Rt):null,Fo(Rt)?it.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,it.createElement("span",{className:"recharts-tooltip-item-value"},It),it.createElement("span",{className:"recharts-tooltip-item-unit"},Je.unit||""))});return it.createElement("ul",{className:"recharts-tooltip-item-list",style:ke},tt)}return null},J=OM({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},u),Z=OM({margin:0},w),K=!gi(R),re=K?R:"",ge=Ai("recharts-default-tooltip",O),ve=Ai("recharts-tooltip-label",L);K&&N&&S!==void 0&&S!==null&&(re=N(R,S));var $e=G?{role:"status","aria-live":"assertive"}:{};return it.createElement("div",W3({className:ge,style:J},$e),it.createElement("p",{className:ve,style:Z},it.isValidElement(re)?re:"".concat(re)),U())};function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function lE(e,t,r){return t=QFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QFe(e){var t=e4e(e,"string");return mb(t)=="symbol"?t:t+""}function e4e(e,t){if(mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j1="recharts-tooltip-wrapper",t4e={visibility:"hidden"};function r4e(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Ai(j1,lE(lE(lE(lE({},"".concat(j1,"-right"),Ur(r)&&t&&Ur(t.x)&&r>=t.x),"".concat(j1,"-left"),Ur(r)&&t&&Ur(t.x)&&r<t.x),"".concat(j1,"-bottom"),Ur(n)&&t&&Ur(t.y)&&n>=t.y),"".concat(j1,"-top"),Ur(n)&&t&&Ur(t.y)&&n<t.y))}function D$(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,o=e.offsetTopLeft,u=e.position,d=e.reverseDirection,i=e.tooltipDimension,v=e.viewBox,w=e.viewBoxDimension;if(u&&Ur(u[n]))return u[n];var S=r[n]-i-o,C=r[n]+o;if(t[n])return d[n]?S:C;if(d[n]){var k=S,O=v[n];return k<O?Math.max(C,v[n]):Math.max(S,v[n])}var L=C+i,R=v[n]+w;return L>R?Math.max(S,v[n]):Math.max(C,v[n])}function n4e(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function i4e(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,o=e.position,u=e.reverseDirection,d=e.tooltipBox,i=e.useTranslate3d,v=e.viewBox,w,S,C;return d.height>0&&d.width>0&&r?(S=D$({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:u,tooltipDimension:d.width,viewBox:v,viewBoxDimension:v.width}),C=D$({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:u,tooltipDimension:d.height,viewBox:v,viewBoxDimension:v.height}),w=n4e({translateX:S,translateY:C,useTranslate3d:i})):w=t4e,{cssProperties:w,cssClasses:r4e({translateX:S,translateY:C,coordinate:r})}}function Gy(e){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gy(e)}function F$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function L$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F$(Object(r),!0).forEach(function(n){H3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wJ(n.key),n)}}function s4e(e,t,r){return t&&o4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function l4e(e,t,r){return t=HA(t),c4e(e,xJ()?Reflect.construct(t,r||[],HA(e).constructor):t.apply(e,r))}function c4e(e,t){if(t&&(Gy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u4e(e)}function u4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xJ=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},HA(e)}function h4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G3(e,t)}function G3(e,t){return G3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G3(e,t)}function H3(e,t,r){return t=wJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wJ(e){var t=f4e(e,"string");return Gy(t)=="symbol"?t:t+""}function f4e(e,t){if(Gy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N$=1,d4e=function(e){function t(){var r;a4e(this,t);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return r=l4e(this,t,[].concat(o)),H3(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),H3(r,"handleKeyDown",function(d){if(d.key==="Escape"){var i,v,w,S;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(v=r.props.coordinate)===null||v===void 0?void 0:v.x)!==null&&i!==void 0?i:0,y:(w=(S=r.props.coordinate)===null||S===void 0?void 0:S.y)!==null&&w!==void 0?w:0}})}}),r}return h4e(t,e),s4e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>N$||Math.abs(n.height-this.state.lastBoundingBox.height)>N$)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,o=this.props,u=o.active,d=o.allowEscapeViewBox,i=o.animationDuration,v=o.animationEasing,w=o.children,S=o.coordinate,C=o.hasPayload,k=o.isAnimationActive,O=o.offset,L=o.position,R=o.reverseDirection,N=o.useTranslate3d,V=o.viewBox,G=o.wrapperStyle,U=i4e({allowEscapeViewBox:d,coordinate:S,offsetTopLeft:O,position:L,reverseDirection:R,tooltipBox:this.state.lastBoundingBox,useTranslate3d:N,viewBox:V}),J=U.cssClasses,Z=U.cssProperties,K=L$(L$({transition:k&&u?"transform ".concat(i,"ms ").concat(v):void 0},Z),{},{pointerEvents:"none",visibility:!this.state.dismissed&&u&&C?"visible":"hidden",position:"absolute",top:0,left:0},G);return it.createElement("div",{tabIndex:-1,className:J,style:K,ref:function(ge){n.wrapperNode=ge}},w)}}])}(ue.PureComponent),p4e=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Cf={isSsr:p4e(),get:function(t){return Cf[t]},set:function(t,r){if(typeof t=="string")Cf[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(o){Cf[o]=t[o]})}}};function Hy(e){"@babel/helpers - typeof";return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hy(e)}function B$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function z$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B$(Object(r),!0).forEach(function(n){LL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TJ(n.key),n)}}function _4e(e,t,r){return t&&g4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function y4e(e,t,r){return t=qA(t),v4e(e,bJ()?Reflect.construct(t,r||[],qA(e).constructor):t.apply(e,r))}function v4e(e,t){if(t&&(Hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x4e(e)}function x4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bJ=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qA(e)}function w4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q3(e,t)}function q3(e,t){return q3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},q3(e,t)}function LL(e,t,r){return t=TJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TJ(e){var t=b4e(e,"string");return Hy(t)=="symbol"?t:t+""}function b4e(e,t){if(Hy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T4e(e){return e.dataKey}function S4e(e,t){return it.isValidElement(e)?it.cloneElement(e,t):typeof e=="function"?it.createElement(e,t):it.createElement(JFe,t)}var bc=function(e){function t(){return m4e(this,t),y4e(this,t,arguments)}return w4e(t,e),_4e(t,[{key:"render",value:function(){var n=this,o=this.props,u=o.active,d=o.allowEscapeViewBox,i=o.animationDuration,v=o.animationEasing,w=o.content,S=o.coordinate,C=o.filterNull,k=o.isAnimationActive,O=o.offset,L=o.payload,R=o.payloadUniqBy,N=o.position,V=o.reverseDirection,G=o.useTranslate3d,U=o.viewBox,J=o.wrapperStyle,Z=L??[];C&&Z.length&&(Z=fJ(L.filter(function(re){return re.value!=null&&(re.hide!==!0||n.props.includeHidden)}),R,T4e));var K=Z.length>0;return it.createElement(d4e,{allowEscapeViewBox:d,animationDuration:i,animationEasing:v,isAnimationActive:k,active:u,coordinate:S,hasPayload:K,offset:O,position:N,reverseDirection:V,useTranslate3d:G,viewBox:U,wrapperStyle:J},S4e(w,z$(z$({},this.props),{},{payload:Z})))}}])}(ue.PureComponent);LL(bc,"displayName","Tooltip");LL(bc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Cf.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var E4e=Rh,A4e=function(){return E4e.Date.now()},C4e=A4e,P4e=/\s/;function I4e(e){for(var t=e.length;t--&&P4e.test(e.charAt(t)););return t}var k4e=I4e,O4e=k4e,M4e=/^\s+/;function R4e(e){return e&&e.slice(0,O4e(e)+1).replace(M4e,"")}var D4e=R4e,F4e=D4e,j$=Bp,L4e=wv,U$=NaN,N4e=/^[-+]0x[0-9a-f]+$/i,B4e=/^0b[01]+$/i,z4e=/^0o[0-7]+$/i,j4e=parseInt;function U4e(e){if(typeof e=="number")return e;if(L4e(e))return U$;if(j$(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=j$(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=F4e(e);var r=B4e.test(e);return r||z4e.test(e)?j4e(e.slice(2),r?2:8):N4e.test(e)?U$:+e}var SJ=U4e,$4e=Bp,MM=C4e,$$=SJ,V4e="Expected a function",W4e=Math.max,G4e=Math.min;function H4e(e,t,r){var n,o,u,d,i,v,w=0,S=!1,C=!1,k=!0;if(typeof e!="function")throw new TypeError(V4e);t=$$(t)||0,$4e(r)&&(S=!!r.leading,C="maxWait"in r,u=C?W4e($$(r.maxWait)||0,t):u,k="trailing"in r?!!r.trailing:k);function O(K){var re=n,ge=o;return n=o=void 0,w=K,d=e.apply(ge,re),d}function L(K){return w=K,i=setTimeout(V,t),S?O(K):d}function R(K){var re=K-v,ge=K-w,ve=t-re;return C?G4e(ve,u-ge):ve}function N(K){var re=K-v,ge=K-w;return v===void 0||re>=t||re<0||C&&ge>=u}function V(){var K=MM();if(N(K))return G(K);i=setTimeout(V,R(K))}function G(K){return i=void 0,k&&n?O(K):(n=o=void 0,d)}function U(){i!==void 0&&clearTimeout(i),w=0,n=v=o=i=void 0}function J(){return i===void 0?d:G(MM())}function Z(){var K=MM(),re=N(K);if(n=arguments,o=this,v=K,re){if(i===void 0)return L(v);if(C)return clearTimeout(i),i=setTimeout(V,t),O(v)}return i===void 0&&(i=setTimeout(V,t)),d}return Z.cancel=U,Z.flush=J,Z}var q4e=H4e,X4e=q4e,Z4e=Bp,Y4e="Expected a function";function K4e(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(Y4e);return Z4e(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),X4e(e,t,{leading:n,maxWait:t,trailing:o})}var J4e=K4e;const EJ=Qi(J4e);function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function V$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V$(Object(r),!0).forEach(function(n){Q4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q4e(e,t,r){return t=eLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eLe(e){var t=tLe(e,"string");return gb(t)=="symbol"?t:t+""}function tLe(e,t){if(gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rLe(e,t){return oLe(e)||aLe(e,t)||iLe(e,t)||nLe()}function nLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iLe(e,t){if(e){if(typeof e=="string")return W$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W$(e,t)}}function W$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function oLe(e){if(Array.isArray(e))return e}var RM=ue.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,o=n===void 0?{width:-1,height:-1}:n,u=e.width,d=u===void 0?"100%":u,i=e.height,v=i===void 0?"100%":i,w=e.minWidth,S=w===void 0?0:w,C=e.minHeight,k=e.maxHeight,O=e.children,L=e.debounce,R=L===void 0?0:L,N=e.id,V=e.className,G=e.onResize,U=e.style,J=U===void 0?{}:U,Z=ue.useRef(null),K=ue.useRef();K.current=G,ue.useImperativeHandle(t,function(){return Object.defineProperty(Z.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),Z.current},configurable:!0})});var re=ue.useState({containerWidth:o.width,containerHeight:o.height}),ge=rLe(re,2),ve=ge[0],$e=ge[1],Ie=ue.useCallback(function(tt,Je){$e(function(et){var at=Math.round(tt),pt=Math.round(Je);return et.containerWidth===at&&et.containerHeight===pt?et:{containerWidth:at,containerHeight:pt}})},[]);ue.useEffect(function(){var tt=function(Ue){var It,Rt=Ue[0].contentRect,_e=Rt.width,Ge=Rt.height;Ie(_e,Ge),(It=K.current)===null||It===void 0||It.call(K,_e,Ge)};R>0&&(tt=EJ(tt,R,{trailing:!0,leading:!1}));var Je=new ResizeObserver(tt),et=Z.current.getBoundingClientRect(),at=et.width,pt=et.height;return Ie(at,pt),Je.observe(Z.current),function(){Je.disconnect()}},[Ie,R]);var ke=ue.useMemo(function(){var tt=ve.containerWidth,Je=ve.containerHeight;if(tt<0||Je<0)return null;Af(Gm(d)||Gm(v),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,v),Af(!r||r>0,"The aspect(%s) must be greater than zero.",r);var et=Gm(d)?tt:d,at=Gm(v)?Je:v;r&&r>0&&(et?at=et/r:at&&(et=at*r),k&&at>k&&(at=k)),Af(et>0||at>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,et,at,d,v,S,C,r);var pt=!Array.isArray(O)&&Ef(O.type).endsWith("Chart");return it.Children.map(O,function(ft){return it.isValidElement(ft)?ue.cloneElement(ft,cE({width:et,height:at},pt?{style:cE({height:"100%",width:"100%",maxHeight:at,maxWidth:et},ft.props.style)}:{})):ft})},[r,O,v,k,C,S,ve,d]);return it.createElement("div",{id:N?"".concat(N):void 0,className:Ai("recharts-responsive-container",V),style:cE(cE({},J),{},{width:d,height:v,minWidth:S,minHeight:C,maxHeight:k}),ref:Z},ke)}),AJ=function(t){return null};AJ.displayName="Cell";function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function G$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function X3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G$(Object(r),!0).forEach(function(n){sLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sLe(e,t,r){return t=lLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lLe(e){var t=cLe(e,"string");return _b(t)=="symbol"?t:t+""}function cLe(e,t){if(_b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_b(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I_={widthCache:{},cacheCount:0},uLe=2e3,hLe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},H$="recharts_measurement_span";function fLe(e){var t=X3({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Aw=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Cf.isSsr)return{width:0,height:0};var n=fLe(r),o=JSON.stringify({text:t,copyStyle:n});if(I_.widthCache[o])return I_.widthCache[o];try{var u=document.getElementById(H$);u||(u=document.createElement("span"),u.setAttribute("id",H$),u.setAttribute("aria-hidden","true"),document.body.appendChild(u));var d=X3(X3({},hLe),n);Object.assign(u.style,d),u.textContent="".concat(t);var i=u.getBoundingClientRect(),v={width:i.width,height:i.height};return I_.widthCache[o]=v,++I_.cacheCount>uLe&&(I_.cacheCount=0,I_.widthCache={}),v}catch{return{width:0,height:0}}},dLe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function XA(e,t){return _Le(e)||gLe(e,t)||mLe(e,t)||pLe()}function pLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mLe(e,t){if(e){if(typeof e=="string")return q$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q$(e,t)}}function q$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;v=!1}else for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function _Le(e){if(Array.isArray(e))return e}function yLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xLe(n.key),n)}}function vLe(e,t,r){return t&&X$(e.prototype,t),r&&X$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xLe(e){var t=wLe(e,"string");return yb(t)=="symbol"?t:t+""}function wLe(e,t){if(yb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Z$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Y$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,bLe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,TLe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},SLe=Object.keys(CJ),Q_="NaN";function ELe(e,t){return e*CJ[t]}var uE=function(){function e(t,r){yLe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!bLe.test(r)&&(this.num=NaN,this.unit=""),SLe.includes(r)&&(this.num=ELe(t,r),this.unit="px")}return vLe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,o=(n=TLe.exec(r))!==null&&n!==void 0?n:[],u=XA(o,3),d=u[1],i=u[2];return new e(parseFloat(d),i??"")}}])}();function PJ(e){if(e.includes(Q_))return Q_;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=Z$.exec(t))!==null&&r!==void 0?r:[],o=XA(n,4),u=o[1],d=o[2],i=o[3],v=uE.parse(u??""),w=uE.parse(i??""),S=d==="*"?v.multiply(w):v.divide(w);if(S.isNaN())return Q_;t=t.replace(Z$,S.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var C,k=(C=Y$.exec(t))!==null&&C!==void 0?C:[],O=XA(k,4),L=O[1],R=O[2],N=O[3],V=uE.parse(L??""),G=uE.parse(N??""),U=R==="+"?V.add(G):V.subtract(G);if(U.isNaN())return Q_;t=t.replace(Y$,U.toString())}return t}var K$=/\(([^()]*)\)/;function ALe(e){for(var t=e;t.includes("(");){var r=K$.exec(t),n=XA(r,2),o=n[1];t=t.replace(K$,PJ(o))}return t}function CLe(e){var t=e.replace(/\s+/g,"");return t=ALe(t),t=PJ(t),t}function PLe(e){try{return CLe(e)}catch{return Q_}}function DM(e){var t=PLe(e.slice(5,-1));return t===Q_?"":t}var ILe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],kLe=["dx","dy","angle","className","breakAll"];function Z3(){return Z3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z3.apply(this,arguments)}function J$(e,t){if(e==null)return{};var r=OLe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Q$(e,t){return FLe(e)||DLe(e,t)||RLe(e,t)||MLe()}function MLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RLe(e,t){if(e){if(typeof e=="string")return eV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eV(e,t)}}function eV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;v=!1}else for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function FLe(e){if(Array.isArray(e))return e}var IJ=/[ \f\n\r\t\v\u2028\u2029]+/,kJ=function(t){var r=t.children,n=t.breakAll,o=t.style;try{var u=[];gi(r)||(n?u=r.toString().split(""):u=r.toString().split(IJ));var d=u.map(function(v){return{word:v,width:Aw(v,o).width}}),i=n?0:Aw("",o).width;return{wordsWithComputedWidth:d,spaceWidth:i}}catch{return null}},LLe=function(t,r,n,o,u){var d=t.maxLines,i=t.children,v=t.style,w=t.breakAll,S=Ur(d),C=i,k=function(){var et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return et.reduce(function(at,pt){var ft=pt.word,Ue=pt.width,It=at[at.length-1];if(It&&(o==null||u||It.width+Ue+n<Number(o)))It.words.push(ft),It.width+=Ue+n;else{var Rt={words:[ft],width:Ue};at.push(Rt)}return at},[])},O=k(r),L=function(et){return et.reduce(function(at,pt){return at.width>pt.width?at:pt})};if(!S)return O;for(var R="",N=function(et){var at=C.slice(0,et),pt=kJ({breakAll:w,style:v,children:at+R}).wordsWithComputedWidth,ft=k(pt),Ue=ft.length>d||L(ft).width>Number(o);return[Ue,ft]},V=0,G=C.length-1,U=0,J;V<=G&&U<=C.length-1;){var Z=Math.floor((V+G)/2),K=Z-1,re=N(K),ge=Q$(re,2),ve=ge[0],$e=ge[1],Ie=N(Z),ke=Q$(Ie,1),tt=ke[0];if(!ve&&!tt&&(V=Z+1),ve&&tt&&(G=Z-1),!ve&&tt){J=$e;break}U++}return J||O},tV=function(t){var r=gi(t)?[]:t.toString().split(IJ);return[{words:r}]},NLe=function(t){var r=t.width,n=t.scaleToFit,o=t.children,u=t.style,d=t.breakAll,i=t.maxLines;if((r||n)&&!Cf.isSsr){var v,w,S=kJ({breakAll:d,children:o,style:u});if(S){var C=S.wordsWithComputedWidth,k=S.spaceWidth;v=C,w=k}else return tV(o);return LLe({breakAll:d,children:o,maxLines:i,style:u},v,w,r,n)}return tV(o)},rV="#808080",ZA=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,u=o===void 0?0:o,d=t.lineHeight,i=d===void 0?"1em":d,v=t.capHeight,w=v===void 0?"0.71em":v,S=t.scaleToFit,C=S===void 0?!1:S,k=t.textAnchor,O=k===void 0?"start":k,L=t.verticalAnchor,R=L===void 0?"end":L,N=t.fill,V=N===void 0?rV:N,G=J$(t,ILe),U=ue.useMemo(function(){return NLe({breakAll:G.breakAll,children:G.children,maxLines:G.maxLines,scaleToFit:C,style:G.style,width:G.width})},[G.breakAll,G.children,G.maxLines,C,G.style,G.width]),J=G.dx,Z=G.dy,K=G.angle,re=G.className,ge=G.breakAll,ve=J$(G,kLe);if(!Fo(n)||!Fo(u))return null;var $e=n+(Ur(J)?J:0),Ie=u+(Ur(Z)?Z:0),ke;switch(R){case"start":ke=DM("calc(".concat(w,")"));break;case"middle":ke=DM("calc(".concat((U.length-1)/2," * -").concat(i," + (").concat(w," / 2))"));break;default:ke=DM("calc(".concat(U.length-1," * -").concat(i,")"));break}var tt=[];if(C){var Je=U[0].width,et=G.width;tt.push("scale(".concat((Ur(et)?et/Je:1)/Je,")"))}return K&&tt.push("rotate(".concat(K,", ").concat($e,", ").concat(Ie,")")),tt.length&&(ve.transform=tt.join(" ")),it.createElement("text",Z3({},Ei(ve,!0),{x:$e,y:Ie,className:Ai("recharts-text",re),textAnchor:O,fill:V.includes("url")?rV:V}),U.map(function(at,pt){var ft=at.words.join(ge?"":" ");return it.createElement("tspan",{x:$e,dy:pt===0?ke:i,key:"".concat(ft,"-").concat(pt)},ft)}))};function yp(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function BLe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function NL(e){let t,r,n;e.length!==2?(t=yp,r=(i,v)=>yp(e(i),v),n=(i,v)=>e(i)-v):(t=e===yp||e===BLe?e:zLe,r=e,n=e);function o(i,v,w=0,S=i.length){if(w<S){if(t(v,v)!==0)return S;do{const C=w+S>>>1;r(i[C],v)<0?w=C+1:S=C}while(w<S)}return w}function u(i,v,w=0,S=i.length){if(w<S){if(t(v,v)!==0)return S;do{const C=w+S>>>1;r(i[C],v)<=0?w=C+1:S=C}while(w<S)}return w}function d(i,v,w=0,S=i.length){const C=o(i,v,w,S-1);return C>w&&n(i[C-1],v)>-n(i[C],v)?C-1:C}return{left:o,center:d,right:u}}function zLe(){return 0}function OJ(e){return e===null?NaN:+e}function*jLe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const ULe=NL(yp),S2=ULe.right;NL(OJ).center;class nV extends Map{constructor(t,r=WLe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,o]of t)this.set(n,o)}get(t){return super.get(iV(this,t))}has(t){return super.has(iV(this,t))}set(t,r){return super.set($Le(this,t),r)}delete(t){return super.delete(VLe(this,t))}}function iV({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function $Le({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function VLe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function WLe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function GLe(e=yp){if(e===yp)return MJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function MJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const HLe=Math.sqrt(50),qLe=Math.sqrt(10),XLe=Math.sqrt(2);function YA(e,t,r){const n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),u=n/Math.pow(10,o),d=u>=HLe?10:u>=qLe?5:u>=XLe?2:1;let i,v,w;return o<0?(w=Math.pow(10,-o)/d,i=Math.round(e*w),v=Math.round(t*w),i/w<e&&++i,v/w>t&&--v,w=-w):(w=Math.pow(10,o)*d,i=Math.round(e/w),v=Math.round(t/w),i*w<e&&++i,v*w>t&&--v),v<i&&.5<=r&&r<2?YA(e,t,r*2):[i,v,w]}function Y3(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[o,u,d]=n?YA(t,e,r):YA(e,t,r);if(!(u>=o))return[];const i=u-o+1,v=new Array(i);if(n)if(d<0)for(let w=0;w<i;++w)v[w]=(u-w)/-d;else for(let w=0;w<i;++w)v[w]=(u-w)*d;else if(d<0)for(let w=0;w<i;++w)v[w]=(o+w)/-d;else for(let w=0;w<i;++w)v[w]=(o+w)*d;return v}function K3(e,t,r){return t=+t,e=+e,r=+r,YA(e,t,r)[2]}function J3(e,t,r){t=+t,e=+e,r=+r;const n=t<e,o=n?K3(t,e,r):K3(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}function aV(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function oV(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function RJ(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?MJ:GLe(o);n>r;){if(n-r>600){const v=n-r+1,w=t-r+1,S=Math.log(v),C=.5*Math.exp(2*S/3),k=.5*Math.sqrt(S*C*(v-C)/v)*(w-v/2<0?-1:1),O=Math.max(r,Math.floor(t-w*C/v+k)),L=Math.min(n,Math.floor(t+(v-w)*C/v+k));RJ(e,t,O,L,o)}const u=e[t];let d=r,i=n;for(U1(e,r,t),o(e[n],u)>0&&U1(e,r,n);d<i;){for(U1(e,d,i),++d,--i;o(e[d],u)<0;)++d;for(;o(e[i],u)>0;)--i}o(e[r],u)===0?U1(e,r,i):(++i,U1(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function U1(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function ZLe(e,t,r){if(e=Float64Array.from(jLe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return oV(e);if(t>=1)return aV(e);var n,o=(n-1)*t,u=Math.floor(o),d=aV(RJ(e,u).subarray(0,u+1)),i=oV(e.subarray(u+1));return d+(i-d)*(o-u)}}function YLe(e,t,r=OJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,u=Math.floor(o),d=+r(e[u],u,e),i=+r(e[u+1],u+1,e);return d+(i-d)*(o-u)}}function KLe(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,u=new Array(o);++n<o;)u[n]=e+n*r;return u}function zc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Q3=Symbol("implicit");function BL(){var e=new nV,t=[],r=[],n=Q3;function o(u){let d=e.get(u);if(d===void 0){if(n!==Q3)return n;e.set(u,d=t.push(u)-1)}return r[d%r.length]}return o.domain=function(u){if(!arguments.length)return t.slice();t=[],e=new nV;for(const d of u)e.has(d)||e.set(d,t.push(d)-1);return o},o.range=function(u){return arguments.length?(r=Array.from(u),o):r.slice()},o.unknown=function(u){return arguments.length?(n=u,o):n},o.copy=function(){return BL(t,r).unknown(n)},zc.apply(o,arguments),o}function vb(){var e=BL().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,u,d,i=!1,v=0,w=0,S=.5;delete e.unknown;function C(){var k=t().length,O=o<n,L=O?o:n,R=O?n:o;u=(R-L)/Math.max(1,k-v+w*2),i&&(u=Math.floor(u)),L+=(R-L-u*(k-v))*S,d=u*(1-v),i&&(L=Math.round(L),d=Math.round(d));var N=KLe(k).map(function(V){return L+u*V});return r(O?N.reverse():N)}return e.domain=function(k){return arguments.length?(t(k),C()):t()},e.range=function(k){return arguments.length?([n,o]=k,n=+n,o=+o,C()):[n,o]},e.rangeRound=function(k){return[n,o]=k,n=+n,o=+o,i=!0,C()},e.bandwidth=function(){return d},e.step=function(){return u},e.round=function(k){return arguments.length?(i=!!k,C()):i},e.padding=function(k){return arguments.length?(v=Math.min(1,w=+k),C()):v},e.paddingInner=function(k){return arguments.length?(v=Math.min(1,k),C()):v},e.paddingOuter=function(k){return arguments.length?(w=+k,C()):w},e.align=function(k){return arguments.length?(S=Math.max(0,Math.min(1,k)),C()):S},e.copy=function(){return vb(t(),[n,o]).round(i).paddingInner(v).paddingOuter(w).align(S)},zc.apply(C(),arguments)}function DJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return DJ(t())},e}function Cw(){return DJ(vb.apply(null,arguments).paddingInner(1))}function zL(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function FJ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function E2(){}var xb=.7,KA=1/xb,_y="\\s*([+-]?\\d+)\\s*",wb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JLe=/^#([0-9a-f]{3,8})$/,QLe=new RegExp(`^rgb\\(${_y},${_y},${_y}\\)$`),eNe=new RegExp(`^rgb\\(${bh},${bh},${bh}\\)$`),tNe=new RegExp(`^rgba\\(${_y},${_y},${_y},${wb}\\)$`),rNe=new RegExp(`^rgba\\(${bh},${bh},${bh},${wb}\\)$`),nNe=new RegExp(`^hsl\\(${wb},${bh},${bh}\\)$`),iNe=new RegExp(`^hsla\\(${wb},${bh},${bh},${wb}\\)$`),sV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};zL(E2,bb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lV,formatHex:lV,formatHex8:aNe,formatHsl:oNe,formatRgb:cV,toString:cV});function lV(){return this.rgb().formatHex()}function aNe(){return this.rgb().formatHex8()}function oNe(){return LJ(this).formatHsl()}function cV(){return this.rgb().formatRgb()}function bb(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=JLe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?uV(t):r===3?new hl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?hE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?hE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=QLe.exec(e))?new hl(t[1],t[2],t[3],1):(t=eNe.exec(e))?new hl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=tNe.exec(e))?hE(t[1],t[2],t[3],t[4]):(t=rNe.exec(e))?hE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=nNe.exec(e))?dV(t[1],t[2]/100,t[3]/100,1):(t=iNe.exec(e))?dV(t[1],t[2]/100,t[3]/100,t[4]):sV.hasOwnProperty(e)?uV(sV[e]):e==="transparent"?new hl(NaN,NaN,NaN,0):null}function uV(e){return new hl(e>>16&255,e>>8&255,e&255,1)}function hE(e,t,r,n){return n<=0&&(e=t=r=NaN),new hl(e,t,r,n)}function sNe(e){return e instanceof E2||(e=bb(e)),e?(e=e.rgb(),new hl(e.r,e.g,e.b,e.opacity)):new hl}function eD(e,t,r,n){return arguments.length===1?sNe(e):new hl(e,t,r,n??1)}function hl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}zL(hl,eD,FJ(E2,{brighter(e){return e=e==null?KA:Math.pow(KA,e),new hl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?xb:Math.pow(xb,e),new hl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hl(s0(this.r),s0(this.g),s0(this.b),JA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hV,formatHex:hV,formatHex8:lNe,formatRgb:fV,toString:fV}));function hV(){return`#${Hm(this.r)}${Hm(this.g)}${Hm(this.b)}`}function lNe(){return`#${Hm(this.r)}${Hm(this.g)}${Hm(this.b)}${Hm((isNaN(this.opacity)?1:this.opacity)*255)}`}function fV(){const e=JA(this.opacity);return`${e===1?"rgb(":"rgba("}${s0(this.r)}, ${s0(this.g)}, ${s0(this.b)}${e===1?")":`, ${e})`}`}function JA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function s0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Hm(e){return e=s0(e),(e<16?"0":"")+e.toString(16)}function dV(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new du(e,t,r,n)}function LJ(e){if(e instanceof du)return new du(e.h,e.s,e.l,e.opacity);if(e instanceof E2||(e=bb(e)),!e)return new du;if(e instanceof du)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),u=Math.max(t,r,n),d=NaN,i=u-o,v=(u+o)/2;return i?(t===u?d=(r-n)/i+(r<n)*6:r===u?d=(n-t)/i+2:d=(t-r)/i+4,i/=v<.5?u+o:2-u-o,d*=60):i=v>0&&v<1?0:d,new du(d,i,v,e.opacity)}function cNe(e,t,r,n){return arguments.length===1?LJ(e):new du(e,t,r,n??1)}function du(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}zL(du,cNe,FJ(E2,{brighter(e){return e=e==null?KA:Math.pow(KA,e),new du(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?xb:Math.pow(xb,e),new du(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new hl(FM(e>=240?e-240:e+120,o,n),FM(e,o,n),FM(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new du(pV(this.h),fE(this.s),fE(this.l),JA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=JA(this.opacity);return`${e===1?"hsl(":"hsla("}${pV(this.h)}, ${fE(this.s)*100}%, ${fE(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pV(e){return e=(e||0)%360,e<0?e+360:e}function fE(e){return Math.max(0,Math.min(1,e||0))}function FM(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const jL=e=>()=>e;function uNe(e,t){return function(r){return e+r*t}}function hNe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function fNe(e){return(e=+e)==1?NJ:function(t,r){return r-t?hNe(t,r,e):jL(isNaN(t)?r:t)}}function NJ(e,t){var r=t-e;return r?uNe(e,r):jL(isNaN(e)?t:e)}const mV=function e(t){var r=fNe(t);function n(o,u){var d=r((o=eD(o)).r,(u=eD(u)).r),i=r(o.g,u.g),v=r(o.b,u.b),w=NJ(o.opacity,u.opacity);return function(S){return o.r=d(S),o.g=i(S),o.b=v(S),o.opacity=w(S),o+""}}return n.gamma=e,n}(1);function dNe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(u){for(o=0;o<r;++o)n[o]=e[o]*(1-u)+t[o]*u;return n}}function pNe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function mNe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),u=new Array(r),d;for(d=0;d<n;++d)o[d]=Iv(e[d],t[d]);for(;d<r;++d)u[d]=t[d];return function(i){for(d=0;d<n;++d)u[d]=o[d](i);return u}}function gNe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function QA(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _Ne(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=Iv(e[o],t[o]):n[o]=t[o];return function(u){for(o in r)n[o]=r[o](u);return n}}var tD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LM=new RegExp(tD.source,"g");function yNe(e){return function(){return e}}function vNe(e){return function(t){return e(t)+""}}function xNe(e,t){var r=tD.lastIndex=LM.lastIndex=0,n,o,u,d=-1,i=[],v=[];for(e=e+"",t=t+"";(n=tD.exec(e))&&(o=LM.exec(t));)(u=o.index)>r&&(u=t.slice(r,u),i[d]?i[d]+=u:i[++d]=u),(n=n[0])===(o=o[0])?i[d]?i[d]+=o:i[++d]=o:(i[++d]=null,v.push({i:d,x:QA(n,o)})),r=LM.lastIndex;return r<t.length&&(u=t.slice(r),i[d]?i[d]+=u:i[++d]=u),i.length<2?v[0]?vNe(v[0].x):yNe(t):(t=v.length,function(w){for(var S=0,C;S<t;++S)i[(C=v[S]).i]=C.x(w);return i.join("")})}function Iv(e,t){var r=typeof t,n;return t==null||r==="boolean"?jL(t):(r==="number"?QA:r==="string"?(n=bb(t))?(t=n,mV):xNe:t instanceof bb?mV:t instanceof Date?gNe:pNe(t)?dNe:Array.isArray(t)?mNe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_Ne:QA)(e,t)}function UL(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function wNe(e,t){t===void 0&&(t=e,e=Iv);for(var r=0,n=t.length-1,o=t[0],u=new Array(n<0?0:n);r<n;)u[r]=e(o,o=t[++r]);return function(d){var i=Math.max(0,Math.min(n-1,Math.floor(d*=n)));return u[i](d-i)}}function bNe(e){return function(){return e}}function eC(e){return+e}var gV=[0,1];function Qs(e){return e}function rD(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:bNe(isNaN(t)?NaN:.5)}function TNe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function SNe(e,t,r){var n=e[0],o=e[1],u=t[0],d=t[1];return o<n?(n=rD(o,n),u=r(d,u)):(n=rD(n,o),u=r(u,d)),function(i){return u(n(i))}}function ENe(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),u=new Array(n),d=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<n;)o[d]=rD(e[d],e[d+1]),u[d]=r(t[d],t[d+1]);return function(i){var v=S2(e,i,1,n)-1;return u[v](o[v](i))}}function A2(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ZP(){var e=gV,t=gV,r=Iv,n,o,u,d=Qs,i,v,w;function S(){var k=Math.min(e.length,t.length);return d!==Qs&&(d=TNe(e[0],e[k-1])),i=k>2?ENe:SNe,v=w=null,C}function C(k){return k==null||isNaN(k=+k)?u:(v||(v=i(e.map(n),t,r)))(n(d(k)))}return C.invert=function(k){return d(o((w||(w=i(t,e.map(n),QA)))(k)))},C.domain=function(k){return arguments.length?(e=Array.from(k,eC),S()):e.slice()},C.range=function(k){return arguments.length?(t=Array.from(k),S()):t.slice()},C.rangeRound=function(k){return t=Array.from(k),r=UL,S()},C.clamp=function(k){return arguments.length?(d=k?!0:Qs,S()):d!==Qs},C.interpolate=function(k){return arguments.length?(r=k,S()):r},C.unknown=function(k){return arguments.length?(u=k,C):u},function(k,O){return n=k,o=O,S()}}function $L(){return ZP()(Qs,Qs)}function ANe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tC(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function qy(e){return e=tC(Math.abs(e)),e?e[1]:NaN}function CNe(e,t){return function(r,n){for(var o=r.length,u=[],d=0,i=e[0],v=0;o>0&&i>0&&(v+i+1>n&&(i=Math.max(1,n-v)),u.push(r.substring(o-=i,o+i)),!((v+=i+1)>n));)i=e[d=(d+1)%e.length];return u.reverse().join(t)}}function PNe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var INe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Tb(e){if(!(t=INe.exec(e)))throw new Error("invalid format: "+e);var t;return new VL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Tb.prototype=VL.prototype;function VL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}VL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kNe(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var BJ;function ONe(e,t){var r=tC(e,t);if(!r)return e+"";var n=r[0],o=r[1],u=o-(BJ=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,d=n.length;return u===d?n:u>d?n+new Array(u-d+1).join("0"):u>0?n.slice(0,u)+"."+n.slice(u):"0."+new Array(1-u).join("0")+tC(e,Math.max(0,t+u-1))[0]}function _V(e,t){var r=tC(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}const yV={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ANe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_V(e*100,t),r:_V,s:ONe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vV(e){return e}var xV=Array.prototype.map,wV=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function MNe(e){var t=e.grouping===void 0||e.thousands===void 0?vV:CNe(xV.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",u=e.numerals===void 0?vV:PNe(xV.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",v=e.nan===void 0?"NaN":e.nan+"";function w(C){C=Tb(C);var k=C.fill,O=C.align,L=C.sign,R=C.symbol,N=C.zero,V=C.width,G=C.comma,U=C.precision,J=C.trim,Z=C.type;Z==="n"?(G=!0,Z="g"):yV[Z]||(U===void 0&&(U=12),J=!0,Z="g"),(N||k==="0"&&O==="=")&&(N=!0,k="0",O="=");var K=R==="$"?r:R==="#"&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",re=R==="$"?n:/[%p]/.test(Z)?d:"",ge=yV[Z],ve=/[defgprs%]/.test(Z);U=U===void 0?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,U)):Math.max(0,Math.min(20,U));function $e(Ie){var ke=K,tt=re,Je,et,at;if(Z==="c")tt=ge(Ie)+tt,Ie="";else{Ie=+Ie;var pt=Ie<0||1/Ie<0;if(Ie=isNaN(Ie)?v:ge(Math.abs(Ie),U),J&&(Ie=kNe(Ie)),pt&&+Ie==0&&L!=="+"&&(pt=!1),ke=(pt?L==="("?L:i:L==="-"||L==="("?"":L)+ke,tt=(Z==="s"?wV[8+BJ/3]:"")+tt+(pt&&L==="("?")":""),ve){for(Je=-1,et=Ie.length;++Je<et;)if(at=Ie.charCodeAt(Je),48>at||at>57){tt=(at===46?o+Ie.slice(Je+1):Ie.slice(Je))+tt,Ie=Ie.slice(0,Je);break}}}G&&!N&&(Ie=t(Ie,1/0));var ft=ke.length+Ie.length+tt.length,Ue=ft<V?new Array(V-ft+1).join(k):"";switch(G&&N&&(Ie=t(Ue+Ie,Ue.length?V-tt.length:1/0),Ue=""),O){case"<":Ie=ke+Ie+tt+Ue;break;case"=":Ie=ke+Ue+Ie+tt;break;case"^":Ie=Ue.slice(0,ft=Ue.length>>1)+ke+Ie+tt+Ue.slice(ft);break;default:Ie=Ue+ke+Ie+tt;break}return u(Ie)}return $e.toString=function(){return C+""},$e}function S(C,k){var O=w((C=Tb(C),C.type="f",C)),L=Math.max(-8,Math.min(8,Math.floor(qy(k)/3)))*3,R=Math.pow(10,-L),N=wV[8+L/3];return function(V){return O(R*V)+N}}return{format:w,formatPrefix:S}}var dE,WL,zJ;RNe({thousands:",",grouping:[3],currency:["$",""]});function RNe(e){return dE=MNe(e),WL=dE.format,zJ=dE.formatPrefix,dE}function DNe(e){return Math.max(0,-qy(Math.abs(e)))}function FNe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qy(t)/3)))*3-qy(Math.abs(e)))}function LNe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,qy(t)-qy(e))+1}function jJ(e,t,r,n){var o=J3(e,t,r),u;switch(n=Tb(n??",f"),n.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(u=FNe(o,d))&&(n.precision=u),zJ(n,d)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(u=LNe(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=u-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(u=DNe(o))&&(n.precision=u-(n.type==="%")*2);break}}return WL(n)}function jp(e){var t=e.domain;return e.ticks=function(r){var n=t();return Y3(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var o=t();return jJ(o[0],o[o.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,u=n.length-1,d=n[o],i=n[u],v,w,S=10;for(i<d&&(w=d,d=i,i=w,w=o,o=u,u=w);S-- >0;){if(w=K3(d,i,r),w===v)return n[o]=d,n[u]=i,t(n);if(w>0)d=Math.floor(d/w)*w,i=Math.ceil(i/w)*w;else if(w<0)d=Math.ceil(d*w)/w,i=Math.floor(i*w)/w;else break;v=w}return e},e}function rC(){var e=$L();return e.copy=function(){return A2(e,rC())},zc.apply(e,arguments),jp(e)}function UJ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,eC),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return UJ(e).unknown(t)},e=arguments.length?Array.from(e,eC):[0,1],jp(r)}function $J(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],u=e[n],d;return u<o&&(d=r,r=n,n=d,d=o,o=u,u=d),e[r]=t.floor(o),e[n]=t.ceil(u),e}function bV(e){return Math.log(e)}function TV(e){return Math.exp(e)}function NNe(e){return-Math.log(-e)}function BNe(e){return-Math.exp(-e)}function zNe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function jNe(e){return e===10?zNe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function UNe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function SV(e){return(t,r)=>-e(-t,r)}function GL(e){const t=e(bV,TV),r=t.domain;let n=10,o,u;function d(){return o=UNe(n),u=jNe(n),r()[0]<0?(o=SV(o),u=SV(u),e(NNe,BNe)):e(bV,TV),t}return t.base=function(i){return arguments.length?(n=+i,d()):n},t.domain=function(i){return arguments.length?(r(i),d()):r()},t.ticks=i=>{const v=r();let w=v[0],S=v[v.length-1];const C=S<w;C&&([w,S]=[S,w]);let k=o(w),O=o(S),L,R;const N=i==null?10:+i;let V=[];if(!(n%1)&&O-k<N){if(k=Math.floor(k),O=Math.ceil(O),w>0){for(;k<=O;++k)for(L=1;L<n;++L)if(R=k<0?L/u(-k):L*u(k),!(R<w)){if(R>S)break;V.push(R)}}else for(;k<=O;++k)for(L=n-1;L>=1;--L)if(R=k>0?L/u(-k):L*u(k),!(R<w)){if(R>S)break;V.push(R)}V.length*2<N&&(V=Y3(w,S,N))}else V=Y3(k,O,Math.min(O-k,N)).map(u);return C?V.reverse():V},t.tickFormat=(i,v)=>{if(i==null&&(i=10),v==null&&(v=n===10?"s":","),typeof v!="function"&&(!(n%1)&&(v=Tb(v)).precision==null&&(v.trim=!0),v=WL(v)),i===1/0)return v;const w=Math.max(1,n*i/t.ticks().length);return S=>{let C=S/u(Math.round(o(S)));return C*n<n-.5&&(C*=n),C<=w?v(S):""}},t.nice=()=>r($J(r(),{floor:i=>u(Math.floor(o(i))),ceil:i=>u(Math.ceil(o(i)))})),t}function VJ(){const e=GL(ZP()).domain([1,10]);return e.copy=()=>A2(e,VJ()).base(e.base()),zc.apply(e,arguments),e}function EV(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function AV(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function HL(e){var t=1,r=e(EV(t),AV(t));return r.constant=function(n){return arguments.length?e(EV(t=+n),AV(t)):t},jp(r)}function WJ(){var e=HL(ZP());return e.copy=function(){return A2(e,WJ()).constant(e.constant())},zc.apply(e,arguments)}function CV(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $Ne(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function VNe(e){return e<0?-e*e:e*e}function qL(e){var t=e(Qs,Qs),r=1;function n(){return r===1?e(Qs,Qs):r===.5?e($Ne,VNe):e(CV(r),CV(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},jp(t)}function XL(){var e=qL(ZP());return e.copy=function(){return A2(e,XL()).exponent(e.exponent())},zc.apply(e,arguments),e}function WNe(){return XL.apply(null,arguments).exponent(.5)}function PV(e){return Math.sign(e)*e*e}function GNe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function GJ(){var e=$L(),t=[0,1],r=!1,n;function o(u){var d=GNe(e(u));return isNaN(d)?n:r?Math.round(d):d}return o.invert=function(u){return e.invert(PV(u))},o.domain=function(u){return arguments.length?(e.domain(u),o):e.domain()},o.range=function(u){return arguments.length?(e.range((t=Array.from(u,eC)).map(PV)),o):t.slice()},o.rangeRound=function(u){return o.range(u).round(!0)},o.round=function(u){return arguments.length?(r=!!u,o):r},o.clamp=function(u){return arguments.length?(e.clamp(u),o):e.clamp()},o.unknown=function(u){return arguments.length?(n=u,o):n},o.copy=function(){return GJ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},zc.apply(o,arguments),jp(o)}function HJ(){var e=[],t=[],r=[],n;function o(){var d=0,i=Math.max(1,t.length);for(r=new Array(i-1);++d<i;)r[d-1]=YLe(e,d/i);return u}function u(d){return d==null||isNaN(d=+d)?n:t[S2(r,d)]}return u.invertExtent=function(d){var i=t.indexOf(d);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},u.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let i of d)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(yp),o()},u.range=function(d){return arguments.length?(t=Array.from(d),o()):t.slice()},u.unknown=function(d){return arguments.length?(n=d,u):n},u.quantiles=function(){return r.slice()},u.copy=function(){return HJ().domain(e).range(t).unknown(n)},zc.apply(u,arguments)}function qJ(){var e=0,t=1,r=1,n=[.5],o=[0,1],u;function d(v){return v!=null&&v<=v?o[S2(n,v,0,r)]:u}function i(){var v=-1;for(n=new Array(r);++v<r;)n[v]=((v+1)*t-(v-r)*e)/(r+1);return d}return d.domain=function(v){return arguments.length?([e,t]=v,e=+e,t=+t,i()):[e,t]},d.range=function(v){return arguments.length?(r=(o=Array.from(v)).length-1,i()):o.slice()},d.invertExtent=function(v){var w=o.indexOf(v);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},d.unknown=function(v){return arguments.length&&(u=v),d},d.thresholds=function(){return n.slice()},d.copy=function(){return qJ().domain([e,t]).range(o).unknown(u)},zc.apply(jp(d),arguments)}function XJ(){var e=[.5],t=[0,1],r,n=1;function o(u){return u!=null&&u<=u?t[S2(e,u,0,n)]:r}return o.domain=function(u){return arguments.length?(e=Array.from(u),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(u){return arguments.length?(t=Array.from(u),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(u){var d=t.indexOf(u);return[e[d-1],e[d]]},o.unknown=function(u){return arguments.length?(r=u,o):r},o.copy=function(){return XJ().domain(e).range(t).unknown(r)},zc.apply(o,arguments)}const NM=new Date,BM=new Date;function No(e,t,r,n){function o(u){return e(u=arguments.length===0?new Date:new Date(+u)),u}return o.floor=u=>(e(u=new Date(+u)),u),o.ceil=u=>(e(u=new Date(u-1)),t(u,1),e(u),u),o.round=u=>{const d=o(u),i=o.ceil(u);return u-d<i-u?d:i},o.offset=(u,d)=>(t(u=new Date(+u),d==null?1:Math.floor(d)),u),o.range=(u,d,i)=>{const v=[];if(u=o.ceil(u),i=i==null?1:Math.floor(i),!(u<d)||!(i>0))return v;let w;do v.push(w=new Date(+u)),t(u,i),e(u);while(w<u&&u<d);return v},o.filter=u=>No(d=>{if(d>=d)for(;e(d),!u(d);)d.setTime(d-1)},(d,i)=>{if(d>=d)if(i<0)for(;++i<=0;)for(;t(d,-1),!u(d););else for(;--i>=0;)for(;t(d,1),!u(d););}),r&&(o.count=(u,d)=>(NM.setTime(+u),BM.setTime(+d),e(NM),e(BM),Math.floor(r(NM,BM))),o.every=u=>(u=Math.floor(u),!isFinite(u)||!(u>0)?null:u>1?o.filter(n?d=>n(d)%u===0:d=>o.count(0,d)%u===0):o)),o}const nC=No(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);nC.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?No(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):nC);nC.range;const vf=1e3,Ic=vf*60,xf=Ic*60,Ff=xf*24,ZL=Ff*7,IV=Ff*30,zM=Ff*365,qm=No(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*vf)},(e,t)=>(t-e)/vf,e=>e.getUTCSeconds());qm.range;const YL=No(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*vf)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getMinutes());YL.range;const KL=No(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getUTCMinutes());KL.range;const JL=No(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*vf-e.getMinutes()*Ic)},(e,t)=>{e.setTime(+e+t*xf)},(e,t)=>(t-e)/xf,e=>e.getHours());JL.range;const QL=No(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*xf)},(e,t)=>(t-e)/xf,e=>e.getUTCHours());QL.range;const C2=No(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ic)/Ff,e=>e.getDate()-1);C2.range;const YP=No(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ff,e=>e.getUTCDate()-1);YP.range;const ZJ=No(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ff,e=>Math.floor(e/Ff));ZJ.range;function V0(e){return No(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ic)/ZL)}const KP=V0(0),iC=V0(1),HNe=V0(2),qNe=V0(3),Xy=V0(4),XNe=V0(5),ZNe=V0(6);KP.range;iC.range;HNe.range;qNe.range;Xy.range;XNe.range;ZNe.range;function W0(e){return No(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/ZL)}const JP=W0(0),aC=W0(1),YNe=W0(2),KNe=W0(3),Zy=W0(4),JNe=W0(5),QNe=W0(6);JP.range;aC.range;YNe.range;KNe.range;Zy.range;JNe.range;QNe.range;const eN=No(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());eN.range;const tN=No(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());tN.range;const Lf=No(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Lf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:No(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Lf.range;const Nf=No(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Nf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:No(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Nf.range;function YJ(e,t,r,n,o,u){const d=[[qm,1,vf],[qm,5,5*vf],[qm,15,15*vf],[qm,30,30*vf],[u,1,Ic],[u,5,5*Ic],[u,15,15*Ic],[u,30,30*Ic],[o,1,xf],[o,3,3*xf],[o,6,6*xf],[o,12,12*xf],[n,1,Ff],[n,2,2*Ff],[r,1,ZL],[t,1,IV],[t,3,3*IV],[e,1,zM]];function i(w,S,C){const k=S<w;k&&([w,S]=[S,w]);const O=C&&typeof C.range=="function"?C:v(w,S,C),L=O?O.range(w,+S+1):[];return k?L.reverse():L}function v(w,S,C){const k=Math.abs(S-w)/C,O=NL(([,,N])=>N).right(d,k);if(O===d.length)return e.every(J3(w/zM,S/zM,C));if(O===0)return nC.every(Math.max(J3(w,S,C),1));const[L,R]=d[k/d[O-1][2]<d[O][2]/k?O-1:O];return L.every(R)}return[i,v]}const[eBe,tBe]=YJ(Nf,tN,JP,ZJ,QL,KL),[rBe,nBe]=YJ(Lf,eN,KP,C2,JL,YL);function jM(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function UM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function $1(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function iBe(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,u=e.days,d=e.shortDays,i=e.months,v=e.shortMonths,w=V1(o),S=W1(o),C=V1(u),k=W1(u),O=V1(d),L=W1(d),R=V1(i),N=W1(i),V=V1(v),G=W1(v),U={a:pt,A:ft,b:Ue,B:It,c:null,d:FV,e:FV,f:CBe,g:NBe,G:zBe,H:SBe,I:EBe,j:ABe,L:KJ,m:PBe,M:IBe,p:Rt,q:_e,Q:BV,s:zV,S:kBe,u:OBe,U:MBe,V:RBe,w:DBe,W:FBe,x:null,X:null,y:LBe,Y:BBe,Z:jBe,"%":NV},J={a:Ge,A:qe,b:Xe,B:yt,c:null,d:LV,e:LV,f:WBe,g:eze,G:rze,H:UBe,I:$Be,j:VBe,L:QJ,m:GBe,M:HBe,p:Dt,q:Yt,Q:BV,s:zV,S:qBe,u:XBe,U:ZBe,V:YBe,w:KBe,W:JBe,x:null,X:null,y:QBe,Y:tze,Z:nze,"%":NV},Z={a:$e,A:Ie,b:ke,B:tt,c:Je,d:RV,e:RV,f:xBe,g:MV,G:OV,H:DV,I:DV,j:gBe,L:vBe,m:mBe,M:_Be,p:ve,q:pBe,Q:bBe,s:TBe,S:yBe,u:cBe,U:uBe,V:hBe,w:lBe,W:fBe,x:et,X:at,y:MV,Y:OV,Z:dBe,"%":wBe};U.x=K(r,U),U.X=K(n,U),U.c=K(t,U),J.x=K(r,J),J.X=K(n,J),J.c=K(t,J);function K(St,Mt){return function(Sr){var Ne=[],un=-1,kr=0,Br=St.length,Yr,Tr,jn;for(Sr instanceof Date||(Sr=new Date(+Sr));++un<Br;)St.charCodeAt(un)===37&&(Ne.push(St.slice(kr,un)),(Tr=kV[Yr=St.charAt(++un)])!=null?Yr=St.charAt(++un):Tr=Yr==="e"?" ":"0",(jn=Mt[Yr])&&(Yr=jn(Sr,Tr)),Ne.push(Yr),kr=un+1);return Ne.push(St.slice(kr,un)),Ne.join("")}}function re(St,Mt){return function(Sr){var Ne=$1(1900,void 0,1),un=ge(Ne,St,Sr+="",0),kr,Br;if(un!=Sr.length)return null;if("Q"in Ne)return new Date(Ne.Q);if("s"in Ne)return new Date(Ne.s*1e3+("L"in Ne?Ne.L:0));if(Mt&&!("Z"in Ne)&&(Ne.Z=0),"p"in Ne&&(Ne.H=Ne.H%12+Ne.p*12),Ne.m===void 0&&(Ne.m="q"in Ne?Ne.q:0),"V"in Ne){if(Ne.V<1||Ne.V>53)return null;"w"in Ne||(Ne.w=1),"Z"in Ne?(kr=UM($1(Ne.y,0,1)),Br=kr.getUTCDay(),kr=Br>4||Br===0?aC.ceil(kr):aC(kr),kr=YP.offset(kr,(Ne.V-1)*7),Ne.y=kr.getUTCFullYear(),Ne.m=kr.getUTCMonth(),Ne.d=kr.getUTCDate()+(Ne.w+6)%7):(kr=jM($1(Ne.y,0,1)),Br=kr.getDay(),kr=Br>4||Br===0?iC.ceil(kr):iC(kr),kr=C2.offset(kr,(Ne.V-1)*7),Ne.y=kr.getFullYear(),Ne.m=kr.getMonth(),Ne.d=kr.getDate()+(Ne.w+6)%7)}else("W"in Ne||"U"in Ne)&&("w"in Ne||(Ne.w="u"in Ne?Ne.u%7:"W"in Ne?1:0),Br="Z"in Ne?UM($1(Ne.y,0,1)).getUTCDay():jM($1(Ne.y,0,1)).getDay(),Ne.m=0,Ne.d="W"in Ne?(Ne.w+6)%7+Ne.W*7-(Br+5)%7:Ne.w+Ne.U*7-(Br+6)%7);return"Z"in Ne?(Ne.H+=Ne.Z/100|0,Ne.M+=Ne.Z%100,UM(Ne)):jM(Ne)}}function ge(St,Mt,Sr,Ne){for(var un=0,kr=Mt.length,Br=Sr.length,Yr,Tr;un<kr;){if(Ne>=Br)return-1;if(Yr=Mt.charCodeAt(un++),Yr===37){if(Yr=Mt.charAt(un++),Tr=Z[Yr in kV?Mt.charAt(un++):Yr],!Tr||(Ne=Tr(St,Sr,Ne))<0)return-1}else if(Yr!=Sr.charCodeAt(Ne++))return-1}return Ne}function ve(St,Mt,Sr){var Ne=w.exec(Mt.slice(Sr));return Ne?(St.p=S.get(Ne[0].toLowerCase()),Sr+Ne[0].length):-1}function $e(St,Mt,Sr){var Ne=O.exec(Mt.slice(Sr));return Ne?(St.w=L.get(Ne[0].toLowerCase()),Sr+Ne[0].length):-1}function Ie(St,Mt,Sr){var Ne=C.exec(Mt.slice(Sr));return Ne?(St.w=k.get(Ne[0].toLowerCase()),Sr+Ne[0].length):-1}function ke(St,Mt,Sr){var Ne=V.exec(Mt.slice(Sr));return Ne?(St.m=G.get(Ne[0].toLowerCase()),Sr+Ne[0].length):-1}function tt(St,Mt,Sr){var Ne=R.exec(Mt.slice(Sr));return Ne?(St.m=N.get(Ne[0].toLowerCase()),Sr+Ne[0].length):-1}function Je(St,Mt,Sr){return ge(St,t,Mt,Sr)}function et(St,Mt,Sr){return ge(St,r,Mt,Sr)}function at(St,Mt,Sr){return ge(St,n,Mt,Sr)}function pt(St){return d[St.getDay()]}function ft(St){return u[St.getDay()]}function Ue(St){return v[St.getMonth()]}function It(St){return i[St.getMonth()]}function Rt(St){return o[+(St.getHours()>=12)]}function _e(St){return 1+~~(St.getMonth()/3)}function Ge(St){return d[St.getUTCDay()]}function qe(St){return u[St.getUTCDay()]}function Xe(St){return v[St.getUTCMonth()]}function yt(St){return i[St.getUTCMonth()]}function Dt(St){return o[+(St.getUTCHours()>=12)]}function Yt(St){return 1+~~(St.getUTCMonth()/3)}return{format:function(St){var Mt=K(St+="",U);return Mt.toString=function(){return St},Mt},parse:function(St){var Mt=re(St+="",!1);return Mt.toString=function(){return St},Mt},utcFormat:function(St){var Mt=K(St+="",J);return Mt.toString=function(){return St},Mt},utcParse:function(St){var Mt=re(St+="",!0);return Mt.toString=function(){return St},Mt}}}var kV={"-":"",_:" ",0:"0"},es=/^\s*\d+/,aBe=/^%/,oBe=/[\\^$*+?|[\]().{}]/g;function zi(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",u=o.length;return n+(u<r?new Array(r-u+1).join(t)+o:o)}function sBe(e){return e.replace(oBe,"\\$&")}function V1(e){return new RegExp("^(?:"+e.map(sBe).join("|")+")","i")}function W1(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function lBe(e,t,r){var n=es.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function cBe(e,t,r){var n=es.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function uBe(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function hBe(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function fBe(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function OV(e,t,r){var n=es.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function MV(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function dBe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function pBe(e,t,r){var n=es.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function mBe(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function RV(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function gBe(e,t,r){var n=es.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function DV(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function _Be(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function yBe(e,t,r){var n=es.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function vBe(e,t,r){var n=es.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function xBe(e,t,r){var n=es.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function wBe(e,t,r){var n=aBe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function bBe(e,t,r){var n=es.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function TBe(e,t,r){var n=es.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function FV(e,t){return zi(e.getDate(),t,2)}function SBe(e,t){return zi(e.getHours(),t,2)}function EBe(e,t){return zi(e.getHours()%12||12,t,2)}function ABe(e,t){return zi(1+C2.count(Lf(e),e),t,3)}function KJ(e,t){return zi(e.getMilliseconds(),t,3)}function CBe(e,t){return KJ(e,t)+"000"}function PBe(e,t){return zi(e.getMonth()+1,t,2)}function IBe(e,t){return zi(e.getMinutes(),t,2)}function kBe(e,t){return zi(e.getSeconds(),t,2)}function OBe(e){var t=e.getDay();return t===0?7:t}function MBe(e,t){return zi(KP.count(Lf(e)-1,e),t,2)}function JJ(e){var t=e.getDay();return t>=4||t===0?Xy(e):Xy.ceil(e)}function RBe(e,t){return e=JJ(e),zi(Xy.count(Lf(e),e)+(Lf(e).getDay()===4),t,2)}function DBe(e){return e.getDay()}function FBe(e,t){return zi(iC.count(Lf(e)-1,e),t,2)}function LBe(e,t){return zi(e.getFullYear()%100,t,2)}function NBe(e,t){return e=JJ(e),zi(e.getFullYear()%100,t,2)}function BBe(e,t){return zi(e.getFullYear()%1e4,t,4)}function zBe(e,t){var r=e.getDay();return e=r>=4||r===0?Xy(e):Xy.ceil(e),zi(e.getFullYear()%1e4,t,4)}function jBe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+zi(t/60|0,"0",2)+zi(t%60,"0",2)}function LV(e,t){return zi(e.getUTCDate(),t,2)}function UBe(e,t){return zi(e.getUTCHours(),t,2)}function $Be(e,t){return zi(e.getUTCHours()%12||12,t,2)}function VBe(e,t){return zi(1+YP.count(Nf(e),e),t,3)}function QJ(e,t){return zi(e.getUTCMilliseconds(),t,3)}function WBe(e,t){return QJ(e,t)+"000"}function GBe(e,t){return zi(e.getUTCMonth()+1,t,2)}function HBe(e,t){return zi(e.getUTCMinutes(),t,2)}function qBe(e,t){return zi(e.getUTCSeconds(),t,2)}function XBe(e){var t=e.getUTCDay();return t===0?7:t}function ZBe(e,t){return zi(JP.count(Nf(e)-1,e),t,2)}function eQ(e){var t=e.getUTCDay();return t>=4||t===0?Zy(e):Zy.ceil(e)}function YBe(e,t){return e=eQ(e),zi(Zy.count(Nf(e),e)+(Nf(e).getUTCDay()===4),t,2)}function KBe(e){return e.getUTCDay()}function JBe(e,t){return zi(aC.count(Nf(e)-1,e),t,2)}function QBe(e,t){return zi(e.getUTCFullYear()%100,t,2)}function eze(e,t){return e=eQ(e),zi(e.getUTCFullYear()%100,t,2)}function tze(e,t){return zi(e.getUTCFullYear()%1e4,t,4)}function rze(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Zy(e):Zy.ceil(e),zi(e.getUTCFullYear()%1e4,t,4)}function nze(){return"+0000"}function NV(){return"%"}function BV(e){return+e}function zV(e){return Math.floor(+e/1e3)}var k_,tQ,rQ;ize({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ize(e){return k_=iBe(e),tQ=k_.format,k_.parse,rQ=k_.utcFormat,k_.utcParse,k_}function aze(e){return new Date(e)}function oze(e){return e instanceof Date?+e:+new Date(+e)}function rN(e,t,r,n,o,u,d,i,v,w){var S=$L(),C=S.invert,k=S.domain,O=w(".%L"),L=w(":%S"),R=w("%I:%M"),N=w("%I %p"),V=w("%a %d"),G=w("%b %d"),U=w("%B"),J=w("%Y");function Z(K){return(v(K)<K?O:i(K)<K?L:d(K)<K?R:u(K)<K?N:n(K)<K?o(K)<K?V:G:r(K)<K?U:J)(K)}return S.invert=function(K){return new Date(C(K))},S.domain=function(K){return arguments.length?k(Array.from(K,oze)):k().map(aze)},S.ticks=function(K){var re=k();return e(re[0],re[re.length-1],K??10)},S.tickFormat=function(K,re){return re==null?Z:w(re)},S.nice=function(K){var re=k();return(!K||typeof K.range!="function")&&(K=t(re[0],re[re.length-1],K??10)),K?k($J(re,K)):S},S.copy=function(){return A2(S,rN(e,t,r,n,o,u,d,i,v,w))},S}function sze(){return zc.apply(rN(rBe,nBe,Lf,eN,KP,C2,JL,YL,qm,tQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lze(){return zc.apply(rN(eBe,tBe,Nf,tN,JP,YP,QL,KL,qm,rQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function QP(){var e=0,t=1,r,n,o,u,d=Qs,i=!1,v;function w(C){return C==null||isNaN(C=+C)?v:d(o===0?.5:(C=(u(C)-r)*o,i?Math.max(0,Math.min(1,C)):C))}w.domain=function(C){return arguments.length?([e,t]=C,r=u(e=+e),n=u(t=+t),o=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(C){return arguments.length?(i=!!C,w):i},w.interpolator=function(C){return arguments.length?(d=C,w):d};function S(C){return function(k){var O,L;return arguments.length?([O,L]=k,d=C(O,L),w):[d(0),d(1)]}}return w.range=S(Iv),w.rangeRound=S(UL),w.unknown=function(C){return arguments.length?(v=C,w):v},function(C){return u=C,r=C(e),n=C(t),o=r===n?0:1/(n-r),w}}function Up(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nQ(){var e=jp(QP()(Qs));return e.copy=function(){return Up(e,nQ())},Gf.apply(e,arguments)}function iQ(){var e=GL(QP()).domain([1,10]);return e.copy=function(){return Up(e,iQ()).base(e.base())},Gf.apply(e,arguments)}function aQ(){var e=HL(QP());return e.copy=function(){return Up(e,aQ()).constant(e.constant())},Gf.apply(e,arguments)}function nN(){var e=qL(QP());return e.copy=function(){return Up(e,nN()).exponent(e.exponent())},Gf.apply(e,arguments)}function cze(){return nN.apply(null,arguments).exponent(.5)}function oQ(){var e=[],t=Qs;function r(n){if(n!=null&&!isNaN(n=+n))return t((S2(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(yp),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,u)=>ZLe(e,u/n))},r.copy=function(){return oQ(t).domain(e)},Gf.apply(r,arguments)}function eI(){var e=0,t=.5,r=1,n=1,o,u,d,i,v,w=Qs,S,C=!1,k;function O(R){return isNaN(R=+R)?k:(R=.5+((R=+S(R))-u)*(n*R<n*u?i:v),w(C?Math.max(0,Math.min(1,R)):R))}O.domain=function(R){return arguments.length?([e,t,r]=R,o=S(e=+e),u=S(t=+t),d=S(r=+r),i=o===u?0:.5/(u-o),v=u===d?0:.5/(d-u),n=u<o?-1:1,O):[e,t,r]},O.clamp=function(R){return arguments.length?(C=!!R,O):C},O.interpolator=function(R){return arguments.length?(w=R,O):w};function L(R){return function(N){var V,G,U;return arguments.length?([V,G,U]=N,w=wNe(R,[V,G,U]),O):[w(0),w(.5),w(1)]}}return O.range=L(Iv),O.rangeRound=L(UL),O.unknown=function(R){return arguments.length?(k=R,O):k},function(R){return S=R,o=R(e),u=R(t),d=R(r),i=o===u?0:.5/(u-o),v=u===d?0:.5/(d-u),n=u<o?-1:1,O}}function sQ(){var e=jp(eI()(Qs));return e.copy=function(){return Up(e,sQ())},Gf.apply(e,arguments)}function lQ(){var e=GL(eI()).domain([.1,1,10]);return e.copy=function(){return Up(e,lQ()).base(e.base())},Gf.apply(e,arguments)}function cQ(){var e=HL(eI());return e.copy=function(){return Up(e,cQ()).constant(e.constant())},Gf.apply(e,arguments)}function iN(){var e=qL(eI());return e.copy=function(){return Up(e,iN()).exponent(e.exponent())},Gf.apply(e,arguments)}function uze(){return iN.apply(null,arguments).exponent(.5)}const jV=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:vb,scaleDiverging:sQ,scaleDivergingLog:lQ,scaleDivergingPow:iN,scaleDivergingSqrt:uze,scaleDivergingSymlog:cQ,scaleIdentity:UJ,scaleImplicit:Q3,scaleLinear:rC,scaleLog:VJ,scaleOrdinal:BL,scalePoint:Cw,scalePow:XL,scaleQuantile:HJ,scaleQuantize:qJ,scaleRadial:GJ,scaleSequential:nQ,scaleSequentialLog:iQ,scaleSequentialPow:nN,scaleSequentialQuantile:oQ,scaleSequentialSqrt:cze,scaleSequentialSymlog:aQ,scaleSqrt:WNe,scaleSymlog:WJ,scaleThreshold:XJ,scaleTime:sze,scaleUtc:lze,tickFormat:jJ},Symbol.toStringTag,{value:"Module"}));var hze=wv;function fze(e,t,r){for(var n=-1,o=e.length;++n<o;){var u=e[n],d=t(u);if(d!=null&&(i===void 0?d===d&&!hze(d):r(d,i)))var i=d,v=u}return v}var uQ=fze;function dze(e,t){return e>t}var pze=dze,mze=uQ,gze=pze,_ze=Pv;function yze(e){return e&&e.length?mze(e,_ze,gze):void 0}var vze=yze;const tI=Qi(vze);function xze(e,t){return e<t}var wze=xze,bze=uQ,Tze=wze,Sze=Pv;function Eze(e){return e&&e.length?bze(e,Sze,Tze):void 0}var Aze=Eze;const rI=Qi(Aze);var Cze=yL,Pze=zp,Ize=yJ,kze=vl;function Oze(e,t){var r=kze(e)?Cze:Ize;return r(e,Pze(t))}var Mze=Oze,Rze=gJ,Dze=Mze;function Fze(e,t){return Rze(Dze(e,t),1)}var Lze=Fze;const Nze=Qi(Lze);var Bze=RL;function zze(e,t){return Bze(e,t)}var jze=zze;const nI=Qi(jze);var kv=1e9,Uze={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},oN,ja=!0,Lc="[DecimalError] ",l0=Lc+"Invalid argument: ",aN=Lc+"Exponent out of range: ",Ov=Math.floor,zm=Math.pow,$ze=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Wl,qo=1e7,Pa=7,hQ=9007199254740991,oC=Ov(hQ/Pa),cn={};cn.absoluteValue=cn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};cn.comparedTo=cn.cmp=function(e){var t,r,n,o,u=this;if(e=new u.constructor(e),u.s!==e.s)return u.s||-e.s;if(u.e!==e.e)return u.e>e.e^u.s<0?1:-1;for(n=u.d.length,o=e.d.length,t=0,r=n<o?n:o;t<r;++t)if(u.d[t]!==e.d[t])return u.d[t]>e.d[t]^u.s<0?1:-1;return n===o?0:n>o^u.s<0?1:-1};cn.decimalPlaces=cn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Pa;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};cn.dividedBy=cn.div=function(e){return Pf(this,new this.constructor(e))};cn.dividedToIntegerBy=cn.idiv=function(e){var t=this,r=t.constructor;return ha(Pf(t,new r(e),0,1),r.precision)};cn.equals=cn.eq=function(e){return!this.cmp(e)};cn.exponent=function(){return wo(this)};cn.greaterThan=cn.gt=function(e){return this.cmp(e)>0};cn.greaterThanOrEqualTo=cn.gte=function(e){return this.cmp(e)>=0};cn.isInteger=cn.isint=function(){return this.e>this.d.length-2};cn.isNegative=cn.isneg=function(){return this.s<0};cn.isPositive=cn.ispos=function(){return this.s>0};cn.isZero=function(){return this.s===0};cn.lessThan=cn.lt=function(e){return this.cmp(e)<0};cn.lessThanOrEqualTo=cn.lte=function(e){return this.cmp(e)<1};cn.logarithm=cn.log=function(e){var t,r=this,n=r.constructor,o=n.precision,u=o+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Wl))throw Error(Lc+"NaN");if(r.s<1)throw Error(Lc+(r.s?"NaN":"-Infinity"));return r.eq(Wl)?new n(0):(ja=!1,t=Pf(Sb(r,u),Sb(e,u),u),ja=!0,ha(t,o))};cn.minus=cn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?pQ(t,e):fQ(t,(e.s=-e.s,e))};cn.modulo=cn.mod=function(e){var t,r=this,n=r.constructor,o=n.precision;if(e=new n(e),!e.s)throw Error(Lc+"NaN");return r.s?(ja=!1,t=Pf(r,e,0,1).times(e),ja=!0,r.minus(t)):ha(new n(r),o)};cn.naturalExponential=cn.exp=function(){return dQ(this)};cn.naturalLogarithm=cn.ln=function(){return Sb(this)};cn.negated=cn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};cn.plus=cn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fQ(t,e):pQ(t,(e.s=-e.s,e))};cn.precision=cn.sd=function(e){var t,r,n,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(l0+e);if(t=wo(o)+1,n=o.d.length-1,r=n*Pa+1,n=o.d[n],n){for(;n%10==0;n/=10)r--;for(n=o.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};cn.squareRoot=cn.sqrt=function(){var e,t,r,n,o,u,d,i=this,v=i.constructor;if(i.s<1){if(!i.s)return new v(0);throw Error(Lc+"NaN")}for(e=wo(i),ja=!1,o=Math.sqrt(+i),o==0||o==1/0?(t=_h(i.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=Ov((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new v(t)):n=new v(o.toString()),r=v.precision,o=d=r+3;;)if(u=n,n=u.plus(Pf(i,u,d+2)).times(.5),_h(u.d).slice(0,d)===(t=_h(n.d)).slice(0,d)){if(t=t.slice(d-3,d+1),o==d&&t=="4999"){if(ha(u,r+1,0),u.times(u).eq(i)){n=u;break}}else if(t!="9999")break;d+=4}return ja=!0,ha(n,r)};cn.times=cn.mul=function(e){var t,r,n,o,u,d,i,v,w,S=this,C=S.constructor,k=S.d,O=(e=new C(e)).d;if(!S.s||!e.s)return new C(0);for(e.s*=S.s,r=S.e+e.e,v=k.length,w=O.length,v<w&&(u=k,k=O,O=u,d=v,v=w,w=d),u=[],d=v+w,n=d;n--;)u.push(0);for(n=w;--n>=0;){for(t=0,o=v+n;o>n;)i=u[o]+O[n]*k[o-n-1]+t,u[o--]=i%qo|0,t=i/qo|0;u[o]=(u[o]+t)%qo|0}for(;!u[--d];)u.pop();return t?++r:u.shift(),e.d=u,e.e=r,ja?ha(e,C.precision):e};cn.toDecimalPlaces=cn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ph(e,0,kv),t===void 0?t=n.rounding:Ph(t,0,8),ha(r,e+wo(r)+1,t))};cn.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=I0(n,!0):(Ph(e,0,kv),t===void 0?t=o.rounding:Ph(t,0,8),n=ha(new o(n),e+1,t),r=I0(n,!0,e+1)),r};cn.toFixed=function(e,t){var r,n,o=this,u=o.constructor;return e===void 0?I0(o):(Ph(e,0,kv),t===void 0?t=u.rounding:Ph(t,0,8),n=ha(new u(o),e+wo(o)+1,t),r=I0(n.abs(),!1,e+wo(n)+1),o.isneg()&&!o.isZero()?"-"+r:r)};cn.toInteger=cn.toint=function(){var e=this,t=e.constructor;return ha(new t(e),wo(e)+1,t.rounding)};cn.toNumber=function(){return+this};cn.toPower=cn.pow=function(e){var t,r,n,o,u,d,i=this,v=i.constructor,w=12,S=+(e=new v(e));if(!e.s)return new v(Wl);if(i=new v(i),!i.s){if(e.s<1)throw Error(Lc+"Infinity");return i}if(i.eq(Wl))return i;if(n=v.precision,e.eq(Wl))return ha(i,n);if(t=e.e,r=e.d.length-1,d=t>=r,u=i.s,d){if((r=S<0?-S:S)<=hQ){for(o=new v(Wl),t=Math.ceil(n/Pa+4),ja=!1;r%2&&(o=o.times(i),$V(o.d,t)),r=Ov(r/2),r!==0;)i=i.times(i),$V(i.d,t);return ja=!0,e.s<0?new v(Wl).div(o):ha(o,n)}}else if(u<0)throw Error(Lc+"NaN");return u=u<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,ja=!1,o=e.times(Sb(i,n+w)),ja=!0,o=dQ(o),o.s=u,o};cn.toPrecision=function(e,t){var r,n,o=this,u=o.constructor;return e===void 0?(r=wo(o),n=I0(o,r<=u.toExpNeg||r>=u.toExpPos)):(Ph(e,1,kv),t===void 0?t=u.rounding:Ph(t,0,8),o=ha(new u(o),e,t),r=wo(o),n=I0(o,e<=r||r<=u.toExpNeg,e)),n};cn.toSignificantDigits=cn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ph(e,1,kv),t===void 0?t=n.rounding:Ph(t,0,8)),ha(new n(r),e,t)};cn.toString=cn.valueOf=cn.val=cn.toJSON=cn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=wo(e),r=e.constructor;return I0(e,t<=r.toExpNeg||t>=r.toExpPos)};function fQ(e,t){var r,n,o,u,d,i,v,w,S=e.constructor,C=S.precision;if(!e.s||!t.s)return t.s||(t=new S(e)),ja?ha(t,C):t;if(v=e.d,w=t.d,d=e.e,o=t.e,v=v.slice(),u=d-o,u){for(u<0?(n=v,u=-u,i=w.length):(n=w,o=d,i=v.length),d=Math.ceil(C/Pa),i=d>i?d+1:i+1,u>i&&(u=i,n.length=1),n.reverse();u--;)n.push(0);n.reverse()}for(i=v.length,u=w.length,i-u<0&&(u=i,n=w,w=v,v=n),r=0;u;)r=(v[--u]=v[u]+w[u]+r)/qo|0,v[u]%=qo;for(r&&(v.unshift(r),++o),i=v.length;v[--i]==0;)v.pop();return t.d=v,t.e=o,ja?ha(t,C):t}function Ph(e,t,r){if(e!==~~e||e<t||e>r)throw Error(l0+e)}function _h(e){var t,r,n,o=e.length-1,u="",d=e[0];if(o>0){for(u+=d,t=1;t<o;t++)n=e[t]+"",r=Pa-n.length,r&&(u+=Wd(r)),u+=n;d=e[t],n=d+"",r=Pa-n.length,r&&(u+=Wd(r))}else if(d===0)return"0";for(;d%10===0;)d/=10;return u+d}var Pf=function(){function e(n,o){var u,d=0,i=n.length;for(n=n.slice();i--;)u=n[i]*o+d,n[i]=u%qo|0,d=u/qo|0;return d&&n.unshift(d),n}function t(n,o,u,d){var i,v;if(u!=d)v=u>d?1:-1;else for(i=v=0;i<u;i++)if(n[i]!=o[i]){v=n[i]>o[i]?1:-1;break}return v}function r(n,o,u){for(var d=0;u--;)n[u]-=d,d=n[u]<o[u]?1:0,n[u]=d*qo+n[u]-o[u];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,u,d){var i,v,w,S,C,k,O,L,R,N,V,G,U,J,Z,K,re,ge,ve=n.constructor,$e=n.s==o.s?1:-1,Ie=n.d,ke=o.d;if(!n.s)return new ve(n);if(!o.s)throw Error(Lc+"Division by zero");for(v=n.e-o.e,re=ke.length,Z=Ie.length,O=new ve($e),L=O.d=[],w=0;ke[w]==(Ie[w]||0);)++w;if(ke[w]>(Ie[w]||0)&&--v,u==null?G=u=ve.precision:d?G=u+(wo(n)-wo(o))+1:G=u,G<0)return new ve(0);if(G=G/Pa+2|0,w=0,re==1)for(S=0,ke=ke[0],G++;(w<Z||S)&&G--;w++)U=S*qo+(Ie[w]||0),L[w]=U/ke|0,S=U%ke|0;else{for(S=qo/(ke[0]+1)|0,S>1&&(ke=e(ke,S),Ie=e(Ie,S),re=ke.length,Z=Ie.length),J=re,R=Ie.slice(0,re),N=R.length;N<re;)R[N++]=0;ge=ke.slice(),ge.unshift(0),K=ke[0],ke[1]>=qo/2&&++K;do S=0,i=t(ke,R,re,N),i<0?(V=R[0],re!=N&&(V=V*qo+(R[1]||0)),S=V/K|0,S>1?(S>=qo&&(S=qo-1),C=e(ke,S),k=C.length,N=R.length,i=t(C,R,k,N),i==1&&(S--,r(C,re<k?ge:ke,k))):(S==0&&(i=S=1),C=ke.slice()),k=C.length,k<N&&C.unshift(0),r(R,C,N),i==-1&&(N=R.length,i=t(ke,R,re,N),i<1&&(S++,r(R,re<N?ge:ke,N))),N=R.length):i===0&&(S++,R=[0]),L[w++]=S,i&&R[0]?R[N++]=Ie[J]||0:(R=[Ie[J]],N=1);while((J++<Z||R[0]!==void 0)&&G--)}return L[0]||L.shift(),O.e=v,ha(O,d?u+wo(O)+1:u)}}();function dQ(e,t){var r,n,o,u,d,i,v=0,w=0,S=e.constructor,C=S.precision;if(wo(e)>16)throw Error(aN+wo(e));if(!e.s)return new S(Wl);for(t==null?(ja=!1,i=C):i=t,d=new S(.03125);e.abs().gte(.1);)e=e.times(d),w+=5;for(n=Math.log(zm(2,w))/Math.LN10*2+5|0,i+=n,r=o=u=new S(Wl),S.precision=i;;){if(o=ha(o.times(e),i),r=r.times(++v),d=u.plus(Pf(o,r,i)),_h(d.d).slice(0,i)===_h(u.d).slice(0,i)){for(;w--;)u=ha(u.times(u),i);return S.precision=C,t==null?(ja=!0,ha(u,C)):u}u=d}}function wo(e){for(var t=e.e*Pa,r=e.d[0];r>=10;r/=10)t++;return t}function $M(e,t,r){if(t>e.LN10.sd())throw ja=!0,r&&(e.precision=r),Error(Lc+"LN10 precision limit exceeded");return ha(new e(e.LN10),t)}function Wd(e){for(var t="";e--;)t+="0";return t}function Sb(e,t){var r,n,o,u,d,i,v,w,S,C=1,k=10,O=e,L=O.d,R=O.constructor,N=R.precision;if(O.s<1)throw Error(Lc+(O.s?"NaN":"-Infinity"));if(O.eq(Wl))return new R(0);if(t==null?(ja=!1,w=N):w=t,O.eq(10))return t==null&&(ja=!0),$M(R,w);if(w+=k,R.precision=w,r=_h(L),n=r.charAt(0),u=wo(O),Math.abs(u)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)O=O.times(e),r=_h(O.d),n=r.charAt(0),C++;u=wo(O),n>1?(O=new R("0."+r),u++):O=new R(n+"."+r.slice(1))}else return v=$M(R,w+2,N).times(u+""),O=Sb(new R(n+"."+r.slice(1)),w-k).plus(v),R.precision=N,t==null?(ja=!0,ha(O,N)):O;for(i=d=O=Pf(O.minus(Wl),O.plus(Wl),w),S=ha(O.times(O),w),o=3;;){if(d=ha(d.times(S),w),v=i.plus(Pf(d,new R(o),w)),_h(v.d).slice(0,w)===_h(i.d).slice(0,w))return i=i.times(2),u!==0&&(i=i.plus($M(R,w+2,N).times(u+""))),i=Pf(i,new R(C),w),R.precision=N,t==null?(ja=!0,ha(i,N)):i;i=v,o+=2}}function UV(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(n,o),t){if(o-=n,r=r-n-1,e.e=Ov(r/Pa),e.d=[],n=(r+1)%Pa,r<0&&(n+=Pa),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=Pa;n<o;)e.d.push(+t.slice(n,n+=Pa));t=t.slice(n),n=Pa-t.length}else n-=o;for(;n--;)t+="0";if(e.d.push(+t),ja&&(e.e>oC||e.e<-oC))throw Error(aN+r)}else e.s=0,e.e=0,e.d=[0];return e}function ha(e,t,r){var n,o,u,d,i,v,w,S,C=e.d;for(d=1,u=C[0];u>=10;u/=10)d++;if(n=t-d,n<0)n+=Pa,o=t,w=C[S=0];else{if(S=Math.ceil((n+1)/Pa),u=C.length,S>=u)return e;for(w=u=C[S],d=1;u>=10;u/=10)d++;n%=Pa,o=n-Pa+d}if(r!==void 0&&(u=zm(10,d-o-1),i=w/u%10|0,v=t<0||C[S+1]!==void 0||w%u,v=r<4?(i||v)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||v||r==6&&(n>0?o>0?w/zm(10,d-o):0:C[S-1])%10&1||r==(e.s<0?8:7))),t<1||!C[0])return v?(u=wo(e),C.length=1,t=t-u-1,C[0]=zm(10,(Pa-t%Pa)%Pa),e.e=Ov(-t/Pa)||0):(C.length=1,C[0]=e.e=e.s=0),e;if(n==0?(C.length=S,u=1,S--):(C.length=S+1,u=zm(10,Pa-n),C[S]=o>0?(w/zm(10,d-o)%zm(10,o)|0)*u:0),v)for(;;)if(S==0){(C[0]+=u)==qo&&(C[0]=1,++e.e);break}else{if(C[S]+=u,C[S]!=qo)break;C[S--]=0,u=1}for(n=C.length;C[--n]===0;)C.pop();if(ja&&(e.e>oC||e.e<-oC))throw Error(aN+wo(e));return e}function pQ(e,t){var r,n,o,u,d,i,v,w,S,C,k=e.constructor,O=k.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new k(e),ja?ha(t,O):t;if(v=e.d,C=t.d,n=t.e,w=e.e,v=v.slice(),d=w-n,d){for(S=d<0,S?(r=v,d=-d,i=C.length):(r=C,n=w,i=v.length),o=Math.max(Math.ceil(O/Pa),i)+2,d>o&&(d=o,r.length=1),r.reverse(),o=d;o--;)r.push(0);r.reverse()}else{for(o=v.length,i=C.length,S=o<i,S&&(i=o),o=0;o<i;o++)if(v[o]!=C[o]){S=v[o]<C[o];break}d=0}for(S&&(r=v,v=C,C=r,t.s=-t.s),i=v.length,o=C.length-i;o>0;--o)v[i++]=0;for(o=C.length;o>d;){if(v[--o]<C[o]){for(u=o;u&&v[--u]===0;)v[u]=qo-1;--v[u],v[o]+=qo}v[o]-=C[o]}for(;v[--i]===0;)v.pop();for(;v[0]===0;v.shift())--n;return v[0]?(t.d=v,t.e=n,ja?ha(t,O):t):new k(0)}function I0(e,t,r){var n,o=wo(e),u=_h(e.d),d=u.length;return t?(r&&(n=r-d)>0?u=u.charAt(0)+"."+u.slice(1)+Wd(n):d>1&&(u=u.charAt(0)+"."+u.slice(1)),u=u+(o<0?"e":"e+")+o):o<0?(u="0."+Wd(-o-1)+u,r&&(n=r-d)>0&&(u+=Wd(n))):o>=d?(u+=Wd(o+1-d),r&&(n=r-o-1)>0&&(u=u+"."+Wd(n))):((n=o+1)<d&&(u=u.slice(0,n)+"."+u.slice(n)),r&&(n=r-d)>0&&(o+1===d&&(u+="."),u+=Wd(n))),e.s<0?"-"+u:u}function $V(e,t){if(e.length>t)return e.length=t,!0}function mQ(e){var t,r,n;function o(u){var d=this;if(!(d instanceof o))return new o(u);if(d.constructor=o,u instanceof o){d.s=u.s,d.e=u.e,d.d=(u=u.d)?u.slice():u;return}if(typeof u=="number"){if(u*0!==0)throw Error(l0+u);if(u>0)d.s=1;else if(u<0)u=-u,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(u===~~u&&u<1e7){d.e=0,d.d=[u];return}return UV(d,u.toString())}else if(typeof u!="string")throw Error(l0+u);if(u.charCodeAt(0)===45?(u=u.slice(1),d.s=-1):d.s=1,$ze.test(u))UV(d,u);else throw Error(l0+u)}if(o.prototype=cn,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=mQ,o.config=o.set=Vze,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function Vze(e){if(!e||typeof e!="object")throw Error(Lc+"Object expected");var t,r,n,o=["precision",1,kv,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((n=e[r=o[t]])!==void 0)if(Ov(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(l0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(l0+r+": "+n);return this}var oN=mQ(Uze);Wl=new oN(1);const sa=oN;function Wze(e){return Xze(e)||qze(e)||Hze(e)||Gze()}function Gze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hze(e,t){if(e){if(typeof e=="string")return nD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nD(e,t)}}function qze(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Xze(e){if(Array.isArray(e))return nD(e)}function nD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Zze=function(t){return t},gQ={"@@functional/placeholder":!0},_Q=function(t){return t===gQ},VV=function(t){return function r(){return arguments.length===0||arguments.length===1&&_Q(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},Yze=function e(t,r){return t===1?r:VV(function(){for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];var d=o.filter(function(i){return i!==gQ}).length;return d>=t?r.apply(void 0,o):e(t-d,VV(function(){for(var i=arguments.length,v=new Array(i),w=0;w<i;w++)v[w]=arguments[w];var S=o.map(function(C){return _Q(C)?v.shift():C});return r.apply(void 0,Wze(S).concat(v))}))})},iI=function(t){return Yze(t.length,t)},iD=function(t,r){for(var n=[],o=t;o<r;++o)n[o-t]=o;return n},Kze=iI(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),Jze=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return Zze;var o=r.reverse(),u=o[0],d=o.slice(1);return function(){return d.reduce(function(i,v){return v(i)},u.apply(void 0,arguments))}},aD=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},yQ=function(t){var r=null,n=null;return function(){for(var o=arguments.length,u=new Array(o),d=0;d<o;d++)u[d]=arguments[d];return r&&u.every(function(i,v){return i===r[v]})||(r=u,n=t.apply(void 0,u)),n}};function Qze(e){var t;return e===0?t=1:t=Math.floor(new sa(e).abs().log(10).toNumber())+1,t}function e5e(e,t,r){for(var n=new sa(e),o=0,u=[];n.lt(t)&&o<1e5;)u.push(n.toNumber()),n=n.add(r),o++;return u}var t5e=iI(function(e,t,r){var n=+e,o=+t;return n+r*(o-n)}),r5e=iI(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),n5e=iI(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const aI={rangeStep:e5e,getDigitCount:Qze,interpolateNumber:t5e,uninterpolateNumber:r5e,uninterpolateTruncation:n5e};function oD(e){return o5e(e)||a5e(e)||vQ(e)||i5e()}function i5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a5e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function o5e(e){if(Array.isArray(e))return sD(e)}function Eb(e,t){return c5e(e)||l5e(e,t)||vQ(e,t)||s5e()}function s5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vQ(e,t){if(e){if(typeof e=="string")return sD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sD(e,t)}}function sD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l5e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,u=void 0;try{for(var d=e[Symbol.iterator](),i;!(n=(i=d.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(v){o=!0,u=v}finally{try{!n&&d.return!=null&&d.return()}finally{if(o)throw u}}return r}}function c5e(e){if(Array.isArray(e))return e}function xQ(e){var t=Eb(e,2),r=t[0],n=t[1],o=r,u=n;return r>n&&(o=n,u=r),[o,u]}function wQ(e,t,r){if(e.lte(0))return new sa(0);var n=aI.getDigitCount(e.toNumber()),o=new sa(10).pow(n),u=e.div(o),d=n!==1?.05:.1,i=new sa(Math.ceil(u.div(d).toNumber())).add(r).mul(d),v=i.mul(o);return t?v:new sa(Math.ceil(v))}function u5e(e,t,r){var n=1,o=new sa(e);if(!o.isint()&&r){var u=Math.abs(e);u<1?(n=new sa(10).pow(aI.getDigitCount(e)-1),o=new sa(Math.floor(o.div(n).toNumber())).mul(n)):u>1&&(o=new sa(Math.floor(e)))}else e===0?o=new sa(Math.floor((t-1)/2)):r||(o=new sa(Math.floor(e)));var d=Math.floor((t-1)/2),i=Jze(Kze(function(v){return o.add(new sa(v-d).mul(n)).toNumber()}),iD);return i(0,t)}function bQ(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new sa(0),tickMin:new sa(0),tickMax:new sa(0)};var u=wQ(new sa(t).sub(e).div(r-1),n,o),d;e<=0&&t>=0?d=new sa(0):(d=new sa(e).add(t).div(2),d=d.sub(new sa(d).mod(u)));var i=Math.ceil(d.sub(e).div(u).toNumber()),v=Math.ceil(new sa(t).sub(d).div(u).toNumber()),w=i+v+1;return w>r?bQ(e,t,r,n,o+1):(w<r&&(v=t>0?v+(r-w):v,i=t>0?i:i+(r-w)),{step:u,tickMin:d.sub(new sa(i).mul(u)),tickMax:d.add(new sa(v).mul(u))})}function h5e(e){var t=Eb(e,2),r=t[0],n=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(o,2),i=xQ([r,n]),v=Eb(i,2),w=v[0],S=v[1];if(w===-1/0||S===1/0){var C=S===1/0?[w].concat(oD(iD(0,o-1).map(function(){return 1/0}))):[].concat(oD(iD(0,o-1).map(function(){return-1/0})),[S]);return r>n?aD(C):C}if(w===S)return u5e(w,o,u);var k=bQ(w,S,d,u),O=k.step,L=k.tickMin,R=k.tickMax,N=aI.rangeStep(L,R.add(new sa(.1).mul(O)),O);return r>n?aD(N):N}function f5e(e,t){var r=Eb(e,2),n=r[0],o=r[1],u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=xQ([n,o]),i=Eb(d,2),v=i[0],w=i[1];if(v===-1/0||w===1/0)return[n,o];if(v===w)return[v];var S=Math.max(t,2),C=wQ(new sa(w).sub(v).div(S-1),u,0),k=[].concat(oD(aI.rangeStep(new sa(v),new sa(w).sub(new sa(.99).mul(C)),C)),[w]);return n>o?aD(k):k}var d5e=yQ(h5e),p5e=yQ(f5e),m5e="Invariant failed";function k0(e,t){throw new Error(m5e)}var g5e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Yy(e){"@babel/helpers - typeof";return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yy(e)}function sC(){return sC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sC.apply(this,arguments)}function _5e(e,t){return w5e(e)||x5e(e,t)||v5e(e,t)||y5e()}function y5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v5e(e,t){if(e){if(typeof e=="string")return WV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WV(e,t)}}function WV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function w5e(e){if(Array.isArray(e))return e}function b5e(e,t){if(e==null)return{};var r=T5e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EQ(n.key),n)}}function A5e(e,t,r){return t&&E5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C5e(e,t,r){return t=lC(t),P5e(e,TQ()?Reflect.construct(t,r||[],lC(e).constructor):t.apply(e,r))}function P5e(e,t){if(t&&(Yy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I5e(e)}function I5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TQ=function(){return!!e})()}function lC(e){return lC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lC(e)}function k5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lD(e,t)}function lD(e,t){return lD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lD(e,t)}function SQ(e,t,r){return t=EQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EQ(e){var t=O5e(e,"string");return Yy(t)=="symbol"?t:t+""}function O5e(e,t){if(Yy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P2=function(e){function t(){return S5e(this,t),C5e(this,t,arguments)}return k5e(t,e),A5e(t,[{key:"render",value:function(){var n=this.props,o=n.offset,u=n.layout,d=n.width,i=n.dataKey,v=n.data,w=n.dataPointFormatter,S=n.xAxis,C=n.yAxis,k=b5e(n,g5e),O=Ei(k,!1);this.props.direction==="x"&&S.type!=="number"&&k0();var L=v.map(function(R){var N=w(R,i),V=N.x,G=N.y,U=N.value,J=N.errorVal;if(!J)return null;var Z=[],K,re;if(Array.isArray(J)){var ge=_5e(J,2);K=ge[0],re=ge[1]}else K=re=J;if(u==="vertical"){var ve=S.scale,$e=G+o,Ie=$e+d,ke=$e-d,tt=ve(U-K),Je=ve(U+re);Z.push({x1:Je,y1:Ie,x2:Je,y2:ke}),Z.push({x1:tt,y1:$e,x2:Je,y2:$e}),Z.push({x1:tt,y1:Ie,x2:tt,y2:ke})}else if(u==="horizontal"){var et=C.scale,at=V+o,pt=at-d,ft=at+d,Ue=et(U-K),It=et(U+re);Z.push({x1:pt,y1:It,x2:ft,y2:It}),Z.push({x1:at,y1:Ue,x2:at,y2:It}),Z.push({x1:pt,y1:Ue,x2:ft,y2:Ue})}return it.createElement(lo,sC({className:"recharts-errorBar",key:"bar-".concat(Z.map(function(Rt){return"".concat(Rt.x1,"-").concat(Rt.x2,"-").concat(Rt.y1,"-").concat(Rt.y2)}))},O),Z.map(function(Rt){return it.createElement("line",sC({},Rt,{key:"line-".concat(Rt.x1,"-").concat(Rt.x2,"-").concat(Rt.y1,"-").concat(Rt.y2)}))}))});return it.createElement(lo,{className:"recharts-errorBars"},L)}}])}(it.Component);SQ(P2,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});SQ(P2,"displayName","ErrorBar");function Ab(e){"@babel/helpers - typeof";return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function GV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GV(Object(r),!0).forEach(function(n){M5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M5e(e,t,r){return t=R5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R5e(e){var t=D5e(e,"string");return Ab(t)=="symbol"?t:t+""}function D5e(e,t){if(Ab(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ab(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AQ=function(t){var r=t.children,n=t.formattedGraphicalItems,o=t.legendWidth,u=t.legendContent,d=zl(r,_p);if(!d)return null;var i=_p.defaultProps,v=i!==void 0?Dm(Dm({},i),d.props):{},w;return d.props&&d.props.payload?w=d.props&&d.props.payload:u==="children"?w=(n||[]).reduce(function(S,C){var k=C.item,O=C.props,L=O.sectors||O.data||[];return S.concat(L.map(function(R){return{type:d.props.iconType||k.props.legendType,value:R.name,color:R.fill,payload:R}}))},[]):w=(n||[]).map(function(S){var C=S.item,k=C.type.defaultProps,O=k!==void 0?Dm(Dm({},k),C.props):{},L=O.dataKey,R=O.name,N=O.legendType,V=O.hide;return{inactive:V,dataKey:L,type:v.iconType||N||"square",color:sN(C),value:R||L,payload:O}}),Dm(Dm(Dm({},v),_p.getWithHeight(d,o)),{},{payload:w,item:d})};function Cb(e){"@babel/helpers - typeof";return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(e)}function HV(e){return B5e(e)||N5e(e)||L5e(e)||F5e()}function F5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L5e(e,t){if(e){if(typeof e=="string")return cD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cD(e,t)}}function N5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B5e(e){if(Array.isArray(e))return cD(e)}function cD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qV(Object(r),!0).forEach(function(n){yy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yy(e,t,r){return t=z5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z5e(e){var t=j5e(e,"string");return Cb(t)=="symbol"?t:t+""}function j5e(e,t){if(Cb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jl(e,t,r){return gi(e)||gi(t)?r:Fo(t)?Mc(e,t,r):ai(t)?t(e):r}function Pw(e,t,r,n){var o=Nze(e,function(i){return Jl(i,t)});if(r==="number"){var u=o.filter(function(i){return Ur(i)||parseFloat(i)});return u.length?[rI(u),tI(u)]:[1/0,-1/0]}var d=n?o.filter(function(i){return!gi(i)}):o;return d.map(function(i){return Fo(i)||i instanceof Date?i:""})}var U5e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,d=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(u&&u.axisType==="angleAxis"&&Math.abs(Math.abs(u.range[1]-u.range[0])-360)<=1e-6)for(var v=u.range,w=0;w<i;w++){var S=w>0?o[w-1].coordinate:o[i-1].coordinate,C=o[w].coordinate,k=w>=i-1?o[0].coordinate:o[w+1].coordinate,O=void 0;if(_u(C-S)!==_u(k-C)){var L=[];if(_u(k-C)===_u(v[1]-v[0])){O=k;var R=C+v[1]-v[0];L[0]=Math.min(R,(R+S)/2),L[1]=Math.max(R,(R+S)/2)}else{O=S;var N=k+v[1]-v[0];L[0]=Math.min(C,(N+C)/2),L[1]=Math.max(C,(N+C)/2)}var V=[Math.min(C,(O+C)/2),Math.max(C,(O+C)/2)];if(t>V[0]&&t<=V[1]||t>=L[0]&&t<=L[1]){d=o[w].index;break}}else{var G=Math.min(S,k),U=Math.max(S,k);if(t>(G+C)/2&&t<=(U+C)/2){d=o[w].index;break}}}else for(var J=0;J<i;J++)if(J===0&&t<=(n[J].coordinate+n[J+1].coordinate)/2||J>0&&J<i-1&&t>(n[J].coordinate+n[J-1].coordinate)/2&&t<=(n[J].coordinate+n[J+1].coordinate)/2||J===i-1&&t>(n[J].coordinate+n[J-1].coordinate)/2){d=n[J].index;break}return d},sN=function(t){var r,n=t,o=n.type.displayName,u=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Ja(Ja({},t.type.defaultProps),t.props):t.props,d=u.stroke,i=u.fill,v;switch(o){case"Line":v=d;break;case"Area":case"Radar":v=d&&d!=="none"?d:i;break;default:v=i;break}return v},$5e=function(t){var r=t.barSize,n=t.totalSize,o=t.stackGroups,u=o===void 0?{}:o;if(!u)return{};for(var d={},i=Object.keys(u),v=0,w=i.length;v<w;v++)for(var S=u[i[v]].stackGroups,C=Object.keys(S),k=0,O=C.length;k<O;k++){var L=S[C[k]],R=L.items,N=L.cateAxisId,V=R.filter(function(re){return Ef(re.type).indexOf("Bar")>=0});if(V&&V.length){var G=V[0].type.defaultProps,U=G!==void 0?Ja(Ja({},G),V[0].props):V[0].props,J=U.barSize,Z=U[N];d[Z]||(d[Z]=[]);var K=gi(J)?r:J;d[Z].push({item:V[0],stackList:V.slice(1),barSize:gi(K)?void 0:P0(K,n,0)})}}return d},V5e=function(t){var r=t.barGap,n=t.barCategoryGap,o=t.bandSize,u=t.sizeList,d=u===void 0?[]:u,i=t.maxBarSize,v=d.length;if(v<1)return null;var w=P0(r,o,0,!0),S,C=[];if(d[0].barSize===+d[0].barSize){var k=!1,O=o/v,L=d.reduce(function(J,Z){return J+Z.barSize||0},0);L+=(v-1)*w,L>=o&&(L-=(v-1)*w,w=0),L>=o&&O>0&&(k=!0,O*=.9,L=v*O);var R=(o-L)/2>>0,N={offset:R-w,size:0};S=d.reduce(function(J,Z){var K={item:Z.item,position:{offset:N.offset+N.size+w,size:k?O:Z.barSize}},re=[].concat(HV(J),[K]);return N=re[re.length-1].position,Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ge){re.push({item:ge,position:N})}),re},C)}else{var V=P0(n,o,0,!0);o-2*V-(v-1)*w<=0&&(w=0);var G=(o-2*V-(v-1)*w)/v;G>1&&(G>>=0);var U=i===+i?Math.min(G,i):G;S=d.reduce(function(J,Z,K){var re=[].concat(HV(J),[{item:Z.item,position:{offset:V+(G+w)*K+(G-U)/2,size:U}}]);return Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ge){re.push({item:ge,position:re[re.length-1].position})}),re},C)}return S},W5e=function(t,r,n,o){var u=n.children,d=n.width,i=n.margin,v=d-(i.left||0)-(i.right||0),w=AQ({children:u,legendWidth:v});if(w){var S=o||{},C=S.width,k=S.height,O=w.align,L=w.verticalAlign,R=w.layout;if((R==="vertical"||R==="horizontal"&&L==="middle")&&O!=="center"&&Ur(t[O]))return Ja(Ja({},t),{},yy({},O,t[O]+(C||0)));if((R==="horizontal"||R==="vertical"&&O==="center")&&L!=="middle"&&Ur(t[L]))return Ja(Ja({},t),{},yy({},L,t[L]+(k||0)))}return t},G5e=function(t,r,n){return gi(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},CQ=function(t,r,n,o,u){var d=r.props.children,i=Rc(d,P2).filter(function(w){return G5e(o,u,w.props.direction)});if(i&&i.length){var v=i.map(function(w){return w.props.dataKey});return t.reduce(function(w,S){var C=Jl(S,n);if(gi(C))return w;var k=Array.isArray(C)?[rI(C),tI(C)]:[C,C],O=v.reduce(function(L,R){var N=Jl(S,R,0),V=k[0]-Math.abs(Array.isArray(N)?N[0]:N),G=k[1]+Math.abs(Array.isArray(N)?N[1]:N);return[Math.min(V,L[0]),Math.max(G,L[1])]},[1/0,-1/0]);return[Math.min(O[0],w[0]),Math.max(O[1],w[1])]},[1/0,-1/0])}return null},H5e=function(t,r,n,o,u){var d=r.map(function(i){return CQ(t,i,n,u,o)}).filter(function(i){return!gi(i)});return d&&d.length?d.reduce(function(i,v){return[Math.min(i[0],v[0]),Math.max(i[1],v[1])]},[1/0,-1/0]):null},PQ=function(t,r,n,o,u){var d=r.map(function(v){var w=v.props.dataKey;return n==="number"&&w&&CQ(t,v,w,o)||Pw(t,w,n,u)});if(n==="number")return d.reduce(function(v,w){return[Math.min(v[0],w[0]),Math.max(v[1],w[1])]},[1/0,-1/0]);var i={};return d.reduce(function(v,w){for(var S=0,C=w.length;S<C;S++)i[w[S]]||(i[w[S]]=!0,v.push(w[S]));return v},[])},IQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},kQ=function(t,r,n,o){if(o)return t.map(function(v){return v.coordinate});var u,d,i=t.map(function(v){return v.coordinate===r&&(u=!0),v.coordinate===n&&(d=!0),v.coordinate});return u||i.push(r),d||i.push(n),i},wf=function(t,r,n){if(!t)return null;var o=t.scale,u=t.duplicateDomain,d=t.type,i=t.range,v=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,w=(r||n)&&d==="category"&&o.bandwidth?o.bandwidth()/v:0;if(w=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?_u(i[0]-i[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var S=(t.ticks||t.niceTicks).map(function(C){var k=u?u.indexOf(C):C;return{coordinate:o(k)+w,value:C,offset:w}});return S.filter(function(C){return!w2(C.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(C,k){return{coordinate:o(C)+w,value:C,index:k,offset:w}}):o.ticks&&!n?o.ticks(t.tickCount).map(function(C){return{coordinate:o(C)+w,value:C,offset:w}}):o.domain().map(function(C,k){return{coordinate:o(C)+w,value:u?u[C]:C,index:k,offset:w}})},VM=new WeakMap,pE=function(t,r){if(typeof r!="function")return t;VM.has(t)||VM.set(t,new WeakMap);var n=VM.get(t);if(n.has(r))return n.get(r);var o=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,o),o},q5e=function(t,r,n){var o=t.scale,u=t.type,d=t.layout,i=t.axisType;if(o==="auto")return d==="radial"&&i==="radiusAxis"?{scale:vb(),realScaleType:"band"}:d==="radial"&&i==="angleAxis"?{scale:rC(),realScaleType:"linear"}:u==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Cw(),realScaleType:"point"}:u==="category"?{scale:vb(),realScaleType:"band"}:{scale:rC(),realScaleType:"linear"};if(C0(o)){var v="scale".concat($P(o));return{scale:(jV[v]||Cw)(),realScaleType:jV[v]?v:"point"}}return ai(o)?{scale:o}:{scale:Cw(),realScaleType:"point"}},XV=1e-4,X5e=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,o=t.range(),u=Math.min(o[0],o[1])-XV,d=Math.max(o[0],o[1])+XV,i=t(r[0]),v=t(r[n-1]);(i<u||i>d||v<u||v>d)&&t.domain([r[0],r[n-1]])}},Z5e=function(t,r){if(!t)return null;for(var n=0,o=t.length;n<o;n++)if(t[n].item===r)return t[n].position;return null},Y5e=function(t,r){if(!r||r.length!==2||!Ur(r[0])||!Ur(r[1]))return t;var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]),u=[t[0],t[1]];return(!Ur(t[0])||t[0]<n)&&(u[0]=n),(!Ur(t[1])||t[1]>o)&&(u[1]=o),u[0]>o&&(u[0]=o),u[1]<n&&(u[1]=n),u},K5e=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var u=0,d=0,i=0;i<r;++i){var v=w2(t[i][n][1])?t[i][n][0]:t[i][n][1];v>=0?(t[i][n][0]=u,t[i][n][1]=u+v,u=t[i][n][1]):(t[i][n][0]=d,t[i][n][1]=d+v,d=t[i][n][1])}},J5e=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var u=0,d=0;d<r;++d){var i=w2(t[d][n][1])?t[d][n][0]:t[d][n][1];i>=0?(t[d][n][0]=u,t[d][n][1]=u+i,u=t[d][n][1]):(t[d][n][0]=0,t[d][n][1]=0)}},Q5e={sign:K5e,expand:pIe,none:$y,silhouette:mIe,wiggle:gIe,positive:J5e},e6e=function(t,r,n){var o=r.map(function(i){return i.props.dataKey}),u=Q5e[n],d=dIe().keys(o).value(function(i,v){return+Jl(i,v,0)}).order(D3).offset(u);return d(t)},t6e=function(t,r,n,o,u,d){if(!t)return null;var i=d?r.reverse():r,v={},w=i.reduce(function(C,k){var O,L=(O=k.type)!==null&&O!==void 0&&O.defaultProps?Ja(Ja({},k.type.defaultProps),k.props):k.props,R=L.stackId,N=L.hide;if(N)return C;var V=L[n],G=C[V]||{hasStack:!1,stackGroups:{}};if(Fo(R)){var U=G.stackGroups[R]||{numericAxisId:n,cateAxisId:o,items:[]};U.items.push(k),G.hasStack=!0,G.stackGroups[R]=U}else G.stackGroups[b2("_stackId_")]={numericAxisId:n,cateAxisId:o,items:[k]};return Ja(Ja({},C),{},yy({},V,G))},v),S={};return Object.keys(w).reduce(function(C,k){var O=w[k];if(O.hasStack){var L={};O.stackGroups=Object.keys(O.stackGroups).reduce(function(R,N){var V=O.stackGroups[N];return Ja(Ja({},R),{},yy({},N,{numericAxisId:n,cateAxisId:o,items:V.items,stackedData:e6e(t,V.items,u)}))},L)}return Ja(Ja({},C),{},yy({},k,O))},S)},r6e=function(t,r){var n=r.realScaleType,o=r.type,u=r.tickCount,d=r.originalDomain,i=r.allowDecimals,v=n||r.scale;if(v!=="auto"&&v!=="linear")return null;if(u&&o==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var w=t.domain();if(!w.length)return null;var S=d5e(w,u,i);return t.domain([rI(S),tI(S)]),{niceTicks:S}}if(u&&o==="number"){var C=t.domain(),k=p5e(C,u,i);return{niceTicks:k}}return null};function ZV(e){var t=e.axis,r=e.ticks,n=e.bandSize,o=e.entry,u=e.index,d=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!gi(o[t.dataKey])){var i=RA(r,"value",o[t.dataKey]);if(i)return i.coordinate+n/2}return r[u]?r[u].coordinate+n/2:null}var v=Jl(o,gi(d)?t.dataKey:d);return gi(v)?null:t.scale(v)}var YV=function(t){var r=t.axis,n=t.ticks,o=t.offset,u=t.bandSize,d=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+o:null;var v=Jl(d,r.dataKey,r.domain[i]);return gi(v)?null:r.scale(v)-u/2+o},n6e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var o=Math.min(n[0],n[1]),u=Math.max(n[0],n[1]);return o<=0&&u>=0?0:u<0?u:o}return n[0]},i6e=function(t,r){var n,o=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Ja(Ja({},t.type.defaultProps),t.props):t.props,u=o.stackId;if(Fo(u)){var d=r[u];if(d){var i=d.items.indexOf(t);return i>=0?d.stackedData[i]:null}}return null},a6e=function(t){return t.reduce(function(r,n){return[rI(n.concat([r[0]]).filter(Ur)),tI(n.concat([r[1]]).filter(Ur))]},[1/0,-1/0])},OQ=function(t,r,n){return Object.keys(t).reduce(function(o,u){var d=t[u],i=d.stackedData,v=i.reduce(function(w,S){var C=a6e(S.slice(r,n+1));return[Math.min(w[0],C[0]),Math.max(w[1],C[1])]},[1/0,-1/0]);return[Math.min(v[0],o[0]),Math.max(v[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},KV=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,JV=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,uD=function(t,r,n){if(ai(t))return t(r,n);if(!Array.isArray(t))return r;var o=[];if(Ur(t[0]))o[0]=n?t[0]:Math.min(t[0],r[0]);else if(KV.test(t[0])){var u=+KV.exec(t[0])[1];o[0]=r[0]-u}else ai(t[0])?o[0]=t[0](r[0]):o[0]=r[0];if(Ur(t[1]))o[1]=n?t[1]:Math.max(t[1],r[1]);else if(JV.test(t[1])){var d=+JV.exec(t[1])[1];o[1]=r[1]+d}else ai(t[1])?o[1]=t[1](r[1]):o[1]=r[1];return o},cC=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!n||o>0)return o}if(t&&r&&r.length>=2){for(var u=FL(r,function(C){return C.coordinate}),d=1/0,i=1,v=u.length;i<v;i++){var w=u[i],S=u[i-1];d=Math.min((w.coordinate||0)-(S.coordinate||0),d)}return d===1/0?0:d}return n?void 0:0},QV=function(t,r,n){return!t||!t.length||nI(t,Mc(n,"type.defaultProps.domain"))?r:t},MQ=function(t,r){var n=t.type.defaultProps?Ja(Ja({},t.type.defaultProps),t.props):t.props,o=n.dataKey,u=n.name,d=n.unit,i=n.formatter,v=n.tooltipType,w=n.chartType,S=n.hide;return Ja(Ja({},Ei(t,!1)),{},{dataKey:o,unit:d,formatter:i,name:u||o,color:sN(t),value:Jl(r,o),type:v,payload:r,chartType:w,hide:S})};function Pb(e){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(e)}function e7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function t7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(r),!0).forEach(function(n){o6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o6e(e,t,r){return t=s6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s6e(e){var t=l6e(e,"string");return Pb(t)=="symbol"?t:t+""}function l6e(e,t){if(Pb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uC=Math.PI/180,c6e=function(t){return t*180/Math.PI},cs=function(t,r,n,o){return{x:t+Math.cos(-uC*o)*n,y:r+Math.sin(-uC*o)*n}},u6e=function(t,r){var n=t.x,o=t.y,u=r.x,d=r.y;return Math.sqrt(Math.pow(n-u,2)+Math.pow(o-d,2))},h6e=function(t,r){var n=t.x,o=t.y,u=r.cx,d=r.cy,i=u6e({x:n,y:o},{x:u,y:d});if(i<=0)return{radius:i};var v=(n-u)/i,w=Math.acos(v);return o>d&&(w=2*Math.PI-w),{radius:i,angle:c6e(w),angleInRadian:w}},f6e=function(t){var r=t.startAngle,n=t.endAngle,o=Math.floor(r/360),u=Math.floor(n/360),d=Math.min(o,u);return{startAngle:r-d*360,endAngle:n-d*360}},d6e=function(t,r){var n=r.startAngle,o=r.endAngle,u=Math.floor(n/360),d=Math.floor(o/360),i=Math.min(u,d);return t+i*360},r7=function(t,r){var n=t.x,o=t.y,u=h6e({x:n,y:o},r),d=u.radius,i=u.angle,v=r.innerRadius,w=r.outerRadius;if(d<v||d>w)return!1;if(d===0)return!0;var S=f6e(r),C=S.startAngle,k=S.endAngle,O=i,L;if(C<=k){for(;O>k;)O-=360;for(;O<C;)O+=360;L=O>=C&&O<=k}else{for(;O>C;)O-=360;for(;O<k;)O+=360;L=O>=k&&O<=C}return L?t7(t7({},r),{},{radius:d,angle:d6e(O,r)}):null};function Ib(e){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}var p6e=["offset"];function m6e(e){return v6e(e)||y6e(e)||_6e(e)||g6e()}function g6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _6e(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function y6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v6e(e){if(Array.isArray(e))return hD(e)}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x6e(e,t){if(e==null)return{};var r=w6e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function w6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function n7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n7(Object(r),!0).forEach(function(n){b6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b6e(e,t,r){return t=T6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T6e(e){var t=S6e(e,"string");return Ib(t)=="symbol"?t:t+""}function S6e(e,t){if(Ib(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ib(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kb.apply(this,arguments)}var E6e=function(t){var r=t.value,n=t.formatter,o=gi(t.children)?r:t.children;return ai(n)?n(o):o},A6e=function(t,r){var n=_u(r-t),o=Math.min(Math.abs(r-t),360);return n*o},C6e=function(t,r,n){var o=t.position,u=t.viewBox,d=t.offset,i=t.className,v=u,w=v.cx,S=v.cy,C=v.innerRadius,k=v.outerRadius,O=v.startAngle,L=v.endAngle,R=v.clockWise,N=(C+k)/2,V=A6e(O,L),G=V>=0?1:-1,U,J;o==="insideStart"?(U=O+G*d,J=R):o==="insideEnd"?(U=L-G*d,J=!R):o==="end"&&(U=L+G*d,J=R),J=V<=0?J:!J;var Z=cs(w,S,N,U),K=cs(w,S,N,U+(J?1:-1)*359),re="M".concat(Z.x,",").concat(Z.y,`
    A`).concat(N,",").concat(N,",0,1,").concat(J?0:1,`,
    `).concat(K.x,",").concat(K.y),ge=gi(t.id)?b2("recharts-radial-line-"):t.id;return it.createElement("text",kb({},n,{dominantBaseline:"central",className:Ai("recharts-radial-bar-label",i)}),it.createElement("defs",null,it.createElement("path",{id:ge,d:re})),it.createElement("textPath",{xlinkHref:"#".concat(ge)},r))},P6e=function(t){var r=t.viewBox,n=t.offset,o=t.position,u=r,d=u.cx,i=u.cy,v=u.innerRadius,w=u.outerRadius,S=u.startAngle,C=u.endAngle,k=(S+C)/2;if(o==="outside"){var O=cs(d,i,w+n,k),L=O.x,R=O.y;return{x:L,y:R,textAnchor:L>=d?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:d,y:i,textAnchor:"middle",verticalAnchor:"end"};var N=(v+w)/2,V=cs(d,i,N,k),G=V.x,U=V.y;return{x:G,y:U,textAnchor:"middle",verticalAnchor:"middle"}},I6e=function(t){var r=t.viewBox,n=t.parentViewBox,o=t.offset,u=t.position,d=r,i=d.x,v=d.y,w=d.width,S=d.height,C=S>=0?1:-1,k=C*o,O=C>0?"end":"start",L=C>0?"start":"end",R=w>=0?1:-1,N=R*o,V=R>0?"end":"start",G=R>0?"start":"end";if(u==="top"){var U={x:i+w/2,y:v-C*o,textAnchor:"middle",verticalAnchor:O};return Oo(Oo({},U),n?{height:Math.max(v-n.y,0),width:w}:{})}if(u==="bottom"){var J={x:i+w/2,y:v+S+k,textAnchor:"middle",verticalAnchor:L};return Oo(Oo({},J),n?{height:Math.max(n.y+n.height-(v+S),0),width:w}:{})}if(u==="left"){var Z={x:i-N,y:v+S/2,textAnchor:V,verticalAnchor:"middle"};return Oo(Oo({},Z),n?{width:Math.max(Z.x-n.x,0),height:S}:{})}if(u==="right"){var K={x:i+w+N,y:v+S/2,textAnchor:G,verticalAnchor:"middle"};return Oo(Oo({},K),n?{width:Math.max(n.x+n.width-K.x,0),height:S}:{})}var re=n?{width:w,height:S}:{};return u==="insideLeft"?Oo({x:i+N,y:v+S/2,textAnchor:G,verticalAnchor:"middle"},re):u==="insideRight"?Oo({x:i+w-N,y:v+S/2,textAnchor:V,verticalAnchor:"middle"},re):u==="insideTop"?Oo({x:i+w/2,y:v+k,textAnchor:"middle",verticalAnchor:L},re):u==="insideBottom"?Oo({x:i+w/2,y:v+S-k,textAnchor:"middle",verticalAnchor:O},re):u==="insideTopLeft"?Oo({x:i+N,y:v+k,textAnchor:G,verticalAnchor:L},re):u==="insideTopRight"?Oo({x:i+w-N,y:v+k,textAnchor:V,verticalAnchor:L},re):u==="insideBottomLeft"?Oo({x:i+N,y:v+S-k,textAnchor:G,verticalAnchor:O},re):u==="insideBottomRight"?Oo({x:i+w-N,y:v+S-k,textAnchor:V,verticalAnchor:O},re):bv(u)&&(Ur(u.x)||Gm(u.x))&&(Ur(u.y)||Gm(u.y))?Oo({x:i+P0(u.x,w),y:v+P0(u.y,S),textAnchor:"end",verticalAnchor:"end"},re):Oo({x:i+w/2,y:v+S/2,textAnchor:"middle",verticalAnchor:"middle"},re)},k6e=function(t){return"cx"in t&&Ur(t.cx)};function Ps(e){var t=e.offset,r=t===void 0?5:t,n=x6e(e,p6e),o=Oo({offset:r},n),u=o.viewBox,d=o.position,i=o.value,v=o.children,w=o.content,S=o.className,C=S===void 0?"":S,k=o.textBreakAll;if(!u||gi(i)&&gi(v)&&!ue.isValidElement(w)&&!ai(w))return null;if(ue.isValidElement(w))return ue.cloneElement(w,o);var O;if(ai(w)){if(O=ue.createElement(w,o),ue.isValidElement(O))return O}else O=E6e(o);var L=k6e(u),R=Ei(o,!0);if(L&&(d==="insideStart"||d==="insideEnd"||d==="end"))return C6e(o,O,R);var N=L?P6e(o):I6e(o);return it.createElement(ZA,kb({className:Ai("recharts-label",C)},R,N,{breakAll:k}),O)}Ps.displayName="Label";var RQ=function(t){var r=t.cx,n=t.cy,o=t.angle,u=t.startAngle,d=t.endAngle,i=t.r,v=t.radius,w=t.innerRadius,S=t.outerRadius,C=t.x,k=t.y,O=t.top,L=t.left,R=t.width,N=t.height,V=t.clockWise,G=t.labelViewBox;if(G)return G;if(Ur(R)&&Ur(N)){if(Ur(C)&&Ur(k))return{x:C,y:k,width:R,height:N};if(Ur(O)&&Ur(L))return{x:O,y:L,width:R,height:N}}return Ur(C)&&Ur(k)?{x:C,y:k,width:0,height:0}:Ur(r)&&Ur(n)?{cx:r,cy:n,startAngle:u||o||0,endAngle:d||o||0,innerRadius:w||0,outerRadius:S||v||i||0,clockWise:V}:t.viewBox?t.viewBox:{}},O6e=function(t,r){return t?t===!0?it.createElement(Ps,{key:"label-implicit",viewBox:r}):Fo(t)?it.createElement(Ps,{key:"label-implicit",viewBox:r,value:t}):ue.isValidElement(t)?t.type===Ps?ue.cloneElement(t,{key:"label-implicit",viewBox:r}):it.createElement(Ps,{key:"label-implicit",content:t,viewBox:r}):ai(t)?it.createElement(Ps,{key:"label-implicit",content:t,viewBox:r}):bv(t)?it.createElement(Ps,kb({viewBox:r},t,{key:"label-implicit"})):null:null},M6e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var o=t.children,u=RQ(t),d=Rc(o,Ps).map(function(v,w){return ue.cloneElement(v,{viewBox:r||u,key:"label-".concat(w)})});if(!n)return d;var i=O6e(t.label,r||u);return[i].concat(m6e(d))};Ps.parseViewBox=RQ;Ps.renderCallByParent=M6e;function R6e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var D6e=R6e;const F6e=Qi(D6e);function Ob(e){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ob(e)}var L6e=["valueAccessor"],N6e=["data","dataKey","clockWise","id","textBreakAll"];function B6e(e){return $6e(e)||U6e(e)||j6e(e)||z6e()}function z6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j6e(e,t){if(e){if(typeof e=="string")return fD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fD(e,t)}}function U6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $6e(e){if(Array.isArray(e))return fD(e)}function fD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hC(){return hC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hC.apply(this,arguments)}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function a7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){V6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V6e(e,t,r){return t=W6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W6e(e){var t=G6e(e,"string");return Ob(t)=="symbol"?t:t+""}function G6e(e,t){if(Ob(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ob(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o7(e,t){if(e==null)return{};var r=H6e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function H6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var q6e=function(t){return Array.isArray(t.value)?F6e(t.value):t.value};function vp(e){var t=e.valueAccessor,r=t===void 0?q6e:t,n=o7(e,L6e),o=n.data,u=n.dataKey,d=n.clockWise,i=n.id,v=n.textBreakAll,w=o7(n,N6e);return!o||!o.length?null:it.createElement(lo,{className:"recharts-label-list"},o.map(function(S,C){var k=gi(u)?r(S,C):Jl(S&&S.payload,u),O=gi(i)?{}:{id:"".concat(i,"-").concat(C)};return it.createElement(Ps,hC({},Ei(S,!0),w,O,{parentViewBox:S.parentViewBox,value:k,textBreakAll:v,viewBox:Ps.parseViewBox(gi(d)?S:a7(a7({},S),{},{clockWise:d})),key:"label-".concat(C),index:C}))}))}vp.displayName="LabelList";function X6e(e,t){return e?e===!0?it.createElement(vp,{key:"labelList-implicit",data:t}):it.isValidElement(e)||ai(e)?it.createElement(vp,{key:"labelList-implicit",data:t,content:e}):bv(e)?it.createElement(vp,hC({data:t},e,{key:"labelList-implicit"})):null:null}function Z6e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,o=Rc(n,vp).map(function(d,i){return ue.cloneElement(d,{data:t,key:"labelList-".concat(i)})});if(!r)return o;var u=X6e(e.label,t);return[u].concat(B6e(o))}vp.renderCallByParent=Z6e;function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}function dD(){return dD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dD.apply(this,arguments)}function s7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function l7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s7(Object(r),!0).forEach(function(n){Y6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y6e(e,t,r){return t=K6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K6e(e){var t=J6e(e,"string");return Mb(t)=="symbol"?t:t+""}function J6e(e,t){if(Mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q6e=function(t,r){var n=_u(r-t),o=Math.min(Math.abs(r-t),359.999);return n*o},mE=function(t){var r=t.cx,n=t.cy,o=t.radius,u=t.angle,d=t.sign,i=t.isExternal,v=t.cornerRadius,w=t.cornerIsExternal,S=v*(i?1:-1)+o,C=Math.asin(v/S)/uC,k=w?u:u+d*C,O=cs(r,n,S,k),L=cs(r,n,o,k),R=w?u-d*C:u,N=cs(r,n,S*Math.cos(C*uC),R);return{center:O,circleTangency:L,lineTangency:N,theta:C}},DQ=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,u=t.outerRadius,d=t.startAngle,i=t.endAngle,v=Q6e(d,i),w=d+v,S=cs(r,n,u,d),C=cs(r,n,u,w),k="M ".concat(S.x,",").concat(S.y,`
    A `).concat(u,",").concat(u,`,0,
    `).concat(+(Math.abs(v)>180),",").concat(+(d>w),`,
    `).concat(C.x,",").concat(C.y,`
  `);if(o>0){var O=cs(r,n,o,d),L=cs(r,n,o,w);k+="L ".concat(L.x,",").concat(L.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(v)>180),",").concat(+(d<=w),`,
            `).concat(O.x,",").concat(O.y," Z")}else k+="L ".concat(r,",").concat(n," Z");return k},e8e=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,u=t.outerRadius,d=t.cornerRadius,i=t.forceCornerRadius,v=t.cornerIsExternal,w=t.startAngle,S=t.endAngle,C=_u(S-w),k=mE({cx:r,cy:n,radius:u,angle:w,sign:C,cornerRadius:d,cornerIsExternal:v}),O=k.circleTangency,L=k.lineTangency,R=k.theta,N=mE({cx:r,cy:n,radius:u,angle:S,sign:-C,cornerRadius:d,cornerIsExternal:v}),V=N.circleTangency,G=N.lineTangency,U=N.theta,J=v?Math.abs(w-S):Math.abs(w-S)-R-U;if(J<0)return i?"M ".concat(L.x,",").concat(L.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):DQ({cx:r,cy:n,innerRadius:o,outerRadius:u,startAngle:w,endAngle:S});var Z="M ".concat(L.x,",").concat(L.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(C<0),",").concat(O.x,",").concat(O.y,`
    A`).concat(u,",").concat(u,",0,").concat(+(J>180),",").concat(+(C<0),",").concat(V.x,",").concat(V.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(C<0),",").concat(G.x,",").concat(G.y,`
  `);if(o>0){var K=mE({cx:r,cy:n,radius:o,angle:w,sign:C,isExternal:!0,cornerRadius:d,cornerIsExternal:v}),re=K.circleTangency,ge=K.lineTangency,ve=K.theta,$e=mE({cx:r,cy:n,radius:o,angle:S,sign:-C,isExternal:!0,cornerRadius:d,cornerIsExternal:v}),Ie=$e.circleTangency,ke=$e.lineTangency,tt=$e.theta,Je=v?Math.abs(w-S):Math.abs(w-S)-ve-tt;if(Je<0&&d===0)return"".concat(Z,"L").concat(r,",").concat(n,"Z");Z+="L".concat(ke.x,",").concat(ke.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(C<0),",").concat(Ie.x,",").concat(Ie.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(Je>180),",").concat(+(C>0),",").concat(re.x,",").concat(re.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(C<0),",").concat(ge.x,",").concat(ge.y,"Z")}else Z+="L".concat(r,",").concat(n,"Z");return Z},t8e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},FQ=function(t){var r=l7(l7({},t8e),t),n=r.cx,o=r.cy,u=r.innerRadius,d=r.outerRadius,i=r.cornerRadius,v=r.forceCornerRadius,w=r.cornerIsExternal,S=r.startAngle,C=r.endAngle,k=r.className;if(d<u||S===C)return null;var O=Ai("recharts-sector",k),L=d-u,R=P0(i,L,0,!0),N;return R>0&&Math.abs(S-C)<360?N=e8e({cx:n,cy:o,innerRadius:u,outerRadius:d,cornerRadius:Math.min(R,L/2),forceCornerRadius:v,cornerIsExternal:w,startAngle:S,endAngle:C}):N=DQ({cx:n,cy:o,innerRadius:u,outerRadius:d,startAngle:S,endAngle:C}),it.createElement("path",dD({},Ei(r,!0),{className:O,d:N,role:"img"}))};function Rb(e){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function pD(){return pD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pD.apply(this,arguments)}function c7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function u7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(r),!0).forEach(function(n){r8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r8e(e,t,r){return t=n8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n8e(e){var t=i8e(e,"string");return Rb(t)=="symbol"?t:t+""}function i8e(e,t){if(Rb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h7={curveBasisClosed:rIe,curveBasisOpen:nIe,curveBasis:tIe,curveBumpX:UPe,curveBumpY:$Pe,curveLinearClosed:iIe,curveLinear:WP,curveMonotoneX:aIe,curveMonotoneY:oIe,curveNatural:sIe,curveStep:lIe,curveStepAfter:uIe,curveStepBefore:cIe},gE=function(t){return t.x===+t.x&&t.y===+t.y},G1=function(t){return t.x},H1=function(t){return t.y},a8e=function(t,r){if(ai(t))return t;var n="curve".concat($P(t));return(n==="curveMonotone"||n==="curveBump")&&r?h7["".concat(n).concat(r==="vertical"?"Y":"X")]:h7[n]||WP},o8e=function(t){var r=t.type,n=r===void 0?"linear":r,o=t.points,u=o===void 0?[]:o,d=t.baseLine,i=t.layout,v=t.connectNulls,w=v===void 0?!1:v,S=a8e(n,i),C=w?u.filter(function(R){return gE(R)}):u,k;if(Array.isArray(d)){var O=w?d.filter(function(R){return gE(R)}):d,L=C.map(function(R,N){return u7(u7({},R),{},{base:O[N]})});return i==="vertical"?k=oE().y(H1).x1(G1).x0(function(R){return R.base.x}):k=oE().x(G1).y1(H1).y0(function(R){return R.base.y}),k.defined(gE).curve(S),k(L)}return i==="vertical"&&Ur(d)?k=oE().y(H1).x1(G1).x0(d):Ur(d)?k=oE().x(G1).y1(H1).y0(d):k=FK().x(G1).y(H1),k.defined(gE).curve(S),k(C)},mD=function(t){var r=t.className,n=t.points,o=t.path,u=t.pathRef;if((!n||!n.length)&&!o)return null;var d=n&&n.length?o8e(t):o;return ue.createElement("path",pD({},Ei(t,!1),DA(t),{className:Ai("recharts-curve",r),d,ref:u}))},LQ={exports:{}},s8e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",l8e=s8e,c8e=l8e;function NQ(){}function BQ(){}BQ.resetWarningCache=NQ;var u8e=function(){function e(n,o,u,d,i,v){if(v!==c8e){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:BQ,resetWarningCache:NQ};return r.PropTypes=r,r};LQ.exports=u8e();var h8e=LQ.exports;const Vi=Qi(h8e);var f8e=Object.getOwnPropertyNames,d8e=Object.getOwnPropertySymbols,p8e=Object.prototype.hasOwnProperty;function f7(e,t){return function(n,o,u){return e(n,o,u)&&t(n,o,u)}}function _E(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var u=o.cache,d=u.get(r),i=u.get(n);if(d&&i)return d===n&&i===r;u.set(r,n),u.set(n,r);var v=e(r,n,o);return u.delete(r),u.delete(n),v}}function d7(e){return f8e(e).concat(d8e(e))}var m8e=Object.hasOwn||function(e,t){return p8e.call(e,t)};function G0(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var g8e="__v",_8e="__o",y8e="_owner",p7=Object.getOwnPropertyDescriptor,m7=Object.keys;function v8e(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function x8e(e,t){return G0(e.getTime(),t.getTime())}function w8e(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function b8e(e,t){return e===t}function g7(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),u=e.entries(),d,i,v=0;(d=u.next())&&!d.done;){for(var w=t.entries(),S=!1,C=0;(i=w.next())&&!i.done;){if(o[C]){C++;continue}var k=d.value,O=i.value;if(r.equals(k[0],O[0],v,C,e,t,r)&&r.equals(k[1],O[1],k[0],O[0],e,t,r)){S=o[C]=!0;break}C++}if(!S)return!1;v++}return!0}var T8e=G0;function S8e(e,t,r){var n=m7(e),o=n.length;if(m7(t).length!==o)return!1;for(;o-- >0;)if(!zQ(e,t,r,n[o]))return!1;return!0}function q1(e,t,r){var n=d7(e),o=n.length;if(d7(t).length!==o)return!1;for(var u,d,i;o-- >0;)if(u=n[o],!zQ(e,t,r,u)||(d=p7(e,u),i=p7(t,u),(d||i)&&(!d||!i||d.configurable!==i.configurable||d.enumerable!==i.enumerable||d.writable!==i.writable)))return!1;return!0}function E8e(e,t){return G0(e.valueOf(),t.valueOf())}function A8e(e,t){return e.source===t.source&&e.flags===t.flags}function _7(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),u=e.values(),d,i;(d=u.next())&&!d.done;){for(var v=t.values(),w=!1,S=0;(i=v.next())&&!i.done;){if(!o[S]&&r.equals(d.value,i.value,d.value,i.value,e,t,r)){w=o[S]=!0;break}S++}if(!w)return!1}return!0}function C8e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function P8e(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function zQ(e,t,r,n){return(n===y8e||n===_8e||n===g8e)&&(e.$$typeof||t.$$typeof)?!0:m8e(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var I8e="[object Arguments]",k8e="[object Boolean]",O8e="[object Date]",M8e="[object Error]",R8e="[object Map]",D8e="[object Number]",F8e="[object Object]",L8e="[object RegExp]",N8e="[object Set]",B8e="[object String]",z8e="[object URL]",j8e=Array.isArray,y7=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,v7=Object.assign,U8e=Object.prototype.toString.call.bind(Object.prototype.toString);function $8e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,o=e.areFunctionsEqual,u=e.areMapsEqual,d=e.areNumbersEqual,i=e.areObjectsEqual,v=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,S=e.areSetsEqual,C=e.areTypedArraysEqual,k=e.areUrlsEqual;return function(L,R,N){if(L===R)return!0;if(L==null||R==null)return!1;var V=typeof L;if(V!==typeof R)return!1;if(V!=="object")return V==="number"?d(L,R,N):V==="function"?o(L,R,N):!1;var G=L.constructor;if(G!==R.constructor)return!1;if(G===Object)return i(L,R,N);if(j8e(L))return t(L,R,N);if(y7!=null&&y7(L))return C(L,R,N);if(G===Date)return r(L,R,N);if(G===RegExp)return w(L,R,N);if(G===Map)return u(L,R,N);if(G===Set)return S(L,R,N);var U=U8e(L);return U===O8e?r(L,R,N):U===L8e?w(L,R,N):U===R8e?u(L,R,N):U===N8e?S(L,R,N):U===F8e?typeof L.then!="function"&&typeof R.then!="function"&&i(L,R,N):U===z8e?k(L,R,N):U===M8e?n(L,R,N):U===I8e?i(L,R,N):U===k8e||U===D8e||U===B8e?v(L,R,N):!1}}function V8e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?q1:v8e,areDatesEqual:x8e,areErrorsEqual:w8e,areFunctionsEqual:b8e,areMapsEqual:n?f7(g7,q1):g7,areNumbersEqual:T8e,areObjectsEqual:n?q1:S8e,arePrimitiveWrappersEqual:E8e,areRegExpsEqual:A8e,areSetsEqual:n?f7(_7,q1):_7,areTypedArraysEqual:n?q1:C8e,areUrlsEqual:P8e};if(r&&(o=v7({},o,r(o))),t){var u=_E(o.areArraysEqual),d=_E(o.areMapsEqual),i=_E(o.areObjectsEqual),v=_E(o.areSetsEqual);o=v7({},o,{areArraysEqual:u,areMapsEqual:d,areObjectsEqual:i,areSetsEqual:v})}return o}function W8e(e){return function(t,r,n,o,u,d,i){return e(t,r,i)}}function G8e(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,u=e.strict;if(n)return function(v,w){var S=n(),C=S.cache,k=C===void 0?t?new WeakMap:void 0:C,O=S.meta;return r(v,w,{cache:k,equals:o,meta:O,strict:u})};if(t)return function(v,w){return r(v,w,{cache:new WeakMap,equals:o,meta:void 0,strict:u})};var d={cache:void 0,equals:o,meta:void 0,strict:u};return function(v,w){return r(v,w,d)}}var H8e=$p();$p({strict:!0});$p({circular:!0});$p({circular:!0,strict:!0});$p({createInternalComparator:function(){return G0}});$p({strict:!0,createInternalComparator:function(){return G0}});$p({circular:!0,createInternalComparator:function(){return G0}});$p({circular:!0,createInternalComparator:function(){return G0},strict:!0});function $p(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,u=e.strict,d=u===void 0?!1:u,i=V8e(e),v=$8e(i),w=n?n(v):W8e(v);return G8e({circular:r,comparator:v,createState:o,equals:w,strict:d})}function q8e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function x7(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function o(u){r<0&&(r=u),u-r>t?(e(u),r=-1):q8e(o)};requestAnimationFrame(n)}function gD(e){"@babel/helpers - typeof";return gD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gD(e)}function X8e(e){return J8e(e)||K8e(e)||Y8e(e)||Z8e()}function Z8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y8e(e,t){if(e){if(typeof e=="string")return w7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w7(e,t)}}function w7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J8e(e){if(Array.isArray(e))return e}function Q8e(){var e={},t=function(){return null},r=!1,n=function o(u){if(!r){if(Array.isArray(u)){if(!u.length)return;var d=u,i=X8e(d),v=i[0],w=i.slice(1);if(typeof v=="number"){x7(o.bind(null,w),v);return}o(v),x7(o.bind(null,w));return}gD(u)==="object"&&(e=u,t(e)),typeof u=="function"&&u()}};return{stop:function(){r=!0},start:function(u){r=!1,n(u)},subscribe:function(u){return t=u,function(){t=function(){return null}}}}}function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function b7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function T7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b7(Object(r),!0).forEach(function(n){jQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jQ(e,t,r){return t=eje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eje(e){var t=tje(e,"string");return Db(t)==="symbol"?t:String(t)}function tje(e,t){if(Db(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Db(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rje=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,o){return n.filter(function(u){return o.includes(u)})})},nje=function(t){return t},ije=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Iw=function(t,r){return Object.keys(r).reduce(function(n,o){return T7(T7({},n),{},jQ({},o,t(o,r[o])))},{})},S7=function(t,r,n){return t.map(function(o){return"".concat(ije(o)," ").concat(r,"ms ").concat(n)}).join(",")};function aje(e,t){return lje(e)||sje(e,t)||UQ(e,t)||oje()}function oje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function lje(e){if(Array.isArray(e))return e}function cje(e){return fje(e)||hje(e)||UQ(e)||uje()}function uje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UQ(e,t){if(e){if(typeof e=="string")return _D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _D(e,t)}}function hje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fje(e){if(Array.isArray(e))return _D(e)}function _D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var fC=1e-4,$Q=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},VQ=function(t,r){return t.map(function(n,o){return n*Math.pow(r,o)}).reduce(function(n,o){return n+o})},E7=function(t,r){return function(n){var o=$Q(t,r);return VQ(o,n)}},dje=function(t,r){return function(n){var o=$Q(t,r),u=[].concat(cje(o.map(function(d,i){return d*i}).slice(1)),[0]);return VQ(u,n)}},A7=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0],u=r[1],d=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":o=0,u=0,d=1,i=1;break;case"ease":o=.25,u=.1,d=.25,i=1;break;case"ease-in":o=.42,u=0,d=1,i=1;break;case"ease-out":o=.42,u=0,d=.58,i=1;break;case"ease-in-out":o=0,u=0,d=.58,i=1;break;default:{var v=r[0].split("(");if(v[0]==="cubic-bezier"&&v[1].split(")")[0].split(",").length===4){var w=v[1].split(")")[0].split(",").map(function(N){return parseFloat(N)}),S=aje(w,4);o=S[0],u=S[1],d=S[2],i=S[3]}}}var C=E7(o,d),k=E7(u,i),O=dje(o,d),L=function(V){return V>1?1:V<0?0:V},R=function(V){for(var G=V>1?1:V,U=G,J=0;J<8;++J){var Z=C(U)-G,K=O(U);if(Math.abs(Z-G)<fC||K<fC)return k(U);U=L(U-Z/K)}return k(U)};return R.isStepper=!1,R},pje=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,o=t.damping,u=o===void 0?8:o,d=t.dt,i=d===void 0?17:d,v=function(S,C,k){var O=-(S-C)*n,L=k*u,R=k+(O-L)*i/1e3,N=k*i/1e3+S;return Math.abs(N-C)<fC&&Math.abs(R)<fC?[C,0]:[N,R]};return v.isStepper=!0,v.dt=i,v},mje=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return A7(o);case"spring":return pje();default:if(o.split("(")[0]==="cubic-bezier")return A7(o)}return typeof o=="function"?o:null};function Fb(e){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}function C7(e){return yje(e)||_je(e)||WQ(e)||gje()}function gje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _je(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yje(e){if(Array.isArray(e))return vD(e)}function P7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function as(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(r),!0).forEach(function(n){yD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yD(e,t,r){return t=vje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vje(e){var t=xje(e,"string");return Fb(t)==="symbol"?t:String(t)}function xje(e,t){if(Fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wje(e,t){return Sje(e)||Tje(e,t)||WQ(e,t)||bje()}function bje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WQ(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function Sje(e){if(Array.isArray(e))return e}var dC=function(t,r,n){return t+(r-t)*n},xD=function(t){var r=t.from,n=t.to;return r!==n},Eje=function e(t,r,n){var o=Iw(function(u,d){if(xD(d)){var i=t(d.from,d.to,d.velocity),v=wje(i,2),w=v[0],S=v[1];return as(as({},d),{},{from:w,velocity:S})}return d},r);return n<1?Iw(function(u,d){return xD(d)?as(as({},d),{},{velocity:dC(d.velocity,o[u].velocity,n),from:dC(d.from,o[u].from,n)}):d},r):e(t,o,n-1)};const Aje=function(e,t,r,n,o){var u=rje(e,t),d=u.reduce(function(N,V){return as(as({},N),{},yD({},V,[e[V],t[V]]))},{}),i=u.reduce(function(N,V){return as(as({},N),{},yD({},V,{from:e[V],velocity:0,to:t[V]}))},{}),v=-1,w,S,C=function(){return null},k=function(){return Iw(function(V,G){return G.from},i)},O=function(){return!Object.values(i).filter(xD).length},L=function(V){w||(w=V);var G=V-w,U=G/r.dt;i=Eje(r,i,U),o(as(as(as({},e),t),k())),w=V,O()||(v=requestAnimationFrame(C))},R=function(V){S||(S=V);var G=(V-S)/n,U=Iw(function(Z,K){return dC.apply(void 0,C7(K).concat([r(G)]))},d);if(o(as(as(as({},e),t),U)),G<1)v=requestAnimationFrame(C);else{var J=Iw(function(Z,K){return dC.apply(void 0,C7(K).concat([r(1)]))},d);o(as(as(as({},e),t),J))}};return C=r.isStepper?L:R,function(){return requestAnimationFrame(C),function(){cancelAnimationFrame(v)}}};function Ky(e){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ky(e)}var Cje=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Pje(e,t){if(e==null)return{};var r=Ije(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ije(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,u;for(u=0;u<n.length;u++)o=n[u],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function WM(e){return Rje(e)||Mje(e)||Oje(e)||kje()}function kje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oje(e,t){if(e){if(typeof e=="string")return wD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wD(e,t)}}function Mje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rje(e){if(Array.isArray(e))return wD(e)}function wD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(r),!0).forEach(function(n){ow(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ow(e,t,r){return t=GQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GQ(n.key),n)}}function Lje(e,t,r){return t&&Fje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GQ(e){var t=Nje(e,"string");return Ky(t)==="symbol"?t:String(t)}function Nje(e,t){if(Ky(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bD(e,t)}function bD(e,t){return bD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bD(e,t)}function zje(e){var t=jje();return function(){var n=pC(e),o;if(t){var u=pC(this).constructor;o=Reflect.construct(n,arguments,u)}else o=n.apply(this,arguments);return TD(this,o)}}function TD(e,t){if(t&&(Ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SD(e)}function SD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pC(e){return pC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pC(e)}var Bf=function(e){Bje(r,e);var t=zje(r);function r(n,o){var u;Dje(this,r),u=t.call(this,n,o);var d=u.props,i=d.isActive,v=d.attributeName,w=d.from,S=d.to,C=d.steps,k=d.children,O=d.duration;if(u.handleStyleChange=u.handleStyleChange.bind(SD(u)),u.changeStyle=u.changeStyle.bind(SD(u)),!i||O<=0)return u.state={style:{}},typeof k=="function"&&(u.state={style:S}),TD(u);if(C&&C.length)u.state={style:C[0].style};else if(w){if(typeof k=="function")return u.state={style:w},TD(u);u.state={style:v?ow({},v,w):w}}else u.state={style:{}};return u}return Lje(r,[{key:"componentDidMount",value:function(){var o=this.props,u=o.isActive,d=o.canBegin;this.mounted=!0,!(!u||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var u=this.props,d=u.isActive,i=u.canBegin,v=u.attributeName,w=u.shouldReAnimate,S=u.to,C=u.from,k=this.state.style;if(i){if(!d){var O={style:v?ow({},v,S):S};this.state&&k&&(v&&k[v]!==S||!v&&k!==S)&&this.setState(O);return}if(!(H8e(o.to,S)&&o.canBegin&&o.isActive)){var L=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var R=L||w?C:o.to;if(this.state&&k){var N={style:v?ow({},v,R):R};(v&&k[v]!==R||!v&&k!==R)&&this.setState(N)}this.runAnimation(nu(nu({},this.props),{},{from:R,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var u=this,d=o.from,i=o.to,v=o.duration,w=o.easing,S=o.begin,C=o.onAnimationEnd,k=o.onAnimationStart,O=Aje(d,i,mje(w),v,this.changeStyle),L=function(){u.stopJSAnimation=O()};this.manager.start([k,S,L,v,C])}},{key:"runStepAnimation",value:function(o){var u=this,d=o.steps,i=o.begin,v=o.onAnimationStart,w=d[0],S=w.style,C=w.duration,k=C===void 0?0:C,O=function(R,N,V){if(V===0)return R;var G=N.duration,U=N.easing,J=U===void 0?"ease":U,Z=N.style,K=N.properties,re=N.onAnimationEnd,ge=V>0?d[V-1]:N,ve=K||Object.keys(Z);if(typeof J=="function"||J==="spring")return[].concat(WM(R),[u.runJSAnimation.bind(u,{from:ge.style,to:Z,duration:G,easing:J}),G]);var $e=S7(ve,G,J),Ie=nu(nu(nu({},ge.style),Z),{},{transition:$e});return[].concat(WM(R),[Ie,G,re]).filter(nje)};return this.manager.start([v].concat(WM(d.reduce(O,[S,Math.max(k,i)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=Q8e());var u=o.begin,d=o.duration,i=o.attributeName,v=o.to,w=o.easing,S=o.onAnimationStart,C=o.onAnimationEnd,k=o.steps,O=o.children,L=this.manager;if(this.unSubscribe=L.subscribe(this.handleStyleChange),typeof w=="function"||typeof O=="function"||w==="spring"){this.runJSAnimation(o);return}if(k.length>1){this.runStepAnimation(o);return}var R=i?ow({},i,v):v,N=S7(Object.keys(R),d,w);L.start([S,u,nu(nu({},R),{},{transition:N}),d,C])}},{key:"render",value:function(){var o=this.props,u=o.children;o.begin;var d=o.duration;o.attributeName,o.easing;var i=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var v=Pje(o,Cje),w=ue.Children.count(u),S=this.state.style;if(typeof u=="function")return u(S);if(!i||w===0||d<=0)return u;var C=function(O){var L=O.props,R=L.style,N=R===void 0?{}:R,V=L.className,G=ue.cloneElement(O,nu(nu({},v),{},{style:nu(nu({},N),S),className:V}));return G};return w===1?C(ue.Children.only(u)):it.createElement("div",null,ue.Children.map(u,function(k){return C(k)}))}}]),r}(ue.PureComponent);Bf.displayName="Animate";Bf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Bf.propTypes={from:Vi.oneOfType([Vi.object,Vi.string]),to:Vi.oneOfType([Vi.object,Vi.string]),attributeName:Vi.string,duration:Vi.number,begin:Vi.number,easing:Vi.oneOfType([Vi.string,Vi.func]),steps:Vi.arrayOf(Vi.shape({duration:Vi.number.isRequired,style:Vi.object.isRequired,easing:Vi.oneOfType([Vi.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Vi.func]),properties:Vi.arrayOf("string"),onAnimationEnd:Vi.func})),children:Vi.oneOfType([Vi.node,Vi.func]),isActive:Vi.bool,canBegin:Vi.bool,onAnimationEnd:Vi.func,shouldReAnimate:Vi.bool,onAnimationStart:Vi.func,onAnimationReStart:Vi.func};function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function mC(){return mC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mC.apply(this,arguments)}function Uje(e,t){return Gje(e)||Wje(e,t)||Vje(e,t)||$je()}function $je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vje(e,t){if(e){if(typeof e=="string")return k7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k7(e,t)}}function k7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function Gje(e){if(Array.isArray(e))return e}function O7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function M7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(r),!0).forEach(function(n){Hje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hje(e,t,r){return t=qje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qje(e){var t=Xje(e,"string");return Lb(t)=="symbol"?t:t+""}function Xje(e,t){if(Lb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R7=function(t,r,n,o,u){var d=Math.min(Math.abs(n)/2,Math.abs(o)/2),i=o>=0?1:-1,v=n>=0?1:-1,w=o>=0&&n>=0||o<0&&n<0?1:0,S;if(d>0&&u instanceof Array){for(var C=[0,0,0,0],k=0,O=4;k<O;k++)C[k]=u[k]>d?d:u[k];S="M".concat(t,",").concat(r+i*C[0]),C[0]>0&&(S+="A ".concat(C[0],",").concat(C[0],",0,0,").concat(w,",").concat(t+v*C[0],",").concat(r)),S+="L ".concat(t+n-v*C[1],",").concat(r),C[1]>0&&(S+="A ".concat(C[1],",").concat(C[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+i*C[1])),S+="L ".concat(t+n,",").concat(r+o-i*C[2]),C[2]>0&&(S+="A ".concat(C[2],",").concat(C[2],",0,0,").concat(w,`,
        `).concat(t+n-v*C[2],",").concat(r+o)),S+="L ".concat(t+v*C[3],",").concat(r+o),C[3]>0&&(S+="A ".concat(C[3],",").concat(C[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+o-i*C[3])),S+="Z"}else if(d>0&&u===+u&&u>0){var L=Math.min(d,u);S="M ".concat(t,",").concat(r+i*L,`
            A `).concat(L,",").concat(L,",0,0,").concat(w,",").concat(t+v*L,",").concat(r,`
            L `).concat(t+n-v*L,",").concat(r,`
            A `).concat(L,",").concat(L,",0,0,").concat(w,",").concat(t+n,",").concat(r+i*L,`
            L `).concat(t+n,",").concat(r+o-i*L,`
            A `).concat(L,",").concat(L,",0,0,").concat(w,",").concat(t+n-v*L,",").concat(r+o,`
            L `).concat(t+v*L,",").concat(r+o,`
            A `).concat(L,",").concat(L,",0,0,").concat(w,",").concat(t,",").concat(r+o-i*L," Z")}else S="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(o," h ").concat(-n," Z");return S},Zje=function(t,r){if(!t||!r)return!1;var n=t.x,o=t.y,u=r.x,d=r.y,i=r.width,v=r.height;if(Math.abs(i)>0&&Math.abs(v)>0){var w=Math.min(u,u+i),S=Math.max(u,u+i),C=Math.min(d,d+v),k=Math.max(d,d+v);return n>=w&&n<=S&&o>=C&&o<=k}return!1},Yje={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},lN=function(t){var r=M7(M7({},Yje),t),n=ue.useRef(),o=ue.useState(-1),u=Uje(o,2),d=u[0],i=u[1];ue.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var J=n.current.getTotalLength();J&&i(J)}catch{}},[]);var v=r.x,w=r.y,S=r.width,C=r.height,k=r.radius,O=r.className,L=r.animationEasing,R=r.animationDuration,N=r.animationBegin,V=r.isAnimationActive,G=r.isUpdateAnimationActive;if(v!==+v||w!==+w||S!==+S||C!==+C||S===0||C===0)return null;var U=Ai("recharts-rectangle",O);return G?it.createElement(Bf,{canBegin:d>0,from:{width:S,height:C,x:v,y:w},to:{width:S,height:C,x:v,y:w},duration:R,animationEasing:L,isActive:G},function(J){var Z=J.width,K=J.height,re=J.x,ge=J.y;return it.createElement(Bf,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:N,duration:R,isActive:V,easing:L},it.createElement("path",mC({},Ei(r,!0),{className:U,d:R7(re,ge,Z,K,k),ref:n})))}):it.createElement("path",mC({},Ei(r,!0),{className:U,d:R7(v,w,S,C,k)}))};function ED(){return ED=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ED.apply(this,arguments)}var cN=function(t){var r=t.cx,n=t.cy,o=t.r,u=t.className,d=Ai("recharts-dot",u);return r===+r&&n===+n&&o===+o?ue.createElement("circle",ED({},Ei(t,!1),DA(t),{className:d,cx:r,cy:n,r:o})):null};function Nb(e){"@babel/helpers - typeof";return Nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nb(e)}var Kje=["x","y","top","left","width","height","className"];function AD(){return AD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AD.apply(this,arguments)}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jje(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){Qje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qje(e,t,r){return t=eUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eUe(e){var t=tUe(e,"string");return Nb(t)=="symbol"?t:t+""}function tUe(e,t){if(Nb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rUe(e,t){if(e==null)return{};var r=nUe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nUe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var iUe=function(t,r,n,o,u,d){return"M".concat(t,",").concat(u,"v").concat(o,"M").concat(d,",").concat(r,"h").concat(n)},aUe=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,u=o===void 0?0:o,d=t.top,i=d===void 0?0:d,v=t.left,w=v===void 0?0:v,S=t.width,C=S===void 0?0:S,k=t.height,O=k===void 0?0:k,L=t.className,R=rUe(t,Kje),N=Jje({x:n,y:u,top:i,left:w,width:C,height:O},R);return!Ur(n)||!Ur(u)||!Ur(C)||!Ur(O)||!Ur(i)||!Ur(w)?null:it.createElement("path",AD({},Ei(N,!0),{className:Ai("recharts-cross",L),d:iUe(n,u,C,O,i,w)}))},oUe=aJ,sUe=oUe(Object.getPrototypeOf,Object),lUe=sUe,cUe=Vf,uUe=lUe,hUe=Wf,fUe="[object Object]",dUe=Function.prototype,pUe=Object.prototype,HQ=dUe.toString,mUe=pUe.hasOwnProperty,gUe=HQ.call(Object);function _Ue(e){if(!hUe(e)||cUe(e)!=fUe)return!1;var t=uUe(e);if(t===null)return!0;var r=mUe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&HQ.call(r)==gUe}var yUe=_Ue;const vUe=Qi(yUe);var xUe=Vf,wUe=Wf,bUe="[object Boolean]";function TUe(e){return e===!0||e===!1||wUe(e)&&xUe(e)==bUe}var SUe=TUe;const EUe=Qi(SUe);function Bb(e){"@babel/helpers - typeof";return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function gC(){return gC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gC.apply(this,arguments)}function AUe(e,t){return kUe(e)||IUe(e,t)||PUe(e,t)||CUe()}function CUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PUe(e,t){if(e){if(typeof e=="string")return F7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F7(e,t)}}function F7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function kUe(e){if(Array.isArray(e))return e}function L7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L7(Object(r),!0).forEach(function(n){OUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OUe(e,t,r){return t=MUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MUe(e){var t=RUe(e,"string");return Bb(t)=="symbol"?t:t+""}function RUe(e,t){if(Bb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B7=function(t,r,n,o,u){var d=n-o,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-d/2,",").concat(r+u),i+="L ".concat(t+n-d/2-o,",").concat(r+u),i+="L ".concat(t,",").concat(r," Z"),i},DUe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FUe=function(t){var r=N7(N7({},DUe),t),n=ue.useRef(),o=ue.useState(-1),u=AUe(o,2),d=u[0],i=u[1];ue.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var U=n.current.getTotalLength();U&&i(U)}catch{}},[]);var v=r.x,w=r.y,S=r.upperWidth,C=r.lowerWidth,k=r.height,O=r.className,L=r.animationEasing,R=r.animationDuration,N=r.animationBegin,V=r.isUpdateAnimationActive;if(v!==+v||w!==+w||S!==+S||C!==+C||k!==+k||S===0&&C===0||k===0)return null;var G=Ai("recharts-trapezoid",O);return V?it.createElement(Bf,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:k,x:v,y:w},to:{upperWidth:S,lowerWidth:C,height:k,x:v,y:w},duration:R,animationEasing:L,isActive:V},function(U){var J=U.upperWidth,Z=U.lowerWidth,K=U.height,re=U.x,ge=U.y;return it.createElement(Bf,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:N,duration:R,easing:L},it.createElement("path",gC({},Ei(r,!0),{className:G,d:B7(re,ge,J,Z,K),ref:n})))}):it.createElement("g",null,it.createElement("path",gC({},Ei(r,!0),{className:G,d:B7(v,w,S,C,k)})))},LUe=["option","shapeType","propTransformer","activeClassName","isActive"];function zb(e){"@babel/helpers - typeof";return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function NUe(e,t){if(e==null)return{};var r=BUe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BUe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _C(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(r),!0).forEach(function(n){zUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zUe(e,t,r){return t=jUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jUe(e){var t=UUe(e,"string");return zb(t)=="symbol"?t:t+""}function UUe(e,t){if(zb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ue(e,t){return _C(_C({},t),e)}function VUe(e,t){return e==="symbols"}function j7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return it.createElement(lN,r);case"trapezoid":return it.createElement(FUe,r);case"sector":return it.createElement(FQ,r);case"symbols":if(VUe(t))return it.createElement(CL,r);break;default:return null}}function WUe(e){return ue.isValidElement(e)?e.props:e}function GUe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,o=n===void 0?$Ue:n,u=e.activeClassName,d=u===void 0?"recharts-active-shape":u,i=e.isActive,v=NUe(e,LUe),w;if(ue.isValidElement(t))w=ue.cloneElement(t,_C(_C({},v),WUe(t)));else if(ai(t))w=t(v);else if(vUe(t)&&!EUe(t)){var S=o(t,v);w=it.createElement(j7,{shapeType:r,elementProps:S})}else{var C=v;w=it.createElement(j7,{shapeType:r,elementProps:C})}return i?it.createElement(lo,{className:d},w):w}function oI(e,t){return t!=null&&"trapezoids"in e.props}function sI(e,t){return t!=null&&"sectors"in e.props}function jb(e,t){return t!=null&&"points"in e.props}function HUe(e,t){var r,n,o=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,u=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return o&&u}function qUe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function XUe(e,t){var r=e.x===t.x,n=e.y===t.y,o=e.z===t.z;return r&&n&&o}function ZUe(e,t){var r;return oI(e,t)?r=HUe:sI(e,t)?r=qUe:jb(e,t)&&(r=XUe),r}function YUe(e,t){var r;return oI(e,t)?r="trapezoids":sI(e,t)?r="sectors":jb(e,t)&&(r="points"),r}function KUe(e,t){if(oI(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(sI(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return jb(e,t)?t.payload:{}}function JUe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,o=YUe(r,t),u=KUe(r,t),d=n.filter(function(v,w){var S=nI(u,v),C=r.props[o].filter(function(L){var R=ZUe(r,t);return R(L,t)}),k=r.props[o].indexOf(C[C.length-1]),O=w===k;return S&&O}),i=n.indexOf(d[d.length-1]);return i}var QUe=Math.ceil,e$e=Math.max;function t$e(e,t,r,n){for(var o=-1,u=e$e(QUe((t-e)/(r||1)),0),d=Array(u);u--;)d[n?u:++o]=e,e+=r;return d}var r$e=t$e,n$e=SJ,U7=1/0,i$e=17976931348623157e292;function a$e(e){if(!e)return e===0?e:0;if(e=n$e(e),e===U7||e===-U7){var t=e<0?-1:1;return t*i$e}return e===e?e:0}var qQ=a$e,o$e=r$e,s$e=XP,GM=qQ;function l$e(e){return function(t,r,n){return n&&typeof n!="number"&&s$e(t,r,n)&&(r=n=void 0),t=GM(t),r===void 0?(r=t,t=0):r=GM(r),n=n===void 0?t<r?1:-1:GM(n),o$e(t,r,n,e)}}var c$e=l$e,u$e=c$e,h$e=u$e(),f$e=h$e;const yC=Qi(f$e);function Ub(e){"@babel/helpers - typeof";return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ub(e)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function V7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){XQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XQ(e,t,r){return t=d$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d$e(e){var t=p$e(e,"string");return Ub(t)=="symbol"?t:t+""}function p$e(e,t){if(Ub(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ub(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m$e=["Webkit","Moz","O","ms"],g$e=function(t,r){var n=t.replace(/(\w)/,function(u){return u.toUpperCase()}),o=m$e.reduce(function(u,d){return V7(V7({},u),{},XQ({},d+n,r))},{});return o[t]=r,o};function Jy(e){"@babel/helpers - typeof";return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jy(e)}function vC(){return vC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vC.apply(this,arguments)}function W7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function HM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(r),!0).forEach(function(n){Nl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YQ(n.key),n)}}function y$e(e,t,r){return t&&G7(e.prototype,t),r&&G7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v$e(e,t,r){return t=xC(t),x$e(e,ZQ()?Reflect.construct(t,r||[],xC(e).constructor):t.apply(e,r))}function x$e(e,t){if(t&&(Jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w$e(e)}function w$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZQ=function(){return!!e})()}function xC(e){return xC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xC(e)}function b$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CD(e,t)}function CD(e,t){return CD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CD(e,t)}function Nl(e,t,r){return t=YQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YQ(e){var t=T$e(e,"string");return Jy(t)=="symbol"?t:t+""}function T$e(e,t){if(Jy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S$e=function(t){var r=t.data,n=t.startIndex,o=t.endIndex,u=t.x,d=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var v=r.length,w=Cw().domain(yC(0,v)).range([u,u+d-i]),S=w.domain().map(function(C){return w(C)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(o),scale:w,scaleValues:S}},H7=function(t){return t.changedTouches&&!!t.changedTouches.length},Qy=function(e){function t(r){var n;return _$e(this,t),n=v$e(this,t,[r]),Nl(n,"handleDrag",function(o){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(o):n.state.isSlideMoving&&n.handleSlideDrag(o)}),Nl(n,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&n.handleDrag(o.changedTouches[0])}),Nl(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=n.props,u=o.endIndex,d=o.onDragEnd,i=o.startIndex;d==null||d({endIndex:u,startIndex:i})}),n.detachDragEndListener()}),Nl(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Nl(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Nl(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Nl(n,"handleSlideDragStart",function(o){var u=H7(o)?o.changedTouches[0]:o;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:u.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return b$e(t,e),y$e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var o=n.startX,u=n.endX,d=this.state.scaleValues,i=this.props,v=i.gap,w=i.data,S=w.length-1,C=Math.min(o,u),k=Math.max(o,u),O=t.getIndexInRange(d,C),L=t.getIndexInRange(d,k);return{startIndex:O-O%v,endIndex:L===S?S:L-L%v}}},{key:"getTextOfTick",value:function(n){var o=this.props,u=o.data,d=o.tickFormatter,i=o.dataKey,v=Jl(u[n],i,n);return ai(d)?d(v,n):v}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var o=this.state,u=o.slideMoveStartX,d=o.startX,i=o.endX,v=this.props,w=v.x,S=v.width,C=v.travellerWidth,k=v.startIndex,O=v.endIndex,L=v.onChange,R=n.pageX-u;R>0?R=Math.min(R,w+S-C-i,w+S-C-d):R<0&&(R=Math.max(R,w-d,w-i));var N=this.getIndex({startX:d+R,endX:i+R});(N.startIndex!==k||N.endIndex!==O)&&L&&L(N),this.setState({startX:d+R,endX:i+R,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,o){var u=H7(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:u.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var o=this.state,u=o.brushMoveStartX,d=o.movingTravellerId,i=o.endX,v=o.startX,w=this.state[d],S=this.props,C=S.x,k=S.width,O=S.travellerWidth,L=S.onChange,R=S.gap,N=S.data,V={startX:this.state.startX,endX:this.state.endX},G=n.pageX-u;G>0?G=Math.min(G,C+k-O-w):G<0&&(G=Math.max(G,C-w)),V[d]=w+G;var U=this.getIndex(V),J=U.startIndex,Z=U.endIndex,K=function(){var ge=N.length-1;return d==="startX"&&(i>v?J%R===0:Z%R===0)||i<v&&Z===ge||d==="endX"&&(i>v?Z%R===0:J%R===0)||i>v&&Z===ge};this.setState(Nl(Nl({},d,w+G),"brushMoveStartX",n.pageX),function(){L&&K()&&L(U)})}},{key:"handleTravellerMoveKeyboard",value:function(n,o){var u=this,d=this.state,i=d.scaleValues,v=d.startX,w=d.endX,S=this.state[o],C=i.indexOf(S);if(C!==-1){var k=C+n;if(!(k===-1||k>=i.length)){var O=i[k];o==="startX"&&O>=w||o==="endX"&&O<=v||this.setState(Nl({},o,O),function(){u.props.onChange(u.getIndex({startX:u.state.startX,endX:u.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,o=n.x,u=n.y,d=n.width,i=n.height,v=n.fill,w=n.stroke;return it.createElement("rect",{stroke:w,fill:v,x:o,y:u,width:d,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,o=n.x,u=n.y,d=n.width,i=n.height,v=n.data,w=n.children,S=n.padding,C=ue.Children.only(w);return C?it.cloneElement(C,{x:o,y:u,width:d,height:i,margin:S,compact:!0,data:v}):null}},{key:"renderTravellerLayer",value:function(n,o){var u,d,i=this,v=this.props,w=v.y,S=v.travellerWidth,C=v.height,k=v.traveller,O=v.ariaLabel,L=v.data,R=v.startIndex,N=v.endIndex,V=Math.max(n,this.props.x),G=HM(HM({},Ei(this.props,!1)),{},{x:V,y:w,width:S,height:C}),U=O||"Min value: ".concat((u=L[R])===null||u===void 0?void 0:u.name,", Max value: ").concat((d=L[N])===null||d===void 0?void 0:d.name);return it.createElement(lo,{tabIndex:0,role:"slider","aria-label":U,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(Z){["ArrowLeft","ArrowRight"].includes(Z.key)&&(Z.preventDefault(),Z.stopPropagation(),i.handleTravellerMoveKeyboard(Z.key==="ArrowRight"?1:-1,o))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(k,G))}},{key:"renderSlide",value:function(n,o){var u=this.props,d=u.y,i=u.height,v=u.stroke,w=u.travellerWidth,S=Math.min(n,o)+w,C=Math.max(Math.abs(o-n)-w,0);return it.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:v,fillOpacity:.2,x:S,y:d,width:C,height:i})}},{key:"renderText",value:function(){var n=this.props,o=n.startIndex,u=n.endIndex,d=n.y,i=n.height,v=n.travellerWidth,w=n.stroke,S=this.state,C=S.startX,k=S.endX,O=5,L={pointerEvents:"none",fill:w};return it.createElement(lo,{className:"recharts-brush-texts"},it.createElement(ZA,vC({textAnchor:"end",verticalAnchor:"middle",x:Math.min(C,k)-O,y:d+i/2},L),this.getTextOfTick(o)),it.createElement(ZA,vC({textAnchor:"start",verticalAnchor:"middle",x:Math.max(C,k)+v+O,y:d+i/2},L),this.getTextOfTick(u)))}},{key:"render",value:function(){var n=this.props,o=n.data,u=n.className,d=n.children,i=n.x,v=n.y,w=n.width,S=n.height,C=n.alwaysShowText,k=this.state,O=k.startX,L=k.endX,R=k.isTextActive,N=k.isSlideMoving,V=k.isTravellerMoving,G=k.isTravellerFocused;if(!o||!o.length||!Ur(i)||!Ur(v)||!Ur(w)||!Ur(S)||w<=0||S<=0)return null;var U=Ai("recharts-brush",u),J=it.Children.count(d)===1,Z=g$e("userSelect","none");return it.createElement(lo,{className:U,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:Z},this.renderBackground(),J&&this.renderPanorama(),this.renderSlide(O,L),this.renderTravellerLayer(O,"startX"),this.renderTravellerLayer(L,"endX"),(R||N||V||G||C)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var o=n.x,u=n.y,d=n.width,i=n.height,v=n.stroke,w=Math.floor(u+i/2)-1;return it.createElement(it.Fragment,null,it.createElement("rect",{x:o,y:u,width:d,height:i,fill:v,stroke:"none"}),it.createElement("line",{x1:o+1,y1:w,x2:o+d-1,y2:w,fill:"none",stroke:"#fff"}),it.createElement("line",{x1:o+1,y1:w+2,x2:o+d-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,o){var u;return it.isValidElement(n)?u=it.cloneElement(n,o):ai(n)?u=n(o):u=t.renderDefaultTraveller(o),u}},{key:"getDerivedStateFromProps",value:function(n,o){var u=n.data,d=n.width,i=n.x,v=n.travellerWidth,w=n.updateId,S=n.startIndex,C=n.endIndex;if(u!==o.prevData||w!==o.prevUpdateId)return HM({prevData:u,prevTravellerWidth:v,prevUpdateId:w,prevX:i,prevWidth:d},u&&u.length?S$e({data:u,width:d,x:i,travellerWidth:v,startIndex:S,endIndex:C}):{scale:null,scaleValues:null});if(o.scale&&(d!==o.prevWidth||i!==o.prevX||v!==o.prevTravellerWidth)){o.scale.range([i,i+d-v]);var k=o.scale.domain().map(function(O){return o.scale(O)});return{prevData:u,prevTravellerWidth:v,prevUpdateId:w,prevX:i,prevWidth:d,startX:o.scale(n.startIndex),endX:o.scale(n.endIndex),scaleValues:k}}return null}},{key:"getIndexInRange",value:function(n,o){for(var u=n.length,d=0,i=u-1;i-d>1;){var v=Math.floor((d+i)/2);n[v]>o?i=v:d=v}return o>=n[i]?i:d}}])}(ue.PureComponent);Nl(Qy,"displayName","Brush");Nl(Qy,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var E$e=DL;function A$e(e,t){var r;return E$e(e,function(n,o,u){return r=t(n,o,u),!r}),!!r}var C$e=A$e,P$e=KK,I$e=zp,k$e=C$e,O$e=vl,M$e=XP;function R$e(e,t,r){var n=O$e(e)?P$e:k$e;return r&&M$e(e,t,r)&&(t=void 0),n(e,I$e(t))}var D$e=R$e;const F$e=Qi(D$e);var Th=function(t,r){var n=t.alwaysShow,o=t.ifOverflow;return n&&(o="extendDomain"),o===r},q7=vJ;function L$e(e,t,r){t=="__proto__"&&q7?q7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var N$e=L$e,B$e=N$e,z$e=_J,j$e=zp;function U$e(e,t){var r={};return t=j$e(t),z$e(e,function(n,o,u){B$e(r,o,t(n,o,u))}),r}var $$e=U$e;const V$e=Qi($$e);function W$e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var G$e=W$e,H$e=DL;function q$e(e,t){var r=!0;return H$e(e,function(n,o,u){return r=!!t(n,o,u),r}),r}var X$e=q$e,Z$e=G$e,Y$e=X$e,K$e=zp,J$e=vl,Q$e=XP;function eVe(e,t,r){var n=J$e(e)?Z$e:Y$e;return r&&Q$e(e,t,r)&&(t=void 0),n(e,K$e(t))}var tVe=eVe;const KQ=Qi(tVe);var rVe=["x","y"];function $b(e){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function PD(){return PD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PD.apply(this,arguments)}function X7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function X1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(r),!0).forEach(function(n){nVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nVe(e,t,r){return t=iVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iVe(e){var t=aVe(e,"string");return $b(t)=="symbol"?t:t+""}function aVe(e,t){if($b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($b(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oVe(e,t){if(e==null)return{};var r=sVe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function lVe(e,t){var r=e.x,n=e.y,o=oVe(e,rVe),u="".concat(r),d=parseInt(u,10),i="".concat(n),v=parseInt(i,10),w="".concat(t.height||o.height),S=parseInt(w,10),C="".concat(t.width||o.width),k=parseInt(C,10);return X1(X1(X1(X1(X1({},t),o),d?{x:d}:{}),v?{y:v}:{}),{},{height:S,width:k,name:t.name,radius:t.radius})}function Z7(e){return it.createElement(GUe,PD({shapeType:"rectangle",propTransformer:lVe,activeClassName:"recharts-active-bar"},e))}var cVe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,o){if(typeof t=="number")return t;var u=Ur(n)||ACe(n);return u?t(n,o):(u||k0(),r)}},uVe=["value","background"],JQ;function ev(e){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}function hVe(e,t){if(e==null)return{};var r=fVe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function wC(){return wC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wC.apply(this,arguments)}function Y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y7(Object(r),!0).forEach(function(n){sp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eee(n.key),n)}}function pVe(e,t,r){return t&&K7(e.prototype,t),r&&K7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mVe(e,t,r){return t=bC(t),gVe(e,QQ()?Reflect.construct(t,r||[],bC(e).constructor):t.apply(e,r))}function gVe(e,t){if(t&&(ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ve(e)}function _Ve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QQ=function(){return!!e})()}function bC(e){return bC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bC(e)}function yVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ID(e,t)}function ID(e,t){return ID=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ID(e,t)}function sp(e,t,r){return t=eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eee(e){var t=vVe(e,"string");return ev(t)=="symbol"?t:t+""}function vVe(e,t){if(ev(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ev(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H0=function(e){function t(){var r;dVe(this,t);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return r=mVe(this,t,[].concat(o)),sp(r,"state",{isAnimationFinished:!1}),sp(r,"id",b2("recharts-bar-")),sp(r,"handleAnimationEnd",function(){var d=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),d&&d()}),sp(r,"handleAnimationStart",function(){var d=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),d&&d()}),r}return yVe(t,e),pVe(t,[{key:"renderRectanglesStatically",value:function(n){var o=this,u=this.props,d=u.shape,i=u.dataKey,v=u.activeIndex,w=u.activeBar,S=Ei(this.props,!1);return n&&n.map(function(C,k){var O=k===v,L=O?w:d,R=vo(vo(vo({},S),C),{},{isActive:O,option:L,index:k,dataKey:i,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return it.createElement(lo,wC({className:"recharts-bar-rectangle"},FA(o.props,C,k),{key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value,"-").concat(k)}),it.createElement(Z7,R))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,o=this.props,u=o.data,d=o.layout,i=o.isAnimationActive,v=o.animationBegin,w=o.animationDuration,S=o.animationEasing,C=o.animationId,k=this.state.prevData;return it.createElement(Bf,{begin:v,duration:w,isActive:i,easing:S,from:{t:0},to:{t:1},key:"bar-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(O){var L=O.t,R=u.map(function(N,V){var G=k&&k[V];if(G){var U=fu(G.x,N.x),J=fu(G.y,N.y),Z=fu(G.width,N.width),K=fu(G.height,N.height);return vo(vo({},N),{},{x:U(L),y:J(L),width:Z(L),height:K(L)})}if(d==="horizontal"){var re=fu(0,N.height),ge=re(L);return vo(vo({},N),{},{y:N.y+N.height-ge,height:ge})}var ve=fu(0,N.width),$e=ve(L);return vo(vo({},N),{},{width:$e})});return it.createElement(lo,null,n.renderRectanglesStatically(R))})}},{key:"renderRectangles",value:function(){var n=this.props,o=n.data,u=n.isAnimationActive,d=this.state.prevData;return u&&o&&o.length&&(!d||!nI(d,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var n=this,o=this.props,u=o.data,d=o.dataKey,i=o.activeIndex,v=Ei(this.props.background,!1);return u.map(function(w,S){w.value;var C=w.background,k=hVe(w,uVe);if(!C)return null;var O=vo(vo(vo(vo(vo({},k),{},{fill:"#eee"},C),v),FA(n.props,w,S)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:d,index:S,className:"recharts-bar-background-rectangle"});return it.createElement(Z7,wC({key:"background-bar-".concat(S),option:n.props.background,isActive:S===i},O))})}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,d=u.data,i=u.xAxis,v=u.yAxis,w=u.layout,S=u.children,C=Rc(S,P2);if(!C)return null;var k=w==="vertical"?d[0].height/2:d[0].width/2,O=function(N,V){var G=Array.isArray(N.value)?N.value[1]:N.value;return{x:N.x,y:N.y,value:G,errorVal:Jl(N,V)}},L={clipPath:n?"url(#clipPath-".concat(o,")"):null};return it.createElement(lo,L,C.map(function(R){return it.cloneElement(R,{key:"error-bar-".concat(o,"-").concat(R.props.dataKey),data:d,xAxis:i,yAxis:v,layout:w,offset:k,dataPointFormatter:O})}))}},{key:"render",value:function(){var n=this.props,o=n.hide,u=n.data,d=n.className,i=n.xAxis,v=n.yAxis,w=n.left,S=n.top,C=n.width,k=n.height,O=n.isAnimationActive,L=n.background,R=n.id;if(o||!u||!u.length)return null;var N=this.state.isAnimationFinished,V=Ai("recharts-bar",d),G=i&&i.allowDataOverflow,U=v&&v.allowDataOverflow,J=G||U,Z=gi(R)?this.id:R;return it.createElement(lo,{className:V},G||U?it.createElement("defs",null,it.createElement("clipPath",{id:"clipPath-".concat(Z)},it.createElement("rect",{x:G?w:w-C/2,y:U?S:S-k/2,width:G?C:C*2,height:U?k:k*2}))):null,it.createElement(lo,{className:"recharts-bar-rectangles",clipPath:J?"url(#clipPath-".concat(Z,")"):null},L?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(J,Z),(!O||N)&&vp.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:o.curData}:n.data!==o.curData?{curData:n.data}:null}}])}(ue.PureComponent);JQ=H0;sp(H0,"displayName","Bar");sp(H0,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Cf.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});sp(H0,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,o=e.bandSize,u=e.xAxis,d=e.yAxis,i=e.xAxisTicks,v=e.yAxisTicks,w=e.stackedData,S=e.dataStartIndex,C=e.displayedData,k=e.offset,O=Z5e(n,r);if(!O)return null;var L=t.layout,R=r.type.defaultProps,N=R!==void 0?vo(vo({},R),r.props):r.props,V=N.dataKey,G=N.children,U=N.minPointSize,J=L==="horizontal"?d:u,Z=w?J.scale.domain():null,K=n6e({numericAxis:J}),re=Rc(G,AJ),ge=C.map(function(ve,$e){var Ie,ke,tt,Je,et,at;w?Ie=Y5e(w[S+$e],Z):(Ie=Jl(ve,V),Array.isArray(Ie)||(Ie=[K,Ie]));var pt=cVe(U,JQ.defaultProps.minPointSize)(Ie[1],$e);if(L==="horizontal"){var ft,Ue=[d.scale(Ie[0]),d.scale(Ie[1])],It=Ue[0],Rt=Ue[1];ke=YV({axis:u,ticks:i,bandSize:o,offset:O.offset,entry:ve,index:$e}),tt=(ft=Rt??It)!==null&&ft!==void 0?ft:void 0,Je=O.size;var _e=It-Rt;if(et=Number.isNaN(_e)?0:_e,at={x:ke,y:d.y,width:Je,height:d.height},Math.abs(pt)>0&&Math.abs(et)<Math.abs(pt)){var Ge=_u(et||pt)*(Math.abs(pt)-Math.abs(et));tt-=Ge,et+=Ge}}else{var qe=[u.scale(Ie[0]),u.scale(Ie[1])],Xe=qe[0],yt=qe[1];if(ke=Xe,tt=YV({axis:d,ticks:v,bandSize:o,offset:O.offset,entry:ve,index:$e}),Je=yt-Xe,et=O.size,at={x:u.x,y:tt,width:u.width,height:et},Math.abs(pt)>0&&Math.abs(Je)<Math.abs(pt)){var Dt=_u(Je||pt)*(Math.abs(pt)-Math.abs(Je));Je+=Dt}}return vo(vo(vo({},ve),{},{x:ke,y:tt,width:Je,height:et,value:w?Ie:Ie[1],payload:ve,background:at},re&&re[$e]&&re[$e].props),{},{tooltipPayload:[MQ(r,ve)],tooltipPosition:{x:ke+Je/2,y:tt+et/2}})});return vo({data:ge,layout:L},k)});function Vb(e){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function xVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tee(n.key),n)}}function wVe(e,t,r){return t&&J7(e.prototype,t),r&&J7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q7(Object(r),!0).forEach(function(n){lI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lI(e,t,r){return t=tee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tee(e){var t=bVe(e,"string");return Vb(t)=="symbol"?t:t+""}function bVe(e,t){if(Vb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ree=function(t,r,n,o,u){var d=t.width,i=t.height,v=t.layout,w=t.children,S=Object.keys(r),C={left:n.left,leftMirror:n.left,right:d-n.right,rightMirror:d-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},k=!!zl(w,H0);return S.reduce(function(O,L){var R=r[L],N=R.orientation,V=R.domain,G=R.padding,U=G===void 0?{}:G,J=R.mirror,Z=R.reversed,K="".concat(N).concat(J?"Mirror":""),re,ge,ve,$e,Ie;if(R.type==="number"&&(R.padding==="gap"||R.padding==="no-gap")){var ke=V[1]-V[0],tt=1/0,Je=R.categoricalDomain.sort(ICe);if(Je.forEach(function(qe,Xe){Xe>0&&(tt=Math.min((qe||0)-(Je[Xe-1]||0),tt))}),Number.isFinite(tt)){var et=tt/ke,at=R.layout==="vertical"?n.height:n.width;if(R.padding==="gap"&&(re=et*at/2),R.padding==="no-gap"){var pt=P0(t.barCategoryGap,et*at),ft=et*at/2;re=ft-pt-(ft-pt)/at*pt}}}o==="xAxis"?ge=[n.left+(U.left||0)+(re||0),n.left+n.width-(U.right||0)-(re||0)]:o==="yAxis"?ge=v==="horizontal"?[n.top+n.height-(U.bottom||0),n.top+(U.top||0)]:[n.top+(U.top||0)+(re||0),n.top+n.height-(U.bottom||0)-(re||0)]:ge=R.range,Z&&(ge=[ge[1],ge[0]]);var Ue=q5e(R,u,k),It=Ue.scale,Rt=Ue.realScaleType;It.domain(V).range(ge),X5e(It);var _e=r6e(It,cu(cu({},R),{},{realScaleType:Rt}));o==="xAxis"?(Ie=N==="top"&&!J||N==="bottom"&&J,ve=n.left,$e=C[K]-Ie*R.height):o==="yAxis"&&(Ie=N==="left"&&!J||N==="right"&&J,ve=C[K]-Ie*R.width,$e=n.top);var Ge=cu(cu(cu({},R),_e),{},{realScaleType:Rt,x:ve,y:$e,scale:It,width:o==="xAxis"?n.width:R.width,height:o==="yAxis"?n.height:R.height});return Ge.bandSize=cC(Ge,_e),!R.hide&&o==="xAxis"?C[K]+=(Ie?-1:1)*Ge.height:R.hide||(C[K]+=(Ie?-1:1)*Ge.width),cu(cu({},O),{},lI({},L,Ge))},{})},nee=function(t,r){var n=t.x,o=t.y,u=r.x,d=r.y;return{x:Math.min(n,u),y:Math.min(o,d),width:Math.abs(u-n),height:Math.abs(d-o)}},TVe=function(t){var r=t.x1,n=t.y1,o=t.x2,u=t.y2;return nee({x:r,y:n},{x:o,y:u})},iee=function(){function e(t){xVe(this,e),this.scale=t}return wVe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.bandAware,u=n.position;if(r!==void 0){if(u)switch(u){case"start":return this.scale(r);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+d}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(o){var v=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+v}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),o=n[0],u=n[n.length-1];return o<=u?r>=o&&r<=u:r>=u&&r<=o}}],[{key:"create",value:function(r){return new e(r)}}])}();lI(iee,"EPS",1e-4);var uN=function(t){var r=Object.keys(t).reduce(function(n,o){return cu(cu({},n),{},lI({},o,iee.create(t[o])))},{});return cu(cu({},r),{},{apply:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=u.bandAware,i=u.position;return V$e(o,function(v,w){return r[w].apply(v,{bandAware:d,position:i})})},isInRange:function(o){return KQ(o,function(u,d){return r[d].isInRange(u)})}})};function SVe(e){return(e%180+180)%180}var EVe=function(t){var r=t.width,n=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=SVe(o),d=u*Math.PI/180,i=Math.atan(n/r),v=d>i&&d<Math.PI-i?n/Math.sin(d):r/Math.cos(d);return Math.abs(v)},AVe=zp,CVe=T2,PVe=HP;function IVe(e){return function(t,r,n){var o=Object(t);if(!CVe(t)){var u=AVe(r);t=PVe(t),r=function(i){return u(o[i],i,o)}}var d=e(t,r,n);return d>-1?o[u?t[d]:d]:void 0}}var kVe=IVe,OVe=qQ;function MVe(e){var t=OVe(e),r=t%1;return t===t?r?t-r:t:0}var RVe=MVe,DVe=hJ,FVe=zp,LVe=RVe,NVe=Math.max;function BVe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:LVe(r);return o<0&&(o=NVe(n+o,0)),DVe(e,FVe(t),o)}var zVe=BVe,jVe=kVe,UVe=zVe,$Ve=jVe(UVe),VVe=$Ve;const WVe=Qi(VVe);var GVe=kAe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),hN=ue.createContext(void 0),fN=ue.createContext(void 0),aee=ue.createContext(void 0),oee=ue.createContext({}),see=ue.createContext(void 0),lee=ue.createContext(0),cee=ue.createContext(0),e9=function(t){var r=t.state,n=r.xAxisMap,o=r.yAxisMap,u=r.offset,d=t.clipPathId,i=t.children,v=t.width,w=t.height,S=GVe(u);return it.createElement(hN.Provider,{value:n},it.createElement(fN.Provider,{value:o},it.createElement(oee.Provider,{value:u},it.createElement(aee.Provider,{value:S},it.createElement(see.Provider,{value:d},it.createElement(lee.Provider,{value:w},it.createElement(cee.Provider,{value:v},i)))))))},HVe=function(){return ue.useContext(see)},uee=function(t){var r=ue.useContext(hN);r==null&&k0();var n=r[t];return n==null&&k0(),n},qVe=function(){var t=ue.useContext(hN);return qd(t)},XVe=function(){var t=ue.useContext(fN),r=WVe(t,function(n){return KQ(n.domain,Number.isFinite)});return r||qd(t)},hee=function(t){var r=ue.useContext(fN);r==null&&k0();var n=r[t];return n==null&&k0(),n},ZVe=function(){var t=ue.useContext(aee);return t},YVe=function(){return ue.useContext(oee)},dN=function(){return ue.useContext(cee)},pN=function(){return ue.useContext(lee)};function tv(e){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(e)}function KVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JVe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dee(n.key),n)}}function QVe(e,t,r){return t&&JVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function e7e(e,t,r){return t=TC(t),t7e(e,fee()?Reflect.construct(t,r||[],TC(e).constructor):t.apply(e,r))}function t7e(e,t){if(t&&(tv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r7e(e)}function r7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fee=function(){return!!e})()}function TC(e){return TC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TC(e)}function n7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kD(e,t)}function kD(e,t){return kD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kD(e,t)}function t9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function r9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t9(Object(r),!0).forEach(function(n){mN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mN(e,t,r){return t=dee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dee(e){var t=i7e(e,"string");return tv(t)=="symbol"?t:t+""}function i7e(e,t){if(tv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a7e(e,t){return c7e(e)||l7e(e,t)||s7e(e,t)||o7e()}function o7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s7e(e,t){if(e){if(typeof e=="string")return n9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n9(e,t)}}function n9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function c7e(e){if(Array.isArray(e))return e}function OD(){return OD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OD.apply(this,arguments)}var u7e=function(t,r){var n;return it.isValidElement(t)?n=it.cloneElement(t,r):ai(t)?n=t(r):n=it.createElement("line",OD({},r,{className:"recharts-reference-line-line"})),n},h7e=function(t,r,n,o,u,d,i,v,w){var S=u.x,C=u.y,k=u.width,O=u.height;if(n){var L=w.y,R=t.y.apply(L,{position:d});if(Th(w,"discard")&&!t.y.isInRange(R))return null;var N=[{x:S+k,y:R},{x:S,y:R}];return v==="left"?N.reverse():N}if(r){var V=w.x,G=t.x.apply(V,{position:d});if(Th(w,"discard")&&!t.x.isInRange(G))return null;var U=[{x:G,y:C+O},{x:G,y:C}];return i==="top"?U.reverse():U}if(o){var J=w.segment,Z=J.map(function(K){return t.apply(K,{position:d})});return Th(w,"discard")&&F$e(Z,function(K){return!t.isInRange(K)})?null:Z}return null};function f7e(e){var t=e.x,r=e.y,n=e.segment,o=e.xAxisId,u=e.yAxisId,d=e.shape,i=e.className,v=e.alwaysShow,w=HVe(),S=uee(o),C=hee(u),k=ZVe();if(!w||!k)return null;Af(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var O=uN({x:S.scale,y:C.scale}),L=Fo(t),R=Fo(r),N=n&&n.length===2,V=h7e(O,L,R,N,k,e.position,S.orientation,C.orientation,e);if(!V)return null;var G=a7e(V,2),U=G[0],J=U.x,Z=U.y,K=G[1],re=K.x,ge=K.y,ve=Th(e,"hidden")?"url(#".concat(w,")"):void 0,$e=r9(r9({clipPath:ve},Ei(e,!0)),{},{x1:J,y1:Z,x2:re,y2:ge});return it.createElement(lo,{className:Ai("recharts-reference-line",i)},u7e(d,$e),Ps.renderCallByParent(e,TVe({x1:J,y1:Z,x2:re,y2:ge})))}var gN=function(e){function t(){return KVe(this,t),e7e(this,t,arguments)}return n7e(t,e),QVe(t,[{key:"render",value:function(){return it.createElement(f7e,this.props)}}])}(it.Component);mN(gN,"displayName","ReferenceLine");mN(gN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function MD(){return MD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MD.apply(this,arguments)}function rv(e){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rv(e)}function i9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function a9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i9(Object(r),!0).forEach(function(n){cI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p7e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mee(n.key),n)}}function m7e(e,t,r){return t&&p7e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function g7e(e,t,r){return t=SC(t),_7e(e,pee()?Reflect.construct(t,r||[],SC(e).constructor):t.apply(e,r))}function _7e(e,t){if(t&&(rv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y7e(e)}function y7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pee=function(){return!!e})()}function SC(e){return SC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SC(e)}function v7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RD(e,t)}function RD(e,t){return RD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RD(e,t)}function cI(e,t,r){return t=mee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mee(e){var t=x7e(e,"string");return rv(t)=="symbol"?t:t+""}function x7e(e,t){if(rv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w7e=function(t){var r=t.x,n=t.y,o=t.xAxis,u=t.yAxis,d=uN({x:o.scale,y:u.scale}),i=d.apply({x:r,y:n},{bandAware:!0});return Th(t,"discard")&&!d.isInRange(i)?null:i},uI=function(e){function t(){return d7e(this,t),g7e(this,t,arguments)}return v7e(t,e),m7e(t,[{key:"render",value:function(){var n=this.props,o=n.x,u=n.y,d=n.r,i=n.alwaysShow,v=n.clipPathId,w=Fo(o),S=Fo(u);if(Af(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!S)return null;var C=w7e(this.props);if(!C)return null;var k=C.x,O=C.y,L=this.props,R=L.shape,N=L.className,V=Th(this.props,"hidden")?"url(#".concat(v,")"):void 0,G=a9(a9({clipPath:V},Ei(this.props,!0)),{},{cx:k,cy:O});return it.createElement(lo,{className:Ai("recharts-reference-dot",N)},t.renderDot(R,G),Ps.renderCallByParent(this.props,{x:k-d,y:O-d,width:2*d,height:2*d}))}}])}(it.Component);cI(uI,"displayName","ReferenceDot");cI(uI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});cI(uI,"renderDot",function(e,t){var r;return it.isValidElement(e)?r=it.cloneElement(e,t):ai(e)?r=e(t):r=it.createElement(cN,MD({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function DD(){return DD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DD.apply(this,arguments)}function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function o9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function s9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o9(Object(r),!0).forEach(function(n){hI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T7e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ee(n.key),n)}}function S7e(e,t,r){return t&&T7e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function E7e(e,t,r){return t=EC(t),A7e(e,gee()?Reflect.construct(t,r||[],EC(e).constructor):t.apply(e,r))}function A7e(e,t){if(t&&(nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C7e(e)}function C7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gee=function(){return!!e})()}function EC(e){return EC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},EC(e)}function P7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FD(e,t)}function FD(e,t){return FD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FD(e,t)}function hI(e,t,r){return t=_ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ee(e){var t=I7e(e,"string");return nv(t)=="symbol"?t:t+""}function I7e(e,t){if(nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k7e=function(t,r,n,o,u){var d=u.x1,i=u.x2,v=u.y1,w=u.y2,S=u.xAxis,C=u.yAxis;if(!S||!C)return null;var k=uN({x:S.scale,y:C.scale}),O={x:t?k.x.apply(d,{position:"start"}):k.x.rangeMin,y:n?k.y.apply(v,{position:"start"}):k.y.rangeMin},L={x:r?k.x.apply(i,{position:"end"}):k.x.rangeMax,y:o?k.y.apply(w,{position:"end"}):k.y.rangeMax};return Th(u,"discard")&&(!k.isInRange(O)||!k.isInRange(L))?null:nee(O,L)},fI=function(e){function t(){return b7e(this,t),E7e(this,t,arguments)}return P7e(t,e),S7e(t,[{key:"render",value:function(){var n=this.props,o=n.x1,u=n.x2,d=n.y1,i=n.y2,v=n.className,w=n.alwaysShow,S=n.clipPathId;Af(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=Fo(o),k=Fo(u),O=Fo(d),L=Fo(i),R=this.props.shape;if(!C&&!k&&!O&&!L&&!R)return null;var N=k7e(C,k,O,L,this.props);if(!N&&!R)return null;var V=Th(this.props,"hidden")?"url(#".concat(S,")"):void 0;return it.createElement(lo,{className:Ai("recharts-reference-area",v)},t.renderRect(R,s9(s9({clipPath:V},Ei(this.props,!0)),N)),Ps.renderCallByParent(this.props,N))}}])}(it.Component);hI(fI,"displayName","ReferenceArea");hI(fI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});hI(fI,"renderRect",function(e,t){var r;return it.isValidElement(e)?r=it.cloneElement(e,t):ai(e)?r=e(t):r=it.createElement(lN,DD({},t,{className:"recharts-reference-area-rect"})),r});function yee(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)n.push(e[o]);return n}function O7e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return EVe(n,r)}function M7e(e,t,r){var n=r==="width",o=e.x,u=e.y,d=e.width,i=e.height;return t===1?{start:n?o:u,end:n?o+d:u+i}:{start:n?o+d:u+i,end:n?o:u}}function AC(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var u=r();return e*(t-e*u/2-n)>=0&&e*(t+e*u/2-o)<=0}function R7e(e,t){return yee(e,t+1)}function D7e(e,t,r,n,o){for(var u=(n||[]).slice(),d=t.start,i=t.end,v=0,w=1,S=d,C=function(){var L=n==null?void 0:n[v];if(L===void 0)return{v:yee(n,w)};var R=v,N,V=function(){return N===void 0&&(N=r(L,R)),N},G=L.coordinate,U=v===0||AC(e,G,V,S,i);U||(v=0,S=d,w+=1),U&&(S=G+e*(V()/2+o),v+=w)},k;w<=u.length;)if(k=C(),k)return k.v;return[]}function Wb(e){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function l9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l9(Object(r),!0).forEach(function(n){F7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F7e(e,t,r){return t=L7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L7e(e){var t=N7e(e,"string");return Wb(t)=="symbol"?t:t+""}function N7e(e,t){if(Wb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B7e(e,t,r,n,o){for(var u=(n||[]).slice(),d=u.length,i=t.start,v=t.end,w=function(k){var O=u[k],L,R=function(){return L===void 0&&(L=r(O,k)),L};if(k===d-1){var N=e*(O.coordinate+e*R()/2-v);u[k]=O=Ts(Ts({},O),{},{tickCoord:N>0?O.coordinate-N*e:O.coordinate})}else u[k]=O=Ts(Ts({},O),{},{tickCoord:O.coordinate});var V=AC(e,O.tickCoord,R,i,v);V&&(v=O.tickCoord-e*(R()/2+o),u[k]=Ts(Ts({},O),{},{isShow:!0}))},S=d-1;S>=0;S--)w(S);return u}function z7e(e,t,r,n,o,u){var d=(n||[]).slice(),i=d.length,v=t.start,w=t.end;if(u){var S=n[i-1],C=r(S,i-1),k=e*(S.coordinate+e*C/2-w);d[i-1]=S=Ts(Ts({},S),{},{tickCoord:k>0?S.coordinate-k*e:S.coordinate});var O=AC(e,S.tickCoord,function(){return C},v,w);O&&(w=S.tickCoord-e*(C/2+o),d[i-1]=Ts(Ts({},S),{},{isShow:!0}))}for(var L=u?i-1:i,R=function(G){var U=d[G],J,Z=function(){return J===void 0&&(J=r(U,G)),J};if(G===0){var K=e*(U.coordinate-e*Z()/2-v);d[G]=U=Ts(Ts({},U),{},{tickCoord:K<0?U.coordinate-K*e:U.coordinate})}else d[G]=U=Ts(Ts({},U),{},{tickCoord:U.coordinate});var re=AC(e,U.tickCoord,Z,v,w);re&&(v=U.tickCoord+e*(Z()/2+o),d[G]=Ts(Ts({},U),{},{isShow:!0}))},N=0;N<L;N++)R(N);return d}function _N(e,t,r){var n=e.tick,o=e.ticks,u=e.viewBox,d=e.minTickGap,i=e.orientation,v=e.interval,w=e.tickFormatter,S=e.unit,C=e.angle;if(!o||!o.length||!n)return[];if(Ur(v)||Cf.isSsr)return R7e(o,typeof v=="number"&&Ur(v)?v:0);var k=[],O=i==="top"||i==="bottom"?"width":"height",L=S&&O==="width"?Aw(S,{fontSize:t,letterSpacing:r}):{width:0,height:0},R=function(U,J){var Z=ai(w)?w(U.value,J):U.value;return O==="width"?O7e(Aw(Z,{fontSize:t,letterSpacing:r}),L,C):Aw(Z,{fontSize:t,letterSpacing:r})[O]},N=o.length>=2?_u(o[1].coordinate-o[0].coordinate):1,V=M7e(u,N,O);return v==="equidistantPreserveStart"?D7e(N,V,R,o,d):(v==="preserveStart"||v==="preserveStartEnd"?k=z7e(N,V,R,o,d,v==="preserveStartEnd"):k=B7e(N,V,R,o,d),k.filter(function(G){return G.isShow}))}var j7e=["viewBox"],U7e=["viewBox"],$7e=["ticks"];function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function ey(){return ey=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ey.apply(this,arguments)}function c9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c9(Object(r),!0).forEach(function(n){yN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qM(e,t){if(e==null)return{};var r=V7e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function W7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xee(n.key),n)}}function G7e(e,t,r){return t&&u9(e.prototype,t),r&&u9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H7e(e,t,r){return t=CC(t),q7e(e,vee()?Reflect.construct(t,r||[],CC(e).constructor):t.apply(e,r))}function q7e(e,t){if(t&&(iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X7e(e)}function X7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vee=function(){return!!e})()}function CC(e){return CC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CC(e)}function Z7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LD(e,t)}function LD(e,t){return LD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LD(e,t)}function yN(e,t,r){return t=xee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xee(e){var t=Y7e(e,"string");return iv(t)=="symbol"?t:t+""}function Y7e(e,t){if(iv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=function(e){function t(r){var n;return W7e(this,t),n=H7e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return Z7e(t,e),G7e(t,[{key:"shouldComponentUpdate",value:function(n,o){var u=n.viewBox,d=qM(n,j7e),i=this.props,v=i.viewBox,w=qM(i,U7e);return!gy(u,v)||!gy(d,w)||!gy(o,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var o=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var o=this.props,u=o.x,d=o.y,i=o.width,v=o.height,w=o.orientation,S=o.tickSize,C=o.mirror,k=o.tickMargin,O,L,R,N,V,G,U=C?-1:1,J=n.tickSize||S,Z=Ur(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":O=L=n.coordinate,N=d+ +!C*v,R=N-U*J,G=R-U*k,V=Z;break;case"left":R=N=n.coordinate,L=u+ +!C*i,O=L-U*J,V=O-U*k,G=Z;break;case"right":R=N=n.coordinate,L=u+ +C*i,O=L+U*J,V=O+U*k,G=Z;break;default:O=L=n.coordinate,N=d+ +C*v,R=N+U*J,G=R+U*k,V=Z;break}return{line:{x1:O,y1:R,x2:L,y2:N},tick:{x:V,y:G}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,o=n.orientation,u=n.mirror,d;switch(o){case"left":d=u?"start":"end";break;case"right":d=u?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,o=n.orientation,u=n.mirror,d="end";switch(o){case"left":case"right":d="middle";break;case"top":d=u?"start":"end";break;default:d=u?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.x,u=n.y,d=n.width,i=n.height,v=n.orientation,w=n.mirror,S=n.axisLine,C=ko(ko(ko({},Ei(this.props,!1)),Ei(S,!1)),{},{fill:"none"});if(v==="top"||v==="bottom"){var k=+(v==="top"&&!w||v==="bottom"&&w);C=ko(ko({},C),{},{x1:o,y1:u+k*i,x2:o+d,y2:u+k*i})}else{var O=+(v==="left"&&!w||v==="right"&&w);C=ko(ko({},C),{},{x1:o+O*d,y1:u,x2:o+O*d,y2:u+i})}return it.createElement("line",ey({},C,{className:Ai("recharts-cartesian-axis-line",Mc(S,"className"))}))}},{key:"renderTicks",value:function(n,o,u){var d=this,i=this.props,v=i.tickLine,w=i.stroke,S=i.tick,C=i.tickFormatter,k=i.unit,O=_N(ko(ko({},this.props),{},{ticks:n}),o,u),L=this.getTickTextAnchor(),R=this.getTickVerticalAnchor(),N=Ei(this.props,!1),V=Ei(S,!1),G=ko(ko({},N),{},{fill:"none"},Ei(v,!1)),U=O.map(function(J,Z){var K=d.getTickLineCoord(J),re=K.line,ge=K.tick,ve=ko(ko(ko(ko({textAnchor:L,verticalAnchor:R},N),{},{stroke:"none",fill:w},V),ge),{},{index:Z,payload:J,visibleTicksCount:O.length,tickFormatter:C});return it.createElement(lo,ey({className:"recharts-cartesian-axis-tick",key:"tick-".concat(J.value,"-").concat(J.coordinate,"-").concat(J.tickCoord)},FA(d.props,J,Z)),v&&it.createElement("line",ey({},G,re,{className:Ai("recharts-cartesian-axis-tick-line",Mc(v,"className"))})),S&&t.renderTickItem(S,ve,"".concat(ai(C)?C(J.value,Z):J.value).concat(k||"")))});return it.createElement("g",{className:"recharts-cartesian-axis-ticks"},U)}},{key:"render",value:function(){var n=this,o=this.props,u=o.axisLine,d=o.width,i=o.height,v=o.ticksGenerator,w=o.className,S=o.hide;if(S)return null;var C=this.props,k=C.ticks,O=qM(C,$7e),L=k;return ai(v)&&(L=k&&k.length>0?v(this.props):v(O)),d<=0||i<=0||!L||!L.length?null:it.createElement(lo,{className:Ai("recharts-cartesian-axis",w),ref:function(N){n.layerReference=N}},u&&this.renderAxisLine(),this.renderTicks(L,this.state.fontSize,this.state.letterSpacing),Ps.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,o,u){var d,i=Ai(o.className,"recharts-cartesian-axis-tick-value");return it.isValidElement(n)?d=it.cloneElement(n,ko(ko({},o),{},{className:i})):ai(n)?d=n(ko(ko({},o),{},{className:i})):d=it.createElement(ZA,ey({},o,{className:"recharts-cartesian-axis-tick-value"}),u),d}}])}(ue.Component);yN(Mv,"displayName","CartesianAxis");yN(Mv,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var K7e=["x1","y1","x2","y2","key"],J7e=["offset"];function O0(e){"@babel/helpers - typeof";return O0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O0(e)}function h9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h9(Object(r),!0).forEach(function(n){Q7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q7e(e,t,r){return t=e9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e9e(e){var t=t9e(e,"string");return O0(t)=="symbol"?t:t+""}function t9e(e,t){if(O0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xm(){return Xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xm.apply(this,arguments)}function f9(e,t){if(e==null)return{};var r=r9e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function r9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var n9e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,o=t.x,u=t.y,d=t.width,i=t.height,v=t.ry;return it.createElement("rect",{x:o,y:u,ry:v,width:d,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function wee(e,t){var r;if(it.isValidElement(e))r=it.cloneElement(e,t);else if(ai(e))r=e(t);else{var n=t.x1,o=t.y1,u=t.x2,d=t.y2,i=t.key,v=f9(t,K7e),w=Ei(v,!1);w.offset;var S=f9(w,J7e);r=it.createElement("line",Xm({},S,{x1:n,y1:o,x2:u,y2:d,fill:"none",key:i}))}return r}function i9e(e){var t=e.x,r=e.width,n=e.horizontal,o=n===void 0?!0:n,u=e.horizontalPoints;if(!o||!u||!u.length)return null;var d=u.map(function(i,v){var w=Is(Is({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(v),index:v});return wee(o,w)});return it.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function a9e(e){var t=e.y,r=e.height,n=e.vertical,o=n===void 0?!0:n,u=e.verticalPoints;if(!o||!u||!u.length)return null;var d=u.map(function(i,v){var w=Is(Is({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(v),index:v});return wee(o,w)});return it.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function o9e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,o=e.y,u=e.width,d=e.height,i=e.horizontalPoints,v=e.horizontal,w=v===void 0?!0:v;if(!w||!t||!t.length)return null;var S=i.map(function(k){return Math.round(k+o-o)}).sort(function(k,O){return k-O});o!==S[0]&&S.unshift(0);var C=S.map(function(k,O){var L=!S[O+1],R=L?o+d-k:S[O+1]-k;if(R<=0)return null;var N=O%t.length;return it.createElement("rect",{key:"react-".concat(O),y:k,x:n,height:R,width:u,stroke:"none",fill:t[N],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return it.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},C)}function s9e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,o=e.fillOpacity,u=e.x,d=e.y,i=e.width,v=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var S=w.map(function(k){return Math.round(k+u-u)}).sort(function(k,O){return k-O});u!==S[0]&&S.unshift(0);var C=S.map(function(k,O){var L=!S[O+1],R=L?u+i-k:S[O+1]-k;if(R<=0)return null;var N=O%n.length;return it.createElement("rect",{key:"react-".concat(O),x:k,y:d,width:R,height:v,stroke:"none",fill:n[N],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return it.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},C)}var l9e=function(t,r){var n=t.xAxis,o=t.width,u=t.height,d=t.offset;return kQ(_N(Is(Is(Is({},Mv.defaultProps),n),{},{ticks:wf(n,!0),viewBox:{x:0,y:0,width:o,height:u}})),d.left,d.left+d.width,r)},c9e=function(t,r){var n=t.yAxis,o=t.width,u=t.height,d=t.offset;return kQ(_N(Is(Is(Is({},Mv.defaultProps),n),{},{ticks:wf(n,!0),viewBox:{x:0,y:0,width:o,height:u}})),d.top,d.top+d.height,r)},O_={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function zE(e){var t,r,n,o,u,d,i=dN(),v=pN(),w=YVe(),S=Is(Is({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:O_.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:O_.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:O_.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:O_.horizontalFill,vertical:(u=e.vertical)!==null&&u!==void 0?u:O_.vertical,verticalFill:(d=e.verticalFill)!==null&&d!==void 0?d:O_.verticalFill,x:Ur(e.x)?e.x:w.left,y:Ur(e.y)?e.y:w.top,width:Ur(e.width)?e.width:w.width,height:Ur(e.height)?e.height:w.height}),C=S.x,k=S.y,O=S.width,L=S.height,R=S.syncWithTicks,N=S.horizontalValues,V=S.verticalValues,G=qVe(),U=XVe();if(!Ur(O)||O<=0||!Ur(L)||L<=0||!Ur(C)||C!==+C||!Ur(k)||k!==+k)return null;var J=S.verticalCoordinatesGenerator||l9e,Z=S.horizontalCoordinatesGenerator||c9e,K=S.horizontalPoints,re=S.verticalPoints;if((!K||!K.length)&&ai(Z)){var ge=N&&N.length,ve=Z({yAxis:U?Is(Is({},U),{},{ticks:ge?N:U.ticks}):void 0,width:i,height:v,offset:w},ge?!0:R);Af(Array.isArray(ve),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(O0(ve),"]")),Array.isArray(ve)&&(K=ve)}if((!re||!re.length)&&ai(J)){var $e=V&&V.length,Ie=J({xAxis:G?Is(Is({},G),{},{ticks:$e?V:G.ticks}):void 0,width:i,height:v,offset:w},$e?!0:R);Af(Array.isArray(Ie),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(O0(Ie),"]")),Array.isArray(Ie)&&(re=Ie)}return it.createElement("g",{className:"recharts-cartesian-grid"},it.createElement(n9e,{fill:S.fill,fillOpacity:S.fillOpacity,x:S.x,y:S.y,width:S.width,height:S.height,ry:S.ry}),it.createElement(i9e,Xm({},S,{offset:w,horizontalPoints:K,xAxis:G,yAxis:U})),it.createElement(a9e,Xm({},S,{offset:w,verticalPoints:re,xAxis:G,yAxis:U})),it.createElement(o9e,Xm({},S,{horizontalPoints:K})),it.createElement(s9e,Xm({},S,{verticalPoints:re})))}zE.displayName="CartesianGrid";var u9e=["type","layout","connectNulls","ref"],h9e=["key"];function av(e){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(e)}function d9(e,t){if(e==null)return{};var r=f9e(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kw(){return kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kw.apply(this,arguments)}function p9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ll(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p9(Object(r),!0).forEach(function(n){uu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M_(e){return g9e(e)||m9e(e)||p9e(e)||d9e()}function d9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p9e(e,t){if(e){if(typeof e=="string")return ND(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ND(e,t)}}function m9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function g9e(e){if(Array.isArray(e))return ND(e)}function ND(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tee(n.key),n)}}function y9e(e,t,r){return t&&m9(e.prototype,t),r&&m9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v9e(e,t,r){return t=PC(t),x9e(e,bee()?Reflect.construct(t,r||[],PC(e).constructor):t.apply(e,r))}function x9e(e,t){if(t&&(av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w9e(e)}function w9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bee=function(){return!!e})()}function PC(e){return PC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},PC(e)}function b9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BD(e,t)}function BD(e,t){return BD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BD(e,t)}function uu(e,t,r){return t=Tee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tee(e){var t=T9e(e,"string");return av(t)=="symbol"?t:t+""}function T9e(e,t){if(av(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(av(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ov=function(e){function t(){var r;_9e(this,t);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return r=v9e(this,t,[].concat(o)),uu(r,"state",{isAnimationFinished:!0,totalLength:0}),uu(r,"generateSimpleStrokeDasharray",function(d,i){return"".concat(i,"px ").concat(d-i,"px")}),uu(r,"getStrokeDasharray",function(d,i,v){var w=v.reduce(function(V,G){return V+G});if(!w)return r.generateSimpleStrokeDasharray(i,d);for(var S=Math.floor(d/w),C=d%w,k=i-d,O=[],L=0,R=0;L<v.length;R+=v[L],++L)if(R+v[L]>C){O=[].concat(M_(v.slice(0,L)),[C-R]);break}var N=O.length%2===0?[0,k]:[k];return[].concat(M_(t.repeat(v,S)),M_(O),N).map(function(V){return"".concat(V,"px")}).join(", ")}),uu(r,"id",b2("recharts-line-")),uu(r,"pathRef",function(d){r.mainCurve=d}),uu(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),uu(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return b9e(t,e),y9e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,d=u.points,i=u.xAxis,v=u.yAxis,w=u.layout,S=u.children,C=Rc(S,P2);if(!C)return null;var k=function(R,N){return{x:R.x,y:R.y,value:R.value,errorVal:Jl(R.payload,N)}},O={clipPath:n?"url(#clipPath-".concat(o,")"):null};return it.createElement(lo,O,C.map(function(L){return it.cloneElement(L,{key:"bar-".concat(L.props.dataKey),data:d,xAxis:i,yAxis:v,layout:w,dataPointFormatter:k})}))}},{key:"renderDots",value:function(n,o,u){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var i=this.props,v=i.dot,w=i.points,S=i.dataKey,C=Ei(this.props,!1),k=Ei(v,!0),O=w.map(function(R,N){var V=Ll(Ll(Ll({key:"dot-".concat(N),r:3},C),k),{},{index:N,cx:R.x,cy:R.y,value:R.value,dataKey:S,payload:R.payload,points:w});return t.renderDotItem(v,V)}),L={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(u,")"):null};return it.createElement(lo,kw({className:"recharts-line-dots",key:"dots"},L),O)}},{key:"renderCurveStatically",value:function(n,o,u,d){var i=this.props,v=i.type,w=i.layout,S=i.connectNulls;i.ref;var C=d9(i,u9e),k=Ll(Ll(Ll({},Ei(C,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(u,")"):null,points:n},d),{},{type:v,layout:w,connectNulls:S});return it.createElement(mD,kw({},k,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,o){var u=this,d=this.props,i=d.points,v=d.strokeDasharray,w=d.isAnimationActive,S=d.animationBegin,C=d.animationDuration,k=d.animationEasing,O=d.animationId,L=d.animateNewValues,R=d.width,N=d.height,V=this.state,G=V.prevPoints,U=V.totalLength;return it.createElement(Bf,{begin:S,duration:C,isActive:w,easing:k,from:{t:0},to:{t:1},key:"line-".concat(O),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(J){var Z=J.t;if(G){var K=G.length/i.length,re=i.map(function(ke,tt){var Je=Math.floor(tt*K);if(G[Je]){var et=G[Je],at=fu(et.x,ke.x),pt=fu(et.y,ke.y);return Ll(Ll({},ke),{},{x:at(Z),y:pt(Z)})}if(L){var ft=fu(R*2,ke.x),Ue=fu(N/2,ke.y);return Ll(Ll({},ke),{},{x:ft(Z),y:Ue(Z)})}return Ll(Ll({},ke),{},{x:ke.x,y:ke.y})});return u.renderCurveStatically(re,n,o)}var ge=fu(0,U),ve=ge(Z),$e;if(v){var Ie="".concat(v).split(/[,\s]+/gim).map(function(ke){return parseFloat(ke)});$e=u.getStrokeDasharray(ve,U,Ie)}else $e=u.generateSimpleStrokeDasharray(U,ve);return u.renderCurveStatically(i,n,o,{strokeDasharray:$e})})}},{key:"renderCurve",value:function(n,o){var u=this.props,d=u.points,i=u.isAnimationActive,v=this.state,w=v.prevPoints,S=v.totalLength;return i&&d&&d.length&&(!w&&S>0||!nI(w,d))?this.renderCurveWithAnimation(n,o):this.renderCurveStatically(d,n,o)}},{key:"render",value:function(){var n,o=this.props,u=o.hide,d=o.dot,i=o.points,v=o.className,w=o.xAxis,S=o.yAxis,C=o.top,k=o.left,O=o.width,L=o.height,R=o.isAnimationActive,N=o.id;if(u||!i||!i.length)return null;var V=this.state.isAnimationFinished,G=i.length===1,U=Ai("recharts-line",v),J=w&&w.allowDataOverflow,Z=S&&S.allowDataOverflow,K=J||Z,re=gi(N)?this.id:N,ge=(n=Ei(d,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},ve=ge.r,$e=ve===void 0?3:ve,Ie=ge.strokeWidth,ke=Ie===void 0?2:Ie,tt=BCe(d)?d:{},Je=tt.clipDot,et=Je===void 0?!0:Je,at=$e*2+ke;return it.createElement(lo,{className:U},J||Z?it.createElement("defs",null,it.createElement("clipPath",{id:"clipPath-".concat(re)},it.createElement("rect",{x:J?k:k-O/2,y:Z?C:C-L/2,width:J?O:O*2,height:Z?L:L*2})),!et&&it.createElement("clipPath",{id:"clipPath-dots-".concat(re)},it.createElement("rect",{x:k-at/2,y:C-at/2,width:O+at,height:L+at}))):null,!G&&this.renderCurve(K,re),this.renderErrorBar(K,re),(G||d)&&this.renderDots(K,et,re),(!R||V)&&vp.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:o.curPoints}:n.points!==o.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,o){for(var u=n.length%2!==0?[].concat(M_(n),[0]):n,d=[],i=0;i<o;++i)d=[].concat(M_(d),M_(u));return d}},{key:"renderDotItem",value:function(n,o){var u;if(it.isValidElement(n))u=it.cloneElement(n,o);else if(ai(n))u=n(o);else{var d=o.key,i=d9(o,h9e),v=Ai("recharts-line-dot",typeof n!="boolean"?n.className:"");u=it.createElement(cN,kw({key:d},i,{className:v}))}return u}}])}(ue.PureComponent);uu(ov,"displayName","Line");uu(ov,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Cf.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});uu(ov,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,o=e.xAxisTicks,u=e.yAxisTicks,d=e.dataKey,i=e.bandSize,v=e.displayedData,w=e.offset,S=t.layout,C=v.map(function(k,O){var L=Jl(k,d);return S==="horizontal"?{x:ZV({axis:r,ticks:o,bandSize:i,entry:k,index:O}),y:gi(L)?null:n.scale(L),value:L,payload:k}:{x:gi(L)?null:r.scale(L),y:ZV({axis:n,ticks:u,bandSize:i,entry:k,index:O}),value:L,payload:k}});return Ll({points:C,layout:S},w)});function sv(e){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sv(e)}function S9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E9e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Aee(n.key),n)}}function A9e(e,t,r){return t&&E9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C9e(e,t,r){return t=IC(t),P9e(e,See()?Reflect.construct(t,r||[],IC(e).constructor):t.apply(e,r))}function P9e(e,t){if(t&&(sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I9e(e)}function I9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function See(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(See=function(){return!!e})()}function IC(e){return IC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IC(e)}function k9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zD(e,t)}function zD(e,t){return zD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zD(e,t)}function Eee(e,t,r){return t=Aee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aee(e){var t=O9e(e,"string");return sv(t)=="symbol"?t:t+""}function O9e(e,t){if(sv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jD(){return jD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jD.apply(this,arguments)}function M9e(e){var t=e.xAxisId,r=dN(),n=pN(),o=uee(t);return o==null?null:ue.createElement(Mv,jD({},o,{className:Ai("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(d){return wf(d,!0)}}))}var c0=function(e){function t(){return S9e(this,t),C9e(this,t,arguments)}return k9e(t,e),A9e(t,[{key:"render",value:function(){return ue.createElement(M9e,this.props)}}])}(ue.Component);Eee(c0,"displayName","XAxis");Eee(c0,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function lv(e){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lv(e)}function R9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D9e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iee(n.key),n)}}function F9e(e,t,r){return t&&D9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function L9e(e,t,r){return t=kC(t),N9e(e,Cee()?Reflect.construct(t,r||[],kC(e).constructor):t.apply(e,r))}function N9e(e,t){if(t&&(lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B9e(e)}function B9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Cee=function(){return!!e})()}function kC(e){return kC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kC(e)}function z9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UD(e,t)}function UD(e,t){return UD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UD(e,t)}function Pee(e,t,r){return t=Iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iee(e){var t=j9e(e,"string");return lv(t)=="symbol"?t:t+""}function j9e(e,t){if(lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $D(){return $D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$D.apply(this,arguments)}var U9e=function(t){var r=t.yAxisId,n=dN(),o=pN(),u=hee(r);return u==null?null:ue.createElement(Mv,$D({},u,{className:Ai("recharts-".concat(u.axisType," ").concat(u.axisType),u.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(i){return wf(i,!0)}}))},u0=function(e){function t(){return R9e(this,t),L9e(this,t,arguments)}return z9e(t,e),F9e(t,[{key:"render",value:function(){return ue.createElement(U9e,this.props)}}])}(ue.Component);Pee(u0,"displayName","YAxis");Pee(u0,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function g9(e){return G9e(e)||W9e(e)||V9e(e)||$9e()}function $9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V9e(e,t){if(e){if(typeof e=="string")return VD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VD(e,t)}}function W9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G9e(e){if(Array.isArray(e))return VD(e)}function VD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var WD=function(t,r,n,o,u){var d=Rc(t,gN),i=Rc(t,uI),v=[].concat(g9(d),g9(i)),w=Rc(t,fI),S="".concat(o,"Id"),C=o[0],k=r;if(v.length&&(k=v.reduce(function(R,N){if(N.props[S]===n&&Th(N.props,"extendDomain")&&Ur(N.props[C])){var V=N.props[C];return[Math.min(R[0],V),Math.max(R[1],V)]}return R},k)),w.length){var O="".concat(C,"1"),L="".concat(C,"2");k=w.reduce(function(R,N){if(N.props[S]===n&&Th(N.props,"extendDomain")&&Ur(N.props[O])&&Ur(N.props[L])){var V=N.props[O],G=N.props[L];return[Math.min(R[0],V,G),Math.max(R[1],V,G)]}return R},k)}return u&&u.length&&(k=u.reduce(function(R,N){return Ur(N)?[Math.min(R[0],N),Math.max(R[1],N)]:R},k)),k},kee={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function o(v,w,S){this.fn=v,this.context=w,this.once=S||!1}function u(v,w,S,C,k){if(typeof S!="function")throw new TypeError("The listener must be a function");var O=new o(S,C||v,k),L=r?r+w:w;return v._events[L]?v._events[L].fn?v._events[L]=[v._events[L],O]:v._events[L].push(O):(v._events[L]=O,v._eventsCount++),v}function d(v,w){--v._eventsCount===0?v._events=new n:delete v._events[w]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var w=[],S,C;if(this._eventsCount===0)return w;for(C in S=this._events)t.call(S,C)&&w.push(r?C.slice(1):C);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(S)):w},i.prototype.listeners=function(w){var S=r?r+w:w,C=this._events[S];if(!C)return[];if(C.fn)return[C.fn];for(var k=0,O=C.length,L=new Array(O);k<O;k++)L[k]=C[k].fn;return L},i.prototype.listenerCount=function(w){var S=r?r+w:w,C=this._events[S];return C?C.fn?1:C.length:0},i.prototype.emit=function(w,S,C,k,O,L){var R=r?r+w:w;if(!this._events[R])return!1;var N=this._events[R],V=arguments.length,G,U;if(N.fn){switch(N.once&&this.removeListener(w,N.fn,void 0,!0),V){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,S),!0;case 3:return N.fn.call(N.context,S,C),!0;case 4:return N.fn.call(N.context,S,C,k),!0;case 5:return N.fn.call(N.context,S,C,k,O),!0;case 6:return N.fn.call(N.context,S,C,k,O,L),!0}for(U=1,G=new Array(V-1);U<V;U++)G[U-1]=arguments[U];N.fn.apply(N.context,G)}else{var J=N.length,Z;for(U=0;U<J;U++)switch(N[U].once&&this.removeListener(w,N[U].fn,void 0,!0),V){case 1:N[U].fn.call(N[U].context);break;case 2:N[U].fn.call(N[U].context,S);break;case 3:N[U].fn.call(N[U].context,S,C);break;case 4:N[U].fn.call(N[U].context,S,C,k);break;default:if(!G)for(Z=1,G=new Array(V-1);Z<V;Z++)G[Z-1]=arguments[Z];N[U].fn.apply(N[U].context,G)}}return!0},i.prototype.on=function(w,S,C){return u(this,w,S,C,!1)},i.prototype.once=function(w,S,C){return u(this,w,S,C,!0)},i.prototype.removeListener=function(w,S,C,k){var O=r?r+w:w;if(!this._events[O])return this;if(!S)return d(this,O),this;var L=this._events[O];if(L.fn)L.fn===S&&(!k||L.once)&&(!C||L.context===C)&&d(this,O);else{for(var R=0,N=[],V=L.length;R<V;R++)(L[R].fn!==S||k&&!L[R].once||C&&L[R].context!==C)&&N.push(L[R]);N.length?this._events[O]=N.length===1?N[0]:N:d(this,O)}return this},i.prototype.removeAllListeners=function(w){var S;return w?(S=r?r+w:w,this._events[S]&&d(this,S)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i})(kee);var H9e=kee.exports;const q9e=Qi(H9e);var XM=new q9e,ZM="recharts.syncMouseEvents";function Gb(e){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}function X9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z9e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oee(n.key),n)}}function Y9e(e,t,r){return t&&Z9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YM(e,t,r){return t=Oee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oee(e){var t=K9e(e,"string");return Gb(t)=="symbol"?t:t+""}function K9e(e,t){if(Gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var J9e=function(){function e(){X9e(this,e),YM(this,"activeIndex",0),YM(this,"coordinateList",[]),YM(this,"layout","horizontal")}return Y9e(e,[{key:"setDetails",value:function(r){var n,o=r.coordinateList,u=o===void 0?null:o,d=r.container,i=d===void 0?null:d,v=r.layout,w=v===void 0?null:v,S=r.offset,C=S===void 0?null:S,k=r.mouseHandlerCallback,O=k===void 0?null:k;this.coordinateList=(n=u??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=w??this.layout,this.offset=C??this.offset,this.mouseHandlerCallback=O??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),u=o.x,d=o.y,i=o.height,v=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,S=((n=window)===null||n===void 0?void 0:n.scrollY)||0,C=u+v+w,k=d+this.offset.top+i/2+S;this.mouseHandlerCallback({pageX:C,pageY:k})}}}])}();function Q9e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],o=e==null?void 0:e[1];if(n&&o&&Ur(n)&&Ur(o))return!0}return!1}function eWe(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Mee(e){var t=e.cx,r=e.cy,n=e.radius,o=e.startAngle,u=e.endAngle,d=cs(t,r,n,o),i=cs(t,r,n,u);return{points:[d,i],cx:t,cy:r,radius:n,startAngle:o,endAngle:u}}function tWe(e,t,r){var n,o,u,d;if(e==="horizontal")n=t.x,u=n,o=r.top,d=r.top+r.height;else if(e==="vertical")o=t.y,d=o,n=r.left,u=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,v=t.cy,w=t.innerRadius,S=t.outerRadius,C=t.angle,k=cs(i,v,w,C),O=cs(i,v,S,C);n=k.x,o=k.y,u=O.x,d=O.y}else return Mee(t);return[{x:n,y:o},{x:u,y:d}]}function Hb(e){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}function _9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_9(Object(r),!0).forEach(function(n){rWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rWe(e,t,r){return t=nWe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nWe(e){var t=iWe(e,"string");return Hb(t)=="symbol"?t:t+""}function iWe(e,t){if(Hb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aWe(e){var t,r,n=e.element,o=e.tooltipEventType,u=e.isActive,d=e.activeCoordinate,i=e.activePayload,v=e.offset,w=e.activeTooltipIndex,S=e.tooltipAxisBandSize,C=e.layout,k=e.chartName,O=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!O||!u||!d||k!=="ScatterChart"&&o!=="axis")return null;var L,R=mD;if(k==="ScatterChart")L=d,R=aUe;else if(k==="BarChart")L=eWe(C,d,v,S),R=lN;else if(C==="radial"){var N=Mee(d),V=N.cx,G=N.cy,U=N.radius,J=N.startAngle,Z=N.endAngle;L={cx:V,cy:G,startAngle:J,endAngle:Z,innerRadius:U,outerRadius:U},R=FQ}else L={points:tWe(C,d,v)},R=mD;var K=yE(yE(yE(yE({stroke:"#ccc",pointerEvents:"none"},v),L),Ei(O,!1)),{},{payload:i,payloadIndex:w,className:Ai("recharts-tooltip-cursor",O.className)});return ue.isValidElement(O)?ue.cloneElement(O,K):ue.createElement(R,K)}var oWe=["item"],sWe=["children","className","width","height","style","compact","title","desc"];function cv(e){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cv(e)}function ty(){return ty=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ty.apply(this,arguments)}function y9(e,t){return uWe(e)||cWe(e,t)||Dee(e,t)||lWe()}function lWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,d,i=[],v=!0,w=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);v=!0);}catch(S){w=!0,o=S}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return i}}function uWe(e){if(Array.isArray(e))return e}function v9(e,t){if(e==null)return{};var r=hWe(e,t),n,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hWe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dWe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fee(n.key),n)}}function pWe(e,t,r){return t&&dWe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mWe(e,t,r){return t=OC(t),gWe(e,Ree()?Reflect.construct(t,r||[],OC(e).constructor):t.apply(e,r))}function gWe(e,t){if(t&&(cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _We(e)}function _We(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ree(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ree=function(){return!!e})()}function OC(e){return OC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OC(e)}function yWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GD(e,t)}function GD(e,t){return GD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GD(e,t)}function uv(e){return wWe(e)||xWe(e)||Dee(e)||vWe()}function vWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dee(e,t){if(e){if(typeof e=="string")return HD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HD(e,t)}}function xWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wWe(e){if(Array.isArray(e))return HD(e)}function HD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x9(Object(r),!0).forEach(function(n){Sn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sn(e,t,r){return t=Fee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fee(e){var t=bWe(e,"string");return cv(t)=="symbol"?t:t+""}function bWe(e,t){if(cv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TWe={xAxis:["bottom","top"],yAxis:["left","right"]},SWe={width:"100%",height:"100%"},Lee={x:0,y:0};function vE(e){return e}var EWe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},AWe=function(t,r,n,o){var u=r.find(function(S){return S&&S.index===n});if(u){if(t==="horizontal")return{x:u.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:u.coordinate};if(t==="centric"){var d=u.coordinate,i=o.radius;return ar(ar(ar({},o),cs(o.cx,o.cy,i,d)),{},{angle:d,radius:i})}var v=u.coordinate,w=o.angle;return ar(ar(ar({},o),cs(o.cx,o.cy,v,w)),{},{angle:w,radius:v})}return Lee},dI=function(t,r){var n=r.graphicalItems,o=r.dataStartIndex,u=r.dataEndIndex,d=(n??[]).reduce(function(i,v){var w=v.props.data;return w&&w.length?[].concat(uv(i),uv(w)):i},[]);return d.length>0?d:t&&t.length&&Ur(o)&&Ur(u)?t.slice(o,u+1):[]};function Nee(e){return e==="number"?[0,"auto"]:void 0}var qD=function(t,r,n,o){var u=t.graphicalItems,d=t.tooltipAxis,i=dI(r,t);return n<0||!u||!u.length||n>=i.length?null:u.reduce(function(v,w){var S,C=(S=w.props.data)!==null&&S!==void 0?S:r;C&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(C=C.slice(t.dataStartIndex,t.dataEndIndex+1));var k;if(d.dataKey&&!d.allowDuplicatedCategory){var O=C===void 0?i:C;k=RA(O,d.dataKey,o)}else k=C&&C[n]||i[n];return k?[].concat(uv(v),[MQ(w,k)]):v},[])},w9=function(t,r,n,o){var u=o||{x:t.chartX,y:t.chartY},d=EWe(u,n),i=t.orderedTooltipTicks,v=t.tooltipAxis,w=t.tooltipTicks,S=U5e(d,i,w,v);if(S>=0&&w){var C=w[S]&&w[S].value,k=qD(t,r,S,C),O=AWe(n,i,S,u);return{activeTooltipIndex:S,activeLabel:C,activePayload:k,activeCoordinate:O}}return null},CWe=function(t,r){var n=r.axes,o=r.graphicalItems,u=r.axisType,d=r.axisIdKey,i=r.stackGroups,v=r.dataStartIndex,w=r.dataEndIndex,S=t.layout,C=t.children,k=t.stackOffset,O=IQ(S,u);return n.reduce(function(L,R){var N,V=R.type.defaultProps!==void 0?ar(ar({},R.type.defaultProps),R.props):R.props,G=V.type,U=V.dataKey,J=V.allowDataOverflow,Z=V.allowDuplicatedCategory,K=V.scale,re=V.ticks,ge=V.includeHidden,ve=V[d];if(L[ve])return L;var $e=dI(t.data,{graphicalItems:o.filter(function(_e){var Ge,qe=d in _e.props?_e.props[d]:(Ge=_e.type.defaultProps)===null||Ge===void 0?void 0:Ge[d];return qe===ve}),dataStartIndex:v,dataEndIndex:w}),Ie=$e.length,ke,tt,Je;Q9e(V.domain,J,G)&&(ke=uD(V.domain,null,J),O&&(G==="number"||K!=="auto")&&(Je=Pw($e,U,"category")));var et=Nee(G);if(!ke||ke.length===0){var at,pt=(at=V.domain)!==null&&at!==void 0?at:et;if(U){if(ke=Pw($e,U,G),G==="category"&&O){var ft=PCe(ke);Z&&ft?(tt=ke,ke=yC(0,Ie)):Z||(ke=QV(pt,ke,R).reduce(function(_e,Ge){return _e.indexOf(Ge)>=0?_e:[].concat(uv(_e),[Ge])},[]))}else if(G==="category")Z?ke=ke.filter(function(_e){return _e!==""&&!gi(_e)}):ke=QV(pt,ke,R).reduce(function(_e,Ge){return _e.indexOf(Ge)>=0||Ge===""||gi(Ge)?_e:[].concat(uv(_e),[Ge])},[]);else if(G==="number"){var Ue=H5e($e,o.filter(function(_e){var Ge,qe,Xe=d in _e.props?_e.props[d]:(Ge=_e.type.defaultProps)===null||Ge===void 0?void 0:Ge[d],yt="hide"in _e.props?_e.props.hide:(qe=_e.type.defaultProps)===null||qe===void 0?void 0:qe.hide;return Xe===ve&&(ge||!yt)}),U,u,S);Ue&&(ke=Ue)}O&&(G==="number"||K!=="auto")&&(Je=Pw($e,U,"category"))}else O?ke=yC(0,Ie):i&&i[ve]&&i[ve].hasStack&&G==="number"?ke=k==="expand"?[0,1]:OQ(i[ve].stackGroups,v,w):ke=PQ($e,o.filter(function(_e){var Ge=d in _e.props?_e.props[d]:_e.type.defaultProps[d],qe="hide"in _e.props?_e.props.hide:_e.type.defaultProps.hide;return Ge===ve&&(ge||!qe)}),G,S,!0);if(G==="number")ke=WD(C,ke,ve,u,re),pt&&(ke=uD(pt,ke,J));else if(G==="category"&&pt){var It=pt,Rt=ke.every(function(_e){return It.indexOf(_e)>=0});Rt&&(ke=It)}}return ar(ar({},L),{},Sn({},ve,ar(ar({},V),{},{axisType:u,domain:ke,categoricalDomain:Je,duplicateDomain:tt,originalDomain:(N=V.domain)!==null&&N!==void 0?N:et,isCategorical:O,layout:S})))},{})},PWe=function(t,r){var n=r.graphicalItems,o=r.Axis,u=r.axisType,d=r.axisIdKey,i=r.stackGroups,v=r.dataStartIndex,w=r.dataEndIndex,S=t.layout,C=t.children,k=dI(t.data,{graphicalItems:n,dataStartIndex:v,dataEndIndex:w}),O=k.length,L=IQ(S,u),R=-1;return n.reduce(function(N,V){var G=V.type.defaultProps!==void 0?ar(ar({},V.type.defaultProps),V.props):V.props,U=G[d],J=Nee("number");if(!N[U]){R++;var Z;return L?Z=yC(0,O):i&&i[U]&&i[U].hasStack?(Z=OQ(i[U].stackGroups,v,w),Z=WD(C,Z,U,u)):(Z=uD(J,PQ(k,n.filter(function(K){var re,ge,ve=d in K.props?K.props[d]:(re=K.type.defaultProps)===null||re===void 0?void 0:re[d],$e="hide"in K.props?K.props.hide:(ge=K.type.defaultProps)===null||ge===void 0?void 0:ge.hide;return ve===U&&!$e}),"number",S),o.defaultProps.allowDataOverflow),Z=WD(C,Z,U,u)),ar(ar({},N),{},Sn({},U,ar(ar({axisType:u},o.defaultProps),{},{hide:!0,orientation:Mc(TWe,"".concat(u,".").concat(R%2),null),domain:Z,originalDomain:J,isCategorical:L,layout:S})))}return N},{})},IWe=function(t,r){var n=r.axisType,o=n===void 0?"xAxis":n,u=r.AxisComp,d=r.graphicalItems,i=r.stackGroups,v=r.dataStartIndex,w=r.dataEndIndex,S=t.children,C="".concat(o,"Id"),k=Rc(S,u),O={};return k&&k.length?O=CWe(t,{axes:k,graphicalItems:d,axisType:o,axisIdKey:C,stackGroups:i,dataStartIndex:v,dataEndIndex:w}):d&&d.length&&(O=PWe(t,{Axis:u,graphicalItems:d,axisType:o,axisIdKey:C,stackGroups:i,dataStartIndex:v,dataEndIndex:w})),O},kWe=function(t){var r=qd(t),n=wf(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:FL(n,function(o){return o.coordinate}),tooltipAxis:r,tooltipAxisBandSize:cC(r,n)}},b9=function(t){var r=t.children,n=t.defaultShowTooltip,o=zl(r,Qy),u=0,d=0;return t.data&&t.data.length!==0&&(d=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(u=o.props.startIndex),o.props.endIndex>=0&&(d=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:u,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!n}},OWe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Ef(r&&r.type);return n&&n.indexOf("Bar")>=0})},T9=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},MWe=function(t,r){var n=t.props,o=t.graphicalItems,u=t.xAxisMap,d=u===void 0?{}:u,i=t.yAxisMap,v=i===void 0?{}:i,w=n.width,S=n.height,C=n.children,k=n.margin||{},O=zl(C,Qy),L=zl(C,_p),R=Object.keys(v).reduce(function(Z,K){var re=v[K],ge=re.orientation;return!re.mirror&&!re.hide?ar(ar({},Z),{},Sn({},ge,Z[ge]+re.width)):Z},{left:k.left||0,right:k.right||0}),N=Object.keys(d).reduce(function(Z,K){var re=d[K],ge=re.orientation;return!re.mirror&&!re.hide?ar(ar({},Z),{},Sn({},ge,Mc(Z,"".concat(ge))+re.height)):Z},{top:k.top||0,bottom:k.bottom||0}),V=ar(ar({},N),R),G=V.bottom;O&&(V.bottom+=O.props.height||Qy.defaultProps.height),L&&r&&(V=W5e(V,o,n,r));var U=w-V.left-V.right,J=S-V.top-V.bottom;return ar(ar({brushBottom:G},V),{},{width:Math.max(U,0),height:Math.max(J,0)})},RWe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Bee=function(t){var r=t.chartName,n=t.GraphicalChild,o=t.defaultTooltipEventType,u=o===void 0?"axis":o,d=t.validateTooltipEventTypes,i=d===void 0?["axis"]:d,v=t.axisComponents,w=t.legendContent,S=t.formatAxisMap,C=t.defaultProps,k=function(V,G){var U=G.graphicalItems,J=G.stackGroups,Z=G.offset,K=G.updateId,re=G.dataStartIndex,ge=G.dataEndIndex,ve=V.barSize,$e=V.layout,Ie=V.barGap,ke=V.barCategoryGap,tt=V.maxBarSize,Je=T9($e),et=Je.numericAxisName,at=Je.cateAxisName,pt=OWe(U),ft=[];return U.forEach(function(Ue,It){var Rt=dI(V.data,{graphicalItems:[Ue],dataStartIndex:re,dataEndIndex:ge}),_e=Ue.type.defaultProps!==void 0?ar(ar({},Ue.type.defaultProps),Ue.props):Ue.props,Ge=_e.dataKey,qe=_e.maxBarSize,Xe=_e["".concat(et,"Id")],yt=_e["".concat(at,"Id")],Dt={},Yt=v.reduce(function(Yn,ta){var Di=G["".concat(ta.axisType,"Map")],ra=_e["".concat(ta.axisType,"Id")];Di&&Di[ra]||ta.axisType==="zAxis"||k0();var Ra=Di[ra];return ar(ar({},Yn),{},Sn(Sn({},ta.axisType,Ra),"".concat(ta.axisType,"Ticks"),wf(Ra)))},Dt),St=Yt[at],Mt=Yt["".concat(at,"Ticks")],Sr=J&&J[Xe]&&J[Xe].hasStack&&i6e(Ue,J[Xe].stackGroups),Ne=Ef(Ue.type).indexOf("Bar")>=0,un=cC(St,Mt),kr=[],Br=pt&&$5e({barSize:ve,stackGroups:J,totalSize:RWe(Yt,at)});if(Ne){var Yr,Tr,jn=gi(qe)?tt:qe,Un=(Yr=(Tr=cC(St,Mt,!0))!==null&&Tr!==void 0?Tr:jn)!==null&&Yr!==void 0?Yr:0;kr=V5e({barGap:Ie,barCategoryGap:ke,bandSize:Un!==un?Un:un,sizeList:Br[yt],maxBarSize:jn}),Un!==un&&(kr=kr.map(function(Yn){return ar(ar({},Yn),{},{position:ar(ar({},Yn.position),{},{offset:Yn.position.offset-Un/2})})}))}var Wi=Ue&&Ue.type&&Ue.type.getComposedData;Wi&&ft.push({props:ar(ar({},Wi(ar(ar({},Yt),{},{displayedData:Rt,props:V,dataKey:Ge,item:Ue,bandSize:un,barPosition:kr,offset:Z,stackedData:Sr,layout:$e,dataStartIndex:re,dataEndIndex:ge}))),{},Sn(Sn(Sn({key:Ue.key||"item-".concat(It)},et,Yt[et]),at,Yt[at]),"animationId",K)),childIndex:UCe(Ue,V.children),item:Ue})}),ft},O=function(V,G){var U=V.props,J=V.dataStartIndex,Z=V.dataEndIndex,K=V.updateId;if(!HU({props:U}))return null;var re=U.children,ge=U.layout,ve=U.stackOffset,$e=U.data,Ie=U.reverseStackOrder,ke=T9(ge),tt=ke.numericAxisName,Je=ke.cateAxisName,et=Rc(re,n),at=t6e($e,et,"".concat(tt,"Id"),"".concat(Je,"Id"),ve,Ie),pt=v.reduce(function(_e,Ge){var qe="".concat(Ge.axisType,"Map");return ar(ar({},_e),{},Sn({},qe,IWe(U,ar(ar({},Ge),{},{graphicalItems:et,stackGroups:Ge.axisType===tt&&at,dataStartIndex:J,dataEndIndex:Z}))))},{}),ft=MWe(ar(ar({},pt),{},{props:U,graphicalItems:et}),G==null?void 0:G.legendBBox);Object.keys(pt).forEach(function(_e){pt[_e]=S(U,pt[_e],ft,_e.replace("Map",""),r)});var Ue=pt["".concat(Je,"Map")],It=kWe(Ue),Rt=k(U,ar(ar({},pt),{},{dataStartIndex:J,dataEndIndex:Z,updateId:K,graphicalItems:et,stackGroups:at,offset:ft}));return ar(ar({formattedGraphicalItems:Rt,graphicalItems:et,offset:ft,stackGroups:at},It),pt)},L=function(N){function V(G){var U,J,Z;return fWe(this,V),Z=mWe(this,V,[G]),Sn(Z,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Sn(Z,"accessibilityManager",new J9e),Sn(Z,"handleLegendBBoxUpdate",function(K){if(K){var re=Z.state,ge=re.dataStartIndex,ve=re.dataEndIndex,$e=re.updateId;Z.setState(ar({legendBBox:K},O({props:Z.props,dataStartIndex:ge,dataEndIndex:ve,updateId:$e},ar(ar({},Z.state),{},{legendBBox:K}))))}}),Sn(Z,"handleReceiveSyncEvent",function(K,re,ge){if(Z.props.syncId===K){if(ge===Z.eventEmitterSymbol&&typeof Z.props.syncMethod!="function")return;Z.applySyncEvent(re)}}),Sn(Z,"handleBrushChange",function(K){var re=K.startIndex,ge=K.endIndex;if(re!==Z.state.dataStartIndex||ge!==Z.state.dataEndIndex){var ve=Z.state.updateId;Z.setState(function(){return ar({dataStartIndex:re,dataEndIndex:ge},O({props:Z.props,dataStartIndex:re,dataEndIndex:ge,updateId:ve},Z.state))}),Z.triggerSyncEvent({dataStartIndex:re,dataEndIndex:ge})}}),Sn(Z,"handleMouseEnter",function(K){var re=Z.getMouseInfo(K);if(re){var ge=ar(ar({},re),{},{isTooltipActive:!0});Z.setState(ge),Z.triggerSyncEvent(ge);var ve=Z.props.onMouseEnter;ai(ve)&&ve(ge,K)}}),Sn(Z,"triggeredAfterMouseMove",function(K){var re=Z.getMouseInfo(K),ge=re?ar(ar({},re),{},{isTooltipActive:!0}):{isTooltipActive:!1};Z.setState(ge),Z.triggerSyncEvent(ge);var ve=Z.props.onMouseMove;ai(ve)&&ve(ge,K)}),Sn(Z,"handleItemMouseEnter",function(K){Z.setState(function(){return{isTooltipActive:!0,activeItem:K,activePayload:K.tooltipPayload,activeCoordinate:K.tooltipPosition||{x:K.cx,y:K.cy}}})}),Sn(Z,"handleItemMouseLeave",function(){Z.setState(function(){return{isTooltipActive:!1}})}),Sn(Z,"handleMouseMove",function(K){K.persist(),Z.throttleTriggeredAfterMouseMove(K)}),Sn(Z,"handleMouseLeave",function(K){Z.throttleTriggeredAfterMouseMove.cancel();var re={isTooltipActive:!1};Z.setState(re),Z.triggerSyncEvent(re);var ge=Z.props.onMouseLeave;ai(ge)&&ge(re,K)}),Sn(Z,"handleOuterEvent",function(K){var re=jCe(K),ge=Mc(Z.props,"".concat(re));if(re&&ai(ge)){var ve,$e;/.*touch.*/i.test(re)?$e=Z.getMouseInfo(K.changedTouches[0]):$e=Z.getMouseInfo(K),ge((ve=$e)!==null&&ve!==void 0?ve:{},K)}}),Sn(Z,"handleClick",function(K){var re=Z.getMouseInfo(K);if(re){var ge=ar(ar({},re),{},{isTooltipActive:!0});Z.setState(ge),Z.triggerSyncEvent(ge);var ve=Z.props.onClick;ai(ve)&&ve(ge,K)}}),Sn(Z,"handleMouseDown",function(K){var re=Z.props.onMouseDown;if(ai(re)){var ge=Z.getMouseInfo(K);re(ge,K)}}),Sn(Z,"handleMouseUp",function(K){var re=Z.props.onMouseUp;if(ai(re)){var ge=Z.getMouseInfo(K);re(ge,K)}}),Sn(Z,"handleTouchMove",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Z.throttleTriggeredAfterMouseMove(K.changedTouches[0])}),Sn(Z,"handleTouchStart",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Z.handleMouseDown(K.changedTouches[0])}),Sn(Z,"handleTouchEnd",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Z.handleMouseUp(K.changedTouches[0])}),Sn(Z,"handleDoubleClick",function(K){var re=Z.props.onDoubleClick;if(ai(re)){var ge=Z.getMouseInfo(K);re(ge,K)}}),Sn(Z,"handleContextMenu",function(K){var re=Z.props.onContextMenu;if(ai(re)){var ge=Z.getMouseInfo(K);re(ge,K)}}),Sn(Z,"triggerSyncEvent",function(K){Z.props.syncId!==void 0&&XM.emit(ZM,Z.props.syncId,K,Z.eventEmitterSymbol)}),Sn(Z,"applySyncEvent",function(K){var re=Z.props,ge=re.layout,ve=re.syncMethod,$e=Z.state.updateId,Ie=K.dataStartIndex,ke=K.dataEndIndex;if(K.dataStartIndex!==void 0||K.dataEndIndex!==void 0)Z.setState(ar({dataStartIndex:Ie,dataEndIndex:ke},O({props:Z.props,dataStartIndex:Ie,dataEndIndex:ke,updateId:$e},Z.state)));else if(K.activeTooltipIndex!==void 0){var tt=K.chartX,Je=K.chartY,et=K.activeTooltipIndex,at=Z.state,pt=at.offset,ft=at.tooltipTicks;if(!pt)return;if(typeof ve=="function")et=ve(ft,K);else if(ve==="value"){et=-1;for(var Ue=0;Ue<ft.length;Ue++)if(ft[Ue].value===K.activeLabel){et=Ue;break}}var It=ar(ar({},pt),{},{x:pt.left,y:pt.top}),Rt=Math.min(tt,It.x+It.width),_e=Math.min(Je,It.y+It.height),Ge=ft[et]&&ft[et].value,qe=qD(Z.state,Z.props.data,et),Xe=ft[et]?{x:ge==="horizontal"?ft[et].coordinate:Rt,y:ge==="horizontal"?_e:ft[et].coordinate}:Lee;Z.setState(ar(ar({},K),{},{activeLabel:Ge,activeCoordinate:Xe,activePayload:qe,activeTooltipIndex:et}))}else Z.setState(K)}),Sn(Z,"renderCursor",function(K){var re,ge=Z.state,ve=ge.isTooltipActive,$e=ge.activeCoordinate,Ie=ge.activePayload,ke=ge.offset,tt=ge.activeTooltipIndex,Je=ge.tooltipAxisBandSize,et=Z.getTooltipEventType(),at=(re=K.props.active)!==null&&re!==void 0?re:ve,pt=Z.props.layout,ft=K.key||"_recharts-cursor";return it.createElement(aWe,{key:ft,activeCoordinate:$e,activePayload:Ie,activeTooltipIndex:tt,chartName:r,element:K,isActive:at,layout:pt,offset:ke,tooltipAxisBandSize:Je,tooltipEventType:et})}),Sn(Z,"renderPolarAxis",function(K,re,ge){var ve=Mc(K,"type.axisType"),$e=Mc(Z.state,"".concat(ve,"Map")),Ie=K.type.defaultProps,ke=Ie!==void 0?ar(ar({},Ie),K.props):K.props,tt=$e&&$e[ke["".concat(ve,"Id")]];return ue.cloneElement(K,ar(ar({},tt),{},{className:Ai(ve,tt.className),key:K.key||"".concat(re,"-").concat(ge),ticks:wf(tt,!0)}))}),Sn(Z,"renderPolarGrid",function(K){var re=K.props,ge=re.radialLines,ve=re.polarAngles,$e=re.polarRadius,Ie=Z.state,ke=Ie.radiusAxisMap,tt=Ie.angleAxisMap,Je=qd(ke),et=qd(tt),at=et.cx,pt=et.cy,ft=et.innerRadius,Ue=et.outerRadius;return ue.cloneElement(K,{polarAngles:Array.isArray(ve)?ve:wf(et,!0).map(function(It){return It.coordinate}),polarRadius:Array.isArray($e)?$e:wf(Je,!0).map(function(It){return It.coordinate}),cx:at,cy:pt,innerRadius:ft,outerRadius:Ue,key:K.key||"polar-grid",radialLines:ge})}),Sn(Z,"renderLegend",function(){var K=Z.state.formattedGraphicalItems,re=Z.props,ge=re.children,ve=re.width,$e=re.height,Ie=Z.props.margin||{},ke=ve-(Ie.left||0)-(Ie.right||0),tt=AQ({children:ge,formattedGraphicalItems:K,legendWidth:ke,legendContent:w});if(!tt)return null;var Je=tt.item,et=v9(tt,oWe);return ue.cloneElement(Je,ar(ar({},et),{},{chartWidth:ve,chartHeight:$e,margin:Ie,onBBoxUpdate:Z.handleLegendBBoxUpdate}))}),Sn(Z,"renderTooltip",function(){var K,re=Z.props,ge=re.children,ve=re.accessibilityLayer,$e=zl(ge,bc);if(!$e)return null;var Ie=Z.state,ke=Ie.isTooltipActive,tt=Ie.activeCoordinate,Je=Ie.activePayload,et=Ie.activeLabel,at=Ie.offset,pt=(K=$e.props.active)!==null&&K!==void 0?K:ke;return ue.cloneElement($e,{viewBox:ar(ar({},at),{},{x:at.left,y:at.top}),active:pt,label:et,payload:pt?Je:[],coordinate:tt,accessibilityLayer:ve})}),Sn(Z,"renderBrush",function(K){var re=Z.props,ge=re.margin,ve=re.data,$e=Z.state,Ie=$e.offset,ke=$e.dataStartIndex,tt=$e.dataEndIndex,Je=$e.updateId;return ue.cloneElement(K,{key:K.key||"_recharts-brush",onChange:pE(Z.handleBrushChange,K.props.onChange),data:ve,x:Ur(K.props.x)?K.props.x:Ie.left,y:Ur(K.props.y)?K.props.y:Ie.top+Ie.height+Ie.brushBottom-(ge.bottom||0),width:Ur(K.props.width)?K.props.width:Ie.width,startIndex:ke,endIndex:tt,updateId:"brush-".concat(Je)})}),Sn(Z,"renderReferenceElement",function(K,re,ge){if(!K)return null;var ve=Z,$e=ve.clipPathId,Ie=Z.state,ke=Ie.xAxisMap,tt=Ie.yAxisMap,Je=Ie.offset,et=K.type.defaultProps||{},at=K.props,pt=at.xAxisId,ft=pt===void 0?et.xAxisId:pt,Ue=at.yAxisId,It=Ue===void 0?et.yAxisId:Ue;return ue.cloneElement(K,{key:K.key||"".concat(re,"-").concat(ge),xAxis:ke[ft],yAxis:tt[It],viewBox:{x:Je.left,y:Je.top,width:Je.width,height:Je.height},clipPathId:$e})}),Sn(Z,"renderActivePoints",function(K){var re=K.item,ge=K.activePoint,ve=K.basePoint,$e=K.childIndex,Ie=K.isRange,ke=[],tt=re.props.key,Je=re.item.type.defaultProps!==void 0?ar(ar({},re.item.type.defaultProps),re.item.props):re.item.props,et=Je.activeDot,at=Je.dataKey,pt=ar(ar({index:$e,dataKey:at,cx:ge.x,cy:ge.y,r:4,fill:sN(re.item),strokeWidth:2,stroke:"#fff",payload:ge.payload,value:ge.value},Ei(et,!1)),DA(et));return ke.push(V.renderActiveDot(et,pt,"".concat(tt,"-activePoint-").concat($e))),ve?ke.push(V.renderActiveDot(et,ar(ar({},pt),{},{cx:ve.x,cy:ve.y}),"".concat(tt,"-basePoint-").concat($e))):Ie&&ke.push(null),ke}),Sn(Z,"renderGraphicChild",function(K,re,ge){var ve=Z.filterFormatItem(K,re,ge);if(!ve)return null;var $e=Z.getTooltipEventType(),Ie=Z.state,ke=Ie.isTooltipActive,tt=Ie.tooltipAxis,Je=Ie.activeTooltipIndex,et=Ie.activeLabel,at=Z.props.children,pt=zl(at,bc),ft=ve.props,Ue=ft.points,It=ft.isRange,Rt=ft.baseLine,_e=ve.item.type.defaultProps!==void 0?ar(ar({},ve.item.type.defaultProps),ve.item.props):ve.item.props,Ge=_e.activeDot,qe=_e.hide,Xe=_e.activeBar,yt=_e.activeShape,Dt=!!(!qe&&ke&&pt&&(Ge||Xe||yt)),Yt={};$e!=="axis"&&pt&&pt.props.trigger==="click"?Yt={onClick:pE(Z.handleItemMouseEnter,K.props.onClick)}:$e!=="axis"&&(Yt={onMouseLeave:pE(Z.handleItemMouseLeave,K.props.onMouseLeave),onMouseEnter:pE(Z.handleItemMouseEnter,K.props.onMouseEnter)});var St=ue.cloneElement(K,ar(ar({},ve.props),Yt));function Mt(ta){return typeof tt.dataKey=="function"?tt.dataKey(ta.payload):null}if(Dt)if(Je>=0){var Sr,Ne;if(tt.dataKey&&!tt.allowDuplicatedCategory){var un=typeof tt.dataKey=="function"?Mt:"payload.".concat(tt.dataKey.toString());Sr=RA(Ue,un,et),Ne=It&&Rt&&RA(Rt,un,et)}else Sr=Ue==null?void 0:Ue[Je],Ne=It&&Rt&&Rt[Je];if(yt||Xe){var kr=K.props.activeIndex!==void 0?K.props.activeIndex:Je;return[ue.cloneElement(K,ar(ar(ar({},ve.props),Yt),{},{activeIndex:kr})),null,null]}if(!gi(Sr))return[St].concat(uv(Z.renderActivePoints({item:ve,activePoint:Sr,basePoint:Ne,childIndex:Je,isRange:It})))}else{var Br,Yr=(Br=Z.getItemByXY(Z.state.activeCoordinate))!==null&&Br!==void 0?Br:{graphicalItem:St},Tr=Yr.graphicalItem,jn=Tr.item,Un=jn===void 0?K:jn,Wi=Tr.childIndex,Yn=ar(ar(ar({},ve.props),Yt),{},{activeIndex:Wi});return[ue.cloneElement(Un,Yn),null,null]}return It?[St,null,null]:[St,null]}),Sn(Z,"renderCustomized",function(K,re,ge){return ue.cloneElement(K,ar(ar({key:"recharts-customized-".concat(ge)},Z.props),Z.state))}),Sn(Z,"renderMap",{CartesianGrid:{handler:vE,once:!0},ReferenceArea:{handler:Z.renderReferenceElement},ReferenceLine:{handler:vE},ReferenceDot:{handler:Z.renderReferenceElement},XAxis:{handler:vE},YAxis:{handler:vE},Brush:{handler:Z.renderBrush,once:!0},Bar:{handler:Z.renderGraphicChild},Line:{handler:Z.renderGraphicChild},Area:{handler:Z.renderGraphicChild},Radar:{handler:Z.renderGraphicChild},RadialBar:{handler:Z.renderGraphicChild},Scatter:{handler:Z.renderGraphicChild},Pie:{handler:Z.renderGraphicChild},Funnel:{handler:Z.renderGraphicChild},Tooltip:{handler:Z.renderCursor,once:!0},PolarGrid:{handler:Z.renderPolarGrid,once:!0},PolarAngleAxis:{handler:Z.renderPolarAxis},PolarRadiusAxis:{handler:Z.renderPolarAxis},Customized:{handler:Z.renderCustomized}}),Z.clipPathId="".concat((U=G.id)!==null&&U!==void 0?U:b2("recharts"),"-clip"),Z.throttleTriggeredAfterMouseMove=EJ(Z.triggeredAfterMouseMove,(J=G.throttleDelay)!==null&&J!==void 0?J:1e3/60),Z.state={},Z}return yWe(V,N),pWe(V,[{key:"componentDidMount",value:function(){var U,J;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(U=this.props.margin.left)!==null&&U!==void 0?U:0,top:(J=this.props.margin.top)!==null&&J!==void 0?J:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var U=this.props,J=U.children,Z=U.data,K=U.height,re=U.layout,ge=zl(J,bc);if(ge){var ve=ge.props.defaultIndex;if(!(typeof ve!="number"||ve<0||ve>this.state.tooltipTicks.length-1)){var $e=this.state.tooltipTicks[ve]&&this.state.tooltipTicks[ve].value,Ie=qD(this.state,Z,ve,$e),ke=this.state.tooltipTicks[ve].coordinate,tt=(this.state.offset.top+K)/2,Je=re==="horizontal",et=Je?{x:ke,y:tt}:{y:ke,x:tt},at=this.state.formattedGraphicalItems.find(function(ft){var Ue=ft.item;return Ue.type.name==="Scatter"});at&&(et=ar(ar({},et),at.props.points[ve].tooltipPosition),Ie=at.props.points[ve].tooltipPayload);var pt={activeTooltipIndex:ve,isTooltipActive:!0,activeLabel:$e,activePayload:Ie,activeCoordinate:et};this.setState(pt),this.renderCursor(ge),this.accessibilityManager.setIndex(ve)}}}},{key:"getSnapshotBeforeUpdate",value:function(U,J){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==J.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==U.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==U.margin){var Z,K;this.accessibilityManager.setDetails({offset:{left:(Z=this.props.margin.left)!==null&&Z!==void 0?Z:0,top:(K=this.props.margin.top)!==null&&K!==void 0?K:0}})}return null}},{key:"componentDidUpdate",value:function(U){E3([zl(U.children,bc)],[zl(this.props.children,bc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var U=zl(this.props.children,bc);if(U&&typeof U.props.shared=="boolean"){var J=U.props.shared?"axis":"item";return i.indexOf(J)>=0?J:u}return u}},{key:"getMouseInfo",value:function(U){if(!this.container)return null;var J=this.container,Z=J.getBoundingClientRect(),K=dLe(Z),re={chartX:Math.round(U.pageX-K.left),chartY:Math.round(U.pageY-K.top)},ge=Z.width/J.offsetWidth||1,ve=this.inRange(re.chartX,re.chartY,ge);if(!ve)return null;var $e=this.state,Ie=$e.xAxisMap,ke=$e.yAxisMap,tt=this.getTooltipEventType(),Je=w9(this.state,this.props.data,this.props.layout,ve);if(tt!=="axis"&&Ie&&ke){var et=qd(Ie).scale,at=qd(ke).scale,pt=et&&et.invert?et.invert(re.chartX):null,ft=at&&at.invert?at.invert(re.chartY):null;return ar(ar({},re),{},{xValue:pt,yValue:ft},Je)}return Je?ar(ar({},re),Je):null}},{key:"inRange",value:function(U,J){var Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,K=this.props.layout,re=U/Z,ge=J/Z;if(K==="horizontal"||K==="vertical"){var ve=this.state.offset,$e=re>=ve.left&&re<=ve.left+ve.width&&ge>=ve.top&&ge<=ve.top+ve.height;return $e?{x:re,y:ge}:null}var Ie=this.state,ke=Ie.angleAxisMap,tt=Ie.radiusAxisMap;if(ke&&tt){var Je=qd(ke);return r7({x:re,y:ge},Je)}return null}},{key:"parseEventsOfWrapper",value:function(){var U=this.props.children,J=this.getTooltipEventType(),Z=zl(U,bc),K={};Z&&J==="axis"&&(Z.props.trigger==="click"?K={onClick:this.handleClick}:K={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var re=DA(this.props,this.handleOuterEvent);return ar(ar({},re),K)}},{key:"addListener",value:function(){XM.on(ZM,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){XM.removeListener(ZM,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(U,J,Z){for(var K=this.state.formattedGraphicalItems,re=0,ge=K.length;re<ge;re++){var ve=K[re];if(ve.item===U||ve.props.key===U.key||J===Ef(ve.item.type)&&Z===ve.childIndex)return ve}return null}},{key:"renderClipPath",value:function(){var U=this.clipPathId,J=this.state.offset,Z=J.left,K=J.top,re=J.height,ge=J.width;return it.createElement("defs",null,it.createElement("clipPath",{id:U},it.createElement("rect",{x:Z,y:K,height:re,width:ge})))}},{key:"getXScales",value:function(){var U=this.state.xAxisMap;return U?Object.entries(U).reduce(function(J,Z){var K=y9(Z,2),re=K[0],ge=K[1];return ar(ar({},J),{},Sn({},re,ge.scale))},{}):null}},{key:"getYScales",value:function(){var U=this.state.yAxisMap;return U?Object.entries(U).reduce(function(J,Z){var K=y9(Z,2),re=K[0],ge=K[1];return ar(ar({},J),{},Sn({},re,ge.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(U){var J;return(J=this.state.xAxisMap)===null||J===void 0||(J=J[U])===null||J===void 0?void 0:J.scale}},{key:"getYScaleByAxisId",value:function(U){var J;return(J=this.state.yAxisMap)===null||J===void 0||(J=J[U])===null||J===void 0?void 0:J.scale}},{key:"getItemByXY",value:function(U){var J=this.state,Z=J.formattedGraphicalItems,K=J.activeItem;if(Z&&Z.length)for(var re=0,ge=Z.length;re<ge;re++){var ve=Z[re],$e=ve.props,Ie=ve.item,ke=Ie.type.defaultProps!==void 0?ar(ar({},Ie.type.defaultProps),Ie.props):Ie.props,tt=Ef(Ie.type);if(tt==="Bar"){var Je=($e.data||[]).find(function(ft){return Zje(U,ft)});if(Je)return{graphicalItem:ve,payload:Je}}else if(tt==="RadialBar"){var et=($e.data||[]).find(function(ft){return r7(U,ft)});if(et)return{graphicalItem:ve,payload:et}}else if(oI(ve,K)||sI(ve,K)||jb(ve,K)){var at=JUe({graphicalItem:ve,activeTooltipItem:K,itemData:ke.data}),pt=ke.activeIndex===void 0?at:ke.activeIndex;return{graphicalItem:ar(ar({},ve),{},{childIndex:pt}),payload:jb(ve,K)?ke.data[at]:ve.props.data[at]}}}return null}},{key:"render",value:function(){var U=this;if(!HU(this))return null;var J=this.props,Z=J.children,K=J.className,re=J.width,ge=J.height,ve=J.style,$e=J.compact,Ie=J.title,ke=J.desc,tt=v9(J,sWe),Je=Ei(tt,!1);if($e)return it.createElement(e9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},it.createElement(C3,ty({},Je,{width:re,height:ge,title:Ie,desc:ke}),this.renderClipPath(),XU(Z,this.renderMap)));if(this.props.accessibilityLayer){var et,at;Je.tabIndex=(et=this.props.tabIndex)!==null&&et!==void 0?et:0,Je.role=(at=this.props.role)!==null&&at!==void 0?at:"application",Je.onKeyDown=function(ft){U.accessibilityManager.keyboardEvent(ft)},Je.onFocus=function(){U.accessibilityManager.focus()}}var pt=this.parseEventsOfWrapper();return it.createElement(e9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},it.createElement("div",ty({className:Ai("recharts-wrapper",K),style:ar({position:"relative",cursor:"default",width:re,height:ge},ve)},pt,{ref:function(Ue){U.container=Ue}}),it.createElement(C3,ty({},Je,{width:re,height:ge,title:Ie,desc:ke,style:SWe}),this.renderClipPath(),XU(Z,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(ue.Component);Sn(L,"displayName",r),Sn(L,"defaultProps",ar({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},C)),Sn(L,"getDerivedStateFromProps",function(N,V){var G=N.dataKey,U=N.data,J=N.children,Z=N.width,K=N.height,re=N.layout,ge=N.stackOffset,ve=N.margin,$e=V.dataStartIndex,Ie=V.dataEndIndex;if(V.updateId===void 0){var ke=b9(N);return ar(ar(ar({},ke),{},{updateId:0},O(ar(ar({props:N},ke),{},{updateId:0}),V)),{},{prevDataKey:G,prevData:U,prevWidth:Z,prevHeight:K,prevLayout:re,prevStackOffset:ge,prevMargin:ve,prevChildren:J})}if(G!==V.prevDataKey||U!==V.prevData||Z!==V.prevWidth||K!==V.prevHeight||re!==V.prevLayout||ge!==V.prevStackOffset||!gy(ve,V.prevMargin)){var tt=b9(N),Je={chartX:V.chartX,chartY:V.chartY,isTooltipActive:V.isTooltipActive},et=ar(ar({},w9(V,U,re)),{},{updateId:V.updateId+1}),at=ar(ar(ar({},tt),Je),et);return ar(ar(ar({},at),O(ar({props:N},at),V)),{},{prevDataKey:G,prevData:U,prevWidth:Z,prevHeight:K,prevLayout:re,prevStackOffset:ge,prevMargin:ve,prevChildren:J})}if(!E3(J,V.prevChildren)){var pt,ft,Ue,It,Rt=zl(J,Qy),_e=Rt&&(pt=(ft=Rt.props)===null||ft===void 0?void 0:ft.startIndex)!==null&&pt!==void 0?pt:$e,Ge=Rt&&(Ue=(It=Rt.props)===null||It===void 0?void 0:It.endIndex)!==null&&Ue!==void 0?Ue:Ie,qe=_e!==$e||Ge!==Ie,Xe=!gi(U),yt=Xe&&!qe?V.updateId:V.updateId+1;return ar(ar({updateId:yt},O(ar(ar({props:N},V),{},{updateId:yt,dataStartIndex:_e,dataEndIndex:Ge}),V)),{},{prevChildren:J,dataStartIndex:_e,dataEndIndex:Ge})}return null}),Sn(L,"renderActiveDot",function(N,V,G){var U;return ue.isValidElement(N)?U=ue.cloneElement(N,V):ai(N)?U=N(V):U=it.createElement(cN,V),it.createElement(lo,{className:"recharts-active-dot",key:G},U)});var R=ue.forwardRef(function(V,G){return it.createElement(L,ty({},V,{ref:G}))});return R.displayName=L.displayName,R},S9=Bee({chartName:"LineChart",GraphicalChild:ov,axisComponents:[{axisType:"xAxis",AxisComp:c0},{axisType:"yAxis",AxisComp:u0}],formatAxisMap:ree}),DWe=Bee({chartName:"BarChart",GraphicalChild:H0,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:c0},{axisType:"yAxis",AxisComp:u0}],formatAxisMap:ree});function Pu(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function M0(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const zee=6048e5,FWe=864e5;let LWe={};function pI(){return LWe}function qb(e,t){var i,v,w,S;const r=pI(),n=(t==null?void 0:t.weekStartsOn)??((v=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:v.weekStartsOn)??r.weekStartsOn??((S=(w=r.locale)==null?void 0:w.options)==null?void 0:S.weekStartsOn)??0,o=Pu(e),u=o.getDay(),d=(u<n?7:0)+u-n;return o.setDate(o.getDate()-d),o.setHours(0,0,0,0),o}function MC(e){return qb(e,{weekStartsOn:1})}function jee(e){const t=Pu(e),r=t.getFullYear(),n=M0(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const o=MC(n),u=M0(e,0);u.setFullYear(r,0,4),u.setHours(0,0,0,0);const d=MC(u);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function E9(e){const t=Pu(e);return t.setHours(0,0,0,0),t}function A9(e){const t=Pu(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function NWe(e,t){const r=E9(e),n=E9(t),o=+r-A9(r),u=+n-A9(n);return Math.round((o-u)/FWe)}function BWe(e){const t=jee(e),r=M0(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),MC(r)}function zWe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function jWe(e){if(!zWe(e)&&typeof e!="number")return!1;const t=Pu(e);return!isNaN(Number(t))}function UWe(e){const t=Pu(e),r=M0(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const $We={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},VWe=(e,t,r)=>{let n;const o=$We[e];return typeof o=="string"?n=o:t===1?n=o.one:n=o.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function vy(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const WWe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},GWe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},HWe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qWe={date:vy({formats:WWe,defaultWidth:"full"}),time:vy({formats:GWe,defaultWidth:"full"}),dateTime:vy({formats:HWe,defaultWidth:"full"})},XWe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ZWe=(e,t,r,n)=>XWe[e];function fh(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let o;if(n==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):d;o=e.formattingValues[i]||e.formattingValues[d]}else{const d=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;o=e.values[i]||e.values[d]}const u=e.argumentCallback?e.argumentCallback(t):t;return o[u]}}const YWe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KWe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},JWe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QWe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eGe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tGe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rGe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},nGe={ordinalNumber:rGe,era:fh({values:YWe,defaultWidth:"wide"}),quarter:fh({values:KWe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fh({values:JWe,defaultWidth:"wide"}),day:fh({values:QWe,defaultWidth:"wide"}),dayPeriod:fh({values:eGe,defaultWidth:"wide",formattingValues:tGe,defaultFormattingWidth:"wide"})};function dh(e){return(t,r={})=>{const n=r.width,o=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],u=t.match(o);if(!u)return null;const d=u[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(i)?aGe(i,C=>C.test(d)):iGe(i,C=>C.test(d));let w;w=e.valueCallback?e.valueCallback(v):v,w=r.valueCallback?r.valueCallback(w):w;const S=t.slice(d.length);return{value:w,rest:S}}}function iGe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function aGe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Uee(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const o=n[0],u=t.match(e.parsePattern);if(!u)return null;let d=e.valueCallback?e.valueCallback(u[0]):u[0];d=r.valueCallback?r.valueCallback(d):d;const i=t.slice(o.length);return{value:d,rest:i}}}const oGe=/^(\d+)(th|st|nd|rd)?/i,sGe=/\d+/i,lGe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},cGe={any:[/^b/i,/^(a|c)/i]},uGe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hGe={any:[/1/i,/2/i,/3/i,/4/i]},fGe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dGe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pGe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},mGe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},gGe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_Ge={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},yGe={ordinalNumber:Uee({matchPattern:oGe,parsePattern:sGe,valueCallback:e=>parseInt(e,10)}),era:dh({matchPatterns:lGe,defaultMatchWidth:"wide",parsePatterns:cGe,defaultParseWidth:"any"}),quarter:dh({matchPatterns:uGe,defaultMatchWidth:"wide",parsePatterns:hGe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:dh({matchPatterns:fGe,defaultMatchWidth:"wide",parsePatterns:dGe,defaultParseWidth:"any"}),day:dh({matchPatterns:pGe,defaultMatchWidth:"wide",parsePatterns:mGe,defaultParseWidth:"any"}),dayPeriod:dh({matchPatterns:gGe,defaultMatchWidth:"any",parsePatterns:_Ge,defaultParseWidth:"any"})},vGe={code:"en-US",formatDistance:VWe,formatLong:qWe,formatRelative:ZWe,localize:nGe,match:yGe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xGe(e){const t=Pu(e);return NWe(t,UWe(t))+1}function wGe(e){const t=Pu(e),r=+MC(t)-+BWe(t);return Math.round(r/zee)+1}function $ee(e,t){var S,C,k,O;const r=Pu(e),n=r.getFullYear(),o=pI(),u=(t==null?void 0:t.firstWeekContainsDate)??((C=(S=t==null?void 0:t.locale)==null?void 0:S.options)==null?void 0:C.firstWeekContainsDate)??o.firstWeekContainsDate??((O=(k=o.locale)==null?void 0:k.options)==null?void 0:O.firstWeekContainsDate)??1,d=M0(e,0);d.setFullYear(n+1,0,u),d.setHours(0,0,0,0);const i=qb(d,t),v=M0(e,0);v.setFullYear(n,0,u),v.setHours(0,0,0,0);const w=qb(v,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=w.getTime()?n:n-1}function bGe(e,t){var i,v,w,S;const r=pI(),n=(t==null?void 0:t.firstWeekContainsDate)??((v=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:v.firstWeekContainsDate)??r.firstWeekContainsDate??((S=(w=r.locale)==null?void 0:w.options)==null?void 0:S.firstWeekContainsDate)??1,o=$ee(e,t),u=M0(e,0);return u.setFullYear(o,0,n),u.setHours(0,0,0,0),qb(u,t)}function TGe(e,t){const r=Pu(e),n=+qb(r,t)-+bGe(r,t);return Math.round(n/zee)+1}function Zi(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const zd={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Zi(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Zi(r+1,2)},d(e,t){return Zi(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Zi(e.getHours()%12||12,t.length)},H(e,t){return Zi(e.getHours(),t.length)},m(e,t){return Zi(e.getMinutes(),t.length)},s(e,t){return Zi(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),o=Math.trunc(n*Math.pow(10,r-3));return Zi(o,t.length)}},R_={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},C9={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),o=n>0?n:1-n;return r.ordinalNumber(o,{unit:"year"})}return zd.y(e,t)},Y:function(e,t,r,n){const o=$ee(e,n),u=o>0?o:1-o;if(t==="YY"){const d=u%100;return Zi(d,2)}return t==="Yo"?r.ordinalNumber(u,{unit:"year"}):Zi(u,t.length)},R:function(e,t){const r=jee(e);return Zi(r,t.length)},u:function(e,t){const r=e.getFullYear();return Zi(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Zi(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Zi(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return zd.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Zi(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const o=TGe(e,n);return t==="wo"?r.ordinalNumber(o,{unit:"week"}):Zi(o,t.length)},I:function(e,t,r){const n=wGe(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Zi(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):zd.d(e,t)},D:function(e,t,r){const n=xGe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Zi(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const o=e.getDay(),u=(o-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(u);case"ee":return Zi(u,2);case"eo":return r.ordinalNumber(u,{unit:"day"});case"eee":return r.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(o,{width:"short",context:"formatting"});case"eeee":default:return r.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const o=e.getDay(),u=(o-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(u);case"cc":return Zi(u,t.length);case"co":return r.ordinalNumber(u,{unit:"day"});case"ccc":return r.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(o,{width:"narrow",context:"standalone"});case"cccccc":return r.day(o,{width:"short",context:"standalone"});case"cccc":default:return r.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),o=n===0?7:n;switch(t){case"i":return String(o);case"ii":return Zi(o,t.length);case"io":return r.ordinalNumber(o,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const o=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let o;switch(n===12?o=R_.noon:n===0?o=R_.midnight:o=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let o;switch(n>=17?o=R_.evening:n>=12?o=R_.afternoon:n>=4?o=R_.morning:o=R_.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return zd.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):zd.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Zi(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Zi(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):zd.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):zd.s(e,t)},S:function(e,t){return zd.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return I9(n);case"XXXX":case"XX":return jm(n);case"XXXXX":case"XXX":default:return jm(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return I9(n);case"xxxx":case"xx":return jm(n);case"xxxxx":case"xxx":default:return jm(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+P9(n,":");case"OOOO":default:return"GMT"+jm(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+P9(n,":");case"zzzz":default:return"GMT"+jm(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Zi(n,t.length)},T:function(e,t,r){const n=e.getTime();return Zi(n,t.length)}};function P9(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),o=Math.trunc(n/60),u=n%60;return u===0?r+String(o):r+String(o)+t+Zi(u,2)}function I9(e,t){return e%60===0?(e>0?"-":"+")+Zi(Math.abs(e)/60,2):jm(e,t)}function jm(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),o=Zi(Math.trunc(n/60),2),u=Zi(n%60,2);return r+o+t+u}const k9=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Vee=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},SGe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],o=r[2];if(!o)return k9(e,t);let u;switch(n){case"P":u=t.dateTime({width:"short"});break;case"PP":u=t.dateTime({width:"medium"});break;case"PPP":u=t.dateTime({width:"long"});break;case"PPPP":default:u=t.dateTime({width:"full"});break}return u.replace("{{date}}",k9(n,t)).replace("{{time}}",Vee(o,t))},EGe={p:Vee,P:SGe},AGe=/^D+$/,CGe=/^Y+$/,PGe=["D","DD","YY","YYYY"];function IGe(e){return AGe.test(e)}function kGe(e){return CGe.test(e)}function OGe(e,t,r){const n=MGe(e,t,r);if(console.warn(n),PGe.includes(e))throw new RangeError(n)}function MGe(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const RGe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,DGe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,FGe=/^'([^]*?)'?$/,LGe=/''/g,NGe=/[a-zA-Z]/;function O9(e,t,r){var S,C,k,O,L,R,N,V;const n=pI(),o=(r==null?void 0:r.locale)??n.locale??vGe,u=(r==null?void 0:r.firstWeekContainsDate)??((C=(S=r==null?void 0:r.locale)==null?void 0:S.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((O=(k=n.locale)==null?void 0:k.options)==null?void 0:O.firstWeekContainsDate)??1,d=(r==null?void 0:r.weekStartsOn)??((R=(L=r==null?void 0:r.locale)==null?void 0:L.options)==null?void 0:R.weekStartsOn)??n.weekStartsOn??((V=(N=n.locale)==null?void 0:N.options)==null?void 0:V.weekStartsOn)??0,i=Pu(e);if(!jWe(i))throw new RangeError("Invalid time value");let v=t.match(DGe).map(G=>{const U=G[0];if(U==="p"||U==="P"){const J=EGe[U];return J(G,o.formatLong)}return G}).join("").match(RGe).map(G=>{if(G==="''")return{isToken:!1,value:"'"};const U=G[0];if(U==="'")return{isToken:!1,value:BGe(G)};if(C9[U])return{isToken:!0,value:G};if(U.match(NGe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:G}});o.localize.preprocessor&&(v=o.localize.preprocessor(i,v));const w={firstWeekContainsDate:u,weekStartsOn:d,locale:o};return v.map(G=>{if(!G.isToken)return G.value;const U=G.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&kGe(U)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&IGe(U))&&OGe(U,t,String(e));const J=C9[U[0]];return J(i,U,o.localize,w)}).join("")}function BGe(e){const t=e.match(FGe);return t?t[1].replace(LGe,"'"):e}const zGe={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},jGe=(e,t,r)=>{let n;const o=zGe[e];return typeof o=="string"?n=o:t===1?n=o.one:n=o.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+n:"h "+n:n},UGe={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},$Ge={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},VGe={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},WGe={date:vy({formats:UGe,defaultWidth:"full"}),time:vy({formats:$Ge,defaultWidth:"full"}),dateTime:vy({formats:VGe,defaultWidth:"full"})},GGe={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},HGe=(e,t,r,n)=>{const o=GGe[e];return typeof o=="function"?o(t):o},qGe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},XGe={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},ZGe={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},YGe={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},KGe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},JGe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},QGe=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"":r+""},eHe={ordinalNumber:QGe,era:fh({values:qGe,defaultWidth:"wide"}),quarter:fh({values:XGe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fh({values:ZGe,defaultWidth:"wide"}),day:fh({values:YGe,defaultWidth:"wide"}),dayPeriod:fh({values:KGe,defaultWidth:"wide",formattingValues:JGe,defaultFormattingWidth:"wide"})},tHe=/^(\d+)[o]?/i,rHe=/\d+/i,nHe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},iHe={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},aHe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},oHe={any:[/1/i,/2/i,/3/i,/4/i]},sHe={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},lHe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},cHe={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},uHe={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},hHe={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},fHe={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},dHe={ordinalNumber:Uee({matchPattern:tHe,parsePattern:rHe,valueCallback:e=>parseInt(e,10)}),era:dh({matchPatterns:nHe,defaultMatchWidth:"wide",parsePatterns:iHe,defaultParseWidth:"any"}),quarter:dh({matchPatterns:aHe,defaultMatchWidth:"wide",parsePatterns:oHe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:dh({matchPatterns:sHe,defaultMatchWidth:"wide",parsePatterns:lHe,defaultParseWidth:"any"}),day:dh({matchPatterns:cHe,defaultMatchWidth:"wide",parsePatterns:uHe,defaultParseWidth:"any"}),dayPeriod:dh({matchPatterns:hHe,defaultMatchWidth:"any",parsePatterns:fHe,defaultParseWidth:"any"})},M9={code:"pt-BR",formatDistance:jGe,formatLong:WGe,formatRelative:HGe,localize:eHe,match:dHe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function pHe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),t&&(n.href=t),o.href=e,o.href}const mHe=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function xp(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let D_=null;function Wee(e={}){return D_||(e.includeStyleProperties?(D_=e.includeStyleProperties,D_):(D_=xp(window.getComputedStyle(document.documentElement)),D_))}function RC(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function gHe(e){const t=RC(e,"border-left-width"),r=RC(e,"border-right-width");return e.clientWidth+t+r}function _He(e){const t=RC(e,"border-top-width"),r=RC(e,"border-bottom-width");return e.clientHeight+t+r}function Gee(e,t={}){const r=t.width||gHe(e),n=t.height||_He(e);return{width:r,height:n}}function yHe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Fl=16384;function vHe(e){(e.width>Fl||e.height>Fl)&&(e.width>Fl&&e.height>Fl?e.width>e.height?(e.height*=Fl/e.width,e.width=Fl):(e.width*=Fl/e.height,e.height=Fl):e.width>Fl?(e.height*=Fl/e.width,e.width=Fl):(e.width*=Fl/e.height,e.height=Fl))}function DC(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function xHe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function wHe(e,t,r){const n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),u=document.createElementNS(n,"foreignObject");return o.setAttribute("width",`${t}`),o.setAttribute("height",`${r}`),o.setAttribute("viewBox",`0 0 ${t} ${r}`),u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("externalResourcesRequired","true"),o.appendChild(u),u.appendChild(e),xHe(o)}const gl=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||gl(r,t)};function bHe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function THe(e,t){return Wee(t).map(r=>{const n=e.getPropertyValue(r),o=e.getPropertyPriority(r);return`${r}: ${n}${o?" !important":""};`}).join(" ")}function SHe(e,t,r,n){const o=`.${e}:${t}`,u=r.cssText?bHe(r):THe(r,n);return document.createTextNode(`${o}{${u}}`)}function R9(e,t,r,n){const o=window.getComputedStyle(e,r),u=o.getPropertyValue("content");if(u===""||u==="none")return;const d=mHe();try{t.className=`${t.className} ${d}`}catch{return}const i=document.createElement("style");i.appendChild(SHe(d,r,o,n)),t.appendChild(i)}function EHe(e,t,r){R9(e,t,":before",r),R9(e,t,":after",r)}const D9="application/font-woff",F9="image/jpeg",AHe={woff:D9,woff2:D9,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:F9,jpeg:F9,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function CHe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function vN(e){const t=CHe(e).toLowerCase();return AHe[t]||""}function PHe(e){return e.split(/,/)[1]}function XD(e){return e.search(/^(data:)/)!==-1}function IHe(e,t){return`data:${t};base64,${e}`}async function Hee(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const o=await n.blob();return new Promise((u,d)=>{const i=new FileReader;i.onerror=d,i.onloadend=()=>{try{u(r({res:n,result:i.result}))}catch(v){d(v)}},i.readAsDataURL(o)})}const KM={};function kHe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function xN(e,t,r){const n=kHe(e,t,r.includeQueryParams);if(KM[n]!=null)return KM[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let o;try{const u=await Hee(e,r.fetchRequestInit,({res:d,result:i})=>(t||(t=d.headers.get("Content-Type")||""),PHe(i)));o=IHe(u,t)}catch(u){o=r.imagePlaceholder||"";let d=`Failed to fetch resource: ${e}`;u&&(d=typeof u=="string"?u:u.message),d&&console.warn(d)}return KM[n]=o,o}async function OHe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):DC(t)}async function MHe(e,t){if(e.currentSrc){const u=document.createElement("canvas"),d=u.getContext("2d");u.width=e.clientWidth,u.height=e.clientHeight,d==null||d.drawImage(e,0,0,u.width,u.height);const i=u.toDataURL();return DC(i)}const r=e.poster,n=vN(r),o=await xN(r,n,t);return DC(o)}async function RHe(e,t){var r;try{if(!((r=e==null?void 0:e.contentDocument)===null||r===void 0)&&r.body)return await mI(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function DHe(e,t){return gl(e,HTMLCanvasElement)?OHe(e):gl(e,HTMLVideoElement)?MHe(e,t):gl(e,HTMLIFrameElement)?RHe(e,t):e.cloneNode(qee(e))}const FHe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",qee=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function LHe(e,t,r){var n,o;if(qee(t))return t;let u=[];return FHe(e)&&e.assignedNodes?u=xp(e.assignedNodes()):gl(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?u=xp(e.contentDocument.body.childNodes):u=xp(((o=e.shadowRoot)!==null&&o!==void 0?o:e).childNodes),u.length===0||gl(e,HTMLVideoElement)||await u.reduce((d,i)=>d.then(()=>mI(i,r)).then(v=>{v&&t.appendChild(v)}),Promise.resolve()),t}function NHe(e,t,r){const n=t.style;if(!n)return;const o=window.getComputedStyle(e);o.cssText?(n.cssText=o.cssText,n.transformOrigin=o.transformOrigin):Wee(r).forEach(u=>{let d=o.getPropertyValue(u);u==="font-size"&&d.endsWith("px")&&(d=`${Math.floor(parseFloat(d.substring(0,d.length-2)))-.1}px`),gl(e,HTMLIFrameElement)&&u==="display"&&d==="inline"&&(d="block"),u==="d"&&t.getAttribute("d")&&(d=`path(${t.getAttribute("d")})`),n.setProperty(u,d,o.getPropertyPriority(u))})}function BHe(e,t){gl(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),gl(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function zHe(e,t){if(gl(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(o=>e.value===o.getAttribute("value"));n&&n.setAttribute("selected","")}}function jHe(e,t,r){return gl(t,Element)&&(NHe(e,t,r),EHe(e,t,r),BHe(e,t),zHe(e,t)),t}async function UHe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let u=0;u<r.length;u++){const i=r[u].getAttribute("xlink:href");if(i){const v=e.querySelector(i),w=document.querySelector(i);!v&&w&&!n[i]&&(n[i]=await mI(w,t,!0))}}const o=Object.values(n);if(o.length){const u="http://www.w3.org/1999/xhtml",d=document.createElementNS(u,"svg");d.setAttribute("xmlns",u),d.style.position="absolute",d.style.width="0",d.style.height="0",d.style.overflow="hidden",d.style.display="none";const i=document.createElementNS(u,"defs");d.appendChild(i);for(let v=0;v<o.length;v++)i.appendChild(o[v]);e.appendChild(d)}return e}async function mI(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>DHe(n,t)).then(n=>LHe(e,n,t)).then(n=>jHe(e,n,t)).then(n=>UHe(n,t))}const Xee=/url\((['"]?)([^'"]+?)\1\)/g,$He=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,VHe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function WHe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function GHe(e){const t=[];return e.replace(Xee,(r,n,o)=>(t.push(o),r)),t.filter(r=>!XD(r))}async function HHe(e,t,r,n,o){try{const u=r?pHe(t,r):t,d=vN(t);let i;return o||(i=await xN(u,d,n)),e.replace(WHe(t),`$1${i}$3`)}catch{}return e}function qHe(e,{preferredFontFormat:t}){return t?e.replace(VHe,r=>{for(;;){const[n,,o]=$He.exec(r)||[];if(!o)return"";if(o===t)return`src: ${n};`}}):e}function Zee(e){return e.search(Xee)!==-1}async function Yee(e,t,r){if(!Zee(e))return e;const n=qHe(e,r);return GHe(n).reduce((u,d)=>u.then(i=>HHe(i,d,t,r)),Promise.resolve(n))}async function F_(e,t,r){var n;const o=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(o){const u=await Yee(o,null,r);return t.style.setProperty(e,u,t.style.getPropertyPriority(e)),!0}return!1}async function XHe(e,t){await F_("background",e,t)||await F_("background-image",e,t),await F_("mask",e,t)||await F_("-webkit-mask",e,t)||await F_("mask-image",e,t)||await F_("-webkit-mask-image",e,t)}async function ZHe(e,t){const r=gl(e,HTMLImageElement);if(!(r&&!XD(e.src))&&!(gl(e,SVGImageElement)&&!XD(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,o=await xN(n,vN(n),t);await new Promise((u,d)=>{e.onload=u,e.onerror=t.onImageErrorHandler?(...v)=>{try{u(t.onImageErrorHandler(...v))}catch(w){d(w)}}:d;const i=e;i.decode&&(i.decode=u),i.loading==="lazy"&&(i.loading="eager"),r?(e.srcset="",e.src=o):e.href.baseVal=o})}async function YHe(e,t){const n=xp(e.childNodes).map(o=>Kee(o,t));await Promise.all(n).then(()=>e)}async function Kee(e,t){gl(e,Element)&&(await XHe(e,t),await ZHe(e,t),await YHe(e,t))}function KHe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(o=>{r[o]=n[o]}),e}const L9={};async function N9(e){let t=L9[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},L9[e]=t,t}async function B9(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,u=(r.match(/url\([^)]+\)/g)||[]).map(async d=>{let i=d.replace(n,"$1");return i.startsWith("https://")||(i=new URL(i,e.url).href),Hee(i,t.fetchRequestInit,({result:v})=>(r=r.replace(d,`url(${v})`),[d,v]))});return Promise.all(u).then(()=>r)}function z9(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const v=o.exec(n);if(v===null)break;t.push(v[0])}n=n.replace(o,"");const u=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,d="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",i=new RegExp(d,"gi");for(;;){let v=u.exec(n);if(v===null){if(v=i.exec(n),v===null)break;u.lastIndex=i.lastIndex}else i.lastIndex=u.lastIndex;t.push(v[0])}return t}async function JHe(e,t){const r=[],n=[];return e.forEach(o=>{if("cssRules"in o)try{xp(o.cssRules||[]).forEach((u,d)=>{if(u.type===CSSRule.IMPORT_RULE){let i=d+1;const v=u.href,w=N9(v).then(S=>B9(S,t)).then(S=>z9(S).forEach(C=>{try{o.insertRule(C,C.startsWith("@import")?i+=1:o.cssRules.length)}catch(k){console.error("Error inserting rule from remote css",{rule:C,error:k})}})).catch(S=>{console.error("Error loading remote css",S.toString())});n.push(w)}})}catch(u){const d=e.find(i=>i.href==null)||document.styleSheets[0];o.href!=null&&n.push(N9(o.href).then(i=>B9(i,t)).then(i=>z9(i).forEach(v=>{d.insertRule(v,d.cssRules.length)})).catch(i=>{console.error("Error loading remote stylesheet",i)})),console.error("Error inlining remote css file",u)}}),Promise.all(n).then(()=>(e.forEach(o=>{if("cssRules"in o)try{xp(o.cssRules||[]).forEach(u=>{r.push(u)})}catch(u){console.error(`Error while reading CSS rules from ${o.href}`,u)}}),r))}function QHe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Zee(t.style.getPropertyValue("src")))}async function eqe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=xp(e.ownerDocument.styleSheets),n=await JHe(r,t);return QHe(n)}function Jee(e){return e.trim().replace(/["']/g,"")}function tqe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(u=>{t.add(Jee(u))}),Array.from(n.children).forEach(u=>{u instanceof HTMLElement&&r(u)})}return r(e),t}async function rqe(e,t){const r=await eqe(e,t),n=tqe(e);return(await Promise.all(r.filter(u=>n.has(Jee(u.style.fontFamily))).map(u=>{const d=u.parentStyleSheet?u.parentStyleSheet.href:null;return Yee(u.cssText,d,t)}))).join(`
`)}async function nqe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await rqe(e,t);if(r){const n=document.createElement("style"),o=document.createTextNode(r);n.appendChild(o),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function Qee(e,t={}){const{width:r,height:n}=Gee(e,t),o=await mI(e,t,!0);return await nqe(o,t),await Kee(o,t),KHe(o,t),await wHe(o,r,n)}async function ete(e,t={}){const{width:r,height:n}=Gee(e,t),o=await Qee(e,t),u=await DC(o),d=document.createElement("canvas"),i=d.getContext("2d"),v=t.pixelRatio||yHe(),w=t.canvasWidth||r,S=t.canvasHeight||n;return d.width=w*v,d.height=S*v,t.skipAutoScale||vHe(d),d.style.width=`${w}`,d.style.height=`${S}`,t.backgroundColor&&(i.fillStyle=t.backgroundColor,i.fillRect(0,0,d.width,d.height)),i.drawImage(u,0,0,d.width,d.height),d}async function iqe(e,t={}){return(await ete(e,t)).toDataURL()}async function aqe(e,t={}){return(await ete(e,t)).toDataURL("image/jpeg",t.quality||1)}const oqe=()=>{const{toast:e}=r2(),t=ue.useCallback(async(o,u="grafico-climatico")=>{try{const d=document.getElementById(o);if(!d)throw new Error("Elemento no encontrado");const i={quality:1,pixelRatio:2,backgroundColor:"#ffffff",width:d.offsetWidth*2,height:d.offsetHeight*2,style:{transform:"scale(2)",transformOrigin:"top left",width:`${d.offsetWidth}px`,height:`${d.offsetHeight}px`}},v=await iqe(d,i),w=document.createElement("a");return w.download=`${u}.png`,w.href=v,w.click(),e({title:"Imagem exportada!",description:`Grfico salvo como ${u}.png`}),!0}catch(d){return console.error("Erro ao exportar PNG:",d),e({title:"Erro na exportao",description:"Falha ao exportar grfico como PNG",variant:"destructive"}),!1}},[e]),r=ue.useCallback(async(o,u="grafico-climatico")=>{try{const d=document.getElementById(o);if(!d)throw new Error("Elemento no encontrado");const i=await Qee(d,{backgroundColor:"#ffffff",quality:1}),v=document.createElement("a");return v.download=`${u}.svg`,v.href=i,v.click(),e({title:"Imagem exportada!",description:`Grfico salvo como ${u}.svg`}),!0}catch(d){return console.error("Erro ao exportar SVG:",d),e({title:"Erro na exportao",description:"Falha ao exportar grfico como SVG",variant:"destructive"}),!1}},[e]),n=ue.useCallback(async(o,u="grafico-climatico")=>{try{const d=document.getElementById(o);if(!d)throw new Error("Elemento no encontrado");const v=await aqe(d,{quality:.95,pixelRatio:2,backgroundColor:"#ffffff"}),w=document.createElement("a");return w.download=`${u}.jpg`,w.href=v,w.click(),e({title:"Imagem exportada!",description:`Grfico salvo como ${u}.jpg`}),!0}catch(d){return console.error("Erro ao exportar JPEG:",d),e({title:"Erro na exportao",description:"Falha ao exportar grfico como JPEG",variant:"destructive"}),!1}},[e]);return{exportChartAsPNG:t,exportChartAsSVG:r,exportChartAsJPEG:n}},Z1=e=>({T2M:{name:"Temperatura",unit:"C",color:"#f97316"},T2M_MAX:{name:"Temp. Mxima",unit:"C",color:"#dc2626"},T2M_MIN:{name:"Temp. Mnima",unit:"C",color:"#2563eb"},RH2M:{name:"Umidade",unit:"%",color:"#3b82f6"},PRECTOTCORR:{name:"Precipitao",unit:"mm/dia",color:"#1d4ed8"},PS:{name:"Presso Atmosfrica",unit:"kPa",color:"#7c3aed"},WS10M:{name:"Velocidade do Vento",unit:"m/s",color:"#059669"},ALLSKY_SFC_SW_DWN:{name:"Radiao Solar",unit:"kWh/m/dia",color:"#ca8a04"}})[e]||{name:e,unit:"",color:"#6b7280"},sqe=({data:e,rawData:t})=>{const{exportChartAsPNG:r,exportChartAsSVG:n,exportChartAsJPEG:o}=oqe(),d=(()=>{if(!t||!t.properties||!t.properties.parameter)return[];const w=[],S=t.properties.parameter,C=Object.keys(S)[0];if(!C||!S[C])return[];const k=Object.keys(S[C]).sort(),O=Math.ceil(k.length/30);return k.filter((R,N)=>N%O===0).forEach(R=>{const N={};try{const V=parseInt(R.substring(0,4)),G=parseInt(R.substring(4,6)),U=parseInt(R.substring(6,8)),J=new Date(V,G-1,U);N.date=O9(J,"dd/MM",{locale:M9}),N.fullDate=O9(J,"dd/MM/yyyy",{locale:M9}),e.selectedParameters.forEach(Z=>{S[Z]&&S[Z][R]!==void 0&&(N[Z]=S[Z][R])}),w.push(N)}catch(V){console.warn("Erro ao processar data:",R,V)}}),w})();if(d.length===0)return be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsx(mh,{children:"Grficos Climticos"})}),be.jsx(mu,{children:be.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Dados insuficientes para gerar grficos"})})]});const i=e.selectedParameters.filter(w=>w.includes("T2M")||w.includes("TEMP")),v=e.selectedParameters.filter(w=>!w.includes("T2M")&&!w.includes("TEMP"));return be.jsxs("div",{className:"space-y-6",children:[be.jsx("h3",{className:"text-2xl font-bold text-foreground mb-4",children:"Visualizao dos Dados"}),i.length>0&&be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center justify-between",children:[be.jsx("span",{children:"Variao de Temperatura ao Longo do Tempo"}),be.jsxs("div",{className:"flex gap-2",children:[be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>r("temperature-chart","temperatura-climatica"),children:[be.jsx(qO,{className:"h-4 w-4 mr-1"}),"PNG"]}),be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>n("temperature-chart","temperatura-climatica"),children:[be.jsx(HO,{className:"h-4 w-4 mr-1"}),"SVG"]})]})]})}),be.jsx(mu,{children:be.jsx("div",{id:"temperature-chart",className:"h-80",children:be.jsx(RM,{width:"100%",height:"100%",children:be.jsxs(S9,{data:d,children:[be.jsx(zE,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),be.jsx(c0,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(u0,{stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(bc,{labelFormatter:w=>{var S;return`Data: ${((S=d.find(C=>C.date===w))==null?void 0:S.fullDate)||w}`},contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),be.jsx(_p,{}),i.map(w=>{const S=Z1(w);return be.jsx(ov,{type:"monotone",dataKey:w,stroke:S.color,strokeWidth:2,dot:{r:2},name:`${S.name} (${S.unit})`},w)})]})})})})]}),v.includes("PRECTOTCORR")&&be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center justify-between",children:[be.jsx("span",{children:"Precipitao ao Longo do Tempo"}),be.jsxs("div",{className:"flex gap-2",children:[be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>r("precipitation-chart","precipitacao-climatica"),children:[be.jsx(qO,{className:"h-4 w-4 mr-1"}),"PNG"]}),be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>n("precipitation-chart","precipitacao-climatica"),children:[be.jsx(HO,{className:"h-4 w-4 mr-1"}),"SVG"]})]})]})}),be.jsx(mu,{children:be.jsx("div",{id:"precipitation-chart",className:"h-80",children:be.jsx(RM,{width:"100%",height:"100%",children:be.jsxs(DWe,{data:d,children:[be.jsx(zE,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),be.jsx(c0,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(u0,{stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(bc,{labelFormatter:w=>{var S;return`Data: ${((S=d.find(C=>C.date===w))==null?void 0:S.fullDate)||w}`},contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),be.jsx(H0,{dataKey:"PRECTOTCORR",fill:Z1("PRECTOTCORR").color,name:`${Z1("PRECTOTCORR").name} (${Z1("PRECTOTCORR").unit})`})]})})})})]}),v.filter(w=>w!=="PRECTOTCORR").length>0&&be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center justify-between",children:[be.jsx("span",{children:"Outros Parmetros Climticos"}),be.jsxs("div",{className:"flex gap-2",children:[be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>r("other-params-chart","outros-parametros-climaticos"),children:[be.jsx(qO,{className:"h-4 w-4 mr-1"}),"PNG"]}),be.jsxs(Ec,{variant:"outline",size:"sm",onClick:()=>n("other-params-chart","outros-parametros-climaticos"),children:[be.jsx(HO,{className:"h-4 w-4 mr-1"}),"SVG"]})]})]})}),be.jsx(mu,{children:be.jsx("div",{id:"other-params-chart",className:"h-80",children:be.jsx(RM,{width:"100%",height:"100%",children:be.jsxs(S9,{data:d,children:[be.jsx(zE,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),be.jsx(c0,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(u0,{stroke:"hsl(var(--muted-foreground))",fontSize:12}),be.jsx(bc,{labelFormatter:w=>{var S;return`Data: ${((S=d.find(C=>C.date===w))==null?void 0:S.fullDate)||w}`},contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),be.jsx(_p,{}),v.filter(w=>w!=="PRECTOTCORR").map(w=>{const S=Z1(w);return be.jsx(ov,{type:"monotone",dataKey:w,stroke:S.color,strokeWidth:2,dot:{r:2},name:`${S.name} (${S.unit})`},w)})]})})})})]})]})};var tte={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(K1,function(){var r,n,o;function u(i,v){if(!r)r=v;else if(!n)n=v;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",S={};r(S),o=v(S),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}u(["exports"],function(i){var v=1e-6,w=typeof Float32Array<"u"?Float32Array:Array;function S(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=l*_-p*f;return y?(c[0]=_*(y=1/y),c[1]=-f*y,c[2]=-p*y,c[3]=l*y,c):null}function C(){var c=new w(9);return w!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function k(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=a[4],T=a[5],A=a[6],I=a[7],D=a[8];return c[0]=y*D-T*I,c[1]=p*I-f*D,c[2]=f*T-p*y,c[3]=T*A-_*D,c[4]=l*D-p*A,c[5]=p*_-l*T,c[6]=_*I-y*A,c[7]=f*A-l*I,c[8]=l*y-f*_,c}function O(c,a,l){var f=a[0],p=a[1],_=a[2],y=a[3],T=a[4],A=a[5],I=a[6],D=a[7],F=a[8],z=l[0],H=l[1],q=l[2],ne=l[3],ie=l[4],ae=l[5],me=l[6],ye=l[7],we=l[8];return c[0]=z*f+H*y+q*I,c[1]=z*p+H*T+q*D,c[2]=z*_+H*A+q*F,c[3]=ne*f+ie*y+ae*I,c[4]=ne*p+ie*T+ae*D,c[5]=ne*_+ie*A+ae*F,c[6]=me*f+ye*y+we*I,c[7]=me*p+ye*T+we*D,c[8]=me*_+ye*A+we*F,c}function L(){var c=new w(16);return w!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c}function R(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function N(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=a[4],T=a[5],A=a[6],I=a[7],D=a[8],F=a[9],z=a[10],H=a[11],q=a[12],ne=a[13],ie=a[14],ae=a[15],me=l*T-f*y,ye=l*A-p*y,we=l*I-_*y,Be=f*A-p*T,ze=f*I-_*T,Ve=p*I-_*A,Ze=D*ne-F*q,Ye=D*ie-z*q,Ct=D*ae-H*q,nt=F*ie-z*ne,kt=F*ae-H*ne,zt=z*ae-H*ie,Ot=me*zt-ye*kt+we*nt+Be*Ct-ze*Ye+Ve*Ze;return Ot?(c[0]=(T*zt-A*kt+I*nt)*(Ot=1/Ot),c[1]=(p*kt-f*zt-_*nt)*Ot,c[2]=(ne*Ve-ie*ze+ae*Be)*Ot,c[3]=(z*ze-F*Ve-H*Be)*Ot,c[4]=(A*Ct-y*zt-I*Ye)*Ot,c[5]=(l*zt-p*Ct+_*Ye)*Ot,c[6]=(ie*we-q*Ve-ae*ye)*Ot,c[7]=(D*Ve-z*we+H*ye)*Ot,c[8]=(y*kt-T*Ct+I*Ze)*Ot,c[9]=(f*Ct-l*kt-_*Ze)*Ot,c[10]=(q*ze-ne*we+ae*me)*Ot,c[11]=(F*we-D*ze-H*me)*Ot,c[12]=(T*Ye-y*nt-A*Ze)*Ot,c[13]=(l*nt-f*Ye+p*Ze)*Ot,c[14]=(ne*ye-q*Be-ie*me)*Ot,c[15]=(D*Be-F*ye+z*me)*Ot,c):null}function V(c,a,l){var f=a[0],p=a[1],_=a[2],y=a[3],T=a[4],A=a[5],I=a[6],D=a[7],F=a[8],z=a[9],H=a[10],q=a[11],ne=a[12],ie=a[13],ae=a[14],me=a[15],ye=l[0],we=l[1],Be=l[2],ze=l[3];return c[0]=ye*f+we*T+Be*F+ze*ne,c[1]=ye*p+we*A+Be*z+ze*ie,c[2]=ye*_+we*I+Be*H+ze*ae,c[3]=ye*y+we*D+Be*q+ze*me,c[4]=(ye=l[4])*f+(we=l[5])*T+(Be=l[6])*F+(ze=l[7])*ne,c[5]=ye*p+we*A+Be*z+ze*ie,c[6]=ye*_+we*I+Be*H+ze*ae,c[7]=ye*y+we*D+Be*q+ze*me,c[8]=(ye=l[8])*f+(we=l[9])*T+(Be=l[10])*F+(ze=l[11])*ne,c[9]=ye*p+we*A+Be*z+ze*ie,c[10]=ye*_+we*I+Be*H+ze*ae,c[11]=ye*y+we*D+Be*q+ze*me,c[12]=(ye=l[12])*f+(we=l[13])*T+(Be=l[14])*F+(ze=l[15])*ne,c[13]=ye*p+we*A+Be*z+ze*ie,c[14]=ye*_+we*I+Be*H+ze*ae,c[15]=ye*y+we*D+Be*q+ze*me,c}function G(c,a,l){var f,p,_,y,T,A,I,D,F,z,H,q,ne=l[0],ie=l[1],ae=l[2];return a===c?(c[12]=a[0]*ne+a[4]*ie+a[8]*ae+a[12],c[13]=a[1]*ne+a[5]*ie+a[9]*ae+a[13],c[14]=a[2]*ne+a[6]*ie+a[10]*ae+a[14],c[15]=a[3]*ne+a[7]*ie+a[11]*ae+a[15]):(p=a[1],_=a[2],y=a[3],T=a[4],A=a[5],I=a[6],D=a[7],F=a[8],z=a[9],H=a[10],q=a[11],c[0]=f=a[0],c[1]=p,c[2]=_,c[3]=y,c[4]=T,c[5]=A,c[6]=I,c[7]=D,c[8]=F,c[9]=z,c[10]=H,c[11]=q,c[12]=f*ne+T*ie+F*ae+a[12],c[13]=p*ne+A*ie+z*ae+a[13],c[14]=_*ne+I*ie+H*ae+a[14],c[15]=y*ne+D*ie+q*ae+a[15]),c}function U(c,a,l){var f=l[0],p=l[1],_=l[2];return c[0]=a[0]*f,c[1]=a[1]*f,c[2]=a[2]*f,c[3]=a[3]*f,c[4]=a[4]*p,c[5]=a[5]*p,c[6]=a[6]*p,c[7]=a[7]*p,c[8]=a[8]*_,c[9]=a[9]*_,c[10]=a[10]*_,c[11]=a[11]*_,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function J(c,a,l){var f=Math.sin(l),p=Math.cos(l),_=a[4],y=a[5],T=a[6],A=a[7],I=a[8],D=a[9],F=a[10],z=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=_*p+I*f,c[5]=y*p+D*f,c[6]=T*p+F*f,c[7]=A*p+z*f,c[8]=I*p-_*f,c[9]=D*p-y*f,c[10]=F*p-T*f,c[11]=z*p-A*f,c}function Z(c,a,l){var f=Math.sin(l),p=Math.cos(l),_=a[0],y=a[1],T=a[2],A=a[3],I=a[8],D=a[9],F=a[10],z=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=_*p-I*f,c[1]=y*p-D*f,c[2]=T*p-F*f,c[3]=A*p-z*f,c[8]=_*f+I*p,c[9]=y*f+D*p,c[10]=T*f+F*p,c[11]=A*f+z*p,c}function K(c,a,l){var f=Math.sin(l),p=Math.cos(l),_=a[0],y=a[1],T=a[2],A=a[3],I=a[4],D=a[5],F=a[6],z=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=_*p+I*f,c[1]=y*p+D*f,c[2]=T*p+F*f,c[3]=A*p+z*f,c[4]=I*p-_*f,c[5]=D*p-y*f,c[6]=F*p-T*f,c[7]=z*p-A*f,c}function re(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function ge(c,a,l){var f,p,_,y=l[0],T=l[1],A=l[2],I=Math.sqrt(y*y+T*T+A*A);return I<v?null:(y*=I=1/I,T*=I,A*=I,f=Math.sin(a),p=Math.cos(a),c[0]=y*y*(_=1-p)+p,c[1]=T*y*_+A*f,c[2]=A*y*_-T*f,c[3]=0,c[4]=y*T*_-A*f,c[5]=T*T*_+p,c[6]=A*T*_+y*f,c[7]=0,c[8]=y*A*_+T*f,c[9]=T*A*_-y*f,c[10]=A*A*_+p,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function ve(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=l+l,T=f+f,A=p+p,I=l*y,D=f*y,F=f*T,z=p*y,H=p*T,q=p*A,ne=_*y,ie=_*T,ae=_*A;return c[0]=1-F-q,c[1]=D+ae,c[2]=z-ie,c[3]=0,c[4]=D-ae,c[5]=1-I-q,c[6]=H+ne,c[7]=0,c[8]=z+ie,c[9]=H-ne,c[10]=1-I-F,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}var $e=V;function Ie(){var c=new w(3);return w!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function ke(c){var a=new w(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function tt(c){var a=c[0],l=c[1],f=c[2];return Math.sqrt(a*a+l*l+f*f)}function Je(c,a,l){var f=new w(3);return f[0]=c,f[1]=a,f[2]=l,f}function et(c,a,l,f){return c[0]=a,c[1]=l,c[2]=f,c}function at(c,a,l){return c[0]=a[0]+l[0],c[1]=a[1]+l[1],c[2]=a[2]+l[2],c}function pt(c,a,l){return c[0]=a[0]-l[0],c[1]=a[1]-l[1],c[2]=a[2]-l[2],c}function ft(c,a,l){return c[0]=a[0]*l[0],c[1]=a[1]*l[1],c[2]=a[2]*l[2],c}function Ue(c,a,l){return c[0]=Math.min(a[0],l[0]),c[1]=Math.min(a[1],l[1]),c[2]=Math.min(a[2],l[2]),c}function It(c,a,l){return c[0]=Math.max(a[0],l[0]),c[1]=Math.max(a[1],l[1]),c[2]=Math.max(a[2],l[2]),c}function Rt(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c[2]=a[2]*l,c}function _e(c,a,l,f){return c[0]=a[0]+l[0]*f,c[1]=a[1]+l[1]*f,c[2]=a[2]+l[2]*f,c}function Ge(c,a){var l=a[0]-c[0],f=a[1]-c[1],p=a[2]-c[2];return l*l+f*f+p*p}function qe(c){var a=c[0],l=c[1],f=c[2];return a*a+l*l+f*f}function Xe(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c}function yt(c,a){var l=a[0],f=a[1],p=a[2],_=l*l+f*f+p*p;return _>0&&(_=1/Math.sqrt(_)),c[0]=a[0]*_,c[1]=a[1]*_,c[2]=a[2]*_,c}function Dt(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function Yt(c,a,l){var f=a[0],p=a[1],_=a[2],y=l[0],T=l[1],A=l[2];return c[0]=p*A-_*T,c[1]=_*y-f*A,c[2]=f*T-p*y,c}function St(c,a,l,f){var p=a[0],_=a[1],y=a[2];return c[0]=p+f*(l[0]-p),c[1]=_+f*(l[1]-_),c[2]=y+f*(l[2]-y),c}function Mt(c,a,l){var f=a[0],p=a[1],_=a[2],y=l[3]*f+l[7]*p+l[11]*_+l[15];return c[0]=(l[0]*f+l[4]*p+l[8]*_+l[12])/(y=y||1),c[1]=(l[1]*f+l[5]*p+l[9]*_+l[13])/y,c[2]=(l[2]*f+l[6]*p+l[10]*_+l[14])/y,c}function Sr(c,a,l){var f=a[0],p=a[1],_=a[2];return c[0]=f*l[0]+p*l[3]+_*l[6],c[1]=f*l[1]+p*l[4]+_*l[7],c[2]=f*l[2]+p*l[5]+_*l[8],c}function Ne(c,a,l){var f=l[0],p=l[1],_=l[2],y=l[3],T=a[0],A=a[1],I=a[2],D=p*I-_*A,F=_*T-f*I,z=f*A-p*T;return c[0]=T+y*(D+=D)+p*(z+=z)-_*(F+=F),c[1]=A+y*F+_*D-f*z,c[2]=I+y*z+f*F-p*D,c}function un(c){return c[0]=0,c[1]=0,c[2]=0,c}function kr(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]}var Br=pt,Yr=ft,Tr=tt;function jn(){var c=new w(4);return w!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function Un(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c[2]=a[2]*l,c[3]=a[3]*l,c}function Wi(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=l*l+f*f+p*p+_*_;return y>0&&(y=1/Math.sqrt(y)),c[0]=l*y,c[1]=f*y,c[2]=p*y,c[3]=_*y,c}function Yn(c,a,l){var f=a[0],p=a[1],_=a[2],y=a[3];return c[0]=l[0]*f+l[4]*p+l[8]*_+l[12]*y,c[1]=l[1]*f+l[5]*p+l[9]*_+l[13]*y,c[2]=l[2]*f+l[6]*p+l[10]*_+l[14]*y,c[3]=l[3]*f+l[7]*p+l[11]*_+l[15]*y,c}function ta(){var c=new w(4);return w!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Di(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function ra(c,a,l){l*=.5;var f=a[0],p=a[1],_=a[2],y=a[3],T=Math.sin(l),A=Math.cos(l);return c[0]=f*A+y*T,c[1]=p*A+_*T,c[2]=_*A-p*T,c[3]=y*A-f*T,c}function Ra(c,a,l){l*=.5;var f=a[0],p=a[1],_=a[2],y=a[3],T=Math.sin(l),A=Math.cos(l);return c[0]=f*A-_*T,c[1]=p*A+y*T,c[2]=_*A+f*T,c[3]=y*A-p*T,c}Ie(),jn();var ei,na,wa,Da=Wi,_n=(ei=Ie(),na=Je(1,0,0),wa=Je(0,1,0),function(c,a,l){var f=Dt(a,l);return f<-.999999?(Yt(ei,na,a),Tr(ei)<1e-6&&Yt(ei,wa,a),yt(ei,ei),function(p,_,y){y*=.5;var T=Math.sin(y);p[0]=T*_[0],p[1]=T*_[1],p[2]=T*_[2],p[3]=Math.cos(y)}(c,ei,Math.PI),c):f>.999999?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(Yt(ei,a,l),c[0]=ei[0],c[1]=ei[1],c[2]=ei[2],c[3]=1+f,Da(c,c))});function Nn(){var c=new w(2);return w!=Float32Array&&(c[0]=0,c[1]=0),c}function Gi(c,a){var l=new w(2);return l[0]=c,l[1]=a,l}function ji(c,a,l){return c[0]=a,c[1]=l,c}function ba(c,a,l){return c[0]=a[0]+l[0],c[1]=a[1]+l[1],c}function Bo(c,a,l){return c[0]=a[0]-l[0],c[1]=a[1]-l[1],c}function uo(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c}function xl(c){var a=c[0],l=c[1];return Math.sqrt(a*a+l*l)}function ti(c,a){var l=a[0],f=a[1],p=l*l+f*f;return p>0&&(p=1/Math.sqrt(p)),c[0]=a[0]*p,c[1]=a[1]*p,c}function ia(c,a){return c[0]*a[0]+c[1]*a[1]}ta(),ta(),C();var wl,bl,To=Bo;function ro(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}Nn();var jc=function(){if(bl)return wl;function c(a,l,f,p){this.cx=3*a,this.bx=3*(f-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=l,this.p2x=f,this.p2y=p}return bl=1,wl=c,c.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,l){if(l===void 0&&(l=1e-6),a<0)return 0;if(a>1)return 1;for(var f=a,p=0;p<8;p++){var _=this.sampleCurveX(f)-a;if(Math.abs(_)<l)return f;var y=this.sampleCurveDerivativeX(f);if(Math.abs(y)<1e-6)break;f-=_/y}var T=0,A=1;for(f=a,p=0;p<20&&(_=this.sampleCurveX(f),!(Math.abs(_-a)<l));p++)a>_?T=f:A=f,f=.5*(A-T)+T;return f},solve:function(a,l){return this.sampleCurveY(this.solveCurveX(a,l))}},wl}(),yn=ro(jc);function Pt(c,a){this.x=c,this.y=a}function si(c,a){if(Array.isArray(c)){if(!Array.isArray(a)||c.length!==a.length)return!1;for(let l=0;l<c.length;l++)if(!si(c[l],a[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&a!==null){if(typeof a!="object"||Object.keys(c).length!==Object.keys(a).length)return!1;for(const l in c)if(!si(c[l],a[l]))return!1;return!0}return c===a}Pt.prototype={clone(){return new Pt(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,a){return this.clone()._rotateAround(c,a)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const a=c.x-this.x,l=c.y-this.y;return a*a+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult(c){const a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const a=Math.cos(c),l=Math.sin(c),f=l*this.x+a*this.y;return this.x=a*this.x-l*this.y,this.y=f,this},_rotateAround(c,a){const l=Math.cos(c),f=Math.sin(c),p=a.y+f*(this.x-a.x)+l*(this.y-a.y);return this.x=a.x+l*(this.x-a.x)-f*(this.y-a.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Pt},Pt.convert=function(c){if(c instanceof Pt)return c;if(Array.isArray(c))return new Pt(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new Pt(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};const So=Math.PI/180,Ha=180/Math.PI;function Qe(c){return c*So}function se(c){return c*Ha}const he=[[0,0],[1,0],[1,1],[0,1]];function Pe(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,l=a*c;return 4*(c<.5?l:3*(c-a)+l-.75)}function We(c,a,l,f){const p=new yn(c,a,l,f);return function(_){return p.solve(_)}}const je=We(.25,.1,.25,1);function Q(c,a,l){return Math.min(l,Math.max(a,c))}function pe(c,a,l){return(l=Q((l-c)/(a-c),0,1))*l*(3-2*l)}function le(c,a,l){const f=l-a,p=((c-a)%f+f)%f+a;return p===a?l:p}function fe(c,a,l){if(!c.length)return l(null,[]);let f=c.length;const p=new Array(c.length);let _=null;c.forEach((y,T)=>{a(y,(A,I)=>{A&&(_=A),p[T]=I,--f==0&&l(_,p)})})}let Se=1;function Te(){return Se++}function ot(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log2(c)))}function wt(c,a){c.forEach(l=>{a[l]&&(a[l]=a[l].bind(a))})}function mt(c,a,l){const f={};for(const p in c)f[p]=a.call(this,c[p],p,c);return f}function bt(c,a,l){const f={};for(const p in c)a.call(this,c[p],p,c)&&(f[p]=c[p]);return f}function xt(c){return Array.isArray(c)?c.map(xt):typeof c=="object"&&c?mt(c,xt):c}function Xt(c,a){for(let l=0;l<c.length;l++)if(a.indexOf(c[l])>=0)return!0;return!1}const cr={};function nr(c){cr[c]||(typeof console<"u"&&console.warn(c),cr[c]=!0)}function ur(c,a,l){return(l.y-c.y)*(a.x-c.x)>(a.y-c.y)*(l.x-c.x)}function Ar(c){let a=0;for(let l,f,p=0,_=c.length,y=_-1;p<_;y=p++)l=c[p],f=c[y],a+=(f.x-l.x)*(l.y+f.y);return a}function Kr([c,a,l]){const f=Qe(a+90),p=Qe(l);return{x:c*Math.cos(f)*Math.sin(p),y:c*Math.sin(f)*Math.sin(p),z:c*Math.cos(p),azimuthal:a,polar:l}}function an(c){return(typeof self<"u"||c!==void 0)&&typeof WorkerGlobalScope<"u"&&(c!==void 0?c:self)instanceof WorkerGlobalScope}function Hr(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,f,p,_)=>{const y=p||_;return a[f]=!y||y.toLowerCase(),""}),a["max-age"]){const l=parseInt(a["max-age"],10);isNaN(l)?delete a["max-age"]:a["max-age"]=l}return a}let En=null;function li(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}function $n(c,a,l,f){for(;a<l;){const p=a+l>>1;c[p]<f?a=p+1:l=p}return a}function ca(c,a,l,f){for(;a<l;){const p=a+l>>1;c[p]<=f?a=p+1:l=p}return a}function da(c){return c>0?1/(1.001-c):1+c}function Eo(c){return c>0?1-1/(1.001-c):-c}function no(c,a,l){return(c-a.min)*(l.max-l.min)/(a.max-a.min)+l.min}const Ao={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ao.API_URL)return null;try{const c=new URL(Ao.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Hf(c){return Ao.API_URL_REGEX.test(c)}function I2(c){return Ao.API_SPRITE_REGEX.test(c)}let Iu,qf,Vp,Wp,ku,Gp;function Rv(){return Iu==null&&(Iu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Iu}const tc={now:()=>Wp!==void 0?Wp:performance.now(),setNow(c){Wp=c},restoreNow(){Wp=void 0},frame(c){const a=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:l,height:f}=c;ku||(ku=document.createElement("canvas"));const p=ku.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>ku.width||f>ku.height)&&(ku.width=l,ku.height=f),p.clearRect(-a,-a,l+2*a,f+2*a),p.drawImage(c,0,0,l,f),p.getImageData(-a,-a,l+2*a,f+2*a)},resolveURL:c=>(qf||(qf=document.createElement("a")),qf.href=c,qf.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Vp==null&&(Vp=window.matchMedia("(prefers-reduced-motion: reduce)")),Vp.matches)},hasCanvasFingerprintNoise(){if(Gp!==void 0)return Gp;if(!Rv())return Gp=!1,!1;const c=new OffscreenCanvas(85,1),a=c.getContext("2d",{willReadFrequently:!0});let l=0;for(let p=0;p<c.width;++p)a.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,a.fillRect(p,0,1,1);const f=a.getImageData(0,0,c.width,c.height);l=0;for(let p=0;p<f.data.length;++p)if(p%4!=3&&l++!==f.data[p])return Gp=!0,!0;return Gp=!1,!1}};function Dv(c,a){const l=c.indexOf("?");if(l<0)return`${c}?${new URLSearchParams(a).toString()}`;const f=new URLSearchParams(c.slice(l));for(const p in a)f.set(p,a[p]);return`${c.slice(0,l)}?${f.toString()}`}function q0(c,a={persistentParams:[]}){const l=c.indexOf("?");if(l<0)return c;const f=new URLSearchParams,p=new URLSearchParams(c.slice(l));for(const y of a.persistentParams){const T=p.get(y);T&&f.set(y,T)}const _=f.toString();return`${c.slice(0,l)}${_.length>0?`?${_}`:""}`}const Ls="mapbox-tiles";let Tl=500,Uc=50;const Sl=["language","worldview","jobid"];let zo,Dh;function Fv(){try{return caches}catch{}}function Hp(){const c=Fv();c&&zo==null&&(zo=c.open(Ls))}let Ou=1/0;const qp={supported:!1,testSupport:function(c){!Ns&&Xf&&(Lv?Zf(c):Xp=c)}};let Xp,Xf,Ns=!1,Lv=!1;const X0=typeof self<"u"?self:{};function Zf(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Xf),c.isContextLost())return;qp.supported=!0}catch{}c.deleteTexture(a),Ns=!0}X0.document&&(Xf=X0.document.createElement("img"),Xf.onload=function(){Xp&&Zf(Xp),Xp=null,Lv=!0},Xf.onerror=function(){Ns=!0,Xp=null},Xf.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Z0={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Z0);class Nv extends Error{constructor(a,l,f){l===401&&Hf(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=l,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Y0=an()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mn=function(c,a){if(!(/^file:/.test(l=c.url)||/^file:/.test(Y0())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,p){const _=new AbortController,y=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Y0(),referrerPolicy:f.referrerPolicy,signal:_.signal});let T=!1,A=!1;const I=(D=y.url).indexOf("sku=")>0&&Hf(D);var D;f.type==="json"&&y.headers.set("Accept","application/json");const F=(H,q,ne)=>{if(A)return;if(H&&H.message!=="SecurityError"&&nr(H.toString()),q&&ne)return z(q);const ie=Date.now();fetch(y).then(ae=>{if(ae.ok){const me=I?ae.clone():null;return z(ae,me,ie)}return p(new Nv(ae.statusText,ae.status,f.url))}).catch(ae=>{ae.name!=="AbortError"&&p(new Error(`${ae.message} ${f.url}`))})},z=(H,q,ne)=>{(f.type==="arrayBuffer"?H.arrayBuffer():f.type==="json"?H.json():H.text()).then(ie=>{A||(q&&ne&&function(ae,me,ye){if(Hp(),zo==null)return;const we=Hr(me.headers.get("Cache-Control")||"");if(we["no-store"])return;const Be={status:me.status,statusText:me.statusText,headers:new Headers};me.headers.forEach((Ze,Ye)=>Be.headers.set(Ye,Ze)),we["max-age"]&&Be.headers.set("Expires",new Date(ye+1e3*we["max-age"]).toUTCString());const ze=Be.headers.get("Expires");if(!ze||new Date(ze).getTime()-ye<42e4)return;let Ve=q0(ae.url,{persistentParams:Sl});if(me.status===206){const Ze=ae.headers.get("Range");if(!Ze)return;Be.status=200,Ve=Dv(Ve,{range:Ze})}(function(Ze,Ye){if(Dh===void 0)try{new Response(new ReadableStream),Dh=!0}catch{Dh=!1}Dh?Ye(Ze.body):Ze.blob().then(Ye).catch(Ct=>nr(Ct.message))})(me,Ze=>{const Ye=new Response((Ct=me.status)!==200&&Ct!==404&&[101,103,204,205,304].includes(Ct)?null:Ze,Be);var Ct;Hp(),zo!=null&&zo.then(nt=>nt.put(Ve,Ye)).catch(nt=>nr(nt.message))})}(y,q,ne),T=!0,p(null,ie,H.headers.get("Cache-Control"),H.headers.get("Expires")))}).catch(ie=>{A||p(new Error(ie.message))})};return I?function(H,q){if(Hp(),zo==null)return q(null);zo.then(ne=>{let ie=q0(H.url,{persistentParams:Sl});const ae=H.headers.get("Range");ae&&(ie=Dv(ie,{range:ae})),ne.match(ie).then(me=>{const ye=function(we){if(!we)return!1;const Be=new Date(we.headers.get("Expires")||0),ze=Hr(we.headers.get("Cache-Control")||"");return Number(Be)>Date.now()&&!ze["no-cache"]}(me);ne.delete(ie).catch(q),ye&&ne.put(ie,me.clone()).catch(q),q(null,me,ye)}).catch(q)}).catch(q)}(y,F):F(null,null),{cancel:()=>{A=!0,T||_.abort()}}}(c,a);if(an(self)&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var l;return function(f,p){const _=new XMLHttpRequest;_.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const y in f.headers)_.setRequestHeader(y,f.headers[y]);return f.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=f.credentials==="include",_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let y=_.response;if(f.type==="json")try{y=JSON.parse(_.response)}catch(T){return p(T)}p(null,y,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new Nv(_.statusText,_.status,f.url))},_.send(f.body),{cancel:()=>_.abort()}}(c,a)},Yf=function(c,a){return mn(Object.assign(c,{type:"arrayBuffer"}),a)};function k2(c){const a=document.createElement("a");return a.href=c,a.protocol===location.protocol&&a.host===location.host}const O2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let K0,Mu;K0=[],Mu=0;const Kf=function(c,a){if(qp.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Mu>=Ao.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return K0.push(_),_}Mu++;let l=!1;const f=()=>{if(!l)for(l=!0,Mu--;K0.length&&Mu<Ao.MAX_PARALLEL_IMAGE_REQUESTS;){const _=K0.shift(),{requestParameters:y,callback:T,cancelled:A}=_;A||(_.cancel=Kf(y,T).cancel)}},p=Yf(c,(_,y,T,A)=>{f(),_?a(_):y&&(self.createImageBitmap?function(I,D){const F=new Blob([new Uint8Array(I)],{type:"image/png"});createImageBitmap(F).then(z=>{D(null,z)}).catch(z=>{D(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(I,D)=>a(I,D,T,A)):function(I,D){const F=new Image;F.onload=()=>{D(null,F),URL.revokeObjectURL(F.src),F.onload=null,requestAnimationFrame(()=>{F.src=O2})},F.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(I)],{type:"image/png"});F.src=I.byteLength?URL.createObjectURL(z):O2}(y,(I,D)=>a(I,D,T,A)))});return{cancel:()=>{p.cancel(),f()}}};var Zp,J0,M2,Fh={exports:{}},R2={exports:{}},Bv={exports:{}},Jf=function(){if(M2)return Fh.exports;M2=1;var c=(Zp||(Zp=1,R2.exports=function(l,f){var p,_,y,T,A,I,D,F;for(_=l.length-(p=3&l.length),y=f,A=3432918353,I=461845907,F=0;F<_;)D=255&l.charCodeAt(F)|(255&l.charCodeAt(++F))<<8|(255&l.charCodeAt(++F))<<16|(255&l.charCodeAt(++F))<<24,++F,y=27492+(65535&(T=5*(65535&(y=(y^=D=(65535&(D=(D=(65535&D)*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(D=0,p){case 3:D^=(255&l.charCodeAt(F+2))<<16;case 2:D^=(255&l.charCodeAt(F+1))<<8;case 1:y^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(F)))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295}return y^=l.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),R2.exports),a=(J0||(J0=1,Bv.exports=function(l,f){for(var p,_=l.length,y=f^_,T=0;_>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(T)|(255&l.charCodeAt(++T))<<8|(255&l.charCodeAt(++T))<<16|(255&l.charCodeAt(++T))<<24))+((1540483477*(p>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),_-=4,++T;switch(_){case 3:y^=(255&l.charCodeAt(T+2))<<16;case 2:y^=(255&l.charCodeAt(T+1))<<8;case 1:y=1540483477*(65535&(y^=255&l.charCodeAt(T)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Bv.exports);return Fh.exports=c,Fh.exports.murmur3=c,Fh.exports.murmur2=a,Fh.exports}(),Q0=ro(Jf);class El{constructor(a,...l){Object.assign(this,l[0]||{}),this.type=a}}class Yp extends El{constructor(a,l={}){super("error",Object.assign({error:a},l))}}function eg(c,a,l){l[c]&&l[c].indexOf(a)!==-1||(l[c]=l[c]||[],l[c].push(a))}function Bs(c,a,l){if(l&&l[c]){const f=l[c].indexOf(a);f!==-1&&l[c].splice(f,1)}}class Lh{on(a,l){return this._listeners=this._listeners||{},eg(a,l,this._listeners),this}off(a,l){return Bs(a,l,this._listeners),Bs(a,l,this._oneTimeListeners),this}once(a,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},eg(a,l,this._oneTimeListeners),this):new Promise(f=>{this.once(a,f)})}fire(a,l){const f=typeof a=="string"?new El(a,l):a,p=f.type;if(this.listens(p)){f.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const A of _)A.call(this,f);const y=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const A of y)Bs(p,A,this._oneTimeListeners),A.call(this,f);const T=this._eventedParent;if(T){const A=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(f,A),T.fire(f)}}else f instanceof Yp&&console.error(f.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,l){return this._eventedParent=a,this._eventedParentData=l,this}}class zs{constructor(a){typeof a=="string"?this.name=a:(this.name=a.name,this.iconsetId=a.iconsetId)}static from(a){return new zs(a)}static toString(a){return a.iconsetId?`${a.name}${a.iconsetId}`:a.name}static parse(a){const[l,f]=a.split("");return new zs({name:l,iconsetId:f})}static isEqual(a,l){return a.name===l.name&&a.iconsetId===l.iconsetId}toString(){return zs.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var zv,tg={},jv=function(){if(zv)return tg;zv=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(_){return(_=Math.round(_))<0?0:_>255?255:_}function l(_){return a(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function f(_){return(y=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:y>1?1:y;var y}function p(_,y,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?_+(y-_)*T*6:2*T<1?y:3*T<2?_+(y-_)*(2/3-T)*6:_}try{tg.parseCSSColor=function(_){var y,T=_.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(y=parseInt(T.substr(1),16))>=0&&y<=4095?[(3840&y)>>4|(3840&y)>>8,240&y|(240&y)>>4,15&y|(15&y)<<4,1]:null:T.length===7&&(y=parseInt(T.substr(1),16))>=0&&y<=16777215?[(16711680&y)>>16,(65280&y)>>8,255&y,1]:null;var A=T.indexOf("("),I=T.indexOf(")");if(A!==-1&&I+1===T.length){var D=T.substr(0,A),F=T.substr(A+1,I-(A+1)).split(","),z=1;switch(D){case"rgba":if(F.length!==4)return null;z=f(F.pop());case"rgb":return F.length!==3?null:[l(F[0]),l(F[1]),l(F[2]),z];case"hsla":if(F.length!==4)return null;z=f(F.pop());case"hsl":if(F.length!==3)return null;var H=(parseFloat(F[0])%360+360)%360/360,q=f(F[1]),ne=f(F[2]),ie=ne<=.5?ne*(q+1):ne+q-ne*q,ae=2*ne-ie;return[a(255*p(ae,ie,H+1/3)),a(255*p(ae,ie,H)),a(255*p(ae,ie,H-1/3)),z];default:return null}}return null}}catch{}return tg}();class On{constructor(a,l,f,p=1){this.r=a,this.g=l,this.b=f,this.a=p}static parse(a){if(!a)return;if(a instanceof On)return a;if(typeof a!="string")return;const l=jv.parseCSSColor(a);return l?new On(l[0]/255,l[1]/255,l[2]/255,l[3]):void 0}toString(){const[a,l,f,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*a)},${Math.round(255*l)},${Math.round(255*f)},${p})`}toNonPremultipliedRenderColor(a){const{r:l,g:f,b:p,a:_}=this;return new D2(a,l,f,p,_)}toPremultipliedRenderColor(a){const{r:l,g:f,b:p,a:_}=this;return new rg(a,l*_,f*_,p*_,_)}clone(){return new On(this.r,this.g,this.b,this.a)}}class Uv{constructor(a,l,f,p,_,y=!1){if(this.premultiplied=!1,this.premultiplied=y,a){const T=a.image.height,A=T*T;this.premultiplied?(l=_===0?0:l/_*(T-1),f=_===0?0:f/_*(T-1),p=_===0?0:p/_*(T-1)):(l*=T-1,f*=T-1,p*=T-1);const I=Math.floor(l),D=Math.floor(f),F=Math.floor(p),z=Math.ceil(l),H=Math.ceil(f),q=Math.ceil(p),ne=l-I,ie=f-D,ae=p-F,me=a.image.data,ye=4*(I+D*A+F*T),we=4*(I+D*A+q*T),Be=4*(I+H*A+F*T),ze=4*(I+H*A+q*T),Ve=4*(z+D*A+F*T),Ze=4*(z+D*A+q*T),Ye=4*(z+H*A+F*T),Ct=4*(z+H*A+q*T);if(ye<0||Ct>=me.length)throw new Error("out of range");this.r=Ir(Ir(Ir(me[ye],me[we],ae),Ir(me[Be],me[ze],ae),ie),Ir(Ir(me[Ve],me[Ze],ae),Ir(me[Ye],me[Ct],ae),ie),ne)/255*(this.premultiplied?_:1),this.g=Ir(Ir(Ir(me[ye+1],me[we+1],ae),Ir(me[Be+1],me[ze+1],ae),ie),Ir(Ir(me[Ve+1],me[Ze+1],ae),Ir(me[Ye+1],me[Ct+1],ae),ie),ne)/255*(this.premultiplied?_:1),this.b=Ir(Ir(Ir(me[ye+2],me[we+2],ae),Ir(me[Be+2],me[ze+2],ae),ie),Ir(Ir(me[Ve+2],me[Ze+2],ae),Ir(me[Ye+2],me[Ct+2],ae),ie),ne)/255*(this.premultiplied?_:1),this.a=_}else this.r=l,this.g=f,this.b=p,this.a=_}toArray(){const{r:a,g:l,b:f,a:p}=this;return[255*a,255*l,255*f,p]}toHslaArray(){let{r:a,g:l,b:f,a:p}=this;if(this.premultiplied){if(p===0)return[0,0,0,0];const q=1/p;a*=q,l*=q,f*=q}const _=Math.min(Math.max(a,0),1),y=Math.min(Math.max(l,0),1),T=Math.min(Math.max(f,0),1),A=Math.min(_,y,T),I=Math.max(_,y,T),D=I-A,F=.5*(A+I);if(D===0)return[0,0,100*F,p];const z=F>.5?D/(2-I-A):D/(I+A);let H;switch(I){case _:H=60*((y-T)/D+(y<T?6:0));break;case y:H=60*((T-_)/D+2);break;default:H=60*((_-y)/D+4)}return[H,100*z,100*F,p]}toArray01(){const{r:a,g:l,b:f,a:p}=this;return[a,l,f,p]}toArray01Scaled(a){const{r:l,g:f,b:p}=this;return[l*a,f*a,p*a]}toArray01Linear(){const{r:a,g:l,b:f,a:p}=this;return[Math.pow(a,2.2),Math.pow(l,2.2),Math.pow(f,2.2),p]}}class D2 extends Uv{constructor(a,l,f,p,_){super(a,l,f,p,_,!1)}}class rg extends Uv{constructor(a,l,f,p,_){super(a,l,f,p,_,!0)}}function Ir(c,a,l){return c*(1-l)+a*l}function $v(c,a,l){return c.map((f,p)=>Ir(f,a[p],l))}On.black=new On(0,0,0,1),On.white=new On(1,1,1,1),On.transparent=new On(0,0,0,0),On.red=new On(1,0,0,1),On.blue=new On(0,0,1,1);var js=Object.freeze({__proto__:null,array:$v,color:function(c,a,l){return new On(Ir(c.r,a.r,l),Ir(c.g,a.g,l),Ir(c.b,a.b,l),Ir(c.a,a.a,l))},number:Ir});class Al extends Error{constructor(a,l){super(l),this.message=l,this.key=a}}class ng{constructor(a,l=[]){this.parent=a,this.bindings={};for(const[f,p]of l)this.bindings[f]=p}concat(a){return new ng(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const rc={kind:"null"},wr={kind:"number"},Mn={kind:"string"},Ln={kind:"boolean"},fs={kind:"color"},Nh={kind:"object"},An={kind:"value"},ig={kind:"collator"},Ru={kind:"formatted"},Kp={kind:"resolvedImage"};function Co(c,a){return{kind:"array",itemType:c,N:a}}function pa(c){if(c.kind==="array"){const a=pa(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const _I=[rc,wr,Mn,Ln,fs,Ru,Nh,Co(An),Kp];function Jp(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Jp(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const l of _I)if(!Jp(l,a))return null}}return`Expected ${pa(c)} but found ${pa(a)} instead.`}function Vv(c,a){return a.some(l=>l.kind===c.kind)}function Qp(c,a){return a.some(l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c)}function em(c,a){return c.kind==="array"&&a.kind==="array"?c.N===a.N&&em(c.itemType,a.itemType):c.kind===a.kind}class Du{constructor(a,l,f){this.sensitivity=a?l?"variant":"case":l?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,l){return this.collator.compare(a,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ag{constructor(a,l,f,p,_){this.text=a.normalize?a.normalize():a,this.image=l,this.scale=f,this.fontStack=p,this.textColor=_}}class jo{constructor(a){this.sections=a}static fromString(a){return new jo([new ag(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||!!a.image&&a.image.hasPrimary())}static factory(a){return a instanceof jo?a:jo.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const l of this.sections){if(l.image){const p=l.image.getPrimary().id.toString();a.push(["image",p]);continue}a.push(l.text);const f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toNonPremultipliedRenderColor(null).toArray())),a.push(f)}return a}}class Cl{constructor(a,l={}){if(this.id=zs.from(a),this.options=Object.assign({},l),l.transform){const{a:f,b:p,c:_,d:y,e:T,f:A}=l.transform;this.options.transform=new DOMMatrix([f,p,_,y,T,A])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a,b:l,c:f,d:p,e:_,f:y}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a,b:l,c:f,d:p,e:_,f:y}})}static parse(a){let l,f,p,_;try{({name:l,iconsetId:f,params:p,transform:_}=JSON.parse(a)||{})}catch{return null}if(!l)return null;const{a:y,b:T,c:A,d:I,e:D,f:F}=_||{};return new Cl({name:l,iconsetId:f},{params:p,transform:new DOMMatrix([y,T,A,I,D,F])})}scaleSelf(a,l){return this.options.transform.scaleSelf(a,l),this}}class ts{constructor(a,l,f,p,_=!1){this.primaryId=zs.from(a),this.primaryOptions=l,f&&(this.secondaryId=zs.from(f)),this.secondaryOptions=p,this.available=_}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Cl(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Cl(this.secondaryId,this.secondaryOptions):null}static from(a){return typeof a=="string"?ts.build({name:a}):a}static build(a,l,f,p){return!a||typeof a=="object"&&!("name"in a)?null:new ts(a,f,l,p)}}function F2(c,a,l,f){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof l=="number"&&l>=0&&l<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,a,l,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,a,l,f]:[c,a,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qf(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof On||c instanceof Du||c instanceof jo||c instanceof ts)return!0;if(Array.isArray(c)){for(const a of c)if(!Qf(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!Qf(c[a]))return!1;return!0}return!1}function Fa(c){if(c===null)return rc;if(typeof c=="string")return Mn;if(typeof c=="boolean")return Ln;if(typeof c=="number")return wr;if(c instanceof On)return fs;if(c instanceof Du)return ig;if(c instanceof jo)return Ru;if(c instanceof ts)return Kp;if(Array.isArray(c)){const a=c.length;let l;for(const f of c){const p=Fa(f);if(l){if(l===p)continue;l=An;break}l=p}return Co(l||An,a)}return Nh}function rs(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof jo||c instanceof ts||c instanceof On?c.toString():JSON.stringify(c)}class Zr{constructor(a,l){this.type=a,this.value=l}static parse(a,l){if(a.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Qf(a[1]))return l.error("invalid value");const f=a[1];let p=Fa(f);const _=l.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new Zr(p,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof On?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof jo?this.value.serialize():this.value}}class or{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const tm={string:Mn,number:wr,boolean:Ln,object:Nh};class Mr{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let f,p=1;const _=a[0];if(_==="array"){let T,A;if(a.length>2){const I=a[1];if(typeof I!="string"||!(I in tm)||I==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);T=tm[I],p++}else T=An;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return l.error('The length argument to "array" must be a positive integer literal',2);A=a[2],p++}f=Co(T,A)}else f=tm[_];const y=[];for(;p<a.length;p++){const T=l.parse(a[p],p,An);if(!T)return null;y.push(T)}return new Mr(f,y)}evaluate(a){for(let l=0;l<this.args.length;l++){const f=this.args[l].evaluate(a);if(!Jp(this.type,Fa(f)))return f;if(l===this.args.length-1)throw new or(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${pa(Fa(f))} but was expected to be of type ${pa(this.type)}.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,l=[a.kind];if(a.kind==="array"){const f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){l.push(f.kind);const p=a.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(f=>f.serialize()))}}class Bh{constructor(a){this.type=Ru,this.sections=a}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return l.error("First argument must be an image or text section.");const p=[];let _=!1;for(let y=1;y<=a.length-1;++y){const T=a[y];if(_&&typeof T=="object"&&!Array.isArray(T)){_=!1;let A=null;if(T["font-scale"]&&(A=l.parseObjectValue(T["font-scale"],y,"font-scale",wr),!A))return null;let I=null;if(T["text-font"]&&(I=l.parseObjectValue(T["text-font"],y,"text-font",Co(Mn)),!I))return null;let D=null;if(T["text-color"]&&(D=l.parseObjectValue(T["text-color"],y,"text-color",fs),!D))return null;const F=p[p.length-1];F.scale=A,F.font=I,F.textColor=D}else{const A=l.parse(a[y],y,An);if(!A)return null;const I=A.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:A,scale:null,font:null,textColor:null})}}return new Bh(p)}evaluate(a){return new jo(this.sections.map(l=>{const f=l.content.evaluate(a);return em(Fa(f),Kp)?new ag("",f,null,null,null):new ag(rs(f),null,l.scale?l.scale.evaluate(a):null,l.font?l.font.evaluate(a).join(","):null,l.textColor?l.textColor.evaluate(a):null)}))}eachChild(a){for(const l of this.sections)a(l.content),l.scale&&a(l.scale),l.font&&a(l.font),l.textColor&&a(l.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const l of this.sections){a.push(l.content.serialize());const f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),a.push(f)}return a}}class ed{constructor(a,l,f,p){this._imageWarnHistory={},this.type=Kp,this.namePrimary=a,this.nameSecondary=l,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(a,l){if(a.length<2)return l.error("Expected two or more arguments.");let f=1;const p=[];function _(){if(f<a.length){const T=l.parse(a[f],f++,Mn);return T?(p.push({image:T,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function y(){if(f<a.length){const A=a[f];if((T=A)===null||typeof T!="object"||Array.isArray(T))return!0;const I=A.params,D=A.iconset,F=l.concat(f);if(!I&&!D)return f++,!0;if(I){if(typeof I!="object"||I.constructor!==Object)return F.error('Image options "params" should be an object'),!1;const z={},H=F.concat(void 0,"params");for(const q in I){if(!q)return H.error("Image parameter name should be non-empty"),!1;const ne=H.concat(void 0,q).parse(I[q],void 0,fs,void 0,{typeAnnotation:"coerce"});if(!ne)return!1;z[q]=ne}p[p.length-1].options.params=z}if(D){if(typeof D!="object"||D.constructor!==Object)return F.error('Image options "iconset" should be an object'),!1;if(!D.id)return F.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=D}return f++,!0}var T;return!0}for(let T=0;T<2;T++)if(!_()||!y())return;return new ed(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(a,l){const f={};if(l){for(const p in l)if(l[p])try{f[p]=l[p].evaluate(a)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(a){const l={name:this.namePrimary.evaluate(a),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(a),iconsetId:this.iconsetIdSecondary}:void 0,p=ts.build(l,f,this.paramsPrimary?this.evaluateParams(a,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(a,this.paramsSecondary):void 0);if(p&&a.availableImages){const _=p.getPrimary().id;if(p.available=a.availableImages.some(y=>zs.isEqual(y,_)),p.available){const y=p.getSecondary()?p.getSecondary().id:null;y&&(p.available=a.availableImages.some(T=>zs.isEqual(T,y)))}}return p}eachChild(a){if(a(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&a(this.paramsPrimary[l]);if(this.nameSecondary&&(a(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&a(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(a,l){const f={};if(l&&(f.iconset={id:l}),a){f.params={};for(const p in a)a[p]&&(f.params[p]=a[p].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const a=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&a.push(l)}if(this.nameSecondary&&(a.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&a.push(l)}return a}}function Lr(c){return rm(c)?"string":nm(c)?"number":Gv(c)?"boolean":Array.isArray(c)?"array":c===null?"null":Wv(c)?"object":typeof c}function Wv(c){return c!=null&&!Array.isArray(c)&&typeof c!="function"&&!(c instanceof String||c instanceof Number||c instanceof Boolean)&&typeof c=="object"}function rm(c){return typeof c=="string"||c instanceof String}function nm(c){return typeof c=="number"||c instanceof Number}function Gv(c){return typeof c=="boolean"||c instanceof Boolean}const og={"to-boolean":Ln,"to-color":fs,"to-number":wr,"to-string":Mn};class aa{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const f=a[0],p=[];let _=rc;if(f==="to-array"){if(!Array.isArray(a[1]))return null;const y=a[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);_=Co(l.expectedType.itemType,y)}else{if(!(y>0&&Qf(a[1][0])))return null;_=Co(Fa(a[1][0]),y)}for(let T=0;T<y;T++){const A=a[1][T];let I;if(Array.isArray(A))I=l.parse(A,void 0,_.itemType);else{const D=Lr(A);if(D!==_.itemType.kind)return l.error(`Expected ${_.itemType.kind} but found ${D}.`);I=l.registry.literal.parse(["literal",A===void 0?null:A],l)}if(!I)return null;p.push(I)}}else{if((f==="to-boolean"||f==="to-string")&&a.length!==2)return l.error("Expected one argument.");_=og[f];for(let y=1;y<a.length;y++){const T=l.parse(a[y],y,An);if(!T)return null;p.push(T)}}return new aa(_,p)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let l,f;for(const p of this.args){if(l=p.evaluate(a),f=null,l instanceof On)return l;if(typeof l=="string"){const _=a.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(f=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:F2(l[0],l[1],l[2],l[3]),!f))return new On(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new or(f||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const f of this.args){if(l=f.evaluate(a),l===null)return 0;const p=Number(l);if(!isNaN(p))return p}throw new or(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?jo.fromString(rs(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?ts.build(rs(this.args[0].evaluate(a))):this.type.kind==="array"?this.args.map(l=>l.evaluate(a)):rs(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Bh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ed(this.args[0]).serialize();const a=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{a.push(l.serialize())}),a}}const Hv=["Unknown","Point","LineString","Polygon"];class $c{constructor(a,l,f){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=a,this.options=l,this.iconImageUseTheme=f}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Hv[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(a){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:f,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*l-a[0])+this.featureDistanceData.bearing[1]*(p*l-a[1])}return 0}parseColor(a){let l=this._parseColorCache[a];return l||(l=this._parseColorCache[a]=On.parse(a)),l}getConfig(a){return this.options?this.options.get(a):null}}class Uo{constructor(a,l,f,p,_){this.name=a,this.type=l,this._evaluate=f,this.args=p,this._overloadIndex=_}evaluate(a){if(!this._evaluate){const l=Uo.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,l){const f=a[0],p=Uo.definitions[f];if(!p)return l.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,y=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,T=[];let A=null,I=-1;for(const[D,F]of y){if(Array.isArray(D)&&D.length!==a.length-1)continue;T.push(D),I++,A=new wg(l.registry,l.path,null,l.scope,void 0,l._scope,l.options,l.iconImageUseTheme);const z=[];let H=!1;for(let q=1;q<a.length;q++){const ne=a[q],ie=Array.isArray(D)?D[q-1]:D.type,ae=A.parse(ne,1+z.length,ie);if(!ae){H=!0;break}z.push(ae)}if(!H)if(Array.isArray(D)&&D.length!==z.length)A.error(`Expected ${D.length} arguments, but found ${z.length} instead.`);else{for(let q=0;q<z.length;q++){const ne=Array.isArray(D)?D[q]:D.type,ie=z[q];A.concat(q+1).checkSubtype(ne,ie.type)}if(A.errors.length===0)return new Uo(f,_,F,z,I)}}if(T.length===1)l.errors.push(...A.errors);else{const D=(T.length?T:y.map(([z])=>z)).map(Fu).join(" | "),F=[];for(let z=1;z<a.length;z++){const H=l.parse(a[z],1+F.length);if(!H)return null;F.push(pa(H.type))}l.error(`Expected arguments of type ${D}, but found (${F.join(", ")}) instead.`)}return null}static register(a,l){Uo.definitions=l;for(const f in l)a[f]=Uo}}function Fu(c){return Array.isArray(c)?`(${c.map(pa).join(", ")})`:`(${pa(c.type)}...)`}class io{constructor(a,l,f){this.type=ig,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=l}static parse(a,l){if(a.length!==2)return l.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return l.error("Collator options argument must be an object.");const p=f["case-sensitive"]===void 0?l.parse(!1,1,Ln):l.parseObjectValue(f["case-sensitive"],1,"case-sensitive",Ln);if(!p)return null;const _=f["diacritic-sensitive"]===void 0?l.parse(!1,1,Ln):l.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",Ln);if(!_)return null;let y=null;return f.locale&&(y=l.parseObjectValue(f.locale,1,"locale",Mn),!y)?null:new io(p,_,y)}evaluate(a){return new Du(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}function L2(c,a,l=0,f=c.length-1,p=yI){for(;f>l;){if(f-l>600){const A=f-l+1,I=a-l+1,D=Math.log(A),F=.5*Math.exp(2*D/3),z=.5*Math.sqrt(D*F*(A-F)/A)*(I-A/2<0?-1:1);L2(c,a,Math.max(l,Math.floor(a-I*F/A+z)),Math.min(f,Math.floor(a+(A-I)*F/A+z)),p)}const _=c[a];let y=l,T=f;for(im(c,l,a),p(c[f],_)>0&&im(c,l,f);y<T;){for(im(c,y,T),y++,T--;p(c[y],_)<0;)y++;for(;p(c[T],_)>0;)T--}p(c[l],_)===0?im(c,l,T):(T++,im(c,T,f)),T<=a&&(l=T+1),a<=T&&(f=T-1)}}function im(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}function yI(c,a){return c<a?-1:c>a?1:0}function sg(c){let a=0;for(let l,f,p=0,_=c.length,y=_-1;p<_;y=p++)l=c[p],f=c[y],a+=(f.x-l.x)*(l.y+f.y);return a}function td(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function Pl(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function vI(c,a,l){const f=c[0]-a[0],p=c[1]-a[1],_=c[0]-l[0],y=c[1]-l[1];return f*y-_*p==0&&f*_<=0&&p*y<=0}function rd(c,a,l=!1){let f=!1;for(let T=0,A=a.length;T<A;T++){const I=a[T];for(let D=0,F=I.length,z=F-1;D<F;z=D++){const H=I[z],q=I[D];if(vI(c,H,q))return l;(_=H)[1]>(p=c)[1]!=(y=q)[1]>p[1]&&p[0]<(y[0]-_[0])*(p[1]-_[1])/(y[1]-_[1])+_[0]&&(f=!f)}}var p,_,y;return f}function N2(c,a,l,f){const p=f[0]-l[0],_=f[1]-l[1],y=(c[0]-l[0])*_-p*(c[1]-l[1]),T=(a[0]-l[0])*_-p*(a[1]-l[1]);return y>0&&T<0||y<0&&T>0}function lg(c,a,l,f){return(p=[f[0]-l[0],f[1]-l[1]])[0]*(_=[a[0]-c[0],a[1]-c[1]])[1]-p[1]*_[0]!=0&&!(!N2(c,a,l,f)||!N2(l,f,c,a));var p,_}function cg(c){const a=new Pt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new Pt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const f of c[0])a.x>f.x&&(a.x=f.x),a.y>f.y&&(a.y=f.y),l.x<f.x&&(l.x=f.x),l.y<f.y&&(l.y=f.y);return{min:a,max:l}}const Lu=8192;function zh(c,a){const l=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,p=Math.pow(2,a.z);return[Math.round(l*p*Lu),Math.round(f*p*Lu)]}function xI(c,a){for(let l=0;l<a.length;l++)if(rd(c,a[l]))return!0;return!1}function wI(c,a,l){for(const f of l)for(let p=0,_=f.length,y=_-1;p<_;y=p++)if(lg(c,a,f[y],f[p]))return!0;return!1}function ug(c,a){for(let l=0;l<c.length;++l)if(!rd(c[l],a))return!1;for(let l=0;l<c.length-1;++l)if(wI(c[l],c[l+1],a))return!1;return!0}function B2(c,a){for(let l=0;l<a.length;l++)if(ug(c,a[l]))return!0;return!1}function hg(c,a,l){const f=[];for(let p=0;p<c.length;p++){const _=[];for(let y=0;y<c[p].length;y++){const T=zh(c[p][y],l);td(a,T),_.push(T)}f.push(_)}return f}function il(c,a,l){const f=[];for(let p=0;p<c.length;p++){const _=hg(c[p],a,l);f.push(_)}return f}function z2(c,a,l,f){if(c[0]<l[0]||c[0]>l[2]){const p=.5*f;let _=c[0]-l[0]>p?-f:l[0]-c[0]>p?f:0;_===0&&(_=c[0]-l[2]>p?-f:l[2]-c[0]>p?f:0),c[0]+=_}td(a,c)}function j2(c,a,l,f){const p=Math.pow(2,f.z)*Lu,_=[f.x*Lu,f.y*Lu],y=[];if(!c)return y;for(const T of c)for(const A of T){const I=[A.x+_[0],A.y+_[1]];z2(I,a,l,p),y.push(I)}return y}function U2(c,a,l,f){const p=Math.pow(2,f.z)*Lu,_=[f.x*Lu,f.y*Lu],y=[];if(!c)return y;for(const A of c){const I=[];for(const D of A){const F=[D.x+_[0],D.y+_[1]];td(a,F),I.push(F)}y.push(I)}if(a[2]-a[0]<=p/2){(T=a)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of y)for(const I of A)z2(I,a,l,p)}var T;return y}class jh{constructor(a,l){this.type=Ln,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Qf(a[1])){const f=a[1];if(f.type==="FeatureCollection")for(let p=0;p<f.features.length;++p){const _=f.features[p].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new jh(f,f.features[p].geometry)}else if(f.type==="Feature"){const p=f.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new jh(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new jh(f,f)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(l,f){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(!y)return!1;if(f.type==="Polygon"){const T=hg(f.coordinates,_,y),A=j2(l.geometry(),p,_,y);if(!Pl(p,_))return!1;for(const I of A)if(!rd(I,T))return!1}if(f.type==="MultiPolygon"){const T=il(f.coordinates,_,y),A=j2(l.geometry(),p,_,y);if(!Pl(p,_))return!1;for(const I of A)if(!xI(I,T))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(l,f){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(!y)return!1;if(f.type==="Polygon"){const T=hg(f.coordinates,_,y),A=U2(l.geometry(),p,_,y);if(!Pl(p,_))return!1;for(const I of A)if(!ug(I,T))return!1}if(f.type==="MultiPolygon"){const T=il(f.coordinates,_,y),A=U2(l.geometry(),p,_,y);if(!Pl(p,_))return!1;for(const I of A)if(!B2(I,T))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const am={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},qv=1/298.257223563,Xv=qv*(2-qv),nd=Math.PI/180;class id{static fromTile(a,l,f){const p=Math.PI*(1-2*(a+.5)/Math.pow(2,l)),_=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/nd;return new id(_,f)}static get units(){return am}constructor(a,l){if(a===void 0)throw new Error("No latitude given.");if(l&&!am[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(am).join(", ")}`);const f=6378.137*nd*(l?am[l]:1),p=Math.cos(a*nd),_=1/(1-Xv*(1-p*p)),y=Math.sqrt(_);this.kx=f*y*p,this.ky=f*y*_*(1-Xv)}distance(a,l){const f=Us(a[0]-l[0])*this.kx,p=(a[1]-l[1])*this.ky;return Math.sqrt(f*f+p*p)}bearing(a,l){const f=Us(l[0]-a[0])*this.kx;return Math.atan2(f,(l[1]-a[1])*this.ky)/nd}destination(a,l,f){const p=f*nd;return this.offset(a,Math.sin(p)*l,Math.cos(p)*l)}offset(a,l,f){return[a[0]+l/this.kx,a[1]+f/this.ky]}lineDistance(a){let l=0;for(let f=0;f<a.length-1;f++)l+=this.distance(a[f],a[f+1]);return l}area(a){let l=0;for(let f=0;f<a.length;f++){const p=a[f];for(let _=0,y=p.length,T=y-1;_<y;T=_++)l+=Us(p[_][0]-p[T][0])*(p[_][1]+p[T][1])*(f?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(a,l){let f=0;if(l<=0)return a[0];for(let p=0;p<a.length-1;p++){const _=a[p],y=a[p+1],T=this.distance(_,y);if(f+=T,f>l)return fg(_,y,(l-(f-T))/T)}return a[a.length-1]}pointToSegmentDistance(a,l,f){let[p,_]=l,y=Us(f[0]-p)*this.kx,T=(f[1]-_)*this.ky;if(y!==0||T!==0){const A=(Us(a[0]-p)*this.kx*y+(a[1]-_)*this.ky*T)/(y*y+T*T);A>1?(p=f[0],_=f[1]):A>0&&(p+=y/this.kx*A,_+=T/this.ky*A)}return y=Us(a[0]-p)*this.kx,T=(a[1]-_)*this.ky,Math.sqrt(y*y+T*T)}pointOnLine(a,l){let f=1/0,p=a[0][0],_=a[0][1],y=0,T=0;for(let A=0;A<a.length-1;A++){let I=a[A][0],D=a[A][1],F=Us(a[A+1][0]-I)*this.kx,z=(a[A+1][1]-D)*this.ky,H=0;F===0&&z===0||(H=(Us(l[0]-I)*this.kx*F+(l[1]-D)*this.ky*z)/(F*F+z*z),H>1?(I=a[A+1][0],D=a[A+1][1]):H>0&&(I+=F/this.kx*H,D+=z/this.ky*H)),F=Us(l[0]-I)*this.kx,z=(l[1]-D)*this.ky;const q=F*F+z*z;q<f&&(f=q,p=I,_=D,y=A,T=H)}return{point:[p,_],index:y,t:Math.max(0,Math.min(1,T))}}lineSlice(a,l,f){let p=this.pointOnLine(f,a),_=this.pointOnLine(f,l);if(p.index>_.index||p.index===_.index&&p.t>_.t){const I=p;p=_,_=I}const y=[p.point],T=p.index+1,A=_.index;!Zv(f[T],y[0])&&T<=A&&y.push(f[T]);for(let I=T+1;I<=A;I++)y.push(f[I]);return Zv(f[A],_.point)||y.push(_.point),y}lineSliceAlong(a,l,f){let p=0;const _=[];for(let y=0;y<f.length-1;y++){const T=f[y],A=f[y+1],I=this.distance(T,A);if(p+=I,p>a&&_.length===0&&_.push(fg(T,A,(a-(p-I))/I)),p>=l)return _.push(fg(T,A,(l-(p-I))/I)),_;p>a&&_.push(A)}return _}bufferPoint(a,l){const f=l/this.ky,p=l/this.kx;return[a[0]-p,a[1]-f,a[0]+p,a[1]+f]}bufferBBox(a,l){const f=l/this.ky,p=l/this.kx;return[a[0]-p,a[1]-f,a[2]+p,a[3]+f]}insideBBox(a,l){return Us(a[0]-l[0])>=0&&Us(a[0]-l[2])<=0&&a[1]>=l[1]&&a[1]<=l[3]}}function Zv(c,a){return c[0]===a[0]&&c[1]===a[1]}function fg(c,a,l){const f=Us(a[0]-c[0]);return[c[0]+f*l,c[1]+(a[1]-c[1])*l]}function Us(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class dg{constructor(a=[],l=(f,p)=>f<p?-1:f>p?1:0){if(this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:l,compare:f}=this,p=l[a];for(;a>0;){const _=a-1>>1,y=l[_];if(f(p,y)>=0)break;l[a]=y,a=_}l[a]=p}_down(a){const{data:l,compare:f}=this,p=this.length>>1,_=l[a];for(;a<p;){let y=1+(a<<1);const T=y+1;if(T<this.length&&f(l[T],l[y])<0&&(y=T),f(l[y],_)>=0)break;l[a]=l[y],a=y}l[a]=_}}var Zt=8192;function Yv(c,a){return a.dist-c.dist}const ad=100,od=50;function om(c){const a=[1/0,1/0,-1/0,-1/0];if(a.length!==c.length)return!1;for(let l=0;l<a.length;l++)if(a[l]!==c[l])return!1;return!0}function sm(c){return c[1]-c[0]+1}function nc(c,a){const l=c[1]>=c[0]&&c[1]<a;return l||console.warn("Distance Expression: Index is out of range"),l}function pg(c,a){if(c[0]>c[1])return[null,null];const l=sm(c);if(a){if(l===2)return[c,null];const f=Math.floor(l/2);return[[c[0],c[0]+f],[c[0]+f,c[1]]]}{if(l===1)return[c,null];const f=Math.floor(l/2)-1;return[[c[0],c[0]+f],[c[0]+f+1,c[1]]]}}function al(c,a){const l=[1/0,1/0,-1/0,-1/0];if(!nc(a,c.length))return l;for(let f=a[0];f<=a[1];++f)td(l,c[f]);return l}function hn(c){const a=[1/0,1/0,-1/0,-1/0];for(let l=0;l<c.length;++l)for(let f=0;f<c[l].length;++f)td(a,c[l][f]);return a}function sd(c,a,l){if(om(c)||om(a))return NaN;let f=0,p=0;return c[2]<a[0]&&(f=a[0]-c[2]),c[0]>a[2]&&(f=c[0]-a[2]),c[1]>a[3]&&(p=c[1]-a[3]),c[3]<a[1]&&(p=a[1]-c[3]),l.distance([0,0],[f,p])}function bI(c){return 360*c-180}function TI(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function mg(c,a){const l=Math.pow(2,a.z),f=(c.y/Zt+a.y)/l;return[bI((c.x/Zt+a.x)/l),TI(f)]}function SI(c,a){const l=[];for(let f=0;f<c.length;++f)l.push(mg(c[f],a));return l}function bi(c,a,l){const f=l.pointOnLine(a,c).point;return l.distance(c,f)}function $2(c,a,l,f,p){const _=l.slice(f[0],f[1]+1);let y=1/0;for(let T=a[0];T<=a[1];++T)if((y=Math.min(y,bi(c[T],_,p)))===0)return 0;return y}function Kv(c,a,l,f,p){const _=Math.min(p.pointToSegmentDistance(c,l,f),p.pointToSegmentDistance(a,l,f)),y=Math.min(p.pointToSegmentDistance(l,c,a),p.pointToSegmentDistance(f,c,a));return Math.min(_,y)}function EI(c,a,l,f,p){if(!nc(a,c.length)||!nc(f,l.length))return NaN;let _=1/0;for(let y=a[0];y<a[1];++y)for(let T=f[0];T<f[1];++T){if(lg(c[y],c[y+1],l[T],l[T+1]))return 0;_=Math.min(_,Kv(c[y],c[y+1],l[T],l[T+1],p))}return _}function AI(c,a,l,f,p){if(!nc(a,c.length)||!nc(f,l.length))return NaN;let _=1/0;for(let y=a[0];y<=a[1];++y)for(let T=f[0];T<=f[1];++T)if((_=Math.min(_,p.distance(c[y],l[T])))===0)return _;return _}function CI(c,a,l){if(rd(c,a,!0))return 0;let f=1/0;for(const p of a){const _=p.length;if(_<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[_-1]&&(f=Math.min(f,l.pointToSegmentDistance(c,p[_-1],p[0])))===0||(f=Math.min(f,bi(c,p,l)))===0)return f}return f}function PI(c,a,l,f){if(!nc(a,c.length))return NaN;for(let _=a[0];_<=a[1];++_)if(rd(c[_],l,!0))return 0;let p=1/0;for(let _=a[0];_<a[1];++_)for(const y of l)for(let T=0,A=y.length,I=A-1;T<A;I=T++){if(lg(c[_],c[_+1],y[I],y[T]))return 0;p=Math.min(p,Kv(c[_],c[_+1],y[I],y[T],f))}return p}function V2(c,a){for(const l of c)for(let f=0;f<=l.length-1;++f)if(rd(l[f],a,!0))return!0;return!1}function II(c,a,l,f=1/0){const p=hn(c),_=hn(a);if(f!==1/0&&sd(p,_,l)>=f)return f;if(Pl(p,_)){if(V2(c,a))return 0}else if(V2(a,c))return 0;let y=f;for(const T of c)for(let A=0,I=T.length,D=I-1;A<I;D=A++)for(const F of a)for(let z=0,H=F.length,q=H-1;z<H;q=z++){if(lg(T[D],T[A],F[q],F[z]))return 0;y=Math.min(y,Kv(T[D],T[A],F[q],F[z],l))}return y}function gg(c,a,l,f,p,_,y){if(_===null||y===null)return;const T=sd(al(f,_),al(p,y),l);T<a&&c.push({dist:T,range1:_,range2:y})}function kI(c,a,l,f,p=1/0){let _=Math.min(f.distance(c[0],l[0][0]),p);if(_===0)return _;const y=new dg([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Yv),T=a?od:ad,A=hn(l);for(;y.length;){const I=y.pop();if(I.dist>=_)continue;const D=I.range1;if(sm(D)<=T){if(!nc(D,c.length))return NaN;if(a){const F=PI(c,D,l,f);if((_=Math.min(_,F))===0)return _}else for(let F=D[0];F<=D[1];++F){const z=CI(c[F],l,f);if((_=Math.min(_,z))===0)return _}}else{const F=pg(D,a);if(F[0]!==null){const z=sd(al(c,F[0]),A,f);z<_&&y.push({dist:z,range1:F[0],range2:[0,0]})}if(F[1]!==null){const z=sd(al(c,F[1]),A,f);z<_&&y.push({dist:z,range1:F[1],range2:[0,0]})}}}return _}function W2(c,a,l,f,p,_=1/0){let y=Math.min(_,p.distance(c[0],l[0]));if(y===0)return y;const T=new dg([{dist:0,range1:[0,c.length-1],range2:[0,l.length-1]}],Yv),A=a?od:ad,I=f?od:ad;for(;T.length;){const D=T.pop();if(D.dist>=y)continue;const F=D.range1,z=D.range2;if(sm(F)<=A&&sm(z)<=I){if(!nc(F,c.length)||!nc(z,l.length))return NaN;if(a&&f?y=Math.min(y,EI(c,F,l,z,p)):a||f?a&&!f?y=Math.min(y,$2(l,z,c,F,p)):!a&&f&&(y=Math.min(y,$2(c,F,l,z,p))):y=Math.min(y,AI(c,F,l,z,p)),y===0)return y}else{const H=pg(F,a),q=pg(z,f);gg(T,y,p,c,l,H[0],q[0]),gg(T,y,p,c,l,H[0],q[1]),gg(T,y,p,c,l,H[1],q[0]),gg(T,y,p,c,l,H[1],q[1])}}return y}function Jv(c,a,l,f,p=1/0){let _=p;const y=al(c,[0,c.length-1]);for(const T of l)if(!(_!==1/0&&sd(y,al(T,[0,T.length-1]),f)>=_)&&(_=Math.min(_,W2(c,a,T,!0,f,_)),_===0))return _;return _}function _g(c,a,l,f,p=1/0){let _=p;const y=al(c,[0,c.length-1]);for(const T of l){if(_!==1/0&&sd(y,hn(T),f)>=_)continue;const A=kI(c,a,T,f,_);if(isNaN(A))return A;if((_=Math.min(_,A))===0)return _}return _}function Qv(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class Uh{constructor(a,l){this.type=wr,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${a.length-1} instead.`);if(Qf(a[1])){const f=a[1];if(f.type==="FeatureCollection"){for(let p=0;p<f.features.length;++p)if(Qv(f.features[p].geometry.type))return new Uh(f,f.features[p].geometry)}else if(f.type==="Feature"){if(Qv(f.geometry.type))return new Uh(f,f.geometry)}else if(Qv(f.type))return new Uh(f,f)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(a){const l=a.geometry(),f=a.canonicalID();if(l!=null&&f!=null){if(a.geometryType()==="Point")return function(p,_,y){const T=[];for(const I of p)for(const D of I)T.push(mg(D,_));const A=new id(T[0][1],"meters");return y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString"?W2(T,!1,y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",A):y.type==="MultiLineString"?Jv(T,!1,y.coordinates,A):y.type==="Polygon"||y.type==="MultiPolygon"?_g(T,!1,y.type==="Polygon"?[y.coordinates]:y.coordinates,A):null}(l,f,this.geometries);if(a.geometryType()==="LineString")return function(p,_,y){const T=[];for(const I of p){const D=[];for(const F of I)D.push(mg(F,_));T.push(D)}const A=new id(T[0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return Jv(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",T,A);if(y.type==="MultiLineString"){let I=1/0;for(let D=0;D<y.coordinates.length;D++){const F=Jv(y.coordinates[D],!0,T,A,I);if(isNaN(F))return F;if((I=Math.min(I,F))===0)return I}return I}if(y.type==="Polygon"||y.type==="MultiPolygon"){let I=1/0;for(let D=0;D<T.length;D++){const F=_g(T[D],!0,y.type==="Polygon"?[y.coordinates]:y.coordinates,A,I);if(isNaN(F))return F;if((I=Math.min(I,F))===0)return I}return I}return null}(l,f,this.geometries);if(a.geometryType()==="Polygon")return function(p,_,y){const T=[];for(const I of function(D,F){const z=D.length;if(z<=1)return[D];const H=[];let q,ne;for(let ie=0;ie<z;ie++){const ae=sg(D[ie]);ae!==0&&(D[ie].area=Math.abs(ae),ne===void 0&&(ne=ae<0),ne===ae<0?(q&&H.push(q),q=[D[ie]]):q.push(D[ie]))}return q&&H.push(q),H}(p)){const D=[];for(let F=0;F<I.length;++F)D.push(SI(I[F],_));T.push(D)}const A=new id(T[0][0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return _g(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",T,A);if(y.type==="MultiLineString"){let I=1/0;for(let D=0;D<y.coordinates.length;D++){const F=_g(y.coordinates[D],!0,T,A,I);if(isNaN(F))return F;if((I=Math.min(I,F))===0)return I}return I}return y.type==="Polygon"||y.type==="MultiPolygon"?function(I,D,F){let z=1/0;for(const H of I)for(const q of D){const ne=II(H,q,F,z);if(isNaN(ne))return ne;if((z=Math.min(z,ne))===0)return z}return z}(y.type==="Polygon"?[y.coordinates]:y.coordinates,T,A):null}(l,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function ld(c){if(c instanceof Uo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof jh||c instanceof Uh)return!1;if(c instanceof ud)return c.featureConstant;let a=!0;return c.eachChild(l=>{a&&!ld(l)&&(a=!1)}),a}function yg(c){if(c instanceof Uo&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(l=>{a&&!yg(l)&&(a=!1)}),a}function vg(c){if(c instanceof ud)return new Set([c.key]);let a=new Set;return c.eachChild(l=>{a=new Set([...a,...vg(l)])}),a}function cd(c,a){if(c instanceof Uo&&a.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild(f=>{l&&!cd(f,a)&&(l=!1)}),l}function G2(c,a,l){return[c,a,l].filter(Boolean).join("")}function ex(c,a){switch(c){case"string":return rs(a);case"number":return+a;case"boolean":return!!a;case"color":return On.parse(a);case"formatted":return jo.fromString(rs(a));case"resolvedImage":return ts.build(rs(a))}return a}function H2(c,a,l,f){return f!==void 0&&(c=f*Math.round(c/f)),a!==void 0&&c<a&&(c=a),l!==void 0&&c>l&&(c=l),c}class ud{constructor(a,l,f,p=!1){this.type=a,this.key=l,this.scope=f,this.featureConstant=p}static parse(a,l){let f=l.expectedType;if(f==null&&(f=An),a.length<2||a.length>3)return l.error("Invalid number of arguments for 'config' expression.");const p=l.parse(a[1],1);if(!(p instanceof Zr))return l.error("Key name of 'config' expression must be a string literal.");let _,y=!0;const T=rs(p.value);if(a.length>=3){const A=l.parse(a[2],2);if(!(A instanceof Zr))return l.error("Scope of 'config' expression must be a string literal.");_=rs(A.value)}if(l.options){const A=G2(T,_,l._scope),I=l.options.get(A);I&&(y=ld(I.value||I.default))}return new ud(f,T,_,y)}evaluate(a){const l=G2(this.key,this.scope,a.scope),f=a.getConfig(l);if(!f)return null;const{type:p,value:_,values:y,minValue:T,maxValue:A,stepValue:I}=f,D=f.default.evaluate(a);let F=D;if(_){const z=a.scope;a.scope=(z||"").split("").slice(1).join(""),F=_.evaluate(a),a.scope=z}return p&&(F=ex(p,F)),F===void 0||T===void 0&&A===void 0&&I===void 0||(typeof F=="number"?F=H2(F,T,A,I):Array.isArray(F)&&(F=F.map(z=>typeof z=="number"?H2(z,T,A,I):z))),_!==void 0&&F!==void 0&&y&&!y.includes(F)&&(F=D,p&&(F=ex(p,F))),(p&&p!==this.type||F!==void 0&&!em(Fa(F),this.type))&&(F=ex(this.type.kind,F)),F}eachChild(){}outputDefined(){return!1}serialize(){const a=["config",this.key];return this.scope&&a.concat(this.scope),a}}class xg{constructor(a,l){this.type=l.type,this.name=a,this.boundExpression=l}static parse(a,l){if(a.length!==2||typeof a[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const f=a[1];return l.scope.has(f)?new xg(f,l.scope.get(f)):l.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class wg{constructor(a,l=[],f,p=new ng,_=[],y,T,A){this.registry=a,this.path=l,this.key=l.map(I=>typeof I=="string"?`['${I}']`:`[${I}]`).join(""),this.scope=p,this.errors=_,this.expectedType=f,this._scope=y,this.options=T,this.iconImageUseTheme=A}parse(a,l,f,p,_={}){return l||f?this.concat(l,null,f,p)._parse(a,_):this._parse(a,_)}parseObjectValue(a,l,f,p,_,y={}){return this.concat(l,f,p,_)._parse(a,y)}_parse(a,l){function f(p,_,y){return y==="assert"?new Mr(_,[p]):y==="coerce"?new aa(_,[p]):p}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof a[0]=="string"?this.registry[a[0]]:void 0;if(p){let _=p.parse(a,this);if(!_)return null;if(this.expectedType){const y=this.expectedType,T=_.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||T.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(y,T))return null}else _=f(_,y,l.typeAnnotation||"coerce");else _=f(_,y,l.typeAnnotation||"assert")}if(!(_ instanceof Zr)&&_.type.kind!=="resolvedImage"&&tx(_)){const y=new $c(this._scope,this.options,this.iconImageUseTheme);try{_=new Zr(_.type,_.evaluate(y))}catch(T){return this.error(T.message),null}}return _}return aa.parse(["to-array",a],this)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,l,f,p){let _=typeof a=="number"?this.path.concat(a):this.path;_=typeof l=="string"?_.concat(l):_;const y=p?this.scope.concat(p):this.scope;return new wg(this.registry,_,f||null,y,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(a,...l){const f=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new Al(f,a))}checkSubtype(a,l){const f=Jp(a,l);return f&&this.error(f),f}}function tx(c){if(c instanceof xg)return tx(c.boundExpression);if(c instanceof Uo&&c.name==="error"||c instanceof io||c instanceof jh||c instanceof Uh||c instanceof ud)return!1;const a=c instanceof aa||c instanceof Mr;let l=!0;return c.eachChild(f=>{l=a?l&&tx(f):l&&f instanceof Zr}),!!l&&ld(c)&&cd(c,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function bg(c,a){const l=c.length-1;let f,p,_=0,y=l,T=0;for(;_<=y;)if(T=Math.floor((_+y)/2),f=c[T],p=c[T+1],f<=a){if(T===l||a<p)return T;_=T+1}else{if(!(f>a))throw new or("Input is not a number.");y=T-1}return 0}class lm{constructor(a,l,f){this.type=a,this.input=l,this.labels=[],this.outputs=[];for(const[p,_]of f)this.labels.push(p),this.outputs.push(_)}static parse(a,l){if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return l.error("Expected an even number of arguments.");const f=l.parse(a[1],1,wr);if(!f)return null;const p=[];let _=null;l.expectedType&&l.expectedType.kind!=="value"&&(_=l.expectedType);for(let y=1;y<a.length;y+=2){const T=y===1?-1/0:a[y],A=a[y+1],I=y,D=y+1;if(typeof T!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(p.length&&p[p.length-1][0]>=T)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const F=l.parse(A,D,_);if(!F)return null;_=_||F.type,p.push([T,F])}return new lm(_,f,p)}evaluate(a){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(a);const p=this.input.evaluate(a);if(p<=l[0])return f[0].evaluate(a);const _=l.length;return p>=l[_-1]?f[_-1].evaluate(a):f[bg(l,p)].evaluate(a)}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&a.push(this.labels[l]),a.push(this.outputs[l].serialize());return a}}const q2=.95047,X2=1.08883,Z2=4/29,Nu=6/29,Y2=3*Nu*Nu,K2=Nu*Nu*Nu,OI=Math.PI/180,MI=180/Math.PI;function rx(c){return c>K2?Math.pow(c,1/3):c/Y2+Z2}function Tg(c){return c>Nu?c*c*c:Y2*(c-Z2)}function Sg(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Bu(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function nx(c){const a=Bu(c.r),l=Bu(c.g),f=Bu(c.b),p=rx((.4124564*a+.3575761*l+.1804375*f)/q2),_=rx((.2126729*a+.7151522*l+.072175*f)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-rx((.0193339*a+.119192*l+.9503041*f)/X2)),alpha:c.a}}function ix(c){let a=(c.l+16)/116,l=isNaN(c.a)?a:a+c.a/500,f=isNaN(c.b)?a:a-c.b/200;return a=1*Tg(a),l=q2*Tg(l),f=X2*Tg(f),new On(Sg(3.2404542*l-1.5371385*a-.4985314*f),Sg(-.969266*l+1.8760108*a+.041556*f),Sg(.0556434*l-.2040259*a+1.0572252*f),c.alpha)}function RI(c,a,l){const f=a-c;return c+l*(f>180||f<-180?f-360*Math.round(f/360):f)}const $h={forward:nx,reverse:ix,interpolate:function(c,a,l){return{l:Ir(c.l,a.l,l),a:Ir(c.a,a.a,l),b:Ir(c.b,a.b,l),alpha:Ir(c.alpha,a.alpha,l)}}},Vh={forward:function(c){const{l:a,a:l,b:f}=nx(c),p=Math.atan2(f,l)*MI;return{h:p<0?p+360:p,c:Math.sqrt(l*l+f*f),l:a,alpha:c.a}},reverse:function(c){const a=c.h*OI,l=c.c;return ix({l:c.l,a:Math.cos(a)*l,b:Math.sin(a)*l,alpha:c.alpha})},interpolate:function(c,a,l){return{h:RI(c.h,a.h,l),c:Ir(c.c,a.c,l),l:Ir(c.l,a.l,l),alpha:Ir(c.alpha,a.alpha,l)}}};var J2=Object.freeze({__proto__:null,hcl:Vh,lab:$h});class $s{constructor(a,l,f,p,_){this.type=a,this.operator=l,this.interpolation=f,this.input=p,this.labels=[],this.outputs=[];for(const[y,T]of _)this.labels.push(y),this.outputs.push(T)}static interpolationFactor(a,l,f,p){let _=0;if(a.name==="exponential")_=Eg(l,a.base,f,p);else if(a.name==="linear")_=Eg(l,1,f,p);else if(a.name==="cubic-bezier"){const y=a.controlPoints;_=new yn(y[0],y[1],y[2],y[3]).solve(Eg(l,1,f,p))}return _}static parse(a,l){let[f,p,_,...y]=a;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const I=p[1];if(typeof I!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:I}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const I=p.slice(1);if(I.length!==4||I.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:I}}}if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length-1>3&&(a.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,wr),!_)return null;const T=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=fs:l.expectedType&&l.expectedType.kind!=="value"&&(A=l.expectedType);for(let I=0;I<y.length;I+=2){const D=y[I],F=y[I+1],z=I+3,H=I+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(T.length&&T[T.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const q=l.parse(F,H,A);if(!q)return null;A=A||q.type,T.push([D,q])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new $s(A,f,p,_,T):l.error(`Type ${pa(A)} is not interpolatable.`)}evaluate(a){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(a);const p=this.input.evaluate(a);if(p<=l[0])return f[0].evaluate(a);const _=l.length;if(p>=l[_-1])return f[_-1].evaluate(a);const y=bg(l,p),T=$s.interpolationFactor(this.interpolation,p,l[y],l[y+1]),A=f[y].evaluate(a),I=f[y+1].evaluate(a);return this.operator==="interpolate"?js[this.type.kind.toLowerCase()](A,I,T):this.operator==="interpolate-hcl"?Vh.reverse(Vh.interpolate(Vh.forward(A),Vh.forward(I),T)):$h.reverse($h.interpolate($h.forward(A),$h.forward(I),T))}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,a,this.input.serialize()];for(let f=0;f<this.labels.length;f++)l.push(this.labels[f],this.outputs[f].serialize());return l}}function Eg(c,a,l,f){const p=f-l,_=c-l;return p===0?0:a===1?_/p:(Math.pow(a,_)-1)/(Math.pow(a,p)-1)}class cm{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expectected at least one argument.");let f=null;const p=l.expectedType;p&&p.kind!=="value"&&(f=p);const _=[];for(const T of a.slice(1)){const A=l.parse(T,1+_.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,_.push(A)}const y=p&&_.some(T=>Jp(p,T.type));return new cm(y?An:f,_)}evaluate(a){let l,f=null,p=0;for(const _ of this.args){if(p++,f=_.evaluate(a),f&&f instanceof ts&&!f.available&&(l||(l=f),f=null,p===this.args.length))return l;if(f!==null)break}return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class Ag{constructor(a,l){this.type=l.type,this.bindings=[].concat(a),this.result=l}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const l of this.bindings)a(l[1]);a(this.result)}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let _=1;_<a.length-1;_+=2){const y=a[_];if(typeof y!="string")return l.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=l.parse(a[_+1],_+1);if(!T)return null;f.push([y,T])}const p=l.parse(a[a.length-1],a.length-1,l.expectedType,f);return p?new Ag(f,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[l,f]of this.bindings)a.push(l,f.serialize());return a.push(this.result.serialize()),a}}class ax{constructor(a,l,f){this.type=a,this.index=l,this.input=f}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,wr),p=l.parse(a[2],2,Co(l.expectedType||An));return f&&p?new ax(p.type.itemType,f,p):null}evaluate(a){const l=this.index.evaluate(a),f=this.input.evaluate(a);if(l<0)throw new or("Array index out of bounds: negative index");if(l>=f.length)throw new or("Array index out of bounds: index exceeds array size");if(l!==Math.floor(l))throw new or("Array index must be an integer. Use at-interpolated for fractional indices");return f[l]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ox{constructor(a,l,f){this.type=a,this.index=l,this.input=f}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,wr),p=l.parse(a[2],2,Co(l.expectedType||An));return f&&p?new ox(p.type.itemType,f,p):null}evaluate(a){const l=this.index.evaluate(a),f=this.input.evaluate(a);if(l<0)throw new or(`Array index out of bounds: ${l} < 0.`);if(l>f.length-1)throw new or(`Array index out of bounds: ${l} > ${f.length-1}.`);if(l===Math.floor(l))return f[l];const p=Math.floor(l),_=Math.ceil(l),y=f[p],T=f[_];if(typeof y!="number"||typeof T!="number")throw new or(`Cannot interpolate between non-number values at index ${l}.`);const A=l-p;return y*(1-A)+T*A}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Cg{constructor(a,l){this.type=Ln,this.needle=a,this.haystack=l}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,An),p=l.parse(a[2],2,An);return f&&p?Vv(f.type,[Ln,Mn,wr,rc,An])?new Cg(f,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(f.type)} instead`):null}evaluate(a){const l=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(f==null)return!1;if(!Qp(l,["boolean","string","number","null"]))throw new or(`Expected first argument to be of type boolean, string, number or null, but found ${pa(Fa(l))} instead.`);if(!Qp(f,["string","array"]))throw new or(`Expected second argument to be of type array or string, but found ${pa(Fa(f))} instead.`);return f.indexOf(l)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class um{constructor(a,l,f){this.type=wr,this.needle=a,this.haystack=l,this.fromIndex=f}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,An),p=l.parse(a[2],2,An);if(!f||!p)return null;if(!Vv(f.type,[Ln,Mn,wr,rc,An]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(f.type)} instead`);if(a.length===4){const _=l.parse(a[3],3,wr);return _?new um(f,p,_):null}return new um(f,p)}evaluate(a){const l=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!Qp(l,["boolean","string","number","null"]))throw new or(`Expected first argument to be of type boolean, string, number or null, but found ${pa(Fa(l))} instead.`);if(!Qp(f,["string","array"]))throw new or(`Expected second argument to be of type array or string, but found ${pa(Fa(f))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(a);return f.indexOf(l,p)}return f.indexOf(l)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class hd{constructor(a,l,f,p,_,y){this.inputType=a,this.type=l,this.input=f,this.cases=p,this.outputs=_,this.otherwise=y}static parse(a,l){if(a.length<5)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return l.error("Expected an even number of arguments.");let f,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const _={},y=[];for(let I=2;I<a.length-1;I+=2){let D=a[I];const F=a[I+1];Array.isArray(D)||(D=[D]);const z=l.concat(I);if(D.length===0)return z.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return z.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return z.error("Numeric branch labels must be integer values.");if(f){if(z.checkSubtype(f,Fa(q)))return null}else f=Fa(q);if(_[String(q)]!==void 0)return z.error("Branch labels must be unique.");_[String(q)]=y.length}const H=l.parse(F,I,p);if(!H)return null;p=p||H.type,y.push(H)}const T=l.parse(a[1],1,An);if(!T)return null;const A=l.parse(a[a.length-1],a.length-1,p);return A?T.type.kind!=="value"&&l.concat(1).checkSubtype(f,T.type)?null:new hd(f,p,T,_,y,A):null}evaluate(a){const l=this.input.evaluate(a);return(em(Fa(l),this.inputType)&&this.outputs[this.cases[l]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),f=[],p={};for(const y of l){const T=p[this.cases[y]];T===void 0?(p[this.cases[y]]=f.length,f.push([this.cases[y],[y]])):f[T][1].push(y)}const _=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,T]of f)a.push(T.length===1?_(T[0]):T.map(_)),a.push(this.outputs[y].serialize());return a.push(this.otherwise.serialize()),a}}class sx{constructor(a,l,f){this.type=a,this.branches=l,this.otherwise=f}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return l.error("Expected an odd number of arguments.");let f;l.expectedType&&l.expectedType.kind!=="value"&&(f=l.expectedType);const p=[];for(let y=1;y<a.length-1;y+=2){const T=l.parse(a[y],y,Ln);if(!T)return null;const A=l.parse(a[y+1],y+1,f);if(!A)return null;p.push([T,A]),f=f||A.type}const _=l.parse(a[a.length-1],a.length-1,f);return _?new sx(f,p,_):null}evaluate(a){for(const[l,f]of this.branches)if(l.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[l,f]of this.branches)a(l),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class hm{constructor(a,l,f,p){this.type=a,this.input=l,this.beginIndex=f,this.endIndex=p}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,An),p=l.parse(a[2],2,wr);if(!f||!p)return null;if(!Vv(f.type,[Co(An),Mn,An]))return l.error(`Expected first argument to be of type array or string, but found ${pa(f.type)} instead`);if(a.length===4){const _=l.parse(a[3],3,wr);return _?new hm(f.type,f,p,_):null}return new hm(f.type,f,p)}evaluate(a){const l=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!Qp(l,["string","array"]))throw new or(`Expected first argument to be of type array or string, but found ${pa(Fa(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(a);return l.slice(f,p)}return l.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class lx{constructor(a,l){this.type=Co(Mn),this.str=a,this.delimiter=l}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,Mn),p=l.parse(a[2],2,Mn);return f&&p?new lx(f,p):void 0}evaluate(a){const l=this.str.evaluate(a),f=this.delimiter.evaluate(a);return l.split(f)}eachChild(a){a(this.str),a(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Q2(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function cx(c,a,l,f){return f.compare(a,l)===0}function Wh(c,a,l){const f=c!=="=="&&c!=="!=";return class rte{constructor(_,y,T){this.type=Ln,this.lhs=_,this.rhs=y,this.collator=T,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");const T=_[0];let A=y.parse(_[1],1,An);if(!A)return null;if(!Q2(T,A.type))return y.concat(1).error(`"${T}" comparisons are not supported for type '${pa(A.type)}'.`);let I=y.parse(_[2],2,An);if(!I)return null;if(!Q2(T,I.type))return y.concat(2).error(`"${T}" comparisons are not supported for type '${pa(I.type)}'.`);if(A.type.kind!==I.type.kind&&A.type.kind!=="value"&&I.type.kind!=="value")return y.error(`Cannot compare types '${pa(A.type)}' and '${pa(I.type)}'.`);f&&(A.type.kind==="value"&&I.type.kind!=="value"?A=new Mr(I.type,[A]):A.type.kind!=="value"&&I.type.kind==="value"&&(I=new Mr(A.type,[I])));let D=null;if(_.length===4){if(A.type.kind!=="string"&&I.type.kind!=="string"&&A.type.kind!=="value"&&I.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(D=y.parse(_[3],3,ig),!D)return null}return new rte(A,I,D)}evaluate(_){const y=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(f&&this.hasUntypedArgument){const A=Fa(y),I=Fa(T);if(A.kind!==I.kind||A.kind!=="string"&&A.kind!=="number")throw new or(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${A.kind}, ${I.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=Fa(y),I=Fa(T);if(A.kind!=="string"||I.kind!=="string")return a(_,y,T)}return this.collator?l(_,y,T,this.collator.evaluate(_)):a(_,y,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[c];return this.eachChild(y=>{_.push(y.serialize())}),_}}}const DI=Wh("==",function(c,a,l){return a===l},cx),FI=Wh("!=",function(c,a,l){return a!==l},function(c,a,l,f){return!cx(0,a,l,f)}),LI=Wh("<",function(c,a,l){return a<l},function(c,a,l,f){return f.compare(a,l)<0}),Pg=Wh(">",function(c,a,l){return a>l},function(c,a,l,f){return f.compare(a,l)>0}),NI=Wh("<=",function(c,a,l){return a<=l},function(c,a,l,f){return f.compare(a,l)<=0}),BI=Wh(">=",function(c,a,l){return a>=l},function(c,a,l,f){return f.compare(a,l)>=0});class ux{constructor(a,l,f,p,_,y){this.type=Mn,this.number=a,this.locale=l,this.currency=f,this.unit=p,this.minFractionDigits=_,this.maxFractionDigits=y}static parse(a,l){if(a.length!==3)return l.error("Expected two arguments.");const f=l.parse(a[1],1,wr);if(!f)return null;const p=a[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=l.parseObjectValue(p.locale,2,"locale",Mn),!_))return null;let y=null;if(p.currency&&(y=l.parseObjectValue(p.currency,2,"currency",Mn),!y))return null;let T=null;if(p.unit&&(T=l.parseObjectValue(p.unit,2,"unit",Mn),!T))return null;let A=null;if(p["min-fraction-digits"]&&(A=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",wr),!A))return null;let I=null;return p["max-fraction-digits"]&&(I=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",wr),!I)?null:new ux(f,_,y,T,A,I)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class hx{constructor(a){this.type=wr,this.input=a}static parse(a,l){if(a.length!==2)return l.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=l.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${pa(f.type)} instead.`):new hx(f):null}evaluate(a){const l=this.input.evaluate(a);if(typeof l=="string"||Array.isArray(l))return l.length;throw new or(`Expected value to be of type string or array, but found ${pa(Fa(l))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(l=>{a.push(l.serialize())}),a}}function fx(c){return function(){c=1831565813+(c|=0)|0;let a=Math.imul(c^c>>>15,1|c);return a=a+Math.imul(a^a>>>7,61|a)^a,((a^a>>>14)>>>0)/4294967296}}const fd={"==":DI,"!=":FI,">":Pg,"<":LI,">=":BI,"<=":NI,array:Mr,at:ax,"at-interpolated":ox,boolean:Mr,case:sx,coalesce:cm,collator:io,format:Bh,image:ed,in:Cg,"index-of":um,interpolate:$s,"interpolate-hcl":$s,"interpolate-lab":$s,length:hx,let:Ag,literal:Zr,match:hd,number:Mr,"number-format":ux,object:Mr,slice:hm,step:lm,string:Mr,"to-boolean":aa,"to-color":aa,"to-number":aa,"to-string":aa,var:xg,within:jh,distance:Uh,config:ud,split:lx};function eT(c,[a,l,f,p]){a=a.evaluate(c),l=l.evaluate(c),f=f.evaluate(c);const _=p?p.evaluate(c):1,y=F2(a,l,f,_);if(y)throw new or(y);return new On(a/255,l/255,f/255,_)}function dx(c,[a,l,f,p]){a=a.evaluate(c),l=l.evaluate(c),f=f.evaluate(c);const _=p?p.evaluate(c):1,y=function(I,D,F,z){return typeof I=="number"&&I>=0&&I<=360?typeof D=="number"&&D>=0&&D<=100&&typeof F=="number"&&F>=0&&F<=100?z===void 0||typeof z=="number"&&z>=0&&z<=1?null:`Invalid hsla value [${[I,D,F,z].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof z=="number"?[I,D,F,z]:[I,D,F]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof z=="number"?[I,D,F,z]:[I,D,F]).join(", ")}]: 'h' must be between 0 and 360.`}(a,l,f,_);if(y)throw new or(y);const T=`hsla(${a}, ${l}%, ${f}%, ${_})`,A=On.parse(T);if(!A)throw new or(`Failed to parse HSLA color: ${T}`);return A}function px(c,a){return c in a}function Ig(c,a){const l=a[c];return l===void 0?null:l}function Gh(c){return{type:c}}function Hh(c){return{result:"success",value:c}}function zu(c){return{result:"error",value:c}}function mx(c,a){return!!c&&!!c.parameters&&c.parameters.indexOf(a)>-1}function kg(c){return c["property-type"]==="data-driven"}function gx(c){return mx(c.expression,"measure-light")}function _x(c){return mx(c.expression,"zoom")}function Og(c){return!!c.expression&&c.expression.interpolated}function Mg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function yx(c){return c}function Rg(c,a){const l=a.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",p=f||!(f||c.property!==void 0),_=c.type||(Og(a)?"exponential":"interval");if(l&&((c=Object.assign({},c)).stops&&(c.stops=c.stops.map(I=>[I[0],On.parse(I[1])])),c.default=On.parse(c.default?c.default:a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!J2[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let y,T,A;if(_==="exponential")y=tT;else if(_==="interval")y=ju;else if(_==="categorical"){y=zI,T=Object.create(null);for(const I of c.stops)T[I[0]]=I[1];A=typeof c.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);y=jI}if(f){const I={},D=[];for(let H=0;H<c.stops.length;H++){const q=c.stops[H],ne=q[0].zoom;I[ne]===void 0&&(I[ne]={zoom:ne,type:c.type,property:c.property,default:c.default,stops:[]},D.push(ne)),I[ne].stops.push([q[0].value,q[1]])}const F=[];for(const H of D)F.push([I[H].zoom,Rg(I[H],a)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:$s.interpolationFactor.bind(void 0,z),zoomStops:F.map(H=>H[0]),evaluate:({zoom:H},q)=>tT({stops:F,base:c.base},a,H).evaluate(H,q)}}if(p){const I=_==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:$s.interpolationFactor.bind(void 0,I),zoomStops:c.stops.map(D=>D[0]),evaluate:({zoom:D})=>y(c,a,D,T,A)}}return{kind:"source",evaluate(I,D){const F=D&&D.properties?D.properties[c.property]:void 0;return F===void 0?dd(c.default,a.default):y(c,a,F,T,A)}}}function dd(c,a,l){return c!==void 0?c:a!==void 0?a:l!==void 0?l:void 0}function zI(c,a,l,f,p){return dd(typeof l===p?f[l]:void 0,c.default,a.default)}function ju(c,a,l){if(!nm(l))return dd(c.default,a.default);const f=c.stops.length;if(f===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[f-1][0])return c.stops[f-1][1];const p=bg(c.stops.map(_=>_[0]),l);return c.stops[p][1]}function tT(c,a,l){const f=c.base!==void 0?c.base:1;if(!nm(l))return dd(c.default,a.default);const p=c.stops.length;if(p===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[p-1][0])return c.stops[p-1][1];const _=bg(c.stops.map(D=>D[0]),l),y=function(D,F,z,H){const q=H-z,ne=D-z;return q===0?0:F===1?ne/q:(Math.pow(F,ne)-1)/(Math.pow(F,q)-1)}(l,f,c.stops[_][0],c.stops[_+1][0]),T=c.stops[_][1],A=c.stops[_+1][1];let I=js[a.type]||yx;if(c.colorSpace&&c.colorSpace!=="rgb"){const D=J2[c.colorSpace];I=(F,z)=>D.reverse(D.interpolate(D.forward(F),D.forward(z),y))}return typeof T.evaluate=="function"?{evaluate(...D){const F=T.evaluate.apply(void 0,D),z=A.evaluate.apply(void 0,D);if(F!==void 0&&z!==void 0)return I(F,z,y)}}:I(T,A,y)}function jI(c,a,l){return a.type==="color"?l=On.parse(l):a.type==="formatted"?l=jo.fromString(l.toString()):a.type==="resolvedImage"?l=ts.build(l.toString()):Lr(l)===a.type||a.type==="enum"&&a.values[l]||(l=void 0),dd(l,c.default,a.default)}Uo.register(fd,{error:[{kind:"error"},[Mn],(c,[a])=>{throw new or(a.evaluate(c))}],typeof:[Mn,[An],(c,[a])=>pa(Fa(a.evaluate(c)))],"to-rgba":[Co(wr,4),[fs],(c,[a])=>a.evaluate(c).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Co(wr,4),[fs],(c,[a])=>a.evaluate(c).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[fs,[wr,wr,wr],eT],rgba:[fs,[wr,wr,wr,wr],eT],hsl:[fs,[wr,wr,wr],dx],hsla:[fs,[wr,wr,wr,wr],dx],has:{type:Ln,overloads:[[[Mn],(c,[a])=>px(a.evaluate(c),c.properties())],[[Mn,Nh],(c,[a,l])=>px(a.evaluate(c),l.evaluate(c))]]},get:{type:An,overloads:[[[Mn],(c,[a])=>Ig(a.evaluate(c),c.properties())],[[Mn,Nh],(c,[a,l])=>Ig(a.evaluate(c),l.evaluate(c))]]},"feature-state":[An,[Mn],(c,[a])=>Ig(a.evaluate(c),c.featureState||{})],properties:[Nh,[],c=>c.properties()],"geometry-type":[Mn,[],c=>c.geometryType()],worldview:[Mn,[],c=>c.globals.worldview||""],id:[An,[],c=>c.id()],zoom:[wr,[],c=>c.globals.zoom],pitch:[wr,[],c=>c.globals.pitch||0],"distance-from-center":[wr,[],c=>c.distanceFromCenter()],"measure-light":[wr,[Mn],(c,[a])=>c.measureLight(a.evaluate(c))],"heatmap-density":[wr,[],c=>c.globals.heatmapDensity||0],"line-progress":[wr,[],c=>c.globals.lineProgress||0],"raster-value":[wr,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[wr,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[wr,[],c=>c.globals.skyRadialProgress||0],accumulated:[An,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[wr,Gh(wr),(c,a)=>{let l=0;for(const f of a)l+=f.evaluate(c);return l}],"*":[wr,Gh(wr),(c,a)=>{let l=1;for(const f of a)l*=f.evaluate(c);return l}],"-":{type:wr,overloads:[[[wr,wr],(c,[a,l])=>a.evaluate(c)-l.evaluate(c)],[[wr],(c,[a])=>-a.evaluate(c)]]},"/":[wr,[wr,wr],(c,[a,l])=>a.evaluate(c)/l.evaluate(c)],"%":[wr,[wr,wr],(c,[a,l])=>a.evaluate(c)%l.evaluate(c)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(c,[a,l])=>Math.pow(a.evaluate(c),l.evaluate(c))],sqrt:[wr,[wr],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[wr,[wr],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[wr,[wr],(c,[a])=>Math.log(a.evaluate(c))],log2:[wr,[wr],(c,[a])=>Math.log2(a.evaluate(c))],sin:[wr,[wr],(c,[a])=>Math.sin(a.evaluate(c))],cos:[wr,[wr],(c,[a])=>Math.cos(a.evaluate(c))],tan:[wr,[wr],(c,[a])=>Math.tan(a.evaluate(c))],asin:[wr,[wr],(c,[a])=>Math.asin(a.evaluate(c))],acos:[wr,[wr],(c,[a])=>Math.acos(a.evaluate(c))],atan:[wr,[wr],(c,[a])=>Math.atan(a.evaluate(c))],min:[wr,Gh(wr),(c,a)=>Math.min(...a.map(l=>l.evaluate(c)))],max:[wr,Gh(wr),(c,a)=>Math.max(...a.map(l=>l.evaluate(c)))],abs:[wr,[wr],(c,[a])=>Math.abs(a.evaluate(c))],round:[wr,[wr],(c,[a])=>{const l=a.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[wr,[wr],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[wr,[wr],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Ln,[Mn,An],(c,[a,l])=>c.properties()[a.value]===l.value],"filter-id-==":[Ln,[An],(c,[a])=>c.id()===a.value],"filter-type-==":[Ln,[Mn],(c,[a])=>c.geometryType()===a.value],"filter-<":[Ln,[Mn,An],(c,[a,l])=>{const f=c.properties()[a.value],p=l.value;return typeof f==typeof p&&f<p}],"filter-id-<":[Ln,[An],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l<f}],"filter->":[Ln,[Mn,An],(c,[a,l])=>{const f=c.properties()[a.value],p=l.value;return typeof f==typeof p&&f>p}],"filter-id->":[Ln,[An],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l>f}],"filter-<=":[Ln,[Mn,An],(c,[a,l])=>{const f=c.properties()[a.value],p=l.value;return typeof f==typeof p&&f<=p}],"filter-id-<=":[Ln,[An],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l<=f}],"filter->=":[Ln,[Mn,An],(c,[a,l])=>{const f=c.properties()[a.value],p=l.value;return typeof f==typeof p&&f>=p}],"filter-id->=":[Ln,[An],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l>=f}],"filter-has":[Ln,[An],(c,[a])=>a.value in c.properties()],"filter-has-id":[Ln,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Ln,[Co(Mn)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Ln,[Co(An)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Ln,[Mn,Co(An)],(c,[a,l])=>l.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Ln,[Mn,Co(An)],(c,[a,l])=>function(f,p,_,y){for(;_<=y;){const T=_+y>>1;if(p[T]===f)return!0;p[T]>f?y=T-1:_=T+1}return!1}(c.properties()[a.value],l.value,0,l.value.length-1)],all:{type:Ln,overloads:[[[Ln,Ln],(c,[a,l])=>a.evaluate(c)&&l.evaluate(c)],[Gh(Ln),(c,a)=>{for(const l of a)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Ln,overloads:[[[Ln,Ln],(c,[a,l])=>a.evaluate(c)||l.evaluate(c)],[Gh(Ln),(c,a)=>{for(const l of a)if(l.evaluate(c))return!0;return!1}]]},"!":[Ln,[Ln],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Ln,[Mn],(c,[a])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(a.evaluate(c))}],upcase:[Mn,[Mn],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Mn,[Mn],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Mn,Gh(An),(c,a)=>a.map(l=>rs(l.evaluate(c))).join("")],"resolved-locale":[Mn,[ig],(c,[a])=>a.evaluate(c).resolvedLocale()],random:[wr,[wr,wr,An],(c,a)=>{const[l,f,p]=a.map(y=>y.evaluate(c));if(l>f||l===f)return l;let _;if(typeof p=="string")_=function(y){let T=0;if(y.length===0)return T;for(let A=0;A<y.length;A++)T=(T<<5)-T+y.charCodeAt(A),T|=0;return T}(p);else{if(typeof p!="number")throw new or(`Invalid seed input: ${p}`);_=p}return l+fx(_)()*(f-l)}]});class Dg{constructor(a,l,f,p,_){this.expression=a,this._warningHistory={},this._evaluator=new $c(f,p,_),this._defaultValue=l?function(y){return y.type==="color"&&(Mg(y.default)||Array.isArray(y.default))?new On(0,0,0,0):y.type==="color"?On.parse(y.default)||null:y.default===void 0?null:y.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=vg(a)}evaluateWithoutErrorHandling(a,l,f,p,_,y,T,A){return this._evaluator.globals=a,this._evaluator.feature=l,this._evaluator.featureState=f,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(a,l,f,p,_,y,T,A,I){this._evaluator.globals=a,this._evaluator.feature=l||null,this._evaluator.featureState=f||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null,this._evaluator.iconImageUseTheme=I||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new or(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function vx(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in fd}function ic(c,a,l,f,p){const _=new wg(fd,[],a?function(T){const A={color:fs,string:Mn,number:wr,enum:Mn,boolean:Ln,formatted:Ru,resolvedImage:Kp};return T.type==="array"?Co(A[T.value]||An,T.length):A[T.type]}(a):void 0,void 0,void 0,l,f,p),y=_.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?Hh(new Dg(y,a,l,f,p)):zu(_.errors)}class fm{constructor(a,l,f,p){this.kind=a,this._styleExpression=l,this.isLightConstant=f,this.isLineProgressConstant=p,this.isStateDependent=a!=="constant"&&!yg(l.expression),this.configDependencies=vg(l.expression)}evaluateWithoutErrorHandling(a,l,f,p,_,y){return this._styleExpression.evaluateWithoutErrorHandling(a,l,f,p,_,y)}evaluate(a,l,f,p,_,y,T){return this._styleExpression.evaluate(a,l,f,p,_,y,void 0,void 0,T)}}class Uu{constructor(a,l,f,p,_,y){this.kind=a,this.zoomStops=f,this._styleExpression=l,this.isStateDependent=a!=="camera"&&!yg(l.expression),this.isLightConstant=_,this.isLineProgressConstant=y,this.configDependencies=vg(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(a,l,f,p,_,y){return this._styleExpression.evaluateWithoutErrorHandling(a,l,f,p,_,y)}evaluate(a,l,f,p,_,y){return this._styleExpression.evaluate(a,l,f,p,_,y)}interpolationFactor(a,l,f){return this.interpolationType?$s.interpolationFactor(this.interpolationType,a,l,f):0}}function xx(c,a,l,f,p){if((c=ic(c,a,l,f,p)).result==="error")return c;const _=c.value.expression,y=ld(_);if(!y&&!kg(a))return zu([new Al("","data expressions not supported")]);const T=cd(_,["zoom","pitch","distance-from-center"]);if(!T&&!_x(a))return zu([new Al("","zoom expressions not supported")]);const A=cd(_,["measure-light"]);if(!A&&!gx(a))return zu([new Al("","measure-light expression not supported")]);const I=cd(_,["line-progress"]);if(!I&&!function(z){return mx(z.expression,"line-progress")}(a))return zu([new Al("","line-progress expression not supported")]);const D=a.expression&&a.expression.relaxZoomRestriction,F=Lg(_);return F||T||D?F instanceof Al?zu([F]):F instanceof $s&&!Og(a)?zu([new Al("",'"interpolate" expressions cannot be used with this property')]):Hh(F?new Uu(y&&I?"camera":"composite",c.value,F.labels,F instanceof $s?F.interpolation:void 0,A,I):new fm(y&&I?"constant":"source",c.value,A,I)):zu([new Al("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Fg{constructor(a,l){this._parameters=a,this._specification=l,Object.assign(this,Rg(this._parameters,this._specification))}static deserialize(a){return new Fg(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Lg(c){let a=null;if(c instanceof Ag)a=Lg(c.result);else if(c instanceof cm){for(const l of c.args)if(a=Lg(l),a)break}else(c instanceof lm||c instanceof $s)&&c.input instanceof Uo&&c.input.name==="zoom"&&(a=c);return a instanceof Al||c.eachChild(l=>{const f=Lg(l);f instanceof Al?a=f:a&&f&&a!==f&&(a=new Al("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}var dm,Ng,rT=function(){if(Ng)return dm;Ng=1,dm=a;var c=3;function a(l,f,p){var _=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var y=new Int32Array(this.arrayBuffer);l=y[0],this.d=(f=y[1])+2*(p=y[2]);for(var T=0;T<this.d*this.d;T++){var A=y[c+T],I=y[c+T+1];_.push(A===I?null:y.subarray(A,I))}var D=y[c+_.length+1];this.keys=y.subarray(y[c+_.length],D),this.bboxes=y.subarray(D),this.insert=this._insertReadonly}else{this.d=f+2*p;for(var F=0;F<this.d*this.d;F++)_.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=l,this.padding=p,this.scale=f/l,this.uid=0;var z=p/f*l;this.min=-z,this.max=l+z}return a.prototype.insert=function(l,f,p,_,y){this._forEachCell(f,p,_,y,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(y)},a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},a.prototype._insertCell=function(l,f,p,_,y,T){this.cells[y].push(T)},a.prototype.query=function(l,f,p,_,y){var T=this.min,A=this.max;if(l<=T&&f<=T&&A<=p&&A<=_&&!y)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(l,f,p,_,this._queryCell,I,{},y),I},a.prototype._queryCell=function(l,f,p,_,y,T,A,I){var D=this.cells[y];if(D!==null)for(var F=this.keys,z=this.bboxes,H=0;H<D.length;H++){var q=D[H];if(A[q]===void 0){var ne=4*q;(I?I(z[ne+0],z[ne+1],z[ne+2],z[ne+3]):l<=z[ne+2]&&f<=z[ne+3]&&p>=z[ne+0]&&_>=z[ne+1])?(A[q]=!0,T.push(F[q])):A[q]=!1}}},a.prototype._forEachCell=function(l,f,p,_,y,T,A,I){for(var D=this._convertToCellCoord(l),F=this._convertToCellCoord(f),z=this._convertToCellCoord(p),H=this._convertToCellCoord(_),q=D;q<=z;q++)for(var ne=F;ne<=H;ne++){var ie=this.d*ne+q;if((!I||I(this._convertFromCellCoord(q),this._convertFromCellCoord(ne),this._convertFromCellCoord(q+1),this._convertFromCellCoord(ne+1)))&&y.call(this,l,f,p,_,ie,T,A,I))return}},a.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},a.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,f=c+this.cells.length+1+1,p=0,_=0;_<this.cells.length;_++)p+=this.cells[_].length;var y=new Int32Array(f+p+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var T=f,A=0;A<l.length;A++){var I=l[A];y[c+A]=T,y.set(I,T),T+=I.length}return y[c+l.length]=T,y.set(this.keys,T),y[c+l.length+1]=T+=this.keys.length,y.set(this.bboxes,T),T+=this.bboxes.length,y.buffer},dm}(),qh=ro(rT);const pd={};function sr(c,a,l={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writable:!1}),pd[a]={klass:c,omit:l.omit||[]}}sr(Object,"Object"),qh.serialize=function(c,a){const l=c.toArrayBuffer();return a&&a.add(l),{buffer:l}},qh.deserialize=function(c){return new qh(c.buffer)},Object.defineProperty(qh,"name",{value:"Grid"}),sr(qh,"Grid"),delete Pt.prototype.constructor,typeof DOMMatrix<"u"&&sr(DOMMatrix,"DOMMatrix"),sr(On,"Color"),sr(Error,"Error"),sr(jo,"Formatted"),sr(ag,"FormattedSection"),sr(Nv,"AJAXError"),sr(ts,"ResolvedImage"),sr(Fg,"StylePropertyFunction"),sr(Dg,"StyleExpression",{omit:["_evaluator"]}),sr(zs,"ImageId"),sr(Cl,"ImageVariant"),sr(Uu,"ZoomDependentExpression"),sr(fm,"ZoomConstantExpression"),sr(Uo,"CompoundExpression",{omit:["_evaluate"]});for(const c in fd)pd[fd[c]._classRegistryKey]||sr(fd[c],`Expression${c}`);function wx(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Vc(c){return self.ImageBitmap&&c instanceof ImageBitmap}function $u(c,a){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(wx(c)||Vc(c))return a&&a.add(c),c;if(ArrayBuffer.isView(c))return a&&a.add(c.buffer),c;if(c instanceof ImageData)return a&&a.add(c.data.buffer),c;if(Array.isArray(c)){const l=[];for(const f of c)l.push($u(f,a));return l}if(c instanceof Map){const l={$name:"Map",entries:[]};for(const[f,p]of c.entries())l.entries.push($u(f),$u(p,a));return l}if(c instanceof Set){const l={$name:"Set"};let f=0;for(const p of c.values())l[++f]=$u(p);return l}if(c instanceof DOMMatrix){const l={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of f)l[p]=c[p];return l}if(typeof c=="bigint")return{$name:"BigInt",value:c.toString()};if(typeof c=="object"){const l=c.constructor,f=l._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const p=l.serialize?l.serialize(c,a):{};if(!l.serialize){for(const _ in c)c.hasOwnProperty(_)&&(pd[f].omit.indexOf(_)>=0||(p[_]=$u(c[_],a)));c instanceof Error&&(p.message=c.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(p.$name=f),p}throw new Error("can't serialize object of type "+typeof c)}function Vu(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||wx(c)||Vc(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Vu);if(typeof c=="object"){const a=c.$name||"Object";if(a==="Map"){const p=c.entries||[],_=new Map;for(let y=0;y<p.length;y+=2)_.set(Vu(p[y]),Vu(p[y+1]));return _}if(a==="Set"){const p=new Set;for(const _ of Object.keys(c))_!=="$name"&&p.add(Vu(c[_]));return p}if(a==="DOMMatrix"){let p;return p=c.is2D?[c.a,c.b,c.c,c.d,c.e,c.f]:[c.m11,c.m12,c.m13,c.m14,c.m21,c.m22,c.m23,c.m24,c.m31,c.m32,c.m33,c.m34,c.m41,c.m42,c.m43,c.m44],new DOMMatrix(p)}if(a==="BigInt")return BigInt(c.value);const{klass:l}=pd[a];if(!l)throw new Error(`Can't deserialize unregistered class "${a}".`);if(l.deserialize)return l.deserialize(c);const f=Object.create(l.prototype);for(const p of Object.keys(c))p!=="$name"&&(f[p]=Vu(c[p]));return f}throw new Error("can't deserialize object of type "+typeof c)}const Pr={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function bx(c){for(const a of c)if(zg(a.charCodeAt(0)))return!0;return!1}function nT(c){for(const a of c)if(!Bg(a.charCodeAt(0)))return!1;return!0}function Bg(c){return!(Pr.Arabic(c)||Pr["Arabic Supplement"](c)||Pr["Arabic Extended-A"](c)||Pr["Arabic Presentation Forms-A"](c)||Pr["Arabic Presentation Forms-B"](c))}function zg(c){return!(c!==746&&c!==747&&(c<4352||!(Pr["Bopomofo Extended"](c)||Pr.Bopomofo(c)||Pr["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Pr["CJK Compatibility Ideographs"](c)||Pr["CJK Compatibility"](c)||Pr["CJK Radicals Supplement"](c)||Pr["CJK Strokes"](c)||!(!Pr["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Pr["CJK Unified Ideographs Extension A"](c)||Pr["CJK Unified Ideographs"](c)||Pr["Enclosed CJK Letters and Months"](c)||Pr["Hangul Compatibility Jamo"](c)||Pr["Hangul Jamo Extended-A"](c)||Pr["Hangul Jamo Extended-B"](c)||Pr["Hangul Jamo"](c)||Pr["Hangul Syllables"](c)||Pr.Hiragana(c)||Pr["Ideographic Description Characters"](c)||Pr.Kanbun(c)||Pr["Kangxi Radicals"](c)||Pr["Katakana Phonetic Extensions"](c)||Pr.Katakana(c)&&c!==12540||!(!Pr["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Pr["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Pr["Unified Canadian Aboriginal Syllabics"](c)||Pr["Unified Canadian Aboriginal Syllabics Extended"](c)||Pr["Vertical Forms"](c)||Pr["Yijing Hexagram Symbols"](c)||Pr["Yi Syllables"](c)||Pr["Yi Radicals"](c))))}function jg(c){return!(zg(c)||function(a){return!!(Pr["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Pr["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Pr["Letterlike Symbols"](a)||Pr["Number Forms"](a)||Pr["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Pr["Control Pictures"](a)&&a!==9251||Pr["Optical Character Recognition"](a)||Pr["Enclosed Alphanumerics"](a)||Pr["Geometric Shapes"](a)||Pr["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Pr["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Pr["CJK Symbols and Punctuation"](a)||Pr.Katakana(a)||Pr["Private Use Area"](a)||Pr["CJK Compatibility Forms"](a)||Pr["Small Form Variants"](a)||Pr["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}function UI(c){return Pr.Arabic(c)||Pr["Arabic Supplement"](c)||Pr["Arabic Extended-A"](c)||Pr["Arabic Presentation Forms-A"](c)||Pr["Arabic Presentation Forms-B"](c)}function iT(c){return c>=1424&&c<=2303||Pr["Arabic Presentation Forms-A"](c)||Pr["Arabic Presentation Forms-B"](c)}function $I(c,a){return!(!a&&iT(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Pr.Khmer(c))}function VI(c){for(const a of c)if(iT(a.charCodeAt(0)))return!0;return!1}const ds={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Tx=null,$o=ds.unavailable,Wu=null;const aT=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&($o=ds.error),Tx&&Tx(c)};function Sx(){Ex.fire(new El("pluginStateChange",{pluginStatus:$o,pluginURL:Wu}))}const Ex=new Lh,Ug=function(){return $o},Xh=function(){if($o!==ds.deferred||!Wu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$o=ds.loading,Sx(),Wu&&Yf({url:Wu},c=>{c?aT(c):($o=ds.loaded,Sx())})},ac={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>$o===ds.loaded||ac.applyArabicShaping!=null,isLoading:()=>$o===ds.loading,setState(c){$o=c.pluginStatus,Wu=c.pluginURL},isParsing:()=>$o===ds.parsing,isParsed:()=>$o===ds.parsed,getPluginURL:()=>Wu};class Kn{constructor(a,l){this.zoom=a,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness,this.worldview=l.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(a){return function(l,f){for(const p of l)if(!$I(p.charCodeAt(0),f))return!1;return!0}(a,ac.isLoaded())}}class Zh{constructor(a,l,f,p,_){this.property=a,this.value=l,this.expression=function(y,T,A,I,D){if(Mg(y))return new Fg(y,T);if(vx(y)||Array.isArray(y)&&y.length>0){const F=xx(y,T,A,I,D);if(F.result==="error")throw new Error(F.value.map(z=>`${z.key}: ${z.message}`).join(", "));return F.value}{let F=y;return typeof y=="string"&&T.type==="color"&&(F=On.parse(y)),{kind:"constant",configDependencies:new Set,evaluate:()=>F}}}(l===void 0?a.specification.default:l,a.specification,f,p,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,l,f,p){return this.property.possiblyEvaluate(this,a,l,f,p)}}class Ax{constructor(a,l,f,p){this.property=a,this.value=new Zh(a,void 0,l,f,p)}transitioned(a,l){return new Wc(this.property,this.value,l,Object.assign({},a.transition,this.transition),a.now)}untransitioned(){return new Wc(this.property,this.value,null,{},0)}}class oT{constructor(a,l,f,p){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues),this._scope=l,this._options=f,this._iconImageUseTheme=p,this.configDependencies=new Set}getValue(a){return xt(this._values[a].value.value)}setValue(a,l){this._values.hasOwnProperty(a)||(this._values[a]=new Ax(this._values[a].property,this._scope,this._options,this._iconImageUseTheme)),this._values[a].value=new Zh(this._values[a].property,l===null?void 0:xt(l),this._scope,this._options,this._iconImageUseTheme),this._values[a].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[a].value.expression.configDependencies]))}setTransitionOrValue(a,l){l&&(this._options=l);const f=this._properties.properties;if(a)for(const p in a){const _=a[p];if(p.endsWith("-transition")){const y=p.slice(0,-11);f[y]&&this.setTransition(y,_)}else f.hasOwnProperty(p)&&this.setValue(p,_)}}getTransition(a){return xt(this._values[a].transition)}setTransition(a,l){this._values.hasOwnProperty(a)||(this._values[a]=new Ax(this._values[a].property)),this._values[a].transition=xt(l)||void 0}serialize(){const a={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(a[l]=f);const p=this.getTransition(l);p!==void 0&&(a[`${l}-transition`]=p)}return a}transitioned(a,l){const f=new Cx(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].transitioned(a,l._values[p]);return f}untransitioned(){const a=new Cx(this._properties);for(const l of Object.keys(this._values))a._values[l]=this._values[l].untransitioned();return a}}class Wc{constructor(a,l,f,p,_){const y=p.delay||0,T=p.duration||0;_=_||0,this.property=a,this.value=l,this.begin=_+y,this.end=this.begin+T,a.specification.transition&&(p.delay||p.duration)&&(this.prior=f)}possiblyEvaluate(a,l,f){const p=a.now||0,_=this.value.possiblyEvaluate(a,l,f),y=this.prior;if(y){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return y.possiblyEvaluate(a,l,f);{const T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(a,l,f),_,Pe(T))}}return _}}class Cx{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,l,f){const p=new Jh(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(a,l,f);return p}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class Yh{constructor(a,l,f,p){this._properties=a,this._values=Object.create(a.defaultPropertyValues),this._scope=l,this._options=f,this._iconImageUseTheme=p,this.configDependencies=new Set}getValue(a){return xt(this._values[a].value)}setValue(a,l){this._values[a]=new Zh(this._values[a].property,l===null?void 0:xt(l),this._scope,this._options,this._iconImageUseTheme),this._values[a].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[a].expression.configDependencies]))}serialize(){const a={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(a[l]=f)}return a}possiblyEvaluate(a,l,f,p){const _=new Jh(this._properties);for(const y of Object.keys(this._values))_._values[y]=this._values[y].possiblyEvaluate(a,l,f,p);return _}}class Kh{constructor(a,l,f,p){this.property=a,this.value=l,this.parameters=f,this.iconImageUseTheme=p}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,l,f,p){return this.property.evaluate(this.value,this.parameters,a,l,f,p,this.iconImageUseTheme)}}class Jh{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Wt{constructor(a){this.specification=a}possiblyEvaluate(a,l){return a.expression.evaluate(l)}interpolate(a,l,f){const p=js[this.specification.type];return p?p(a,l,f):a}}class er{constructor(a,l){this.specification=a,this.overrides=l}possiblyEvaluate(a,l,f,p,_){return a.expression.kind==="constant"||a.expression.kind==="camera"?new Kh(this,{kind:"constant",value:a.expression.evaluate(l,null,{},f,p,void 0,_)},l):new Kh(this,a.expression,l,_)}interpolate(a,l,f){if(a.value.kind!=="constant"||l.value.kind!=="constant")return a;if(a.value.value===void 0||l.value.value===void 0)return new Kh(this,{kind:"constant",value:void 0},a.parameters);const p=js[this.specification.type];return p?new Kh(this,{kind:"constant",value:p(a.value.value,l.value.value,f)},a.parameters):a}evaluate(a,l,f,p,_,y,T){return a.kind==="constant"?a.value:a.evaluate(l,f,p,_,y,void 0,T)}}class md{constructor(a){this.specification=a}possiblyEvaluate(a,l,f,p){return!!a.expression.evaluate(l,null,{},f,p)}interpolate(){return!1}}class Ii{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new Kn(0,{});for(const f in a){const p=a[f];p.specification.overridable&&this.overridableProperties.push(f);const _=this.defaultPropertyValues[f]=new Zh(p,void 0),y=this.defaultTransitionablePropertyValues[f]=new Ax(p);this.defaultTransitioningPropertyValues[f]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=_.possiblyEvaluate(l)}}}sr(er,"DataDrivenProperty"),sr(Wt,"DataConstantProperty"),sr(md,"ColorRampProperty");var rt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function $g(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Qh(c){if(Array.isArray(c))return c.map(Qh);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const l in c)a[l]=Qh(c[l]);return a}return $g(c)}function Vg(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!Vg(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function pm(c,a="",l=null,f="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Vg(c)||(c=Wg(c));const p=c;let _=!0;try{_=function(D){if(!gd(D))return D;let F=Qh(D);return Il(F),F=sT(F),F}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let y=null,T=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){T=rt[`filter_${f}`];const D=ic(_,T,a,l);if(D.result==="error")throw new Error(D.value.map(F=>`${F.key}: ${F.message}`).join(", "));y=(F,z,H)=>D.value.evaluate(F,z,{},H)}let A=null,I=null;if(_!==p){const D=ic(p,T,a,l);if(D.result==="error")throw new Error(D.value.map(F=>`${F.key}: ${F.message}`).join(", "));A=(F,z,H,q,ne)=>D.value.evaluate(F,z,{},H,void 0,void 0,q,ne),I=!ld(D.value.expression)}return{filter:y,dynamicFilter:A||void 0,needGeometry:cT(_),needFeature:!!I}}function sT(c){if(!Array.isArray(c))return c;const a=function(l){if(lT.has(l[0])){for(let f=1;f<l.length;f++)if(gd(l[f]))return!0}return l}(c);return a===!0?a:a.map(l=>sT(l))}function Il(c){let a=!1;const l=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)a=a||gd(c[f]),l.push(c[f+1]);l.push(c[c.length-1])}else if(c[0]==="match"){a=a||gd(c[1]);for(let f=2;f<c.length-1;f+=2)l.push(c[f+1]);l.push(c[c.length-1])}else if(c[0]==="step"){a=a||gd(c[1]);for(let f=1;f<c.length-1;f+=2)l.push(c[f+1])}a&&(c.length=0,c.push("any",...l));for(let f=1;f<c.length;f++)Il(c[f])}function gd(c){if(!Array.isArray(c))return!1;if((a=c[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let l=1;l<c.length;l++)if(gd(c[l]))return!0;return!1}const lT=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function WI(c,a){return c<a?-1:c>a?1:0}function cT(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let a=1;a<c.length;a++)if(cT(c[a]))return!0;return!1}function Wg(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?Px(c[1],c[2],"=="):a==="!="?Gg(Px(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?Px(c[1],c[2],a):a==="any"?(l=c.slice(1),["any"].concat(l.map(Wg))):a==="all"?["all"].concat(c.slice(1).map(Wg)):a==="none"?["all"].concat(c.slice(1).map(Wg).map(Gg)):a==="in"?uT(c[1],c.slice(2)):a==="!in"?Gg(uT(c[1],c.slice(2))):a==="has"?hT(c[1]):a!=="!has"||Gg(hT(c[1]));var l}function Px(c,a,l){switch(c){case"$type":return[`filter-type-${l}`,a];case"$id":return[`filter-id-${l}`,a];default:return[`filter-${l}`,c,a]}}function uT(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(l=>typeof l!=typeof a[0])?["filter-in-large",c,["literal",a.sort(WI)]]:["filter-in-small",c,["literal",a]]}}function hT(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Gg(c){return["!",c]}const mm="";function _d(c,a){return a?`${c}${mm}${a}`:c}let Ix;const fT=()=>Ix||(Ix=new Ii({"icon-size":new er(rt.layout_symbol["icon-size"]),"icon-image":new er(rt.layout_symbol["icon-image"]),"icon-rotate":new er(rt.layout_symbol["icon-rotate"]),"icon-offset":new er(rt.layout_symbol["icon-offset"])}));class GI{constructor(a,l,f,p,_,y){const T=ic(a,rt.appearance.condition);if(T.result==="success"&&(this.condition=T.value),this.name=l,f){this.properties=new Jh(fT()),this.unevaluatedLayout=new Yh(fT(),p,_,y);for(const A in f)this.unevaluatedLayout.setValue(A,f[A])}}isActive(a){return!(this.condition||!a.isHidden||this.name!=="hidden")||this.condition.evaluate(a.globals,a.feature,a.featureState,a.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(a){return this.properties.get(a)}getUnevaluatedProperties(){return this.unevaluatedLayout}serialize(){const a={};return a.condition=this.condition.expression.serialize(),this.name&&(a.name=this.name),this.properties&&(a.properties=this.properties),a}}const dT="-transition",pT=new Set(["fill","line","background","hillshade","raster"]);class Po extends Lh{constructor(a,l,f,p,_,y){if(super(),this.id=a.id,this.fqid=_d(this.id,f),this.type=a.type,this.scope=f,this.lut=p,this.options=_,this.iconImageUseTheme=y,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,a.type!=="custom"){if(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type&&a.type!=="background"&&a.type!=="sky"&&a.type!=="slot"){this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter;const T=ic(this.filter,rt[`filter_${a.type}`]);T.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...T.value.configDependencies]))}if(a.slot&&(this.slot=a.slot),a.appearances&&a.appearances.forEach(T=>{this.appearances.push(new GI(T.condition,T.name,T.properties,this.scope,_,this.iconImageUseTheme))}),l.layout&&(this._unevaluatedLayout=new Yh(l.layout,this.scope,_,this.iconImageUseTheme),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new oT(l.paint,this.scope,_);for(const T in a.paint)this.setPaintProperty(T,a.paint[T]);for(const T in a.layout)this.setLayoutProperty(T,a.layout[T]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Jh(l.paint)}}}onAdd(a){}onRemove(a){}isDraped(a){return!this.is3D(!0)&&pT.has(this.type)}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,l){if(this.type==="custom"&&a==="visibility")return void(this.visibility=l);const f=this._unevaluatedLayout;f._properties.properties[a]&&(f.setValue(a,l),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),a==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(a){return a.endsWith(dT)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,l){const f=this._transitionablePaint,p=f._properties.properties;if(a.endsWith(dT)){const F=a.slice(0,-11);return p[F]&&f.setTransition(F,l||void 0),!1}if(!p[a])return!1;const _=f._values[a],y=_.value.isDataDriven(),T=_.value;f.setValue(a,l),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(a);const A=f._values[a].value,I=A.isDataDriven(),D=a.endsWith("pattern")||a==="line-dasharray";return I||y||D||this._handleOverridablePaintPropertyUpdate(a,T,A)}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getDefaultProgramParams(a,l,f){return null}_handleOverridablePaintPropertyUpdate(a,l,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,l,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,l)}serialize(){const a={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(a.appearances=this.appearances.map(l=>l.serialize())),bt(a,(l,f)=>!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length))}is3D(a){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const a in this.paint._values){const l=this.paint.get(a);if(l instanceof Kh&&kg(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(a){this._filterCompiled||(this._featureFilter=pm(this.filter,this.scope,a),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(a){this._stats&&(a.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRadius(a){}queryIntersectsFeature(a,l,f,p,_,y,T,A,I){}}const Gu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class yd{constructor(a,l){this._structArray=a,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ci{constructor(){this.capacity=-1,this.resize(0)}static serialize(a,l){return a._trim(),l&&l.add(a.arrayBuffer),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const l=Object.create(this.prototype);return l.arrayBuffer=a.arrayBuffer,l.length=a.length,l.capacity=a.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...a){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...a){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function fn(c,a=1){let l=0,f=0;return{members:c.map(p=>{const _=Gu[p.type].BYTES_PER_ELEMENT,y=l=mT(l,Math.max(a,_)),T=p.components||1;return f=Math.max(f,_),l+=_*T,{name:p.name,type:p.type,components:T,offset:y}}),size:mT(l,Math.max(f,a)),alignment:a}}function mT(c,a){return Math.ceil(c/a)*a}class Hu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const p=2*a;return this.int16[p+0]=l,this.int16[p+1]=f,a}}Hu.prototype.bytesPerElement=4,sr(Hu,"StructArrayLayout2i4");class ef extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,a,l,f)}emplace(a,l,f,p){const _=3*a;return this.int16[_+0]=l,this.int16[_+1]=f,this.int16[_+2]=p,a}}ef.prototype.bytesPerElement=6,sr(ef,"StructArrayLayout3i6");class tf extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,l,f,p)}emplace(a,l,f,p,_){const y=4*a;return this.int16[y+0]=l,this.int16[y+1]=f,this.int16[y+2]=p,this.int16[y+3]=_,a}}tf.prototype.bytesPerElement=8,sr(tf,"StructArrayLayout4i8");class qu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.float32[1*a+0]=l,a}}qu.prototype.bytesPerElement=4,sr(qu,"StructArrayLayout1f4");class kx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,a,l,f)}emplace(a,l,f,p){const _=4*a,y=2*a;return this.int16[_+0]=l,this.int16[_+1]=f,this.float32[y+1]=p,a}}kx.prototype.bytesPerElement=8,sr(kx,"StructArrayLayout2i1f8");class Hg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,a,l,f)}emplace(a,l,f,p){const _=4*a;return this.int16[_+0]=l,this.int16[_+1]=f,this.int16[_+2]=p,a}}Hg.prototype.bytesPerElement=8,sr(Hg,"StructArrayLayout3i8");class Ox extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_){const y=this.length;return this.resize(y+1),this.emplace(y,a,l,f,p,_)}emplace(a,l,f,p,_,y){const T=5*a;return this.int16[T+0]=l,this.int16[T+1]=f,this.int16[T+2]=p,this.int16[T+3]=_,this.int16[T+4]=y,a}}Ox.prototype.bytesPerElement=10,sr(Ox,"StructArrayLayout5i10");class qg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T){const A=this.length;return this.resize(A+1),this.emplace(A,a,l,f,p,_,y,T)}emplace(a,l,f,p,_,y,T,A){const I=6*a,D=12*a,F=3*a;return this.int16[I+0]=l,this.int16[I+1]=f,this.uint8[D+4]=p,this.uint8[D+5]=_,this.uint8[D+6]=y,this.uint8[D+7]=T,this.float32[F+2]=A,a}}qg.prototype.bytesPerElement=12,sr(qg,"StructArrayLayout2i4ub1f12");class ns extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,a,l,f)}emplace(a,l,f,p){const _=3*a;return this.float32[_+0]=l,this.float32[_+1]=f,this.float32[_+2]=p,a}}ns.prototype.bytesPerElement=12,sr(ns,"StructArrayLayout3f12");class Xu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_){const y=this.length;return this.resize(y+1),this.emplace(y,a,l,f,p,_)}emplace(a,l,f,p,_,y){const T=6*a,A=3*a;return this.uint16[T+0]=l,this.uint16[T+1]=f,this.uint16[T+2]=p,this.uint16[T+3]=_,this.float32[A+2]=y,a}}Xu.prototype.bytesPerElement=12,sr(Xu,"StructArrayLayout4ui1f12");class vd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,l,f,p)}emplace(a,l,f,p,_){const y=4*a;return this.uint16[y+0]=l,this.uint16[y+1]=f,this.uint16[y+2]=p,this.uint16[y+3]=_,a}}vd.prototype.bytesPerElement=8,sr(vd,"StructArrayLayout4ui8");class Xg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,p,_,y)}emplace(a,l,f,p,_,y,T){const A=6*a;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=p,this.int16[A+3]=_,this.int16[A+4]=y,this.int16[A+5]=T,a}}Xg.prototype.bytesPerElement=12,sr(Xg,"StructArrayLayout6i12");class Mx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F,z){const H=this.length;return this.resize(H+1),this.emplace(H,a,l,f,p,_,y,T,A,I,D,F,z)}emplace(a,l,f,p,_,y,T,A,I,D,F,z,H){const q=12*a;return this.int16[q+0]=l,this.int16[q+1]=f,this.int16[q+2]=p,this.int16[q+3]=_,this.uint16[q+4]=y,this.uint16[q+5]=T,this.uint16[q+6]=A,this.uint16[q+7]=I,this.int16[q+8]=D,this.int16[q+9]=F,this.int16[q+10]=z,this.int16[q+11]=H,a}}Mx.prototype.bytesPerElement=24,sr(Mx,"StructArrayLayout4i4ui4i24");class Rx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,p,_,y)}emplace(a,l,f,p,_,y,T){const A=10*a,I=5*a;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=p,this.float32[I+2]=_,this.float32[I+3]=y,this.float32[I+4]=T,a}}Rx.prototype.bytesPerElement=20,sr(Rx,"StructArrayLayout3i3f20");class kl extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,l,f,p)}emplace(a,l,f,p,_){const y=4*a;return this.float32[y+0]=l,this.float32[y+1]=f,this.float32[y+2]=p,this.float32[y+3]=_,a}}kl.prototype.bytesPerElement=16,sr(kl,"StructArrayLayout4f16");class xd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint32[1*a+0]=l,a}}xd.prototype.bytesPerElement=4,sr(xd,"StructArrayLayout1ul4");class ma extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const p=2*a;return this.uint16[p+0]=l,this.uint16[p+1]=f,a}}ma.prototype.bytesPerElement=4,sr(ma,"StructArrayLayout2ui4");class wd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F,z,H){const q=this.length;return this.resize(q+1),this.emplace(q,a,l,f,p,_,y,T,A,I,D,F,z,H)}emplace(a,l,f,p,_,y,T,A,I,D,F,z,H,q){const ne=20*a,ie=10*a;return this.int16[ne+0]=l,this.int16[ne+1]=f,this.int16[ne+2]=p,this.int16[ne+3]=_,this.int16[ne+4]=y,this.float32[ie+3]=T,this.float32[ie+4]=A,this.float32[ie+5]=I,this.float32[ie+6]=D,this.int16[ne+14]=F,this.uint32[ie+8]=z,this.uint16[ne+18]=H,this.uint16[ne+19]=q,a}}wd.prototype.bytesPerElement=40,sr(wd,"StructArrayLayout5i4f1i1ul2ui40");class Zg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T){const A=this.length;return this.resize(A+1),this.emplace(A,a,l,f,p,_,y,T)}emplace(a,l,f,p,_,y,T,A){const I=8*a;return this.int16[I+0]=l,this.int16[I+1]=f,this.int16[I+2]=p,this.int16[I+4]=_,this.int16[I+5]=y,this.int16[I+6]=T,this.int16[I+7]=A,a}}Zg.prototype.bytesPerElement=16,sr(Zg,"StructArrayLayout3i2i2i16");class Dx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_){const y=this.length;return this.resize(y+1),this.emplace(y,a,l,f,p,_)}emplace(a,l,f,p,_,y){const T=4*a,A=8*a;return this.float32[T+0]=l,this.float32[T+1]=f,this.float32[T+2]=p,this.int16[A+6]=_,this.int16[A+7]=y,a}}Dx.prototype.bytesPerElement=16,sr(Dx,"StructArrayLayout2f1f2i16");class Fx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,p,_,y)}emplace(a,l,f,p,_,y,T){const A=20*a,I=5*a;return this.uint8[A+0]=l,this.uint8[A+1]=f,this.float32[I+1]=p,this.float32[I+2]=_,this.float32[I+3]=y,this.float32[I+4]=T,a}}Fx.prototype.bytesPerElement=20,sr(Fx,"StructArrayLayout2ub4f20");class Ta extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f){const p=this.length;return this.resize(p+1),this.emplace(p,a,l,f)}emplace(a,l,f,p){const _=3*a;return this.uint16[_+0]=l,this.uint16[_+1]=f,this.uint16[_+2]=p,a}}Ta.prototype.bytesPerElement=6,sr(Ta,"StructArrayLayout3ui6");class gm extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be){const ze=this.length;return this.resize(ze+1),this.emplace(ze,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be)}emplace(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be,ze){const Ve=30*a,Ze=15*a,Ye=60*a;return this.int16[Ve+0]=l,this.int16[Ve+1]=f,this.int16[Ve+2]=p,this.float32[Ze+2]=_,this.float32[Ze+3]=y,this.uint16[Ve+8]=T,this.uint16[Ve+9]=A,this.uint32[Ze+5]=I,this.uint32[Ze+6]=D,this.uint32[Ze+7]=F,this.uint16[Ve+16]=z,this.uint16[Ve+17]=H,this.uint16[Ve+18]=q,this.float32[Ze+10]=ne,this.float32[Ze+11]=ie,this.uint8[Ye+48]=ae,this.uint8[Ye+49]=me,this.uint8[Ye+50]=ye,this.uint32[Ze+13]=we,this.int16[Ve+28]=Be,this.uint8[Ye+58]=ze,a}}gm.prototype.bytesPerElement=60,sr(gm,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Lx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt,Ot,Lt,$t,Et){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt,Ot,Lt,$t,Et)}emplace(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye,we,Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt,Ot,Lt,$t,Et,Nt){const gt=20*a,ut=40*a,Vt=80*a;return this.float32[gt+0]=l,this.float32[gt+1]=f,this.int16[ut+4]=p,this.int16[ut+5]=_,this.int16[ut+6]=y,this.int16[ut+7]=T,this.int16[ut+8]=A,this.int16[ut+9]=I,this.int16[ut+10]=D,this.int16[ut+11]=F,this.int16[ut+12]=z,this.uint16[ut+13]=H,this.uint16[ut+14]=q,this.uint16[ut+15]=ne,this.uint16[ut+16]=ie,this.uint16[ut+17]=ae,this.uint16[ut+18]=me,this.uint16[ut+19]=ye,this.uint16[ut+20]=we,this.uint16[ut+21]=Be,this.uint16[ut+22]=ze,this.uint16[ut+23]=Ve,this.uint16[ut+24]=Ze,this.uint16[ut+25]=Ye,this.uint16[ut+26]=Ct,this.uint16[ut+27]=nt,this.uint32[gt+14]=kt,this.float32[gt+15]=zt,this.float32[gt+16]=Ot,this.float32[gt+17]=Lt,this.float32[gt+18]=$t,this.uint8[Vt+76]=Et,this.uint16[ut+39]=Nt,a}}Lx.prototype.bytesPerElement=80,sr(Lx,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class _m extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,p,_,y)}emplace(a,l,f,p,_,y,T){const A=6*a;return this.float32[A+0]=l,this.float32[A+1]=f,this.float32[A+2]=p,this.float32[A+3]=_,this.float32[A+4]=y,this.float32[A+5]=T,a}}_m.prototype.bytesPerElement=24,sr(_m,"StructArrayLayout6f24");class rf extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_){const y=this.length;return this.resize(y+1),this.emplace(y,a,l,f,p,_)}emplace(a,l,f,p,_,y){const T=5*a;return this.float32[T+0]=l,this.float32[T+1]=f,this.float32[T+2]=p,this.float32[T+3]=_,this.float32[T+4]=y,a}}rf.prototype.bytesPerElement=20,sr(rf,"StructArrayLayout5f20");class Nx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T){const A=this.length;return this.resize(A+1),this.emplace(A,a,l,f,p,_,y,T)}emplace(a,l,f,p,_,y,T,A){const I=7*a;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=p,this.float32[I+3]=_,this.float32[I+4]=y,this.float32[I+5]=T,this.float32[I+6]=A,a}}Nx.prototype.bytesPerElement=28,sr(Nx,"StructArrayLayout7f28");class Yg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F){const z=this.length;return this.resize(z+1),this.emplace(z,a,l,f,p,_,y,T,A,I,D,F)}emplace(a,l,f,p,_,y,T,A,I,D,F,z){const H=11*a;return this.float32[H+0]=l,this.float32[H+1]=f,this.float32[H+2]=p,this.float32[H+3]=_,this.float32[H+4]=y,this.float32[H+5]=T,this.float32[H+6]=A,this.float32[H+7]=I,this.float32[H+8]=D,this.float32[H+9]=F,this.float32[H+10]=z,a}}Yg.prototype.bytesPerElement=44,sr(Yg,"StructArrayLayout11f44");class ym extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I){const D=this.length;return this.resize(D+1),this.emplace(D,a,l,f,p,_,y,T,A,I)}emplace(a,l,f,p,_,y,T,A,I,D){const F=9*a;return this.float32[F+0]=l,this.float32[F+1]=f,this.float32[F+2]=p,this.float32[F+3]=_,this.float32[F+4]=y,this.float32[F+5]=T,this.float32[F+6]=A,this.float32[F+7]=I,this.float32[F+8]=D,a}}ym.prototype.bytesPerElement=36,sr(ym,"StructArrayLayout9f36");class bd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const p=2*a;return this.float32[p+0]=l,this.float32[p+1]=f,a}}bd.prototype.bytesPerElement=8,sr(bd,"StructArrayLayout2f8");class Kg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,l,f,p)}emplace(a,l,f,p,_){const y=6*a;return this.uint32[3*a+0]=l,this.uint16[y+2]=f,this.uint16[y+3]=p,this.uint16[y+4]=_,a}}Kg.prototype.bytesPerElement=12,sr(Kg,"StructArrayLayout1ul3ui12");class Jg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint16[1*a+0]=l,a}}Jg.prototype.bytesPerElement=2,sr(Jg,"StructArrayLayout1ui2");class Bx extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie){const ae=this.length;return this.resize(ae+1),this.emplace(ae,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie)}emplace(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae){const me=16*a;return this.float32[me+0]=l,this.float32[me+1]=f,this.float32[me+2]=p,this.float32[me+3]=_,this.float32[me+4]=y,this.float32[me+5]=T,this.float32[me+6]=A,this.float32[me+7]=I,this.float32[me+8]=D,this.float32[me+9]=F,this.float32[me+10]=z,this.float32[me+11]=H,this.float32[me+12]=q,this.float32[me+13]=ne,this.float32[me+14]=ie,this.float32[me+15]=ae,a}}Bx.prototype.bytesPerElement=64,sr(Bx,"StructArrayLayout16f64");class Td extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,p,_,y,T){const A=this.length;return this.resize(A+1),this.emplace(A,a,l,f,p,_,y,T)}emplace(a,l,f,p,_,y,T,A){const I=10*a,D=5*a;return this.uint16[I+0]=l,this.uint16[I+1]=f,this.uint16[I+2]=p,this.uint16[I+3]=_,this.float32[D+2]=y,this.float32[D+3]=T,this.float32[D+4]=A,a}}Td.prototype.bytesPerElement=20,sr(Td,"StructArrayLayout4ui3f20");class Sd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.int16[1*a+0]=l,a}}Sd.prototype.bytesPerElement=2,sr(Sd,"StructArrayLayout1i2");class Qg extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint8[1*a+0]=l,a}}Qg.prototype.bytesPerElement=1,sr(Qg,"StructArrayLayout1ub1");class gT extends yd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}gT.prototype.size=40;class zx extends wd{get(a){return new gT(this,a)}}sr(zx,"CollisionBoxArray");class _T extends yd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}_T.prototype.size=60;class e_ extends gm{get(a){return new _T(this,a)}}sr(e_,"PlacedSymbolArray");class yT extends yd{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(a){this._structArray.uint32[this._pos4+14]=a}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(a){this._structArray.float32[this._pos4+18]=a}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}yT.prototype.size=80;class vT extends Lx{get(a){return new yT(this,a)}}sr(vT,"SymbolInstanceArray");class xT extends qu{getoffsetX(a){return this.float32[1*a+0]}}sr(xT,"GlyphOffsetArray");class wT extends Hu{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}sr(wT,"SymbolLineVertexArray");class jx extends yd{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}jx.prototype.size=12;class bT extends Kg{get(a){return new jx(this,a)}}sr(bT,"FeatureIndexArray");class TT extends ma{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}sr(TT,"FillExtrusionCentroidArray");class ST extends yd{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ST.prototype.size=6;class ET extends ef{get(a){return new ST(this,a)}}sr(ET,"FillExtrusionWallArray");const HI=fn([{name:"a_pos",components:2,type:"Int16"}],4),qI=fn([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),XI=fn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ti{constructor(a=[]){this.segments=a}_prepareSegment(a,l,f,p){let _=this.segments[this.segments.length-1];return a>Ti.MAX_VERTEX_ARRAY_LENGTH&&nr(`Max vertices per segment is ${Ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!_||_.vertexLength+a>Ti.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:l,primitiveOffset:f,vertexLength:0,primitiveLength:0},p!==void 0&&(_.sortKey=p),this.segments.push(_)),_}prepareSegment(a,l,f,p){return this._prepareSegment(a,l.length,f.length,p)}get(){return this.segments}destroy(){for(const a of this.segments)for(const l in a.vaos)a.vaos[l].destroy()}static simpleSegment(a,l,f,p){return new Ti([{vertexOffset:a,primitiveOffset:l,vertexLength:f,primitiveLength:p,vaos:{},sortKey:0}])}}function vm(c,a){return 256*(c=Q(Math.floor(c),0,255))+Q(Math.floor(a),0,255)}Ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,sr(Ti,"SegmentVector");const ZI=fn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),YI=fn([{name:"a_pattern_b",components:4,type:"Uint16"}]),t_=fn([{name:"a_dash",components:4,type:"Uint16"}]);class xm{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(a,l,f,p){this.ids.push(Ux(a)),this.positions.push(l,f,p)}eachPosition(a,l){const f=Ux(a);let p=0,_=this.ids.length-1;for(;p<_;){const y=p+_>>1;this.ids[y]>=f?_=y:p=y+1}for(;this.ids[p]===f;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(a,l){const f=new Float64Array(a.ids),p=new Uint32Array(a.positions);return $x(f,p,0,f.length-1),l&&(l.add(f.buffer),l.add(p.buffer)),{ids:f,positions:p}}static deserialize(a){const l=new xm;let f;l.ids=a.ids,l.positions=a.positions;for(const p of l.ids)p!==f&&l.uniqueIds.push(p),f=p;return l.indexed=!0,l}}function Ux(c){const a=+c;return Number.isSafeInteger(a)?a:Q0(String(c))}function $x(c,a,l,f){for(;l<f;){const p=c[l+f>>1];let _=l-1,y=f+1;for(;;){do _++;while(c[_]<p);do y--;while(c[y]>p);if(_>=y)break;wm(c,_,y),wm(a,3*_,3*y),wm(a,3*_+1,3*y+1),wm(a,3*_+2,3*y+2)}y-l<f-y?($x(c,a,l,y),l=y+1):($x(c,a,y+1,f),f=y)}}function wm(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}sr(xm,"FeaturePositionMap");class oc{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,l),this.initialized=!0),!!this.location}set(a,l,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class bm extends oc{constructor(a){super(a),this.current=0}set(a,l,f){this.fetchUniformLocation(a,l)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class Hi extends oc{constructor(a){super(a),this.current=0}set(a,l,f){this.fetchUniformLocation(a,l)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class sc extends oc{constructor(a){super(a),this.current=[0,0]}set(a,l,f){this.fetchUniformLocation(a,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class Tm extends oc{constructor(a){super(a),this.current=[0,0,0]}set(a,l,f){this.fetchUniformLocation(a,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class Sm extends oc{constructor(a){super(a),this.current=[0,0,0,0]}set(a,l,f){this.fetchUniformLocation(a,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class AT extends oc{constructor(a){super(a),this.current=On.transparent.toPremultipliedRenderColor(null)}set(a,l,f){this.fetchUniformLocation(a,l)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const KI=new Float32Array(16);class Em extends oc{constructor(a){super(a),this.current=KI}set(a,l,f){if(this.fetchUniformLocation(a,l)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let p=1;p<16;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const JI=new Float32Array(9),QI=new Float32Array(4);class r_ extends oc{constructor(a){super(a),this.current=QI}set(a,l,f){if(this.fetchUniformLocation(a,l)){for(let p=0;p<4;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function Am(c){return[vm(255*c.r,255*c.g),vm(255*c.b,255*c.a)]}class Vs{constructor(a,l,f,p){this.value=a,this.uniformNames=l.map(_=>`u_${_}`),this.type=f,this.context=p}setUniform(a,l,f,p,_){const y=p.constantOr(this.value);l.set(a,_,y instanceof On?y.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):y)}getBinding(a,l){return this.type==="color"?new AT(a):new Hi(a)}}class nf{constructor(a,l){this.uniformNames=l.map(f=>`u_${f}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(a,l){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(a,l,f,p,_){let y=null;_!=="u_pattern"&&_!=="u_dash"||(y=this.pattern),_==="u_pattern_b"&&(y=this.patternTransition),_==="u_pixel_ratio"&&(y=this.pixelRatio),y&&l.set(a,_,y)}getBinding(a,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new Sm(a):new Hi(a)}}class Zu{constructor(a,l,f,p){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(a,l,f,p,_,y,T,A){const I=this.paintVertexArray.length,D=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Kn(0,{brightness:y,worldview:A}),l,{},_,p,T):this.expression.kind==="constant"&&this.expression.value,F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Kn(0,{brightness:y,worldview:A}),l,{},_,p,T):this.lutExpression.value)==="none";this.paintVertexArray.resize(a),this._setPaintValue(I,a,D,F?null:this.context.lut)}updatePaintArray(a,l,f,p,_,y,T,A){const I=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T,worldview:A},f,p,void 0,_):this.expression.kind==="constant"&&this.expression.value,D=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Kn(0,{brightness:T,worldview:A}),f,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(a,l,I,D?null:this.context.lut)}_setPaintValue(a,l,f,p){if(this.type==="color"){const _=Am(f.toPremultipliedRenderColor(p));for(let y=a;y<l;y++)this.paintVertexArray.emplace(y,_[0],_[1])}else{for(let _=a;_<l;_++)this.paintVertexArray.emplace(_,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gc{constructor(a,l,f,p,_,y){this.expression=a,this.uniformNames=l.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=p,this.context=_,this.maxValue=0,this.paintVertexAttributes=l.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(a,l,f,p,_,y,T,A){const I=this.expression.evaluate(new Kn(this.context.zoom,{brightness:y,worldview:A}),l,{},_,p,T),D=this.expression.evaluate(new Kn(this.context.zoom+1,{brightness:y,worldview:A}),l,{},_,p,T),F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Kn(0,{brightness:y,worldview:A}),l,{},_,p,T):this.lutExpression.value)==="none",z=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(z,a,I,D,F?null:this.context.lut)}updatePaintArray(a,l,f,p,_,y,T,A){const I=this.expression.evaluate({zoom:this.context.zoom,brightness:T,worldview:A},f,p,void 0,_),D=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T,worldview:A},f,p,void 0,_),F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Kn(0,{brightness:T,worldview:A}),f,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(a,l,I,D,F?null:this.context.lut)}_setPaintValue(a,l,f,p,_){if(this.type==="color"){const y=Am(f.toPremultipliedRenderColor(_)),T=Am(f.toPremultipliedRenderColor(_));for(let A=a;A<l;A++)this.paintVertexArray.emplace(A,y[0],y[1],T[0],T[1])}else{for(let y=a;y<l;y++)this.paintVertexArray.emplace(y,f,p);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,l,f,p,_){const y=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=Q(this.expression.interpolationFactor(y,this.context.zoom,this.context.zoom+1),0,1);l.set(a,_,T)}getBinding(a,l){return new Hi(a)}}class Hc{constructor(a,l,f,p,_){this.expression=a,this.layerId=_,this.paintVertexAttributes=(f==="array"?t_:ZI).members;for(let y=0;y<l.length;++y);this.paintVertexArray=new p,this.paintTransitionVertexArray=new vd}populatePaintArray(a,l,f,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(_,a,l.patterns&&l.patterns[this.layerId],f)}updatePaintArray(a,l,f,p,_,y,T){this._setPaintValues(a,l,f.patterns&&f.patterns[this.layerId],y)}_setPaintValues(a,l,f,p){if(!p||!f)return;const _=p[f[0]],y=p[f[1]];if(_){if(_){const{tl:T,br:A,pixelRatio:I}=_;for(let D=a;D<l;D++)this.paintVertexArray.emplace(D,T[0],T[1],A[0],A[1],I)}if(y){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:T,br:A}=y;for(let I=a;I<l;I++)this.paintTransitionVertexArray.emplace(I,T[0],T[1],A[0],A[1])}}}upload(a){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=a.createVertexBuffer(this.paintTransitionVertexArray,YI.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class af{constructor(a,l,f=()=>!0){this.binders={},this._buffers=[],this.context=l;const p=[];for(const _ in a.paint._values){const y=a.paint.get(_);if(_.endsWith("-use-theme")||!f(_)||!(y instanceof Kh&&kg(y.property.specification)))continue;const T=SN(_,a.type),A=y.value,I=y.property.specification.type,D=!!y.property.useIntegerZoom,F=_==="line-dasharray"||_.endsWith("pattern"),z=a.paint.get(`${_}-use-theme`),H=_==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant"||z&&z.value.kind!=="constant";if(A.kind!=="constant"||H)if(A.kind==="source"||H||F){const q=h(_,I,"source");this.binders[_]=F?new Hc(A,T,I,q,a.id):new Zu(A,T,I,q),p.push(`/a_${_}`)}else{const q=h(_,I,"composite");this.binders[_]=new Gc(A,T,I,D,l,q),p.push(`/z_${_}`)}else this.binders[_]=F?new nf(A.value,T):new Vs(A.value,T,I,l),p.push(`/u_${_}`);z&&(this.binders[_].lutExpression=z.value)}this.cacheKey=p.sort().join("")}getMaxValue(a){const l=this.binders[a];return l instanceof Zu||l instanceof Gc?l.maxValue:0}populatePaintArrays(a,l,f,p,_,y,T,A){for(const I in this.binders){const D=this.binders[I];D.context=this.context,(D instanceof Zu||D instanceof Gc||D instanceof Hc)&&D.populatePaintArray(a,l,f,p,_,y,T,A)}}setConstantPatternPositions(a,l){for(const f in this.binders){const p=this.binders[f];p instanceof nf&&p.setConstantPatternPositions(a,l)}}getPatternTransitionVertexBuffer(a){const l=this.binders[a];return l instanceof Hc?l.paintTransitionVertexBuffer:null}updatePaintArrays(a,l,f,p,_,y,T,A,I,D){let F=!1;const z=Object.keys(a),H=z.length!==0&&!A,q=H?z:l.uniqueIds;this.context.lut=_.lut;for(const ne in this.binders){const ie=this.binders[ne];if(ie.context=this.context,(ie instanceof Zu||ie instanceof Gc||ie instanceof Hc)&&ie.expression&&ie.expression.kind&&ie.expression.kind!=="constant"&&(ie.expression.isStateDependent===!0||ie.expression.isLightConstant===!1)){const ae=_.paint.get(ne);ie.expression=ae.value;for(const me of q){const ye=a[me.toString()];l.eachPosition(me,(we,Be,ze)=>{const Ve=p.feature(we);ie.updatePaintArray(Be,ze,Ve,ye,y,T,I,D)})}if(!H)for(const me of f.uniqueIds){const ye=a[me.toString()];f.eachPosition(me,(we,Be,ze)=>{const Ve=p.feature(we);ie.updatePaintArray(Be,ze,Ve,ye,y,T,I,D)})}F=!0}}return F}defines(){const a=[];for(const l in this.binders){const f=this.binders[l];(f instanceof Vs||f instanceof nf)&&a.push(...f.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const l=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof Vs||p instanceof nf||p instanceof Gc)for(const _ of p.uniformNames)l.push({name:_,property:f,binding:p.getBinding(a,_)})}return l}setUniforms(a,l,f,p,_){for(const{name:y,property:T,binding:A}of f)this.binders[T].setUniform(a,A,_,p.get(T),y)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const l=this.binders[a];(l instanceof Zu||l instanceof Gc||l instanceof Hc)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof Hc&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(a){for(const l in this.binders){const f=this.binders[l];(f instanceof Zu||f instanceof Gc||f instanceof Hc)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const l=this.binders[a];(l instanceof Zu||l instanceof Gc||l instanceof Hc)&&l.destroy()}}}class Ol{constructor(a,l,f=()=>!0){this.programConfigurations={};for(const p of a)this.programConfigurations[p.id]=new af(p,l,f);this.needsUpload=!1,this._featureMap=new xm,this._featureMapWithoutIds=new xm,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(a,l,f,p,_,y,T,A,I){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(a,l,p,_,y,T,A,I);l.id!==void 0?this._featureMap.add(l.id,f,this._bufferOffset,a):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,a),this._idlessCounter+=1),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,l,f,p,_,y,T,A){for(const I of f)this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(a,this._featureMap,this._featureMapWithoutIds,l,I,p,_,y,T||0,A)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const CT={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function SN(c,a){return CT[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:Xu,composite:Xu},"fill-pattern":{source:Xu,composite:Xu},"fill-extrusion-pattern":{source:Xu,composite:Xu},"line-dasharray":{source:vd,composite:vd}},s={color:{source:bd,composite:kl},number:{source:qu,composite:bd}};function h(c,a,l){const f=g[c];return f&&f[l]||s[a][l]}sr(Vs,"ConstantBinder"),sr(nf,"PatternConstantBinder"),sr(Zu,"SourceExpressionBinder"),sr(Hc,"PatternCompositeBinder"),sr(Gc,"CompositeExpressionBinder"),sr(af,"ProgramConfiguration",{omit:["_buffers"]}),sr(Ol,"ProgramConfigurationSet");const m=Zt/Math.PI/2,x=5,b=6,E=16383,P=64,M=[P,32,16],B=-m,j=m;function X(c,a,l,f=m){return l=Qe(l),[c*Math.sin(l)*f,-a*f,c*Math.cos(l)*f]}function W(c,a,l){return X(Math.cos(Qe(c)),Math.sin(Qe(c)),a,l)}const Y=63710088e-1,ee=2*Math.PI*Y;class te{constructor(a,l){if(isNaN(a)||isNaN(l))throw new Error(`Invalid LngLat object: (${a}, ${l})`);if(this.lng=+a,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new te(le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const l=Math.PI/180,f=this.lat*l,p=a.lat*l,_=Math.sin(f)*Math.sin(p)+Math.cos(f)*Math.cos(p)*Math.cos((a.lng-this.lng)*l);return Y*Math.acos(Math.min(_,1))}toBounds(a=0){const l=360*a/40075017,f=l/Math.cos(Math.PI/180*this.lat);return new ce({lng:this.lng-f,lat:this.lat-l},{lng:this.lng+f,lat:this.lat+l})}toEcef(a){return W(this.lat,this.lng,m+a*m/Y)}static convert(a){if(a instanceof te)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new te(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new te(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ce{constructor(a,l){a&&(l?this.setSouthWest(a).setNorthEast(l):Array.isArray(a)&&a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof te?new te(a.lng,a.lat):te.convert(a),this}setSouthWest(a){return this._sw=a instanceof te?new te(a.lng,a.lat):te.convert(a),this}extend(a){const l=this._sw,f=this._ne;let p,_;if(a instanceof te)p=a,_=a;else{if(!(a instanceof ce))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(ce.convert(a)):this.extend(te.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(te.convert(a)):this;if(p=a._sw,_=a._ne,!p||!_)return this}return l||f?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),f.lng=Math.max(_.lng,f.lng),f.lat=Math.max(_.lat,f.lat)):(this._sw=new te(p.lng,p.lat),this._ne=new te(_.lng,_.lat)),this}getCenter(){return new te((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new te(this.getWest(),this.getNorth())}getSouthEast(){return new te(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:l,lat:f}=te.convert(a);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&p}static convert(a){if(a)return a instanceof ce?a:new ce(a)}}const oe=0,de=25.5;function xe(c){return ee*Math.cos(c*Math.PI/180)}function Ee(c){return(180+c)/360}function De(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Me(c,a){return c/xe(a)}function Fe(c){return 360*c-180}function Re(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Oe(c,a){return c*xe(Re(a))}const Le=85.051129;function ct(c){return Math.cos(Qe(Q(c,-Le,Le)))}function Ke(c,a){const l=Q(a,oe,de),f=Math.pow(2,l);return ct(c)*ee/(512*f)}function vt(c){return 1/Math.cos(c*Math.PI/180)}function st(c,a=0){const l=Math.exp(Math.PI*(1-(c.y+a/Zt)/(1<<c.z)*2));return 80150034*l/(l*l+1)/Zt/(1<<c.z)}class _t{constructor(a,l,f=0){this.x=+a,this.y=+l,this.z=+f}static fromLngLat(a,l=0){const f=te.convert(a);return new _t(Ee(f.lng),De(f.lat),Me(l,f.lat))}toLngLat(){return new te(Fe(this.x),Re(this.y))}toAltitude(){return Oe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ee*vt(Re(this.y))}}function Ht(c,a,l,f,p,_,y,T,A){const I=(a+f)/2,D=(l+p)/2,F=new Pt(I,D);T(F),function(z,H,q,ne,ie,ae){const me=q-ie,ye=ne-ae;return Math.abs((ne-H)*me-(q-z)*ye)/Math.hypot(me,ye)}(F.x,F.y,_.x,_.y,y.x,y.y)>=A?(Ht(c,a,l,I,D,_,F,T,A),Ht(c,I,D,f,p,F,y,T,A)):c.push(y)}function lt(c,a,l){let f=c[0],p=f.x,_=f.y;a(f);const y=[f];for(let T=1;T<c.length;T++){const A=c[T],{x:I,y:D}=A;a(A),Ht(y,p,_,I,D,f,A,a,l),p=I,_=D,f=A}return y}function He(c,a,l,f){if(f(a,l)){const p=a.add(l)._mult(.5);He(c,a,p,f),He(c,p,l,f)}else c.push(l)}function Tt(c,a){let l=c[0];const f=[l];for(let p=1;p<c.length;p++){const _=c[p];He(f,l,_,a),l=_}return f}const ht=Math.pow(2,14)-1,Ft=-ht-1;function Gt(c,a){const l=Math.round(c.x*a),f=Math.round(c.y*a);return c.x=Q(l,Ft,ht),c.y=Q(f,Ft,ht),(l<c.x||l>c.x+1||f<c.y||f>c.y+1)&&nr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function tr(c,a,l){const f=c.loadGeometry(),p=c.extent,_=Zt/p;if(a&&l&&l.projection.isReprojectedInTileSpace){const y=1<<a.z,{scale:T,x:A,y:I,projection:D}=l,F=z=>{const H=Fe((a.x+z.x/p)/y),q=Re((a.y+z.y/p)/y),ne=D.project(H,q);z.x=(ne.x*T-A)*p,z.y=(ne.y*T-I)*p};for(let z=0;z<f.length;z++)if(c.type!==1)f[z]=lt(f[z],F,1);else{const H=[];for(const q of f[z])q.x<0||q.x>=p||q.y<0||q.y>=p||(F(q),H.push(q));f[z]=H}}for(const y of f)for(const T of y)Gt(T,_);return f}function Ut(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?tr(c):[]}}class Bt{constructor(a,l,f,p,_){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=a,this._geometry=-1,this._keys=p,this._values=_,a.readFields(vr,this,l)}loadGeometry(){const a=this._pbf;a.pos=this._geometry;const l=a.readVarint()+a.pos,f=[];let p,_=1,y=0,T=0,A=0;for(;a.pos<l;){if(y<=0){const I=a.readVarint();_=7&I,y=I>>3}if(y--,_===1||_===2)T+=a.readSVarint(),A+=a.readSVarint(),_===1&&(p&&f.push(p),p=[]),p&&p.push(new Pt(T,A));else{if(_!==7)throw new Error(`unknown command ${_}`);p&&p.push(p[0].clone())}}return p&&f.push(p),f}bbox(){const a=this._pbf;a.pos=this._geometry;const l=a.readVarint()+a.pos;let f=1,p=0,_=0,y=0,T=1/0,A=-1/0,I=1/0,D=-1/0;for(;a.pos<l;){if(p<=0){const F=a.readVarint();f=7&F,p=F>>3}if(p--,f===1||f===2)_+=a.readSVarint(),y+=a.readSVarint(),_<T&&(T=_),_>A&&(A=_),y<I&&(I=y),y>D&&(D=y);else if(f!==7)throw new Error(`unknown command ${f}`)}return[T,I,A,D]}toGeoJSON(a,l,f){const p=this.extent*Math.pow(2,f),_=this.extent*a,y=this.extent*l,T=this.loadGeometry();function A(z){return[360*(z.x+_)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(z.y+y)/p)*Math.PI))-90]}function I(z){return z.map(A)}let D;if(this.type===1){const z=[];for(const q of T)z.push(q[0]);const H=I(z);D=z.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const z=T.map(I);D=z.length===1?{type:"LineString",coordinates:z[0]}:{type:"MultiLineString",coordinates:z}}else{if(this.type!==3)throw new Error("unknown feature type");{const z=function(q){const ne=q.length;if(ne<=1)return[q];const ie=[];let ae,me;for(let ye=0;ye<ne;ye++){const we=mr(q[ye]);we!==0&&(me===void 0&&(me=we<0),me===we<0?(ae&&ie.push(ae),ae=[q[ye]]):ae&&ae.push(q[ye]))}return ae&&ie.push(ae),ie}(T),H=[];for(const q of z)H.push(q.map(I));D=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const F={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(F.id=this.id),F}}function vr(c,a,l){c===1?a.id=l.readVarint():c===2?function(f,p){const _=f.readVarint()+f.pos;for(;f.pos<_;){const y=p._keys[f.readVarint()],T=p._values[f.readVarint()];p.properties[y]=T}}(l,a):c===3?a.type=l.readVarint():c===4&&(a._geometry=l.pos)}function mr(c){let a=0;for(let l,f,p=0,_=c.length,y=_-1;p<_;y=p++)l=c[p],f=c[y],a+=(f.x-l.x)*(l.y+f.y);return a}Bt.types=["Unknown","Point","LineString","Polygon"];class _r{constructor(a,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(pr,this,l),this.length=this._features.length}feature(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];const l=this._pbf.readVarint()+this._pbf.pos;return new Bt(this._pbf,l,this.extent,this._keys,this._values)}}function pr(c,a,l){c===15?a.version=l.readVarint():c===1?a.name=l.readString():c===5?a.extent=l.readVarint():c===2?a._features.push(l.pos):c===3?a._keys.push(l.readString()):c===4&&a._values.push(function(f){let p=null;const _=f.readVarint()+f.pos;for(;f.pos<_;){const y=f.readVarint()>>3;p=y===1?f.readString():y===2?f.readFloat():y===3?f.readDouble():y===4?f.readVarint64():y===5?f.readVarint():y===6?f.readSVarint():y===7?f.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p}(l))}class zr{constructor(a,l){this.layers=a.readFields(qr,{},l)}}function qr(c,a,l){if(c===3){const f=new _r(l,l.readVarint()+l.pos);f.length&&(a[f.name]=f)}}const Jr="3d_elevation_id",Rn="level";class $r{constructor(){this._valid=!1}reset(a){return this.feature=a,this._valid=!0,this._geometry=a.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(a,l){return this._valid&&a(l(this._geometry)),this}require(a,l,f){return this.get(a,!0,l,f)}optional(a,l,f){return this.get(a,!1,l,f)}success(){return this._valid}get(a,l,f,p){const _=this.feature.properties.hasOwnProperty(a)?+this.feature.properties[a]:void 0;return this._valid&&_!==void 0&&!Number.isNaN(_)?f(p?p(_):_):l&&(this._valid=!1),this}}class vn{constructor(a,l){this.featureFunc=a,this.vertexFunc=l}parseFeature(a,l,f){return this.featureFunc(a,l,f)}parseVertex(a,l,f){return this.vertexFunc(a,l,f)}}const In=new vn((c,a,l)=>c.reset(a).require(Jr,f=>{l.id=f}).optional("fixed_height_relative",f=>{l.constantHeight=f},Xr.decodeRelativeHeight).geometry(f=>{l.bounds=f},cg).success(),(c,a,l)=>c.reset(a).require(Jr,f=>{l.id=f}).require("elevation_idx",f=>{l.idx=f}).require("extent",f=>{l.extent=f}).require("height_relative",f=>{l.height=f},Xr.decodeRelativeHeight).geometry(f=>{l.position=f},Xr.getPoint).success()),ui=new vn((c,a,l)=>c.reset(a).require(Jr,f=>{l.id=f}).optional("fixed_height",f=>{l.constantHeight=f},Xr.decodeMetricHeight).geometry(f=>{l.bounds=f},cg).success(),(c,a,l)=>c.reset(a).require(Jr,f=>{l.id=f}).require("elevation_idx",f=>{l.idx=f}).require("extent",f=>{l.extent=f}).require("height",f=>{l.height=f},Xr.decodeMetricHeight).geometry(f=>{l.position=f},Xr.getPoint).success());class Xr{static getPoint(a){return Gi(a[0][0].x,a[0][0].y)}static decodeRelativeHeight(a){return 1e-4*a*5}static decodeMetricHeight(a){return 1e-4*a}static getVersionSchema(a){return a?a==="1.0.1"?ui:void 0:In}static parse(a){const l=[],f=[],p=a.length,_=new $r;for(let y=0;y<p;y++){const T=a.feature(y),A=T.properties.version,I=Xr.getVersionSchema(A);if(I===void 0){nr(`Unknown elevation feature version number ${A||"(unknown)"}`);continue}const D=T.properties.type;if(!D)continue;const F=Bt.types[T.type];if(F==="Point"&&D==="curve_point"){const z={};I.parseVertex(_,T,z)&&l.push(z)}else if(F==="Polygon"&&D==="curve_meta"){const z={};I.parseFeature(_,T,z)&&f.push(z)}}return{vertices:l,features:f}}}class Tn{constructor(a,l){this.pos=a,this.dir=l}intersectsPlane(a,l,f){const p=ia(l,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((a[0]-this.pos[0])*l[0]+(a[1]-this.pos[1])*l[1])/p;return f[0]=this.pos[0]+this.dir[0]*_,f[1]=this.pos[1]+this.dir[1]*_,!0}}class wn{constructor(a,l){this.pos=a,this.dir=l}intersectsPlane(a,l,f){const p=Dt(l,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((a[0]-this.pos[0])*l[0]+(a[1]-this.pos[1])*l[1]+(a[2]-this.pos[2])*l[2])/p;return f[0]=this.pos[0]+this.dir[0]*_,f[1]=this.pos[1]+this.dir[1]*_,f[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(a,l,f){if(function(H,q){var ne=H[0],ie=H[1],ae=H[2],me=q[0],ye=q[1],we=q[2];return Math.abs(ne-me)<=v*Math.max(1,Math.abs(ne),Math.abs(me))&&Math.abs(ie-ye)<=v*Math.max(1,Math.abs(ie),Math.abs(ye))&&Math.abs(ae-we)<=v*Math.max(1,Math.abs(ae),Math.abs(we))}(this.pos,a)||l===0)return f[0]=f[1]=f[2]=0,!1;const[p,_,y]=this.dir,T=this.pos[0]-a[0],A=this.pos[1]-a[1],I=this.pos[2]-a[2],D=p*p+_*_+y*y,F=2*(T*p+A*_+I*y),z=F*F-4*D*(T*T+A*A+I*I-l*l);if(z<0){const H=Math.max(-F/2,0),q=T+p*H,ne=A+_*H,ie=I+y*H,ae=Math.hypot(q,ne,ie);return f[0]=q*l/ae,f[1]=ne*l/ae,f[2]=ie*l/ae,!1}{const H=(-F-Math.sqrt(z))/(2*D);if(H<0){const q=Math.hypot(T,A,I);return f[0]=T*l/q,f[1]=A*l/q,f[2]=I*l/q,!1}return f[0]=T+p*H,f[1]=A+_*H,f[2]=I+y*H,!0}}}class Cn{constructor(a,l,f,p,_){this.TL=a,this.TR=l,this.BR=f,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(a,l,f){const p=[-1,1,1],_=[1,1,1],y=[1,-1,1],T=[-1,-1,1],A=Mt(p,p,a),I=Mt(_,_,a),D=Mt(y,y,a),F=Mt(T,T,a);return new Cn(A,I,D,F,l/f)}}function di(c,a,l){let f=1/0,p=-1/0;const _=[];for(const y of c){Br(_,y,a);const T=Dt(_,l);f=Math.min(f,T),p=Math.max(p,T)}return[f,p]}function Ui(c,a){let l=!0;for(let f=0;f<c.planes.length;f++){const p=c.planes[f];let _=0;for(let y=0;y<a.length;y++)_+=+(Dt(p,a[y])+p[3]>=0);if(_===0)return 0;_!==a.length&&(l=!1)}return l?2:1}function La(c,a){for(const l of c.projections){const f=di(a,c.points[0],l.axis);if(l.projection[1]<f[0]||l.projection[0]>f[1])return 0}return 1}function pi(c,a){let l=0;const f=[0,0,0,0];for(let y=0;y<c.length;y++)f[0]=c[y][0],f[1]=c[y][1],f[2]=c[y][2],f[3]=1,(p=f)[0]*(_=a)[0]+p[1]*_[1]+p[2]*_[2]+p[3]*_[3]>=0&&l++;var p,_;return l}class Qr{constructor(a,l){this.points=a||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=Rr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Br([],this.points[2],this.points[3]),Br([],this.points[0],this.points[3]),Br([],this.points[4],this.points[0]),Br([],this.points[5],this.points[1]),Br([],this.points[6],this.points[2]),Br([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const p=[0,-f[2],f[1]],_=[f[2],0,-f[0]];this.projections.push({axis:p,projection:di(this.points,this.points[0],p)}),this.projections.push({axis:_,projection:di(this.points,this.points[0],_)})}}static fromInvProjectionMatrix(a,l,f,p){const _=Math.pow(2,f),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const D=Yn([],I,a),F=1/D[3]/l*_;return(z=D)[0]=(H=D)[0]*(q=[F,F,p?1/D[3]:F,F])[0],z[1]=H[1]*q[1],z[2]=H[2]*q[2],z[3]=H[3]*q[3],z;var z,H,q}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const D=yt([],Yt([],Br([],y[I[0]],y[I[1]]),Br([],y[I[2]],y[I[1]]))),F=-Dt(D,y[I[1]]);return D.concat(F)}),A=[];for(let I=0;I<y.length;I++)A.push([y[I][0],y[I][1],y[I][2]]);return new Qr(A,T)}intersectsPrecise(a,l,f){for(let p=0;p<l.length;p++)if(!pi(a,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!pi(a,this.planes[p]))return 0;for(const p of f)for(const _ of this.frustumEdges){const y=Yt([],p,_),T=tt(y);if(T===0)continue;Rt(y,y,1/T);const A=di(this.points,this.points[0],y),I=di(a,this.points[0],y);if(A[0]>I[1]||I[0]>A[1])return 0}return 1}containsPoint(a){for(const l of this.planes){const f=l[3];if(Dt([l[0],l[1],l[2]],a)+f<0)return!1}return!0}}class Rr{static fromPoints(a){const l=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const p of a)Ue(l,l,p),It(f,f,p);return new Rr(l,f)}static fromTileIdAndHeight(a,l,f){const p=1<<a.canonical.z,_=a.canonical.x,y=a.canonical.y;return new Rr([_/p,y/p,l],[(_+1)/p,(y+1)/p,f])}static applyTransform(a,l){const f=a.getCorners();for(let p=0;p<f.length;++p)Mt(f[p],f[p],l);return Rr.fromPoints(f)}static applyTransformFast(a,l){const f=[l[12],l[13],l[14]],p=[...f];for(let _=0;_<3;_++)for(let y=0;y<3;y++){const T=l[4*y+_],A=T*a.min[y],I=T*a.max[y];f[_]+=Math.min(A,I),p[_]+=Math.max(A,I)}return new Rr(f,p)}static projectAabbCorners(a,l){const f=a.getCorners();for(let p=0;p<f.length;++p)Mt(f[p],f[p],l);return f}constructor(a,l){this.min=a,this.max=l,this.center=Rt([],at([],this.min,this.max),.5)}quadrant(a){const l=[a%2==0,a<2],f=ke(this.min),p=ke(this.max);for(let _=0;_<l.length;_++)f[_]=l[_]?this.min[_]:this.center[_],p[_]=l[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new Rr(f,p)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,l=this.max;return[[a[0],a[1],a[2]],[l[0],a[1],a[2]],[l[0],l[1],a[2]],[a[0],l[1],a[2]],[a[0],a[1],l[2]],[l[0],a[1],l[2]],[l[0],l[1],l[2]],[a[0],l[1],l[2]]]}intersects(a){return this.intersectsAabb(a.bounds)?Ui(a,this.getCorners()):0}intersectsFlat(a){return this.intersectsAabb(a.bounds)?Ui(a,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(a,l){return l||this.intersects(a)?La(a,this.getCorners()):0}intersectsPreciseFlat(a,l){return l||this.intersectsFlat(a)?La(a,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(a){for(let l=0;l<3;++l)if(this.min[l]>a.max[l]||a.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(a){return!(this.min[0]>a.max[0]||a.min[0]>this.max[0]||this.min[1]>a.max[1]||a.min[1]>this.max[1])}encapsulate(a){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],a.min[l]),this.max[l]=Math.max(this.max[l],a.max[l])}encapsulatePoint(a){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],a[l]),this.max[l]=Math.max(this.max[l],a[l])}closestPoint(a){return[Math.max(Math.min(this.max[0],a[0]),this.min[0]),Math.max(Math.min(this.max[1],a[1]),this.min[1]),Math.max(Math.min(this.max[2],a[2]),this.min[2])]}}sr(Rr,"Aabb");class Dn{constructor(a,l){this.feature=a,this.metersToTile=l,this.index=0}get(){const a=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,f=l[1],p=-l[0],_=(a.extent+1)*this.metersToTile;return[new Pt(Math.trunc(a.position[0]+f*_),Math.trunc(a.position[1]+p*_)),new Pt(Math.trunc(a.position[0]-f*_),Math.trunc(a.position[1]-p*_))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class ki{constructor(a,l,f,p,_,y){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Nn(),Nn(),Nn(),Nn(),Nn(),Nn(),Nn()],this.id=a,this.heightRange={min:f,max:f},this.safeArea=l,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=_,this.edges=this.edges.filter(T=>{return T.a<this.vertices.length&&T.b<this.vertices.length&&!((A=this.vertices[T.a].position)[0]===(I=this.vertices[T.b].position)[0]&&A[1]===I[1]);var A,I}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const T of this.vertices)this.vertexProps.push({dir:Gi(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,T.height),this.heightRange.max=Math.max(this.heightRange.max,T.height);for(const T of this.edges){const A=this.vertices[T.a].position,I=this.vertices[T.b].position,D=Bo(Nn(),I,A),F=xl(D),z=uo(Nn(),D,1/F);this.edgeProps.push({vec:D,dir:z,len:F});const H=this.vertexProps[T.a].dir,q=this.vertexProps[T.b].dir;ba(H,H,z),ba(q,q,z)}for(const T of this.vertexProps)T.dir[0]===0&&T.dir[1]===0||ti(T.dir,T.dir);this.tessellate(y)}}pointElevation(a){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(a);if(l==null)return 0;const[f,p]=l;return Ir(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,p)}computeSlopeNormal(a,l){const f=this.getClosestEdge(a);if(!f)return Je(0,0,1);const p=f[0],_=this.edges[p],y=this.edgeProps[p].vec,T=Je(y[0],y[1],(this.vertices[_.b].height-this.vertices[_.a].height)*l),A=Je(T[1],-T[0],0);Yt(A,A,T);const I=tt(A);return I>0?Rt(A,A,1/I):et(A,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(a){if(this.edges.length===0)return;let l=0,f=Number.POSITIVE_INFINITY,p=0;const[_,y,T,A,I,D,F]=this._tmpVec2;ji(F,a.x,a.y);const z=new Tn(F,null);for(let H=0;H<this.edges.length;H++){const q=this.edges[H],ne=this.edgeProps[H].dir;z.dir=ne;const ie=this.vertices[q.a].position,ae=this.vertices[q.b].position,me=z.intersectsPlane(ie,this.vertexProps[q.a].dir,_),ye=z.intersectsPlane(ae,this.vertexProps[q.b].dir,y);if(!me||!ye)continue;Bo(T,y,_),Bo(A,F,_);const we=ia(T,T),Be=we>0?ia(A,T)/we:0,ze=Q(Be,0,1),Ve=Math.abs((Be-ze)*this.edgeProps[H].len);Bo(I,F,ie),ji(D,ne[1],-ne[0]);const Ze=Ve+Math.abs(ia(I,D));Ze<f&&(l=H,f=Ze,p=ze)}return[l,p]}tessellate(a){const l=Ie(),f=Ie(),p=Ie(),_=Ie();for(let y=this.edges.length-1;y>=0;--y){const T=this.edges[y].a,A=this.edges[y].b,{position:I,height:D,extent:F}=this.vertices[T],{position:z,height:H,extent:q}=this.vertices[A],ne=this.vertexProps[T].dir,ie=this.vertexProps[A].dir;if(et(l,I[0]/a,I[1]/a,D),et(f,z[0]/a,z[1]/a,H),et(p,ne[1],-ne[0],0),Rt(p,p,F),et(_,ie[1],-ie[0],0),Rt(_,_,q),this.distSqLines(Je(l[0]+.5*p[0],l[1]+.5*p[1],l[2]+.5*p[2]),Je(f[0]-.5*_[0],f[1]-.5*_[1],f[2]-.5*_[2]),Je(l[0]-.5*p[0],l[1]-.5*p[1],l[2]-.5*p[2]),Je(f[0]+.5*_[0],f[1]+.5*_[1],f[2]+.5*_[2]))<=.0025000000000000005)continue;const ae=this.vertices.length,me=ba(Nn(),I,z);this.vertices.push({position:uo(me,me,.5),height:.5*(D+H),extent:.5*(F+q)});const ye=ba(Nn(),ne,ie);this.vertexProps.push({dir:ti(ye,ye)}),this.edges.splice(y,1),this.edgeProps.splice(y,1),this.edges.push({a:T,b:ae}),this.edges.push({a:ae,b:A});const we=Bo(Nn(),this.vertices[ae].position,I),Be=xl(we),ze={vec:we,dir:uo(Nn(),we,1/Be),len:Be};this.edgeProps.push(ze),this.edgeProps.push(ze)}}distSqLines(a,l,f,p){const _=pt(Ie(),l,a),y=pt(Ie(),p,f),T=pt(Ie(),a,f),A=Dt(_,_),I=Dt(_,y),D=Dt(_,T),F=Dt(y,y),z=Dt(y,T),H=A*F-I*I;if(H===0)return Ge(St(_,f,p,Dt(T,y)/Dt(y,y)),a);const q=(A*z-I*D)/H;return Ge(St(_,a,l,(I*z-D*F)/H),St(y,f,p,q))}}class vi{static parseFrom(a,l){const f=Xr.parse(a);if(!f)return[];let{vertices:p,features:_}=f;const y=1/st(l);_.sort((D,F)=>D.id-F.id),p.sort((D,F)=>D.id-F.id||D.idx-F.idx),p=p.filter((D,F,z)=>F===z.findIndex(H=>H.id===D.id&&H.idx===D.idx));const T=new Array;let A=0;const I=p.length;for(const D of _){if(D.constantHeight){T.push(new ki(D.id,D.bounds,D.constantHeight));continue}for(;A!==I&&p[A].id<D.id;)A++;if(A===I||p[A].id!==D.id)continue;const F=new Array,z=new Array,H=A;for(;A!==I&&p[A].id===D.id;){const q=p[A];if(F.push({position:q.position,height:q.height,extent:q.extent}),A!==H&&p[A-1].idx===q.idx-1){const ne=A-H;z.push({a:ne-1,b:ne})}A++}T.push(new ki(D.id,D.bounds,void 0,F,z,y))}return T}static getElevationFeature(a,l){if(!l)return;const f=+a.properties[Jr];return Number.isNaN(f)?void 0:l.find(p=>p.id===f)}}class oa{constructor(a,l){this.zScale=1,this.xOffset=0,this.yOffset=0,a.equals(l)||(this.zScale=Math.pow(2,l.z-a.z),this.xOffset=(a.x*this.zScale-l.x)*Zt,this.yOffset=(a.y*this.zScale-l.y)*Zt)}constantElevation(a,l){if(a.constantHeight!=null)return this.computeBiasedHeight(a.constantHeight,l)}pointElevation(a,l,f){const p=this.constantElevation(l,f);return p??(a.x=a.x*this.zScale+this.xOffset,a.y=a.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(a),f))}computeBiasedHeight(a,l){return l<=0?a:a+l*pe(0,l,a>=0?a:Math.abs(.5*a))}}sr(ki,"ElevationFeature");class qa{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new Hu,this.indexArray=new Ta,this.segments=new Ti,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new qu),this.worldview=a.worldview}updateFootprints(a,l){}populate(a,l,f,p){const _=this.layers[0],y=[];let T=null;_.type==="circle"&&(T=_.layout.get("circle-sort-key"));for(const{feature:I,id:D,index:F,sourceLayerIndex:z}of a){const H=this.layers[0]._featureFilter.needGeometry,q=Ut(I,H);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),q,f))continue;const ne=T?T.evaluate(q,{},f):void 0,ie={id:D,properties:I.properties,type:I.type,sourceLayerIndex:z,index:F,geometry:H?q.geometry:tr(I,f,p),patterns:{},sortKey:ne};y.push(ie)}T&&y.sort((I,D)=>I.sortKey-D.sortKey);let A=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Xg,A=p.projection);for(const I of y){const{geometry:D,index:F,sourceLayerIndex:z}=I,H=a[F].feature;this.addFeature(I,D,F,l.availableImages,f,A,l.brightness,l.elevationFeatures),l.featureIndex.insert(H,D,F,z,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(a,l,f,p,_,y,T){this.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,HI.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,XI.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=a.createVertexBuffer(this.elevatedLayoutVertexArray,qI.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(a,l,f,p,_,y,T,A){let I;this.elevationMode!=="none"&&(I=vi.getElevationFeature(a,A));for(const D of l)for(const F of D){const z=F.x,H=F.y;if(z<0||z>=Zt||H<0||H>=Zt)continue;if(y){const ie=y.projectTilePoint(z,H,_),ae=y.upVector(_,z,H);this.addGlobeExtVertex(ie,ae),this.addGlobeExtVertex(ie,ae),this.addGlobeExtVertex(ie,ae),this.addGlobeExtVertex(ie,ae)}const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),ne=q.vertexLength;if(this.addCircleVertex(z,H,-1,-1),this.addCircleVertex(z,H,1,-1),this.addCircleVertex(z,H,1,1),this.addCircleVertex(z,H,-1,1),this.elevationMode!=="none"){const ie=I?I.pointElevation(new Pt(z,H)):0;this.hasElevation=this.hasElevation||ie!==0;for(let ae=0;ae<4;ae++)this.elevatedLayoutVertexArray.emplaceBack(ie)}this.indexArray.emplaceBack(ne,ne+1,ne+2),this.indexArray.emplaceBack(ne,ne+2,ne+3),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},p,_,T,void 0,this.worldview)}addCircleVertex(a,l,f,p){this.layoutVertexArray.emplaceBack(2*a+(f+1)/2,2*l+(p+1)/2)}addGlobeExtVertex(a,l){this.globeExtVertexArray.emplaceBack(a.x,a.y,a.z,l[0]*16384,l[1]*16384,l[2]*16384)}}function Ws(c,a){for(let l=0;l<c.length;l++)if(Na(a,c[l]))return!0;for(let l=0;l<a.length;l++)if(Na(c,a[l]))return!0;return!!Vo(c,a)}function Gs(c,a,l){return!!Na(c,a)||!!$i(a,c,l)}function ps(c,a){if(c.length===1)return ga(a,c[0]);for(let l=0;l<a.length;l++){const f=a[l];for(let p=0;p<f.length;p++)if(Na(c,f[p]))return!0}for(let l=0;l<c.length;l++)if(ga(a,c[l]))return!0;for(let l=0;l<a.length;l++)if(Vo(c,a[l]))return!0;return!1}function ms(c,a,l){if(c.length>1){if(Vo(c,a))return!0;for(let f=0;f<a.length;f++)if($i(a[f],c,l))return!0}for(let f=0;f<c.length;f++)if($i(c[f],a,l))return!0;return!1}function Vo(c,a){if(c.length===0||a.length===0)return!1;for(let l=0;l<c.length-1;l++){const f=c[l],p=c[l+1];for(let _=0;_<a.length-1;_++)if(ol(f,p,a[_],a[_+1]))return!0}return!1}function ol(c,a,l,f){return ur(c,l,f)!==ur(a,l,f)&&ur(c,a,l)!==ur(c,a,f)}function Ml(c,a,l){return(c.x-l.x)*(a.y-l.y)-(c.y-l.y)*(a.x-l.x)}function Fi(c,a,l,f){const p=Ml(c,a,f),_=Ml(c,a,l);if(Math.sign(p)===Math.sign(_))return;const y=Ml(l,f,c),T=y+_-p;return Math.sign(y)!==Math.sign(T)?[y/(y-T),_/(_-p)]:void 0}function $i(c,a,l){const f=l*l;if(a.length===1)return c.distSqr(a[0])<f;for(let p=1;p<a.length;p++)if(xi(c,a[p-1],a[p])<f)return!0;return!1}function xi(c,a,l){const f=a.distSqr(l);if(f===0)return c.distSqr(a);const p=((c.x-a.x)*(l.x-a.x)+(c.y-a.y)*(l.y-a.y))/f;return c.distSqr(p<0?a:p>1?l:l.sub(a)._mult(p)._add(a))}function ga(c,a){let l,f,p,_=!1;for(let y=0;y<c.length;y++){l=c[y];for(let T=0,A=l.length-1;T<l.length;A=T++)f=l[T],p=l[A],f.y>a.y!=p.y>a.y&&a.x<(p.x-f.x)*(a.y-f.y)/(p.y-f.y)+f.x&&(_=!_)}return _}function Na(c,a){let l=!1;for(let f=0,p=c.length-1;f<c.length;p=f++){const _=c[f],y=c[p];_.y>a.y!=y.y>a.y&&a.x<(y.x-_.x)*(a.y-_.y)/(y.y-_.y)+_.x&&(l=!l)}return l}function qi(c,a,l,f,p){for(const y of c)if(a<=y.x&&l<=y.y&&f>=y.x&&p>=y.y)return!0;const _=[new Pt(a,l),new Pt(a,p),new Pt(f,p),new Pt(f,l)];if(c.length>2){for(const y of _)if(Na(c,y))return!0}for(let y=0;y<c.length-1;y++)if(ho(c[y],c[y+1],_))return!0;return!1}function ho(c,a,l){const f=l[0],p=l[2];if(c.x<f.x&&a.x<f.x||c.x>p.x&&a.x>p.x||c.y<f.y&&a.y<f.y||c.y>p.y&&a.y>p.y)return!1;const _=ur(c,a,l[0]);return _!==ur(c,a,l[1])||_!==ur(c,a,l[2])||_!==ur(c,a,l[3])}function lc(c,a,l,f,p,_){let y=a.y-c.y,T=c.x-a.x;if(_=_||0){const A=y*y+T*T;if(A===0)return!0;const I=Math.sqrt(A);y/=I,T/=I}return!((l.x-c.x)*y+(l.y-c.y)*T-_<0||(f.x-c.x)*y+(f.y-c.y)*T-_<0||(p.x-c.x)*y+(p.y-c.y)*T-_<0)}function qc(c,a,l,f,p,_,y){return!(lc(c,a,f,p,_,y)||lc(a,l,f,p,_,y)||lc(l,c,f,p,_,y)||lc(f,p,c,a,l,y)||lc(p,_,c,a,l,y)||lc(_,f,c,a,l,y))}function Rl(c,a,l){const f=a.paint.get(c).value;return f.kind==="constant"?f.value:l.programConfigurations.get(a.id).getMaxValue(c)}function Yu(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ku(c,a,l,f,p){if(!a[0]&&!a[1])return c;const _=Pt.convert(a)._mult(p);l==="viewport"&&_._rotate(-f);const y=[];for(let T=0;T<c.length;T++)y.push(c[T].sub(_));return y}function cc(c,a,l,f){const p=Pt.convert(c)._mult(f);return a==="viewport"&&p._rotate(-l),p}let Ed,Xc;function uc(c,a,l){var f=2*Math.PI*6378137/256/Math.pow(2,l);return[c*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}sr(qa,"CircleBucket",{omit:["layers"]});class Zc{constructor(a,l,f){this.z=a,this.x=l,this.y=f,this.key=i_(0,a,a,l,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}isChildOf(a){const l=this.z-a.z;return a.z===0||a.z<this.z&&a.x===this.x>>l&&a.y===this.y>>l}url(a,l){const f=function(_,y,T){var A=uc(256*_,256*(y=Math.pow(2,T)-y-1),T),I=uc(256*(_+1),256*(y+1),T);return A[0]+","+A[1]+","+I[0]+","+I[1]}(this.x,this.y,this.z),p=function(_,y,T){let A,I="";for(let D=_;D>0;D--)A=1<<D-1,I+=(y&A?1:0)+(T&A?2:0);return I}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class n_{constructor(a,l){this.wrap=a,this.canonical=l,this.key=i_(a,l.z,l.z,l.x,l.y)}}class Wo{constructor(a,l,f,p,_){this.overscaledZ=a,this.wrap=l,this.canonical=new Zc(f,+p,+_),this.key=l===0&&a===f?this.canonical.key:i_(l,a,f,p,_)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const l=this.canonical.z-a;return a>this.canonical.z?new Wo(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wo(a,this.wrap,a,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(a,l=!0){if(this.overscaledZ===a&&l)return this.key;if(a>this.canonical.z)return i_(this.wrap*+l,a,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-a;return i_(this.wrap*+l,a,a,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const l=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.z<this.canonical.z&&a.canonical.x===this.canonical.x>>l&&a.canonical.y===this.canonical.y>>l}children(a){if(this.overscaledZ>=a)return[new Wo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,f=2*this.canonical.x,p=2*this.canonical.y;return[new Wo(l,this.wrap,l,f,p),new Wo(l,this.wrap,l,f+1,p),new Wo(l,this.wrap,l,f,p+1),new Wo(l,this.wrap,l,f+1,p+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Wo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Wo(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new n_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function i_(c,a,l,f,p){const _=1<<Math.min(l,22);let y=_*(p%_)+f%_;return c&&l<22&&(y+=_*_*((c<0?-2*c-1:2*c)%(1<<2*(22-l)))),16*(32*y+l)+(a-l)}const cte=[c=>{let a=c.canonical.x-1,l=c.wrap;return a<0&&(a=(1<<c.canonical.z)-1,l--),new Wo(c.overscaledZ,l,c.canonical.z,a,c.canonical.y)},c=>{let a=c.canonical.x+1,l=c.wrap;return a===1<<c.canonical.z&&(a=0,l++),new Wo(c.overscaledZ,l,c.canonical.z,a,c.canonical.y)},c=>new Wo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Wo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];sr(Zc,"CanonicalTileID"),sr(Wo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ute=fn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:PT}=ute,hte=fn([{name:"a_pos_3",components:3,type:"Int16"}]);var EN=fn([{name:"a_pos",type:"Int16",components:2}]);function IT(c){return c*m/Y}const fte=[new Rr([B,B,B],[j,j,j]),new Rr([B,B,B],[0,0,j]),new Rr([0,B,B],[j,0,j]),new Rr([B,0,B],[0,j,j]),new Rr([0,0,B],[j,j,j])];function AN(c,a,l,f=!0){const p=Rt([],c._camera.position,c.worldSize),_=[a,l,1,1];Yn(_,_,c.pixelMatrixInverse),Un(_,_,1/_[3]);const y=yt([],Br([],_,p)),T=c.globeMatrix,A=[T[12],T[13],T[14]],I=Br([],A,p),D=tt(I),F=yt([],I),z=c.worldSize/(2*Math.PI),H=Dt(F,y),q=Math.asin(z/D);if(q<Math.acos(H)){if(!f)return null;const Ct=[],nt=[];Rt(Ct,y,D/H),yt(nt,Br(nt,Ct,I)),yt(y,at(y,I,Rt(y,nt,Math.tan(q)*D)))}const ne=[];new wn(p,y).closestPointOnSphere(A,z,ne);const ie=yt([],li(T,0)),ae=yt([],li(T,1)),me=yt([],li(T,2)),ye=Dt(ie,ne),we=Dt(ae,ne),Be=Dt(me,ne),ze=se(Math.asin(-we/z));let Ve=se(Math.atan2(ye,Be));Ve=c.center.lng+function(Ct,nt){const kt=(nt-Ct+180)%360-180;return kt<-180?kt+360:kt}(c.center.lng,Ve);const Ze=Ee(Ve),Ye=Q(De(ze),0,1);return new _t(Ze,Ye)}class dte{constructor(a,l,f){this.a=Br([],a,f),this.b=Br([],l,f),this.center=f;const p=yt([],this.a),_=yt([],this.b);this.angle=Math.acos(Dt(p,_))}}function ek(c,a){if(c.angle===0)return null;let l;return l=c.a[a]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),l<0||l>1?null:function(f,p,_,y){const T=Math.sin(_);return f*(Math.sin((1-y)*_)/T)+p*(Math.sin(y*_)/T)}(c.a[a],c.b[a],c.angle,Q(l,0,1))+c.center[a]}function Ju(c){if(c.z<=1)return fte[c.z+2*c.y+c.x];const a=tk(kT(c));return Rr.fromPoints(a)}function of(c,a,l){return Rt(c,c,1-l),_e(c,c,a,l)}function CN(c,a,l){for(const f of c)Mt(f,f,a),Rt(f,f,l)}function PN(c,a,l,f){const p=a/c.worldSize,_=c.globeMatrix;if(l.z<=1){const Ye=Ju(l).getCorners();return CN(Ye,_,p),Rr.fromPoints(Ye)}const y=kT(l,f),T=tk(y,m+IT(c._tileCoverLift));CN(T,_,p);const A=Number.MAX_VALUE,I=[-A,-A,-A],D=[A,A,A];if(y.contains(c.center)){for(const nt of T)Ue(D,D,nt),It(I,I,nt);I[2]=0;const Ye=c.point,Ct=[Ye.x*p,Ye.y*p,0];return Ue(D,D,Ct),It(I,I,Ct),new Rr(D,I)}if(c._tileCoverLift>0){for(const Ye of T)Ue(D,D,Ye),It(I,I,Ye);return new Rr(D,I)}const F=[_[12]*p,_[13]*p,_[14]*p],z=y.getCenter(),H=Q(c.center.lat,-Le,Le),q=Q(z.lat,-Le,Le),ne=Ee(c.center.lng),ie=De(H);let ae=ne-Ee(z.lng);const me=ie-De(q);ae>.5?ae-=1:ae<-.5&&(ae+=1);let ye=0;Math.abs(ae)>Math.abs(me)?ye=ae>=0?1:3:(ye=me>=0?0:2,_e(F,F,[_[4]*p,_[5]*p,_[6]*p],-Math.sin(Qe(me>=0?y.getSouth():y.getNorth()))*m));const we=T[ye],Be=T[(ye+1)%4],ze=new dte(we,Be,F),Ve=[ek(ze,0)||we[0],ek(ze,1)||we[1],ek(ze,2)||we[2]],Ze=Ad(c.zoom);if(Ze>0){const Ye=function({x:nt,y:kt,z:zt},Ot,Lt,$t,Et){const Nt=1/(1<<zt);let gt=nt*Nt,ut=gt+Nt,Vt=kt*Nt,jt=Vt+Nt,br=0;const ir=(gt+ut)/2-$t;return ir>.5?br=-1:ir<-.5&&(br=1),gt=((gt+br)*Ot-($t*=Ot))*Lt+$t,ut=((ut+br)*Ot-$t)*Lt+$t,Vt=(Vt*Ot-(Et*=Ot))*Lt+Et,jt=(jt*Ot-Et)*Lt+Et,[[gt,jt,0],[ut,jt,0],[ut,Vt,0],[gt,Vt,0]]}(l,a,c._pixelsPerMercatorPixel,ne,ie);for(let nt=0;nt<T.length;nt++)of(T[nt],Ye[nt],Ze);const Ct=at([],Ye[ye],Ye[(ye+1)%4]);Rt(Ct,Ct,.5),of(Ve,Ct,Ze)}for(const Ye of T)Ue(D,D,Ye),It(I,I,Ye);return D[2]=Math.min(we[2],Be[2]),Ue(D,D,Ve),It(I,I,Ve),new Rr(D,I)}function kT({x:c,y:a,z:l},f=!1){const p=1/(1<<l),_=new te(Fe(c*p),a===(1<<l)-1&&f?-90:Re((a+1)*p)),y=new te(Fe((c+1)*p),a===0&&f?90:Re(a*p));return new ce(_,y)}function tk(c,a=m){const l=Qe(c.getNorth()),f=Qe(c.getSouth()),p=Math.cos(l),_=Math.cos(f),y=Math.sin(l),T=Math.sin(f),A=c.getWest(),I=c.getEast();return[X(_,T,A,a),X(_,T,I,a),X(p,y,I,a),X(p,y,A,a)]}function Vx(c,a,l,f){const p=1<<l.z,_=(c/Zt+l.x)/p;return W(Re((a/Zt+l.y)/p),Fe(_),f)}function OT({min:c,max:a}){return E/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const IN=new Float64Array(16);function MT(c){const a=OT(c),l=re(IN,[a,a,a]);return G(l,l,Xe([],c.min))}function rk(c){const a=(f=c.min,(l=IN)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=f[0],l[13]=f[1],l[14]=f[2],l[15]=1,l);var l,f;const p=1/OT(c);return U(a,a,[p,p,p])}function nk(c){const a=Zt/(2*Math.PI);return c/(2*Math.PI)/a}function kN(c,a){return Zt/(512*Math.pow(2,c))*OT(Ju(a))}function ON(c,a,l,f,p){const _=nk(l),y=[c,a,-l/(2*Math.PI)],T=R(new Float64Array(16));return G(T,T,y),U(T,T,[_,_,_]),J(T,T,Qe(-p)),Z(T,T,Qe(-f)),T}function Ad(c){return pe(x,b,c)}function MN(c,a){const l=W(a.lat,a.lng),f=function(q){const ne=W(q._center.lat,q._center.lng);let ie=Yt([],Je(0,1,0),ne);const ae=ge([],-q.angle,ne);ie=Mt(ie,ie,ae),ge(ae,-q._pitch,ie);const me=yt([],ne);return Rt(me,me,IT(q.cameraToCenterDistance/q.pixelsPerMeter)),Mt(me,me,ae),at([],ne,me)}(c);return y=(p=pt([],f,l))[0],T=p[1],A=p[2],I=(_=l)[0],D=_[1],F=_[2],H=(z=Math.sqrt((y*y+T*T+A*A)*(I*I+D*D+F*F)))&&Dt(p,_)/z,Math.acos(Math.min(Math.max(H,-1),1));var p,_,y,T,A,I,D,F,z,H}function ik(c,a){return MN(c,a)>Math.PI/2*1.01}const RN=Qe(85),pte=Math.cos(RN),mte=Math.sin(RN),gte=L(),DN=c=>{const a=[];return c.paint.get("circle-pitch-alignment")==="map"&&a.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&a.push("SCALE_WITH_MAP"),a};function FN(c,a,l,f,p,_,y,T,A){if(_&&c.queryGeometry.isAboveHorizon)return!1;_&&(A*=c.pixelToTileUnitsFactor);const I=c.tileID.canonical,D=l.projection.upVectorScale(I,l.center.lat,l.worldSize).metersToTile;for(const F of a)for(const z of F){const H=z.add(T),q=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(H.x,H.y,!0):0,ne=l.projection.projectTilePoint(H.x,H.y,I);if(q>0){const ye=l.projection.upVector(I,H.x,H.y);ne.x+=ye[0]*D*q,ne.y+=ye[1]*D*q,ne.z+=ye[2]*D*q}const ie=_?H:_te(ne.x,ne.y,ne.z,f),ae=_?c.tilespaceRays.map(ye=>vte(ye,q)):c.queryGeometry.screenGeometry,me=Yn([],[ne.x,ne.y,ne.z,1],f);if(!y&&_?A*=me[3]/l.cameraToCenterDistance:y&&!_&&(A*=l.cameraToCenterDistance/me[3]),_){const ye=Re((z.y/Zt+I.y)/(1<<I.z));A/=l.projection.pixelsPerMeter(ye,1)/Me(1,ye)}if(Gs(ae,ie,A))return!0}return!1}function _te(c,a,l,f){const p=Yn([],[c,a,l,1],f);return new Pt(p[0]/p[3],p[1]/p[3])}const LN=Je(0,0,0),yte=Je(0,0,1);function vte(c,a){const l=Ie();return LN[2]=a,c.intersectsPlane(LN,yte,l),new Pt(l[0],l[1])}class NN extends qa{}let BN,zN,jN,UN;function $N(c,{width:a,height:l},f,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==a*l*f)throw new RangeError("mismatched image size")}else p=new Uint8Array(a*l*f);return c.width=a,c.height=l,c.data=p,c}function VN(c,a,l){const{width:f,height:p}=a;f===c.width&&p===c.height||(ak(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,p)},l,null),c.width=f,c.height=p,c.data=a.data)}function ak(c,a,l,f,p,_,y,T){if(p.width===0||p.height===0)return a;if(p.width>c.width||p.height>c.height||l.x>c.width-p.width||l.y>c.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>a.width||p.height>a.height||f.x>a.width-p.width||f.y>a.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const A=c.data,I=a.data,D=_===4&&T;for(let F=0;F<p.height;F++){const z=((l.y+F)*c.width+l.x)*_,H=((f.y+F)*a.width+f.x)*_;if(D)for(let q=0;q<p.width;q++){const ne=z+q*_+3,ie=H+q*_;I[ie+0]=255,I[ie+1]=255,I[ie+2]=255,I[ie+3]=A[ne]}else if(y)for(let q=0;q<p.width;q++){const ne=z+q*_,ie=H+q*_,ae=new On(A[ne+0]/255,A[ne+1]/255,A[ne+2]/255,A[ne+3]).toNonPremultipliedRenderColor(y).toArray();I[ie+0]=ae[0],I[ie+1]=ae[1],I[ie+2]=ae[2],I[ie+3]=ae[3]}else for(let q=0;q<p.width*_;q++)I[H+q]=A[z+q]}return a}sr(NN,"HeatmapBucket",{omit:["layers"]});class Cd{constructor(a,l){$N(this,a,1,l)}resize(a){VN(this,new Cd(a),1)}clone(){return new Cd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,f,p,_){ak(a,l,f,p,_,1,null)}}class fo{constructor(a,l){$N(this,a,4,l)}resize(a){VN(this,new fo(a),4)}replace(a,l){l?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,f,p,_,y,T){ak(a,l,f,p,_,4,y,T)}}class WN{constructor(a,l){this.width=a.width,this.height=a.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function Wx(c){const a={},l=c.resolution||256,f=c.clips?c.clips.length:1,p=c.image||new fo({width:l,height:f}),_=(y,T,A)=>{a[c.evaluationKey]=A;const I=c.expression.evaluate(a),D=I?I.toNonPremultipliedRenderColor(null):null;D&&(p.data[y+T+0]=Math.floor(255*D.r),p.data[y+T+1]=Math.floor(255*D.g),p.data[y+T+2]=Math.floor(255*D.b),p.data[y+T+3]=Math.floor(255*D.a))};if(c.clips)for(let y=0,T=0;y<f;++y,T+=4*l)for(let A=0,I=0;A<l;A++,I+=4){const D=A/(l-1),{start:F,end:z}=c.clips[y];_(T,I,F*(1-D)+z*D)}else for(let y=0,T=0;y<l;y++,T+=4)_(0,T,y/(l-1));return p}sr(Cd,"AlphaImage"),sr(fo,"RGBAImage");const xte=fn([{name:"a_pos",components:2,type:"Int16"}],4),wte=fn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),bte=fn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),Tte=fn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function a_(c,a,l=2){const f=a&&a.length,p=f?a[0]*l:c.length;let _=GN(c,0,p,l,!0);const y=[];if(!_||_.next===_.prev)return y;let T,A,I;if(f&&(_=function(D,F,z,H){const q=[];for(let ne=0,ie=F.length;ne<ie;ne++){const ae=GN(D,F[ne]*H,ne<ie-1?F[ne+1]*H:D.length,H,!1);ae===ae.next&&(ae.steiner=!0),q.push(Ote(ae))}q.sort(Pte);for(let ne=0;ne<q.length;ne++)z=Ite(q[ne],z);return z}(c,a,_,l)),c.length>80*l){T=c[0],A=c[1];let D=T,F=A;for(let z=l;z<p;z+=l){const H=c[z],q=c[z+1];H<T&&(T=H),q<A&&(A=q),H>D&&(D=H),q>F&&(F=q)}I=Math.max(D-T,F-A),I=I!==0?32767/I:0}return Gx(_,y,l,T,A,I,0),y}function GN(c,a,l,f,p){let _;if(p===function(y,T,A,I){let D=0;for(let F=T,z=A-I;F<A;F+=I)D+=(y[z]-y[F])*(y[F+1]+y[z+1]),z=F;return D}(c,a,l,f)>0)for(let y=a;y<l;y+=f)_=ZN(y/f|0,c[y],c[y+1],_);else for(let y=l-f;y>=a;y-=f)_=ZN(y/f|0,c[y],c[y+1],_);return _&&o_(_,_.next)&&(Xx(_),_=_.next),_}function Cm(c,a){if(!c)return c;a||(a=c);let l,f=c;do if(l=!1,f.steiner||!o_(f,f.next)&&Ua(f.prev,f,f.next)!==0)f=f.next;else{if(Xx(f),f=a=f.prev,f===f.next)break;l=!0}while(l||f!==a);return a}function Gx(c,a,l,f,p,_,y){if(!c)return;!y&&_&&function(A,I,D,F){let z=A;do z.z===0&&(z.z=ok(z.x,z.y,I,D,F)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next;while(z!==A);z.prevZ.nextZ=null,z.prevZ=null,function(H){let q,ne=1;do{let ie,ae=H;H=null;let me=null;for(q=0;ae;){q++;let ye=ae,we=0;for(let ze=0;ze<ne&&(we++,ye=ye.nextZ,ye);ze++);let Be=ne;for(;we>0||Be>0&&ye;)we!==0&&(Be===0||!ye||ae.z<=ye.z)?(ie=ae,ae=ae.nextZ,we--):(ie=ye,ye=ye.nextZ,Be--),me?me.nextZ=ie:H=ie,ie.prevZ=me,me=ie;ae=ye}me.nextZ=null,ne*=2}while(q>1)}(z)}(c,f,p,_);let T=c;for(;c.prev!==c.next;){const A=c.prev,I=c.next;if(_?Ete(c,f,p,_):Ste(c))a.push(A.i,c.i,I.i),Xx(c),c=I.next,T=I.next;else if((c=I)===T){y?y===1?Gx(c=Ate(Cm(c),a),a,l,f,p,_,2):y===2&&Cte(c,a,l,f,p,_):Gx(Cm(c),a,l,f,p,_,1);break}}}function Ste(c){const a=c.prev,l=c,f=c.next;if(Ua(a,l,f)>=0)return!1;const p=a.x,_=l.x,y=f.x,T=a.y,A=l.y,I=f.y,D=Math.min(p,_,y),F=Math.min(T,A,I),z=Math.max(p,_,y),H=Math.max(T,A,I);let q=f.next;for(;q!==a;){if(q.x>=D&&q.x<=z&&q.y>=F&&q.y<=H&&Hx(p,T,_,A,y,I,q.x,q.y)&&Ua(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function Ete(c,a,l,f){const p=c.prev,_=c,y=c.next;if(Ua(p,_,y)>=0)return!1;const T=p.x,A=_.x,I=y.x,D=p.y,F=_.y,z=y.y,H=Math.min(T,A,I),q=Math.min(D,F,z),ne=Math.max(T,A,I),ie=Math.max(D,F,z),ae=ok(H,q,a,l,f),me=ok(ne,ie,a,l,f);let ye=c.prevZ,we=c.nextZ;for(;ye&&ye.z>=ae&&we&&we.z<=me;){if(ye.x>=H&&ye.x<=ne&&ye.y>=q&&ye.y<=ie&&ye!==p&&ye!==y&&Hx(T,D,A,F,I,z,ye.x,ye.y)&&Ua(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,we.x>=H&&we.x<=ne&&we.y>=q&&we.y<=ie&&we!==p&&we!==y&&Hx(T,D,A,F,I,z,we.x,we.y)&&Ua(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;ye&&ye.z>=ae;){if(ye.x>=H&&ye.x<=ne&&ye.y>=q&&ye.y<=ie&&ye!==p&&ye!==y&&Hx(T,D,A,F,I,z,ye.x,ye.y)&&Ua(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;we&&we.z<=me;){if(we.x>=H&&we.x<=ne&&we.y>=q&&we.y<=ie&&we!==p&&we!==y&&Hx(T,D,A,F,I,z,we.x,we.y)&&Ua(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function Ate(c,a){let l=c;do{const f=l.prev,p=l.next.next;!o_(f,p)&&qN(f,l,l.next,p)&&qx(f,p)&&qx(p,f)&&(a.push(f.i,l.i,p.i),Xx(l),Xx(l.next),l=c=p),l=l.next}while(l!==c);return Cm(l)}function Cte(c,a,l,f,p,_){let y=c;do{let T=y.next.next;for(;T!==y.prev;){if(y.i!==T.i&&Mte(y,T)){let A=XN(y,T);return y=Cm(y,y.next),A=Cm(A,A.next),Gx(y,a,l,f,p,_,0),void Gx(A,a,l,f,p,_,0)}T=T.next}y=y.next}while(y!==c)}function Pte(c,a){let l=c.x-a.x;return l===0&&(l=c.y-a.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(a.next.y-a.y)/(a.next.x-a.x)),l}function Ite(c,a){const l=function(p,_){let y=_;const T=p.x,A=p.y;let I,D=-1/0;if(o_(p,y))return y;do{if(o_(p,y.next))return y.next;if(A<=y.y&&A>=y.next.y&&y.next.y!==y.y){const ne=y.x+(A-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(ne<=T&&ne>D&&(D=ne,I=y.x<y.next.x?y:y.next,ne===T))return I}y=y.next}while(y!==_);if(!I)return null;const F=I,z=I.x,H=I.y;let q=1/0;y=I;do{if(T>=y.x&&y.x>=z&&T!==y.x&&HN(A<H?T:D,A,z,H,A<H?D:T,A,y.x,y.y)){const ne=Math.abs(A-y.y)/(T-y.x);qx(y,p)&&(ne<q||ne===q&&(y.x>I.x||y.x===I.x&&kte(I,y)))&&(I=y,q=ne)}y=y.next}while(y!==F);return I}(c,a);if(!l)return a;const f=XN(l,c);return Cm(f,f.next),Cm(l,l.next)}function kte(c,a){return Ua(c.prev,c,a.prev)<0&&Ua(a.next,c,c.next)<0}function ok(c,a,l,f,p){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*p|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Ote(c){let a=c,l=c;do(a.x<l.x||a.x===l.x&&a.y<l.y)&&(l=a),a=a.next;while(a!==c);return l}function HN(c,a,l,f,p,_,y,T){return(p-y)*(a-T)>=(c-y)*(_-T)&&(c-y)*(f-T)>=(l-y)*(a-T)&&(l-y)*(_-T)>=(p-y)*(f-T)}function Hx(c,a,l,f,p,_,y,T){return!(c===y&&a===T)&&HN(c,a,l,f,p,_,y,T)}function Mte(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(l,f){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==f.i&&p.next.i!==f.i&&qN(p,p.next,l,f))return!0;p=p.next}while(p!==l);return!1}(c,a)&&(qx(c,a)&&qx(a,c)&&function(l,f){let p=l,_=!1;const y=(l.x+f.x)/2,T=(l.y+f.y)/2;do p.y>T!=p.next.y>T&&p.next.y!==p.y&&y<(p.next.x-p.x)*(T-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==l);return _}(c,a)&&(Ua(c.prev,c,a.prev)||Ua(c,a.prev,a))||o_(c,a)&&Ua(c.prev,c,c.next)>0&&Ua(a.prev,a,a.next)>0)}function Ua(c,a,l){return(a.y-c.y)*(l.x-a.x)-(a.x-c.x)*(l.y-a.y)}function o_(c,a){return c.x===a.x&&c.y===a.y}function qN(c,a,l,f){const p=DT(Ua(c,a,l)),_=DT(Ua(c,a,f)),y=DT(Ua(l,f,c)),T=DT(Ua(l,f,a));return p!==_&&y!==T||!(p!==0||!RT(c,l,a))||!(_!==0||!RT(c,f,a))||!(y!==0||!RT(l,c,f))||!(T!==0||!RT(l,a,f))}function RT(c,a,l){return a.x<=Math.max(c.x,l.x)&&a.x>=Math.min(c.x,l.x)&&a.y<=Math.max(c.y,l.y)&&a.y>=Math.min(c.y,l.y)}function DT(c){return c>0?1:c<0?-1:0}function qx(c,a){return Ua(c.prev,c,c.next)<0?Ua(c,a,c.next)>=0&&Ua(c,c.prev,a)>=0:Ua(c,a,c.prev)<0||Ua(c,c.next,a)<0}function XN(c,a){const l=sk(c.i,c.x,c.y),f=sk(a.i,a.x,a.y),p=c.next,_=a.prev;return c.next=a,a.prev=c,l.next=p,p.prev=l,f.next=l,l.prev=f,_.next=f,f.prev=_,f}function ZN(c,a,l,f){const p=sk(c,a,l);return f?(p.next=f.next,p.prev=f,f.next.prev=p,f.next=p):(p.prev=p,p.next=p),p}function Xx(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function sk(c,a,l){return{i:c,x:a,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Zx(c,a){const l=c.length;if(l<=1)return[c];const f=[];let p,_;for(let y=0;y<l;y++){const T=Ar(c[y]);T!==0&&(c[y].area=Math.abs(T),_===void 0&&(_=T<0),_===T<0?(p&&f.push(p),p=[c[y]]):p.push(c[y]))}if(p&&f.push(p),a>1)for(let y=0;y<f.length;y++)f[y].length<=a||(L2(f[y],a,1,f[y].length-1,Rte),f[y]=f[y].slice(0,a));return f}function Rte(c,a){return a.area-c.area}function YN(c,a,l=1){if(!c)return null;const f=typeof c=="string"?ts.from(c).getPrimary():c.getPrimary(),p=typeof c=="string"?null:c.getSecondary();for(const _ of[f,p]){if(!_)continue;const y=_.id.toString();a.has(y)||a.set(y,[]),_.scaleSelf(l),a.get(y).push(_)}return{primary:f.toString(),secondary:p?p.toString():null}}function lk(c,a,l,f){const p=f.patternDependencies;let _=!1;for(const y of a){const T=y.paint.get(`${c}-pattern`);T.isConstant()||(_=!0),YN(T.constantOr(null),p,l)&&(_=!0)}return _}function ck(c,a,l,f,p,_){const y=_.patternDependencies;for(const T of a){const A=T.paint.get(`${c}-pattern`).value;if(A.kind!=="constant"){let I=A.evaluate({zoom:f},l,{},_.availableImages);I=I&&I.name?I.name:I;const D=YN(I,y,p);if(!D)continue;const{primary:F,secondary:z}=D;F&&(l.patterns[T.id]=[F,z].filter(Boolean))}}return l}class KN{constructor(){this.polygons=new Map}add(a,...l){const f=this.polygons.get(a);f?f.push(...l):this.polygons.set(a,l)}merge(a){for(const[l,f]of a.polygons)this.add(l,...f)}}class sf{constructor(){this.portals=[]}static isOnBorder(a,l){return a<=0&&l<=0||a>=Zt&&l>=Zt}static evaluate(a){if(a.length===0)return new sf;let l=[];for(const A of a)l.push(...A.portals);if(l.length===0)return new sf;for(const A of l){const I=A.va,D=A.vb;(sf.isOnBorder(I.x,D.x)||sf.isOnBorder(I.y,D.y))&&(A.type="border")}const f=l.filter(A=>A.type!=="unevaluated"),p=l.filter(A=>A.type==="unevaluated");if(p.length===0)return new sf;p.sort((A,I)=>A.hash===I.hash?A.isTunnel===I.isTunnel?0:A.isTunnel?-1:1:A.hash<I.hash?1:-1),l=f.concat(p);let _=f.length,y=_,T=_;do if(y++,y===l.length||l[_].hash!==l[y].hash){if(y-_==2){T<_&&(l[T]=l[_],l[_]=null);const A=l[T],I=l[y-1];A.type=A.isTunnel!==I.isTunnel?"tunnel":"polygon",A.connection={a:A.connection.a,b:I.connection.a},T++}_=y}while(_!==l.length);return l.splice(T),l.sort((A,I)=>A.hash<I.hash?1:-1),{portals:l}}}sr(sf,"ElevationPortalGraph"),sr(KN,"ElevationPolygons");class Dte{constructor(a,l,f){this.outPositions=a,this.outNormals=l,this.outIndices=f,this.vertexLookup=new Map}addVertex(a,l,f){let p=a[2];f!=null&&(p*=f);const _=`${a[0]},${a[1]},${a[2]},${l[0]},${l[1]},${l[2]}`,y=this.vertexLookup.get(_);if(y!=null)return y;const T=this.outPositions.length;this.vertexLookup.set(_,T);const A=Math.trunc(16384*l[0]),I=Math.trunc(16384*l[1]),D=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(a[0],a[1],p),this.outNormals.emplaceBack(A,I,D),T}addTriangle(a,l,f){this.outIndices.emplaceBack(a,l,f)}addTriangles(a,l,f){if(a.length===0)return;const p=f.length===1,_=Ie(),y=Ie();for(let T=0;T<a.length;T+=3){const A=l[a[T+0]],I=l[a[T+1]],D=l[a[T+2]],F=p?f[0]:f[a[T+1]],z=p?f[0]:f[a[T+2]];et(_,A.x,A.y,p?f[0]:f[a[T+0]]);const H=this.addVertex(_,y);et(_,I.x,I.y,F);const q=this.addVertex(_,y);et(_,D.x,D.y,z);const ne=this.addVertex(_,y);this.outIndices.emplaceBack(H,q,ne)}}addQuad(a,l,f,p,_,y){const T=this.addVertex(a,_,y),A=this.addVertex(l,_,y),I=this.addVertex(f,_,y),D=this.addVertex(p,_,y);this.addTriangle(T,A,I),this.addTriangle(I,D,T)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class Hs{constructor(a,l,f,p){this.unevaluatedPortals=new sf,this.portalPolygons=new KN,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new kx,this.vertexNormals=new Hg,this.indexArray=new Ta,this.tileToMeters=st(a),this.bridgeProgramConfigurations=new Ol(l,{zoom:f,lut:p},_=>_!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new Ol(l,{zoom:f,lut:p},_=>_!=="fill-bridge-guard-rail-color")}addVertices(a,l){const f=this.unevalVertices.length;for(let p=0;p<a.length;p++)this.unevalVertices.push(a[p]),this.unevalHeights.push(l[p]);return f}addTriangles(a,l,f){const p=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const _ of a)p.push(_+l)}addRenderableRing(a,l,f,p,_,y){const T=[new Pt(_.min.x,_.min.y),new Pt(_.max.x,_.min.y),new Pt(_.max.x,_.max.y),new Pt(_.min.x,_.max.y)];for(let A=0;A<f-1;A++){const I=l+A,D=I+1,F=this.unevalVertices[I],z=this.unevalVertices[D];if(!(F.x>=_.min.x&&F.x<=_.max.x&&F.y>=_.min.y&&F.y<=_.max.y||z.x>=_.min.x&&z.x<=_.max.x&&z.y>=_.min.y&&z.y<=_.max.y||ho(F,z,T))||this.isOnBorder(F.x,z.x)||this.isOnBorder(F.y,z.y))continue;const H=Hs.computeEdgeHash(this.unevalVertices[I],this.unevalVertices[D]);let q,ne=this.vertexHashLookup.get(Hs.computePosHash(F));ne!=null?q=ne.next:(ne=this.vertexHashLookup.get(Hs.computePosHash(z)),q=ne!=null?ne.prev:H),this.unevalEdges.push({polygonIdx:a,a:I,b:D,hash:H,portalHash:q,isTunnel:p,type:"unevaluated",featureInfo:y})}}addPortalCandidates(a,l,f,p,_){if(l.length===0)return;this.portalPolygons.add(a,{geometry:l,zLevel:_});const y=l[0];this.vertexHashLookup.clear();let T=Hs.computeEdgeHash(y[y.length-2],y[y.length-1]);for(let A=0;A<y.length-1;A++){const I=y[A+0],D=y[A+1],F=Gi(D.x-I.x,D.y-I.y),z=xl(F);if(z===0)continue;let H="unevaluated";const q=p.pointElevation(I),ne=p.pointElevation(D);Math.abs(q)<.01&&Math.abs(ne)<.01?H="entrance":(this.isOnBorder(I.x,D.x)||this.isOnBorder(I.y,D.y))&&(H="border");const ie=Hs.computeEdgeHash(I,D);this.unevaluatedPortals.portals.push({connection:{a,b:void 0},va:I,vb:D,vab:F,length:z,hash:ie,isTunnel:f,type:H});const ae=Hs.computePosHash(I);this.vertexHashLookup.set(ae,{prev:T,next:ie}),T=ie}}construct(a){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=z=>{z.primitiveLength=this.indexArray.length-z.primitiveOffset},p=new Dte(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(a.portals,this.unevalEdges);const _=l(),y=l(),T=l(),A=(z,H)=>{z.sort((ne,ie)=>ne.type===H&&ie.type!==H?-1:ne.type!==H&&ie.type===H?1:0);const q=z.findIndex(ne=>ne.type!==H);return q>=0?q:z.length};let I=0;this.unevalEdges.length>0&&(I=A(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},this.tileToMeters)),f(T);const D=l(),F=l();if(this.unevalEdges.length>0){const z=this.unevalEdges.splice(I),H=A(z,"tunnel")+I;this.unevalEdges.push(...z),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},{min:I,max:H})}f(D),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(F),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(y),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(_),this.maskSegments=Ti.simpleSegment(0,F.primitiveOffset,0,F.primitiveLength),this.depthSegments=Ti.simpleSegment(0,y.primitiveOffset,0,y.primitiveLength),this.renderableBridgeSegments=Ti.simpleSegment(0,T.primitiveOffset,0,T.primitiveLength),this.renderableTunnelSegments=Ti.simpleSegment(0,D.primitiveOffset,0,D.primitiveLength),this.shadowCasterSegments=Ti.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength)}update(a,l,f,p,_,y,T,A){this.bridgeProgramConfigurations.updatePaintArrays(a,l,_,f,p,y,T,A),this.tunnelProgramConfigurations.updatePaintArrays(a,l,_,f,p,y,T,A)}upload(a){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=a.createVertexBuffer(this.vertexPositions,bte.members),this.vertexBufferNormal=a.createVertexBuffer(this.vertexNormals,Tte.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(a),this.tunnelProgramConfigurations.upload(a))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(a,l,f,p,_){const y=(T,A)=>{for(let I=0;I<A.length-1;I++){const D=A[I].featureIndex,F=A[I+1].vertexStart,z=a.feature(D);T.populatePaintArrays(F,z,D,{},f,l,p,void 0,_)}};y(this.bridgeProgramConfigurations,this.bridgeFeatureSections),y(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(a,l,f,p,_){const y=new Map;for(let T=p;T<_;T++){const A=f[T],I=A.a,D=A.b,F=Hs.computePosHash(a[I]),z=Hs.computePosHash(a[D]);let H=y.get(F);H||(H={},y.set(F,H));let q=y.get(z);q||(q={},y.set(z,q)),l[I]<=0&&l[D]<=0||(H.to=D,q.from=I)}return y}isTerminalVertex(a,l){const f=Hs.computePosHash(this.unevalVertices[a]),p=l.get(f);return!p||!p.from||!p.to}constructBridgeStructures(a,l,f,p,_,y){a.clearVertexLookup();const T=this.computeVertexConnections(l,f,p,_.min,_.max),A=1/y,I=.5*A,D=(Lt,$t)=>et(Lt,l[$t].x,l[$t].y,f[$t]*A),F=Ie(),z=Ie(),H=Ie(),q=Ie(),ne=Ie(),ie=(Lt,$t)=>{const Et=T.get(Hs.computePosHash(l[$t])),Nt=Et.from,gt=Et.to;if(!Nt||!gt)return;D(F,Nt),D(z,$t),D(H,gt),un(q),kr(F,z)||(Br(ne,z,F),yt(q,ne)),kr(H,z)||(Br(ne,H,z),at(q,q,yt(ne,ne)));const ut=Tr(q);return ut>0?Rt(Lt,q,1/ut):void 0};let ae=Number.POSITIVE_INFINITY;this.sortSubarray(p,_.min,_.max,(Lt,$t)=>Lt.featureInfo.featureIndex-$t.featureInfo.featureIndex);const me=Ie(),ye=Ie(),we=Ie(),Be=Ie(),ze=Ie(),Ve=Ie(),Ze=Ie(),Ye=Ie(),Ct=Ie(),nt=[Ie(),Ie(),Ie(),Ie()],kt=[Ie(),Ie(),Ie(),Ie()],zt=[{coord:new Pt(0,0),height:0},{coord:new Pt(0,0),height:0}],Ot=(Lt,$t)=>Lt>$t;for(let Lt=_.min;Lt<_.max;Lt++){const $t=p[Lt];if(!$t.featureInfo.guardRailEnabled||!this.prepareEdgePoints(zt,l,f,$t,Ot))continue;const[Et,Nt]=zt;if(et(me,Et.coord.x,Et.coord.y,A*Et.height),et(ye,Nt.coord.x,Nt.coord.y,A*Nt.height),kr(me,ye))continue;Br(we,ye,me),yt(we,we);const gt=ie(Ye,$t.a)||we,ut=ie(Ct,$t.b)||we;et(Be,gt[1],-gt[0],0),yt(Be,Be),et(ze,ut[1],-ut[0],0),yt(ze,ze),Yt(Ye,Be,gt),yt(Ve,Ye),Yt(Ye,ze,ut),yt(Ze,Ye),at(nt[0],me,Rt(Ye,Br(Ye,Be,Ve),I)),at(nt[1],me,Rt(Ye,at(Ye,Be,Ve),I)),at(nt[2],me,Rt(Ye,Ve,I)),nt[3]=me,at(kt[0],ye,Rt(Ye,Br(Ye,ze,Ze),I)),at(kt[1],ye,Rt(Ye,at(Ye,ze,Ze),I)),at(kt[2],ye,Rt(Ye,Ze,I)),kt[3]=ye,ae=this.addFeatureSection($t.featureInfo.featureIndex,ae,this.bridgeFeatureSections,a);const Vt=a.addVertex(nt[0],Be,y),jt=a.addVertex(nt[1],Be,y),br=a.addVertex(kt[0],ze,y),ir=a.addVertex(kt[1],ze,y);a.addTriangle(Vt,jt,br),a.addTriangle(jt,ir,br);const dr=a.addVertex(nt[1],Ve,y),qt=a.addVertex(nt[2],Ve,y),xr=a.addVertex(kt[1],Ze,y),jr=a.addVertex(kt[2],Ze,y);a.addTriangle(dr,qt,xr),a.addTriangle(qt,jr,xr),Xe(Be,Be),Xe(ze,ze);const Qt=a.addVertex(nt[2],Be,y),gr=a.addVertex(nt[3],Be,y),Or=a.addVertex(kt[2],ze,y),Vr=a.addVertex(kt[3],ze,y);a.addTriangle(Qt,gr,Or),a.addTriangle(gr,Vr,Or);const rn=this.isTerminalVertex($t.a,T),Gr=this.isTerminalVertex($t.b,T);Et.height<.01&&rn&&a.addQuad(nt[3],nt[2],nt[1],nt[0],Xe(gt,gt),y),Nt.height<.01&&Gr&&a.addQuad(kt[0],kt[1],kt[2],kt[3],ut,y)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:a.getVertexCount()})}constructTunnelStructures(a,l,f,p,_,y){a.clearVertexLookup();let T=Number.POSITIVE_INFINITY;const A=(ae,me)=>ae.featureInfo.featureIndex-me.featureInfo.featureIndex;this.sortSubarray(p,_.min,_.max,A),this.sortSubarray(p,y.min,y.max,A);const I=ae=>yt(ae,ae),D=[{coord:new Pt(0,0),height:0},{coord:new Pt(0,0),height:0}],F=(ae,me)=>ae<me,z=Ie(),H=Ie(),q=Ie(),ne=Ie(),ie=Ie();for(let ae=_.min;ae<_.max;ae++){if(!this.prepareEdgePoints(D,l,f,p[ae],F))continue;const[me,ye]=D,we=I(et(ie,-(ye.coord.y-me.coord.y),ye.coord.x-me.coord.x,0));T=this.addFeatureSection(p[ae].featureInfo.featureIndex,T,this.tunnelFeatureSections,a),a.addQuad(et(z,me.coord.x,me.coord.y,me.height),et(H,ye.coord.x,ye.coord.y,ye.height),et(q,ye.coord.x,ye.coord.y,p[ae].isTunnel?-.1:0),et(ne,me.coord.x,me.coord.y,p[ae].isTunnel?-.1:0),we)}for(let ae=y.min;ae<y.max;ae++){const me=p[ae];me.isTunnel&&([me.a,me.b]=[me.b,me.a]);const ye=l[me.a],we=l[me.b],Be=I(et(ie,-(we.y-ye.y),we.x-ye.x,0));T=this.addFeatureSection(me.featureInfo.featureIndex,T,this.tunnelFeatureSections,a),a.addQuad(et(z,we.x,we.y,0),et(H,ye.x,ye.y,0),et(q,ye.x,ye.y,f[me.a]+4),et(ne,we.x,we.y,f[me.b]+4),Be),a.addQuad(et(z,ye.x,ye.y,0),et(H,we.x,we.y,0),et(q,we.x,we.y,f[me.b]+4),et(ne,ye.x,ye.y,f[me.a]+4),Be)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:a.getVertexCount()})}setElevatedPoint(a,l,f,p){a.coord.x=l,a.coord.y=f,a.height=p}prepareEdgePoints(a,l,f,p,_){let y=l[p.a].x,T=l[p.a].y,A=l[p.b].x,I=l[p.b].y,D=f[p.a],F=f[p.b];const z=_(D,0),H=_(F,0);if(z&&H)return this.setElevatedPoint(a[0],y,T,D),this.setElevatedPoint(a[1],A,I,F),!0;if(!z&&!H)return!1;if(z){if(!H){const q=F/(F-D);A=Ir(A,y,q),I=Ir(I,T,q),F=Ir(F,D,q)}}else{const q=D/(D-F);y=Ir(y,A,q),T=Ir(T,I,q),D=Ir(D,F,q)}return this.setElevatedPoint(a[0],y,T,D),this.setElevatedPoint(a[1],A,I,F),!0}prepareEdges(a,l){if(l.length===0)return;l.sort((T,A)=>T.hash===A.hash?A.polygonIdx-T.polygonIdx:A.hash>T.hash?1:-1);let f=0,p=0,_=0,y=l[f].polygonIdx;do p++,(p===l.length||l[f].hash!==l[p].hash)&&((p-f==1||l[p-1].polygonIdx!==y)&&(_<f&&(l[_]=l[f],l[f]=null),l[_].type="none",_++),f=p,f!==l.length&&(y=l[f].polygonIdx));while(f!==l.length);if(l.splice(_),l.length!==0&&a.length!==0){l.sort((I,D)=>I.portalHash<D.portalHash?1:-1);let T=0,A=0;for(;T!==l.length&&A!==a.length;){const I=l[T],D=a[A];I.portalHash>D.hash?T++:D.hash>I.portalHash?A++:(I.type=D.type,T++)}}}isOnBorder(a,l){return a<=0&&l<=0||a>=Zt&&l>=Zt}addFeatureSection(a,l,f,p){return a!==l&&(l=a,f.push({featureIndex:a,vertexStart:p.getVertexCount()}),p.clearVertexLookup()),l}sortSubarray(a,l,f,p){const _=a.slice(l,f);_.sort(p),a.splice(l,_.length,..._)}static computeEdgeHash(a,l){return(a.y===l.y&&a.x>l.x||a.y>l.y)&&([a,l]=[l,a]),BigInt(Hs.computePosHash(a))<<32n|BigInt(Hs.computePosHash(l))}static computePosHash(a){return((65535&a.x)<<16|65535&a.y)>>>0}}var JN,QN={exports:{}},eB=(JN||(JN=1,function(c,a){(function(l){function f(Ae,Ce){return Ae>Ce?1:Ae<Ce?-1:0}var p=function(Ae,Ce){Ae===void 0&&(Ae=f),Ce===void 0&&(Ce=!1),this._compare=Ae,this._root=null,this._size=0,this._noDuplicates=!!Ce},_={size:{configurable:!0}};function y(Ae,Ce,dt,At,Jt){var Kt=Jt-At;if(Kt>0){var lr=At+Math.floor(Kt/2),Er={key:Ce[lr],data:dt[lr],parent:Ae};return Er.left=y(Er,Ce,dt,At,lr),Er.right=y(Er,Ce,dt,lr+1,Jt),Er}return null}function T(Ae,Ce,dt,At,Jt){if(!(dt>=At)){for(var Kt=Ae[dt+At>>1],lr=dt-1,Er=At+1;;){do lr++;while(Jt(Ae[lr],Kt)<0);do Er--;while(Jt(Ae[Er],Kt)>0);if(lr>=Er)break;var nn=Ae[lr];Ae[lr]=Ae[Er],Ae[Er]=nn,nn=Ce[lr],Ce[lr]=Ce[Er],Ce[Er]=nn}T(Ae,Ce,dt,Er,Jt),T(Ae,Ce,Er+1,At,Jt)}}p.prototype.rotateLeft=function(Ae){var Ce=Ae.right;Ce&&(Ae.right=Ce.left,Ce.left&&(Ce.left.parent=Ae),Ce.parent=Ae.parent),Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ce:Ae.parent.right=Ce:this._root=Ce,Ce&&(Ce.left=Ae),Ae.parent=Ce},p.prototype.rotateRight=function(Ae){var Ce=Ae.left;Ce&&(Ae.left=Ce.right,Ce.right&&(Ce.right.parent=Ae),Ce.parent=Ae.parent),Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ce:Ae.parent.right=Ce:this._root=Ce,Ce&&(Ce.right=Ae),Ae.parent=Ce},p.prototype._splay=function(Ae){for(;Ae.parent;){var Ce=Ae.parent;Ce.parent?Ce.left===Ae&&Ce.parent.left===Ce?(this.rotateRight(Ce.parent),this.rotateRight(Ce)):Ce.right===Ae&&Ce.parent.right===Ce?(this.rotateLeft(Ce.parent),this.rotateLeft(Ce)):Ce.left===Ae&&Ce.parent.right===Ce?(this.rotateRight(Ce),this.rotateLeft(Ce)):(this.rotateLeft(Ce),this.rotateRight(Ce)):Ce.left===Ae?this.rotateRight(Ce):this.rotateLeft(Ce)}},p.prototype.splay=function(Ae){for(var Ce,dt,At,Jt,Kt;Ae.parent;)(dt=(Ce=Ae.parent).parent)&&dt.parent?((At=dt.parent).left===dt?At.left=Ae:At.right=Ae,Ae.parent=At):(Ae.parent=null,this._root=Ae),Jt=Ae.left,Kt=Ae.right,Ae===Ce.left?(dt&&(dt.left===Ce?(Ce.right?(dt.left=Ce.right,dt.left.parent=dt):dt.left=null,Ce.right=dt,dt.parent=Ce):(Jt?(dt.right=Jt,Jt.parent=dt):dt.right=null,Ae.left=dt,dt.parent=Ae)),Kt?(Ce.left=Kt,Kt.parent=Ce):Ce.left=null,Ae.right=Ce,Ce.parent=Ae):(dt&&(dt.right===Ce?(Ce.left?(dt.right=Ce.left,dt.right.parent=dt):dt.right=null,Ce.left=dt,dt.parent=Ce):(Kt?(dt.left=Kt,Kt.parent=dt):dt.left=null,Ae.right=dt,dt.parent=Ae)),Jt?(Ce.right=Jt,Jt.parent=Ce):Ce.right=null,Ae.left=Ce,Ce.parent=Ae)},p.prototype.replace=function(Ae,Ce){Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ce:Ae.parent.right=Ce:this._root=Ce,Ce&&(Ce.parent=Ae.parent)},p.prototype.minNode=function(Ae){if(Ae===void 0&&(Ae=this._root),Ae)for(;Ae.left;)Ae=Ae.left;return Ae},p.prototype.maxNode=function(Ae){if(Ae===void 0&&(Ae=this._root),Ae)for(;Ae.right;)Ae=Ae.right;return Ae},p.prototype.insert=function(Ae,Ce){var dt=this._root,At=null,Jt=this._compare;if(this._noDuplicates)for(;dt;){if(At=dt,Jt(dt.key,Ae)===0)return;dt=Jt(dt.key,Ae)<0?dt.right:dt.left}else for(;dt;)At=dt,dt=Jt(dt.key,Ae)<0?dt.right:dt.left;return dt={key:Ae,data:Ce,left:null,right:null,parent:At},At?Jt(At.key,dt.key)<0?At.right=dt:At.left=dt:this._root=dt,this.splay(dt),this._size++,dt},p.prototype.find=function(Ae){for(var Ce=this._root,dt=this._compare;Ce;){var At=dt(Ce.key,Ae);if(At<0)Ce=Ce.right;else{if(!(At>0))return Ce;Ce=Ce.left}}return null},p.prototype.contains=function(Ae){for(var Ce=this._root,dt=this._compare;Ce;){var At=dt(Ae,Ce.key);if(At===0)return!0;Ce=At<0?Ce.left:Ce.right}return!1},p.prototype.remove=function(Ae){var Ce=this.find(Ae);if(!Ce)return!1;if(this.splay(Ce),Ce.left)if(Ce.right){var dt=this.minNode(Ce.right);dt.parent!==Ce&&(this.replace(dt,dt.right),dt.right=Ce.right,dt.right.parent=dt),this.replace(Ce,dt),dt.left=Ce.left,dt.left.parent=dt}else this.replace(Ce,Ce.left);else this.replace(Ce,Ce.right);return this._size--,!0},p.prototype.removeNode=function(Ae){if(!Ae)return!1;if(this.splay(Ae),Ae.left)if(Ae.right){var Ce=this.minNode(Ae.right);Ce.parent!==Ae&&(this.replace(Ce,Ce.right),Ce.right=Ae.right,Ce.right.parent=Ce),this.replace(Ae,Ce),Ce.left=Ae.left,Ce.left.parent=Ce}else this.replace(Ae,Ae.left);else this.replace(Ae,Ae.right);return this._size--,!0},p.prototype.erase=function(Ae){var Ce=this.find(Ae);if(Ce){this.splay(Ce);var dt=Ce.left,At=Ce.right,Jt=null;dt&&(dt.parent=null,Jt=this.maxNode(dt),this.splay(Jt),this._root=Jt),At&&(dt?Jt.right=At:this._root=At,At.parent=Jt),this._size--}},p.prototype.pop=function(){var Ae=this._root,Ce=null;if(Ae){for(;Ae.left;)Ae=Ae.left;Ce={key:Ae.key,data:Ae.data},this.remove(Ae.key)}return Ce},p.prototype.next=function(Ae){var Ce=Ae;if(Ce)if(Ce.right)for(Ce=Ce.right;Ce&&Ce.left;)Ce=Ce.left;else for(Ce=Ae.parent;Ce&&Ce.right===Ae;)Ae=Ce,Ce=Ce.parent;return Ce},p.prototype.prev=function(Ae){var Ce=Ae;if(Ce)if(Ce.left)for(Ce=Ce.left;Ce&&Ce.right;)Ce=Ce.right;else for(Ce=Ae.parent;Ce&&Ce.left===Ae;)Ae=Ce,Ce=Ce.parent;return Ce},p.prototype.forEach=function(Ae){for(var Ce=this._root,dt=[],At=!1,Jt=0;!At;)Ce?(dt.push(Ce),Ce=Ce.left):dt.length>0?(Ae(Ce=dt.pop(),Jt++),Ce=Ce.right):At=!0;return this},p.prototype.range=function(Ae,Ce,dt,At){for(var Jt=[],Kt=this._compare,lr=this._root;Jt.length!==0||lr;)if(lr)Jt.push(lr),lr=lr.left;else{if(Kt((lr=Jt.pop()).key,Ce)>0)break;if(Kt(lr.key,Ae)>=0&&dt.call(At,lr))return this;lr=lr.right}return this},p.prototype.keys=function(){for(var Ae=this._root,Ce=[],dt=[],At=!1;!At;)Ae?(Ce.push(Ae),Ae=Ae.left):Ce.length>0?(Ae=Ce.pop(),dt.push(Ae.key),Ae=Ae.right):At=!0;return dt},p.prototype.values=function(){for(var Ae=this._root,Ce=[],dt=[],At=!1;!At;)Ae?(Ce.push(Ae),Ae=Ae.left):Ce.length>0?(Ae=Ce.pop(),dt.push(Ae.data),Ae=Ae.right):At=!0;return dt},p.prototype.at=function(Ae){for(var Ce=this._root,dt=[],At=!1,Jt=0;!At;)if(Ce)dt.push(Ce),Ce=Ce.left;else if(dt.length>0){if(Ce=dt.pop(),Jt===Ae)return Ce;Jt++,Ce=Ce.right}else At=!0;return null},p.prototype.load=function(Ae,Ce,dt){if(Ae===void 0&&(Ae=[]),Ce===void 0&&(Ce=[]),dt===void 0&&(dt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var At=Ae.length;return dt&&T(Ae,Ce,0,At-1,this._compare),this._root=y(null,Ae,Ce,0,At),this._size=At,this},p.prototype.min=function(){var Ae=this.minNode(this._root);return Ae?Ae.key:null},p.prototype.max=function(){var Ae=this.maxNode(this._root);return Ae?Ae.key:null},p.prototype.isEmpty=function(){return this._root===null},_.size.get=function(){return this._size},p.createTree=function(Ae,Ce,dt,At,Jt){return new p(dt,Jt).load(Ae,Ce,At)},Object.defineProperties(p.prototype,_);var A=0,I=1,D=2,F=3,z=0,H=1,q=2,ne=3;function ie(Ae,Ce,dt){Ce===null?(Ae.inOut=!1,Ae.otherInOut=!0):(Ae.isSubject===Ce.isSubject?(Ae.inOut=!Ce.inOut,Ae.otherInOut=Ce.otherInOut):(Ae.inOut=!Ce.otherInOut,Ae.otherInOut=Ce.isVertical()?!Ce.inOut:Ce.inOut),Ce&&(Ae.prevInResult=!ae(Ce,dt)||Ce.isVertical()?Ce.prevInResult:Ce));var At=ae(Ae,dt);Ae.resultTransition=At?function(Jt,Kt){var lr,Er=!Jt.inOut,nn=!Jt.otherInOut;switch(Kt){case z:lr=Er&&nn;break;case H:lr=Er||nn;break;case ne:lr=Er^nn;break;case q:lr=Jt.isSubject?Er&&!nn:nn&&!Er}return lr?1:-1}(Ae,dt):0}function ae(Ae,Ce){switch(Ae.type){case A:switch(Ce){case z:return!Ae.otherInOut;case H:return Ae.otherInOut;case q:return Ae.isSubject&&Ae.otherInOut||!Ae.isSubject&&!Ae.otherInOut;case ne:return!0}break;case D:return Ce===z||Ce===H;case F:return Ce===q;case I:return!1}return!1}var me=function(Ae,Ce,dt,At,Jt){this.left=Ce,this.point=Ae,this.otherEvent=dt,this.isSubject=At,this.type=Jt||A,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},ye={inResult:{configurable:!0}};function we(Ae,Ce){return Ae[0]===Ce[0]&&Ae[1]===Ce[1]}me.prototype.isBelow=function(Ae){var Ce=this.point,dt=this.otherEvent.point;return this.left?(Ce[0]-Ae[0])*(dt[1]-Ae[1])-(dt[0]-Ae[0])*(Ce[1]-Ae[1])>0:(dt[0]-Ae[0])*(Ce[1]-Ae[1])-(Ce[0]-Ae[0])*(dt[1]-Ae[1])>0},me.prototype.isAbove=function(Ae){return!this.isBelow(Ae)},me.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},ye.inResult.get=function(){return this.resultTransition!==0},me.prototype.clone=function(){var Ae=new me(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ae.contourId=this.contourId,Ae.resultTransition=this.resultTransition,Ae.prevInResult=this.prevInResult,Ae.isExteriorRing=this.isExteriorRing,Ae.inOut=this.inOut,Ae.otherInOut=this.otherInOut,Ae},Object.defineProperties(me.prototype,ye);var Be=11102230246251565e-32,ze=134217729,Ve=(3+8*Be)*Be;function Ze(Ae,Ce,dt,At,Jt){var Kt,lr,Er,nn,on=Ce[0],tn=At[0],Fn=0,mi=0;tn>on==tn>-on?(Kt=on,on=Ce[++Fn]):(Kt=tn,tn=At[++mi]);var en=0;if(Fn<Ae&&mi<dt)for(tn>on==tn>-on?(Er=Kt-((lr=on+Kt)-on),on=Ce[++Fn]):(Er=Kt-((lr=tn+Kt)-tn),tn=At[++mi]),Kt=lr,Er!==0&&(Jt[en++]=Er);Fn<Ae&&mi<dt;)tn>on==tn>-on?(Er=Kt-((lr=Kt+on)-(nn=lr-Kt))+(on-nn),on=Ce[++Fn]):(Er=Kt-((lr=Kt+tn)-(nn=lr-Kt))+(tn-nn),tn=At[++mi]),Kt=lr,Er!==0&&(Jt[en++]=Er);for(;Fn<Ae;)Er=Kt-((lr=Kt+on)-(nn=lr-Kt))+(on-nn),on=Ce[++Fn],Kt=lr,Er!==0&&(Jt[en++]=Er);for(;mi<dt;)Er=Kt-((lr=Kt+tn)-(nn=lr-Kt))+(tn-nn),tn=At[++mi],Kt=lr,Er!==0&&(Jt[en++]=Er);return Kt===0&&en!==0||(Jt[en++]=Kt),en}function Ye(Ae){return new Float64Array(Ae)}var Ct=33306690738754716e-32,nt=22204460492503146e-32,kt=11093356479670487e-47,zt=Ye(4),Ot=Ye(8),Lt=Ye(12),$t=Ye(16),Et=Ye(4);function Nt(Ae,Ce,dt){var At=function(Jt,Kt,lr,Er,nn,on){var tn=(Kt-on)*(lr-nn),Fn=(Jt-nn)*(Er-on),mi=tn-Fn;if(tn===0||Fn===0||tn>0!=Fn>0)return mi;var en=Math.abs(tn+Fn);return Math.abs(mi)>=Ct*en?mi:-function(Jn,Bn,bn,ri,ni,qn,Qn){var zn,sn,Vn,Si,Dr,gn,ii,Oi,hi,_a,Wn,ua,gs,po,ao,_s,th,ya,Ba=Jn-ni,mo=bn-ni,Go=Bn-qn,Io=ri-qn;zt[0]=(ao=(Oi=Ba-(ii=(gn=ze*Ba)-(gn-Ba)))*(_a=Io-(hi=(gn=ze*Io)-(gn-Io)))-((po=Ba*Io)-ii*hi-Oi*hi-ii*_a))-((Wn=ao-(th=(Oi=Go-(ii=(gn=ze*Go)-(gn-Go)))*(_a=mo-(hi=(gn=ze*mo)-(gn-mo)))-((_s=Go*mo)-ii*hi-Oi*hi-ii*_a)))+(Dr=ao-Wn))+(Dr-th),zt[1]=(gs=po-((ua=po+Wn)-(Dr=ua-po))+(Wn-Dr))-((Wn=gs-_s)+(Dr=gs-Wn))+(Dr-_s),zt[2]=ua-((ya=ua+Wn)-(Dr=ya-ua))+(Wn-Dr),zt[3]=ya;var Dd=function(Pqe,p6){for(var m6=p6[0],mO=1;mO<4;mO++)m6+=p6[mO];return m6}(0,zt),A1=nt*Qn;if(Dd>=A1||-Dd>=A1||(zn=Jn-(Ba+(Dr=Jn-Ba))+(Dr-ni),Vn=bn-(mo+(Dr=bn-mo))+(Dr-ni),sn=Bn-(Go+(Dr=Bn-Go))+(Dr-qn),Si=ri-(Io+(Dr=ri-Io))+(Dr-qn),zn===0&&sn===0&&Vn===0&&Si===0)||(A1=kt*Qn+Ve*Math.abs(Dd),(Dd+=Ba*Si+Io*zn-(Go*Vn+mo*sn))>=A1||-Dd>=A1))return Dd;Et[0]=(ao=(Oi=zn-(ii=(gn=ze*zn)-(gn-zn)))*(_a=Io-(hi=(gn=ze*Io)-(gn-Io)))-((po=zn*Io)-ii*hi-Oi*hi-ii*_a))-((Wn=ao-(th=(Oi=sn-(ii=(gn=ze*sn)-(gn-sn)))*(_a=mo-(hi=(gn=ze*mo)-(gn-mo)))-((_s=sn*mo)-ii*hi-Oi*hi-ii*_a)))+(Dr=ao-Wn))+(Dr-th),Et[1]=(gs=po-((ua=po+Wn)-(Dr=ua-po))+(Wn-Dr))-((Wn=gs-_s)+(Dr=gs-Wn))+(Dr-_s),Et[2]=ua-((ya=ua+Wn)-(Dr=ya-ua))+(Wn-Dr),Et[3]=ya;var Bie=Ze(4,zt,4,Et,Ot);Et[0]=(ao=(Oi=Ba-(ii=(gn=ze*Ba)-(gn-Ba)))*(_a=Si-(hi=(gn=ze*Si)-(gn-Si)))-((po=Ba*Si)-ii*hi-Oi*hi-ii*_a))-((Wn=ao-(th=(Oi=Go-(ii=(gn=ze*Go)-(gn-Go)))*(_a=Vn-(hi=(gn=ze*Vn)-(gn-Vn)))-((_s=Go*Vn)-ii*hi-Oi*hi-ii*_a)))+(Dr=ao-Wn))+(Dr-th),Et[1]=(gs=po-((ua=po+Wn)-(Dr=ua-po))+(Wn-Dr))-((Wn=gs-_s)+(Dr=gs-Wn))+(Dr-_s),Et[2]=ua-((ya=ua+Wn)-(Dr=ya-ua))+(Wn-Dr),Et[3]=ya;var zie=Ze(Bie,Ot,4,Et,Lt);Et[0]=(ao=(Oi=zn-(ii=(gn=ze*zn)-(gn-zn)))*(_a=Si-(hi=(gn=ze*Si)-(gn-Si)))-((po=zn*Si)-ii*hi-Oi*hi-ii*_a))-((Wn=ao-(th=(Oi=sn-(ii=(gn=ze*sn)-(gn-sn)))*(_a=Vn-(hi=(gn=ze*Vn)-(gn-Vn)))-((_s=sn*Vn)-ii*hi-Oi*hi-ii*_a)))+(Dr=ao-Wn))+(Dr-th),Et[1]=(gs=po-((ua=po+Wn)-(Dr=ua-po))+(Wn-Dr))-((Wn=gs-_s)+(Dr=gs-Wn))+(Dr-_s),Et[2]=ua-((ya=ua+Wn)-(Dr=ya-ua))+(Wn-Dr),Et[3]=ya;var jie=Ze(zie,Lt,4,Et,$t);return $t[jie-1]}(Jt,Kt,lr,Er,nn,on,en)}(Ae[0],Ae[1],Ce[0],Ce[1],dt[0],dt[1]);return At>0?-1:At<0?1:0}function gt(Ae,Ce){var dt=Ae.point,At=Ce.point;return dt[0]>At[0]?1:dt[0]<At[0]?-1:dt[1]!==At[1]?dt[1]>At[1]?1:-1:function(Jt,Kt,lr,Er){return Jt.left!==Kt.left?Jt.left?1:-1:Nt(lr,Jt.otherEvent.point,Kt.otherEvent.point)!==0?Jt.isBelow(Kt.otherEvent.point)?-1:1:!Jt.isSubject&&Kt.isSubject?1:-1}(Ae,Ce,dt)}function ut(Ae,Ce,dt){var At=new me(Ce,!1,Ae,Ae.isSubject),Jt=new me(Ce,!0,Ae.otherEvent,Ae.isSubject);return we(Ae.point,Ae.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ae),At.contourId=Jt.contourId=Ae.contourId,gt(Jt,Ae.otherEvent)>0&&(Ae.otherEvent.left=!0,Jt.left=!1),Ae.otherEvent.otherEvent=Jt,Ae.otherEvent=At,dt.push(Jt),dt.push(At),dt}function Vt(Ae,Ce){return Ae[0]*Ce[1]-Ae[1]*Ce[0]}function jt(Ae,Ce){return Ae[0]*Ce[0]+Ae[1]*Ce[1]}function br(Ae,Ce,dt){var At=function(nn,on,tn,Fn,mi){var en=[on[0]-nn[0],on[1]-nn[1]],Jn=[Fn[0]-tn[0],Fn[1]-tn[1]];function Bn(gn,ii,Oi){return[gn[0]+ii*Oi[0],gn[1]+ii*Oi[1]]}var bn=[tn[0]-nn[0],tn[1]-nn[1]],ri=Vt(en,Jn),ni=ri*ri,qn=jt(en,en);if(ni>0){var Qn=Vt(bn,Jn)/ri;if(Qn<0||Qn>1)return null;var zn=Vt(bn,en)/ri;return zn<0||zn>1?null:Qn===0||Qn===1?[Bn(nn,Qn,en)]:zn===0||zn===1?[Bn(tn,zn,Jn)]:[Bn(nn,Qn,en)]}if((ni=(ri=Vt(bn,en))*ri)>0)return null;var sn=jt(en,bn)/qn,Vn=sn+jt(en,Jn)/qn,Si=Math.min(sn,Vn),Dr=Math.max(sn,Vn);return Si<=1&&Dr>=0?Si===1?[Bn(nn,Si>0?Si:0,en)]:Dr===0?[Bn(nn,Dr<1?Dr:1,en)]:[Bn(nn,Si>0?Si:0,en),Bn(nn,Dr<1?Dr:1,en)]:null}(Ae.point,Ae.otherEvent.point,Ce.point,Ce.otherEvent.point),Jt=At?At.length:0;if(Jt===0||Jt===1&&(we(Ae.point,Ce.point)||we(Ae.otherEvent.point,Ce.otherEvent.point))||Jt===2&&Ae.isSubject===Ce.isSubject)return 0;if(Jt===1)return we(Ae.point,At[0])||we(Ae.otherEvent.point,At[0])||ut(Ae,At[0],dt),we(Ce.point,At[0])||we(Ce.otherEvent.point,At[0])||ut(Ce,At[0],dt),1;var Kt=[],lr=!1,Er=!1;return we(Ae.point,Ce.point)?lr=!0:gt(Ae,Ce)===1?Kt.push(Ce,Ae):Kt.push(Ae,Ce),we(Ae.otherEvent.point,Ce.otherEvent.point)?Er=!0:gt(Ae.otherEvent,Ce.otherEvent)===1?Kt.push(Ce.otherEvent,Ae.otherEvent):Kt.push(Ae.otherEvent,Ce.otherEvent),lr&&Er||lr?(Ce.type=I,Ae.type=Ce.inOut===Ae.inOut?D:F,lr&&!Er&&ut(Kt[1].otherEvent,Kt[0].point,dt),2):Er?(ut(Kt[0],Kt[1].point,dt),3):Kt[0]!==Kt[3].otherEvent?(ut(Kt[0],Kt[1].point,dt),ut(Kt[1],Kt[2].point,dt),3):(ut(Kt[0],Kt[1].point,dt),ut(Kt[3].otherEvent,Kt[2].point,dt),3)}function ir(Ae,Ce){if(Ae===Ce)return 0;if(Nt(Ae.point,Ae.otherEvent.point,Ce.point)!==0||Nt(Ae.point,Ae.otherEvent.point,Ce.otherEvent.point)!==0)return we(Ae.point,Ce.point)?Ae.isBelow(Ce.otherEvent.point)?-1:1:Ae.point[0]===Ce.point[0]?Ae.point[1]<Ce.point[1]?-1:1:gt(Ae,Ce)===1?Ce.isAbove(Ae.point)?-1:1:Ae.isBelow(Ce.point)?-1:1;if(Ae.isSubject!==Ce.isSubject)return Ae.isSubject?-1:1;var dt=Ae.point,At=Ce.point;return dt[0]===At[0]&&dt[1]===At[1]?(dt=Ae.otherEvent.point)[0]===(At=Ce.otherEvent.point)[0]&&dt[1]===At[1]?0:Ae.contourId>Ce.contourId?1:-1:gt(Ae,Ce)===1?1:-1}var dr=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function qt(Ae,Ce,dt,At){var Jt,Kt=Ae+1,lr=Ce[Ae].point,Er=Ce.length;for(Kt<Er&&(Jt=Ce[Kt].point);Kt<Er&&Jt[0]===lr[0]&&Jt[1]===lr[1];){if(!dt[Kt])return Kt;++Kt<Er&&(Jt=Ce[Kt].point)}for(Kt=Ae-1;dt[Kt]&&Kt>At;)Kt--;return Kt}dr.prototype.isExterior=function(){return this.holeOf==null};var xr=Qt,jr=Qt;function Qt(Ae,Ce){if(!(this instanceof Qt))return new Qt(Ae,Ce);if(this.data=Ae||[],this.length=this.data.length,this.compare=Ce||gr,this.length>0)for(var dt=(this.length>>1)-1;dt>=0;dt--)this._down(dt)}function gr(Ae,Ce){return Ae<Ce?-1:Ae>Ce?1:0}Qt.prototype={push:function(Ae){this.data.push(Ae),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ae=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ae}},peek:function(){return this.data[0]},_up:function(Ae){for(var Ce=this.data,dt=this.compare,At=Ce[Ae];Ae>0;){var Jt=Ae-1>>1,Kt=Ce[Jt];if(dt(At,Kt)>=0)break;Ce[Ae]=Kt,Ae=Jt}Ce[Ae]=At},_down:function(Ae){for(var Ce=this.data,dt=this.compare,At=this.length>>1,Jt=Ce[Ae];Ae<At;){var Kt=1+(Ae<<1),lr=Kt+1,Er=Ce[Kt];if(lr<this.length&&dt(Ce[lr],Er)<0&&(Kt=lr,Er=Ce[lr]),dt(Er,Jt)>=0)break;Ce[Ae]=Er,Ae=Kt}Ce[Ae]=Jt}},xr.default=jr;var Or=Math.max,Vr=Math.min,rn=0;function Gr(Ae,Ce,dt,At,Jt,Kt){var lr,Er,nn,on,tn,Fn;for(lr=0,Er=Ae.length-1;lr<Er;lr++)if(on=Ae[lr+1],tn=new me(nn=Ae[lr],!1,void 0,Ce),Fn=new me(on,!1,tn,Ce),tn.otherEvent=Fn,nn[0]!==on[0]||nn[1]!==on[1]){tn.contourId=Fn.contourId=dt,Kt||(tn.isExteriorRing=!1,Fn.isExteriorRing=!1),gt(tn,Fn)>0?Fn.left=!0:tn.left=!0;var mi=nn[0],en=nn[1];Jt[0]=Vr(Jt[0],mi),Jt[1]=Vr(Jt[1],en),Jt[2]=Or(Jt[2],mi),Jt[3]=Or(Jt[3],en),At.push(tn),At.push(Fn)}}var hr=[];function Wr(Ae,Ce,dt){typeof Ae[0][0][0]=="number"&&(Ae=[Ae]),typeof Ce[0][0][0]=="number"&&(Ce=[Ce]);var At=function(en,Jn,Bn){var bn=null;return en.length*Jn.length==0&&(Bn===z?bn=hr:Bn===q?bn=en:Bn!==H&&Bn!==ne||(bn=en.length===0?Jn:en)),bn}(Ae,Ce,dt);if(At)return At===hr?null:At;var Jt=[1/0,1/0,-1/0,-1/0],Kt=[1/0,1/0,-1/0,-1/0],lr=function(en,Jn,Bn,bn,ri){var ni,qn,Qn,zn,sn,Vn,Si=new xr(null,gt);for(Qn=0,zn=en.length;Qn<zn;Qn++)for(sn=0,Vn=(ni=en[Qn]).length;sn<Vn;sn++)(qn=sn===0)&&rn++,Gr(ni[sn],!0,rn,Si,Bn,qn);for(Qn=0,zn=Jn.length;Qn<zn;Qn++)for(sn=0,Vn=(ni=Jn[Qn]).length;sn<Vn;sn++)qn=sn===0,ri===q&&(qn=!1),qn&&rn++,Gr(ni[sn],!1,rn,Si,bn,qn);return Si}(Ae,Ce,Jt,Kt,dt);if(At=function(en,Jn,Bn,bn,ri){var ni=null;return(Bn[0]>bn[2]||bn[0]>Bn[2]||Bn[1]>bn[3]||bn[1]>Bn[3])&&(ri===z?ni=hr:ri===q?ni=en:ri!==H&&ri!==ne||(ni=en.concat(Jn))),ni}(Ae,Ce,Jt,Kt,dt))return At===hr?null:At;for(var Er=function(en){var Jn,Bn,bn=function(Qn){var zn,sn,Vn,Si,Dr=[];for(sn=0,Vn=Qn.length;sn<Vn;sn++)((zn=Qn[sn]).left&&zn.inResult||!zn.left&&zn.otherEvent.inResult)&&Dr.push(zn);for(var gn=!1;!gn;)for(gn=!0,sn=0,Vn=Dr.length;sn<Vn;sn++)sn+1<Vn&&gt(Dr[sn],Dr[sn+1])===1&&(Si=Dr[sn],Dr[sn]=Dr[sn+1],Dr[sn+1]=Si,gn=!1);for(sn=0,Vn=Dr.length;sn<Vn;sn++)(zn=Dr[sn]).otherPos=sn;for(sn=0,Vn=Dr.length;sn<Vn;sn++)(zn=Dr[sn]).left||(Si=zn.otherPos,zn.otherPos=zn.otherEvent.otherPos,zn.otherEvent.otherPos=Si);return Dr}(en),ri={},ni=[],qn=function(){if(!ri[Jn]){var Qn=ni.length,zn=function(Dr,gn,ii){var Oi=new dr;if(Dr.prevInResult!=null){var hi=Dr.prevInResult,_a=hi.outputContourId;if(hi.resultTransition>0){var Wn=gn[_a];if(Wn.holeOf!=null){var ua=Wn.holeOf;gn[ua].holeIds.push(ii),Oi.holeOf=ua,Oi.depth=gn[_a].depth}else gn[_a].holeIds.push(ii),Oi.holeOf=_a,Oi.depth=gn[_a].depth+1}else Oi.holeOf=null,Oi.depth=gn[_a].depth}else Oi.holeOf=null,Oi.depth=0;return Oi}(bn[Jn],ni,Qn),sn=function(Dr){ri[Dr]=!0,Dr<bn.length&&bn[Dr]&&(bn[Dr].outputContourId=Qn)},Vn=Jn,Si=Jn;for(zn.points.push(bn[Jn].point);sn(Vn),sn(Vn=bn[Vn].otherPos),zn.points.push(bn[Vn].point),!((Vn=qt(Vn,bn,ri,Si))==Si||Vn>=bn.length)&&bn[Vn];);ni.push(zn)}};for(Jn=0,Bn=bn.length;Jn<Bn;Jn++)qn();return ni}(function(en,Jn,Bn,bn,ri,ni){for(var qn,Qn,zn,sn=new p(ir),Vn=[],Si=Math.min(bn[2],ri[2]);en.length!==0;){var Dr=en.pop();if(Vn.push(Dr),ni===z&&Dr.point[0]>Si||ni===q&&Dr.point[0]>bn[2])break;if(Dr.left){Qn=qn=sn.insert(Dr),qn=qn!==(zn=sn.minNode())?sn.prev(qn):null,Qn=sn.next(Qn);var gn=qn?qn.key:null;if(ie(Dr,gn,ni),Qn&&br(Dr,Qn.key,en)===2&&(ie(Dr,gn,ni),ie(Qn.key,Dr,ni)),qn&&br(qn.key,Dr,en)===2){var ii=qn;ie(gn,(ii=ii!==zn?sn.prev(ii):null)?ii.key:null,ni),ie(Dr,gn,ni)}}else Qn=qn=sn.find(Dr=Dr.otherEvent),qn&&Qn&&(qn=qn!==zn?sn.prev(qn):null,Qn=sn.next(Qn),sn.remove(Dr),Qn&&qn&&br(qn.key,Qn.key,en))}return Vn}(lr,0,0,Jt,Kt,dt)),nn=[],on=0;on<Er.length;on++){var tn=Er[on];if(tn.isExterior()){for(var Fn=[tn.points],mi=0;mi<tn.holeIds.length;mi++)Fn.push(Er[tn.holeIds[mi]].points);nn.push(Fn)}}return nn}var dn={UNION:H,DIFFERENCE:q,INTERSECTION:z,XOR:ne};l.diff=function(Ae,Ce){return Wr(Ae,Ce,q)},l.intersection=function(Ae,Ce){return Wr(Ae,Ce,z)},l.operations=dn,l.union=function(Ae,Ce){return Wr(Ae,Ce,H)},l.xor=function(Ae,Ce){return Wr(Ae,Ce,ne)},Object.defineProperty(l,"__esModule",{value:!0})})(a)}(0,QN.exports)),QN.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function FT(c,a,l,f){const p=[],_=f===0?(y,T,A,I,D,F)=>{y.push(new Pt(F,A+(F-T)/(I-T)*(D-A)))}:(y,T,A,I,D,F)=>{y.push(new Pt(T+(F-A)/(D-A)*(I-T),F))};for(const y of c){const T=[];for(const A of y){if(A.length<=2)continue;const I=[];for(let z=0;z<A.length-1;z++){const H=A[z].x,q=A[z].y,ne=A[z+1].x,ie=A[z+1].y,ae=f===0?H:q,me=f===0?ne:ie;ae<a?me>a&&_(I,H,q,ne,ie,a):ae>l?me<l&&_(I,H,q,ne,ie,l):I.push(A[z]),me<a&&ae>=a&&_(I,H,q,ne,ie,a),me>l&&ae<=l&&_(I,H,q,ne,ie,l)}let D=A[A.length-1];const F=f===0?D.x:D.y;F>=a&&F<=l&&I.push(D),I.length&&(D=I[I.length-1],I[0].x===D.x&&I[0].y===D.y||I.push(I[0]),T.push(I))}T.length&&p.push(T)}return p}function Fte(c,a){const l=uk(c),f=uk([a]),p=eB.intersection(l,f);return p==null?[]:tB(p)}function Lte(c,a){let f=uk(c,65536);const p=[];for(;a.valid();a.next()){const[_,y]=a.get(),T=_.x*65536,A=_.y*65536,I=y.x*65536,D=y.y*65536,F=I-T,z=D-A,H=Math.hypot(F,z);if(H===0)continue;const q=Math.trunc(z/H*3),ne=-Math.trunc(F/H*3);p.push([[[T,A],[I,D],[I+q,D+ne],[T+q,A+ne],[T,A]]])}return p.length>0&&(f=eB.diff(f,p)),tB(f,1/65536)}function uk(c,a=1){return[c.map(l=>l.map(f=>[f.x*a,f.y*a]))]}function tB(c,a=1){return c.map(l=>l.map((f,p)=>{const _=f.map(y=>new Pt(y[0]*a,y[1]*a).round());return p>0&&_.reverse(),_}))}class hk{constructor(a,l){this.layoutVertexArray=new Hu,this.indexArray=new Ta,this.lineIndexArray=new ma,this.triangleSegments=new Ti,this.lineSegments=new Ti,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new qu)}update(a,l,f,p,_,y,T,A){this.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,A)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,xte.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.lineIndexBuffer=a.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=a.createVertexBuffer(this.elevatedLayoutVertexArray,wte.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(a,l,f,p,_,y,T){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,l,f,p,_,y,void 0,T)}}class fk{constructor(a){this.zoom=a.zoom,this.pixelRatio=a.pixelRatio,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=a.lut,this.bufferData=new hk(a,!1),this.elevationBufferData=new hk(a,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=a.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=a.sourceLayerIndex,this.worldview=a.worldview}updateFootprints(a,l){}populate(a,l,f,p){this.hasPattern=lk("fill",this.layers,this.pixelRatio,l);const _=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:T,id:A,index:I,sourceLayerIndex:D}of a){const F=this.layers[0]._featureFilter.needGeometry,z=Ut(T,F);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),z,f))continue;const H=_?_.evaluate(z,{},f,l.availableImages):void 0,q={id:A,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:F?z.geometry:tr(T,f,p),patterns:{},sortKey:H};y.push(q)}_&&y.sort((T,A)=>T.sortKey-A.sortKey);for(const T of y){const{geometry:A,index:I,sourceLayerIndex:D}=T;if(this.hasPattern){const F=ck("fill",this.layers,T,this.zoom,this.pixelRatio,l);this.patternFeatures.push(F)}else this.addFeature(T,A,I,f,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(a[I].feature,A,I,D,this.index)}}update(a,l,f,p,_,y,T){this.bufferData.update(a,l,f,p,_,y,T,this.worldview),this.elevationBufferData.update(a,l,f,p,_,y,T,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(a,l,f,p,_,y,T,this.worldview)}addFeatures(a,l,f,p,_,y){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,l,f,p,y,a.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(a){this.bufferData.upload(a),this.elevationBufferData.upload(a),this.elevatedStructures&&this.elevatedStructures.upload(a)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(a,l,f,p,_,y=[],T,A){const I=Zx(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(a,I,p,f,A):this.addGeometry(I,this.bufferData),this.bufferData.populatePaintArrays(a,f,_,y,p,T,this.worldview),this.elevationBufferData.populatePaintArrays(a,f,_,y,p,T,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(a,l,f,p,_){this.elevatedStructures&&(this.elevatedStructures.construct(a),this.elevatedStructures.populatePaintArrays(l,f,p,_,this.worldview))}addElevatedRoadFeature(a,l,f,p,_){const y=new Array,T=vi.getElevationFeature(a,_);if(!T)return void this.addGeometry(l,this.bufferData);{const I=this.clipPolygonsToTile(l,1);I.length>0&&y.push({polygons:I,elevationFeature:T,elevationTileID:f})}const A={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(a,{},f),featureIndex:p};for(const I of y)if(I.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Hs(I.elevationTileID,this.layers,this.zoom,this.lut));const F=I.elevationFeature.isTunnel();let z=0;a.properties.hasOwnProperty(Rn)&&(z=+a.properties[Rn]);for(const H of I.polygons)this.elevatedStructures.addPortalCandidates(I.elevationFeature.id,H,F,I.elevationFeature,z)}I.elevationFeature.constantHeight==null&&(I.polygons=this.prepareElevatedPolygons(I.polygons,I.elevationFeature,I.elevationTileID));const D=new oa(f,I.elevationTileID);this.addElevatedGeometry(I.polygons,D,I.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p,A)}}addElevatedGeometry(a,l,f,p,_,y){const T={elevation:f,elevationSampler:l,bias:p,index:_,featureInfo:y},[A,I]=this.addGeometry(a,this.elevationBufferData,T);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:A,max:I}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,A),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,I))}addGeometry(a,l,f){let p=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,y=null;f&&(y=f.elevationSampler.constantElevation(f.elevation,f.bias),y!=null&&(p=y,_=y));const T=(A,I,D)=>{if(f!=null)if(I.push(A),y!=null)l.elevatedLayoutVertexArray.emplaceBack(y),D.push(y);else{const F=f.elevationSampler.pointElevation(A,f.elevation,f.bias);l.elevatedLayoutVertexArray.emplaceBack(F),D.push(F),p=Math.min(p,F),_=Math.max(_,F)}};for(const A of a){let I=0;for(const ye of A)I+=ye.length;const D=l.triangleSegments.prepareSegment(I,l.layoutVertexArray,l.indexArray),F=D.vertexLength,z=[],H=[],q=[],ne=[],ie=[],ae=l.layoutVertexArray.length;for(const ye of A){if(ye.length===0)continue;ye!==A[0]&&H.push(z.length/2);const we=l.lineSegments.prepareSegment(ye.length,l.layoutVertexArray,l.lineIndexArray),Be=we.vertexLength;f&&ie.push(l.layoutVertexArray.length-ae),T(ye[0],q,ne),l.layoutVertexArray.emplaceBack(ye[0].x,ye[0].y),l.lineIndexArray.emplaceBack(Be+ye.length-1,Be),z.push(ye[0].x),z.push(ye[0].y);for(let ze=1;ze<ye.length;ze++)T(ye[ze],q,ne),l.layoutVertexArray.emplaceBack(ye[ze].x,ye[ze].y),l.lineIndexArray.emplaceBack(Be+ze-1,Be+ze),z.push(ye[ze].x),z.push(ye[ze].y);we.vertexLength+=ye.length,we.primitiveLength+=ye.length}const me=a_(z,H);for(let ye=0;ye<me.length;ye+=3)l.indexArray.emplaceBack(F+me[ye],F+me[ye+1],F+me[ye+2]);if(me.length>0&&f&&this.elevationMode==="hd-road-base"){const ye=f.elevation.isTunnel(),we=f.elevation.safeArea,Be=this.elevatedStructures.addVertices(q,ne);this.elevatedStructures.addTriangles(me,Be,ye);const ze=ie.length;if(ze>0){for(let Ve=0;Ve<ze-1;Ve++)this.elevatedStructures.addRenderableRing(f.index,ie[Ve]+Be,ie[Ve+1]-ie[Ve],ye,we,f.featureInfo);this.elevatedStructures.addRenderableRing(f.index,ie[ze-1]+Be,q.length-ie[ze-1],ye,we,f.featureInfo)}}D.vertexLength+=I,D.primitiveLength+=me.length/3}return[p,_]}prepareElevatedPolygons(a,l,f){const p=1/st(f),_=[];for(const y of a){const T=Lte(y,new Dn(l,p));_.push(...T)}return _}clipPolygonsToTile(a,l){const f=-l,p=-l,_=Zt+l,y=Zt+l;let T=0;const A=[],I=[];for(;T<a.length;T++){const z=a[T],H=cg(z);(H.min.x>=f&&H.max.x<=_&&H.min.y>=p&&H.max.y<=y?A:I).push(z)}if(A.length===a.length)return a;const D=[new Pt(f,p),new Pt(_,p),new Pt(_,y),new Pt(f,y),new Pt(f,p)],F=A;for(const z of I)F.push(...Fte(z,D));return F}}let rB,nB,iB,aB;sr(fk,"FillBucket",{omit:["layers","patternFeatures"]}),sr(hk,"FillBufferData"),sr(Hs,"ElevatedStructures");class LT{constructor(a,l,f,p){if(this.triangleCount=l.length/3,this.min=new Pt(0,0),this.max=new Pt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||a.length===0)return;const[_,y]=[a[0].clone(),a[0].clone()];for(let F=1;F<a.length;++F){const z=a[F];_.x=Math.min(_.x,z.x),_.y=Math.min(_.y,z.y),y.x=Math.max(y.x,z.x),y.y=Math.max(y.y,z.y)}if(p){const F=Math.ceil(Math.max(y.x-_.x,y.y-_.y)/p);f=Math.max(f,F)}if(f===0)return;this.min=_,this.max=y;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const A=Math.max(T.x,T.y)/f;this.cellsX=Math.max(1,Math.ceil(T.x/A)),this.cellsY=Math.max(1,Math.ceil(T.y/A)),this.xScale=1/A,this.yScale=1/A;const I=[];for(let F=0;F<this.triangleCount;F++){const z=a[l[3*F+0]].sub(this.min),H=a[l[3*F+1]].sub(this.min),q=a[l[3*F+2]].sub(this.min),ne=Qu(Math.floor(Math.min(z.x,H.x,q.x)),this.xScale,this.cellsX),ie=Qu(Math.floor(Math.max(z.x,H.x,q.x)),this.xScale,this.cellsX),ae=Qu(Math.floor(Math.min(z.y,H.y,q.y)),this.yScale,this.cellsY),me=Qu(Math.floor(Math.max(z.y,H.y,q.y)),this.yScale,this.cellsY),ye=new Pt(0,0),we=new Pt(0,0),Be=new Pt(0,0),ze=new Pt(0,0);for(let Ve=ae;Ve<=me;++Ve){ye.y=we.y=Ve*A,Be.y=ze.y=(Ve+1)*A;for(let Ze=ne;Ze<=ie;++Ze)ye.x=Be.x=Ze*A,we.x=ze.x=(Ze+1)*A,(qc(z,H,q,ye,we,ze)||qc(z,H,q,ye,ze,Be))&&I.push({cellIdx:Ve*this.cellsX+Ze,triIdx:F})}}if(I.length===0)return;I.sort((F,z)=>F.cellIdx-z.cellIdx||F.triIdx-z.triIdx);let D=0;for(;D<I.length;){const F=I[D].cellIdx,z={start:this.payload.length,len:0};for(;D<I.length&&I[D].cellIdx===F;)++z.len,this.payload.push(I[D++].triIdx);this.cells[F]=z}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(a,l){if(this.triangleCount===0||this.cells.length===0||a.x>this.max.x||this.min.x>a.x||a.y>this.max.y||this.min.y>a.y)return;const f=Qu(a.x-this.min.x,this.xScale,this.cellsX),p=Qu(a.y-this.min.y,this.yScale,this.cellsY),_=this.cells[p*this.cellsX+f];if(_){this._lazyInitLookup();for(let y=0;y<_.len;y++){const T=this.payload[_.start+y],A=Math.floor(T/8),I=1<<T%8;if(!(this.lookup[A]&I)&&(this.lookup[A]|=I,l.push(T),l.length===this.triangleCount))return}}}query(a,l,f){if(this.triangleCount===0||this.cells.length===0||a.x>this.max.x||this.min.x>l.x||a.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const p=Qu(a.x-this.min.x,this.xScale,this.cellsX),_=Qu(l.x-this.min.x,this.xScale,this.cellsX),y=Qu(a.y-this.min.y,this.yScale,this.cellsY),T=Qu(l.y-this.min.y,this.yScale,this.cellsY);for(let A=y;A<=T;A++)for(let I=p;I<=_;I++){const D=this.cells[A*this.cellsX+I];if(D)for(let F=0;F<D.len;F++){const z=this.payload[D.start+F],H=Math.floor(z/8),q=1<<z%8;if(!(this.lookup[H]&q)&&(this.lookup[H]|=q,f.push(z),f.length===this.triangleCount))return}}}}function Qu(c,a,l){return Math.max(0,Math.min(l-1,Math.floor(c*a)))}sr(LT,"TriangleGridIndex");class oB{constructor(a){this.zoom=a.zoom,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[],this.worldview=a.worldview}updateFootprints(a,l){for(const f of this.footprints)l.push({footprint:f,id:a})}populate(a,l,f,p){const _=[];for(const{feature:y,id:T,index:A,sourceLayerIndex:I}of a){const D=this.layers[0]._featureFilter.needGeometry,F=Ut(y,D);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),F,f))continue;const z={id:T,properties:y.properties,type:y.type,sourceLayerIndex:I,index:A,geometry:D?F.geometry:tr(y,f,p),patterns:{}};_.push(z)}for(const y of _){const{geometry:T,index:A,sourceLayerIndex:I}=y;this.addFeature(y,T,A,f,{},l.availableImages,l.brightness),l.featureIndex.insert(a[A].feature,T,A,I,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(a){}update(a,l,f,p,_,y,T){}destroy(){}addFeature(a,l,f,p,_,y=[],T){for(const A of Zx(l,2)){const I=[],D=[],F=[],z=new Pt(1/0,1/0),H=new Pt(-1/0,-1/0);for(const ie of A)if(ie.length!==0){ie!==A[0]&&F.push(D.length/2);for(let ae=0;ae<ie.length;ae++)D.push(ie[ae].x),D.push(ie[ae].y),I.push(ie[ae]),z.x=Math.min(z.x,ie[ae].x),z.y=Math.min(z.y,ie[ae].y),H.x=Math.max(H.x,ie[ae].x),H.y=Math.max(H.y,ie[ae].y)}const q=a_(D,F),ne=new LT(I,q,8,256);this.footprints.push({vertices:I,indices:q,grid:ne,min:z,max:H})}}}sr(oB,"ClipBucket",{omit:["layers"]});const Nte=fn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Bte=fn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),zte=fn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jte=fn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Ute=fn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),$te=fn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Vte}=Nte,Yx=Number.MAX_SAFE_INTEGER,sB=Yx-1;function lB(c,a,l,f){return c.order<a||c.order===Yx||!(c.clipMask&l)||function(p,_){return _.length!==0&&_.find(y=>y===p)===void 0}(f,c.clipScope)}function NT(c,a){return c.x-a.x||c.y-a.y}function cB(c,a){return NT(c.min,a.min)===0&&NT(c.max,a.max)===0}function dk(c,a){return!(c.min.x>a.max.x||c.max.x<a.min.x||c.min.y>a.max.y||c.max.y<a.min.y)}function BT(c,a){if(c.length!==a.length)return!1;for(let l=0;l<c.length;l++)if(c[l].sourceId!==a[l].sourceId||!cB(c[l],a[l])||c[l].order!==a[l].order||c[l].clipMask!==a[l].clipMask||!si(c[l].clipScope,a[l].clipScope))return!1;return!0}function uB(c,a,l){const f=1/Zt,p=1/(1<<l.canonical.z),_=(a.x*f+l.canonical.x)*p+l.wrap,y=(a.y*f+l.canonical.y)*p;return{min:new Pt((c.x*f+l.canonical.x)*p+l.wrap,(c.y*f+l.canonical.y)*p),max:new Pt(_,y)}}function Wte(c,a,l){const f=1<<l.canonical.z,p=((a.x-l.wrap)*f-l.canonical.x)*Zt,_=(a.y*f-l.canonical.y)*Zt;return{min:new Pt(((c.x-l.wrap)*f-l.canonical.x)*Zt,(c.y*f-l.canonical.y)*Zt),max:new Pt(p,_)}}function pk(c,a,l,f,p,_,y){const T=c.indices,A=c.vertices,I=[];for(let D=f;D<f+p;D+=3){const F=a[l[D+0]+_],z=a[l[D+1]+_],H=a[l[D+2]+_],q=Math.min(F.x,z.x,H.x),ne=Math.max(F.x,z.x,H.x),ie=Math.min(F.y,z.y,H.y),ae=Math.max(F.y,z.y,H.y);I.length=0,c.grid.query(new Pt(q,ie),new Pt(ne,ae),I);for(let me=0;me<I.length;me++){const ye=I[me];if(qc(A[T[3*ye+0]],A[T[3*ye+1]],A[T[3*ye+2]],F,z,H,y))return!0}}return!1}function hB(c,a,l,f){if(!c||!l)return!1;let p=c.vertices;if(!a.canonical.equals(f.canonical)||a.wrap!==f.wrap){if(l.vertices.length<c.vertices.length)return hB(l,f,c,a);const _=a.canonical,y=f.canonical,T=Math.pow(2,y.z-_.z);p=c.vertices.map(A=>new Pt((A.x+_.x*Zt)*T-y.x*Zt,(A.y+_.y*Zt)*T-y.y*Zt))}return pk(l,p,c.indices,0,c.indices.length,0,0)}function fB(c,a,l,f){const p=Math.pow(2,f.z-l.z);return new Pt((c+l.x*Zt)*p-f.x*Zt,(a+l.y*Zt)*p-f.y*Zt)}function mk(c,a){const l=[];a.grid.queryPoint(c,l);const f=a.indices,p=a.vertices;for(let _=0;_<l.length;_++){const y=l[_];if(Na([p[f[3*y+0]],p[f[3*y+1]],p[f[3*y+2]]],c))return!0}return!1}const gk=[new Pt(0,0),new Pt(Zt,0),new Pt(Zt,Zt),new Pt(0,Zt)];function dB(c,a){const l=[];let f=[];if(!a||c.length<2)return[c];if(c.length===2)return ho(c[0],c[1],gk)?[c]:[];for(let p=0;p<c.length+2;p++){const _=c[p%c.length],y=c[(p+1)%c.length],T=ho(p===0?c[c.length-1]:c[(p-1)%c.length],_,gk),A=ho(_,y,gk),I=T||A;I&&f.push(_),I&&A||f.length>0&&(f.length>1&&l.push(f),f=[])}return f.length>1&&l.push(f),l}const _k=Bt.types,Gte=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Hte=["fill-extrusion-flood-light-ground-radius"],qte=Math.pow(2,13),Xte=Math.pow(2,15)-1,pB=new Pt(0,1),Pd=2147483648;function Kx(c,a,l,f,p,_,y,T){c.emplaceBack((a<<1)+y,(l<<1)+_,(Math.floor(f*qte)<<1)+p,Math.round(T))}function Jx(c,a,l){c.emplaceBack(a.x*Zt,a.y*Zt,l?1:0)}function zT(c,a,l,f,p,_){c.emplaceBack(a.x,a.y,(l.x<<1)+f,(l.y<<1)+p,_)}function Qx(c,a,l){c.emplaceBack(a.x,a.y,a.z,l[0]*16384,l[1]*16384,l[2]*16384)}class mB{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class gB{constructor(){this.centroidXY=new Pt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Pt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Pt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new Pt(this.max.x-this.min.x,this.max.y-this.min.y)}}class _B{constructor(){this.acc=new Pt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(a,l){a.min.x===Number.MAX_VALUE&&(a.min.x=a.max.x=l.x,a.min.y=a.max.y=l.y)}appendEdge(a,l,f){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<a.min.x?(a.min.x=l.x,p=!0):l.x>a.max.x&&(a.max.x=l.x,p=!0),l.y<a.min.y?(a.min.y=l.y,p=!0):l.y>a.max.y&&(a.max.y=l.y,p=!0),((l.x===0||l.x===Zt)&&l.x===f.x)!=((l.y===0||l.y===Zt)&&l.y===f.y)&&this.processBorderOverlap(l,f),p&&this.checkBorderIntersection(l,f)}checkBorderIntersection(a,l){l.x<0!=a.x<0&&this.addBorderIntersection(0,Ir(l.y,a.y,(0-l.x)/(a.x-l.x))),l.x>Zt!=a.x>Zt&&this.addBorderIntersection(1,Ir(l.y,a.y,(Zt-l.x)/(a.x-l.x))),l.y<0!=a.y<0&&this.addBorderIntersection(2,Ir(l.x,a.x,(0-l.y)/(a.y-l.y))),l.y>Zt!=a.y>Zt&&this.addBorderIntersection(3,Ir(l.x,a.x,(Zt-l.y)/(a.y-l.y)))}addBorderIntersection(a,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[a];l<f[0]&&(f[0]=l),l>f[1]&&(f[1]=l)}processBorderOverlap(a,l){if(a.x===l.x){if(a.y===l.y)return;const f=a.x===0?0:1;this.addBorderIntersection(f,l.y),this.addBorderIntersection(f,a.y)}else{const f=a.y===0?2:3;this.addBorderIntersection(f,l.x),this.addBorderIntersection(f,a.x)}}centroid(){return this.accCount===0?new Pt(0,0):new Pt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((a,l)=>a+ +(l[0]!==Number.MAX_VALUE),0):0}}function yB(c,a){const l=c.add(a)._unit(),f=Q(c.x*l.x+c.y*l.y,-1,1);var p,_,y;return p=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(p)))/4*Xte*((_=c).x*(y=a).y-_.y*y.x<0?-1:1)}const Zte=[c=>c.x<0,c=>c.x>Zt,c=>c.y<0,c=>c.y>Zt];function Yte(c,a,l,f){const p=[4];if(f===0)return p;l._mult(f);const _=c.sub(l),y=a.sub(l),T=[c,a,_,y];for(let A=0;A<4;A++)for(const I of T)if(Zte[A](I)){p.push(A);break}return p}class yk{constructor(a){this.vertexArray=new Ox,this.indexArray=new Ta,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut},l=>Hte.includes(l)),this._segments=new Ti,this.hiddenByLandmarkVertexArray=new Qg,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ti}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(a,l,f,p=!1){const _=a.length;if(_>2){let y=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*_,this.vertexArray.length,2*this._segmentToGroundQuads[y].length);let A;y!==this._segments.get().length-1&&(y++,this._segmentToGroundQuads[y]=[],this._segmentToRegionTriCounts[y]=[0,0,0,0,0]);{const I=a[0],D=a[1];A=yB(I.sub(a[_-1])._perp()._unit(),D.sub(I)._perp()._unit())}for(let I=0;I<_;I++){const D=I===_-1?0:I+1,F=a[I],z=a[D],H=a[D===_-1?0:D+1],q=z.sub(F)._perp()._unit(),ne=yB(q,H.sub(z)._perp()._unit()),ie=A,ae=ne;if(vk(F,z,l)||p&&wB(F,l)&&wB(z,l)){A=ne;continue}const me=T.vertexLength;zT(this.vertexArray,F,z,1,1,ie),zT(this.vertexArray,F,z,1,0,ie),zT(this.vertexArray,F,z,0,1,ae),zT(this.vertexArray,F,z,0,0,ae),T.vertexLength+=4;const ye=Yte(F,z,q,f);for(const we of ye)this._segmentToGroundQuads[y].push({id:me,region:we}),this._segmentToRegionTriCounts[y][we]+=2,T.primitiveLength+=2;A=ne}}}prepareBorderSegments(){if(!this.hasData())return;const a=this._segments.get(),l=a.length;for(let f=0;f<l;f++)this._segmentToGroundQuads[f].sort((p,_)=>p.region-_.region);for(let f=0;f<l;f++){const p=this._segmentToGroundQuads[f],_=a[f],y=this._segmentToRegionTriCounts[f];y.reduce((A,I)=>A+I,0);let T=0;for(let A=0;A<=4;A++){const I=y[A];if(I!==0){let D=this.regionSegments[A];D||(D=this.regionSegments[A]=new Ti);const F={vertexOffset:_.vertexOffset,primitiveOffset:_.primitiveOffset+T,vertexLength:_.vertexLength,primitiveLength:I};D.get().push(F)}T+=I}for(let A=0;A<p.length;A++){const I=p[A].id;this.indexArray.emplaceBack(I,I+1,I+3),this.indexArray.emplaceBack(I,I+3,I+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(a,l,f,p,_,y,T){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,a,l,f,p,_,y,void 0,T)}upload(a){this.hasData()&&(this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Bte.members),this.indexBuffer=a.createIndexBuffer(this.indexArray))}uploadPaintProperties(a){this.hasData()&&this.programConfigurations.upload(a)}update(a,l,f,p,_,y,T,A){this.hasData()&&this.programConfigurations.updatePaintArrays(a,l,f,p,_,y,T,A)}updateHiddenByLandmark(a){this.updateHiddenByLandmarkRange(a.groundVertexArrayOffset,a.groundVertexCount,!!(a.flags&Pd))}updateHiddenByLandmarkRange(a,l,f){if(!this.hasData())return;const p=l+a;if(l!==0){for(let _=a;_<p;++_)this.hiddenByLandmarkVertexArray.emplace(_,f?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(a){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=a.createVertexBuffer(this.hiddenByLandmarkVertexArray,Ute.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let a=0;a<=4;a++){const l=this.regionSegments[a];l&&l.destroy()}}}}class jT{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.pixelRatio=a.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ta,this.footprintVertices=new Hu,this.footprintSegments=[],this.layoutVertexArray=new tf,this.centroidVertexArray=new TT,this.wallVertexArray=new ET,this.indexArray=new Ta,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut},l=>Gte.includes(l)),this.segments=new Ti,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new yk(a),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=a.worldview}updateFootprints(a,l){}populate(a,l,f,p){this.features=[],this.hasPattern=lk("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=st(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:_,id:y,index:T,sourceLayerIndex:A}of a){const I=this.layers[0]._featureFilter.needGeometry,D=Ut(_,I);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),D,f))continue;const F={id:y,sourceLayerIndex:A,index:T,geometry:I?D.geometry:tr(_,f,p),properties:_.properties,type:_.type,patterns:{}},z=this.layoutVertexArray.length,H=_k[F.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:_.id,feature:ck("fill-extrusion",this.layers,F,this.zoom,this.pixelRatio,l)});else if(this.wallMode)for(const q of F.geometry)for(const ne of dB(q,H))this.addFeature(_.id,F,[ne],T,f,{},l.availableImages,p,l.brightness);else this.addFeature(_.id,F,F.geometry,T,f,{},l.availableImages,p,l.brightness);l.featureIndex.insert(_,F.geometry,T,A,this.index,z)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(a,l,f,p,_,y){for(const{featureId:T,feature:A}of this.features){const I=_k[A.type]==="Polygon",{geometry:D}=A;if(this.wallMode)for(const F of D)for(const z of dB(F,I))this.addFeature(T,A,[z],A.index,l,f,p,_,y);else this.addFeature(T,A,D,A.index,l,f,p,_,y)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(a,l,f,p,_,y,T){this.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,this.worldview),this.groundEffect.update(a,l,_,f,p,y,T,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Vte),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.wallVertexBuffer=a.createVertexBuffer(this.wallVertexArray,jte.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,$te.members,!0)),this.groundEffect.upload(a)),this.groundEffect.uploadPaintProperties(a),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.groundEffect.uploadHiddenByLandmark(a),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,zte.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,l,f,p,_,y,T,A,I){const D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(l,{})/this.tileToMeter,F=[new Pt(0,0),new Pt(Zt,Zt)],z=A.projection,H=z.name==="globe",q=this.wallMode||_k[l.type]==="Polygon",ne=new _B;ne.centroidDataIndex=this.centroidData.length;const ie=new gB;ie.buildingId=a,l.properties&&l.properties.hasOwnProperty("building_id")&&(ie.buildingId=l.properties.building_id);const ae=this.layers[0].paint.get("fill-extrusion-base").evaluate(l,{},_)<=0,me=this.layers[0].paint.get("fill-extrusion-height").evaluate(l,{},_);let ye;if(ie.height=me,ie.vertexArrayOffset=this.layoutVertexArray.length,ie.groundVertexArrayOffset=this.groundEffect.vertexArray.length,H&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xg),this.wallMode){if(H)return void nr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(f.length!==1)return;ye=function(nt){const kt=nt[0].x===nt[nt.length-1].x&&nt[0].y===nt[nt.length-1].y;(function(qt){let xr=0;const jr=qt.length;for(let Qt=0;Qt<jr;Qt++)xr+=(qt[(Qt+1)%jr].x-qt[Qt].x)*(qt[(Qt+1)%jr].y+qt[Qt].y);return xr>=0})(nt)||(nt=nt.reverse());const Ot={geometry:[],joinNormals:[],indices:[]},Lt=[],$t=[],Et=[];let Nt=nt.length;for(;Nt>=2&&nt[Nt-1].equals(nt[Nt-2]);)Nt--;if(Nt<(kt?3:2))return Ot;let gt,ut,Vt,jt,br,ir=0;for(;ir<Nt-1&&nt[ir].equals(nt[ir+1]);)ir++;kt&&(gt=nt[Nt-2],br=nt[ir].sub(gt)._unit()._perp());for(let qt=ir;qt<Nt;qt++){if(Vt=qt===Nt-1?kt?nt[ir+1]:void 0:nt[qt+1],Vt&&nt[qt].equals(Vt))continue;br&&(jt=br),gt&&(ut=gt),gt=nt[qt],br=Vt?Vt.sub(gt)._unit()._perp():jt,jt=jt||br;let xr=jt.add(br);xr.x===0&&xr.y===0||xr._unit();const jr=xr.x*br.x+xr.y*br.y,Qt=jr!==0?1/jr:1/0,gr=jt.x*br.y-jt.y*br.x>0;let Or="miter";const Vr=2;Or==="miter"&&Qt>Vr&&(Or="bevel"),Or==="bevel"&&(Qt>100&&(Or="flipbevel"),Qt<Vr&&(Or="miter"));const rn=(Gr,hr,Wr,dn)=>{const Ae=new Pt(Gr.x,Gr.y),Ce=new Pt(Gr.x,Gr.y);Ae.x+=hr.x*dn,Ae.y+=hr.y*dn,Ce.x-=hr.x*Math.max(Wr,1),Ce.y-=hr.y*Math.max(Wr,1),Et.push(hr),Lt.push(Ae),$t.push(Ce)};if(Or==="miter")xr._mult(Qt),rn(gt,xr,0,0);else if(Or==="flipbevel")xr=br.mult(-1),rn(gt,xr,0,0),rn(gt,xr.mult(-1),0,0);else{const Gr=-Math.sqrt(Qt*Qt-1),hr=gr?Gr:0,Wr=gr?0:Gr;ut&&rn(gt,jt,hr,Wr),Vt&&rn(gt,br,hr,Wr)}}Ot.geometry=[...Lt,...$t.reverse(),Lt[0]],Ot.joinNormals=[...Et,...Et.reverse(),Et[Et.length-1]];const dr=Ot.geometry.length-1;for(let qt=0;qt<dr/2;qt++)if(qt+1<dr/2){let xr=qt,jr=qt+1,Qt=dr-1-qt,gr=dr-2-qt;xr=xr===0?dr-1:xr-1,jr=jr===0?dr-1:jr-1,Qt=Qt===0?dr-1:Qt-1,gr=gr===0?dr-1:gr-1,Ot.indices.push(Qt),Ot.indices.push(jr),Ot.indices.push(xr),Ot.indices.push(Qt),Ot.indices.push(gr),Ot.indices.push(jr)}return Ot}(f[0]),f=[ye.geometry]}const we=(nt,kt)=>nt<(kt.length-1)/2||nt===kt.length-1,Be=this.wallMode?[f]:Zx(f,500);for(let nt=Be.length-1;nt>=0;nt--){const kt=Be[nt];(kt.length===0||(ze=kt[0]).every(zt=>zt.x<=0)||ze.every(zt=>zt.x>=Zt)||ze.every(zt=>zt.y<=0)||ze.every(zt=>zt.y>=Zt))&&Be.splice(nt,1)}var ze;let Ve;if(H)Ve=EB(Be,F,_);else{Ve=[];for(const nt of Be)Ve.push({polygon:nt,bounds:F})}const Ze=q?this.edgeRadius:0,Ye=Ze>0&&this.zoom<17,Ct=(nt,kt)=>{if(nt.length===0)return!1;const zt=nt[nt.length-1];return kt.x===zt.x&&kt.y===zt.y};for(const{polygon:nt,bounds:kt}of Ve){let zt=0,Ot=0;for(const Nt of nt)q&&!Nt[0].equals(Nt[Nt.length-1])&&Nt.push(Nt[0]),Ot+=q?Nt.length-1:Nt.length;const Lt=this.segments.prepareSegment((q?5:4)*Ot,this.layoutVertexArray,this.indexArray);ie.footprintSegIdx<0&&(ie.footprintSegIdx=this.footprintSegments.length),ie.polygonSegIdx<0&&(ie.polygonSegIdx=this.polygonSegments.length);const $t={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Et=new mB;if(Et.vertexOffset=this.footprintVertices.length,Et.indexOffset=3*this.footprintIndices.length,Et.ringIndices=[],q){const Nt=[],gt=[];zt=Lt.vertexLength;for(let Vt=0;Vt<nt.length;Vt++){const jt=nt[Vt];jt.length&&Vt!==0&&gt.push(Nt.length/2);const br=[];let ir,dr;ir=jt[1].sub(jt[0])._perp()._unit(),Et.ringIndices.push(jt.length-1);for(let qt=1;qt<jt.length;qt++){const xr=jt[qt],jr=jt[qt===jt.length-1?1:qt+1],Qt=xr.clone();if(Ze){dr=jr.sub(xr)._perp()._unit();const gr=ir.add(dr)._unit(),Or=Ze*Math.min(4,1/(ir.x*gr.x+ir.y*gr.y));Qt.x+=Or*gr.x,Qt.y+=Or*gr.y,Qt.x=Math.round(Qt.x),Qt.y=Math.round(Qt.y),ir=dr}if(!ae||Ze!==0&&!Ye||Ct(br,Qt)||br.push(Qt),Kx(this.layoutVertexArray,Qt.x,Qt.y,0,0,1,1,0),this.wallMode){const gr=we(qt,jt);Jx(this.wallVertexArray,ye.joinNormals[qt],!gr)}Lt.vertexLength++,this.footprintVertices.emplaceBack(xr.x,xr.y),Nt.push(xr.x,xr.y),H&&Qx(this.layoutVertexExtArray,z.projectTilePoint(Qt.x,Qt.y,_),z.upVector(_,Qt.x,Qt.y))}ae&&(Ze===0||Ye)&&(br.length!==0&&Ct(br,br[0])&&br.pop(),this.groundEffect.addData(br,kt,D))}const ut=this.wallMode?ye.indices:a_(Nt,gt);for(let Vt=0;Vt<ut.length;Vt+=3)this.footprintIndices.emplaceBack(Et.vertexOffset+ut[Vt+0],Et.vertexOffset+ut[Vt+1],Et.vertexOffset+ut[Vt+2]),this.indexArray.emplaceBack(zt+ut[Vt],zt+ut[Vt+2],zt+ut[Vt+1]),Lt.primitiveLength++;Et.indexCount+=ut.length,Et.vertexCount+=this.footprintVertices.length-Et.vertexOffset}for(let Nt=0;Nt<nt.length;Nt++){const gt=nt[Nt];ne.startRing(ie,gt[0]);let ut=gt.length>4&&bB(gt[gt.length-2],gt[0],gt[1]),Vt=Ze?Kte(gt[gt.length-2],gt[0],gt[1],Ze):0;const jt=[];let br,ir,dr;ir=gt[1].sub(gt[0])._perp()._unit();let qt=!0;for(let xr=1,jr=0;xr<gt.length;xr++){let Qt=gt[xr-1],gr=gt[xr];const Or=gt[xr===gt.length-1?1:xr+1];if(ne.appendEdge(ie,gr,Qt),vk(gr,Qt,kt)){Ze&&(ir=Or.sub(gr)._perp()._unit(),qt=!qt);continue}const Vr=gr.sub(Qt)._perp(),rn=Vr.x/(Math.abs(Vr.x)+Math.abs(Vr.y)),Gr=Vr.y>0?1:0,hr=Qt.dist(gr);if(jr+hr>32768&&(jr=0),Ze){dr=Or.sub(gr)._perp()._unit();let Ce=xB(Qt,gr,Or,vB(ir,dr),Ze);isNaN(Ce)&&(Ce=0);const dt=gr.sub(Qt)._unit();Qt=Qt.add(dt.mult(Vt))._round(),gr=gr.add(dt.mult(-Ce))._round(),Vt=Ce,ir=dr,ae&&this.zoom>=17&&(Ct(jt,Qt)||jt.push(Qt),Ct(jt,gr)||jt.push(gr))}const Wr=Lt.vertexLength,dn=gt.length>4&&bB(Qt,gr,Or);let Ae=TB(jr,ut,qt);if(Kx(this.layoutVertexArray,Qt.x,Qt.y,rn,Gr,0,0,Ae),Kx(this.layoutVertexArray,Qt.x,Qt.y,rn,Gr,0,1,Ae),this.wallMode){const Ce=we(xr-1,gt),dt=ye.joinNormals[xr-1];Jx(this.wallVertexArray,dt,Ce),Jx(this.wallVertexArray,dt,Ce)}if(jr+=hr,Ae=TB(jr,dn,!qt),ut=dn,Kx(this.layoutVertexArray,gr.x,gr.y,rn,Gr,0,0,Ae),Kx(this.layoutVertexArray,gr.x,gr.y,rn,Gr,0,1,Ae),this.wallMode){const Ce=we(xr,gt),dt=ye.joinNormals[xr];Jx(this.wallVertexArray,dt,Ce),Jx(this.wallVertexArray,dt,Ce)}if(Lt.vertexLength+=4,this.indexArray.emplaceBack(Wr+0,Wr+1,Wr+2),this.indexArray.emplaceBack(Wr+1,Wr+3,Wr+2),Lt.primitiveLength+=2,Ze){const Ce=zt+(xr===1?gt.length-2:xr-2),dt=xr===1?zt:Ce+1;if(this.indexArray.emplaceBack(Wr+1,Ce,Wr+3),this.indexArray.emplaceBack(Ce,dt,Wr+3),Lt.primitiveLength+=2,br===void 0&&(br=Wr),!vk(Or,gt[xr],kt)){const At=xr===gt.length-1?br:Lt.vertexLength;this.indexArray.emplaceBack(Wr+2,Wr+3,At),this.indexArray.emplaceBack(Wr+3,At+1,At),this.indexArray.emplaceBack(Wr+3,dt,At+1),Lt.primitiveLength+=3}qt=!qt}if(H){const Ce=this.layoutVertexExtArray,dt=z.projectTilePoint(Qt.x,Qt.y,_),At=z.projectTilePoint(gr.x,gr.y,_),Jt=z.upVector(_,Qt.x,Qt.y),Kt=z.upVector(_,gr.x,gr.y);Qx(Ce,dt,Jt),Qx(Ce,dt,Jt),Qx(Ce,At,Kt),Qx(Ce,At,Kt)}}q&&(zt+=gt.length-1),ae&&Ze&&this.zoom>=17&&(jt.length!==0&&Ct(jt,jt[0])&&jt.pop(),this.groundEffect.addData(jt,kt,D,Ze>0))}this.footprintSegments.push(Et),$t.triangleCount=this.indexArray.length-$t.triangleArrayOffset,this.polygonSegments.push($t),++ie.footprintSegLen,++ie.polygonSegLen}if(ie.vertexCount=this.layoutVertexArray.length-ie.vertexArrayOffset,ie.groundVertexCount=this.groundEffect.vertexArray.length-ie.groundVertexArrayOffset,ie.vertexCount!==0){if(ie.centroidXY=ne.borders?pB:this.encodeCentroid(ne,ie),this.centroidData.push(ie),ne.borders){this.featuresOnBorder.push(ne);const nt=this.featuresOnBorder.length-1;for(let kt=0;kt<ne.borders.length;kt++)ne.borders[kt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[kt].push(nt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,y,T,_,I,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(l,p,y,T,_,I,this.worldview),this.maxHeight=Math.max(this.maxHeight,me)}}sortBorders(){for(let a=0;a<this.borderFeatureIndices.length;a++)this.borderFeatureIndices[a].sort((l,f)=>this.featuresOnBorder[l].borders[a][0]-this.featuresOnBorder[f].borders[a][0])}splitToSubtiles(){const a=[];for(let T=0;T<this.centroidData.length;T++){const A=this.centroidData[T],I=+(A.min.y+A.max.y>Zt),D=2*I+(+(A.min.x+A.max.x>Zt)^I);for(let F=0;F<A.polygonSegLen;F++){const z=A.polygonSegIdx+F;a.push({centroidIdx:T,subtile:D,polygonSegmentIdx:z,triangleSegmentIdx:this.polygonSegments[z].triangleSegIdx})}}const l=new Ta;a.sort((T,A)=>T.triangleSegmentIdx===A.triangleSegmentIdx?T.subtile-A.subtile:T.triangleSegmentIdx-A.triangleSegmentIdx);let f=0,p=0,_=0;for(const T of a){if(T.triangleSegmentIdx!==f)break;_++}const y=a.length;for(;p!==a.length;){f=a[p].triangleSegmentIdx;let T=0,A=p,I=p;for(let D=A;D<_&&a[D].subtile===T;D++)I++;for(;A!==_;){const D=a[A];T=D.subtile;const F=this.centroidData[D.centroidIdx].min.clone(),z=this.centroidData[D.centroidIdx].max.clone(),H={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let q=A;q<I;q++){const ne=a[q],ie=this.polygonSegments[ne.polygonSegmentIdx],ae=this.centroidData[ne.centroidIdx].min,me=this.centroidData[ne.centroidIdx].max,ye=this.indexArray.uint16;for(let we=ie.triangleArrayOffset;we<ie.triangleArrayOffset+ie.triangleCount;we++)l.emplaceBack(ye[3*we],ye[3*we+1],ye[3*we+2]);H.primitiveLength+=ie.triangleCount,F.x=Math.min(F.x,ae.x),F.y=Math.min(F.y,ae.y),z.x=Math.max(z.x,me.x),z.y=Math.max(z.y,me.y)}H.primitiveLength>0&&this.triangleSubSegments.push({segment:H,min:F,max:z}),A=I;for(let q=A;q<_&&a[q].subtile===a[A].subtile;q++)I++}p=_;for(let D=p;D<y&&a[D].triangleSegmentIdx===a[p].triangleSegmentIdx;D++)_++}l._trim(),this.indexArray=l}getVisibleSegments(a,l,f){const p=new Ti;if(this.wallMode){for(const ne of this.triangleSubSegments)p.segments.push(ne.segment);return p}let _=0,y=0;const T=1<<a.canonical.z;if(l){const ne=l.getMinMaxForTile(a);ne&&(_=ne.min,y=ne.max)}y+=this.maxHeight;const A=a.toUnwrapped();let I;const D=[A.canonical.x/T+A.wrap,A.canonical.y/T],F=[(A.canonical.x+1)/T+A.wrap,(A.canonical.y+1)/T],z=(ne,ie,ae)=>[ne[0]*(1-ae[0])+ie[0]*ae[0],ne[1]*(1-ae[1])+ie[1]*ae[1]],H=[],q=[];for(const ne of this.triangleSubSegments){H[0]=ne.min.x/Zt,H[1]=ne.min.y/Zt,q[0]=ne.max.x/Zt,q[1]=ne.max.y/Zt;const ie=z(D,F,H),ae=z(D,F,q);if(new Rr([ie[0],ie[1],_],[ae[0],ae[1],y]).intersectsPrecise(f)===0){I&&(p.segments.push(I),I=void 0);continue}const me=ne.segment;I&&I.vertexOffset!==me.vertexOffset&&(p.segments.push(I),I=void 0),I?(I.vertexLength+=me.vertexLength,I.primitiveLength+=me.primitiveLength):I={vertexOffset:me.vertexOffset,primitiveLength:me.primitiveLength,vertexLength:me.vertexLength,primitiveOffset:me.primitiveOffset,sortKey:void 0,vaos:{}}}return I&&p.segments.push(I),p}encodeCentroid(a,l){const f=a.centroid(),p=l.span(),_=Math.min(7,Math.round(p.x*this.tileToMeter/10)),y=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new Pt(Q(f.x,1,Zt-1)<<3|_,Q(f.y,1,Zt-1)<<3|y)}encodeBorderCentroid(a){if(!a.borders)return new Pt(0,0);const l=a.borders,f=Number.MAX_VALUE;if(l[0][0]!==f||l[1][0]!==f){const p=l[0][0]!==f?0:1;return new Pt(6|(l[0][0]!==f?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{const p=l[2][0]!==f?2:3;return new Pt((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==f?0:65528))}}showCentroid(a){const l=this.centroidData[a.centroidDataIndex];l.flags&=2147483647,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(a){this.groundEffect.updateHiddenByLandmark(a);const l=a.vertexArrayOffset,f=a.vertexCount+a.vertexArrayOffset,p=a.flags&Pd?pB:a.centroidXY,_=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||_!==p.x){for(let y=l;y<f;++y)this.centroidVertexArray.emplace(y,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const a of this.centroidData)this.writeCentroidToBuffer(a)}updateReplacement(a,l,f){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(a.toUnwrapped());if(BT(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const _=[];for(const y of this.activeReplacements){if(y.order<f)continue;const T=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-a.canonical.z));if(y.footprint.buildingId){const A=y.footprint.buildingId;for(const I of this.centroidData)I.buildingId===A&&(I.flags|=Pd)}else for(const A of this.centroidData)if(!(A.flags&Pd||y.min.x>A.max.x||A.min.x>y.max.x||y.min.y>A.max.y||A.min.y>y.max.y))for(let I=0;I<A.footprintSegLen;I++){const D=this.footprintSegments[A.footprintSegIdx+I];if(_.length=0,Jte(this.footprintVertices,D.vertexOffset,D.vertexCount,y.footprintTileId.canonical,a.canonical,_),pk(y.footprint,_,this.footprintIndices.uint16,D.indexOffset,D.indexCount,-D.vertexOffset,-T)){A.flags|=Pd;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(a,l,f){let p=!1;for(let _=0;_<f.footprintSegLen;_++){const y=this.footprintSegments[f.footprintSegIdx+_];let T=0;for(const A of y.ringIndices){for(let I=T,D=A+T-1;I<A+T;D=I++){const F=this.footprintVertices.int16[2*(I+y.vertexOffset)+0],z=this.footprintVertices.int16[2*(I+y.vertexOffset)+1],H=this.footprintVertices.int16[2*(D+y.vertexOffset)+1];z>l!=H>l&&a<(this.footprintVertices.int16[2*(D+y.vertexOffset)+0]-F)*(l-z)/(H-z)+F&&(p=!p)}T=A}}return p}getHeightAtTileCoord(a,l){let f=Number.NEGATIVE_INFINITY,p=!0;const _=4*(a+Zt)*Zt+(l+Zt);if(this.partLookup.hasOwnProperty(_)){const y=this.partLookup[_];return y?{height:y.height,hidden:!!(y.flags&Pd)}:void 0}for(const y of this.centroidData)a>y.max.x||y.min.x>a||l>y.max.y||y.min.y>l||y.height<=f||this.footprintContainsPoint(a,l,y)&&(f=y.height,this.partLookup[_]=y,p=!!(y.flags&Pd));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:p};this.partLookup[_]=void 0}}function vB(c,a){const l=c.add(a)._unit();return c.x*l.x+c.y*l.y}function Kte(c,a,l,f){const p=a.sub(c)._perp()._unit(),_=l.sub(a)._perp()._unit();return xB(c,a,l,vB(p,_),f)}function xB(c,a,l,f,p){const _=Math.sqrt(1-f*f);return Math.min(c.dist(a)/3,a.dist(l)/3,p*_/f)}function vk(c,a,l){return c.x<l[0].x&&a.x<l[0].x||c.x>l[1].x&&a.x>l[1].x||c.y<l[0].y&&a.y<l[0].y||c.y>l[1].y&&a.y>l[1].y}function wB(c,a){return c.x<a[0].x||c.x>a[1].x||c.y<a[0].y||c.y>a[1].y}function bB(c,a,l){if(c.x<0||c.x>=Zt||a.x<0||a.x>=Zt||l.x<0||l.x>=Zt)return!1;const f=l.sub(a),p=f.perp(),_=c.sub(a);return(f.x*_.x+f.y*_.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(_.x*_.x+_.y*_.y))>-.866&&p.x*_.x+p.y*_.y<0}function TB(c,a,l){const f=a?2|c:-3&c;return l?1|f:-2&f}function SB(){const c=Math.PI/32,a=Math.tan(c),l=Y;return l*Math.sqrt(1+2*a*a)-l}function EB(c,a,l){const f=1<<l.z,p=Fe(l.x/f),_=Fe((l.x+1)/f),y=Re(l.y/f),T=Re((l.y+1)/f);return function(A,I,D,F,z=0,H){const q=[];if(!A.length||!D||!F)return q;const ne=(ze,Ve)=>{for(const Ze of ze)q.push({polygon:Ze,bounds:Ve})},ie=Math.ceil(Math.log2(D)),ae=Math.ceil(Math.log2(F)),me=ie-ae,ye=[];for(let ze=0;ze<Math.abs(me);ze++)ye.push(me>0?0:1);for(let ze=0;ze<Math.min(ie,ae);ze++)ye.push(0),ye.push(1);let we=A;if(we=FT(we,I[0].y-z,I[1].y+z,1),we=FT(we,I[0].x-z,I[1].x+z,0),!we.length)return q;const Be=[];for(ye.length?Be.push({polygons:we,bounds:I,depth:0}):ne(we,I);Be.length;){const ze=Be.pop(),Ve=ze.depth,Ze=ye[Ve],Ye=ze.bounds[0],Ct=ze.bounds[1],nt=Ze===0?Ye.x:Ye.y,kt=Ze===0?Ct.x:Ct.y,zt=H?H(Ze,nt,kt):.5*(nt+kt),Ot=FT(ze.polygons,nt-z,zt+z,Ze),Lt=FT(ze.polygons,zt-z,kt+z,Ze);if(Ot.length){const $t=[Ye,new Pt(Ze===0?zt:Ct.x,Ze===1?zt:Ct.y)];ye.length>Ve+1?Be.push({polygons:Ot,bounds:$t,depth:Ve+1}):ne(Ot,$t)}if(Lt.length){const $t=[new Pt(Ze===0?zt:Ye.x,Ze===1?zt:Ye.y),Ct];ye.length>Ve+1?Be.push({polygons:Lt,bounds:$t,depth:Ve+1}):ne(Lt,$t)}}return q}(c,a,Math.ceil((_-p)/11.25),Math.ceil((y-T)/11.25),1,(A,I,D)=>{if(A===0)return .5*(I+D);{const F=Re((l.y+I/Zt)/f);return(De(.5*(Re((l.y+D/Zt)/f)+F))*f-l.y)*Zt}})}function Jte(c,a,l,f,p,_){const y=Math.pow(2,f.z-p.z);for(let T=0;T<l;T++){let A=c.int16[2*(T+a)+0],I=c.int16[2*(T+a)+1];A=(A+p.x*Zt)*y-f.x*Zt,I=(I+p.y*Zt)*y-f.y*Zt,_.push(new Pt(A,I))}}let AB,CB;sr(jT,"FillExtrusionBucket",{omit:["layers","features"]}),sr(gB,"PartData"),sr(mB,"FootprintSegment"),sr(_B,"BorderCentroidData"),sr(yk,"GroundEffect");class Pm extends Pt{constructor(a,l,f){super(a,l),this.z=f}}class PB extends Pm{constructor(a,l,f,p){super(a,l,f),this.w=p}}function IB(c,a,l,f){const p=l==="x"?"y":"x",_=(f-c[l])/(a[l]-c[l]);c[p]=Math.round(c[p]+(a[p]-c[p])*_),c[l]=f,c.hasOwnProperty("z")&&(c.z=Ir(c.z,a.z,_)),c.hasOwnProperty("w")&&(c.w=Ir(c.w,a.w,_))}function kB(c,a,l,f){const p=l,_=f;for(const y of["x","y"]){let T=c,A=a;T[y]>=A[y]&&(T=a,A=c),T[y]<p&&A[y]>p&&IB(T,A,y,p),T[y]<_&&A[y]>_&&IB(A,T,y,_)}}function UT(c,a,l,f,p,_){const y=[];for(let T=0;T<c.length;T++){const A=c[T];let I;const D=y.length;let F=0;for(let z=0;z<A.length-1;z++){let H=A[z],q=A[z+1],ne=0;const ie=F;let ae,me;_&&(ne=Math.hypot(q.x-H.x,q.y-H.y),F+=ne,ae=H,me=q),H.x<a&&q.x<a||(H.x<a?H=new Pt(a,H.y+(a-H.x)/(q.x-H.x)*(q.y-H.y))._round():q.x<a&&(q=new Pt(a,H.y+(a-H.x)/(q.x-H.x)*(q.y-H.y))._round()),H.y<l&&q.y<l||(H.y<l?H=new Pt(H.x+(l-H.y)/(q.y-H.y)*(q.x-H.x),l)._round():q.y<l&&(q=new Pt(H.x+(l-H.y)/(q.y-H.y)*(q.x-H.x),l)._round()),H.x>=f&&q.x>=f||(H.x>=f?H=new Pt(f,H.y+(f-H.x)/(q.x-H.x)*(q.y-H.y))._round():q.x>=f&&(q=new Pt(f,H.y+(f-H.x)/(q.x-H.x)*(q.y-H.y))._round()),H.y>=p&&q.y>=p||(H.y>=p?H=new Pt(H.x+(p-H.y)/(q.y-H.y)*(q.x-H.x),p)._round():q.y>=p&&(q=new Pt(H.x+(p-H.y)/(q.y-H.y)*(q.x-H.x),p)._round()),I&&H.equals(I[I.length-1])||(I=[H],y.push(I),_&&_.push({progress:{min:ie+OB(ae,me,H)*ne,max:1},parentIndex:T,prevPoint:ae,nextPoint:me})),I.push(q),_&&(_[_.length-1].progress.max=ie+OB(ae,me,q)*ne,_[_.length-1].nextPoint=me)))))}if(_&&F>0)for(let z=D;z<y.length;z++)_[z].progress.min/=F,_[z].progress.max/=F}return y}function Qte(c,a,l,f,p){if(c.length<2)return void f.push(c);const _=[];for(;a.valid();){const[I,D]=a.get();for(let F=0;F<c.length-1;F++){const z=c[F],H=c[F+1],q=Fi(z,H,I,D);if(q){const[ne]=q,ie=new Pt(Ir(z.x,H.x,ne),Ir(z.y,H.y,ne));_.push({t:F+ne,distance:0,point:ie})}}a.next()}if(_.length===0)return void f.push(c);_.sort((I,D)=>I.t-D.t);let y=0,T=0,A=[];for(f.push(A);y!==c.length;){if(T===_.length){for(;y!==c.length;)A.length!==0&&A[A.length-1].equals(c[y])||A.push(c[y]),y++;break}_[T].t<=y?(A.length!==0&&A[A.length-1].equals(_[T].point)||A.push(_[T].point),Math.trunc(_[T].t),T++):(A.length!==0&&A[A.length-1].equals(c[y])||A.push(c[y]),y++)}}function OB(c,a,l){return c.x!==a.x?(l.x-c.x)/(a.x-c.x):c.y!==a.y?(l.y-c.y)/(a.y-c.y):0}function e1(c,a){return c.x*a.x+c.y*a.y}function MB(c,a){if(c.length===1){let l=0;const f=a[l++];let p;for(;!p||f.equals(p);)if(p=a[l++],!p)return 1/0;for(;l<a.length;l++){const _=a[l],y=c[0],T=p.sub(f),A=_.sub(f),I=y.sub(f),D=e1(T,T),F=e1(T,A),z=e1(A,A),H=e1(I,T),q=e1(I,A),ne=D*z-F*F,ie=(z*H-F*q)/ne,ae=(D*q-F*H)/ne,me=f.z*(1-ie-ae)+p.z*ie+_.z*ae;if(isFinite(me))return me}return 1/0}{let l=1/0;for(const f of a)l=Math.min(l,f.z);return l}}function RB(c,a,l,f,p,_,y,T){const A=y*p.getElevationAt(c,a,!0,!0),I=_[0]!==0,D=I?_[1]===0?y*(_[0]/7-450):y*function(F,z,H){const q=Math.floor(z[0]/8),ne=Math.floor(z[1]/8),ie=10*(z[0]-8*q),ae=10*(z[1]-8*ne),me=F.getElevationAt(q,ne,!0,!0),ye=F.getMeterToDEM(H),we=Math.floor(.5*(ie*ye-1)),Be=Math.floor(.5*(ae*ye-1)),ze=F.tileCoordToPixel(q,ne),Ve=2*we+1,Ze=2*Be+1,Ye=function(Lt,$t,Et,Nt,gt){return[Lt.getElevationAtPixel($t,Et,!0),Lt.getElevationAtPixel($t+gt,Et,!0),Lt.getElevationAtPixel($t,Et+gt,!0),Lt.getElevationAtPixel($t+Nt,Et+gt,!0)]}(F,ze.x-we,ze.y-Be,Ve,Ze),Ct=Math.abs(Ye[0]-Ye[1]),nt=Math.abs(Ye[2]-Ye[3]),kt=Math.abs(Ye[0]-Ye[2])+Math.abs(Ye[1]-Ye[3]),zt=Math.min(.25,.5*ye*(Ct+nt)/Ve),Ot=Math.min(.25,.5*ye*kt/Ze);return me+Math.max(zt*ie,Ot*ae)}(p,_,T):A;return{base:A+(l===0?-1:l),top:I?Math.max(D+f,A+l+2):A+f}}class ere{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class tre{constructor(){this.tasks={},this.taskQueue=[],wt(["process"],this),this.invoker=new ere(this.process),this.nextId=0}add(a,l){const f=this.nextId++,p=function({type:_,isSymbolTile:y,zoom:T}){return T=T||0,_==="message"?0:_!=="maybePrepare"||y?_!=="parseTile"||y?_==="parseTile"&&y?300-T:_==="maybePrepare"&&y?400-T:500:200-T:100-T}(l);if(p===0){try{a()}finally{}return null}return this.tasks[f]={fn:a,metadata:l,priority:p,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const l=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let a=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<l&&(l=_.priority,a=p)}if(a===null)return null;const f=this.taskQueue[a];return this.taskQueue.splice(a,1),f}remove(){this.invoker.remove()}}class DB{constructor(a,l,f){this.target=a,this.parent=l,this.mapId=f,this.callbacks={},this.cancelCallbacks={},wt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new tre}send(a,l,f,p,_=!1,y){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=y,this.callbacks[T]=f);const A=new Set;return this.target.postMessage({id:T,type:a,hasCallback:!!f,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:$u(l,A)},A),{cancel:()=>{f&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(a){const l=a.data;if(!l)return;const f=l.id;if(f&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const p=this.cancelCallbacks[f];delete this.cancelCallbacks[f],p&&p.cancel()}else if(l.mustQueue||an(self)){const p=this.callbacks[f],_=this.scheduler.add(()=>this.processTask(f,l),p&&p.metadata||{type:"message"});_&&(this.cancelCallbacks[f]=_)}else this.processTask(f,l)}processTask(a,l){if(delete this.cancelCallbacks[a],l.type==="<response>"){const f=this.callbacks[a];delete this.callbacks[a],f&&(l.error?f(Vu(l.error)):f(null,Vu(l.data)))}else{const f=new Set,p=l.hasCallback?(y,T)=>{this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:y?$u(y):null,data:$u(T,f)},f)}:()=>{},_=Vu(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,_,p);else if(this.parent.getWorkerSource){const y=l.type.split("."),{source:T,scope:A}=_;this.parent.getWorkerSource(l.sourceMapId,y[0],T,A)[y[1]](_,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var t1={workerUrl:"",workerClass:null,workerParams:void 0};const xk="mapboxgl_preloaded_worker_pool";class Im{constructor(){this.active={}}acquire(a,l=Im.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(t1.workerClass!=null?new t1.workerClass:new self.Worker(t1.workerUrl,t1.workerParams));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xk]}numActive(){return Object.keys(this.active).length}}Im.workerCount=2;class s_{constructor(a,l,f="Worker",p=Im.workerCount){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=Te();const _=this.workerPool.acquire(this.id,p);for(let y=0;y<_.length;y++){const T=new s_.Actor(_[y],l,this.id);T.name=`${f} ${y}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,l,f){fe(this.actors,(p,_)=>{p.send(a,l,_)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}let r1,wk;function $T(){return r1||(r1=new Im),r1}s_.Actor=DB;class rre{constructor(a){this.module=a}createIntArray(a){const l=new Int32Array(a),f=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heap32.set(l,f/l.BYTES_PER_ELEMENT),f}createFloatArray(a){const l=new Float32Array(a),f=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heapF32.set(l,f/l.BYTES_PER_ELEMENT),f}createStringBuffer(a){const l=this.module.malloc(a.length+1);for(let f=0;f<a.length;++f)this.module.heapU8[l+f]=a.charCodeAt(f);return this.module.heapU8[l+a.length]=0,l}readStringBuffer(a){let l="";for(;this.module.heapU8[a]!==0;)l+=String.fromCharCode(this.module.heapU8[a]),++a;return l}setStyle(a){const l=a.entranceColorRgb,f=a.facadeGlazingColorRgb,p=a.roofColorRgb,_=a.wallColorRgb,y=a.normalScale;this.module.setStyle(l[0],l[1],l[2],f[0],f[1],f[2],p[0],p[1],p[2],_[0],_[1],_[2],y[0],y[1],y[2],a.tileToMeters)}setAOOptions(a,l){this.module.setAOOptions(a?1:0,l)}setMetricOptions(a,l){this.module.setMetricOptions(a?1:0,l)}setStructuralOptions(a){this.module.setStructuralOptions(a?1:0)}setFacadeOptions(a,l){this.module.setFacadeOptions(a,l?1:0)}setFauxFacadeOptions(a,l,f){this.module.setFauxFacadeOptions(a?1:0,l?1:0,f)}setFacadeClassifierOptions(a){this.module.setFacadeClassifierOptions(a)}generateMesh(a,l){for(const T of a){const A=this.createStringBuffer(T.roofType),I=[0],D=[];for(const H of T.coordinates)if(Array.isArray(H)){for(const q of H)D.push(q.x),D.push(q.y);I.push(D.length)}const F=this.createIntArray(I),z=this.createFloatArray(D);this.module.addFeature(T.id,T.sourceId,T.minHeight,T.height,A,T.roofType.length,z,F,I.length-1),this.module.free(A),this.module.free(F),this.module.free(z)}for(const T of l){let A;A=T.entrances?JSON.parse(T.entrances):[];const I=this.createFloatArray(A),D=[];for(const z of T.coordinates)D.push(z.x),D.push(z.y);const F=this.createFloatArray(D);this.module.addFacade(T.sourceId,T.crossPerc,T.distanceToRoad,I,A.length,F,D.length),this.module.free(I),this.module.free(F)}if(!this.module.generateMesh()){const T=this.module.getLastError();return this.readStringBuffer(T)}const f=this.module.getMeshCount(),p=new Array(f);for(let T=0;T<f;T++){const A=this.module.getPositionsPtr(T),I=this.module.getPositionsLength(T),D=new Float32Array(this.module.heapF32.buffer,A,I),F=this.module.getNormalsPtr(T),z=this.module.getNormalsLength(T),H=new Float32Array(this.module.heapF32.buffer,F,z),q=this.module.getColorsPtr(T),ne=this.module.getColorsLength(T),ie=new Uint8Array(this.module.heapU8.buffer,q,ne),ae=this.module.getAOPtr(T),me=this.module.getAOLength(T),ye=new Float32Array(this.module.heapF32.buffer,ae,me),we=this.module.getUVPtr(T),Be=this.module.getUVLength(T),ze=new Float32Array(this.module.heapF32.buffer,we,Be),Ve=this.module.getFauxFacadePtr(T),Ze=this.module.getFauxFacadeLength(T),Ye=new Uint8Array(this.module.heapU8.buffer,Ve,Ze),Ct=this.module.getIndicesPtr(T),nt=this.module.getIndicesLength(T),kt=new Int32Array(this.module.heap32.buffer,Ct,nt),zt=this.module.getBuildingPart(T),Ot=this.readStringBuffer(zt);p[T]={positions:D,normals:H,colors:ie,ao:ye,uv:ze,isFauxFacade:Ye,indices:kt,buildingPart:Ot}}const _=this.module.getRingCount(),y=[];for(let T=0;T<_;T++){const A=this.module.getRingPtr(T),I=this.module.getRingLength(T),D=new Float32Array(this.module.heapF32.buffer,A,I);y.push(D)}return{meshes:p,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:y}}}let n1,bk,Yc,l_,Tk,c_=null,u_=null,FB=null,VT=null;function LB(){return an(self)&&self.worker.dracoUrl?self.worker.dracoUrl:bk||Ao.DRACO_URL}function NB(){if(an(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(l_)return l_;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return l_=WebAssembly.validate(c)?Ao.MESHOPT_SIMD_URL:Ao.MESHOPT_URL,l_}function nre(){return VT}const WT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ire={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},i1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function BB(c,a,l){const f=l.json.bufferViews.length,p=l.buffers.length;a.bufferView=f,l.json.bufferViews[f]={buffer:p,byteLength:c.byteLength},l.buffers[p]=c}const Sk="KHR_draco_mesh_compression";function are(c,a){const l=c.extensions&&c.extensions[Sk];if(!l)return;const f=new Yc.Decoder,p=$B(a,l.bufferView),_=new Yc.Mesh;if(!f.DecodeArrayToMesh(p,p.byteLength,_))throw new Error("Failed to decode Draco mesh");const y=a.json.accessors[c.indices],T=WT[y.componentType],A=y.count*T.BYTES_PER_ELEMENT,I=Yc._malloc(A);T===Uint16Array?f.GetTrianglesUInt16Array(_,A,I):f.GetTrianglesUInt32Array(_,A,I),BB(Yc.memory.buffer.slice(I,I+A),y,a),Yc._free(I);for(const D of Object.keys(l.attributes)){const F=f.GetAttributeByUniqueId(_,l.attributes[D]),z=a.json.accessors[c.attributes[D]],H=ire[z.componentType],q=z.count*i1[z.type]*WT[z.componentType].BYTES_PER_ELEMENT,ne=Yc._malloc(q);f.GetAttributeDataArrayForAllPoints(_,F,Yc[H],q,ne),BB(Yc.memory.buffer.slice(ne,ne+q),z,a),Yc._free(ne)}f.destroy(),_.destroy(),delete c.extensions[Sk]}const GT="EXT_meshopt_compression";function ore(c,a){if(!c.extensions||!c.extensions[GT])return;const l=c.extensions[GT],f=new Uint8Array(a.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);Tk.decodeGltfBuffer(p,l.count,l.byteStride,f,l.mode,l.filter),c.buffer=a.buffers.length,c.byteOffset=0,a.buffers[c.buffer]=p.buffer,delete c.extensions[GT]}const zB=1179937895,jB=new TextDecoder("utf8");function UB(c,a){return new URL(c,a).href}function sre(c,a,l,f){return fetch(UB(c.uri,f)).then(p=>p.arrayBuffer()).then(p=>{a.buffers[l]=p})}function $B(c,a){const l=c.json.bufferViews[a];return new Uint8Array(c.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function lre(c,a,l,f){if(c.uri){const p=UB(c.uri,f);return fetch(p).then(_=>_.blob()).then(_=>createImageBitmap(_)).then(_=>{a.images[l]=_})}if(c.bufferView!==void 0){const p=$B(a,c.bufferView),_=new Blob([p],{type:c.mimeType});return createImageBitmap(_).then(y=>{a.images[l]=y})}}function VB(c,a=0,l){const f={json:null,images:[],buffers:[]};if(new Uint32Array(c,a,1)[0]===zB){const D=new Uint32Array(c,a);let F=2;const z=(D[F++]>>2)-3,H=D[F++]>>2;if(F++,f.json=JSON.parse(jB.decode(D.subarray(F,F+H))),F+=H,F<z){const q=D[F++];F++;const ne=a+(F<<2);f.buffers[0]=c.slice(ne,ne+q)}}else f.json=JSON.parse(jB.decode(new Uint8Array(c,a)));const{buffers:p,images:_,meshes:y,extensionsUsed:T,bufferViews:A}=f.json;let I=Promise.resolve();if(p){const D=[];for(let F=0;F<p.length;F++){const z=p[F];z.uri?D.push(sre(z,f,F,l)):f.buffers[F]||(f.buffers[F]=null)}I=Promise.all(D)}return I.then(()=>{const D=[],F=T&&T.includes(Sk),z=T&&T.includes(GT);if(F&&D.push(function(){if(!Yc)return n1??(n1=function(H){let q,ne=null;function ie(){q=new Uint8Array(ne.buffer)}function ae(){throw new Error("Unexpected Draco error.")}const me={a:{a:ae,d:function(ye,we,Be){return q.copyWithin(ye,we,we+Be)},c:function(ye){const we=q.length,Be=Math.max(ye>>>0,Math.ceil(1.2*we)),ze=Math.ceil((Be-we)/65536);try{return ne.grow(ze),ie(),!0}catch{return!1}},b:ae}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(H,me):H.then(ye=>ye.arrayBuffer()).then(ye=>WebAssembly.instantiate(ye,me))).then(ye=>{const{Rb:we,Qb:Be,P:ze,T:Ve,X:Ze,Ja:Ye,La:Ct,Qa:nt,Va:kt,Wa:zt,eb:Ot,jb:Lt,f:$t,e:Et,yb:Nt,zb:gt,Ab:ut,Bb:Vt,Db:jt,Gb:br}=ye.instance.exports;ne=Et;const ir=(()=>{let dr=0,qt=0,xr=0,jr=0;return Qt=>{xr&&(we(jr),we(dr),qt+=xr,xr=dr=0),dr||(qt+=128,dr=Be(qt));const gr=Qt.length+7&-8;let Or=dr;gr>=qt&&(xr=gr,Or=jr=Be(gr));for(let Vr=0;Vr<Qt.length;Vr++)q[Or+Vr]=Qt[Vr];return Or}})();return ie(),$t(),{memory:Et,_free:we,_malloc:Be,Mesh:class{constructor(){this.ptr=ze()}destroy(){Ve(this.ptr)}},Decoder:class{constructor(){this.ptr=Ye()}destroy(){Lt(this.ptr)}DecodeArrayToMesh(dr,qt,xr){const jr=ir(dr),Qt=Ct(this.ptr,jr,qt,xr.ptr);return!!Ze(Qt)}GetAttributeByUniqueId(dr,qt){return{ptr:nt(this.ptr,dr.ptr,qt)}}GetTrianglesUInt16Array(dr,qt,xr){kt(this.ptr,dr.ptr,qt,xr)}GetTrianglesUInt32Array(dr,qt,xr){zt(this.ptr,dr.ptr,qt,xr)}GetAttributeDataArrayForAllPoints(dr,qt,xr,jr,Qt){Ot(this.ptr,dr.ptr,qt.ptr,xr,jr,Qt)}},DT_INT8:Nt(),DT_UINT8:gt(),DT_INT16:ut(),DT_UINT16:Vt(),DT_UINT32:jt(),DT_FLOAT32:br()}})}(fetch(LB())),n1.then(H=>{Yc=H,n1=void 0}))}()),z&&D.push(function(){if(Tk)return;const H=function(q){let ne;const ie=WebAssembly.instantiateStreaming(q,{}).then(ye=>{ne=ye.instance,ne.exports.__wasm_call_ctors()}),ae={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},me={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ie,supported:!0,decodeGltfBuffer(ye,we,Be,ze,Ve,Ze){(function(Ye,Ct,nt,kt,zt,Ot,Lt){const $t=Ye.exports.sbrk,Et=kt+3&-4,Nt=$t(Et*zt),gt=$t(Ot.length),ut=new Uint8Array(Ye.exports.memory.buffer);ut.set(Ot,gt);const Vt=Ct(Nt,kt,zt,gt,Ot.length);if(Vt===0&&Lt&&Lt(Nt,Et,zt),nt.set(ut.subarray(Nt,Nt+kt*zt)),$t(Nt-$t(0)),Vt!==0)throw new Error(`Malformed buffer data: ${Vt}`)})(ne,ne.exports[me[Ve]],ye,we,Be,ze,ne.exports[ae[Ze]])}}}(fetch(NB()));return H.ready.then(()=>{Tk=H})}()),_)for(let H=0;H<_.length;H++)D.push(lre(_[H],f,H,l));return(D.length?Promise.all(D):Promise.resolve()).then(()=>{if(F&&y)for(const{primitives:H}of y)for(const q of H)are(q,f);if(z&&y&&A)for(const H of A)ore(H,f);return f})})}function Ek(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Ak(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Ck{constructor(a,l,f,p){this.context=a,this.format=f,this.useMipmap=p&&p.useMipmap,this.texture=a.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(a,l){const f=a&&a instanceof HTMLVideoElement&&a.width===0?a.videoWidth:a.width,p=a&&a instanceof HTMLVideoElement&&a.height===0?a.videoHeight:a.height,{context:_}=this,{gl:y}=_,{x:T,y:A}=l&&l.position?l.position:{x:0,y:0},I=T+f,D=A+p;!this.size||this.size[0]===I&&this.size[1]===D||(y.bindTexture(y.TEXTURE_2D,null),y.deleteTexture(this.texture),this.texture=y.createTexture(),this.size=null),y.bindTexture(y.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA8&&(!l||l.premultiply!==!1));const F=a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||ImageBitmap&&a instanceof ImageBitmap;if(!this.size&&I>0&&D>0){const z=this.useMipmap?Math.floor(Math.log2(Math.max(I,D)))+1:1;y.texStorage2D(y.TEXTURE_2D,z,this.format,I,D),this.size=[I,D]}this.size&&(F?y.texSubImage2D(y.TEXTURE_2D,0,T,A,Ek(this.format),Ak(this.format),a):"data"in a&&a.data&&y.texSubImage2D(y.TEXTURE_2D,0,T,A,f,p,Ek(this.format),Ak(this.format),a.data)),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(a,l,f=!1){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),a!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap&&!f?a===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:a),this.minFilter=a),l!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,l),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(a,l,f,p,_){const{context:y}=this,{gl:T}=y;T.bindTexture(T.TEXTURE_2D,this.texture),l!==this.magFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,l),this.magFilter=l),a!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?a===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR:a),this.minFilter=a),f!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,f),this.wrapS=f),p!==this.wrapT&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,p),this.wrapT=p),_!==this.compareMode&&(_?(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_MODE,T.COMPARE_REF_TO_TEXTURE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_FUNC,_)):T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_MODE,T.NONE),this.compareMode=_)}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class a1{constructor(a,l){this.context=a,this.texture=l}bind(a,l){const{context:f}=this,{gl:p}=f;p.bindTexture(p.TEXTURE_2D,this.texture),a!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,a),this.minFilter=a),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}const cre=fn([{name:"a_pos_3f",components:3,type:"Float32"}]),ure=fn([{name:"a_color_3f",components:3,type:"Float32"}]),hre=fn([{name:"a_color_4f",components:4,type:"Float32"}]),fre=fn([{name:"a_uv_2f",components:2,type:"Float32"}]),dre=fn([{name:"a_normal_3f",components:3,type:"Float32"}]),pre=fn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),mre=fn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function WB(c,a){const l=HT(c.projection,c.zoom,c.width,c.height),f=function(_,y,T,A,I){const D=new te(T.lng-180*Id,T.lat),F=new te(T.lng+180*Id,T.lat),z=_.project(D.lng,D.lat),H=_.project(F.lng,F.lat),q=-Math.atan2(H.y-z.y,H.x-z.x),ne=_t.fromLngLat(T);ne.y=Q(ne.y,-1+Id,1-Id);const ie=ne.toLngLat(),ae=_.project(ie.lng,ie.lat),me=_t.fromLngLat(ie);me.x+=Id;const ye=me.toLngLat(),we=_.project(ye.lng,ye.lat),Be=HB(we.x-ae.x,we.y-ae.y,q),ze=_t.fromLngLat(ie);ze.y+=Id;const Ve=ze.toLngLat(),Ze=_.project(Ve.lng,Ve.lat),Ye=HB(Ze.x-ae.x,Ze.y-ae.y,q),Ct=Math.abs(Be.x)/Math.abs(Ye.y),nt=R([]);K(nt,nt,-q*(1-(I?0:A)));const kt=R([]);return U(kt,kt,[1,1-(1-Ct)*A,1]),kt[4]=-Ye.x/Ye.y*A,K(kt,kt,q),V(kt,nt,kt),kt}(c.projection,0,c.center,l,a),p=GB(c);return U(f,f,[p,p,1]),f}function GB(c){const a=c.projection,l=HT(c.projection,c.zoom,c.width,c.height),f=Pk(a,c.center),p=Pk(a,te.convert(a.center));return Math.pow(2,f*l+(1-l)*p)}function HT(c,a,l,f,p=1/0){const _=c.range;if(!_)return 0;const y=Math.min(p,Math.max(l,f)),T=Math.log2(y/1024);return pe(_[0]+T,_[1]+T,a)}const Id=1/4e4;function Pk(c,a){const l=Q(a.lat,-Le,Le),f=new te(a.lng-180*Id,l),p=new te(a.lng+180*Id,l),_=c.project(f.lng,l),y=c.project(p.lng,l),T=_t.fromLngLat(f),A=_t.fromLngLat(p),I=y.x-_.x,D=y.y-_.y,F=A.x-T.x,z=A.y-T.y,H=Math.sqrt((F*F+z*z)/(I*I+D*D));return Math.log2(H)}function HB(c,a,l){const f=Math.cos(l),p=Math.sin(l);return{x:c*f-a*p,y:c*p+a*f}}function qB(c,a,l){R(c),K(c,c,Qe(a[2])),J(c,c,Qe(a[0])),Z(c,c,Qe(a[1])),U(c,c,l),V(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function qT(c,a,l,f,p,_,y,T){const A=[l[0]-a[0],l[1]-a[1],0],I=[f[0]-a[0],f[1]-a[1],0];if(tt(A)<1e-12||tt(I)<1e-12)return Di(c);const D=Yt([],A,I);yt(D,D),pt(I,f,a),A[2]=(_-p)*T,I[2]=(y-p)*T;const F=A;return Yt(F,A,I),yt(F,F),_n(c,D,F)}function Ik(c,a,l=!1){const f=Ad(a.zoom),p=function(_,y,T){const A=y.worldSize,I=[_[12],_[13],_[14]],D=Re(I[1]/A),F=Fe(I[0]/A),z=R([]),H=Me(1,D)*A,q=Me(1,0)*A*Ke(D,y.zoom),ne=1/nk(A);let ie=q*ne;if(T){const we=HT(y.projection,y.zoom,y.width,y.height,1024);ie=ne*y.projection.pixelSpaceConversion(y.center.lat,A,we)}const ae=W(D,F);at(ae,ae,Rt([],yt([],ae),H*ie*I[2]));const me=function(we){const Be=[we[0],we[1],we[2]];let ze=[0,1,0];const Ve=Yt([],ze,Be);return Yt(ze,Be,Ve),qe(ze)===0&&(ze=[0,1,0],Yt(Ve,Be,ze)),yt(Ve,Ve),yt(ze,ze),yt(Be,Be),[Ve[0],Ve[1],Ve[2],0,ze[0],ze[1],ze[2],0,Be[0],Be[1],Be[2],0,we[0],we[1],we[2],1]}(ae);U(z,z,[ie,ie,ie*H]),G(z,z,[-I[0],-I[1],-I[2]]);const ye=V([],y.globeMatrix,me);return V(ye,ye,z),V(ye,ye,_),ye}(c,a,l);if(f>0){const _=function(y,T){const A=T.worldSize,I=Me(1,0)*A*Ke(T.center.lat,T.zoom)/nk(A),D=Me(1,T.center.lat)*A,F=R([]);Z(F,F,Qe(T.center.lng)),J(F,F,Qe(T.center.lat)),G(F,F,[0,0,m]),U(F,F,[I,I,I*D]);const z=T.point;return G(F,F,[-z.x,-z.y,0]),V(F,F,y),V(F,T.globeMatrix,F)}(c,a);return function(y,T,A){const I=(q,ne,ie)=>{const ae=tt(q),me=tt(ne),ye=of(q,ne,ie);return Rt(ye,ye,1/tt(ye)*Ir(ae,me,ie))},D=I([y[0],y[1],y[2]],[T[0],T[1],T[2]],A),F=I([y[4],y[5],y[6]],[T[4],T[5],T[6]],A),z=I([y[8],y[9],y[10]],[T[8],T[9],T[10]],A),H=of([y[12],y[13],y[14]],[T[12],T[13],T[14]],A);return[D[0],D[1],D[2],0,F[0],F[1],F[2],0,z[0],z[1],z[2],0,H[0],H[1],H[2],1]}(p,_,f)}return p}function XB(c,a,l,f){const p=Rr.projectAabbCorners(f,l);let _=Number.MAX_VALUE,y=-1;for(let I=0;I<p.length;++I){const D=p[I];D[0]=(.5*D[0]+.5)*a.width,D[1]=(.5-.5*D[1])*a.height,D[2]<_&&(y=I,_=D[2])}const T=I=>new Pt(p[I][0],p[I][1]);let A;switch(y){case 0:case 6:A=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:A=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:A=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:A=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(Ws(c,A))return _}const km=64,h_={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function ZB(c,a,l,f,p,_,y,T,A,I=!1){const D=l.zoom,F=l.project(f),z=Ke(f.lat,D),H=1/z;R(c),G(c,c,[F.x+y[0]*H,F.y+y[1]*H,y[2]]);let q=1,ne=1;const ie=l.worldSize;if(I){if(l.projection.name==="mercator"){let we=0;l.elevation&&(we=l.elevation.getAtPointOrZero(new _t(F.x/ie,F.y/ie),0));const Be=Yn([],[F.x,F.y,we,1],l.projMatrix)[3]/l.cameraToCenterDistance;q=Be,ne=Be*Ke(l.center.lat,D)}else if(l.projection.name==="globe"){const we=Ik(c,l),Be=[0,0,0,1];Yn(Be,Be,V([],l.projMatrix,we));const ze=Be[3]/l.cameraToCenterDistance,Ve=Ad(D),Ze=l.projection.pixelsPerMeter(f.lat,ie)*Ke(f.lat,D),Ye=l.projection.pixelsPerMeter(l.center.lat,ie)*Ke(l.center.lat,D);q=ze/Ir(Ze,ct(l.center.lat),Ve),ne=ze*z/Ze,q*=Ye,ne*=Ye}}else q=H;U(c,c,[q,q,ne]);const ae=[...c],me=a.orientation,ye=[];if(qB(ye,[me[0]+p[0],me[1]+p[1],me[2]+p[2]],_),V(c,ae,ye),T&&l.elevation){let we=0;const Be=[];if(A&&l.elevation){we=function(Ve,Ze,Ye,Ct,nt){const kt=Ze.elevation;if(!kt)return 0;const zt=Rr.projectAabbCorners(Ye,Ct),Ot=Me(1,nt.lat)*Ze.worldSize,Lt=function(qt,xr){const jr=[0,0,1],Qt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const gr of Qt){const Or=qt[gr.corners[0]],Vr=qt[gr.corners[1]],rn=qt[gr.corners[2]],Gr=[Vr[0]-Or[0],Vr[1]-Or[1],xr*(Vr[2]-Or[2])],hr=Yt(Gr,Gr,[rn[0]-Or[0],rn[1]-Or[1],xr*(rn[2]-Or[2])]);yt(hr,hr),gr.dotProductWithUp=Dt(hr,jr)}return Qt.sort((gr,Or)=>gr.dotProductWithUp-Or.dotProductWithUp),Qt[0].corners}(zt,Ot),$t=zt[Lt[0]],Et=zt[Lt[1]],Nt=zt[Lt[2]],gt=zt[Lt[3]],ut=kt.getAtPointOrZero(new _t($t[0]/Ze.worldSize,$t[1]/Ze.worldSize),0),Vt=kt.getAtPointOrZero(new _t(Et[0]/Ze.worldSize,Et[1]/Ze.worldSize),0),jt=kt.getAtPointOrZero(new _t(Nt[0]/Ze.worldSize,Nt[1]/Ze.worldSize),0),br=kt.getAtPointOrZero(new _t(gt[0]/Ze.worldSize,gt[1]/Ze.worldSize),0),ir=(ut+br)/2,dr=(Vt+jt)/2;return ir>dr?Vt<jt?qT(Ve,Et,gt,$t,Vt,br,ut,Ot):qT(Ve,Nt,$t,gt,jt,ut,br,Ot):ut<br?qT(Ve,$t,Et,Nt,ut,Vt,jt,Ot):qT(Ve,gt,Nt,Et,br,jt,Vt,Ot),Math.max(ir,dr)}(Be,l,a.aabb,c,f);const ze=V([],ve([],Be),ye);V(c,ae,ze)}else we=l.elevation.getAtPointOrZero(new _t(F.x/ie,F.y/ie),0);we!==0&&(c[14]+=we)}}function o1(c,a,l=!1){c.uploaded||(c.gfxTexture=new Ck(a,c.image,l?a.gl.R8:a.gl.RGBA8,{useMipmap:c.sampler.minFilter>=a.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function gre(c,a,l){c.indexBuffer=a.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=a.createVertexBuffer(c.vertexArray,cre.members,!1,!0),c.normalArray&&(c.normalBuffer=a.createVertexBuffer(c.normalArray,dre.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=a.createVertexBuffer(c.texcoordArray,fre.members,!1,!0)),c.colorArray&&(c.colorBuffer=a.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?ure:hre).members,!1,!0)),c.featureArray&&(c.pbrBuffer=a.createVertexBuffer(c.featureArray,mre.members,!0)),c.segments=Ti.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const f=c.material;f.pbrMetallicRoughness.baseColorTexture&&o1(f.pbrMetallicRoughness.baseColorTexture,a),f.pbrMetallicRoughness.metallicRoughnessTexture&&o1(f.pbrMetallicRoughness.metallicRoughnessTexture,a),f.normalTexture&&o1(f.normalTexture,a),f.occlusionTexture&&o1(f.occlusionTexture,a,l),f.emissionTexture&&o1(f.emissionTexture,a)}function kk(c,a,l){if(c.meshes)for(const f of c.meshes)gre(f,a,l);if(c.children)for(const f of c.children)kk(f,a,l)}function XT(c){if(c.meshes)for(const a of c.meshes)a.indexArray.destroy(),a.vertexArray.destroy(),a.colorArray&&a.colorArray.destroy(),a.normalArray&&a.normalArray.destroy(),a.texcoordArray&&a.texcoordArray.destroy(),a.featureArray&&a.featureArray.destroy();if(c.children)for(const a of c.children)XT(a)}function Ok(c){if(c.meshes)for(const l of c.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((a=l.material).pbrMetallicRoughness.baseColorTexture&&a.pbrMetallicRoughness.baseColorTexture.gfxTexture&&a.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),a.pbrMetallicRoughness.metallicRoughnessTexture&&a.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&a.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),a.normalTexture&&a.normalTexture.gfxTexture&&a.normalTexture.gfxTexture.destroy(),a.emissionTexture&&a.emissionTexture.gfxTexture&&a.emissionTexture.gfxTexture.destroy(),a.occlusionTexture&&a.occlusionTexture.gfxTexture&&a.occlusionTexture.gfxTexture.destroy()));var a;if(c.children)for(const l of c.children)Ok(l)}function Om(c,a){const l=c.json.bufferViews[a.bufferView],f=WT[a.componentType];return new f(c.buffers[l.buffer],(a.byteOffset||0)+(l.byteOffset||0),a.count*(l.byteStride&&l.byteStride!==i1[a.type]*f.BYTES_PER_ELEMENT?l.byteStride/f.BYTES_PER_ELEMENT:i1[a.type]))}function Mk(c,a,l,f){const p=WT[a.componentType],_=function(D){switch(D){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),y=c.json.bufferViews[a.bufferView],T=y.byteStride?y.byteStride/p.BYTES_PER_ELEMENT:i1[a.type],A=l.float32,I=A.length/l.capacity;for(let D=0,F=0;D<a.count*T;D+=T,F+=I)for(let z=0;z<I;z++)A[F+z]=f[D+z]*_;l._trim()}function _re(c,a,l){const f=c.indices,p=c.attributes,_={};_.indexArray=new Ta;const y=a.json.accessors[f],T=y.count/3;_.indexArray.reserve(T);const A=Om(a,y);for(let z=0;z<T;z++)_.indexArray.emplaceBack(A[3*z],A[3*z+1],A[3*z+2]);_.indexArray._trim(),_.vertexArray=new ns;const I=a.json.accessors[p.POSITION];_.vertexArray.reserve(I.count);const D=Om(a,I);for(let z=0;z<I.count;z++)_.vertexArray.emplaceBack(D[3*z],D[3*z+1],D[3*z+2]);if(_.vertexArray._trim(),_.aabb=new Rr(I.min,I.max),_.centroid=function(z,H){const q=[0,0,0],ne=z.length;if(ne>0){for(let ie=0;ie<ne;ie++){const ae=3*z[ie];q[0]+=H[ae],q[1]+=H[ae+1],q[2]+=H[ae+2]}q[0]/=ne,q[1]/=ne,q[2]/=ne}return q}(A,D),p.COLOR_0!==void 0){const z=a.json.accessors[p.COLOR_0],H=i1[z.type],q=Om(a,z);_.colorArray=H===3?new ns:new kl,_.colorArray.resize(z.count),Mk(a,z,_.colorArray,q)}if(p.NORMAL!==void 0){_.normalArray=new ns;const z=a.json.accessors[p.NORMAL];_.normalArray.resize(z.count);const H=Om(a,z);Mk(a,z,_.normalArray,H)}if(p.TEXCOORD_0!==void 0&&l.length>0){_.texcoordArray=new bd;const z=a.json.accessors[p.TEXCOORD_0];_.texcoordArray.resize(z.count);const H=Om(a,z);Mk(a,z,_.texcoordArray,H)}if(p._FEATURE_ID_RGBA4444!==void 0){const z=a.json.accessors[p._FEATURE_ID_RGBA4444];a.json.extensionsUsed&&a.json.extensionsUsed.includes("EXT_meshopt_compression")&&(_.featureData=Om(a,z))}p._FEATURE_RGBA4444!==void 0&&(_.featureData=new Uint32Array(Om(a,a.json.accessors[p._FEATURE_RGBA4444]).buffer));const F=c.material;return _.material=function(z,H){const{emissiveFactor:q=[0,0,0],alphaMode:ne="OPAQUE",alphaCutoff:ie=.5,normalTexture:ae,occlusionTexture:me,emissiveTexture:ye,doubleSided:we}=z,{baseColorFactor:Be=[1,1,1,1],metallicFactor:ze=1,roughnessFactor:Ve=1,baseColorTexture:Ze,metallicRoughnessTexture:Ye}=z.pbrMetallicRoughness||{},Ct=me?H[me.index]:void 0;if(me&&me.extensions&&me.extensions.KHR_texture_transform&&Ct){const nt=me.extensions.KHR_texture_transform;Ct.offsetScale=[nt.offset[0],nt.offset[1],nt.scale[0],nt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new On(...Be),metallicFactor:ze,roughnessFactor:Ve,baseColorTexture:Ze?H[Ze.index]:void 0,metallicRoughnessTexture:Ye?H[Ye.index]:void 0},doubleSided:we,emissiveFactor:new On(...q),alphaMode:ne,alphaCutoff:ie,normalTexture:ae?H[ae.index]:void 0,occlusionTexture:Ct,emissionTexture:ye?H[ye.index]:void 0,defined:z.defined===void 0}}(F!==void 0?a.json.materials[F]:{defined:!1},l),_}function YB(c,a,l){const{matrix:f,rotation:p,translation:_,scale:y,mesh:T,extras:A,children:I}=c,D={};if(D.matrix=f||function(F,z,H,q){var ne=z[0],ie=z[1],ae=z[2],me=z[3],ye=ne+ne,we=ie+ie,Be=ae+ae,ze=ne*ye,Ve=ne*we,Ze=ne*Be,Ye=ie*we,Ct=ie*Be,nt=ae*Be,kt=me*ye,zt=me*we,Ot=me*Be,Lt=q[0],$t=q[1],Et=q[2];return F[0]=(1-(Ye+nt))*Lt,F[1]=(Ve+Ot)*Lt,F[2]=(Ze-zt)*Lt,F[3]=0,F[4]=(Ve-Ot)*$t,F[5]=(1-(ze+nt))*$t,F[6]=(Ct+kt)*$t,F[7]=0,F[8]=(Ze+zt)*Et,F[9]=(Ct-kt)*Et,F[10]=(1-(ze+Ye))*Et,F[11]=0,F[12]=H[0],F[13]=H[1],F[14]=H[2],F[15]=1,F}([],p||[0,0,0,1],_||[0,0,0],y||[1,1,1]),T!==void 0){D.meshes=l[T];const F=D.anchor=[0,0];for(const z of D.meshes){const{min:H,max:q}=z.aabb;F[0]+=H[0]+q[0],F[1]+=H[1]+q[1]}F[0]=Math.floor(F[0]/D.meshes.length/2),F[1]=Math.floor(F[1]/D.meshes.length/2)}if(A&&(A.id&&(D.id=A.id),A.lights&&(D.lights=function(F){if(!F.length)return[];const z=function(ae){const me=atob(ae),ye=new Uint8Array(me.length);for(let we=0;we<me.length;we++)ye[we]=me.codePointAt(we);return ye}(F),H=[],q=z.length/24,ne=new Uint16Array(z.buffer),ie=new Float32Array(z.buffer);for(let ae=0;ae<q;ae++){const me=ne[2*ae*6]/30,ye=ne[2*ae*6+1]/30,we=ne[2*ae*6+10]/100,Be=ie[6*ae+1],ze=ie[6*ae+2],Ve=ie[6*ae+3],Ze=ie[6*ae+4],Ye=Ve-Be,Ct=Ze-ze,nt=Math.hypot(Ye,Ct);H.push({pos:[Be+.5*Ye,ze+.5*Ct,ye],normal:[Ct/nt,-Ye/nt,0],width:nt,height:me,depth:we,points:[Be,ze,Ve,Ze]})}return H}(A.lights))),I){const F=[];for(const z of I)F.push(YB(a.json.nodes[z],a,l));D.children=F}return D}function yre(c){if(c.vertices.length===0||c.indices.length===0)return null;const a=new LT(c.vertices,c.indices,8,256),[l,f]=[a.min.clone(),a.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:a,min:l,max:f}}function vre(c){if(!c.extras||!c.extras.ground)return null;const a=c.extras.ground;if(!a||!Array.isArray(a)||a.length===0)return null;const l=a[0];if(!l||!Array.isArray(l)||l.length===0)return null;const f=[];for(const y of l){if(!Array.isArray(y)||y.length!==2)continue;const T=y[0],A=y[1];typeof T=="number"&&typeof A=="number"&&f.push(new Pt(T,A))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let p=0;for(let y=0;y<f.length;y++){const T=f[y],A=f[(y+1)%f.length],I=f[(y+2)%f.length];p+=(T.x-A.x)*(I.y-A.y)-(I.x-A.x)*(T.y-A.y)}p>0&&f.reverse();const _=a_(f.flatMap(y=>[y.x,y.y]),[]);return _.length===0?null:{vertices:f,indices:_}}function xre(c,a){const l=[],f=[];let p=0;const _=[];for(const y of c){p=l.length;const T=y.vertexArray.float32,A=y.indexArray.uint16;for(let I=0;I<y.vertexArray.length;I++)_[0]=T[3*I+0],_[1]=T[3*I+1],_[2]=T[3*I+2],Mt(_,_,a),l.push(new Pt(_[0],_[1]));for(let I=0;I<3*y.indexArray.length;I++)f.push(A[I]+p)}if(f.length%3!=0)return null;for(let y=0;y<f.length;y+=3){const T=l[f[y+0]],A=l[f[y+1]],I=l[f[y+2]];(T.x-A.x)*(I.y-A.y)-(I.x-A.x)*(T.y-A.y)>0&&([f[y+1],f[y+2]]=[f[y+2],f[y+1]])}return{vertices:l,indices:f}}function KB(c){const a=function(A,I){const D=[],F=WebGL2RenderingContext;if(A.json.textures)for(const z of A.json.textures){const H={magFilter:F.LINEAR,minFilter:F.NEAREST,wrapS:F.REPEAT,wrapT:F.REPEAT};z.sampler!==void 0&&Object.assign(H,A.json.samplers[z.sampler]),D.push({image:I[z.source],sampler:H,uploaded:!1})}return D}(c,c.images),l=function(A,I){const D=[];for(const F of A.json.meshes){const z=[];for(const H of F.primitives)z.push(_re(H,A,I));D.push(z)}return D}(c,a),{scenes:f,scene:p,nodes:_}=c.json,y=f?f[p||0].nodes:[..._.keys()],T=[];for(const A of y)T.push(YB(_[A],c,l));return function(A,I,D){const F={},z=new Set;for(let H=0;H<A.length;H++){const q=D[I[H]];if(!q.extras)continue;const ne=q.extras["mapbox:footprint:version"],ie=q.extras["mapbox:footprint:id"];(ne||ie)&&z.add(H),ne==="1.0.0"&&ie&&(F[ie]=H)}for(let H=0;H<A.length;H++){if(z.has(H))continue;const q=A[H],ne=D[I[H]];if(!ne.extras)continue;let ie=null;q.id in F&&(ie=xre(A[F[q.id]].meshes,q.matrix)),ie||(ie=vre(ne)),ie&&(q.footprint=yre(ie))}if(z.size>0){const H=Array.from(z.values()).sort((q,ne)=>q-ne);for(let q=H.length-1;q>=0;q--)A.splice(H[q],1)}}(T,y,c.json.nodes),T}function wre(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const a=c.vertexArray.float32,l=c.aabb.min[0]-1,f=c.aabb.min[1]-1,p=km/(c.aabb.max[0]-l+2),_=km/(c.aabb.max[1]-f+2);for(let y=0;y<a.length;y+=3){const T=a[y+2],A=(a[y+0]-l)*p|0,I=(a[y+1]-f)*_|0;T>c.heightmap[I*km+A]&&(c.heightmap[I*km+A]=T)}}function JB(c,a,l,f,p){l.reserve(l.length+4*c.length),f.reserve(f.length+10*c.length),p.reserve(p.length+10*c.length);let _=f.length;for(const y of c){const T=Math.min(10,Math.max(4,1.3*y.height))*a,A=[-y.normal[1],y.normal[0],0],I=Math.min(.29,.1*y.width/y.depth),D=y.width-2*y.depth*a*(I+.01),F=_e([],y.pos,A,D/2),z=_e([],y.pos,A,-D/2),H=[F[0],F[1],F[2]+y.height],q=[z[0],z[1],z[2]+y.height],ne=_e([],y.normal,A,I);Rt(ne,ne,T);const ie=_e([],y.normal,A,-I);Rt(ie,ie,T),at(ne,F,ne),at(ie,z,ie),F[2]+=.1,z[2]+=.1,f.emplaceBack(ne[0],ne[1],ne[2]),f.emplaceBack(ie[0],ie[1],ie[2]),f.emplaceBack(F[0],F[1],F[2]),f.emplaceBack(z[0],z[1],z[2]),f.emplaceBack(H[0],H[1],H[2]),f.emplaceBack(q[0],q[1],q[2]),f.emplaceBack(F[0],F[1],F[2]),f.emplaceBack(z[0],z[1],z[2]),f.emplaceBack(ne[0],ne[1],ne[2]),f.emplaceBack(ie[0],ie[1],ie[2]);const ae=D/T/2;p.emplaceBack(-ae-I,-1,ae,.8),p.emplaceBack(ae+I,-1,ae,.8),p.emplaceBack(-ae,0,ae,1.3),p.emplaceBack(ae,0,ae,1.3),p.emplaceBack(ae+I,-.8,ae,.7),p.emplaceBack(ae+I,-.8,ae,.7),p.emplaceBack(0,0,ae,1.3),p.emplaceBack(0,0,ae,1.3),p.emplaceBack(ae+I,-1.2,ae,.8),p.emplaceBack(ae+I,-1.2,ae,.8),l.emplaceBack(6+_,4+_,8+_),l.emplaceBack(7+_,9+_,5+_),l.emplaceBack(0+_,1+_,2+_),l.emplaceBack(1+_,3+_,2+_),_+=10}}function bre(c,a){const l={};l.indexArray=new Ta,l.vertexArray=new ns,l.colorArray=new kl,JB(c,a,l.indexArray,l.vertexArray,l.colorArray);const f={defined:!0};f.emissiveFactor=On.black;const p={};return p.baseColorFactor=On.white,f.pbrMetallicRoughness=p,l.material=f,l.aabb=new Rr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}const QB=fn([{name:"a_pos_3f",components:3,type:"Float32"}]),Tre=fn([{name:"a_normal_3",components:3,type:"Int16"}]),Sre=fn([{name:"a_centroid_3",components:3,type:"Int16"}]),ez=fn([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),Ere=fn([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),Are=fn([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),Cre=fn([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),Pre=fn([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),tz=Bt.types,Rk=32767;function Ire(c,a){const l=Zt+a;for(const f of c)for(const p of f)if(p.x<-a||p.x>l||p.y<-a||p.y>l)return!1;return!0}class rz{constructor(){this.layoutVertexArray=new ns,this.layoutAttenuationArray=new kl,this.layoutColorArray=new ma,this.indexArray=new Ta,this.indexArrayForConflation=new Ta,this.segmentsBucket=new Ti}}class Dk{constructor(){this.layoutVertexArray=new ns,this.layoutNormalArray=new ef,this.layoutCentroidArray=new ef,this.layoutColorArray=new ma,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutAOArray=[],this.indexArray=new Ta,this.indexArrayForConflation=new Ta,this.segmentsBucket=new Ti,this.entranceBloom=new rz}}class nz{constructor(a){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new Dk,this.buildingWithFacade=new Dk,this.indexArrayForConflationUploaded=!1,this.footprintLookup={},this.zoom=a.zoom,this.canonical=a.canonical,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.worldview=a.worldview,this.lut=a.lut,this.buildingWithFacade.layoutFacadePaintArray=new ma,this.buildingWithFacade.layoutFacadeDataArray=new vd,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new ma,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=a.projection,this.groundEffect=new yk(a)}updateFootprints(a,l){for(const f of this.footprints)l.push({footprint:f,id:a})}prepare(){return function(){if(VT!=null||FB!=null)return null;if(u_!=null)return u_;const a=fetch(Ao.BUILDING_GEN_URL);return u_=function(l){let f,p,_,y;function T(){f=new Uint8Array(y.buffer),p=new Int32Array(y.buffer),_=new Float32Array(y.buffer)}function A(){throw new Error("Unexpected BuildingGen error.")}const I=()=>{},D={a:{a:A,f:function(F){const z=f.length,H=Math.max(F>>>0,Math.ceil(1.2*z)),q=Math.ceil((H-z)/65536);try{return y.grow(q),T(),!0}catch{return!1}},g:A,b:I,c:I,d:I,e:I}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(l,D):l.then(F=>F.arrayBuffer()).then(F=>WebAssembly.instantiate(F,D))).then(F=>{const z=F.instance.exports;return(0,z.g)(),y=z.f,T(),new rre({setStyle:z.h,setAOOptions:z.i,setMetricOptions:z.j,setStructuralOptions:z.k,setFacadeOptions:z.l,setFauxFacadeOptions:z.m,setFacadeClassifierOptions:z.n,addFeature:z.o,addFacade:z.p,generateMesh:z.q,getLastError:z.r,getOuterRingLength:z.s,getMeshCount:z.t,getPositionsPtr:z.u,getPositionsLength:z.v,getNormalsPtr:z.w,getNormalsLength:z.x,getColorsPtr:z.y,getColorsLength:z.z,getAOPtr:z.A,getAOLength:z.B,getUVPtr:z.C,getUVLength:z.D,getFauxFacadePtr:z.E,getFauxFacadeLength:z.F,getIndicesPtr:z.G,getIndicesLength:z.H,getBuildingPart:z.I,getRingCount:z.J,getRingPtr:z.K,getRingLength:z.L,free:z.M,malloc:z.N,heapU8:f,heap32:p,heapF32:_})})}(a).then(l=>(u_=null,VT=l,VT)).catch(l=>{nr("Could not load building-gen"),u_=null,FB=l}),u_}()}populate(a,l,f,p){const _=nre();if(!_)return;const y=st(f);this.tileToMeter=y,this.brightness=l.brightness,_.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,y],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:y,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),_.setAOOptions(!1,.3),_.setMetricOptions(!1,16),_.setStructuralOptions(!0),_.setFacadeClassifierOptions(3);const T=new Map;for(const{feature:A}of a){if(tz[A.type]!=="LineString")continue;const I=this.layers[0]._featureFilter.needGeometry,D=Ut(A,I);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),D,f))continue;const F=I?D.geometry:tr(A,f,p),z=[];for(const ie of F)for(const ae of ie)z.push({x:ae.x,y:ae.y});const H={coordinates:z,crossPerc:A.properties.cross_perc,distanceToRoad:A.properties.distance_to_road,entrances:A.properties.entrances,sourceId:0},q=A.properties.source_id;let ne=T.get(q);ne||(ne=[],T.set(q,ne)),ne.push(H)}this.maxHeight=0;for(const{feature:A,index:I}of a){if(tz[A.type]==="LineString")continue;const D=this.layers[0]._featureFilter.needGeometry,F=Ut(A,D);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),F,f))continue;const z=D?F.geometry:tr(A,f,p),H=Zx(z,500);if(!Ire(z,163))continue;const q=this.layers[0],ne=q.layout.get("building-base").evaluate(A,{},f),ie=q.layout.get("building-height").evaluate(A,{},f),ae=q.layout.get("building-roof-shape").evaluate(A,{},f),me=q.paint.get("building-ambient-occlusion-intensity"),ye=q.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(ae==="flat")continue;const we=q.layout.get("building-facade").evaluate(A,{},f);_.setFacadeOptions(4,!0),_.setFauxFacadeOptions(we,!1,1);const Be=A.properties.source_id;let ze;ze=T.has(Be)?T.get(Be):[];let Ve=0,Ze=0,Ye=0,Ct=0,nt=0,kt=0;if(we){let hr=Math.round(q.layout.get("building-facade-floors").evaluate(A,{},f));if(ne===0){hr=Math.max(1,hr-(ze.length>0?1:0));let dn=4;if(ie>100){const Ae=[10,13,15];dn=Ae[A.id?A.id%Ae.length:0],_.setFacadeOptions(dn,!0)}nt=1.6803*dn/y}else nt=ne/y;kt=ie/y,nt=Math.min(nt,kt),Ye=q.layout.get("building-facade-unit-width").evaluate(A,{},f)/y,Ct=(kt-nt)/hr,_.setFauxFacadeOptions(!0,!0,Ye);const Wr=q.layout.get("building-facade-window").evaluate(A,{},f);Ve=Wr[0],Ze=Wr[1]}const zt=[],Ot=new Pt(1/0,1/0),Lt=new Pt(-1/0,-1/0),$t=new Pt(0,0);let Et=0;for(const hr of H)if(hr.length>0){const Wr=[];for(const dn of hr){const Ae=[];for(let Ce=dn.length-1;Ce>=0;Ce--){const dt=dn[Ce];Ae.push({x:dt.x,y:dt.y}),Ot.x=Math.min(Ot.x,dt.x),Ot.y=Math.min(Ot.y,dt.y),Lt.x=Math.max(Lt.x,dt.x),Lt.y=Math.max(Lt.y,dt.y),$t.x+=dt.x,$t.y+=dt.y,Et++}Wr.push(Ae)}zt.push({id:A.id?A.id:0,height:ie,minHeight:ne,sourceId:0,roofType:ae,coordinates:Wr})}$t.x/=Et||1,$t.y/=Et||1;const Nt=_.generateMesh(zt,ze);if(typeof Nt=="string"){nr(`Unable to generate building ${A.id}: ${Nt}`);continue}if(Nt.meshes.length===0||Nt.modifiedPolygonRings.length===0)continue;let gt=0;for(const hr of Nt.meshes)gt+=hr.positions.length/3;const ut=we?this.buildingWithFacade:this.buildingWithoutFacade,Vt=ut.segmentsBucket.prepareSegment(gt,ut.layoutVertexArray,ut.indexArray),jt=[];let br=null,ir=0,dr=-1;const qt=ut.indexArray.length;let xr=0;for(const hr of Nt.meshes){const Wr=ut.layoutVertexArray.length;if(hr.buildingPart==="entrance"){const At=new Array;for(let Er=0;Er<hr.indices.length;Er+=12){const nn=hr.positions[Er+0],on=hr.positions[Er+1],tn=hr.positions[Er+3],Fn=hr.positions[Er+4],mi=hr.positions[Er+2],en=hr.positions[Er+8]-mi,Jn=1,Bn=tn-nn,bn=Fn-on,ri=Math.hypot(Bn,bn);At.push({pos:[nn+.5*Bn,on+.5*bn,mi],normal:[bn/ri,-Bn/ri,0],width:ri,height:en,depth:Jn,points:[nn,on,tn,Fn]})}const Jt=ut.entranceBloom.segmentsBucket.prepareSegment(10*At.length,ut.entranceBloom.layoutVertexArray,ut.entranceBloom.indexArray),Kt=ut.entranceBloom.layoutVertexArray.length;ir=ut.entranceBloom.indexArray.length,JB(At,.5/this.tileToMeter,ut.entranceBloom.indexArray,ut.entranceBloom.layoutVertexArray,ut.entranceBloom.layoutAttenuationArray);const lr=ut.entranceBloom.layoutVertexArray.length-Kt;dr=ut.entranceBloom.indexArray.length-ir;for(let Er=0;Er<lr;Er++)ut.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Jt.vertexLength+=lr,Jt.primitiveLength+=dr,br={part:hr.buildingPart,vertexOffset:Kt,vertexLength:lr}}for(let At=0;At<hr.positions.length;At+=3)xr=Math.max(xr,hr.positions[At+2]),ut.layoutVertexArray.emplaceBack(hr.positions[At],hr.positions[At+1],hr.positions[At+2]);const dn=Math.floor($t.x),Ae=Math.floor($t.y),Ce=Math.floor(xr);for(let At=0;At<hr.positions.length;At+=3)ut.layoutCentroidArray.emplaceBack(dn,Ae,Ce);for(let At=0;At<hr.normals.length;At+=3)ut.layoutNormalArray.emplaceBack(hr.normals[At+0]*Rk,hr.normals[At+1]*Rk,hr.normals[At+2]*Rk);for(let At=0;At<hr.ao.length;At++)ut.layoutAOArray.push(hr.ao[At]);for(let At=0;At<hr.colors.length;At+=3){const Jt=1+(hr.ao[At/3]-1)*me;ut.layoutColorArray.emplaceBack(hr.colors[At]*Jt<<8|hr.colors[At+1]*Jt,hr.colors[At+2]*Jt<<8)}if(we){for(let At=0;At<hr.positions.length;At+=3)ut.layoutFacadePaintArray.emplaceBack(65535,255);for(let At=0;At<hr.isFauxFacade.length;At++)if(hr.isFauxFacade[At]){const Jt=1|Math.min(65535,Math.floor(hr.uv[2*At]*Nt.outerRingLength)),Kt=Math.floor(255*Ve)<<8|Math.floor(255*Ze),lr=Math.floor(65535*Math.min(1,Ye/Zt)),Er=Math.floor(65535*Math.min(1,Ct/Zt));ut.layoutFacadeDataArray.emplaceBack(Jt,Kt,lr,Er);const nn=Math.floor(65535*Math.min(1,nt/Zt)),on=Math.floor(65535*Math.min(1,kt/Zt));ut.layoutFacadeVerticalRangeArray.emplaceBack(nn,on)}else ut.layoutFacadeDataArray.emplaceBack(0,0,0,0),ut.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const dt=Vt.vertexLength;for(let At=0;At<hr.indices.length;At+=3)ut.indexArray.emplaceBack(dt+hr.indices[At],dt+hr.indices[At+1],dt+hr.indices[At+2]);Vt.vertexLength+=hr.positions.length/3,Vt.primitiveLength+=hr.indices.length/3,(hr.buildingPart==="roof"||hr.buildingPart==="wall"||hr.buildingPart==="facade_glazing"||hr.buildingPart==="entrance")&&jt.push({part:hr.buildingPart,vertexOffset:Wr,vertexLength:hr.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,xr),this.buildingFeatures.push({feature:F,hasFauxFacade:we,segment:Vt,parts:jt,buildingBloom:br});const jr=ut.indexArray.length-qt,Qt=[],gr=[],Or=new Pt(1/0,1/0),Vr=new Pt(-1/0,-1/0),rn=this.groundEffect.vertexArray.length;for(const hr of Nt.modifiedPolygonRings){const Wr=[],dn=new Pt(1/0,1/0),Ae=new Pt(-1/0,-1/0);for(let Ce=0;Ce<hr.length;Ce+=2){const dt=hr.length-Ce-2;dn.x=Math.min(dn.x,hr[dt]),dn.y=Math.min(dn.y,hr[dt+1]),Ae.x=Math.max(Ae.x,hr[dt]),Ae.y=Math.max(Ae.y,hr[dt+1]);const At=new Pt(hr[dt],hr[dt+1]);Wr.push(At),Qt.push(At.x,At.y),gr.push(At.clone())}Or.x=Math.min(Or.x,dn.x),Or.y=Math.min(Or.y,dn.y),Vr.x=Math.max(Vr.x,Ae.x),Vr.y=Math.max(Vr.y,Ae.y),this.groundEffect.addData(Wr,[dn,Ae],ye)}const Gr=this.groundEffect.vertexArray.length-rn;(Ot.x<0||Lt.x>Zt||Ot.y<0||Lt.y>Zt)&&this.featuresOnBorder.push({featureId:A.id,footprintIndex:this.footprints.length});{const hr=a_(Qt,null,2),Wr=new LT(gr,hr,8,256);let dn=A.id;A.properties&&A.properties.hasOwnProperty("building_id")&&(dn=A.properties.building_id),this.footprints.push({vertices:gr,indices:hr,grid:Wr,min:Or,max:Vr,buildingId:dn,hiddenFlags:0,indicesOffset:qt,indicesLength:jr,bloomIndicesOffset:ir,bloomIndicesLength:dr,groundEffectVertexOffset:rn,groundEffectVertexLength:Gr,hasFauxFacade:we,segment:Vt,height:xr})}this.programConfigurations.populatePaintArrays(ut.layoutVertexArray.length,A,I,{},l.availableImages,f,l.brightness),this.groundEffect.addPaintPropertiesData(A,I,{},l.availableImages,f,l.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(a,l,f,p,_,y,T){this.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T),this.groundEffect.update(a,l,_,f,p,y,T),this.evaluate(this.layers[0],a),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(a){const l=f=>{f.layoutVertexBuffer=a.createVertexBuffer(f.layoutVertexArray,QB.members),f.layoutNormalBuffer=a.createVertexBuffer(f.layoutNormalArray,Tre.members),f.layoutCentroidBuffer=a.createVertexBuffer(f.layoutCentroidArray,Sre.members),f.layoutFacadeDataArray&&f.layoutFacadeDataArray.length&&(f.layoutFacadeDataBuffer=a.createVertexBuffer(f.layoutFacadeDataArray,Are.members)),f.layoutFacadeVerticalRangeArray&&f.layoutFacadeVerticalRangeArray.length&&(f.layoutFacadeVerticalRangeBuffer=a.createVertexBuffer(f.layoutFacadeVerticalRangeArray,Cre.members)),f.entranceBloom.layoutVertexArray.length&&(f.entranceBloom.layoutVertexBuffer=a.createVertexBuffer(f.entranceBloom.layoutVertexArray,QB.members),f.entranceBloom.layoutAttenuationBuffer=a.createVertexBuffer(f.entranceBloom.layoutAttenuationArray,Pre.members)),this.uploadUpdatedColorBuffer(a),this.uploadUpdatedIndexBuffer(a)};this.uploaded||(l(this.buildingWithoutFacade),l(this.buildingWithFacade),this.groundEffect.upload(a)),this.groundEffect.uploadPaintProperties(a),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){const a=l=>{l.layoutVertexBuffer&&(l.layoutVertexBuffer.destroy(),l.layoutNormalBuffer.destroy(),l.layoutColorBuffer.destroy(),l.segmentsBucket.destroy(),l.indexBuffer&&l.indexBuffer.destroy(),l.entranceBloom.layoutVertexBuffer&&(l.entranceBloom.layoutVertexBuffer.destroy(),l.entranceBloom.layoutColorBuffer.destroy(),l.entranceBloom.layoutAttenuationBuffer.destroy(),l.entranceBloom.indexBuffer.destroy(),l.entranceBloom.segmentsBucket.destroy()))};a(this.buildingWithoutFacade),a(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(a,l,f=!0){let p=!1;const _=f?l:0,y=0|(f?-1:~l);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const T of a){const A=this.footprints[T],I=A.hiddenFlags&y|_;A.hiddenFlags!==I&&(A.hiddenFlags=I,p=!0,this.groundEffect.updateHiddenByLandmarkRange(A.groundEffectVertexOffset,A.groundEffectVertexLength,A.hiddenFlags!==0))}return p&&(this.indexArrayForConflationUploaded=!1),p}uploadUpdatedIndexBuffer(a){if(this.groundEffect.uploadHiddenByLandmark(a),this.indexArrayForConflationUploaded)return;const l=p=>{p.indexArray.length!==0&&(p.indexArrayForConflation.resize(p.indexArray.length),p.indexArrayForConflation.uint16.set(p.indexArray.uint16),p.entranceBloom.indexArrayForConflation.resize(p.entranceBloom.indexArray.length),p.entranceBloom.indexArrayForConflation.uint16.set(p.entranceBloom.indexArray.uint16))};l(this.buildingWithoutFacade),l(this.buildingWithFacade);for(const p of this.footprints){const _=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,y=p.indicesOffset+p.indicesLength;if(p.hiddenFlags!==0){for(let A=p.indicesOffset;A<y;A++)_.indexArrayForConflation.uint16[3*A+0]=0,_.indexArrayForConflation.uint16[3*A+1]=0,_.indexArrayForConflation.uint16[3*A+2]=0;const T=p.bloomIndicesOffset+p.bloomIndicesLength;for(let A=p.bloomIndicesOffset;A<T;A++)_.entranceBloom.indexArrayForConflation.uint16[3*A+0]=0,_.entranceBloom.indexArrayForConflation.uint16[3*A+1]=0,_.entranceBloom.indexArrayForConflation.uint16[3*A+2]=0}}const f=p=>{p.indexArray.length!==0&&(p.indexBuffer?p.indexBuffer.updateData(p.indexArrayForConflation):p.indexBuffer=a.createIndexBuffer(p.indexArrayForConflation,!0),p.entranceBloom.indexBuffer?p.entranceBloom.indexBuffer.updateData(p.entranceBloom.indexArrayForConflation):p.entranceBloom.indexBuffer=a.createIndexBuffer(p.entranceBloom.indexArrayForConflation,!0))};f(this.buildingWithoutFacade),f(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(a){const l=f=>{f.layoutColorBuffer?f.layoutColorBuffer.updateData(f.layoutColorArray):f.layoutColorBuffer=a.createVertexBuffer(f.layoutColorArray,ez.members,!0),f.layoutFacadePaintArray&&(f.layoutFacadePaintBuffer?f.layoutFacadePaintBuffer.updateData(f.layoutFacadePaintArray):f.layoutFacadePaintBuffer=a.createVertexBuffer(f.layoutFacadePaintArray,Ere.members,!0)),f.entranceBloom.layoutColorBuffer?f.entranceBloom.layoutColorBuffer.updateData(f.entranceBloom.layoutColorArray):f.entranceBloom.layoutColorBuffer=a.createVertexBuffer(f.entranceBloom.layoutColorArray,ez.members,!0)};l(this.buildingWithoutFacade),l(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(a,l){const f=a.paint.get("building-ambient-occlusion-intensity");for(const p of this.buildingFeatures){const _=l[p.feature.id],y=p.feature;y.properties["building-part"]="roof";const T=a.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),A=a.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="wall";const I=a.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),D=a.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="window";const F=a.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),z=a.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="door";const H=a.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),q=a.paint.get("building-emissive-strength").evaluate(y,_,this.canonical),ne=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const ae of p.parts){let me,ye=T;ae.part==="roof"?(ye=T,me=A):ae.part==="wall"?(ye=I,me=D):ae.part==="facade_glazing"?(ye=F,me=z):ae.part==="entrance"&&(ye=H,me=q),me=Q(me,0,1);for(let we=0;we<ae.vertexLength;we++){const Be=ae.vertexOffset+we,ze=1+(ne.layoutAOArray[Be]-1)*f;ne.layoutColorArray.emplace(Be,ye.r*ze*255<<8|ye.g*ze*255,ye.b*ze*255<<8|255*me),p.hasFauxFacade&&ne.layoutFacadePaintArray.emplace(Be,255*F.r<<8|255*F.g,255*F.b<<8|255*z)}}const ie=p.buildingBloom;if(ie)for(let ae=0;ae<ie.vertexLength;ae++)ne.entranceBloom.layoutColorArray.emplace(ie.vertexOffset+ae,255*H.r<<8|255*H.g,255*H.b<<8|51*q)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(a,l,f){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(a.toUnwrapped());if(BT(this.activeReplacements,p))return;this.activeReplacements=p;for(const y of this.footprints)y.hiddenFlags&=-2;const _=[];for(const y of this.activeReplacements){if(y.order<=sB)continue;const T=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-a.canonical.z));for(const A of this.footprints)A.min.x>y.max.x||A.max.x<y.min.x||A.min.y>y.max.y||A.max.y<y.min.y||(_.length=0,kre(A.vertices,0,A.vertices.length,y.footprintTileId.canonical,a.canonical,_),pk(y.footprint,_,A.indices,0,A.indices.length,0,-T)&&(A.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const y of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(y.groundEffectVertexOffset,y.groundEffectVertexLength,y.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(a,l){let f=Number.NEGATIVE_INFINITY,p=!0;const _=4*(a+Zt)*Zt+(l+Zt);if(this.footprintLookup.hasOwnProperty(_)){const T=this.footprintLookup[_];return T?{height:T.height,hidden:T.hiddenFlags!==0}:void 0}const y=new Pt(a,l);for(const T of this.footprints)a>T.max.x||T.min.x>a||l>T.max.y||T.min.y>l||T.height<=f||mk(y,T)&&(f=T.height,this.footprintLookup[_]=T,p=T.hiddenFlags!==0);if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:p};this.footprintLookup[_]=void 0}}function kre(c,a,l,f,p,_){const y=Math.pow(2,f.z-p.z);for(let T=0;T<l;T++){let A=c[T+a].x,I=c[T+a].y;A=(A+p.x*Zt)*y-f.x*Zt,I=(I+p.y*Zt)*y-f.y*Zt,_.push(new Pt(A,I))}}let iz,az;sr(nz,"BuildingBucket",{omit:["layers"]}),sr(Dk,"BuildingGeometry"),sr(rz,"BuildingBloomGeometry");const Ore=fn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Mre=fn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Rre}=Ore,Dre=fn([{name:"a_packed",components:3,type:"Float32"}]),{members:Fre}=Dre,Lre=fn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Nre}=Lre;class oz{constructor(a,l){this.width=a,this.height=l,this.nextRow=0,this.image=new Cd({width:a,height:l}),this.positions={},this.uploaded=!1}getDash(a,l){const f=this.getKey(a,l);return this.positions[f]}trim(){const a=this.width,l=this.height=ot(this.nextRow);this.image.resize({width:a,height:l})}getKey(a,l){return a.join(",")+l}getDashRanges(a,l,f){const p=[];let _=a.length%2==1?-a[a.length-1]*f:0,y=a[0]*f,T=!0;p.push({left:_,right:y,isDash:T,zeroLength:a[0]===0});let A=a[0];for(let I=1;I<a.length;I++){T=!T;const D=a[I];_=A*f,A+=D,y=A*f,p.push({left:_,right:y,isDash:T,zeroLength:D===0})}return p}addRoundDash(a,l,f){const p=l/2;for(let _=-f;_<=f;_++){const y=this.width*(this.nextRow+f+_);let T=0,A=a[T];for(let I=0;I<this.width;I++){I/A.right>1&&(A=a[++T]);const D=Math.abs(I-A.left),F=Math.abs(I-A.right),z=Math.min(D,F);let H;const q=_/f*(p+1);if(A.isDash){const ne=p-Math.abs(q);H=Math.sqrt(z*z+ne*ne)}else H=p-Math.sqrt(z*z+q*q);this.image.data[y+I]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(a,l){for(let A=a.length-1;A>=0;--A){const I=a[A],D=a[A+1];I.zeroLength?a.splice(A,1):D&&D.isDash===I.isDash&&(D.left=I.left,a.splice(A,1))}const f=a[0],p=a[a.length-1];f.isDash===p.isDash&&(f.left=p.left-this.width,p.right=f.right+this.width);const _=this.width*this.nextRow;let y=0,T=a[y];for(let A=0;A<this.width;A++){A/T.right>1&&(T=a[++y]);const I=Math.abs(A-T.left),D=Math.abs(A-T.right),F=Math.min(I,D);this.image.data[_+A]=Math.max(0,Math.min(255,(T.isDash?F:-F)+l+128))}}addDash(a,l){const f=this.getKey(a,l);if(this.positions[f])return this.positions[f];const p=l==="round",_=p?7:0,y=2*_+1;if(this.nextRow+y>this.height)return nr("LineAtlas out of space"),null;a.length===0&&a.push(1);let T=0;for(let D=0;D<a.length;D++)a[D]<0&&(nr("Negative value is found in line dasharray, replacing values with 0"),a[D]=0),T+=a[D];if(T!==0){const D=this.width/T,F=this.getDashRanges(a,this.width,D);p?this.addRoundDash(F,D,_):this.addRegularDash(F,l==="square"?.5*D:0)}const A=this.nextRow+_;this.nextRow+=y;const I={tl:[A,_],br:[T,0]};return this.positions[f]=I,I}}sr(oz,"LineAtlas");const Bre=Bt.types,zre=Math.cos(Math.PI/180*37.5),jre=Math.cos(Math.PI/180*5);class Fk{constructor(a){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=a.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=a.overscaling,this.pixelRatio=a.pixelRatio,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new qg,this.layoutVertexArray2=new ns,this.patternVertexArray=new ns,this.indexArray=new Ta,this.programConfigurations=new Ol(a.layers,{zoom:a.zoom,lut:a.lut}),this.segments=new Ti,this.maxLineLength=0,this.zOffsetVertexArray=new ns,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=a.tessellationStep?a.tessellationStep:Zt/64,this.worldview=a.worldview}updateFootprints(a,l){}populate(a,l,f,p){this.hasPattern=lk("line",this.layers,this.pixelRatio,l);const _=this.layers[0].layout.get("line-sort-key");this.tileToMeter=st(f);const y=this.layers[0].layout.get("line-elevation-reference");if(y==="hd-road-markup")this.elevationType="road";else{const z=this.layers[0].layout.get("line-z-offset"),H=z.isConstant()&&!z.constantOr(0);this.elevationType=y!=="sea"&&y!=="ground"&&H?"none":"offset",this.elevationType==="offset"&&y==="none"&&nr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&T!==void 0;const A=[];for(const{feature:z,id:H,index:q,sourceLayerIndex:ne}of a){const ie=this.layers[0]._featureFilter.needGeometry,ae=Ut(z,ie);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),ae,f))continue;const me=_?_.evaluate(ae,{},f):void 0,ye={id:H,properties:z.properties,type:z.type,sourceLayerIndex:ne,index:q,geometry:ie?ae.geometry:tr(z,f,p),patterns:{},sortKey:me};A.push(ye)}_&&A.sort((z,H)=>z.sortKey-H.sortKey);const{lineAtlas:I,featureIndex:D}=l,F=this.addConstantDashes(I);for(const z of A){const{geometry:H,index:q,sourceLayerIndex:ne}=z;if(F&&this.addFeatureDashes(z,I),this.hasPattern){const ie=ck("line",this.layers,z,this.zoom,this.pixelRatio,l);this.patternFeatures.push(ie)}else this.addFeature(z,H,q,f,I.positions,l.availableImages,l.brightness,l.elevationFeatures);D.insert(a[q].feature,H,q,ne,this.index)}}addConstantDashes(a){let l=!1;for(const f of this.layers){const p=f.paint.get("line-dasharray").value,_=f.layout.get("line-cap").value;if(p.kind!=="constant"||_.kind!=="constant")l=!0;else{const y=_.value,T=p.value;if(!T)continue;a.addDash(T,y)}}return l}addFeatureDashes(a,l){const f=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,y=p.layout.get("line-cap").value;if(_.kind==="constant"&&y.kind==="constant")continue;let T,A;if(_.kind==="constant"){if(T=_.value,!T)continue}else T=_.evaluate({zoom:f},a);A=y.kind==="constant"?y.value:y.evaluate({zoom:f},a),l.addDash(T,A),a.patterns[p.id]=[l.getKey(T,A)]}}update(a,l,f,p,_,y,T,A){this.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,A)}addFeatures(a,l,f,p,_,y){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,l,f,p,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Fre)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=a.createVertexBuffer(this.patternVertexArray,Nre)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=a.createVertexBuffer(this.zOffsetVertexArray,Mre.members,!0)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Rre),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a,l){let f,p;if(l&&l>0?(f=`mapbox_clip_start_${l}`,p=`mapbox_clip_end_${l}`):(f="mapbox_clip_start",p="mapbox_clip_end"),a.properties&&a.properties.hasOwnProperty(f)&&a.properties.hasOwnProperty(p))return{start:+a.properties[f],end:+a.properties[p]}}addFeature(a,l,f,p,_,y,T,A){const I=this.layers[0].layout,D=I.get("line-join").evaluate(a,{}),F=I.get("line-cap").evaluate(a,{}),z=I.get("line-miter-limit"),H=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(a),this.lineFeature=a;const q=!(!a.properties||!a.properties.hasOwnProperty("mapbox_line_metrics"))&&a.properties.mapbox_line_metrics;this.zOffsetValue=I.get("line-z-offset").value;const ne=this.layers[0].paint.get("line-width").value;if(ne.kind!=="constant"&&ne.isLineProgressConstant===!1&&(this.variableWidthValue=ne),this.elevationType==="road"){const ie=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(a,l,p,A,D,F,z,H)){const[ae,me]=this.clipRuntimeLinesToTile(l,1);for(let ye=0;ye<ae.length;ye++){const we=ae[ye],Be=me[ye],ze={progress:{min:Be.progress.min,max:Be.progress.max},nextDir:this.computeSegNextDir(Be,we),prevDir:this.computeSegPrevDir(Be,we)};this.addLine(we,a,p,D,F,z,H,ze,q&&Be.parentIndex>0?Be.parentIndex:null)}this.fillNonElevatedRoadSegment(ie)}}else for(let ie=0;ie<l.length;ie++)this.addLine(l[ie],a,p,D,F,z,H,void 0,q&&ie>0?ie:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,_,y,p,T,void 0,this.worldview)}computeSegNextDir(a,l){return a.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(a,l){return l[1].sub(a.prevPoint).unit()}clipLinesToTile(a,l){return UT(a,-l,-l,Zt+l,Zt+l)}clipRuntimeLinesToTile(a,l){const f=[];return[UT(a,-l,-l,Zt+l,Zt+l,f),f]}addElevatedRoadFeature(a,l,f,p,_,y,T,A){const I=[],D=vi.getElevationFeature(a,p);if(D){const F=this.clipLinesToTile(l,1),z=this.prepareElevatedLines(F,D,f);for(const H of z)I.push({geometry:H,elevation:D,elevationTileID:f,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(I.length===0)return!1;for(const F of I){const z=this.layoutVertexArray.length;this.addLine(F.geometry,a,f,_,y,T,A);const H=new oa(f,F.elevationTileID);if(F.elevation)for(let q=z;q<this.layoutVertexArray.length;q++){const ne=new Pt(this.layoutVertexArray.int16[6*q]>>1,this.layoutVertexArray.int16[6*q+1]>>1),ie=H.pointElevation(ne,F.elevation,.05);this.updateHeightRange(ie),this.zOffsetVertexArray.emplaceBack(ie,0,0)}else this.fillNonElevatedRoadSegment(z)}return!0}prepareElevatedLines(a,l,f){if(l.constantHeight!=null)return a;const p=[],_=1/st(f);for(const y of a)Qte(y,new Dn(l,_),0,p);return p}fillNonElevatedRoadSegment(a){for(let l=a;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(a){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,a),this.heightRange.max=Math.max(this.heightRange.max,a)):this.heightRange={min:a,max:a}}addLine(a,l,f,p,_,y,T,A,I){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=I?this.lineFeatureClips(l,I):this.lineClips;const D=p==="none";this.patternJoinNone=this.hasPattern&&D,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const F=A&&A.progress.min>0,z=A&&A.progress.max<1;if(this.lineClips){let Ye={min:this.lineClips.start,max:this.lineClips.end},Ct=1;if(A){const zt=this.lineClips.end-this.lineClips.start;Ye=function(Ot,Lt,$t){return{min:no(Ot.min,Lt,$t),max:no(Ot.max,Lt,$t)}}(A.progress,{min:0,max:1},Ye),zt>0&&(Ct=(Ye.max-Ye.min)/zt)}const nt=+l.properties.mapbox_clip_feature_len,kt=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(nt)||Number.isNaN(kt)){for(let Ot=0;Ot<a.length-1;Ot++)this.totalDistance+=a[Ot].dist(a[Ot+1]);const zt=this.totalDistance/(Ye.max-Ye.min);this.totalFeatureLength=Number.isFinite(zt)?zt:0,this.lineClips.start=Ye.min,this.lineClips.end=Ye.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=nt,this.distance=kt*Ct,this.lineClips.start=Ye.min,this.lineClips.end=Ye.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const H=Bre[l.type]==="Polygon";let q=a.length;for(;q>=2&&a[q-1].equals(a[q-2]);)q--;let ne=0;for(;ne<q-1&&a[ne].equals(a[ne+1]);)ne++;if(q<(H?3:2))return;p==="bevel"&&(y=1.05);const ie=this.segments.prepareSegment(10*q,this.layoutVertexArray,this.indexArray);let ae,me,ye,we,Be,ze,Ve,Ze;A&&A.prevDir&&(ze=A.prevDir.perp()),A&&A.nextDir&&(Ve=A.nextDir.perp()),this.e1=this.e2=-1,H&&(ae=a[q-2],Be=a[ne].sub(ae)._unit()._perp());for(let Ye=ne;Ye<q;Ye++){if(ye=Ye===q-1?H?a[ne+1]:void 0:a[Ye+1],ye&&a[Ye].equals(ye))continue;Be&&(we=Be),ae&&(me=ae),ae=a[Ye],Ze=this.evaluateLineProgressFeatures(me?me.dist(ae):0),Be=ye?ye.sub(ae)._unit()._perp():we,we=we||Be;const Ct=me&&ye;let nt=Ct?p:H||D?"butt":_;const kt=we.x*Be.x+we.y*Be.y;if(D){const ut=function(Vt){if(Vt.patternJoinNone){const jt=Vt.segmentPoints.length/2,br=Vt.lineSoFar-Vt.segmentStart;for(let ir=0;ir<jt;++ir){const dr=Vt.segmentPoints[2*ir+1],qt=Math.round(Vt.segmentPoints[2*ir])+.5+.25*dr;Vt.patternVertexArray.emplaceBack(qt,br,Vt.segmentStart),Vt.patternVertexArray.emplaceBack(qt,br,Vt.segmentStart)}Vt.segmentPoints.length=0}Vt.e1=Vt.e2=-1};if(Ct&&kt<jre){this.updateDistance(me,ae),this.addCurrentVertex(ae,we,1,1,ie,Ze),ut(this),this.addCurrentVertex(ae,Be,-1,-1,ie,Ze);continue}if(me){if(!ye){this.updateDistance(me,ae),this.addCurrentVertex(ae,we,1,1,ie,Ze),ut(this);continue}nt="miter"}}let zt=we.add(Be);zt.x===0&&zt.y===0||zt._unit();const Ot=zt.x*Be.x+zt.y*Be.y,Lt=Ot!==0?1/Ot:1/0,$t=2*Math.sqrt(2-2*Ot),Et=Ot<zre&&me&&ye,Nt=we.x*Be.y-we.y*Be.x>0,gt=this.overscaling<=16?15*Zt/(512*this.overscaling):0;if(Ct&&nt==="round"){if(Lt<T)nt="miter";else if(Lt<=2){const ut=Lk(ae,-10,Zt+10);nt=this.elevationType==="offset"&&(ut||this.hasCrossSlope)?"miter":"fakeround"}}if(nt==="miter"&&Lt>y&&(nt="bevel"),nt==="bevel"&&(Lt>2&&(nt="flipbevel"),Lt<y&&(nt="miter")),me&&!(nt==="miter"&&Et)&&this.updateDistance(me,ae),nt==="miter")if(Et){const ut=ae.dist(me);if(ut>2*gt){const jt=ae.sub(ae.sub(me)._mult(gt/ut)._round());this.updateDistance(me,jt),this.addCurrentVertex(jt,we,0,0,ie,Ze),me=jt}this.updateDistance(me,ae),zt._mult(Lt),this.addCurrentVertex(ae,zt,0,0,ie,Ze);const Vt=ae.dist(ye);if(Vt>2*gt){const jt=ae.add(ye.sub(ae)._mult(gt/Vt)._round());this.updateDistance(ae,jt),this.addCurrentVertex(jt,Be,0,0,ie,Ze),ae=jt}}else zt._mult(Lt),this.addCurrentVertex(ae,zt,0,0,ie,Ze);else if(nt==="flipbevel"){if(Lt>100)zt=Be.mult(-1);else{const ut=Lt*we.add(Be).mag()/we.sub(Be).mag();zt._perp()._mult(ut*(Nt?-1:1))}this.addCurrentVertex(ae,zt,0,0,ie,Ze),this.addCurrentVertex(ae,zt.mult(-1),0,0,ie,Ze)}else if(nt==="bevel"||nt==="fakeround"){Ze!=null&&me&&this.addCurrentVertex(ae,Ve||we,-1,-1,ie,Ze);const ut=ae.dist(me)<=2*gt&&nt!=="bevel",Vt=zt.mult(Nt?1:-1);Vt._mult(Lt);const jt=Be.mult(Nt?-1:1),br=we.mult(Nt?-1:1),ir=this.evaluateLineProgressFeatures(this.distance);if(Ze==null&&(this.addHalfVertex(ae,Vt.x,Vt.y,!1,!Nt,0,ie,ir),ut||this.addHalfVertex(ae,Vt.x+2*br.x,Vt.y+2*br.y,!1,Nt,0,ie,ir)),nt==="fakeround"){const dr=Math.round(180*$t/Math.PI/20);this.addHalfVertex(ae,br.x,br.y,!1,Nt,0,ie,ir);for(let qt=0;qt<dr;qt++){let xr=qt/dr;if(xr!==.5){const Qt=xr-.5;xr+=xr*Qt*(xr-1)*((1.0904+kt*(kt*(3.55645-1.43519*kt)-3.2452))*Qt*Qt+(.848013+kt*(.215638*kt-1.06021)))}const jr=jt.sub(br)._mult(xr)._add(br)._unit();this.addHalfVertex(ae,jr.x,jr.y,!1,Nt,0,ie,ir)}this.addHalfVertex(ae,jt.x,jt.y,!1,Nt,0,ie,ir)}ut||Ze!=null||this.addHalfVertex(ae,Vt.x+2*jt.x,Vt.y+2*jt.y,!1,Nt,0,ie,ir),Ze!=null&&ye&&this.addCurrentVertex(ae,ze||Be,1,1,ie,Ze)}else if(nt==="butt")this.addCurrentVertex(ae,zt,0,0,ie,Ze);else if(nt==="square"){if(!me){const ut=F?0:-1;this.addCurrentVertex(ae,zt,ut,ut,ie,Ze)}if(this.addCurrentVertex(ae,zt,0,0,ie,Ze),me){const ut=z?0:1;this.addCurrentVertex(ae,zt,ut,ut,ie,Ze)}}else if(nt==="round"){if(me){const ut=!Ct&&Ve?Ve:we;this.addCurrentVertex(ae,ut,0,0,ie,Ze),!Ct&&z||this.addCurrentVertex(ae,ut,1,1,ie,Ze,!0)}if(ye){const ut=!Ct&&ze?ze:Be;!Ct&&F||this.addCurrentVertex(ae,ut,-1,-1,ie,Ze,!0),this.addCurrentVertex(ae,ut,0,0,ie,Ze)}}}}addVerticesTo(a,l,f,p,_,y,T,A,I,D){const F=(l.w-a.w)/this.tessellationStep|0;let z=0;const H=this.scaledDistance;if(F>1){this.lineSoFar=a.w;const ne=(l.x-a.x)/F,ie=(l.y-a.y)/F,ae=(l.z-a.z)/F,me=(l.w-a.w)/F;for(let ye=1;ye<F;++ye){a.x+=ne,a.y+=ie,a.z+=ae,this.lineSoFar+=me,z+=me;const we=this.evaluateLineProgressFeatures(this.prevDistance+z);this.scaledDistance=(this.prevDistance+z)/this.totalDistance,this.addHalfVertex(a,f,p,D,!1,T,I,we),this.addHalfVertex(a,_,y,D,!0,-A,I,we)}}this.lineSoFar=l.w,this.scaledDistance=H;const q=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,f,p,D,!1,T,I,q),this.addHalfVertex(l,_,y,D,!0,-A,I,q)}evaluateLineProgressFeatures(a){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+a)/this.totalFeatureLength):nr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(a,l,f,p,_,y,T=!1){const A=l.x+l.y*f,I=l.y-l.x*f,D=l.y*p-l.x,F=-l.y-l.x*p;if(y!=null){const z=this.elevationType==="offset",H=-10,q=Zt+10,ne=y.zOffset,ie=new PB(a.x,a.y,ne,this.lineSoFar),ae=!!z&&Lk(a,H,q),me=this.lineSoFar,ye=this.distance;if(this.currentVertex)if(ae){const we=this.currentVertexIsOutside,Be=this.currentVertex,ze=new PB(a.x,a.y,ne,this.lineSoFar);if(kB(Be,ze,H,q),!Lk(ze,H,q)){if(we){this.e1=this.e2=-1,this.distance-=Be.dist(ie),this.lineSoFar=Be.w;const Ve=this.evaluateLineProgressFeatures(Be.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Be,A,I,T,!1,f,_,Ve),this.addHalfVertex(Be,D,F,T,!0,-p,_,Ve),this.prevDistance=this.distance}this.distance=this.prevDistance+Be.dist(ze),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Be,ze,A,I,D,F,f,p,_,T),this.distance=ye,this.scaledDistance=this.distance/this.totalDistance}}else{const we=this.currentVertex;if(this.currentVertexIsOutside){kB(we,ie,H,q),this.e1=this.e2=-1,this.distance-=we.dist(ie),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=we.w;const Be=this.evaluateLineProgressFeatures(we.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(we,A,I,T,!1,f,_,Be),this.addHalfVertex(we,D,F,T,!0,-p,_,Be),this.prevDistance=this.distance,this.distance=ye,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(we,ie,A,I,D,F,f,p,_,T)}else ae||(this.addHalfVertex(a,A,I,T,!1,f,_,y),this.addHalfVertex(a,D,F,T,!0,-p,_,y));this.currentVertex=ie,this.currentVertexIsOutside=ae,this.lineSoFar=me}else this.addHalfVertex(a,A,I,T,!1,f,_,y),this.addHalfVertex(a,D,F,T,!0,-p,_,y)}addHalfVertex({x:a,y:l},f,p,_,y,T,A,I){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),y||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((a<<1)+(_?1:0),(l<<1)+(y?1:0),Math.round(63*f)+128,Math.round(63*p)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const F=Ir(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,F)}const D=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),A.primitiveLength++),y?this.e2=D:this.e1=D,I!=null&&this.zOffsetVertexArray.emplaceBack(I.zOffset,I.variableWidth,I.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(a,l){this.prevDistance=this.distance,this.distance+=a.dist(l),this.updateScaledDistance()}}function Lk(c,a,l){return c.x<a||c.x>l||c.y<a||c.y>l}let sz,lz;function cz(c,a,l){return a*(Zt/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}sr(Fk,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const uz=(c,a,l)=>(1-l)*c+l*a;function hz(c,a){return 1/cz(c,1,a.tileZoom)}function fz(c,a,l,f){return c.translatePosMatrix(f||a.tileID.projMatrix,a,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const dz=c=>{const a=[];pz(c)&&a.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&a.push("RENDER_LINE_GRADIENT");const l=c.paint.get("line-trim-offset");l[0]===0&&l[1]===0||a.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&a.push("RENDER_LINE_BORDER");const f=c.layout.get("line-join").constantOr("miter")==="none",p=!!c.paint.get("line-pattern").constantOr(1);return f&&p&&a.push("LINE_JOIN_NONE"),a};function pz(c){const a=c.paint.get("line-dasharray").value;return a.kind!=="constant"||a.value}let Nk;const mz=()=>Nk||(Nk={layout:sz||(sz=new Ii({"line-cap":new er(rt.layout_line["line-cap"]),"line-join":new er(rt.layout_line["line-join"]),"line-miter-limit":new Wt(rt.layout_line["line-miter-limit"]),"line-round-limit":new Wt(rt.layout_line["line-round-limit"]),"line-sort-key":new er(rt.layout_line["line-sort-key"]),"line-z-offset":new er(rt.layout_line["line-z-offset"]),"line-elevation-reference":new Wt(rt.layout_line["line-elevation-reference"]),"line-cross-slope":new Wt(rt.layout_line["line-cross-slope"]),visibility:new Wt(rt.layout_line.visibility),"line-width-unit":new Wt(rt.layout_line["line-width-unit"])})),paint:lz||(lz=new Ii({"line-opacity":new er(rt.paint_line["line-opacity"]),"line-color":new er(rt.paint_line["line-color"]),"line-translate":new Wt(rt.paint_line["line-translate"]),"line-translate-anchor":new Wt(rt.paint_line["line-translate-anchor"]),"line-width":new er(rt.paint_line["line-width"]),"line-gap-width":new er(rt.paint_line["line-gap-width"]),"line-offset":new er(rt.paint_line["line-offset"]),"line-blur":new er(rt.paint_line["line-blur"]),"line-dasharray":new er(rt.paint_line["line-dasharray"]),"line-pattern":new er(rt.paint_line["line-pattern"]),"line-pattern-cross-fade":new Wt(rt.paint_line["line-pattern-cross-fade"]),"line-gradient":new md(rt.paint_line["line-gradient"]),"line-trim-offset":new Wt(rt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Wt(rt.paint_line["line-trim-fade-range"]),"line-trim-color":new Wt(rt.paint_line["line-trim-color"]),"line-emissive-strength":new Wt(rt.paint_line["line-emissive-strength"]),"line-border-width":new er(rt.paint_line["line-border-width"]),"line-border-color":new er(rt.paint_line["line-border-color"]),"line-occlusion-opacity":new Wt(rt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},Nk);class Ure extends er{possiblyEvaluate(a,l){return l=new Kn(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition,worldview:l.worldview}),super.possiblyEvaluate(a,l)}evaluate(a,l,f,p){return l=Object.assign({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(a,l,f,p)}}let s1;function gz(c,a){return a>0?a+2*c:c}const $re=fn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vre=fn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Wre=fn([{name:"a_projected_pos",components:4,type:"Float32"}],4);fn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Gre=fn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Hre=fn([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),qre=fn([{name:"a_texb",components:2,type:"Uint16"}]),Xre=fn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Zre=fn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);fn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _z=fn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yre=fn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);fn([{name:"triangle",components:3,type:"Uint16"}]),fn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),fn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),fn([{type:"Float32",name:"offsetX"}]),fn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Xa=24;function Kre(c,a,l){return c.sections.forEach(f=>{f.text=function(p,_,y){const T=_.layout.get("text-transform").evaluate(y,{});return T==="uppercase"?p=p.toLocaleUpperCase():T==="lowercase"&&(p=p.toLocaleLowerCase()),ac.applyArabicShaping&&(p=ac.applyArabicShaping(p)),p}(f.text,a,l)}),c}const l1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Jre(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function Qre(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}const Bk=4294967296,yz=1/Bk,vz=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let ZT=class{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,a,l=this.length){for(;this.pos<l;){const f=this.readVarint(),p=f>>3,_=this.pos;this.type=7&f,c(p,a,this),this.pos===_&&this.skip(f)}return a}readMessage(c,a){return this.readFields(c,a,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Bk;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Bk;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const a=this.buf;let l,f;return f=a[this.pos++],l=127&f,f<128?l:(f=a[this.pos++],l|=(127&f)<<7,f<128?l:(f=a[this.pos++],l|=(127&f)<<14,f<128?l:(f=a[this.pos++],l|=(127&f)<<21,f<128?l:(f=a[this.pos],l|=(15&f)<<28,function(p,_,y){const T=y.buf;let A,I;if(I=T[y.pos++],A=(112&I)>>4,I<128||(I=T[y.pos++],A|=(127&I)<<3,I<128)||(I=T[y.pos++],A|=(127&I)<<10,I<128)||(I=T[y.pos++],A|=(127&I)<<17,I<128)||(I=T[y.pos++],A|=(127&I)<<24,I<128)||(I=T[y.pos++],A|=(1&I)<<31,I<128))return f_(p,A,_);throw new Error("Expected varint not more than 10 bytes")}(l,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&vz?vz.decode(this.buf.subarray(a,c)):function(l,f,p){let _="",y=f;for(;y<p;){const T=l[y];let A,I,D,F=null,z=T>239?4:T>223?3:T>191?2:1;if(y+z>p)break;z===1?T<128&&(F=T):z===2?(A=l[y+1],(192&A)==128&&(F=(31&T)<<6|63&A,F<=127&&(F=null))):z===3?(A=l[y+1],I=l[y+2],(192&A)==128&&(192&I)==128&&(F=(15&T)<<12|(63&A)<<6|63&I,(F<=2047||F>=55296&&F<=57343)&&(F=null))):z===4&&(A=l[y+1],I=l[y+2],D=l[y+3],(192&A)==128&&(192&I)==128&&(192&D)==128&&(F=(15&T)<<18|(63&A)<<12|(63&I)<<6|63&D,(F<=65535||F>=1114112)&&(F=null))),F===null?(F=65533,z=1):F>65535&&(F-=65536,_+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),_+=String.fromCharCode(F),y+=z}return _}(this.buf,a,c)}readBytes(){const c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a}readPackedVarint(c=[],a){const l=this.readPackedEnd();for(;this.pos<l;)c.push(this.readVarint(a));return c}readPackedSVarint(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const a=this.readPackedEnd();for(;this.pos<a;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const a=7&c;if(a===0)for(;this.buf[this.pos++]>127;);else if(a===2)this.pos=this.readVarint()+this.pos;else if(a===5)this.pos+=4;else{if(a!==1)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(c,a){this.writeVarint(c<<3|a)}realloc(c){let a=this.length||16;for(;a<this.pos+c;)a*=2;if(a!==this.length){const l=new Uint8Array(a);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*yz),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*yz),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?function(a,l){let f,p;if(a>=0?(f=a%4294967296|0,p=a/4294967296|0):(f=~(-a%4294967296),p=~(-a/4294967296),4294967295^f?f=f+1|0:(f=0,p=p+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(_,y,T){T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,T.buf[T.pos]=127&(_>>>=7)}(f,0,l),function(_,y){const T=(7&_)<<4;y.buf[y.pos++]|=T|((_>>>=3)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_)))))}(p,l)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const a=this.pos;this.pos=function(f,p,_){for(let y,T,A=0;A<p.length;A++){if(y=p.charCodeAt(A),y>55295&&y<57344){if(!T){y>56319||A+1===p.length?(f[_++]=239,f[_++]=191,f[_++]=189):T=y;continue}if(y<56320){f[_++]=239,f[_++]=191,f[_++]=189,T=y;continue}y=T-55296<<10|y-56320|65536,T=null}else T&&(f[_++]=239,f[_++]=191,f[_++]=189,T=null);y<128?f[_++]=y:(y<2048?f[_++]=y>>6|192:(y<65536?f[_++]=y>>12|224:(f[_++]=y>>18|240,f[_++]=y>>12&63|128),f[_++]=y>>6&63|128),f[_++]=63&y|128)}return _}(this.buf,c,this.pos);const l=this.pos-a;l>=128&&xz(a,l,this),this.pos=a-1,this.writeVarint(l),this.pos+=l}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const a=c.length;this.writeVarint(a),this.realloc(a);for(let l=0;l<a;l++)this.buf[this.pos++]=c[l]}writeRawMessage(c,a){this.pos++;const l=this.pos;c(a,this);const f=this.pos-l;f>=128&&xz(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f}writeMessage(c,a,l){this.writeTag(c,2),this.writeRawMessage(a,l)}writePackedVarint(c,a){a.length&&this.writeMessage(c,ene,a)}writePackedSVarint(c,a){a.length&&this.writeMessage(c,tne,a)}writePackedBoolean(c,a){a.length&&this.writeMessage(c,ine,a)}writePackedFloat(c,a){a.length&&this.writeMessage(c,rne,a)}writePackedDouble(c,a){a.length&&this.writeMessage(c,nne,a)}writePackedFixed32(c,a){a.length&&this.writeMessage(c,ane,a)}writePackedSFixed32(c,a){a.length&&this.writeMessage(c,one,a)}writePackedFixed64(c,a){a.length&&this.writeMessage(c,sne,a)}writePackedSFixed64(c,a){a.length&&this.writeMessage(c,lne,a)}writeBytesField(c,a){this.writeTag(c,2),this.writeBytes(a)}writeFixed32Field(c,a){this.writeTag(c,5),this.writeFixed32(a)}writeSFixed32Field(c,a){this.writeTag(c,5),this.writeSFixed32(a)}writeFixed64Field(c,a){this.writeTag(c,1),this.writeFixed64(a)}writeSFixed64Field(c,a){this.writeTag(c,1),this.writeSFixed64(a)}writeVarintField(c,a){this.writeTag(c,0),this.writeVarint(a)}writeSVarintField(c,a){this.writeTag(c,0),this.writeSVarint(a)}writeStringField(c,a){this.writeTag(c,2),this.writeString(a)}writeFloatField(c,a){this.writeTag(c,5),this.writeFloat(a)}writeDoubleField(c,a){this.writeTag(c,1),this.writeDouble(a)}writeBooleanField(c,a){this.writeVarintField(c,+a)}};function f_(c,a,l){return l?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function xz(c,a,l){const f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));l.realloc(f);for(let p=l.pos-1;p>=c;p--)l.buf[p+f]=l.buf[p]}function ene(c,a){for(let l=0;l<c.length;l++)a.writeVarint(c[l])}function tne(c,a){for(let l=0;l<c.length;l++)a.writeSVarint(c[l])}function rne(c,a){for(let l=0;l<c.length;l++)a.writeFloat(c[l])}function nne(c,a){for(let l=0;l<c.length;l++)a.writeDouble(c[l])}function ine(c,a){for(let l=0;l<c.length;l++)a.writeBoolean(c[l])}function ane(c,a){for(let l=0;l<c.length;l++)a.writeFixed32(c[l])}function one(c,a){for(let l=0;l<c.length;l++)a.writeSFixed32(c[l])}function sne(c,a){for(let l=0;l<c.length;l++)a.writeFixed64(c[l])}function lne(c,a){for(let l=0;l<c.length;l++)a.writeSFixed64(c[l])}const zk=3;function cne(c,a,l){a.glyphs=[],c===1&&l.readMessage(une,a)}function une(c,a,l){if(c===3){const{id:f,bitmap:p,width:_,height:y,left:T,top:A,advance:I}=l.readMessage(hne,{});a.glyphs.push({id:f,bitmap:new Cd({width:_+2*zk,height:y+2*zk},p),metrics:{width:_,height:y,left:T,top:A,advance:I}})}else c===4?a.ascender=l.readSVarint():c===5&&(a.descender=l.readSVarint())}function hne(c,a,l){c===1?a.id=l.readVarint():c===2?a.bitmap=l.readBytes():c===3?a.width=l.readVarint():c===4?a.height=l.readVarint():c===5?a.left=l.readSVarint():c===6?a.top=l.readSVarint():c===7&&(a.advance=l.readVarint())}const wz=zk,qs={horizontal:1,vertical:2,horizontalOnly:3};class c1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(a,l){const f=new c1;return f.scale=a||1,f.fontStack=l,f}static forImage(a){const l=new c1;return l.image=a,l}}class d_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,l,f){const p=new d_;for(let _=0;_<a.sections.length;_++){const y=a.sections[_];y.image?p.addImageSection(y,f):p.addTextSection(y,l)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCodePoint(a){return this.text.codePointAt(a)}verticalizePunctuation(a){this.text=function(l,f){let p="";for(let _=0;_<l.length;_++){const y=l.charCodeAt(_+1)||null,T=l.charCodeAt(_-1)||null;p+=!f&&(y&&jg(y)&&!l1[l[_+1]]||T&&jg(T)&&!l1[l[_-1]])||!l1[l[_]]?l[_]:l1[l[_]]}return p}(this.text,a)}trim(){let a=0;for(let f=0;f<this.text.length&&YT[this.text.charCodeAt(f)];f++)a++;let l=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&YT[this.text.charCodeAt(f)];f--)l--;this.text=this.text.substring(a,l),this.sectionIndex=this.sectionIndex.slice(a,l)}substring(a,l){const f=new d_;return f.text=this.text.substring(a,l),f.sectionIndex=this.sectionIndex.slice(a,l),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,l)=>Math.max(a,this.sections[l].scale),0)}addTextSection(a,l){this.text+=a.text,this.sections.push(c1.forText(a.scale,a.fontStack||l));const f=this.sections.length-1;for(let p=0;p<a.text.length;++p)this.sectionIndex.push(f)}addImageSection(a,l){const f=a.image?a.image.getPrimary():null;if(!f)return void nr("Can't add FormattedSection with an empty image.");f.scaleSelf(l);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(c1.forImage(f)),this.sectionIndex.push(this.sections.length-1)):nr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jk(c,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne=1){const ie=d_.fromFeature(c,p,ne);F===qs.vertical&&ie.verticalizePunctuation(z);let ae=[];const me=function(Ve,Ze,Ye,Ct,nt,kt){if(!Ve)return[];const zt=[],Ot=function(Nt,gt,ut,Vt,jt,br){let ir=0;for(let dr=0;dr<Nt.length();dr++){const qt=Nt.getSection(dr);ir+=bz(Nt.getCodePoint(dr),qt,Vt,jt,gt,br)}return ir/Math.max(1,Math.ceil(ir/ut))}(Ve,Ze,Ye,Ct,nt,kt),Lt=Ve.text.indexOf("")>=0;let $t=0;for(let Nt=0;Nt<Ve.length();Nt++){const gt=Ve.getSection(Nt),ut=Ve.getCodePoint(Nt);if(YT[ut]||($t+=bz(ut,gt,Ct,nt,Ze,kt)),Nt<Ve.length()-1){const Vt=!((Et=ut)<11904||!(Pr["Bopomofo Extended"](Et)||Pr.Bopomofo(Et)||Pr["CJK Compatibility Forms"](Et)||Pr["CJK Compatibility Ideographs"](Et)||Pr["CJK Compatibility"](Et)||Pr["CJK Radicals Supplement"](Et)||Pr["CJK Strokes"](Et)||Pr["CJK Symbols and Punctuation"](Et)||Pr["CJK Unified Ideographs Extension A"](Et)||Pr["CJK Unified Ideographs"](Et)||Pr["Enclosed CJK Letters and Months"](Et)||Pr["Halfwidth and Fullwidth Forms"](Et)||Pr.Hiragana(Et)||Pr["Ideographic Description Characters"](Et)||Pr["Kangxi Radicals"](Et)||Pr["Katakana Phonetic Extensions"](Et)||Pr.Katakana(Et)||Pr["Vertical Forms"](Et)||Pr["Yi Radicals"](Et)||Pr["Yi Syllables"](Et)));(fne[ut]||Vt||gt.image)&&zt.push(Sz(Nt+1,$t,Ot,zt,dne(ut,Ve.getCodePoint(Nt+1),Vt&&Lt),!1))}}var Et;return Ez(Sz(Ve.length(),$t,Ot,zt,0,!0))}(ie,I,_,a,f,H),{processBidirectionalText:ye,processStyledBidirectionalText:we}=ac;if(ye&&ie.sections.length===1){const Ve=ye(ie.toString(),me);for(const Ze of Ve){const Ye=new d_;Ye.text=Ze,Ye.sections=ie.sections;for(let Ct=0;Ct<Ze.length;Ct++)Ye.sectionIndex.push(0);ae.push(Ye)}}else if(we){const Ve=we(ie.text,ie.sectionIndex,me);for(const Ze of Ve){const Ye=new d_;Ye.text=Ze[0],Ye.sectionIndex=Ze[1],Ye.sections=ie.sections,ae.push(Ye)}}else ae=function(Ve,Ze){const Ye=[],Ct=Ve.text;let nt=0;for(const kt of Ze)Ye.push(Ve.substring(nt,kt)),nt=kt;return nt<Ct.length&&Ye.push(Ve.substring(nt,Ct.length)),Ye}(ie,me);const Be=[],ze={positionedLines:Be,text:ie.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Ve,Ze,Ye,Ct,nt,kt,zt,Ot,Lt,$t,Et,Nt){let gt=0,ut=0,Vt=0;const jt=Ot==="right"?1:Ot==="left"?0:.5;let br=!1;for(const Qt of nt){const gr=Qt.getSections();for(const Or of gr){if(Or.image)continue;const Vr=Ze[Or.fontStack];if(Vr&&(br=Vr.ascender!==void 0&&Vr.descender!==void 0,!br))break}if(!br)break}let ir=0;for(const Qt of nt){Qt.trim();const gr=Qt.getMaxScale(),Or=(gr-1)*Xa,Vr={positionedGlyphs:[],lineOffset:0};Ve.positionedLines[ir]=Vr;const rn=Vr.positionedGlyphs;let Gr=0;if(!Qt.length()){ut+=kt,++ir;continue}let hr=0,Wr=0;for(let Ae=0;Ae<Qt.length();Ae++){const Ce=Qt.getSection(Ae),dt=Qt.getSectionIndex(Ae),At=Qt.getCodePoint(Ae);let Jt=Ce.scale,Kt=null,lr=null,Er=null,nn=Xa,on=0,tn=Lt;tn===qs.vertical&&((dr=At)===12312||dr===12313||dr===12316||dr===12540||dr===12448)&&(tn=qs.horizontal);const Fn=!(tn===qs.horizontal||!Et&&!zg(At)||Et&&(YT[At]||UI(At)));if(Ce.image){const mi=Ct.get(Ce.image.toString());if(!mi)continue;Er=Ce.image,Ve.iconsInText=Ve.iconsInText||!0,lr=mi.paddedRect;const en=mi.displaySize;Jt=Jt*Xa/Nt,Kt={width:en[0],height:en[1],left:0,top:-wz,advance:Fn?en[1]:en[0],localGlyph:!1},on=br?-Kt.height*Jt:gr*Xa-17-en[1]*Jt,nn=Kt.advance;const Jn=(Fn?en[0]:en[1])*Jt-Xa*gr;Jn>0&&Jn>Gr&&(Gr=Jn)}else{const mi=Ye[Ce.fontStack];if(!mi)continue;mi[At]&&(lr=mi[At]);const en=Ze[Ce.fontStack];if(!en)continue;const Jn=en.glyphs[At];if(!Jn)continue;if(Kt=Jn.metrics,nn=At!==8203?Xa:0,br){const Bn=en.ascender!==void 0?Math.abs(en.ascender):0,bn=en.descender!==void 0?Math.abs(en.descender):0,ri=(Bn+bn)*Jt;hr<ri&&(hr=ri,Wr=(Bn-bn)/2*Jt),on=-Bn*Jt}else on=(gr-Jt)*Xa-17}Fn?(Ve.verticalizable=!0,rn.push({glyph:At,image:Er,x:gt,y:ut+on,vertical:Fn,scale:Jt,localGlyph:Kt.localGlyph,fontStack:Ce.fontStack,sectionIndex:dt,metrics:Kt,rect:lr}),gt+=nn*Jt+$t):(rn.push({glyph:At,image:Er,x:gt,y:ut+on,vertical:Fn,scale:Jt,localGlyph:Kt.localGlyph,fontStack:Ce.fontStack,sectionIndex:dt,metrics:Kt,rect:lr}),gt+=Kt.advance*Jt+$t)}rn.length!==0&&(Vt=Math.max(gt-$t,Vt),br?Az(rn,jt,Gr,Wr,kt*gr/2):Az(rn,jt,Gr,0,kt/2)),gt=0;const dn=kt*gr+Gr;Vr.lineOffset=Math.max(Gr,Or),ut+=dn,++ir}var dr;const qt=ut,{horizontalAlign:xr,verticalAlign:jr}=Uk(zt);(function(Qt,gr,Or,Vr,rn,Gr){const hr=(gr-Or)*rn,Wr=-Gr*Vr;for(const dn of Qt)for(const Ae of dn.positionedGlyphs)Ae.x+=hr,Ae.y+=Wr})(Ve.positionedLines,jt,xr,jr,Vt,qt),Ve.top+=-jr*qt,Ve.bottom=Ve.top+qt,Ve.left+=-xr*Vt,Ve.right=Ve.left+Vt,Ve.hasBaseline=br}(ze,a,l,f,ae,y,T,A,F,I,z,q),!function(Ve){for(const Ze of Ve)if(Ze.positionedGlyphs.length!==0)return!1;return!0}(Be))return ze}const YT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fne={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bz(c,a,l,f,p,_){if(a.image){const y=f.get(a.image.toString());return y?y.displaySize[0]*a.scale*Xa/_+p:0}{const y=l[a.fontStack],T=y&&y.glyphs[c];return T?T.metrics.advance*a.scale+p:0}}function Tz(c,a,l,f){const p=Math.pow(c-a,2);return f?c<a?p/2:2*p:p+Math.abs(l)*l}function dne(c,a,l){let f=0;return c===10&&(f-=1e4),l&&(f+=150),c!==40&&c!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function Sz(c,a,l,f,p,_){let y=null,T=Tz(a,l,p,_);for(const A of f){const I=Tz(a-A.x,l,p,_)+A.badness;I<=T&&(y=A,T=I)}return{index:c,x:a,priorBreak:y,badness:T}}function Ez(c){return c?Ez(c.priorBreak).concat(c.index):[]}function Uk(c){let a=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:a,verticalAlign:l}}function Az(c,a,l,f,p){if(!(a||l||f||p))return;const _=c.length-1,y=c[_],T=(y.x+y.metrics.advance*y.scale)*a;for(let A=0;A<=_;A++)c[A].x-=T,c[A].y+=l+f+p}function Cz(c){return c.imagePrimary!==void 0&&c.top!==void 0&&c.bottom!==void 0&&c.left!==void 0&&c.right!==void 0}function pne(c,a,l,f){const{horizontalAlign:p,verticalAlign:_}=Uk(f),y=l[0]-c.displaySize[0]*p,T=l[1]-c.displaySize[1]*_;return{imagePrimary:c,imageSecondary:a,top:T,bottom:T+c.displaySize[1],left:y,right:y+c.displaySize[0]}}function Pz(c,a,l,f,p,_){const y=c.imagePrimary;let T;if(y.content){const ie=y.content,ae=y.pixelRatio||1;T=[ie[0]/ae,ie[1]/ae,y.displaySize[0]-ie[2]/ae,y.displaySize[1]-ie[3]/ae]}const A=a.left*_,I=a.right*_;let D,F,z,H;l==="width"||l==="both"?(H=p[0]+A-f[3],F=p[0]+I+f[1]):(H=p[0]+(A+I-y.displaySize[0])/2,F=H+y.displaySize[0]);const q=a.top*_,ne=a.bottom*_;return l==="height"||l==="both"?(D=p[1]+q-f[0],z=p[1]+ne+f[2]):(D=p[1]+(q+ne-y.displaySize[1])/2,z=D+y.displaySize[1]),{imagePrimary:y,imageSecondary:void 0,top:D,right:F,bottom:z,left:H,collisionPadding:T}}function Iz(c){return!c.imagePrimary.stretchX}function kz(c){return!c.imagePrimary.stretchY}function Oz(c){return{width:c.right-c.left,height:c.bottom-c.top}}const eh=128;function Mz(c,a,l){const{expression:f}=a;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new Kn(c+1,{worldview:l}))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=f;let y=0;for(;y<p.length&&p[y]<=c;)y++;y=Math.max(0,y-1);let T=y;for(;T<p.length&&p[T]<c+1;)T++;T=Math.min(p.length-1,T);const A=p[y],I=p[T];return f.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:I,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:I,minSize:f.evaluate(new Kn(A,{worldview:l})),maxSize:f.evaluate(new Kn(I,{worldview:l})),interpolationType:_}}}function $k(c,{uSize:a,uSizeT:l},{lowerSize:f,upperSize:p}){return c.kind==="source"?f/eh:c.kind==="composite"?Ir(f/eh,p/eh,l):a}function u1(c,a,l=1){let f=0,p=0;if(c.kind==="constant")p=c.layoutSize*l;else if(c.kind!=="source"){const{interpolationType:_,minZoom:y,maxZoom:T}=c,A=_?Q($s.interpolationFactor(_,a,y,T),0,1):0;c.kind==="camera"?p=Ir(c.minSize,c.maxSize,A)*l:f=A*l}return{uSizeT:f,uSize:p}}class lf extends Pt{constructor(a,l,f,p,_){super(a,l),this.angle=p,this.z=f,_!==void 0&&(this.segment=_)}clone(){return new lf(this.x,this.y,this.z,this.angle,this.segment)}}function Rz(c,a,l,f,p){if(a.segment===void 0)return!0;let _=a,y=a.segment+1,T=0;for(;T>-l/2;){if(y--,y<0)return!1;T-=c[y].dist(_),_=c[y]}T+=c[y].dist(c[y+1]),y++;const A=[];let I=0;for(;T<l/2;){const D=c[y],F=c[y+1];if(!F)return!1;let z=c[y-1].angleTo(D)-D.angleTo(F);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:z}),I+=z;T-A[0].distance>f;)I-=A.shift().angleDelta;if(I>p)return!1;y++,T+=D.dist(F)}return!0}function Dz(c){let a=0;for(let l=0;l<c.length-1;l++)a+=c[l].dist(c[l+1]);return a}function Fz(c,a,l){return c?.6*a*l:0}function Lz(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function mne(c,a,l,f,p,_){const y=Fz(l,p,_),T=Lz(l,f)*_;let A=0;const I=Dz(c)/2;for(let D=0;D<c.length-1;D++){const F=c[D],z=c[D+1],H=F.dist(z);if(A+H>I){const q=(I-A)/H,ne=Ir(F.x,z.x,q),ie=Ir(F.y,z.y,q),ae=new lf(ne,ie,0,z.angleTo(F),D);return!y||Rz(c,ae,T,y,a)?ae:void 0}A+=H}}function gne(c,a,l,f,p,_,y,T,A){const I=Fz(f,_,y),D=Lz(f,p),F=D*y,z=c[0].x===0||c[0].x===A||c[0].y===0||c[0].y===A;return a-F<a/4&&(a=F+a/4),Nz(c,z?a/2*T%a:(D/2+2*_)*y*T%a,a,I,l,F,z,!1,A)}function Nz(c,a,l,f,p,_,y,T,A){const I=_/2,D=Dz(c);let F=0,z=a-l,H=[];for(let q=0;q<c.length-1;q++){const ne=c[q],ie=c[q+1],ae=ne.dist(ie),me=ie.angleTo(ne);for(;z+l<F+ae;){z+=l;const ye=(z-F)/ae,we=Ir(ne.x,ie.x,ye),Be=Ir(ne.y,ie.y,ye);if(we>=0&&we<A&&Be>=0&&Be<A&&z-I>=0&&z+I<=D){const ze=new lf(we,Be,0,me,q);f&&!Rz(c,ze,_,f,p)||H.push(ze)}}F+=ae}return T||H.length||y||(H=Nz(c,F/2,l,f,p,_,y,!0,A)),H}function Bz(c){let a=0,l=0;for(const y of c)a+=y.w*y.h,l=Math.max(l,y.w);c.sort((y,T)=>T.h-y.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),l),h:1/0}];let p=0,_=0;for(const y of c)for(let T=f.length-1;T>=0;T--){const A=f[T];if(!(y.w>A.w||y.h>A.h)){if(y.x=A.x,y.y=A.y,_=Math.max(_,y.y+y.h),p=Math.max(p,y.x+y.w),y.w===A.w&&y.h===A.h){const I=f.pop();I&&T<f.length&&(f[T]=I)}else y.h===A.h?(A.x+=y.w,A.w-=y.w):y.w===A.w?(A.y+=y.h,A.h-=y.h):(f.push({x:A.x+y.w,y:A.y,w:A.w-y.w,h:y.h}),A.y+=y.h,A.h-=y.h);break}}return{w:p,h:_,fill:a/(p*_)||0}}sr(lf,"Anchor");const Mm=1;class h1{static getImagePositionScale(a,l,f){if(l&&a&&a.options&&a.options.transform){const p=a.options.transform;return{x:p.a,y:p.d}}return{x:f,y:f}}constructor(a,l,f,p){this.paddedRect=a;const{pixelRatio:_,version:y,stretchX:T,stretchY:A,content:I,sdf:D,usvg:F}=l;this.pixelRatio=_,this.stretchX=T,this.stretchY=A,this.content=I,this.version=y,this.padding=f,this.sdf=D,this.usvg=F,this.scale=h1.getImagePositionScale(p,F,_)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function Vk(c,a,l){const f=Cl.parse(c),p=function(_,y,T=[1,1]){return{x:0,y:0,w:(_.data?_.data.width:_.width*T[0])+2*y,h:(_.data?_.data.height:_.height*T[1])+2*y}}(a,l,[f.options.transform.a,f.options.transform.d]);return{bin:p,imagePosition:new h1(p,a,l,f),imageVariant:f}}class zz{constructor(a,l,f){const p=new Map,_=new Map;this.haveRenderCallbacks=[];const y=[];this.addImages(a,p,Mm,y),this.addImages(l,_,2,y);const{w:T,h:A}=Bz(y),I=new fo({width:T||1,height:A||1});for(const[D,F]of a.entries()){const z=p.get(D).paddedRect;fo.copy(F.data,I,{x:0,y:0},{x:z.x+Mm,y:z.y+Mm},F.data,null,F.sdf)}for(const[D,F]of l.entries()){const z=_.get(D),H=z.paddedRect;let q=z.padding;const ne=H.x+q,ie=H.y+q,ae=F.data.width,me=F.data.height;q=q>1?q-1:q,fo.copy(F.data,I,{x:0,y:0},{x:ne,y:ie},F.data,f),fo.copy(F.data,I,{x:0,y:me-q},{x:ne,y:ie-q},{width:ae,height:q},f),fo.copy(F.data,I,{x:0,y:0},{x:ne,y:ie+me},{width:ae,height:q},f),fo.copy(F.data,I,{x:ae-q,y:0},{x:ne-q,y:ie},{width:q,height:me},f),fo.copy(F.data,I,{x:0,y:0},{x:ne+ae,y:ie},{width:q,height:me},f),fo.copy(F.data,I,{x:ae-q,y:me-q},{x:ne-q,y:ie-q},{width:q,height:q},f),fo.copy(F.data,I,{x:0,y:me-q},{x:ne+ae,y:ie-q},{width:q,height:q},f),fo.copy(F.data,I,{x:0,y:0},{x:ne+ae,y:ie+me},{width:q,height:q},f),fo.copy(F.data,I,{x:ae-q,y:0},{x:ne-q,y:ie+me},{width:q,height:q},f)}this.lut=f,this.image=I,this.iconPositions=p,this.patternPositions=_}addImages(a,l,f,p){for(const[_,y]of a.entries()){const{bin:T,imagePosition:A,imageVariant:I}=Vk(_,y,f);l.set(_,A),p.push(T),y.hasRenderCallback&&this.haveRenderCallbacks.push(I.id)}}patchUpdatedImages(a,l,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>a.hasImage(p,f)),a.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const p of a.getUpdatedImages(f)){for(const _ of this.iconPositions.keys()){const y=Cl.parse(_);if(zs.isEqual(y.id,p)){const T=a.getImage(p,f);this.patchUpdatedImage(this.iconPositions.get(_),T,l,null)}}for(const _ of this.patternPositions.keys()){const y=Cl.parse(_);if(zs.isEqual(y.id,p)){const T=a.getImage(p,f);this.patchUpdatedImage(this.patternPositions.get(_),T,l,this.lut)}}}}patchUpdatedImage(a,l,f,p=null){if(!a||!l||a.version===l.version)return;a.version=l.version;const[_,y]=a.tl,T=a.sdf;if(this.lut||T){const A={width:l.data.width,height:l.data.height},I=new fo(A);fo.copy(l.data,I,{x:0,y:0},{x:0,y:0},A,p,T),f.update(I,{position:{x:_,y}})}else f.update(l.data,{position:{x:_,y}})}}sr(h1,"ImagePosition"),sr(zz,"ImageAtlas");const f1=1e20;function jz(c,a,l,f,p,_,y,T,A){for(let I=a;I<a+f;I++)Uz(c,l*_+I,_,p,y,T,A);for(let I=l;I<l+p;I++)Uz(c,I*_+a,1,f,y,T,A)}function Uz(c,a,l,f,p,_,y){_[0]=0,y[0]=-f1,y[1]=f1,p[0]=c[a];for(let T=1,A=0,I=0;T<f;T++){p[T]=c[a+T*l];const D=T*T;do{const F=_[A];I=(p[T]-p[F]+D-F*F)/(T-F)/2}while(I<=y[A]&&--A>-1);A++,_[A]=T,y[A]=I,y[A+1]=f1}for(let T=0,A=0;T<f;T++){for(;y[A+1]<T;)A++;const I=_[A],D=T-I;c[a+T*l]=p[I]+D*D}}const Kc=2,Wk={none:0,ideographs:1,all:2};class p_{constructor(a,l,f){this.requestManager=a,this.localGlyphMode=l,this.localFontFamily=f,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,l){const f=[],p=this.url||Ao.GLYPHS_URL;for(const _ in a)for(const y of a[_])f.push({stack:_,id:y});fe(f,({stack:_,id:y},T)=>{let A=this.entries[_];A||(A=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=A.glyphs[y];if(I!==void 0)return void T(null,{stack:_,id:y,glyph:I});if(I=this._tinySDF(A,_,y),I)return A.glyphs[y]=I,void T(null,{stack:_,id:y,glyph:I});const D=Math.floor(y/256);if(256*D>65535)return nr("glyphs > 65535 not supported"),void T(null,{stack:_,id:y,glyph:I});if(A.ranges[D])return void T(null,{stack:_,id:y,glyph:I});let F=A.requests[D];F||(F=A.requests[D]=[],p_.loadGlyphRange(_,D,p,this.requestManager,(z,H)=>{if(H){A.ascender=H.ascender,A.descender=H.descender;for(const q in H.glyphs)this._doesCharSupportLocalGlyph(+q)||(A.glyphs[+q]=H.glyphs[+q]);A.ranges[D]=!0}for(const q of F)q(z,H);delete A.requests[D]})),F.push((z,H)=>{z?T(z):H&&T(null,{stack:_,id:y,glyph:H.glyphs[y]||null})})},(_,y)=>{if(_)l(_);else if(y){const T={};for(const{stack:A,id:I,glyph:D}of y)T[A]===void 0&&(T[A]={}),T[A].glyphs===void 0&&(T[A].glyphs={}),T[A].glyphs[I]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},T[A].ascender=this.entries[A].ascender,T[A].descender=this.entries[A].descender;l(null,T)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==Wk.none&&(this.localGlyphMode===Wk.all?!!this.localFontFamily:!!this.localFontFamily&&(Pr["CJK Unified Ideographs"](a)||Pr["Hangul Syllables"](a)||Pr.Hiragana(a)||Pr.Katakana(a)||Pr["CJK Symbols and Punctuation"](a)||Pr["CJK Unified Ideographs Extension A"](a)||Pr["CJK Unified Ideographs Extension B"](a)||Pr.Osage(a)))}_tinySDF(a,l,f){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(f))return;let _=a.tinySDF;if(!_){let ne="400";/bold/i.test(l)?ne="900":/medium/i.test(l)?ne="500":/light/i.test(l)&&(ne="200"),_=a.tinySDF=new p_.TinySDF({fontFamily:p,fontWeight:ne,fontSize:24*Kc,buffer:3*Kc,radius:8*Kc}),_.fontWeight=ne}if(this.localGlyphs[_.fontWeight][f])return this.localGlyphs[_.fontWeight][f];const y=String.fromCodePoint(f),{data:T,width:A,height:I,glyphWidth:D,glyphHeight:F,glyphLeft:z,glyphTop:H,glyphAdvance:q}=_.draw(y);return this.localGlyphs[_.fontWeight][f]={id:f,bitmap:new Cd({width:A,height:I},T),metrics:{width:D/Kc,height:F/Kc,left:z/Kc,top:H/Kc-27,advance:q/Kc,localGlyph:!0}}}}p_.loadGlyphRange=function(c,a,l,f,p){const _=256*a,y=_+255,T=f.transformRequest(f.normalizeGlyphsURL(l).replace("{fontstack}",c).replace("{range}",`${_}-${y}`),Z0.Glyphs);Yf(T,(A,I)=>{if(A)p(A);else if(I){const D={},F=function(z){return new ZT(z).readFields(cne,{})}(I);for(const z of F.glyphs)D[z.id]=z;p(null,{glyphs:D,ascender:F.ascender,descender:F.descender})}})},p_.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:l=8,cutoff:f=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:y="normal",lang:T=null}={}){this.buffer=a,this.cutoff=f,this.radius=l,this.lang=T;const A=this.size=c+4*a,I=this._createCanvas(A),D=this.ctx=I.getContext("2d",{willReadFrequently:!0});D.font=`${y} ${_} ${c}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:f,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(c),y=Math.ceil(l),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),A=Math.min(this.size-this.buffer,y+Math.ceil(f)),I=T+2*this.buffer,D=A+2*this.buffer,F=Math.max(I*D,0),z=new Uint8ClampedArray(F),H={data:z,width:I,height:D,glyphWidth:T,glyphHeight:A,glyphTop:y,glyphLeft:0,glyphAdvance:a};if(T===0||A===0)return H;const{ctx:q,buffer:ne,gridInner:ie,gridOuter:ae}=this;this.lang&&(q.lang=this.lang),q.clearRect(ne,ne,T,A),q.fillText(c,ne,ne+y);const me=q.getImageData(ne,ne,T,A);ae.fill(f1,0,F),ie.fill(0,0,F);for(let ye=0;ye<A;ye++)for(let we=0;we<T;we++){const Be=me.data[4*(ye*T+we)+3]/255;if(Be===0)continue;const ze=(ye+ne)*I+we+ne;if(Be===1)ae[ze]=0,ie[ze]=f1;else{const Ve=.5-Be;ae[ze]=Ve>0?Ve*Ve:0,ie[ze]=Ve<0?Ve*Ve:0}}jz(ae,0,0,I,D,I,this.f,this.v,this.z),jz(ie,ne,ne,T,A,I,this.f,this.v,this.z);for(let ye=0;ye<F;ye++){const we=Math.sqrt(ae[ye])-Math.sqrt(ie[ye]);z[ye]=Math.round(255-255*(we/this.radius+this.cutoff))}return H}};const kd=Mm;function $z(c,a){return c+a[1]-a[0]}function Vz(c,a,l,f,p=1){const _=[],y=c.imagePrimary,T=y.pixelRatio,A=y.paddedRect.w-2*kd,I=y.paddedRect.h-2*kd,D=(c.right-c.left)*p,F=(c.bottom-c.top)*p,z=y.stretchX||[[0,A]],H=y.stretchY||[[0,I]],q=z.reduce($z,0),ne=H.reduce($z,0),ie=A-q,ae=I-ne;let me=0,ye=q,we=0,Be=ne,ze=0,Ve=ie,Ze=0,Ye=ae;if(y.content&&f){const nt=y.content;me=KT(z,0,nt[0]),we=KT(H,0,nt[1]),ye=KT(z,nt[0],nt[2]),Be=KT(H,nt[1],nt[3]),ze=nt[0]-me,Ze=nt[1]-we,Ve=nt[2]-nt[0]-ye,Ye=nt[3]-nt[1]-Be}const Ct=(nt,kt,zt,Ot)=>{const Lt=JT(nt.stretch-me,ye,D,c.left*p),$t=QT(nt.fixed-ze,Ve,nt.stretch,q),Et=JT(kt.stretch-we,Be,F,c.top*p),Nt=QT(kt.fixed-Ze,Ye,kt.stretch,ne),gt=JT(zt.stretch-me,ye,D,c.left*p),ut=QT(zt.fixed-ze,Ve,zt.stretch,q),Vt=JT(Ot.stretch-we,Be,F,c.top*p),jt=QT(Ot.fixed-Ze,Ye,Ot.stretch,ne),br=new Pt(Lt,Et),ir=new Pt(gt,Et),dr=new Pt(gt,Vt),qt=new Pt(Lt,Vt),xr=new Pt($t/T,Nt/T),jr=new Pt(ut/T,jt/T),Qt=a*Math.PI/180;if(Qt){const hr=Math.sin(Qt),Wr=Math.cos(Qt),dn=[Wr,-hr,hr,Wr];br._matMult(dn),ir._matMult(dn),qt._matMult(dn),dr._matMult(dn)}const gr=nt.stretch+nt.fixed,Or=zt.stretch+zt.fixed,Vr=kt.stretch+kt.fixed,rn=Ot.stretch+Ot.fixed,Gr=c.imageSecondary;return{tl:br,tr:ir,bl:qt,br:dr,texPrimary:{x:y.paddedRect.x+kd+gr,y:y.paddedRect.y+kd+Vr,w:Or-gr,h:rn-Vr},texSecondary:Gr?{x:Gr.paddedRect.x+kd+gr,y:Gr.paddedRect.y+kd+Vr,w:Or-gr,h:rn-Vr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:xr,pixelOffsetBR:jr,minFontScaleX:Ve/T/D,minFontScaleY:Ye/T/F,isSDF:l}};if(f&&(y.stretchX||y.stretchY)){const nt=Wz(z,ie,q),kt=Wz(H,ae,ne);for(let zt=0;zt<nt.length-1;zt++){const Ot=nt[zt],Lt=nt[zt+1];for(let $t=0;$t<kt.length-1;$t++)_.push(Ct(Ot,kt[$t],Lt,kt[$t+1]))}}else _.push(Ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:I+1}));return _}function KT(c,a,l){let f=0;for(const p of c)f+=Math.max(a,Math.min(l,p[1]))-Math.max(a,Math.min(l,p[0]));return f}function Wz(c,a,l){const f=[{fixed:-kd,stretch:0}];for(const[p,_]of c){const y=f[f.length-1];f.push({fixed:p-y.stretch,stretch:y.stretch}),f.push({fixed:p-y.stretch,stretch:y.stretch+(_-p)})}return f.push({fixed:a+kd,stretch:l}),f}function JT(c,a,l,f){return c/a*l+f}function QT(c,a,l,f){return c-a*l/f}function _ne(c,a,l,f){const p=a+c.positionedLines[f].lineOffset;return f===0?l+p/2:l+(p+(a+c.positionedLines[f-1].lineOffset))/2}function yne(c,a=1,l=!1){let f=1/0,p=1/0,_=-1/0,y=-1/0;const T=c[0];for(let H=0;H<T.length;H++){const q=T[H];(!H||q.x<f)&&(f=q.x),(!H||q.y<p)&&(p=q.y),(!H||q.x>_)&&(_=q.x),(!H||q.y>y)&&(y=q.y)}const A=Math.min(_-f,y-p);let I=A/2;const D=new dg([],vne);if(A===0)return new Pt(f,p);for(let H=f;H<_;H+=A)for(let q=p;q<y;q+=A)D.push(new m_(H+I,q+I,I,c));let F=function(H){let q=0,ne=0,ie=0;const ae=H[0];for(let me=0,ye=ae.length,we=ye-1;me<ye;we=me++){const Be=ae[me],ze=ae[we],Ve=Be.x*ze.y-ze.x*Be.y;ne+=(Be.x+ze.x)*Ve,ie+=(Be.y+ze.y)*Ve,q+=3*Ve}return new m_(ne/q,ie/q,0,H)}(c),z=D.length;for(;D.length;){const H=D.pop();(H.d>F.d||!F.d)&&(F=H,l&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,z)),H.max-F.d<=a||(I=H.h/2,D.push(new m_(H.p.x-I,H.p.y-I,I,c)),D.push(new m_(H.p.x+I,H.p.y-I,I,c)),D.push(new m_(H.p.x-I,H.p.y+I,I,c)),D.push(new m_(H.p.x+I,H.p.y+I,I,c)),z+=4)}return l&&(console.log(`num probes: ${z}`),console.log(`best distance: ${F.d}`)),F.p}function vne(c,a){return a.max-c.max}class m_{constructor(a,l,f,p){this.p=new Pt(a,l),this.h=f,this.d=function(_,y){let T=!1,A=1/0;for(let I=0;I<y.length;I++){const D=y[I];for(let F=0,z=D.length,H=z-1;F<z;H=F++){const q=D[F],ne=D[H];q.y>_.y!=ne.y>_.y&&_.x<(ne.x-q.x)*(_.y-q.y)/(ne.y-q.y)+q.x&&(T=!T),A=Math.min(A,xi(_,q,ne))}}return(T?1:-1)*Math.sqrt(A)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const xne=Object.keys,Gk=Number.POSITIVE_INFINITY,wne=Math.sqrt(2);function Gz(c,[a,l]){let f=0,p=0;if(l===Gk){a<0&&(a=0);const _=a/wne;switch(c){case"top-right":case"top-left":p=_-7;break;case"bottom-right":case"bottom-left":p=7-_;break;case"bottom":p=7-a;break;case"top":p=a-7}switch(c){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=a;break;case"right":f=-a}}else{switch(a=Math.abs(a),l=Math.abs(l),c){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(c){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}}return[f,p]}function eS(c,a,l,f,p,_,y,T,A){if(!a||!a.usvg)return;const I=Oz(f),D=Oz(p),F=_!=="both"&&_!=="width"||!Iz(f)?1:D.width/I.width,z=_!=="both"&&_!=="height"||!kz(f)?1:D.height/I.height;l.scaleSelf(F,z);const H=l.toString();y.set(H,l),T.set(H,a);const{imagePosition:q}=Vk(H,a,Mm);A.set(H,q)}function Hz(c,a,l,f,p,_,y,T,A){if(!c)return;const I=function(D,F,z,H,q,ne){if(D.kind==="camera")return D.maxSize;if(D.kind==="composite"){const ie=F.possiblyEvaluate(new Kn(D.maxZoom,{worldview:ne}),z).evaluate(q,{},z),ae=F.possiblyEvaluate(new Kn(D.minZoom,{worldview:ne}),z).evaluate(q,{},z);return Math.max(ie,ae)}return F.possiblyEvaluate(new Kn(H,{worldview:ne})).evaluate(q,{},z)}(a,l,f,p,_,A);return c.scaleSelf(I*T*y)}function qz(c,a,l,f,p,_,y,T,A){return{iconPrimary:Hz(c.getPrimary(),a,l,f,p,_,y,T,A),iconSecondary:Hz(c.getSecondary(),a,l,f,p,_,y,T,A)}}function bne(c,a,l){if(!a)return;const f=l.get(c.toString()),p=l.get(a.toString());f&&p&&(f.paddedRect.w===p.paddedRect.w&&f.paddedRect.h===p.paddedRect.h||nr(`Mismatch in icon variant sizes: ${c.toString()} and ${a.toString()}`),f.usvg!==p.usvg&&nr(`Mismatch in icon variant image types: ${c.id} and ${a.id}`))}function Xz(c,a,l,f){if(!c)return;const p=a.get(l.toString());if(c.imagePrimary=p,f){const _=a.get(f.toString());c.imageSecondary=_}}function Tne(c,a){for(const l in c.horizontal)Zz(c.horizontal[l],a);Zz(c.vertical,a)}function Zz(c,a){if(c){for(const l of c.positionedLines)for(const f of l.positionedGlyphs)if(f.image!==null){const p=f.image.toString();f.rect=a.get(p).paddedRect}}}function Hk(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sne(c,a,l,f,p,_,y,T,A){const I=qk(_.horizontal)||_.vertical,D=l.get("icon-text-fit-padding").evaluate(f,{},p);let F,z=a;return a&&A!=="none"&&(c.allowVerticalPlacement&&_.vertical&&(F=Pz(a,_.vertical,A,D,T,y)),I&&(z=Pz(a,I,A,D,T,y))),{defaultShapedIcon:z,verticallyShapedIcon:F}}function Ene(c,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae,me,ye){let we=y.textMaxSize.evaluate(a,{},z);we===void 0?we=T*y.textScaleFactor:we*=y.textScaleFactor;const Be=c.layers[0].layout,ze=qk(l.horizontal)||l.vertical,Ve=H.name==="globe",Ze=Xa,Ye=c.tilePixelRatio*we/Ze,Ct=($t=c.overscaling,c.zoom>18&&$t>2&&($t>>=1),Math.max(Zt/(512*$t),1)*Be.get("symbol-spacing")),nt=Be.get("text-padding")*c.tilePixelRatio,kt=Be.get("icon-padding")*c.tilePixelRatio,zt=Qe(Be.get("text-max-angle")),Ot=Be.get("icon-rotation-alignment")==="map"&&ye!=="point",Lt=Ct/2;var $t;c.hasAnyIconTextFit===!1&&ie!=="none"&&(c.hasAnyIconTextFit=!0);const Et=a.properties?+a.properties[Jr]:null,Nt=Et&&c.elevationFeatureIdToIndex?c.elevationFeatureIdToIndex.get(Et):65535,gt=(ut,Vt,jt)=>{if(Vt.x<0||Vt.x>=Zt||Vt.y<0||Vt.y>=Zt)return;let br=null;if(Ve){const{x:ir,y:dr,z:qt}=H.projectTilePoint(Vt.x,Vt.y,jt);br={anchor:new lf(ir,dr,qt,0,void 0),up:H.upVector(jt,Vt.x,Vt.y)}}(function(ir,dr,qt,xr,jr,Qt,gr,Or,Vr,rn,Gr,hr,Wr,dn,Ae,Ce,dt,At,Jt,Kt,lr,Er,nn,on,tn,Fn,mi,en,Jn){const Bn=ir.addToLineVertexArray(dr,xr);let bn,ri,ni,qn,Qn,zn,sn,Vn=0,Si=0,Dr=0,gn=0,ii=-1,Oi=-1;const hi={};let _a=Q0("");const Wn=qt?qt.anchor:dr,ua=en!=="none";let gs=0,po=0;if(Vr._unevaluatedLayout.getValue("text-radial-offset")===void 0){const ya=Vr.layout.get("text-offset").evaluate(lr,{},tn);gs=ya[0]*Xa,po=ya[1]*Xa}else gs=Vr.layout.get("text-radial-offset").evaluate(lr,{},tn)*Xa,po=Gk;if(ir.allowVerticalPlacement&&jr.vertical){const ya=jr.vertical;if(Ae)zn=Xk(ya),Or&&(sn=Xk(Or));else{const Ba=Vr.layout.get("text-rotate").evaluate(lr,{},tn)+90;ni=tS(rn,Wn,dr,Gr,hr,Wr,ya,dn,Ba,Ce),Or&&(qn=tS(rn,Wn,dr,Gr,hr,Wr,Or,At,Ba))}}if(Qt){const ya=ir.iconSizeData,Ba=Vr.layout.get("icon-rotate").evaluate(lr,{},tn),mo=Vz(Qt,Ba,nn,ua,Er.iconScaleFactor),Go=Or?Vz(Or,Ba,nn,ua,Er.iconScaleFactor):void 0;ri=tS(rn,Wn,dr,Gr,hr,Wr,Qt,At,Ba,null),Vn=4*mo.length;let Io=null;ya.kind==="source"?(Io=[eh*Vr.layout.get("icon-size").evaluate(lr,{},tn)*Er.iconScaleFactor],Io[0]>Od&&nr(`${ir.layerIds[0]}: Value for "icon-size" is >= ${d1}. Reduce your "icon-size".`)):ya.kind==="composite"&&(Io=[eh*Er.compositeIconSizes[0].evaluate(lr,{},tn)*Er.iconScaleFactor,eh*Er.compositeIconSizes[1].evaluate(lr,{},tn)*Er.iconScaleFactor],(Io[0]>Od||Io[1]>Od)&&nr(`${ir.layerIds[0]}: Value for "icon-size" is >= ${d1}. Reduce your "icon-size".`)),ir.addSymbols(ir.icon,mo,Io,Kt,Jt,lr,void 0,qt,dr,Bn.lineStartIndex,Bn.lineLength,-1,on,tn,Fn,mi),ii=ir.icon.placedSymbolArray.length-1,Go&&(Si=4*Go.length,ir.addSymbols(ir.icon,Go,Io,Kt,Jt,lr,qs.vertical,qt,dr,Bn.lineStartIndex,Bn.lineLength,-1,on,tn,Fn,mi),Oi=ir.icon.placedSymbolArray.length-1)}for(const ya in jr.horizontal){const Ba=ya,mo=jr.horizontal[Ba];bn||(_a=Q0(mo.text),Ae?Qn=Xk(mo):bn=tS(rn,Wn,dr,Gr,hr,Wr,mo,dn,Vr.layout.get("text-rotate").evaluate(lr,{},tn),Ce));const Go=mo.positionedLines.length===1;if(Dr+=Yz(ir,qt,dr,mo,gr,Vr,Ae,lr,Ce,Bn,jr.vertical?qs.horizontal:qs.horizontalOnly,Go?xne(jr.horizontal):[Ba],hi,ii,Er,on,tn,Fn),Go)break}jr.vertical&&(gn+=Yz(ir,qt,dr,jr.vertical,gr,Vr,Ae,lr,Ce,Bn,qs.vertical,["vertical"],hi,Oi,Er,on,tn,Fn));let ao=-1;const _s=(ya,Ba)=>ya?Math.max(ya,Ba):Ba;ao=_s(Qn,ao),ao=_s(zn,ao),ao=_s(sn,ao);const th=ao>-1?1:0;ir.glyphOffsetArray.length>=65535&&nr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),lr.sortKey!==void 0&&ir.addToSortKeyRanges(ir.symbolInstances.length,lr.sortKey),ir.symbolInstances.emplaceBack(dr.x,dr.y,Wn.x,Wn.y,Wn.z,hi.right>=0?hi.right:-1,hi.center>=0?hi.center:-1,hi.left>=0?hi.left:-1,hi.vertical>=0?hi.vertical:-1,ii,Oi,_a,bn!==void 0?bn:ir.collisionBoxArray.length,bn!==void 0?bn+1:ir.collisionBoxArray.length,ni!==void 0?ni:ir.collisionBoxArray.length,ni!==void 0?ni+1:ir.collisionBoxArray.length,ri!==void 0?ri:ir.collisionBoxArray.length,ri!==void 0?ri+1:ir.collisionBoxArray.length,qn||ir.collisionBoxArray.length,qn?qn+1:ir.collisionBoxArray.length,Gr,Dr,gn,Vn,Si,th,0,gs,po,ao,0,ua?1:0,Jn)})(c,Vt,br,ut,l,f,_,p,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,nt,me,I,0,kt,Ot,ae,a,y,D,F,z,q,ne,ie,Nt)};if(ye==="line")for(const ut of UT(a.geometry,0,0,Zt,Zt)){const Vt=gne(ut,Ct,zt,l.vertical||ze,f,Ze,Ye,c.overscaling,Zt);for(const jt of Vt)ze&&Ane(c,ze.text,Lt,jt)||gt(ut,jt,z)}else if(ye==="line-center"){for(const ut of a.geometry)if(ut.length>1){const Vt=mne(ut,zt,l.vertical||ze,f,Ze,Ye);Vt&&gt(ut,Vt,z)}}else if(a.type==="Polygon")for(const ut of Zx(a.geometry,0)){const Vt=yne(ut,16);gt(ut[0],new lf(Vt.x,Vt.y,0,0,void 0),z)}else if(a.type==="LineString")for(const ut of a.geometry)gt(ut,new lf(ut[0].x,ut[0].y,0,0,void 0),z);else if(a.type==="Point")for(const ut of a.geometry)for(const Vt of ut)gt([Vt],new lf(Vt.x,Vt.y,0,0,void 0),z)}const d1=255,Od=d1*eh;function Yz(c,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie,ae){const me=function(Be,ze,Ve,Ze,Ye,Ct,nt,kt){const zt=[];if(ze.positionedLines.length===0)return zt;const Ot=Ze.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,Lt=function(ut){const Vt=ut[0],jt=ut[1],br=Vt*jt;return br>0?[Vt,-jt]:br<0?[-Vt,jt]:Vt===0?[jt,Vt]:[jt,-Vt]}(Ve);let $t=Math.abs(ze.top-ze.bottom);for(const ut of ze.positionedLines)$t-=ut.lineOffset;const Et=ze.positionedLines.length,Nt=$t/Et;let gt=ze.top-Ve[1];for(let ut=0;ut<Et;++ut){const Vt=ze.positionedLines[ut];gt=_ne(ze,Nt,gt,ut);for(const jt of Vt.positionedGlyphs){if(!jt.rect)continue;const br=jt.rect||{};let ir=wz+1,dr=!0,qt=1,xr=0;if(jt.image){const lr=nt.get(jt.image.toString());if(!lr)continue;if(lr.sdf){nr("SDF images are not supported in formatted text and will be ignored.");continue}dr=!1,qt=lr.pixelRatio,ir=Mm/qt}const jr=(Ye||kt)&&jt.vertical,Qt=jt.metrics.advance*jt.scale/2,gr=jt.metrics,Or=jt.rect;if(Or===null)continue;kt&&ze.verticalizable&&(xr=jt.image?Qt-jt.metrics.width*jt.scale/2:0);const Vr=Ye?[jt.x+Qt,jt.y]:[0,0];let rn=[0,0],Gr=[0,0],hr=!1;Ye||(jr?(Gr=[jt.x+Qt+Lt[0],jt.y+Lt[1]-xr],hr=!0):rn=[jt.x+Qt+Ve[0],jt.y+Ve[1]-xr]);const Wr=Or.w*jt.scale/(qt*(jt.localGlyph?Kc:1)),dn=Or.h*jt.scale/(qt*(jt.localGlyph?Kc:1));let Ae,Ce,dt,At;if(jr){const lr=jt.y-gt,Er=new Pt(-Qt,Qt-lr),nn=-Math.PI/2,on=new Pt(...Gr);Ae=new Pt(-Qt+rn[0],rn[1]),Ae._rotateAround(nn,Er)._add(on),Ae.x+=-lr+Qt,Ae.y-=(gr.left-ir)*jt.scale;const tn=jt.image?gr.advance*jt.scale:Xa*jt.scale,Fn=String.fromCodePoint(jt.glyph);Jre(Fn)?Ae.x+=(1-ir)*jt.scale:Qre(Fn)?Ae.x+=tn-gr.height*jt.scale+(-ir-1)*jt.scale:Ae.x+=jt.image||gr.width+2*ir===Or.w&&gr.height+2*ir===Or.h?(tn-dn)/2:(tn-(gr.height+2*ir)*jt.scale)/2,Ce=new Pt(Ae.x,Ae.y-Wr),dt=new Pt(Ae.x+dn,Ae.y),At=new Pt(Ae.x+dn,Ae.y-Wr)}else{const lr=(gr.left-ir)*jt.scale-Qt+rn[0],Er=(-gr.top-ir)*jt.scale+rn[1],nn=lr+Wr,on=Er+dn;Ae=new Pt(lr,Er),Ce=new Pt(nn,Er),dt=new Pt(lr,on),At=new Pt(nn,on)}if(Ot){let lr;lr=Ye?new Pt(0,0):hr?new Pt(Lt[0],Lt[1]):new Pt(Ve[0],Ve[1]),Ae._rotateAround(Ot,lr),Ce._rotateAround(Ot,lr),dt._rotateAround(Ot,lr),At._rotateAround(Ot,lr)}const Jt=new Pt(0,0),Kt=new Pt(0,0);zt.push({tl:Ae,tr:Ce,bl:dt,br:At,texPrimary:br,texSecondary:void 0,writingMode:ze.writingMode,glyphOffset:Vr,sectionIndex:jt.sectionIndex,isSDF:dr,pixelOffsetTL:Jt,pixelOffsetBR:Kt,minFontScaleX:0,minFontScaleY:0})}}return zt}(0,f,A,_,y,T,p,c.allowVerticalPlacement),ye=c.textSizeData;let we=null;ye.kind==="source"?(we=[eh*_.layout.get("text-size").evaluate(T,{},ie)*q.textScaleFactor],we[0]>Od&&nr(`${c.layerIds[0]}: Value for "text-size" is >= ${d1}. Reduce your "text-size".`)):ye.kind==="composite"&&(we=[eh*q.compositeTextSizes[0].evaluate(T,{},ie)*q.textScaleFactor,eh*q.compositeTextSizes[1].evaluate(T,{},ie)*q.textScaleFactor],(we[0]>Od||we[1]>Od)&&nr(`${c.layerIds[0]}: Value for "text-size" is >= ${d1}. Reduce your "text-size".`)),c.addSymbols(c.text,me,we,A,y,T,D,a,l,I.lineStartIndex,I.lineLength,H,ne,ie,ae,!1);for(const Be of F)z[Be]=c.text.placedSymbolArray.length-1;return 4*me.length}function qk(c){for(const a in c)return c[a];return null}function tS(c,a,l,f,p,_,y,T,A,I){let D=y.top,F=y.bottom,z=y.left,H=y.right;if(Cz(y)&&y.collisionPadding){const q=y.collisionPadding;z-=q[0],D-=q[1],H+=q[2],F+=q[3]}if(A){const q=new Pt(z,D),ne=new Pt(H,D),ie=new Pt(z,F),ae=new Pt(H,F),me=Qe(A);let ye=new Pt(0,0);I&&(ye=new Pt(I[0],I[1])),q._rotateAround(me,ye),ne._rotateAround(me,ye),ie._rotateAround(me,ye),ae._rotateAround(me,ye),z=Math.min(q.x,ne.x,ie.x,ae.x),H=Math.max(q.x,ne.x,ie.x,ae.x),D=Math.min(q.y,ne.y,ie.y,ae.y),F=Math.max(q.y,ne.y,ie.y,ae.y)}return c.emplaceBack(a.x,a.y,a.z,l.x,l.y,z,D,H,F,T,f,p,_),c.length-1}function Xk(c){Cz(c)&&c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function Ane(c,a,l,f){const p=c.compareText;if(a in p){const _=p[a];for(let y=_.length-1;y>=0;y--)if(f.dist(_[y])<l)return!0}else p[a]=[];return p[a].push(f),!1}function Kz(c,a){const l=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,p=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),_=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-c._pitch-l,.01));let y=Math.sin(c._pitch)*_+p;const T=p*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let A=Math.max(c.zoom-17,0);c.isOrthographic&&(A/=10),y*=1+A}return Math.min(1.01*y,T)}function p1(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const l=Math.pow(2,-c.z),f=c.x*l,p=(c.x+1)*l,_=c.y*l,y=(c.y+1)*l,T=Fe(f),A=Fe(p),I=Re(_),D=Re(y),F=a.project(T,I),z=a.project(A,I),H=a.project(A,D),q=a.project(T,D);let ne=Math.min(F.x,z.x,H.x,q.x),ie=Math.min(F.y,z.y,H.y,q.y),ae=Math.max(F.x,z.x,H.x,q.x),me=Math.max(F.y,z.y,H.y,q.y);const ye=l/16;function we(ze,Ve,Ze,Ye,Ct,nt){const kt=(Ze+Ct)/2,zt=(Ye+nt)/2,Ot=a.project(Fe(kt),Re(zt)),Lt=Math.max(0,ne-Ot.x,ie-Ot.y,Ot.x-ae,Ot.y-me);ne=Math.min(ne,Ot.x),ae=Math.max(ae,Ot.x),ie=Math.min(ie,Ot.y),me=Math.max(me,Ot.y),Lt>ye&&(we(ze,Ot,Ze,Ye,kt,zt),we(Ot,Ve,kt,zt,Ct,nt))}we(F,z,f,_,p,_),we(z,H,p,_,p,y),we(H,q,p,y,f,y),we(q,F,f,y,f,_),ne-=ye,ie-=ye,ae+=ye,me+=ye;const Be=1/Math.max(ae-ne,me-ie);return{scale:Be,x:ne*Be,y:ie*Be,x2:ae*Be,y2:me*Be,projection:a}}function Jz(c,{x:a,y:l},f=0){return new Pt(((a-f)*c.scale-c.x)*Zt,(l*c.scale-c.y)*Zt)}const Cne=R(new Float32Array(16));class Md{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,l){return{x:0,y:0,z:0}}unproject(a,l){return new te(0,0)}projectTilePoint(a,l,f){return{x:a,y:l,z:0}}locationPoint(a,l,f,p=!0){return a._coordinatePoint(a.locationCoordinate(l,f),p)}pixelsPerMeter(a,l){return Me(1,a)*l}pixelSpaceConversion(a,l,f){return 1}farthestPixelDistance(a){return Kz(a,a.pixelsPerMeter)}pointCoordinate(a,l,f,p){const _=a.horizonLineFromTop(!1),y=new Pt(l,Math.max(_,f));return a.rayIntersectionCoordinate(a.pointRayIntersection(y,p))}pointCoordinate3D(a,l,f){const p=new Pt(l,f);if(a.elevation)return a.elevation.pointCoordinate(p);{const _=this.pointCoordinate(a,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(a,l){if(a.elevation&&a.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(a,l.x,l.y);const f=a.horizonLineFromTop();return l.y<f}createInversionMatrix(a,l){return Cne}createTileMatrix(a,l,f){let p,_,y;const T=f.canonical,A=R(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=p1(T,this);p=1,_=I.x+f.wrap*I.scale,y=I.y,U(A,A,[p/I.scale,p/I.scale,a.pixelsPerMeter/l])}else p=l/a.zoomScale(T.z),_=(T.x+Math.pow(2,T.z)*f.wrap)*p,y=T.y*p;return G(A,A,[_,y,0]),U(A,A,[p/Zt,p/Zt,1]),A}upVector(a,l,f){return[0,0,1]}upVectorScale(a,l,f){return{metersToTile:1}}}class Pne extends Md{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[l,f]=this.parallels=a.parallels||[29.5,45.5],p=Math.sin(Qe(l));this.n=(p+Math.sin(Qe(f)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(a,l){const{n:f,c:p,r0:_}=this,y=Qe(a-this.center[0]),T=Qe(l),A=Math.sqrt(p-2*f*Math.sin(T))/f;return{x:A*Math.sin(y*f),y:A*Math.cos(y*f)-_,z:0}}unproject(a,l){const{n:f,c:p,r0:_}=this,y=_+l;let T=Math.atan2(a,Math.abs(y))*Math.sign(y);y*f<0&&(T-=Math.PI*Math.sign(a)*Math.sign(y));const A=Qe(this.center[0])*f;T=le(T,-Math.PI-A,Math.PI-A);const I=Q(se(T/f)+this.center[0],-180,180),D=Math.asin(Q((p-(a*a+y*y)*f*f)/(2*f),-1,1)),F=Q(se(D),-Le,Le);return new te(I,F)}}const m1=1.340264,g1=-.081106,_1=893e-6,y1=.003796,rS=Math.sqrt(3)/2;class Ine extends Md{project(a,l){l=l/180*Math.PI,a=a/180*Math.PI;const f=Math.asin(rS*Math.sin(l)),p=f*f,_=p*p*p;return{x:.5*(a*Math.cos(f)/(rS*(m1+3*g1*p+_*(7*_1+9*y1*p)))/Math.PI+.5),y:1-.5*(f*(m1+g1*p+_*(_1+y1*p))/Math.PI+1),z:0}}unproject(a,l){a=(2*a-.5)*Math.PI;let f=l=(2*(1-l)-1)*Math.PI,p=f*f,_=p*p*p;for(let D,F,z,H=0;H<12&&(F=f*(m1+g1*p+_*(_1+y1*p))-l,z=m1+3*g1*p+_*(7*_1+9*y1*p),D=F/z,f=Q(f-D,-Math.PI/3,Math.PI/3),p=f*f,_=p*p*p,!(Math.abs(D)<1e-12));++H);const y=rS*a*(m1+3*g1*p+_*(7*_1+9*y1*p))/Math.cos(f),T=Math.asin(Math.sin(f)/rS),A=Q(180*y/Math.PI,-180,180),I=Q(180*T/Math.PI,-Le,Le);return new te(A,I)}}class kne extends Md{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,l){return{x:.5+a/360,y:.5-l/360,z:0}}unproject(a,l){const f=360*(a-.5),p=Q(360*(.5-l),-Le,Le);return new te(f,p)}}const g_=Math.PI/2;function nS(c){return Math.tan((g_+c)/2)}class One extends Md{constructor(a){super(a),this.center=a.center||[0,30];const[l,f]=this.parallels=a.parallels||[30,30];let p=Qe(l),_=Qe(f);this.southernCenter=p+_<0,this.southernCenter&&(p=-p,_=-_);const y=Math.cos(p),T=nS(p);this.n=p===_?Math.sin(p):Math.log(y/Math.cos(_))/Math.log(nS(_)/T),this.f=y*Math.pow(nS(p),this.n)/this.n}project(a,l){l=Qe(l),this.southernCenter&&(l=-l),a=Qe(a-this.center[0]);const f=1e-6,{n:p,f:_}=this;_>0?l<-g_+f&&(l=-g_+f):l>g_-f&&(l=g_-f);const y=_/Math.pow(nS(l),p);let T=y*Math.sin(p*a),A=_-y*Math.cos(p*a);return T=.5*(T/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:T,y:this.southernCenter?A:1-A,z:0}}unproject(a,l){a=(2*a-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:f,f:p}=this,_=p-l,y=Math.sign(_),T=Math.sign(f)*Math.sqrt(a*a+_*_);let A=Math.atan2(a,Math.abs(_))*y;_*f<0&&(A-=Math.PI*Math.sign(a)*y);const I=Q(se(A/f)+this.center[0],-180,180),D=Q(se(2*Math.atan(Math.pow(p/T,1/f))-g_),-Le,Le);return new te(I,this.southernCenter?-D:D)}}class Qz extends Md{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,l){return{x:Ee(a),y:De(l),z:0}}unproject(a,l){const f=Fe(a),p=Re(l);return new te(f,p)}}const e5=Qe(Le);class Mne extends Md{project(a,l){const f=(l=Qe(l))*l,p=f*f;return{x:.5*((a=Qe(a))*(.8707-.131979*f+p*(p*(.003971*f-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+f*(.015085+p*(.028874*f-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(a,l){a=(2*a-.5)*Math.PI;let f=l=(2*(1-l)-1)*Math.PI,p=25,_=0,y=f*f;do{y=f*f;const I=y*y;_=(f*(1.007226+y*(.015085+I*(.028874*y-.044475-.005916*I)))-l)/(1.007226+y*(.045255+I*(.259866*y-.311325-.005916*11*I))),f=Q(f-_,-e5,e5)}while(Math.abs(_)>1e-6&&--p>0);y=f*f;const T=Q(se(a/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),A=se(f);return new te(T,A)}}const t5=Qe(Le);class Rne extends Md{project(a,l){l=Qe(l),a=Qe(a);const f=Math.cos(l),p=2/Math.PI,_=Math.acos(f*Math.cos(a/2)),y=Math.sin(_)/_,T=.5*(a*p+2*f*Math.sin(a/2)/y)||0,A=.5*(l+Math.sin(l)/y)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(a,l){let f=a=(2*a-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,_=25;const y=1e-6;let T=0,A=0;do{const I=Math.cos(p),D=Math.sin(p),F=2*D*I,z=D*D,H=I*I,q=Math.cos(f/2),ne=Math.sin(f/2),ie=2*q*ne,ae=ne*ne,me=1-H*q*q,ye=me?1/me:0,we=me?Math.acos(I*q)*Math.sqrt(1/me):0,Be=.5*(2*we*I*ne+2*f/Math.PI)-a,ze=.5*(we*D+p)-l,Ve=.5*ye*(H*ae+we*I*q*z)+1/Math.PI,Ze=ye*(ie*F/4-we*D*ne),Ye=.125*ye*(F*ne-we*D*H*ie),Ct=.5*ye*(z*q+we*ae*I)+.5,nt=Ze*Ye-Ct*Ve;T=(ze*Ze-Be*Ct)/nt,A=(Be*Ye-ze*Ve)/nt,f=Q(f-T,-Math.PI,Math.PI),p=Q(p-A,-t5,t5)}while((Math.abs(T)>y||Math.abs(A)>y)&&--_>0);return new te(se(f),se(p))}}class r5 extends Md{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Qe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,l){const{scale:f,cosPhi:p}=this;return{x:Qe(a)*p*f+.5,y:-Math.sin(Qe(l))/p*f+.5,z:0}}unproject(a,l){const{scale:f,cosPhi:p}=this,_=-(l-.5)/f,y=Q(se((a-.5)/f)/p,-180,180),T=Math.asin(Q(_*p,-1,1)),A=Q(se(T),-Le,Le);return new te(y,A)}}class Dne extends Qz{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,l,f){const p=Vx(a,l,f);return Mt(p,p,MT(Ju(f))),{x:p[0],y:p[1],z:p[2]}}locationPoint(a,l,f){const p=W(l.lat,l.lng),_=yt([],p),y=f?a._centerAltitude+f:a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(l),a._centerAltitude):a._centerAltitude;_e(p,p,_,Me(1,0)*Zt*y);const T=R(new Float64Array(16));return V(T,a.pixelMatrix,a.globeMatrix),Mt(p,p,T),new Pt(p[0],p[1])}pixelsPerMeter(a,l){return Me(1,0)*l}pixelSpaceConversion(a,l,f){const p=Me(1,a)*l,_=Ir(Me(1,45)*l,p,f);return this.pixelsPerMeter(a,l)/_}createTileMatrix(a,l,f){const p=rk(Ju(f.canonical));return V(new Float64Array(16),a.globeMatrix,p)}createInversionMatrix(a,l){const{center:f}=a,p=MT(Ju(l));return Z(p,p,Qe(f.lng)),J(p,p,Qe(f.lat)),U(p,p,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(a,l,f,p){return AN(a,l,f,!0)||new _t(0,0)}pointCoordinate3D(a,l,f){const p=this.pointCoordinate(a,l,f,0);return[p.x,p.y,p.z]}isPointAboveHorizon(a,l){return!AN(a,l.x,l.y,!1)}farthestPixelDistance(a){const l=function(p,_){const y=p.cameraToCenterDistance,T=p._centerAltitude*_,A=p._camera,I=p._camera.forward(),D=at([],Rt([],I,-y),[0,0,T]),F=p.worldSize/(2*Math.PI),z=[0,0,-F],H=p.width/p.height,q=Math.tan(p.fovAboveCenter),ne=Rt([],A.up(),q),ie=Rt([],A.right(),q*H),ae=yt([],at([],at([],I,ne),ie)),me=[];let ye;if(new wn(D,ae).closestPointOnSphere(z,F,me)){const we=at([],me,z),Be=Br([],we,D);ye=Math.cos(p.fovAboveCenter)*tt(Be)}else{const we=Br([],D,z),Be=Br([],z,D);yt(Be,Be);const ze=tt(we)-F;ye=Math.sqrt(ze*(ze+2*F));const Ve=Math.acos(ye/(F+ze))-Math.acos(Dt(I,Be));ye*=Math.cos(Ve)}return 1.01*ye}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),f=Ad(a.zoom);if(f>0){const p=Kz(a,Me(1,a.center.lat)*a.worldSize),_=a.worldSize/(2*Math.PI),y=Math.max(a.width,a.height)/a.worldSize*Math.PI;return Ir(l,p+_*(1-Math.cos(y)),Math.pow(f,10))}return l}upVector(a,l,f){return Vx(l,f,a,1)}upVectorScale(a){return{metersToTile:IT(OT(Ju(a)))}}}function n5(c){const a=c.parallels,l=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new Qz(c);case"equirectangular":return new kne(c);case"naturalEarth":return new Mne(c);case"equalEarth":return new Ine(c);case"winkelTripel":return new Rne(c);case"albers":return l?new r5(c):new Pne(c);case"lambertConformalConic":return l?new r5(c):new One(c);case"globe":return new Dne(c)}throw new Error(`Invalid projection name: ${c.name}`)}const Fne=Bt.types,Lne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function iS(c,a,l,f,p,_,y,T,A,I,D,F,z){const H=T?Math.min(Od,Math.round(T[0])):0,q=T?Math.min(Od,Math.round(T[1])):0;c.emplaceBack(a,l,Math.round(32*f),Math.round(32*p),_,y,(H<<1)+(A?1:0),q,16*I,16*D,256*F,256*z)}function aS(c,a,l){c.emplaceBack(a,l)}function oS(c,a,l,f,p,_,y){c.emplaceBack(a,l,f,p,_,y)}const sS=(c,a,l,f)=>{for(let p=0;p<a;p++)c.emplaceBack(l[0],l[1],l[2],f[0],f[1],f[2])};function lS(c,a,l,f,p){c.emplaceBack(a,l,f,p),c.emplaceBack(a,l,f,p),c.emplaceBack(a,l,f,p),c.emplaceBack(a,l,f,p)}function Nne(c){for(const a of c.sections)if(VI(a.text))return!0;return!1}class Zk{constructor(a){this.layoutVertexArray=new Mx,this.indexArray=new Ta,this.programConfigurations=a,this.segments=new Ti,this.dynamicLayoutVertexArray=new kl,this.opacityVertexArray=new xd,this.placedSymbolArray=new e_,this.iconTransitioningVertexArray=new ma,this.globeExtVertexArray=new Rx,this.zOffsetVertexArray=new qu,this.orientationVertexArray=new _m}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(a,l,f,p,_){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,$re.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Wre.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,Lne,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=a.createVertexBuffer(this.iconTransitioningVertexArray,qre.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,Vre.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||_)&&(this.zOffsetVertexBuffer=a.createVertexBuffer(this.zOffsetVertexArray,Gre.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=a.createVertexBuffer(this.orientationVertexArray,Hre.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||p)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}sr(Zk,"SymbolBuffers");class Yk{constructor(a,l,f){this.layoutVertexArray=new a,this.layoutAttributes=l,this.indexArray=new f,this.segments=new Ti,this.collisionVertexArray=new Fx,this.collisionVertexArrayExt=new kl}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Xre.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,Zre.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}sr(Yk,"CollisionBuffers");class cS{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(y=>y.fqid),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=R([]),this.placementViewportMatrix=R([]);const l=this.layers[0]._unevaluatedLayout._values;this.worldview=a.worldview,this.textSizeData=Mz(this.zoom,l["text-size"],this.worldview),this.iconSizeData=Mz(this.zoom,l["icon-size"],this.worldview);const f=this.layers[0].layout,p=f.get("symbol-sort-key"),_=f.get("symbol-z-order");this.lut=a.lut,this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(y=>qs[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=a.sourceID,this.projection=a.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new Zk(new Ol(this.layers,{zoom:this.zoom,lut:this.lut},a=>a.startsWith("text")||a.startsWith("symbol"))),this.icon=new Zk(new Ol(this.layers,{zoom:this.zoom,lut:this.lut},a=>a.startsWith("icon")||a.startsWith("symbol"))),this.glyphOffsetArray=new xT,this.lineVertexArray=new wT,this.symbolInstances=new vT}calculateGlyphDependencies(a,l,f,p,_){for(const y of a){const T=y.codePointAt(0);if(T===void 0)break;if(l[T]=!0,p&&_&&T<=65535){const A=l1[y];A&&(l[A.charCodeAt(0)]=!0)}}}updateFootprints(a,l){}updateReplacement(a,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const f=l.getReplacementRegionsForTile(a.toUnwrapped(),!0);return!BT(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(a,l,f,p){const _=this.layers[0],y=_.layout,T=this.projection.name==="globe",A=y.get("text-font"),I=y.get("text-field"),D=y.get("icon-image"),[F,z]=y.get("icon-size-scale-range"),H=Q(l.scaleFactor||1,F,z),q=(I.value.kind!=="constant"||I.value.value instanceof jo&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),ne=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,ie=y.get("symbol-sort-key");if(this.features=[],!q&&!ne)return;const ae=l.iconDependencies,me=l.glyphDependencies,ye=l.availableImages,we=new Kn(this.zoom,{worldview:this.worldview});for(const{feature:Be,id:ze,index:Ve,sourceLayerIndex:Ze}of a){const Ye=_._featureFilter.needGeometry,Ct=Ut(Be,Ye);if(!_._featureFilter.filter(we,Ct,f))continue;if(Ye||(Ct.geometry=tr(Be,f,p)),T&&Be.type!==1&&f.z<=5){const Lt=Ct.geometry,$t=.98078528056,Et=(Nt,gt)=>Dt(Vx(Nt.x,Nt.y,f,1),Vx(gt.x,gt.y,f,1))<$t;for(let Nt=0;Nt<Lt.length;Nt++)Lt[Nt]=Tt(Lt[Nt],Et)}let nt,kt;if(q){const Lt=_.getValueAndResolveTokens("text-field",Ct,f,ye),$t=jo.factory(Lt);Nne($t)&&(this.hasRTLText=!0),(!this.hasRTLText||Ug()==="unavailable"||this.hasRTLText&&ac.isParsed())&&(nt=Kre($t,_,Ct))}if(ne){const Lt=_.getValueAndResolveTokens("icon-image",Ct,f,ye);kt=typeof Lt=="string"?ts.build(Lt):Lt}if(!nt&&!kt)continue;const zt=this.sortFeaturesByKey?ie.evaluate(Ct,{},f):void 0,Ot={id:ze,text:nt,icon:kt,index:Ve,sourceLayerIndex:Ze,geometry:Ct.geometry,properties:Be.properties,type:Fne[Be.type],sortKey:zt};if(this.features.push(Ot),kt){const Lt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:$t,iconSecondary:Et}=qz(kt,this.iconSizeData,Lt["icon-size"],f,this.zoom,Ot,this.pixelRatio,H,this.worldview),Nt=$t.id.toString();if(ae.has(Nt)?ae.get(Nt).push($t):ae.set(Nt,[$t]),Et){this.hasAnySecondaryIcon=!0;const gt=Et.id.toString();ae.has(gt)?ae.get(gt).push(Et):ae.set(gt,[Et])}}if(nt){const Lt=A.evaluate(Ct,{},f).join(","),$t=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qs.vertical)>=0;for(const Et of nt.sections)if(Et.image){const Nt=Et.image.getPrimary().scaleSelf(this.pixelRatio),gt=Nt.id.toString(),ut=ae.get(gt)||[];ut.push(Nt),ae.set(gt,ut)}else{const Nt=bx(nt.toString()),gt=Et.fontStack||Lt,ut=me[gt]=me[gt]||{};this.calculateGlyphDependencies(Et.text,ut,$t,this.allowVerticalPlacement,Nt)}}}if(y.get("symbol-placement")==="line"&&(this.features=function(Be){const ze={},Ve={},Ze=[];let Ye=0;function Ct(Ot){Ze.push(Be[Ot]),Ye++}function nt(Ot,Lt,$t){const Et=Ve[Ot];return delete Ve[Ot],Ve[Lt]=Et,Ze[Et].geometry[0].pop(),Ze[Et].geometry[0]=Ze[Et].geometry[0].concat($t[0]),Et}function kt(Ot,Lt,$t){const Et=ze[Lt];return delete ze[Lt],ze[Ot]=Et,Ze[Et].geometry[0].shift(),Ze[Et].geometry[0]=$t[0].concat(Ze[Et].geometry[0]),Et}function zt(Ot,Lt,$t){const Et=$t?Lt[0][Lt[0].length-1]:Lt[0][0];return`${Ot}:${Et.x}:${Et.y}`}for(let Ot=0;Ot<Be.length;Ot++){const Lt=Be[Ot],$t=Lt.geometry,Et=Lt.text?Lt.text.toString():null;if(!Et){Ct(Ot);continue}const Nt=zt(Et,$t),gt=zt(Et,$t,!0);if(Nt in Ve&&gt in ze&&Ve[Nt]!==ze[gt]){const ut=kt(Nt,gt,$t),Vt=nt(Nt,gt,Ze[ut].geometry);delete ze[Nt],delete Ve[gt],Ve[zt(Et,Ze[Vt].geometry,!0)]=Vt,Ze[ut].geometry=null}else Nt in Ve?nt(Nt,gt,$t):gt in ze?kt(Nt,gt,$t):(Ct(Ot),ze[Nt]=Ye-1,Ve[gt]=Ye-1)}return Ze.filter(Ot=>Ot.geometry)}(this.features)),y.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Be of l.elevationFeatures)this.elevationFeatureIdToIndex.set(Be.id,this.elevationFeatures.length),this.elevationFeatures.push(Be)}}else y.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Be,ze)=>Be.sortKey-ze.sortKey)}update(a,l,f,p,_,y,T){this.text.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,this.worldview),this.icon.programConfigurations.updatePaintArrays(a,l,_,f,p,y,T,this.worldview)}updateRoadElevation(a){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let l=!1;const f=st(a),p=1/f;let _=!1,y=!1;for(let T=0;T<this.symbolInstances.length;T++){const A=this.symbolInstances.get(T),I=Je(1,0,0),D=Je(0,1,0),{numHorizontalGlyphVertices:F,numVerticalGlyphVertices:z,numIconVertices:H,numVerticalIconVertices:q}=A,ne=F>0||z>0,ie=H>0,ae=this.elevationFeatures[A.elevationFeatureIndex];if(ae){const me=new Pt(A.tileAnchorX,A.tileAnchorY),ye=.075+ae.pointElevation(me);A.zOffset!==ye&&(l=!0,A.zOffset=ye);const we=ae.computeSlopeNormal(me,p),Be=_n(ta(),Je(0,0,1),we);Ne(I,I,Be),Ne(D,D,Be),I[2]*=f,D[2]*=f,I[0]===1&&I[1]===0&&I[2]===0&&D[0]===0&&D[1]===1&&D[2]===0||(_=_||ne,y=y||ie)}if(ne&&(sS(this.text.orientationVertexArray,F,I,D),sS(this.text.orientationVertexArray,z,I,D)),ie){const{placedIconSymbolIndex:me,verticalPlacedIconSymbolIndex:ye}=A;me>=0&&sS(this.icon.orientationVertexArray,H,I,D),ye>=0&&sS(this.icon.orientationVertexArray,q,I,D)}}_||(this.text.orientationVertexArray=void 0),y||(this.icon.orientationVertexArray=void 0),l&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const a=(_,y,T)=>{f+=y,f>_.length&&_.resize(f);for(let A=-y;A<0;A++)_.emplace(A+f,T)},l=(_,y,T)=>{p+=y,p>_.length&&_.resize(p);for(let A=-y;A<0;A++)_.emplace(A+p,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,p=0;for(let _=0;_<this.symbolInstances.length;_++){const y=this.symbolInstances.get(_),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:A,numIconVertices:I}=y,D=y.zOffset,F=I>0;if((T>0||A>0)&&(a(this.text.zOffsetVertexArray,T,D),a(this.text.zOffsetVertexArray,A,D)),F){const{placedIconSymbolIndex:z,verticalPlacedIconSymbolIndex:H}=y;z>=0&&l(this.icon.zOffsetVertexArray,I,D),H>=0&&l(this.icon.zOffsetVertexArray,y.numVerticalIconVertices,D)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=n5(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,l){const f=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x:p,y:_}of l)this.lineVertexArray.emplaceBack(p,_);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne,ie){const ae=a.indexArray,me=a.layoutVertexArray,ye=a.globeExtVertexArray,we=a.segments.prepareSegment(4*l.length,me,ae,this.canOverlap?y.sortKey:void 0),Be=this.glyphOffsetArray.length,ze=we.vertexLength,Ve=this.allowVerticalPlacement&&T===qs.vertical?Math.PI/2:0,Ze=y.text&&y.text.sections;for(let Ct=0;Ct<l.length;Ct++){const{tl:nt,tr:kt,bl:zt,br:Ot,texPrimary:Lt,texSecondary:$t,pixelOffsetTL:Et,pixelOffsetBR:Nt,minFontScaleX:gt,minFontScaleY:ut,glyphOffset:Vt,isSDF:jt,sectionIndex:br}=l[Ct],ir=we.vertexLength,dr=Vt[1];if(iS(me,I.x,I.y,nt.x,dr+nt.y,Lt.x,Lt.y,f,jt,Et.x,Et.y,gt,ut),iS(me,I.x,I.y,kt.x,dr+kt.y,Lt.x+Lt.w,Lt.y,f,jt,Nt.x,Et.y,gt,ut),iS(me,I.x,I.y,zt.x,dr+zt.y,Lt.x,Lt.y+Lt.h,f,jt,Et.x,Nt.y,gt,ut),iS(me,I.x,I.y,Ot.x,dr+Ot.y,Lt.x+Lt.w,Lt.y+Lt.h,f,jt,Nt.x,Nt.y,gt,ut),A){const{x:qt,y:xr,z:jr}=A.anchor,[Qt,gr,Or]=A.up;oS(ye,qt,xr,jr,Qt,gr,Or),oS(ye,qt,xr,jr,Qt,gr,Or),oS(ye,qt,xr,jr,Qt,gr,Or),oS(ye,qt,xr,jr,Qt,gr,Or),lS(a.dynamicLayoutVertexArray,qt,xr,jr,Ve)}else lS(a.dynamicLayoutVertexArray,I.x,I.y,I.z,Ve);if(ie){const qt=$t||Lt;aS(a.iconTransitioningVertexArray,qt.x,qt.y),aS(a.iconTransitioningVertexArray,qt.x+qt.w,qt.y),aS(a.iconTransitioningVertexArray,qt.x,qt.y+qt.h),aS(a.iconTransitioningVertexArray,qt.x+qt.w,qt.y+qt.h)}ae.emplaceBack(ir,ir+1,ir+2),ae.emplaceBack(ir+1,ir+2,ir+3),we.vertexLength+=4,we.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vt[0]),Ct!==l.length-1&&br===l[Ct+1].sectionIndex||a.programConfigurations.populatePaintArrays(me.length,y,y.index,{},H,q,ne,Ze&&Ze[br],this.worldview)}const Ye=A?A.anchor:I;a.placedSymbolArray.emplaceBack(Ye.x,Ye.y,Ye.z,I.x,I.y,Be,this.glyphOffsetArray.length-Be,ze,D,F,I.segment,f?f[0]:0,f?f[1]:0,p[0],p[1],T,0,0,0,z,0)}_commitLayoutVertex(a,l,f,p,_,y,T){a.emplaceBack(l,f,p,_,y,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(a,l,f,p,_,y,T){const A=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),I=A.vertexLength,D=T.tileAnchorX,F=T.tileAnchorY;for(let H=0;H<4;H++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,l,a.padding,T.zOffset),this._commitLayoutVertex(f.layoutVertexArray,p,_,y,D,F,new Pt(a.x1,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,_,y,D,F,new Pt(a.x2,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,_,y,D,F,new Pt(a.x2,a.y2)),this._commitLayoutVertex(f.layoutVertexArray,p,_,y,D,F,new Pt(a.x1,a.y2)),A.vertexLength+=4;const z=f.indexArray;z.emplaceBack(I,I+1),z.emplaceBack(I+1,I+2),z.emplaceBack(I+2,I+3),z.emplaceBack(I+3,I),A.primitiveLength+=4}_addTextDebugCollisionBoxes(a,l,f,p,_,y){for(let T=p;T<_;T++){const A=f.get(T),I=this.getSymbolInstanceTextSize(a,y,l,T);this._addCollisionDebugVertices(A,I,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(a,l,f,p,_,y){for(let T=p;T<_;T++){const A=f.get(T),I=this.getSymbolInstanceIconSize(a,l,y.placedIconSymbolIndex);this._addCollisionDebugVertices(A,I,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,y)}}generateCollisionDebugBuffers(a,l,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Yk(Zg,_z.members,ma),this.iconCollisionBox=new Yk(Zg,_z.members,ma);const p=u1(this.iconSizeData,a),_=u1(this.textSizeData,a,f);for(let y=0;y<this.symbolInstances.length;y++){const T=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(_,a,l,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(_,a,l,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,a,l,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,a,l,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(a,l,f,p){const _=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),y=$k(this.textSizeData,a,_)/Xa;return this.tilePixelRatio*y}getSymbolInstanceIconSize(a,l,f){const p=this.icon.placedSymbolArray.get(f),_=$k(this.iconSizeData,a,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(a,l,f,p){a.emplaceBack(l,-f,-f,p),a.emplaceBack(l,f,-f,p),a.emplaceBack(l,f,f,p),a.emplaceBack(l,-f,f,p)}_updateTextDebugCollisionBoxes(a,l,f,p,_,y,T){for(let A=p;A<_;A++){const I=f.get(A),D=this.getSymbolInstanceTextSize(a,y,l,A);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,I.padding,y.zOffset)}}_updateIconDebugCollisionBoxes(a,l,f,p,_,y,T){for(let A=p;A<_;A++){const I=f.get(A),D=this.getSymbolInstanceIconSize(a,l,y.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,I.padding,y.zOffset)}}updateCollisionDebugBuffers(a,l,f,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=u1(this.iconSizeData,a,p),y=u1(this.textSizeData,a,f);for(let T=0;T<this.symbolInstances.length;T++){const A=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(y,a,l,A.textBoxStartIndex,A.textBoxEndIndex,A,f),this._updateTextDebugCollisionBoxes(y,a,l,A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A,f),this._updateIconDebugCollisionBoxes(_,a,l,A.iconBoxStartIndex,A.iconBoxEndIndex,A,p),this._updateIconDebugCollisionBoxes(_,a,l,A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex,A,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,l,f,p,_,y,T,A,I){const D={};if(l<f){const{x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we,featureIndex:Be}=a.get(l);D.textBox={x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we},D.textFeatureIndex=Be}if(p<_){const{x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we,featureIndex:Be}=a.get(p);D.verticalTextBox={x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we},D.verticalTextFeatureIndex=Be}if(y<T){const{x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we,featureIndex:Be}=a.get(y);D.iconBox={x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we},D.iconFeatureIndex=Be}if(A<I){const{x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we,featureIndex:Be}=a.get(A);D.verticalIconBox={x1:F,y1:z,x2:H,y2:q,padding:ne,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:ye,tileAnchorY:we},D.verticalIconFeatureIndex=Be}return D}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(a,l){const f=a.placedSymbolArray.get(l),p=f.vertexStartIndex+4*f.numGlyphs;for(let _=f.vertexStartIndex;_<p;_+=4)a.indexArray.emplaceBack(_,_+1,_+2),a.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(a),f=Math.cos(a),p=[],_=[],y=[];for(let T=0;T<this.symbolInstances.length;++T){y.push(T);const A=this.symbolInstances.get(T);p.push(0|Math.round(l*A.tileAnchorX+f*A.tileAnchorY)),_.push(A.featureIndex)}return y.sort((T,A)=>p[T]-p[A]||_[A]-_[T]),y}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let a=0;a<this.symbolInstances.length;++a)this.symbolInstanceIndexesSortedZOffset.push(a)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((a,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(a).zOffset)}addToSortKeyRanges(a,l){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===l?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const f=this.symbolInstances.get(l);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:I}=f;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),y>=0&&y!==_&&y!==p&&this.addIndicesForPlacedSymbol(this.text,y),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let i5,a5,Kk;sr(cS,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),cS.addDynamicAttributes=lS;class o5{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:rc,this.defaultValue=a}evaluate(a){if(a.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(a.formattedSection))return l.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sr(o5,"FormatSectionOverride",{omit:["defaultValue"]});const Jk=()=>Kk||(Kk={layout:i5||(i5=new Ii({"symbol-placement":new Wt(rt.layout_symbol["symbol-placement"]),"symbol-spacing":new Wt(rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wt(rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new er(rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wt(rt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Wt(rt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Wt(rt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Wt(rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Wt(rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wt(rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wt(rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new er(rt.layout_symbol["icon-size"]),"icon-size-scale-range":new Wt(rt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new er(rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new er(rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new er(rt.layout_symbol["icon-image"]),"icon-image-use-theme":new Wt({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new er(rt.layout_symbol["icon-rotate"]),"icon-padding":new Wt(rt.layout_symbol["icon-padding"]),"icon-keep-upright":new Wt(rt.layout_symbol["icon-keep-upright"]),"icon-offset":new er(rt.layout_symbol["icon-offset"]),"icon-anchor":new er(rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wt(rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wt(rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wt(rt.layout_symbol["text-rotation-alignment"]),"text-field":new er(rt.layout_symbol["text-field"]),"text-font":new er(rt.layout_symbol["text-font"]),"text-size":new er(rt.layout_symbol["text-size"]),"text-size-scale-range":new Wt(rt.layout_symbol["text-size-scale-range"]),"text-max-width":new er(rt.layout_symbol["text-max-width"]),"text-line-height":new er(rt.layout_symbol["text-line-height"]),"text-letter-spacing":new er(rt.layout_symbol["text-letter-spacing"]),"text-justify":new er(rt.layout_symbol["text-justify"]),"text-radial-offset":new er(rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wt(rt.layout_symbol["text-variable-anchor"]),"text-anchor":new er(rt.layout_symbol["text-anchor"]),"text-max-angle":new Wt(rt.layout_symbol["text-max-angle"]),"text-writing-mode":new Wt(rt.layout_symbol["text-writing-mode"]),"text-rotate":new er(rt.layout_symbol["text-rotate"]),"text-padding":new Wt(rt.layout_symbol["text-padding"]),"text-keep-upright":new Wt(rt.layout_symbol["text-keep-upright"]),"text-transform":new er(rt.layout_symbol["text-transform"]),"text-offset":new er(rt.layout_symbol["text-offset"]),"text-allow-overlap":new Wt(rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Wt(rt.layout_symbol["text-ignore-placement"]),"text-optional":new Wt(rt.layout_symbol["text-optional"]),visibility:new Wt(rt.layout_symbol.visibility)})),paint:a5||(a5=new Ii({"icon-opacity":new er(rt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new er(rt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new er(rt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new er(rt.paint_symbol["text-emissive-strength"]),"icon-color":new er(rt.paint_symbol["icon-color"]),"icon-halo-color":new er(rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new er(rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new er(rt.paint_symbol["icon-halo-blur"]),"icon-translate":new Wt(rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wt(rt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Wt(rt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new er(rt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new er(rt.paint_symbol["text-occlusion-opacity"]),"text-color":new er(rt.paint_symbol["text-color"],{runtimeType:fs,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new er(rt.paint_symbol["text-halo-color"]),"text-halo-width":new er(rt.paint_symbol["text-halo-width"]),"text-halo-blur":new er(rt.paint_symbol["text-halo-blur"]),"text-translate":new Wt(rt.paint_symbol["text-translate"]),"text-translate-anchor":new Wt(rt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Wt(rt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Wt(rt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Wt(rt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Wt(rt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new er(rt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},Kk);class uS extends Po{constructor(a,l,f,p){super(a,Jk(),l,f,p,a.layout?a.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=R([]),this.hasOcclusionOpacityProperties=a.paint!==void 0&&("icon-occlusion-opacity"in a.paint||"text-occlusion-opacity"in a.paint)}_handleSpecialPaintPropertyUpdate(a){a!=="icon-occlusion-opacity"&&a!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(a,l){super.recalculate(a,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const p=[];for(const _ of f)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(a,l,f,p){return this._saturation===a&&this._contrast===l&&this._brightnessMin===f&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(_,y,T,A){_=Eo(_),y=da(y);const I=L(),D=_/3,F=1-2*D,z=[F,D,D,0,D,F,D,0,D,D,F,0,0,0,0,1],H=.5-.5*y,q=A-T;return V(I,[q,0,0,0,0,q,0,0,0,0,q,0,T,T,T,1],[y,0,0,0,0,y,0,0,0,0,y,0,H,H,H,1]),V(I,I,z),I}(a,l,f,p),this._saturation=a,this._contrast=l,this._brightnessMin=f,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(a,l,f,p){const _=this.layout.get(a).evaluate(l,{},f,p),y=this._unevaluatedLayout._values[a];return y.isDataDriven()||vx(y.value)||!_?_:function(T,A){return A.replace(/{([^{}]+)}/g,(I,D)=>D in T?String(T[D]):"")}(l.properties,_)}createBucket(a){return new cS(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of Jk().paint.overridableProperties){if(!uS.hasPaintOverride(this.layout,a))continue;const l=this.paint.get(a),f=new o5(l),p=new Dg(f,l.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let _=null;_=l.value.kind==="constant"||l.value.kind==="source"?new fm("source",p):new Uu("composite",p,l.value.zoomStops,l.value.interpolationType),this.paint._values[a]=new Kh(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(a,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&uS.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,l){const f=a.get("text-field"),p=Jk().paint.properties[l];let _=!1;const y=T=>{for(const A of T)if(p.overrides&&p.overrides.hasOverride(A))return void(_=!0)};if(f.value.kind==="constant"&&f.value.value instanceof jo)y(f.value.value.sections);else if(f.value.kind==="source"){const T=I=>{_||(I instanceof Zr&&Fa(I.value)===Ru?y(I.value.sections):I instanceof Bh?y(I.sections):I.eachChild(T))},A=f.value;A._styleExpression&&T(A._styleExpression.expression)}return _}getProgramIds(){return["symbol"]}getDefaultProgramParams(a,l,f){return{config:new af(this,{zoom:l,lut:f}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let s5,l5,c5,u5;var Qk=fn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function hS(c,a,l,f,p,_,y,T){const A=[c,a,1,l,f,1,p,_,1],I=[y,T,1],D=k([],A),[F,z,H]=Sr(I,I,D);return O(A,A,[F,0,0,0,z,0,0,0,H])}function h5(c,a,l,f,p,_,y,T){const A=function(I,D,F,z,H,q,ne,ie){const ae=hS(0,0,1,0,1,1,0,1),me=hS(I,D,F,z,H,q,ne,ie);return O(me,me,k([],ae))}(c,a,l,f,p,_,y,T);return[A[2]/A[8]/Zt,A[5]/A[8]/Zt]}function fS(c){return[c[0],Math.min(Math.max(c[1],-Le),Le)]}class f5 extends Lh{constructor(a,l,f,p){super(),this.id=a,this.dispatcher=f,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(a,l){if(this._loaded=l||!1,this.fire(new El("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return a&&(this.coordinates=a),this._loaded=!0,void this._finishLoading();this._imageRequest=Kf(this.map._requestManager.transformRequest(this.url,Z0.Image),(f,p)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new Yp(f)):p&&(this.image=p instanceof HTMLImageElement?tc.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading())})}loaded(){return this._loaded}updateImage(a){return a.url?(this._imageRequest&&a.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}setTexture(a){if(!(a.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new a1(this.map.painter.context,a.handle),this.width=a.dimensions[0],this.height=a.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new El("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(a){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof a1||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(a){if(this.coordinates=a,this._boundsArray=void 0,this._unsupportedCoords=!1,!a.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=a[0][1],f=a[0][1];for(const _ of a)_[1]>f&&(f=_[1]),_[1]<l&&(l=_[1]);const p=(f+l)/2;if(p>Le?this.onNorthPole=!0:p<-Le&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const _=a.map(_t.fromLngLat);this.tileID=function(y){let T=1/0,A=1/0,I=-1/0,D=-1/0;for(const ne of y)T=Math.min(T,ne.x),A=Math.min(A,ne.y),I=Math.max(I,ne.x),D=Math.max(D,ne.y);const F=Math.max(I-T,D-A),z=Math.max(0,Math.floor(-Math.log2(F))),H=Math.pow(2,z);let q=Math.floor((T+I)/2*H);return q>1&&(q-=1),new Zc(z,q,Math.floor((A+D)/2*H))}(_),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new El("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof a1||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(a){for(const ae in this.tiles){const me=this.tiles[ae];me.state!=="loaded"&&(me.state="loaded",me.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=p1(new Zc(0,0,0),this.map.transform.projection),f=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ae){const me=ae[1].x-ae[0].x,ye=ae[1].y-ae[0].y,we=ae[2].x-ae[1].x,Be=ae[2].y-ae[1].y,ze=ae[3].x-ae[2].x,Ve=ae[3].y-ae[2].y,Ze=ae[0].x-ae[3].x,Ye=ae[0].y-ae[3].y,Ct=me*Be-we*ye,nt=we*Ve-ze*Be,kt=ze*Ye-Ze*Ve,zt=Ze*ye-me*Ye;return Ct>0&&nt>0&&kt>0&&zt>0||Ct<0&&nt<0&&kt<0&&zt<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=p1(this.tileID,this.map.transform.projection),[_,y,T,A]=this.coordinates.map(ae=>{const me=p.projection.project(ae[0],ae[1]);return Jz(p,me)._round()});this.perspectiveTransform=h5(_.x,_.y,y.x,y.y,T.x,T.y,A.x,A.y);const I=this._boundsArray=new tf;I.emplaceBack(_.x,_.y,0,0),I.emplaceBack(y.x,y.y,Zt,0),I.emplaceBack(A.x,A.y,0,Zt),I.emplaceBack(T.x,T.y,Zt,Zt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=a.createVertexBuffer(I,Qk.members),this.boundsSegments=Ti.simpleSegment(0,0,4,2);const D=[],F=[fS((z=this.coordinates)[0]),fS(z[1]),fS(z[2]),fS(z[3])];var z;const[H,q,ne,ie]=function(ae){let me=ae[0][0],ye=me,we=ae[0][1],Be=we;for(let ze=1;ze<ae.length;ze++)ae[ze][0]<me?me=ae[ze][0]:ae[ze][0]>ye&&(ye=ae[ze][0]),ae[ze][1]<we?we=ae[ze][1]:ae[ze][1]>Be&&(Be=ae[ze][1]);return[me,we,ye-me,Be-we]}(F);{const ae=new tf,[me,ye,we,Be]=function(Et){let Nt=Et[0].x,gt=Nt,ut=Et[0].y,Vt=ut;for(let jt=1;jt<Et.length;jt++)Et[jt].x<Nt?Nt=Et[jt].x:Et[jt].x>gt&&(gt=Et[jt].x),Et[jt].y<ut?ut=Et[jt].y:Et[jt].y>Vt&&(Vt=Et[jt].y);return[Nt,ut,gt-Nt,Vt-ut]}(f),ze=Et=>[(Et.x-me)/we,(Et.y-ye)/Be],[Ve,Ze,Ye,Ct]=f.map(ze),nt=function(Et,Nt,gt,ut,Vt,jt,br,ir){const dr=hS(0,0,1,0,1,1,0,1);return O(dr,dr,k([],hS(Et,Nt,gt,ut,Vt,jt,br,ir)))}(Ve[0],Ve[1],Ze[0],Ze[1],Ye[0],Ye[1],Ct[0],Ct[1]);this.elevatedGlobePerspectiveTransform=h5(Ve[0],Ve[1],Ze[0],Ze[1],Ye[0],Ye[1],Ct[0],Ct[1]);const kt=(Et,Nt)=>{D.push(Et.lng);const gt=Math.round((Et.lng-H)/ne*Zt),ut=Math.round((Et.lat-q)/ie*Zt),Vt=ze(Nt),jt=Sr([],[Vt[0],Vt[1],1],nt),br=Math.round(jt[0]/jt[2]*Zt),ir=Math.round(jt[1]/jt[2]*Zt);ae.emplaceBack(gt,ut,br,ir)},zt=f[3].x-f[0].x,Ot=f[3].y-f[0].y,Lt=f[2].x-f[1].x,$t=f[2].y-f[1].y;for(let Et=0;Et<65;Et++){const Nt=Et/64,gt=[f[0].x+Nt*zt,f[0].y+Nt*Ot],ut=[f[1].x+Nt*Lt,f[1].y+Nt*$t],Vt=ut[0]-gt[0],jt=ut[1]-gt[1];for(let br=0;br<65;br++){const ir=br/64,dr={x:gt[0]+Vt*ir,y:gt[1]+jt*ir};kt(l.projection.unproject(dr.x,dr.y),dr)}}this.elevatedGlobeVertexBuffer=a.createVertexBuffer(ae,Qk.members)}{this.maxLongitudeTriangleSize=0;let ae=[],me=new Ta;const ye=(we,Be,ze)=>{me.emplaceBack(we,Be,ze);const Ve=D[we],Ze=D[Be],Ye=D[ze],Ct=Math.min(Math.min(Ve,Ze),Ye),nt=Math.max(Math.max(Ve,Ze),Ye)-Ct;nt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=nt),ae.push(Ct+nt/2)};for(let we=0;we<64;we++)for(let Be=0;Be<64;Be++){const ze=65*we+Be,Ve=ze+1,Ze=ze+65,Ye=Ze+1;ye(ze,Ze,Ve),ye(Ve,Ze,Ye)}[ae,me]=function(we,Be){const ze=Array.from({length:we.length},(Ye,Ct)=>Ct);ze.sort((Ye,Ct)=>we[Ye]-we[Ct]);const Ve=[],Ze=new Ta;for(let Ye=0;Ye<ze.length;Ye++){const Ct=ze[Ye];Ve.push(we[Ct]);const nt=3*Ct,kt=nt+1;Ze.emplaceBack(Be.uint16[nt],Be.uint16[kt],Be.uint16[kt+1])}return[Ve,Ze]}(ae,me),this.elevatedGlobeTrianglesCenterLongitudes=ae,this.elevatedGlobeIndexBuffer=a.createIndexBuffer(me)}this.elevatedGlobeSegments=Ti.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ne/Zt,0,ie/Zt,0,0,q,H,0])}prepare(){const a=Object.keys(this.tiles).length!==0;if(this.tileID&&!a)return;const l=this.map.painter.context,f=l.gl;!this._dirty||this.texture instanceof a1||(this.texture?this.texture.update(this.image):(this.texture=new Ck(l,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),a&&this._prepareData(l)}loadTile(a,l){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},l(null)):(a.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(a){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let p=(_=a+180)+360*Math.round((f[0]-_)/360);var _;const y=new Ti,T=(F,z)=>{y.segments.push({vertexOffset:0,primitiveOffset:F,vertexLength:l.segments[0].vertexLength,primitiveLength:z,sortKey:void 0,vaos:{}})},A=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-p)<=A){const F=ca(f,0,f.length,p+A);return F===f.length||T(F,$n(f,F+1,f.length,p+360-A)-F),y}p<f[0]&&(p+=360);const I=$n(f,0,f.length,p-A);if(I===f.length)return T(0,f.length),y;T(0,I-0);const D=ca(f,I+1,f.length,p+A);return D!==f.length&&T(D,f.length-D),y}}const Bne=(Math.pow(256,2)-1)/16907520;class d5 extends Po{constructor(a,l,f,p){super(a,{layout:c5||(c5=new Ii({visibility:new Wt(rt.layout_raster.visibility)})),paint:u5||(u5=new Ii({"raster-opacity":new Wt(rt.paint_raster["raster-opacity"]),"raster-color":new md(rt.paint_raster["raster-color"]),"raster-color-mix":new Wt(rt.paint_raster["raster-color-mix"]),"raster-color-range":new Wt(rt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Wt(rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wt(rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wt(rt.paint_raster["raster-brightness-max"]),"raster-saturation":new Wt(rt.paint_raster["raster-saturation"]),"raster-contrast":new Wt(rt.paint_raster["raster-contrast"]),"raster-resampling":new Wt(rt.paint_raster["raster-resampling"]),"raster-fade-duration":new Wt(rt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Wt(rt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Wt(rt.paint_raster["raster-array-band"]),"raster-elevation":new Wt(rt.paint_raster["raster-elevation"]),"raster-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},l,f,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(a){return!(a&&a._source instanceof f5&&(a._source.onNorthPole||a._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(a){a!=="raster-color"&&a!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(a){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[f,p]=a||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(p)||f===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=Wx({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,p])}}let p5,m5,g5,_5,y5;class v5 extends Po{constructor(a,l,f,p){super(a,{layout:p5||(p5=new Ii({visibility:new Wt(rt["layout_raster-particle"].visibility)})),paint:m5||(m5=new Ii({"raster-particle-array-band":new Wt(rt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Wt(rt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new md(rt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Wt(rt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Wt(rt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Wt(rt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Wt(rt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Wt(rt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},l,f,p),this._updateColorRamp(),this.lastInvalidatedAt=tc.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(a){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(a){return!1}_handleSpecialPaintPropertyUpdate(a){a!=="raster-particle-color"&&a!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),a==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const a=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Wx({expression:a,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=tc.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class zne extends Po{constructor(a,l){super(a,{},l,null),this.implementation=a,a.slot&&(this.slot=a.slot)}is3D(a){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(a){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}function eO(c,a,l){const f=[0,0,1],p=Di([]);return Ra(p,p,l?-Qe(c)+Math.PI:Qe(c)),ra(p,p,-Qe(a)),Ne(f,f,p),yt(f,f)}const x5={None:0,Model:1,Symbol:2,FillExtrusion:4};class dS{constructor(a,l,f,p){this.message=(a?`${a}: `:"")+f,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function tO(c,a){const l=c.indexOf("://")===-1;try{return new URL(c,l&&a?"http://example.com":void 0),!0}catch{return!1}}class w5{constructor(a,l){this.feature=a,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class b5{constructor(){this.instancedDataArray=new Bx,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class rO{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=a.projection,this.index=a.index,this.worldview=a.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=a.styleDefinedModelURLs}updateFootprints(a,l){}populate(a,l,f,p){this.tileToMeter=st(f);const _=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:y,id:T,index:A,sourceLayerIndex:I}of a){const D=T??(y.properties&&y.properties.hasOwnProperty("id")?y.properties.id:void 0),F=Ut(y,_);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom,{worldview:this.worldview}),F,f))continue;const z={id:D,sourceLayerIndex:I,index:A,geometry:_?F.geometry:tr(y,f,p),properties:y.properties,type:y.type,patterns:{}},H=this.addFeature(z,z.geometry,F);H&&l.featureIndex.insert(y,z.geometry,A,I,this.index,this.instancesPerModel[H].instancedDataArray.length,Zt/32)}this.lookup=null}update(a,l,f,p){for(const _ in this.instancesPerModel){const y=this.instancesPerModel[_];for(const T in a)y.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(y.features[y.idToFeaturesIndex[T]],a[T],y,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let a=!1;for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];for(const p of f.features){const _=this.layers[0],y=p.feature,T=this.canonical,A=_.paint.get("model-rotation").evaluate(y,{},T),I=_.paint.get("model-scale").evaluate(y,{},T),D=_.paint.get("model-translation").evaluate(y,{},T);kr(p.rotation,A)&&kr(p.scale,I)&&kr(p.translation,D)||(this.evaluate(p,p.featureStates,f,!0),a=!0)}}return a}updateReplacement(a,l,f,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const _=l.getReplacementRegionsForTile(a.toUnwrapped(),!0);if(BT(this.activeReplacements,_))return!1;this.activeReplacements=_;let y=!1;for(const T in this.instancesPerModel){const A=this.instancesPerModel[T],I=A.instancedDataArray;for(const D of A.features){const F=D.instancedDataOffset,z=D.instancedDataCount;for(let H=0;H<z;H++){const q=16*(H+F);let ne=I.float32[q+0];const ie=ne>Zt;ne=ie?ne-Zt:ne;const ae=Math.floor(ne),me=I.float32[q+1];let ye=!1;for(const we of this.activeReplacements)if(!lB(we,f,x5.Model,p)&&!(we.min.x>ae||ae>we.max.x||we.min.y>me||me>we.max.y)&&(ye=mk(fB(ae,me,a.canonical,we.footprintTileId.canonical),we.footprint),ye))break;I.float32[q]=ye?ne+Zt:ne,y=y||ye!==ie}}}return y}isEmpty(){for(const a in this.instancesPerModel)if(this.instancesPerModel[a].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(a){if(!this.uploaded)for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=a.createVertexBuffer(f.instancedDataArray,pre.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const f=this.instancesPerModel[l];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const a=this.layers[0].modelManager;if(a&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)a.removeModel(l,"",!0)}addFeature(a,l,f){const p=this.layers[0],_=p.layout.get("model-id").evaluate(f,{},this.canonical);if(!_)return nr(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),_;(tO(_,!1)||this.styleDefinedModelURLs[_]!==void 0)&&(this.modelUris.includes(_)||this.modelUris.push(_)),this.instancesPerModel[_]||(this.instancesPerModel[_]=new b5);const y=this.instancesPerModel[_],T=y.instancedDataArray,A=new w5(f,T.length);for(const I of l)for(const D of I){if(D.x<0||D.x>=Zt||D.y<0||D.y>=Zt)continue;if(this.lookupDim!==0){const z=(this.lookupDim-1)/Zt,H=this.lookupDim*(D.y*z|0)+D.x*z|0;if(this.lookup){if(this.lookup[H]!==0)continue;this.lookup[H]=1}}this.instanceCount++;const F=T.length;T.resize(F+1),y.instancesEvaluatedElevation.push(0),T.float32[16*F]=D.x,T.float32[16*F+1]=D.y}return A.instancedDataCount=y.instancedDataArray.length-A.instancedDataOffset,A.instancedDataCount>0&&(a.id&&(y.idToFeaturesIndex[a.id]=y.features.length),y.features.push(A),this.evaluate(A,{},y,!1)),_}getModelUris(){return this.modelUris}evaluate(a,l,f,p){const _=this.layers[0],y=a.feature,T=this.canonical,A=a.rotation=_.paint.get("model-rotation").evaluate(y,l,T),I=a.scale=_.paint.get("model-scale").evaluate(y,l,T),D=a.translation=_.paint.get("model-translation").evaluate(y,l,T),F=_.paint.get("model-color").evaluate(y,l,T);F.a=_.paint.get("model-color-mix-intensity").evaluate(y,l,T);const z=[];this.maxVerticalOffset<D[2]&&(this.maxVerticalOffset=D[2]),this.maxScale=Math.max(Math.max(this.maxScale,I[0]),Math.max(I[1],I[2])),qB(z,A,I);const H=Math.round(100*F.a)+F.b/1.05;for(let q=0;q<a.instancedDataCount;++q){const ne=a.instancedDataOffset+q,ie=16*ne,ae=f.instancedDataArray.float32;let me=0;p&&(me=ae[ie+6]-f.instancesEvaluatedElevation[ne]);const ye=0|ae[ie+1];ae[ie]=(0|ae[ie])+F.r/1.05,ae[ie+1]=ye+F.g/1.05,ae[ie+2]=H,ae[ie+3]=1/(T.z>10?this.tileToMeter:st(T,ye)),ae[ie+4]=D[0],ae[ie+5]=D[1],ae[ie+6]=D[2]+me,ae[ie+7]=z[0],ae[ie+8]=z[1],ae[ie+9]=z[2],ae[ie+10]=z[4],ae[ie+11]=z[5],ae[ie+12]=z[6],ae[ie+13]=z[8],ae[ie+14]=z[9],ae[ie+15]=z[10],f.instancesEvaluatedElevation[ne]=D[2]}}}let T5,S5;sr(rO,"ModelBucket",{omit:["layers"]}),sr(b5,"PerModelAttributes"),sr(w5,"ModelFeature");class __{constructor(a,l,f){this._demTile=a,this._dem=this._demTile.dem,this._scale=l,this._offset=f}static create(a,l,f){const p=f||a.findDEMTileFor(l);if(!p||!p.dem)return;const _=p.dem,y=p.tileID,T=1<<l.canonical.z-y.canonical.z;return new __(p,_.dim/Zt/T,[(l.canonical.x/T-y.canonical.x)*_.dim,(l.canonical.y/T-y.canonical.y)*_.dim])}tileCoordToPixel(a,l){const f=l*this._scale+this._offset[1];return new Pt(Math.floor(a*this._scale+this._offset[0]),Math.floor(f))}getElevationAt(a,l,f,p){const _=a*this._scale+this._offset[0],y=l*this._scale+this._offset[1],T=Math.floor(_),A=Math.floor(y),I=this._dem;return p=!!p,f?Ir(Ir(I.get(T,A,p),I.get(T,A+1,p),y-A),Ir(I.get(T+1,A,p),I.get(T+1,A+1,p),y-A),_-T):I.get(T,A,p)}getElevationAtPixel(a,l,f){return this._dem.get(a,l,!!f)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Me(1,a)*this._dem.stride}}const nO=new Float32Array(262144),Rm=new Uint8Array(262144);function E5(c){let a=0;if(c.meshes)for(const l of c.meshes)a=Math.max(a,l.aabb.max[2]);if(c.children)for(const l of c.children)a=Math.max(a,E5(l));return a}function A5(c,a,l){if(c.meshes)for(const f of c.meshes){if(f.aabb.min[0]===1/0)continue;const p=Rr.applyTransform(f.aabb,c.matrix);l.insert(a,p.min[0],p.min[1],p.max[0],p.max[1])}if(c.children)for(const f of c.children)A5(f,a,l)}const C5=["","wall","door","roof","window","lamp","logo"];class P5{constructor(a){this.node=a,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:a.id,geometry:[],properties:{height:E5(a)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Rr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let a=0;const l=new Rr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==a&&(f.transformedAabb=Rr.applyTransformFast(f.aabb,this.node.matrix),l.encapsulate(f.transformedAabb)),a++;this.aabb=l}return this.aabb}}class pS{constructor(a,l,f,p,_,y,T,A){this.id=f,this.layers=a,this.layerIds=this.layers.map(I=>I.fqid),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id),this.modelTraits|=h_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=h_.HasMapboxMeshFeatures),_&&(this.modelTraits|=h_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.worldview=A,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const I of l)this.nodesInfo.push(new P5(I)),A5(I,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(a,l){for(const f of this.getNodesInfo()){const p=f.node;p.footprint&&l.push({footprint:p.footprint,id:a})}}update(a){const l=Object.keys(a).length!==0;if(l&&!this.stateDependentLayers.length)return;const f=l?this.stateDependentLayers:this.layers;if(!si(a,this.states))for(const p of f)this.evaluate(p,a);this.states=structuredClone(a)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(a){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const f of l){const p=f.node;this.uploaded?this.updatePbrBuffer(p):kk(p,a,!0)}for(const f of l)XT(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(a){let l=!1;if(!a.meshes)return l;for(const f of a.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),l=!0);return l}needsReEvaluation(a,l,f){const p=a.transform.projectionOptions,_=a.style.getBrightness(),y=this.brightness!==_;if(!this.uploaded||this.dirty||p.name!==this.projection.name||v1(f.paint.get("model-color").value,y)||v1(f.paint.get("model-color-mix-intensity").value,y)||v1(f.paint.get("model-roughness").value,y)||v1(f.paint.get("model-emissive-strength").value,y)||v1(f.paint.get("model-height-based-emissive-strength-multiplier").value,y)){this.projection=p,this.brightness=_;const T=this.getNodesInfo();for(const A of T)A.state=null;return!0}return!1}evaluateTransform(a,l){if(a.transform.zoom===this.zoom)return;this.zoom=a.transform.zoom;const f=this.getNodesInfo(),p=this.id.canonical;for(const _ of f){const y=_.feature;_.evaluatedTranslation=l.paint.get("model-translation").evaluate(y,{},p),_.evaluatedScale=l.paint.get("model-scale").evaluate(y,{},p)}}evaluate(a,l){const f=this.getNodesInfo();for(const p of f){if(!p.node.meshes)continue;const _=p.feature,y=l&&l[_.id];if(si(y,p.state))continue;p.state=structuredClone(y);const T=p.node.meshes&&p.node.meshes[0].featureData,A=p.evaluatedColor[2],I=p.evaluatedRMEA[2],D=this.id.canonical;if(p.hasTranslucentParts=!1,T){for(let F=0;F<C5.length;F++){const z=C5[F];z.length&&(_.properties.part=z);const H=a.paint.get("model-color").evaluate(_,y,D).toPremultipliedRenderColor(null),q=a.paint.get("model-color-mix-intensity").evaluate(_,y,D);p.evaluatedColor[F]=[H.r,H.g,H.b,q],p.evaluatedRMEA[F][0]=a.paint.get("model-roughness").evaluate(_,y,D),p.evaluatedRMEA[F][2]=a.paint.get("model-emissive-strength").evaluate(_,y,D),p.evaluatedRMEA[F][3]=H.a,p.emissionHeightBasedParams[F]=a.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,y,D),!p.hasTranslucentParts&&H.a<1&&(p.hasTranslucentParts=!0)}delete _.properties.part,Une(p,A!==p.evaluatedColor[2]||I!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=a.paint.get("model-emissive-strength").evaluate(_,y,D);p.evaluatedTranslation=a.paint.get("model-translation").evaluate(_,y,D),p.evaluatedScale=a.paint.get("model-scale").evaluate(_,y,D),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(a,l,f,p){const _=a.findDEMTileFor(f);if(_&&(_.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(_.dem&&_.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=_.tileID.overscaledZ;const y=__.create(a,f,_);if(!y)return;this.modelTraits&h_.HasMapboxMeshFeatures&&this.updateDEM(a,y,f,p);for(const T of this.getNodesInfo()){const A=T.node;if(!A.footprint||!A.footprint.vertices||!A.footprint.vertices.length)continue;const I=A.footprint.vertices;let D=y.getElevationAt(I[0].x,I[0].y,!0,!0);for(let F=1;F<I.length;F++)D=Math.min(D,y.getElevationAt(I[F].x,I[F].y,!0,!0));A.elevation=D}}this.terrainTile=_.tileID.canonical,this.terrainExaggeration=l}}updateDEM(a,l,f,p){let _=l._dem._modifiedForSources[p];if(_===void 0&&(l._dem._modifiedForSources[p]=[],_=l._dem._modifiedForSources[p]),_.includes(f.canonical))return;const y=l._dem.dim;_.push(f.canonical);let T=!1;for(const A of this.getNodesInfo()){const I=A.node;if(!I.footprint||!I.footprint.grid)continue;const D=I.footprint.grid,F=l.tileCoordToPixel(D.min.x,D.min.y),z=l.tileCoordToPixel(D.max.x,D.max.y),H=Math.min(Math.min(y-z.y,F.x),Math.min(F.y,y-z.x));if(H<0)continue;const q=Q(H,2,5);let ne=Math.max(0,F.x-q),ie=Math.max(0,F.y-q),ae=Math.min(z.x+q,y-1),me=Math.min(z.y+q,y-1);for(let ze=ie;ze<=me;++ze)for(let Ve=ne;Ve<=ae;++Ve)Rm[ze*y+Ve]=255;let ye=0,we=0;for(let ze=0;ze<D.cellsY;++ze)for(let Ve=0;Ve<D.cellsX;++Ve){if(!D.cells[ze*D.cellsX+Ve])continue;const Ze=l.tileCoordToPixel(D.min.x+Ve/D.xScale,D.min.y+ze/D.yScale),Ye=l.tileCoordToPixel(D.min.x+(Ve+1)/D.xScale,D.min.y+(ze+1)/D.yScale);for(let Ct=Ze.y;Ct<=Math.min(Ye.y+1,y-1);++Ct)for(let nt=Ze.x;nt<=Math.min(Ye.x+1,y-1);++nt)Rm[Ct*y+nt]===255&&(Rm[Ct*y+nt]=0,ye+=l.getElevationAtPixel(nt,Ct),we++)}const Be=ye/we;ne=Math.max(1,F.x-q),ie=Math.max(1,F.y-q),ae=Math.min(z.x+q,y-2),me=Math.min(z.y+q,y-2),T=!0;for(let ze=ie;ze<=me;++ze)for(let Ve=ne;Ve<=ae;++Ve)Rm[ze*y+Ve]===0&&(nO[ze*y+Ve]=l._dem.set(Ve,ze,Be));for(let ze=1;ze<q;++ze){ne=Math.max(1,F.x-ze),ie=Math.max(1,F.y-ze),ae=Math.min(z.x+ze,y-2),me=Math.min(z.y+ze,y-2);for(let Ve=ie;Ve<=me;++Ve)for(let Ze=ne;Ze<=ae;++Ze){const Ye=Ve*y+Ze;if(Rm[Ye]===255){let Ct=0,nt=0,kt=-1,zt=-1;for(let Ot=-1;Ot<=1;++Ot)for(let Lt=-1;Lt<=1;++Lt){const $t=(Ve+Ot)*y+Ze+Lt;if(Rm[$t]>=ze)continue;const Et=nO[$t],Nt=Math.abs(Et);Nt>nt&&(Ct=Et,nt=Nt,kt=Lt,zt=Ot)}if(nt>.1){const Ot=1-(ze+.5*Math.abs(kt*zt))/q;let Lt=l._dem.get(Ze,Ve)+Ct*Ot;const $t=l._dem.get(Ze+kt,Ve+zt),Et=l._dem.get(Ze-kt,Ve-zt,!0);(Lt-$t)*(Lt-Et)>0&&(Lt=($t+Et)/2),nO[Ye]=l._dem.set(Ze,Ve,Lt),Rm[Ye]=ze}}}}}T&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=tc.now())}setFilter(a){this.filter=a?pm(a):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(a=>this.filter.filter(new Kn(this.id.overscaledZ,{worldview:this.worldview}),a.feature,this.id.canonical)):this.nodesInfo}destroy(){const a=this.getNodesInfo();for(const l of a)XT(l.node),Ok(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(a,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const f=l.getReplacementRegionsForTile(a.toUnwrapped());for(const p of this.getNodesInfo()){const _=p.node.footprint;p.hiddenByReplacement=!!_&&!f.find(y=>y.footprint===_)}}getHeightAtTileCoord(a,l){const f=[],p=[0,0,0],_=R([]);for(const y of this.getNodesInfo()){const T=y.node.meshes[0],A=T.transformedAabb;if(a<A.min[0]||l<A.min[1]||a>A.max[0]||l>A.max[1])continue;if(y.node.hidden===!0)return{height:1/0,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};N(_,y.node.matrix),p[0]=a,p[1]=l,Mt(p,p,_);const I=(p[0]-T.aabb.min[0])/(T.aabb.max[0]-T.aabb.min[0])*km|0,D=Math.min(63,(p[1]-T.aabb.min[1])/(T.aabb.max[1]-T.aabb.min[1])*km|0)*km+Math.min(63,I),F=T.heightmap[D];if(!(F<0&&y.node.footprint))return y.hiddenByReplacement?void 0:{height:F,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};if(y.node.footprint.grid.query(new Pt(a,l),new Pt(a,l),f),f.length>0)return{height:void 0,maxHeight:y.feature.properties.height,hidden:y.hiddenByReplacement,verticalScale:y.evaluatedScale[2]}}}}function v1(c,a){return c instanceof fm&&!c.isLightConstant&&a}function jne(c,a,l,f,p,_,y,T){let A=(61440&a|(61440&a)>>4)>>8,I=(3840&a|(3840&a)>>4)>>4,D=240&a|(240&a)>>4;l[3]>0&&(A=Ir(A,255*l[0],l[3]),I=Ir(I,255*l[1],l[3]),D=Ir(D,255*l[2],l[3]));const F=A<<8|I,z=D<<8|Math.floor(255*f[3]),H=function(ze){const Ve=Q(ze,0,2);return Math.min(Math.round(.5*Ve*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],q=Q(p[0],0,1),ne=Q(p[1],0,1),ie=Q(p[2],0,1),ae=Q(p[3],0,1);let me,ye,we,Be;if(q!==ne&&y!==_&&ne!==q){const ze=y-_;ye=1/(ze*(ne-q)),we=-(_+ze*q)/(ze*(ne-q));const Ve=Q(p[4],-1,1);Be=Math.pow(10,Ve),me=255*ie<<8|255*ae}else me=65535,ye=0,we=1,Be=1;if(c.emplaceBack(F,z,H,me,ye,we,Be),T){const ze=T.length;T.clear();for(let Ve=0;Ve<ze;Ve++)T.emplaceBack(F,z,H,me,ye,we,Be)}}function Une(c,a,l){const f=c.node;let p=0;const _=l&h_.HasMeshoptCompression;for(const y of f.meshes){if(f.lights&&f.lightMeshIndex===p||!y.featureData)continue;y.featureArray=new Td,y.featureArray.reserve(y.featureData.length);let T=a;for(const A of y.featureData){const I=_?65535&A:A>>16&65535,D=_?A>>16&65535:65535&A,F=(15&D)<8?15&D:0,z=c.evaluatedRMEA[F],H=c.evaluatedColor[F],q=c.emissionHeightBasedParams[F];let ne;if(T&&F===2&&f.lights&&(ne=new Td,ne.resize(10*f.lights.length)),jne(y.featureArray,I,H,z,q,y.aabb.min[2],y.aabb.max[2],ne),ne&&T){T=!1;const ie=f.meshes[f.lightMeshIndex];ie.featureArray=ne,ie.featureArray._trim()}}y.featureArray._trim(),p++}}function I5(c,a,l,f){const p=1<<c.z;a.lat=Re((f/Zt+c.y)/p),a.lng=Fe((l/Zt+c.x)/p)}function $ne(c,a,l,f){const p=c.getNodesInfo()[a];if(!p||p.hiddenByReplacement||!p.node.meshes)return;let _=Number.MAX_VALUE;const y=p.node,T=l.tile,A=f.calculatePosMatrix(T.tileID.toUnwrapped(),f.worldSize),I=p.evaluatedScale;let D=0;f.elevation&&y.elevation&&(D=y.elevation*f.elevation.exaggeration()),G(A,A,[(y.anchor?y.anchor[0]:0)*(I[0]-1),(y.anchor?y.anchor[1]:0)*(I[1]-1),D]),U(A,A,I);const F=l.queryGeometry,z=F.isPointQuery()?F.screenBounds:F.screenGeometry,H=function(ne){const ie=V([],A,ne.matrix);V(ie,f.expandedFarZProjMatrix,ie);for(let ae=0;ae<ne.meshes.length;++ae){const me=ne.meshes[ae];if(ae===ne.lightMeshIndex)continue;const ye=XB(z,f,ie,me.aabb);ye!=null&&(_=Math.min(ye,_))}if(ne.children)for(const ae of ne.children)H(ae)};if(H(y),_===Number.MAX_VALUE)return;const q=new te(0,0);return I5(T.tileID.canonical,q,p.node.anchor[0],p.node.anchor[1]),{intersectionZ:_,position:q,feature:p.feature}}sr(pS,"Tiled3dModelBucket",{omit:["layers"]}),sr(P5,"Tiled3dModelFeature");const Vne={circle:class extends Po{constructor(c,a,l,f){super(c,{layout:Ed||(Ed=new Ii({"circle-sort-key":new er(rt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Wt(rt.layout_circle["circle-elevation-reference"]),visibility:new Wt(rt.layout_circle.visibility)})),paint:Xc||(Xc=new Ii({"circle-radius":new er(rt.paint_circle["circle-radius"]),"circle-color":new er(rt.paint_circle["circle-color"]),"circle-blur":new er(rt.paint_circle["circle-blur"]),"circle-opacity":new er(rt.paint_circle["circle-opacity"]),"circle-translate":new Wt(rt.paint_circle["circle-translate"]),"circle-translate-anchor":new Wt(rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wt(rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wt(rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new er(rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new er(rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new er(rt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Wt(rt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f)}createBucket(c){return new qa(c)}queryRadius(c){const a=c;return Rl("circle-radius",this,a)+Rl("circle-stroke-width",this,a)+Yu(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,l,f,p,_,y,T){const A=cc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(a,l)+this.paint.get("circle-stroke-width").evaluate(a,l);return FN(c,f,_,y,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,I)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,a,l){const f=DN(this);return{config:new af(this,{zoom:a,lut:l}),defines:f,overrideFog:!1}}is3D(c){return!c&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Po{createBucket(c){return new NN(c)}constructor(c,a,l,f){super(c,{layout:BN||(BN=new Ii({visibility:new Wt(rt.layout_heatmap.visibility)})),paint:zN||(zN=new Ii({"heatmap-radius":new er(rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new er(rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wt(rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new md(rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wt(rt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(c){return Rl("heatmap-radius",this,c)}queryIntersectsFeature(c,a,l,f,p,_,y,T){const A=this.paint.get("heatmap-radius").evaluate(a,l);return FN(c,f,_,y,T,!0,!0,new Pt(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,a,l){return c==="heatmap"?{config:new af(this,{zoom:a,lut:l}),overrideFog:!1}:{}}},hillshade:class extends Po{constructor(c,a,l,f){super(c,{layout:jN||(jN=new Ii({visibility:new Wt(rt.layout_hillshade.visibility)})),paint:UN||(UN=new Ii({"hillshade-illumination-direction":new Wt(rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wt(rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wt(rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wt(rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wt(rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wt(rt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Wt(rt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,a,l){return{overrideFog:!1}}},fill:class extends Po{constructor(c,a,l,f){super(c,{layout:rB||(rB=new Ii({"fill-sort-key":new er(rt.layout_fill["fill-sort-key"]),visibility:new Wt(rt.layout_fill.visibility),"fill-elevation-reference":new Wt(rt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new er(rt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:nB||(nB=new Ii({"fill-antialias":new Wt(rt.paint_fill["fill-antialias"]),"fill-opacity":new er(rt.paint_fill["fill-opacity"]),"fill-color":new er(rt.paint_fill["fill-color"]),"fill-outline-color":new er(rt.paint_fill["fill-outline-color"]),"fill-translate":new Wt(rt.paint_fill["fill-translate"]),"fill-translate-anchor":new Wt(rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new er(rt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Wt(rt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Wt(rt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new er(rt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new er(rt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new er(rt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),l=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(c,a,l){return{config:new af(this,{zoom:a,lut:l}),overrideFog:!1}}recalculate(c,a){super.recalculate(c,a);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new fk(c)}queryRadius(){return Yu(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,l,f,p,_){return!c.queryGeometry.isAboveHorizon&&ps(Ku(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(c){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const a=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return c!=null?a&&!c:a}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Po{constructor(c,a,l,f){super(c,{layout:AB||(AB=new Ii({visibility:new Wt(rt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Wt(rt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:CB||(CB=new Ii({"fill-extrusion-opacity":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new er(rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new er(rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new er(rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new er(rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new er(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new er(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new er(rt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new er(rt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Wt(rt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new jT(c)}queryRadius(){return Yu(this.paint.get("fill-extrusion-translate"))}is3D(c){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,a,l,f,p,_,y,T,A){const I=cc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(a,l),F=this.paint.get("fill-extrusion-base").evaluate(a,l),z=[0,0],H=T&&_.elevation,q=_.elevation?_.elevation.exaggeration():1,ne=c.tile.getBucket(this);if(H&&ne instanceof jT){const we=ne.centroidVertexArray,Be=A+1;Be<we.length&&(z[0]=we.geta_centroid_pos0(Be),z[1]=we.geta_centroid_pos1(Be))}if(z[0]===0&&z[1]===1)return!1;_.projection.name==="globe"&&(f=EB([f],[new Pt(0,0),new Pt(Zt,Zt)],c.tileID.canonical).map(we=>we.polygon).flat());const ie=H?T:null,[ae,me]=function(we,Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt,Ot){return we.projection.name==="globe"?function(Lt,$t,Et,Nt,gt,ut,Vt,jt,br,ir,dr){const qt=[],xr=[],jr=Lt.projection.upVectorScale(dr,Lt.center.lat,Lt.worldSize).metersToTile,Qt=[0,0,0,1],gr=[0,0,0,1],Or=(rn,Gr,hr,Wr)=>{rn[0]=Gr,rn[1]=hr,rn[2]=Wr,rn[3]=1},Vr=SB();Et>0&&(Et+=Vr),Nt+=Vr;for(const rn of $t){const Gr=[],hr=[];for(const Wr of rn){const dn=Wr.x+gt.x,Ae=Wr.y+gt.y,Ce=Lt.projection.projectTilePoint(dn,Ae,dr),dt=Lt.projection.upVector(dr,Wr.x,Wr.y);let At=Et,Jt=Nt;if(Vt){const Kt=RB(dn,Ae,Et,Nt,Vt,jt,br,ir);At+=Kt.base,Jt+=Kt.top}Et!==0?Or(Qt,Ce.x+dt[0]*jr*At,Ce.y+dt[1]*jr*At,Ce.z+dt[2]*jr*At):Or(Qt,Ce.x,Ce.y,Ce.z),Or(gr,Ce.x+dt[0]*jr*Jt,Ce.y+dt[1]*jr*Jt,Ce.z+dt[2]*jr*Jt),Mt(Qt,Qt,ut),Mt(gr,gr,ut),Gr.push(new Pm(Qt[0],Qt[1],Qt[2])),hr.push(new Pm(gr[0],gr[1],gr[2]))}qt.push(Gr),xr.push(hr)}return[qt,xr]}(we,Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt,Ot):Ct?function(Lt,$t,Et,Nt,gt,ut,Vt,jt,br){const ir=[],dr=[],qt=[0,0,0,1];for(const xr of Lt){const jr=[],Qt=[];for(const gr of xr){const Or=gr.x+Nt.x,Vr=gr.y+Nt.y,rn=RB(Or,Vr,$t,Et,ut,Vt,jt,br);qt[0]=Or,qt[1]=Vr,qt[2]=rn.base,qt[3]=1,Yn(qt,qt,gt),qt[3]=Math.max(qt[3],1e-5);const Gr=new Pm(qt[0]/qt[3],qt[1]/qt[3],qt[2]/qt[3]);qt[0]=Or,qt[1]=Vr,qt[2]=rn.top,qt[3]=1,Yn(qt,qt,gt),qt[3]=Math.max(qt[3],1e-5);const hr=new Pm(qt[0]/qt[3],qt[1]/qt[3],qt[2]/qt[3]);jr.push(Gr),Qt.push(hr)}ir.push(jr),dr.push(Qt)}return[ir,dr]}(Be,ze,Ve,Ze,Ye,Ct,nt,kt,zt):function(Lt,$t,Et,Nt,gt){const ut=[],Vt=[],jt=gt[8]*$t,br=gt[9]*$t,ir=gt[10]*$t,dr=gt[11]*$t,qt=gt[8]*Et,xr=gt[9]*Et,jr=gt[10]*Et,Qt=gt[11]*Et;for(const gr of Lt){const Or=[],Vr=[];for(const rn of gr){const Gr=rn.x+Nt.x,hr=rn.y+Nt.y,Wr=gt[0]*Gr+gt[4]*hr+gt[12],dn=gt[1]*Gr+gt[5]*hr+gt[13],Ae=gt[2]*Gr+gt[6]*hr+gt[14],Ce=gt[3]*Gr+gt[7]*hr+gt[15],dt=Wr+jt,At=dn+br,Jt=Ae+ir,Kt=Math.max(Ce+dr,1e-5),lr=Wr+qt,Er=dn+xr,nn=Ae+jr,on=Math.max(Ce+Qt,1e-5);Or.push(new Pm(dt/Kt,At/Kt,Jt/Kt)),Vr.push(new Pm(lr/on,Er/on,nn/on))}ut.push(Or),Vt.push(Vr)}return[ut,Vt]}(Be,ze,Ve,Ze,Ye)}(_,f,F,D,I,y,ie,z,q,_.center.lat,c.tileID.canonical),ye=c.queryGeometry;return function(we,Be,ze){let Ve=1/0;ps(ze,Be)&&(Ve=MB(ze,Be[0]));for(let Ze=0;Ze<Be.length;Ze++){const Ye=Be[Ze],Ct=we[Ze];for(let nt=0;nt<Ye.length-1;nt++){const kt=Ye[nt],zt=[kt,Ye[nt+1],Ct[nt+1],Ct[nt],kt];Ws(ze,zt)&&(Ve=Math.min(Ve,MB(ze,zt)))}}return Ve!==1/0&&Ve}(ae,me,ye.isPointQuery()?ye.screenBounds:ye.screenGeometry)}},building:class extends Po{constructor(c,a,l,f){super(c,{layout:iz||(iz=new Ii({visibility:new Wt(rt.layout_building.visibility),"building-facade":new er(rt.layout_building["building-facade"]),"building-facade-floors":new er(rt.layout_building["building-facade-floors"]),"building-facade-unit-width":new er(rt.layout_building["building-facade-unit-width"]),"building-facade-window":new er(rt.layout_building["building-facade-window"]),"building-roof-shape":new er(rt.layout_building["building-roof-shape"]),"building-height":new er(rt.layout_building["building-height"]),"building-base":new er(rt.layout_building["building-base"]),"building-flood-light-wall-radius":new er(rt.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new er(rt.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new er(rt.layout_building["building-flip-roof-orientation"])})),paint:az||(az=new Ii({"building-opacity":new Wt(rt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new Wt(rt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new Wt(rt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Wt(rt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Wt(rt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Wt(rt.paint_building["building-vertical-scale"]),"building-cast-shadows":new Wt(rt.paint_building["building-cast-shadows"]),"building-color":new er(rt.paint_building["building-color"]),"building-emissive-strength":new er(rt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new Wt(rt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new Wt(rt.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new Wt(rt.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new Wt(rt.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new Wt(rt.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new nz(c)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(c){return!0}},line:class extends Po{constructor(c,a,l,f){const p=mz();super(c,p,a,l,f),p.layout&&(this.layout=new Jh(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof lm,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=(()=>{if(s1)return s1;const l=mz();return s1=new Ure(l.paint.properties["line-width"].specification),s1.useIntegerZoom=!0,s1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Fk(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,a,l){const f=dz(this);return{config:new af(this,{zoom:a,lut:l}),defines:f,overrideFog:!1}}queryRadius(c){const a=c,l=gz(Rl("line-width",this,a),Rl("line-gap-width",this,a)),f=Rl("line-offset",this,a);return l/2+Math.abs(f)+Yu(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,l,f,p,_){if(c.queryGeometry.isAboveHorizon)return!1;const y=Ku(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*gz(this.paint.get("line-width").evaluate(a,l),this.paint.get("line-gap-width").evaluate(a,l)),A=this.paint.get("line-offset").evaluate(a,l);return A&&(f=function(I,D){const F=[],z=new Pt(0,0);for(let H=0;H<I.length;H++){const q=I[H],ne=[];for(let ie=0;ie<q.length;ie++){const ae=q[ie],me=q[ie+1],ye=ie===0?z:ae.sub(q[ie-1])._unit()._perp(),we=ie===q.length-1?z:me.sub(ae)._unit()._perp(),Be=ye._add(we)._unit();Be._mult(1/(Be.x*we.x+Be.y*we.y)),ne.push(Be._mult(D)._add(ae))}F.push(ne)}return F}(f,A*c.pixelToTileUnitsFactor)),function(I,D,F){for(let z=0;z<D.length;z++){const H=D[z];if(I.length>=3){for(let q=0;q<H.length;q++)if(Na(I,H[q]))return!0}if(ms(I,H,F))return!0}return!1}(y,f,T)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(c){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:uS,background:class extends Po{constructor(c,a,l,f){super(c,{layout:s5||(s5=new Ii({visibility:new Wt(rt.layout_background.visibility)})),paint:l5||(l5=new Ii({"background-pitch-alignment":new Wt(rt.paint_background["background-pitch-alignment"]),"background-color":new Wt(rt.paint_background["background-color"]),"background-pattern":new Wt(rt.paint_background["background-pattern"]),"background-opacity":new Wt(rt.paint_background["background-opacity"]),"background-emissive-strength":new Wt(rt.paint_background["background-emissive-strength"]),"background-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,a,l){return{overrideFog:!1}}is3D(c){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:d5,"raster-particle":v5,sky:class extends Po{constructor(c,a,l,f){super(c,{layout:g5||(g5=new Ii({visibility:new Wt(rt.layout_sky.visibility)})),paint:_5||(_5=new Ii({"sky-type":new Wt(rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Wt(rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Wt(rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Wt(rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Wt(rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new md(rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Wt(rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Wt(rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Wt(rt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Wx({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),p=!f,_=c.style.light,y=_.properties.get("position");return p&&_.properties.get("anchor")==="viewport"&&nr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?eO(y.azimuthal,90-y.polar,a):eO(f[0],90-f[1],a)}const l=this.paint.get("sky-gradient-center");return eO(l[0],90-l[1],a)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Po{constructor(c,a,l,f){super(c,{paint:y5||(y5=new Ii({}))},a,null)}},model:class extends Po{constructor(c,a,l,f){super(c,{layout:T5||(T5=new Ii({visibility:new Wt(rt.layout_model.visibility),"model-id":new er(rt.layout_model["model-id"])})),paint:S5||(S5=new Ii({"model-opacity":new er(rt.paint_model["model-opacity"]),"model-rotation":new er(rt.paint_model["model-rotation"]),"model-scale":new er(rt.paint_model["model-scale"]),"model-translation":new er(rt.paint_model["model-translation"]),"model-color":new er(rt.paint_model["model-color"]),"model-color-mix-intensity":new er(rt.paint_model["model-color-mix-intensity"]),"model-type":new Wt(rt.paint_model["model-type"]),"model-cast-shadows":new Wt(rt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Wt(rt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Wt(rt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new er(rt.paint_model["model-emissive-strength"]),"model-roughness":new er(rt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new er(rt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Wt(rt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Wt(rt.paint_model["model-front-cutoff"]),"model-elevation-reference":new Wt(rt.paint_model["model-elevation-reference"]),"model-color-use-theme":new er({type:"string",default:"default","property-type":"data-driven"})}))},a,l,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new rO(c)}getProgramIds(){return["model"]}is3D(c){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof pS?Zt-1:0}queryIntersectsFeature(c,a,l,f,p,_){if(!this.modelManager)return!1;const y=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof rO))return!1;for(const A in T.instancesPerModel){const I=T.instancesPerModel[A],D=a.id!==void 0?a.id:a.properties&&a.properties.hasOwnProperty("id")?a.properties.id:void 0;if(I.idToFeaturesIndex.hasOwnProperty(D)){const F=I.features[I.idToFeaturesIndex[D]],z=y.getModel(A,this.scope);if(!z)return!1;let H=L();const q=new te(0,0),ne=T.canonical;let ie=Number.MAX_VALUE;for(let ae=0;ae<F.instancedDataCount;++ae){const me=16*(F.instancedDataOffset+ae),ye=I.instancedDataArray.float32,we=[ye[me+4],ye[me+5],ye[me+6]];I5(ne,q,ye[me],0|ye[me+1]),ZB(H,z,_,q,F.rotation,F.scale,we,!1,!1,!1),_.projection.name==="globe"&&(H=Ik(H,_));const Be=V([],_.projMatrix,H),ze=c.queryGeometry,Ve=XB(ze.isPointQuery()?ze.screenBounds:ze.screenGeometry,_,Be,z.aabb);Ve!=null&&(ie=Math.min(Ve,ie))}return ie!==Number.MAX_VALUE&&ie}}return!1}_handleOverridablePaintPropertyUpdate(c,a,l){return!(!this.layout||a.isDataDriven()||l.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const a=this._transitionablePaint._values[c];return a!=null&&a.value!=null&&a.value.expression!=null&&a.value.expression instanceof Uu}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Po{constructor(c,a,l,f){super(c,{layout:iB||(iB=new Ii({"clip-layer-types":new Wt(rt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Wt(rt.layout_clip["clip-layer-scope"])})),paint:aB||(aB=new Ii({}))},a,l,f)}recalculate(c,a){super.recalculate(c,a)}createBucket(c){return new oB(c)}is3D(c){return!0}}},iO=new On(0,0,0),aO={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},oO={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},mS={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},Wne={PAINT_ORDER_FILL_AND_STROKE:1},x1={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},k5={MASK_TYPE_LUMINANCE:1};function Gne(c,a,l){c===1&&a.icons.push(function(f,p){return function(_){if(_.usvg_tree.height||(_.usvg_tree.height=_.usvg_tree.width),!_.metadata)return _;const{metadata:y}=_;if(y.content_area){const{content_area:T}=y;T.left==null&&(T.left=0),T.top==null&&(T.top=T.left),T.width==null&&(T.width=_.usvg_tree.width),T.height==null&&(T.height=T.width)}if(y.text_placeholder){const{text_placeholder:T}=y;T.top==null&&(T.top=T.left),T.height==null&&(T.height=T.width)}return y.stretch_x&&y.stretch_x.length&&O5(y,"x"),y.stretch_y&&y.stretch_y.length&&O5(y,"y"),_}(f.readFields(Hne,{name:void 0},p))}(l,l.readVarint()+l.pos))}function O5(c,a){const l=[],f=c[`stretch_${a}`];let p=null;for(let _=0;_<f.length;_++)p===null?p=l.length===0?f[0]:l[l.length-1][1]+f[_]:(l.push([p,p+f[_]]),p=null);c[`stretch_${a}_areas`]=l}function Hne(c,a,l){c===1?a.name=l.readString():c===2?a.metadata=function(f,p){return f.readFields(qne,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):c===3&&(a.usvg_tree=function(f,p){return f.readFields(Yne,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),a.data="usvg_tree")}function qne(c,a,l){c===1?a.stretch_x=l.readPackedVarint():c===2?a.stretch_y=l.readPackedVarint():c===3?a.content_area=M5(l,l.readVarint()+l.pos):c===4?a.variables.push(function(f,p){return f.readFields(Zne,{name:void 0},p)}(l,l.readVarint()+l.pos)):c===5&&(a.text_placeholder=M5(l,l.readVarint()+l.pos))}function M5(c,a){return c.readFields(Xne,{},a)}function Xne(c,a,l){c===1?a.left=l.readVarint():c===2?a.width=l.readVarint():c===3?a.top=l.readVarint():c===4&&(a.height=l.readVarint())}function Zne(c,a,l){c===1?a.name=l.readString():c===2&&(a.rgb_color=yS(l.readVarint()),a.value="rgb_color")}function Yne(c,a,l){c===1?a.width=a.height=l.readVarint():c===2?a.height=l.readVarint():c===3?a.children.push(gS(l,l.readVarint()+l.pos)):c===4?a.linear_gradients.push(function(f,p){return f.readFields(nie,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):c===5?a.radial_gradients.push(function(f,p){return f.readFields(aie,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):c===7?a.clip_paths.push(function(f,p){return f.readFields(oie,{children:[]},p)}(l,l.readVarint()+l.pos)):c===8&&a.masks.push(function(f,p){const _=f.readFields(sie,{left:0,width:20,mask_type:k5.MASK_TYPE_LUMINANCE,children:[]},p);return _.height==null&&(_.height=_.width),_.top==null&&(_.top=_.left),_}(l,l.readVarint()+l.pos))}function gS(c,a){return c.readFields(Kne,{},a)}function Kne(c,a,l){c===1?(a.group=function(f,p){return f.readFields(Jne,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),a.node="group"):c===2&&(a.path=function(f,p){return f.readFields(eie,{paint_order:1,commands:[],step:1,diffs:[],rule:aO.PATH_RULE_NON_ZERO},p)}(l,l.readVarint()+l.pos),a.node="path")}function Jne(c,a,l){c===1?a.transform=_S(l,l.readVarint()+l.pos):c===2?a.opacity=l.readVarint():c===5?a.clip_path_idx=l.readVarint():c===6?a.mask_idx=l.readVarint():c===7&&a.children.push(gS(l,l.readVarint()+l.pos))}function _S(c,a){return c.readFields(Qne,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},a)}function Qne(c,a,l){c===1?a.sx=l.readFloat():c===2?a.ky=l.readFloat():c===3?a.kx=l.readFloat():c===4?a.sy=l.readFloat():c===5?a.tx=l.readFloat():c===6&&(a.ty=l.readFloat())}function eie(c,a,l){c===1?a.fill=function(f,p){return f.readFields(tie,{rgb_color:iO,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):c===2?a.stroke=function(f,p){return f.readFields(rie,{rgb_color:iO,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):c===3?a.paint_order=l.readVarint():c===5?l.readPackedVarint(a.commands):c===6?a.step=l.readFloat():c===7?l.readPackedSVarint(a.diffs):c===8&&(a.rule=l.readVarint())}function tie(c,a,l){c===1?(a.rgb_color=yS(l.readVarint()),a.paint="rgb_color"):c===2?(a.linear_gradient_idx=l.readVarint(),a.paint="linear_gradient_idx"):c===3?(a.radial_gradient_idx=l.readVarint(),a.paint="radial_gradient_idx"):c===5&&(a.opacity=l.readVarint())}function yS(c){return new On((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function rie(c,a,l){c===1?(a.rgb_color=yS(l.readVarint()),a.paint="rgb_color"):c===2?(a.linear_gradient_idx=l.readVarint(),a.paint="linear_gradient_idx"):c===3?(a.radial_gradient_idx=l.readVarint(),a.paint="radial_gradient_idx"):c===5?l.readPackedFloat(a.dasharray):c===6?a.dashoffset=l.readFloat():c===7?a.miterlimit=l.readFloat():c===8?a.opacity=l.readVarint():c===9?a.width=l.readFloat():c===10?a.linecap=l.readVarint():c===11&&(a.linejoin=l.readVarint())}function nie(c,a,l){c===1?a.transform=_S(l,l.readVarint()+l.pos):c===2?a.spread_method=l.readVarint():c===3?a.stops.push(R5(l,l.readVarint()+l.pos)):c===4?a.x1=l.readFloat():c===5?a.y1=l.readFloat():c===6?a.x2=l.readFloat():c===7&&(a.y2=l.readFloat())}function R5(c,a){return c.readFields(iie,{offset:0,opacity:255,rgb_color:iO},a)}function iie(c,a,l){c===1?a.offset=l.readFloat():c===2?a.opacity=l.readVarint():c===3&&(a.rgb_color=yS(l.readVarint()))}function aie(c,a,l){c===1?a.transform=_S(l,l.readVarint()+l.pos):c===2?a.spread_method=l.readVarint():c===3?a.stops.push(R5(l,l.readVarint()+l.pos)):c===4?a.cx=l.readFloat():c===5?a.cy=l.readFloat():c===6?a.r=l.readFloat():c===7?a.fx=l.readFloat():c===8?a.fy=l.readFloat():c===9&&(a.fr=l.readFloat())}function oie(c,a,l){c===1?a.transform=_S(l,l.readVarint()+l.pos):c===2?a.clip_path_idx=l.readVarint():c===3&&a.children.push(gS(l,l.readVarint()+l.pos))}function sie(c,a,l){c===1?a.left=a.top=l.readFloat():c===2?a.width=a.height=l.readFloat():c===3?a.top=l.readFloat():c===4?a.height=l.readFloat():c===5?a.mask_type=l.readVarint():c===6?a.mask_idx=l.readVarint():c===7&&a.children.push(gS(l,l.readVarint()+l.pos))}class lie{static calculate(a={},l=[]){const f=new Map,p=new Map;if(Object.keys(a).length===0)return f;l.forEach(_=>{p.set(_.name,_.rgb_color||new On(0,0,0))});for(const[_,y]of Object.entries(a))p.has(_)?f.set(p.get(_).toString(),y):console.warn(`Ignoring unknown image variable "${_}"`);return f}}function y_(c,a=255,l){const f=a/255,p=c.toString(),_=l.has(p)?l.get(p).clone():c.clone();return _.a*=f,_.toString()}function w1(c,a){if(!Rv()){const l=document.createElement("canvas");return l.width=c,l.height=a,l}return new OffscreenCanvas(c,a)}function cie(c,a){const l=lie.calculate(a.params,c.metadata?c.metadata.variables:[]),f=c.usvg_tree,p=f.width,_=f.height,y=a.transform?a.transform:new DOMMatrix,T=Math.max(1,Math.round(p*y.a)),A=Math.max(1,Math.round(_*y.d)),I=new DOMMatrix([T/p,0,0,A/_,0,0]),D=w1(T,A).getContext("2d");return sO(D,I,f,f,l),D.getImageData(0,0,T,A)}function sO(c,a,l,f,p){for(const _ of f.children)D5(c,a,l,_,p)}function D5(c,a,l,f,p){f.group?(c.save(),function(_,y,T,A,I){const D=A.mask_idx!=null?T.masks[A.mask_idx]:null,F=A.clip_path_idx!=null?T.clip_paths[A.clip_path_idx]:null;if(A.transform&&(y=v_(A.transform).preMultiplySelf(y)),!function(q,ne,ie){return q.opacity!==255||ne||ie}(A,F!=null,D!=null))return void sO(_,y,T,A,I);const z=w1(_.canvas.width,_.canvas.height),H=z.getContext("2d");sO(H,y,T,A,I),F&&U5(H,y,T,F),D&&$5(H,y,T,D,I),_.globalAlpha=A.opacity/255,_.drawImage(z,0,0)}(c,a,l,f.group,p),c.restore()):f.path&&(c.save(),function(_,y,T,A,I){_.setTransform(y),A.paint_order===Wne.PAINT_ORDER_FILL_AND_STROKE?(F5(_,T,A,I),N5(_,T,A,I)):(N5(_,T,A,I),F5(_,T,A,I))}(c,a,l,f.path,p),c.restore())}function F5(c,a,l,f){const p=l.fill;if(!p)return;const _=p.opacity/255;switch(c.save(),c.beginPath(),V5(l,c),p.paint){case"rgb_color":c.fillStyle=y_(p.rgb_color,p.opacity,f);break;case"linear_gradient_idx":{const y=a.linear_gradients[p.linear_gradient_idx];y.transform&&c.setTransform(v_(y.transform).preMultiplySelf(c.getTransform())),c.fillStyle=B5(c,y,_,f);break}case"radial_gradient_idx":{const y=a.radial_gradients[p.radial_gradient_idx];y.transform&&c.setTransform(v_(y.transform).preMultiplySelf(c.getTransform())),c.fillStyle=z5(c,y,_,f)}}c.fill(L5(l)),c.restore()}function L5(c){return c.rule===aO.PATH_RULE_NON_ZERO?"nonzero":c.rule===aO.PATH_RULE_EVEN_ODD?"evenodd":void 0}function N5(c,a,l,f){const p=l.stroke;if(!p)return;const _=W5(l);c.lineWidth=p.width,c.miterLimit=p.miterlimit,c.setLineDash(p.dasharray),c.lineDashOffset=p.dashoffset;const y=p.opacity/255;switch(p.paint){case"rgb_color":c.strokeStyle=y_(p.rgb_color,p.opacity,f);break;case"linear_gradient_idx":c.strokeStyle=B5(c,a.linear_gradients[p.linear_gradient_idx],y,f,!0);break;case"radial_gradient_idx":c.strokeStyle=z5(c,a.radial_gradients[p.radial_gradient_idx],y,f,!0)}switch(p.linejoin){case mS.LINE_JOIN_MITER_CLIP:case mS.LINE_JOIN_MITER:c.lineJoin="miter";break;case mS.LINE_JOIN_ROUND:c.lineJoin="round";break;case mS.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(p.linecap){case oO.LINE_CAP_BUTT:c.lineCap="butt";break;case oO.LINE_CAP_ROUND:c.lineCap="round";break;case oO.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(_)}function B5(c,a,l,f,p=!1){if(a.stops.length===1){const z=a.stops[0];return y_(z.rgb_color,z.opacity*l,f)}const{x1:_,y1:y,x2:T,y2:A}=a;let I=new DOMPoint(_,y),D=new DOMPoint(T,A);if(p){const z=v_(a.transform);I=z.transformPoint(I),D=z.transformPoint(D)}const F=c.createLinearGradient(I.x,I.y,D.x,D.y);for(const z of a.stops)F.addColorStop(z.offset,y_(z.rgb_color,z.opacity*l,f));return F}function z5(c,a,l,f,p=!1){if(a.stops.length===1){const ae=a.stops[0];return y_(ae.rgb_color,ae.opacity*l,f)}const _=v_(a.transform),{fx:y,fy:T,fr:A,cx:I,cy:D,r:F}=a;let z=new DOMPoint(y,T),H=new DOMPoint(I,D),q=A,ne=F;if(p){z=_.transformPoint(z),H=_.transformPoint(H);const ae=(_.a+_.d)/2;q=A*ae,ne=a.r*ae}const ie=c.createRadialGradient(z.x,z.y,q,H.x,H.y,ne);for(const ae of a.stops)ie.addColorStop(ae.offset,y_(ae.rgb_color,ae.opacity*l,f));return ie}function j5(c,a,l,f){const p=f.transform?v_(f.transform).preMultiplySelf(a):a,_=w1(c.canvas.width,c.canvas.height),y=_.getContext("2d");for(const A of f.children)if(A.group)j5(y,p,l,A.group);else if(A.path){const I=A.path,D=new Path2D;D.addPath(W5(I),p),y.fill(D,L5(I))}const T=f.clip_path_idx!=null?l.clip_paths[f.clip_path_idx]:null;T&&U5(y,p,l,T),c.globalCompositeOperation="source-over",c.drawImage(_,0,0)}function U5(c,a,l,f){const p=w1(c.canvas.width,c.canvas.height);j5(p.getContext("2d"),a,l,f),c.globalCompositeOperation="destination-in",c.drawImage(p,0,0)}function $5(c,a,l,f,p){if(f.children.length===0)return;const _=f.mask_idx!=null?l.masks[f.mask_idx]:null;_&&$5(c,a,l,_,p);const y=c.canvas.width,T=c.canvas.height,A=w1(y,T),I=A.getContext("2d"),D=f.width,F=f.height,z=f.left,H=f.top,q=new Path2D,ne=new Path2D;ne.rect(z,H,D,F),q.addPath(ne,a),I.clip(q);for(const me of f.children)D5(I,a,l,me,p);const ie=I.getImageData(0,0,y,T),ae=ie.data;if(f.mask_type===k5.MASK_TYPE_LUMINANCE)for(let me=0;me<ae.length;me+=4)ae[me+3]=ae[me+3]/255*(.2126*ae[me]+.7152*ae[me+1]+.0722*ae[me+2]);I.putImageData(ie,0,0),c.globalCompositeOperation="destination-in",c.drawImage(A,0,0)}function v_(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function V5(c,a){const l=c.step;let f=c.diffs[0]*l,p=c.diffs[1]*l;a.moveTo(f,p);for(let _=0,y=2;_<c.commands.length;_++)switch(c.commands[_]){case x1.PATH_COMMAND_MOVE:f+=c.diffs[y++]*l,p+=c.diffs[y++]*l,a.moveTo(f,p);break;case x1.PATH_COMMAND_LINE:f+=c.diffs[y++]*l,p+=c.diffs[y++]*l,a.lineTo(f,p);break;case x1.PATH_COMMAND_QUAD:{const T=f+c.diffs[y++]*l,A=p+c.diffs[y++]*l;f=T+c.diffs[y++]*l,p=A+c.diffs[y++]*l,a.quadraticCurveTo(T,A,f,p);break}case x1.PATH_COMMAND_CUBIC:{const T=f+c.diffs[y++]*l,A=p+c.diffs[y++]*l,I=T+c.diffs[y++]*l,D=A+c.diffs[y++]*l;f=I+c.diffs[y++]*l,p=D+c.diffs[y++]*l,a.bezierCurveTo(T,A,I,D,f,p);break}case x1.PATH_COMMAND_CLOSE:a.closePath()}return a}function W5(c){return V5(c,new Path2D)}class vS{constructor(a){this.capacity=a,this.cache=new Map}get(a){if(!this.cache.has(a))return;const l=this.cache.get(a);return this.cache.delete(a),this.cache.set(a,l),l}put(a,l){this.cache.has(a)?this.cache.delete(a):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(a,l)}delete(a){this.cache.delete(a)}}sr(vS,"LRUCache");class lO{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(a){return new fo(a,a.data)}getFromCache(a,l,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new vS(150)),this.cacheMap.get(f).get(_d(a.toString(),l))}setInCache(a,l,f,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new vS(150));const _=this.cacheDependenciesMap.get(p),y=_d(a.id.toString(),f);_.get(y)||_.set(y,new Set);const T=this.cacheMap.get(p),A=a.toString();_.get(y).add(A),T.put(_d(a.toString(),f),l)}removeImagesFromCacheByIds(a,l,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const p=this.cacheMap.get(f),_=this.cacheDependenciesMap.get(f);for(const y of a){const T=_d(y.toString(),l);if(_.has(T)){for(const A of _.get(T))p.delete(A);_.delete(T)}}}rasterize(a,l,f,p,_=cie){const y=this.getFromCache(a,f,p);if(y)return y.clone();const T=_(l.icon,a.options),A=lO._getImage(T);return this.setInCache(a,A,f,p),A.clone()}}class G5{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,l){const f=this.toIdx(a,l);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(a,l){return this.leaves[this.toIdx(a,l)]}toIdx(a,l){return l*this.size+a}}function H5(c,a,l,f){let p=0,_=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(f[y])<1e-15){if(l[y]<c[y]||l[y]>a[y])return null}else{const T=1/f[y];let A=(c[y]-l[y])*T,I=(a[y]-l[y])*T;if(A>I){const D=A;A=I,I=D}if(A>p&&(p=A),I<_&&(_=I),p>_)return null}return p}function q5(c,a,l,f,p,_,y,T,A,I,D){const F=f-c,z=p-a,H=_-l,q=y-c,ne=T-a,ie=A-l,ae=D[1]*ie-D[2]*ne,me=D[2]*q-D[0]*ie,ye=D[0]*ne-D[1]*q,we=F*ae+z*me+H*ye;if(Math.abs(we)<1e-15)return null;const Be=1/we,ze=I[0]-c,Ve=I[1]-a,Ze=I[2]-l,Ye=(ze*ae+Ve*me+Ze*ye)*Be;if(Ye<0||Ye>1)return null;const Ct=Ve*H-Ze*z,nt=Ze*F-ze*H,kt=ze*z-Ve*F,zt=(D[0]*Ct+D[1]*nt+D[2]*kt)*Be;return zt<0||Ye+zt>1?null:(q*Ct+ne*nt+ie*kt)*Be}function X5(c,a,l){return(c-a)/(l-a)}function Z5(c,a,l,f,p,_,y,T,A){const I=1<<l,D=_-f,F=y-p,z=(c+1)/I*D+f,H=(a+0)/I*F+p,q=(a+1)/I*F+p;T[0]=(c+0)/I*D+f,T[1]=H,A[0]=z,A[1]=q}class Y5{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(_){const y=Math.ceil(Math.log2(_.dim/8)),T=[];let A=Math.ceil(Math.pow(2,y));const I=1/A,D=(H,q,ne,ie,ae)=>{const me=ie?1:0,ye=(H+1)*ne-me,we=q*ne,Be=(q+1)*ne-me;ae[0]=H*ne,ae[1]=we,ae[2]=ye,ae[3]=Be};let F=new G5(A);const z=[];for(let H=0;H<A*A;H++){D(H%A,Math.floor(H/A),I,!1,z);const q=Rd(z[0],z[1],_),ne=Rd(z[2],z[1],_),ie=Rd(z[2],z[3],_),ae=Rd(z[0],z[3],_);F.minimums.push(Math.min(q,ne,ie,ae)),F.maximums.push(Math.max(q,ne,ie,ae)),F.leaves.push(1)}for(T.push(F),A/=2;A>=1;A/=2){const H=T[T.length-1];F=new G5(A);for(let q=0;q<A*A;q++){D(q%A,Math.floor(q/A),2,!0,z);const ne=H.getElevation(z[0],z[1]),ie=H.getElevation(z[2],z[1]),ae=H.getElevation(z[2],z[3]),me=H.getElevation(z[0],z[3]),ye=H.isLeaf(z[0],z[1]),we=H.isLeaf(z[2],z[1]),Be=H.isLeaf(z[2],z[3]),ze=H.isLeaf(z[0],z[3]),Ve=Math.min(ne.min,ie.min,ae.min,me.min),Ze=Math.max(ne.max,ie.max,ae.max,me.max),Ye=ye&&we&&Be&&ze;F.maximums.push(Ze),F.minimums.push(Ve),F.leaves.push(Ze-Ve<=5&&Ye?1:0)}T.push(F)}return T}(this.dem),f=l.length-1,p=l[f];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,f,0)}raycastRoot(a,l,f,p,_,y,T=1){return H5([a,l,-100],[f,p,this.maximums[0]*T],_,y)}raycast(a,l,f,p,_,y,T=1){if(!this.nodeCount)return null;const A=this.raycastRoot(a,l,f,p,_,y,T);if(A==null)return null;const I=[],D=[],F=[],z=[],H=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;H.length>0;){const{idx:q,t:ne,nodex:ie,nodey:ae,depth:me}=H.pop();if(this.leaves[q]){Z5(ie,ae,me,a,l,f,p,F,z);const we=1<<me,Be=(ie+0)/we,ze=(ie+1)/we,Ve=(ae+0)/we,Ze=(ae+1)/we,Ye=Rd(Be,Ve,this.dem)*T,Ct=Rd(ze,Ve,this.dem)*T,nt=Rd(ze,Ze,this.dem)*T,kt=Rd(Be,Ze,this.dem)*T,zt=q5(F[0],F[1],Ye,z[0],F[1],Ct,z[0],z[1],nt,_,y),Ot=q5(z[0],z[1],nt,F[0],z[1],kt,F[0],F[1],Ye,_,y),Lt=Math.min(zt!==null?zt:Number.MAX_VALUE,Ot!==null?Ot:Number.MAX_VALUE);if(Lt!==Number.MAX_VALUE)return Lt;{const $t=_e([],_,y,ne);if(K5(Ye,Ct,kt,nt,X5($t[0],F[0],z[0]),X5($t[1],F[1],z[1]))>=$t[2])return ne}continue}let ye=0;for(let we=0;we<this._siblingOffset.length;we++){Z5((ie<<1)+this._siblingOffset[we][0],(ae<<1)+this._siblingOffset[we][1],me+1,a,l,f,p,F,z),F[2]=-100,z[2]=this.maximums[this.childOffsets[q]+we]*T;const Be=H5(F,z,_,y);if(Be!=null){const ze=Be;I[we]=ze;let Ve=!1;for(let Ze=0;Ze<ye&&!Ve;Ze++)ze>=I[D[Ze]]&&(D.splice(Ze,0,we),Ve=!0);Ve||(D[ye]=we),ye++}}for(let we=0;we<ye;we++){const Be=D[we];H.push({idx:this.childOffsets[q]+Be,t:I[Be],nodex:(ie<<1)+this._siblingOffset[Be][0],nodey:(ae<<1)+this._siblingOffset[Be][1],depth:me+1})}}return null}_addNode(a,l,f){return this.minimums.push(a),this.maximums.push(l),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(a,l,f,p,_){if(a[p].isLeaf(l,f)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const y=p-1,T=a[y];let A=0,I=0;for(let D=0;D<this._siblingOffset.length;D++){const F=2*l+this._siblingOffset[D][0],z=2*f+this._siblingOffset[D][1],H=T.getElevation(F,z),q=T.isLeaf(F,z),ne=this._addNode(H.min,H.max,q);q&&(A|=1<<D),I||(I=ne)}for(let D=0;D<this._siblingOffset.length;D++)A&1<<D||this._construct(a,2*l+this._siblingOffset[D][0],2*f+this._siblingOffset[D][1],y,I+D)}}function K5(c,a,l,f,p,_){return Ir(Ir(c,l,_),Ir(a,f,_),p)}function Rd(c,a,l){const f=l.dim,p=Q(c*f-.5,0,f-1),_=Q(a*f-.5,0,f-1),y=Math.floor(p),T=Math.floor(_),A=Math.min(y+1,f-1),I=Math.min(T+1,f-1);return K5(l.get(y,T),l.get(A,T),l.get(y,I),l.get(A,I),p-y,_-T)}const uie={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function hie(c,a,l){return(256*c*256+256*a+l)/10-1e4}function fie(c,a,l){return 256*c+a+l/256-32768}class xS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,l,f,p=!1){if(this.uid=a,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void nr(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const _=this.dim=l.height-2,y=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let A=0;A<_;A++)y[this._idx(-1,A)]=y[this._idx(0,A)],y[this._idx(_,A)]=y[this._idx(_-1,A)],y[this._idx(A,-1)]=y[this._idx(A,0)],y[this._idx(A,_)]=y[this._idx(A,_-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(_,-1)]=y[this._idx(_-1,0)],y[this._idx(-1,_)]=y[this._idx(0,_-1)],y[this._idx(_,_)]=y[this._idx(_-1,_-1)]}const T=f==="terrarium"?fie:hie;for(let A=0;A<y.length;++A){const I=4*A;this.floatView[A]=T(this.pixels[I],this.pixels[I+1],this.pixels[I+2])}this._timestamp=tc.now()}_buildQuadTree(){this._tree=new Y5(this)}get(a,l,f=!1){f&&(a=Q(a,-1,this.dim),l=Q(l,-1,this.dim));const p=this._idx(a,l);return this.floatView[p]}set(a,l,f){const p=this._idx(a,l),_=this.floatView[p];return this.floatView[p]=f,f-_}static getUnpackVector(a){return uie[a]}_idx(a,l){if(a<-1||a>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(a+1)}static pack(a,l){const f=[0,0,0,0],p=xS.getUnpackVector(l);let _=Math.floor((a+p[3])/p[2]);return f[2]=_%256,_=Math.floor(_/256),f[1]=_%256,_=Math.floor(_/256),f[0]=_,f}getPixels(){return new WN({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,l,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,_=l*this.dim+this.dim,y=f*this.dim,T=f*this.dim+this.dim;switch(l){case-1:p=_-1;break;case 1:_=p+1}switch(f){case-1:y=T-1;break;case 1:T=y+1}const A=-l*this.dim,I=-f*this.dim;for(let D=y;D<T;D++)for(let F=p;F<_;F++){const z=4*this._idx(F,D),H=4*this._idx(F+A,D+I);this.pixels[z+0]=a.pixels[H+0],this.pixels[z+1]=a.pixels[H+1],this.pixels[z+2]=a.pixels[H+2],this.pixels[z+3]=a.pixels[H+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function die(c,a,l){c===1?a.headerLength=l.readFixed32():c===2?a.x=l.readVarint():c===3?a.y=l.readVarint():c===4?a.z=l.readVarint():c===5&&a.layers.push(function(f,p){return f.readFields(yie,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function pie(c,a,l){c===1?(a.delta_filter=function(f,p){return f.readFields(mie,{blockSize:0},p)}(l,l.readVarint()+l.pos),a.filter="delta_filter"):c===2?(l.readVarint(),a.filter="zigzag_filter"):c===3?(l.readVarint(),a.filter="bitshuffle_filter"):c===4&&(l.readVarint(),a.filter="byteshuffle_filter")}function mie(c,a,l){c===1&&(a.blockSize=l.readVarint())}function gie(c,a,l){c===1?(l.readVarint(),a.codec="gzip_data"):c===2?(l.readVarint(),a.codec="jpeg_image"):c===3?(l.readVarint(),a.codec="webp_image"):c===4&&(l.readVarint(),a.codec="png_image")}function _ie(c,a,l){let f=0,p=0;c===1?a.firstByte=l.readFixed64():c===2?a.lastByte=l.readFixed64():c===3?a.filters.push(function(_,y){return _.readFields(pie,{},y)}(l,l.readVarint()+l.pos)):c===4?a.codec=function(_,y){return _.readFields(gie,{},y)}(l,l.readVarint()+l.pos):c===5?p=l.readFloat():c===6?f=l.readFloat():c===7?a.bands.push(l.readString()):c===8?a.offset=l.readDouble():c===9&&(a.scale=l.readDouble()),a.offset===0&&(a.offset=p),a.scale===0&&(a.scale=f)}function yie(c,a,l){c===1?a.version=l.readVarint():c===2?a.name=l.readString():c===3?a.units=l.readString():c===4?a.tileSize=l.readVarint():c===5?a.buffer=l.readVarint():c===6?a.pixelFormat=l.readVarint():c===7&&a.dataIndex.push(function(f,p){return f.readFields(_ie,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function vie(c,a,l){if(c===2)(function(f,p,_){f.readFields(xie,_,p)})(l,l.readVarint()+l.pos,a);else if(c===3)throw new Error("Not implemented")}function xie(c,a,l){if(c===1){let f=0;const p=l.readVarint()+l.pos;for(;l.pos<p;)a[f++]=l.readVarint()}}function wie(c,a){if(a.length!==4)throw new Error(`Expected data of dimension 4 but got ${a.length}.`);let l=a[3];for(let f=2;f>=1;f--){const p=f===1?1:0,_=f===2?1:0;for(let y=0;y<a[0];y++){const T=a[1]*y;for(let A=p;A<a[1];A++){const I=a[2]*(A+T);for(let D=_;D<a[2];D++){const F=a[3]*(D+I);for(let z=0;z<a[3];z++){const H=F+z;c[H]+=c[H-l]}}}}l*=a[f]}return c}function bie(c){for(let a=0,l=c.length;a<l;a++)c[a]=c[a]>>>1^-(1&c[a]);return c}function Tie(c,a){switch(a){case"uint32":return c;case"uint16":for(let l=0;l<c.length;l+=2){const f=c[l],p=c[l+1];c[l]=(240&f)>>4|(61440&f)>>8|(240&p)<<4|61440&p,c[l+1]=15&f|(3840&f)>>4|(15&p)<<8|(3840&p)<<4}return c;case"uint8":for(let l=0;l<c.length;l+=4){const f=c[l],p=c[l+1],_=c[l+2],y=c[l+3];c[l+0]=(192&f)>>6|(192&p)>>4|(192&_)>>2|192&y,c[l+1]=(48&f)>>4|(48&p)>>2|48&_|(48&y)<<2,c[l+2]=(12&f)>>2|12&p|(12&_)<<2|(12&y)<<4,c[l+3]=3&f|(3&p)<<2|(3&_)<<4|(3&y)<<6}return c;default:throw new Error(`Invalid pixel format, "${a}"`)}}sr(xS,"DEMData"),sr(Y5,"DemMinMaxQuadTree",{omit:["dem"]});var Dl=Uint8Array,b1=Uint16Array,Sie=Int32Array,J5=new Dl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Q5=new Dl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Eie=new Dl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e6=function(c,a){for(var l=new b1(31),f=0;f<31;++f)l[f]=a+=1<<c[f-1];var p=new Sie(l[30]);for(f=1;f<30;++f)for(var _=l[f];_<l[f+1];++_)p[_]=_-l[f]<<5|f;return{b:l,r:p}},t6=e6(J5,2),r6=t6.b,Aie=t6.r;r6[28]=258,Aie[258]=28;for(var Cie=e6(Q5,0).b,n6=new b1(32768),Sa=0;Sa<32768;++Sa){var x_=(43690&Sa)>>1|(21845&Sa)<<1;n6[Sa]=((65280&(x_=(61680&(x_=(52428&x_)>>2|(13107&x_)<<2))>>4|(3855&x_)<<4))>>8|(255&x_)<<8)>>1}var T1=function(c,a,l){for(var f=c.length,p=0,_=new b1(a);p<f;++p)c[p]&&++_[c[p]-1];var y,T=new b1(a);for(p=1;p<a;++p)T[p]=T[p-1]+_[p-1]<<1;y=new b1(1<<a);var A=15-a;for(p=0;p<f;++p)if(c[p])for(var I=p<<4|c[p],D=a-c[p],F=T[c[p]-1]++<<D,z=F|(1<<D)-1;F<=z;++F)y[n6[F]>>A]=I;return y},S1=new Dl(288);for(Sa=0;Sa<144;++Sa)S1[Sa]=8;for(Sa=144;Sa<256;++Sa)S1[Sa]=9;for(Sa=256;Sa<280;++Sa)S1[Sa]=7;for(Sa=280;Sa<288;++Sa)S1[Sa]=8;var i6=new Dl(32);for(Sa=0;Sa<32;++Sa)i6[Sa]=5;var Pie=T1(S1,9),Iie=T1(i6,5),cO=function(c){for(var a=c[0],l=1;l<c.length;++l)c[l]>a&&(a=c[l]);return a},Jc=function(c,a,l){var f=a/8|0;return(c[f]|c[f+1]<<8)>>(7&a)&l},uO=function(c,a){var l=a/8|0;return(c[l]|c[l+1]<<8|c[l+2]<<16)>>(7&a)},kie=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qc=function(c,a,l){var f=new Error(a||kie[c]);if(f.code=c,Error.captureStackTrace&&Error.captureStackTrace(f,Qc),!l)throw f;return f},Oie=new Dl(0),Mie=typeof TextDecoder<"u"&&new TextDecoder;try{Mie.decode(Oie,{stream:!0})}catch{}const Rie={gzip_data:"gzip"};class hc extends Error{constructor(a){super(a),this.name="MRTError"}}const Die={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},a6={uint32:1,uint16:2,uint8:4},Fie={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let hO;class wS{constructor(a=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=a}getLayer(a){const l=this.layers[a];if(!l)throw new hc(`Layer '${a}' not found`);return l}getHeaderLength(a){const l=new Uint8Array(a),f=new DataView(a);if(l[0]!==13)throw new hc("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(a){const l=new Uint8Array(a),f=this.getHeaderLength(a);if(l.length<f)throw new hc(`Expected header with length >= ${f} but got buffer of length ${l.length}`);const p=new hO(l.subarray(0,f)).readFields(die,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new hc(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const _ of p.layers)this.layers[_.name]=new o6(_,{cacheSize:this._cacheSize});return this}createDecodingTask(a){const l=[],f=this.getLayer(a.layerName);for(let p of a.blockIndices){const _=f.dataIndex[p],y=_.firstByte-a.firstByte,T=_.lastByte-a.firstByte;if(f._blocksInProgress.has(p))continue;const A={layerName:f.name,firstByte:y,lastByte:T,pixelFormat:f.pixelFormat,blockIndex:p,blockShape:[_.bands.length].concat(f.bandShape),buffer:f.buffer,codec:_.codec.codec,filters:_.filters.map(I=>I.filter)};f._blocksInProgress.add(p),l.push(A)}return new s6(l,()=>{l.forEach(p=>f._blocksInProgress.delete(p.blockIndex))},(p,_)=>{if(l.forEach(y=>f._blocksInProgress.delete(y.blockIndex)),p)throw p;_.forEach(y=>{this.getLayer(y.layerName).processDecodedData(y)})})}}class o6{constructor({version:a,name:l,units:f,tileSize:p,pixelFormat:_,buffer:y,dataIndex:T},A){if(this.version=a,this.version!==1)throw new hc(`Cannot parse raster layer encoded with MRT version ${a}`);this.name=l,this.units=f,this.tileSize=p,this.buffer=y,this.pixelFormat=Die[_],this.dataIndex=T,this.bandShape=[p+2*y,p+2*y,a6[this.pixelFormat]],this._decodedBlocks=new vS(A?A.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return a6[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:a})=>a).flat()}processDecodedData(a){const l=a.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,a.data)}getBlockForBand(a){let l=0;switch(typeof a){case"string":for(const[f,p]of this.dataIndex.entries()){for(const[_,y]of p.bands.entries())if(y===a)return{bandIndex:l+_,blockIndex:f,blockBandIndex:_};l+=p.bands.length}break;case"number":for(const[f,p]of this.dataIndex.entries()){if(a>=l&&a<l+p.bands.length)return{bandIndex:a,blockIndex:f,blockBandIndex:a-l};l+=p.bands.length}break;default:throw new hc(`Invalid band \`${JSON.stringify(a)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(a){let l=1/0,f=-1/0;const p=[],_=new Set;for(const y of a){const{blockIndex:T}=this.getBlockForBand(y);if(T<0)throw new hc(`Invalid band: ${JSON.stringify(y)}`);const A=this.dataIndex[T];p.includes(T)||p.push(T),_.add(T),l=Math.min(l,A.firstByte),f=Math.max(f,A.lastByte)}if(_.size>this.cacheSize)throw new hc(`Number of blocks to decode (${_.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:f,blockIndices:p}}hasBand(a){const{blockIndex:l}=this.getBlockForBand(a);return l>=0}hasDataForBand(a){const{blockIndex:l}=this.getBlockForBand(a);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(a){const{blockIndex:l,blockBandIndex:f}=this.getBlockForBand(a);if(l<0)throw new hc(`Band not found: ${JSON.stringify(a)}`);const p=this._decodedBlocks.get(l.toString());if(!p)throw new hc(`Data for band ${JSON.stringify(a)} of layer "${this.name}" not decoded.`);const _=this.dataIndex[l],y=this.bandShape.reduce((I,D)=>I*D,1),T=f*y,A=p.subarray(T,T+y);return{data:A,bytes:new Uint8Array(A.buffer).subarray(A.byteOffset,A.byteOffset+A.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:_.offset,scale:_.scale}}}wS.setPbf=function(c){hO=c};class s6{constructor(a,l,f){this.tasks=a,this._onCancel=l,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(a,l){this._finalized||(this._onComplete(a,l),this._finalized=!0)}}wS.performDecoding=function(c,a){const l=new Uint8Array(c);return Promise.all(a.tasks.map(f=>{const{layerName:p,firstByte:_,lastByte:y,pixelFormat:T,blockShape:A,blockIndex:I,filters:D,codec:F}=f,z=l.subarray(_,y+1),H=new Uint32Array(A[0]*A[1]*A[2]);let q;if(F!=="gzip_data")throw new hc(`Unhandled codec: ${F}`);return q=function(ne,ie){if(!globalThis.DecompressionStream&&ie==="gzip_data")return Promise.resolve(((we=function(Ve){Ve[0]==31&&Ve[1]==139&&Ve[2]==8||Qc(6,"invalid gzip data");var Ze=Ve[3],Ye=10;4&Ze&&(Ye+=2+(Ve[10]|Ve[11]<<8));for(var Ct=(Ze>>3&1)+(Ze>>4&1);Ct>0;Ct-=!Ve[Ye++]);return Ye+(2&Ze)}(ye=ne))+8>ye.length&&Qc(6,"invalid gzip data"),function(Ve,Ze,Ye,Ct){var nt=Ve.length;if(!nt||Ze.f&&!Ze.l)return Ye||new Dl(0);var kt=!Ye,zt=kt||Ze.i!=2,Ot=Ze.i;kt&&(Ye=new Dl(3*nt));var Lt,$t,Et=function(ri){var ni=Ye.length;if(ri>ni){var qn=new Dl(Math.max(2*ni,ri));qn.set(Ye),Ye=qn}},Nt=Ze.f||0,gt=Ze.p||0,ut=Ze.b||0,Vt=Ze.l,jt=Ze.d,br=Ze.m,ir=Ze.n,dr=8*nt;do{if(!Vt){Nt=Jc(Ve,gt,1);var qt=Jc(Ve,gt+1,3);if(gt+=3,!qt){var xr=Ve[(Ae=4+((gt+7)/8|0))-4]|Ve[Ae-3]<<8,jr=Ae+xr;if(jr>nt){Ot&&Qc(0);break}zt&&Et(ut+xr),Ye.set(Ve.subarray(Ae,jr),ut),Ze.b=ut+=xr,Ze.p=gt=8*jr,Ze.f=Nt;continue}if(qt==1)Vt=Pie,jt=Iie,br=9,ir=5;else if(qt==2){var Qt=Jc(Ve,gt,31)+257,gr=Jc(Ve,gt+10,15)+4,Or=Qt+Jc(Ve,gt+5,31)+1;gt+=14;for(var Vr=new Dl(Or),rn=new Dl(19),Gr=0;Gr<gr;++Gr)rn[Eie[Gr]]=Jc(Ve,gt+3*Gr,7);gt+=3*gr;var hr=cO(rn),Wr=(1<<hr)-1,dn=T1(rn,hr);for(Gr=0;Gr<Or;){var Ae,Ce=dn[Jc(Ve,gt,Wr)];if(gt+=15&Ce,(Ae=Ce>>4)<16)Vr[Gr++]=Ae;else{var dt=0,At=0;for(Ae==16?(At=3+Jc(Ve,gt,3),gt+=2,dt=Vr[Gr-1]):Ae==17?(At=3+Jc(Ve,gt,7),gt+=3):Ae==18&&(At=11+Jc(Ve,gt,127),gt+=7);At--;)Vr[Gr++]=dt}}var Jt=Vr.subarray(0,Qt),Kt=Vr.subarray(Qt);br=cO(Jt),ir=cO(Kt),Vt=T1(Jt,br),jt=T1(Kt,ir)}else Qc(1);if(gt>dr){Ot&&Qc(0);break}}zt&&Et(ut+131072);for(var lr=(1<<br)-1,Er=(1<<ir)-1,nn=gt;;nn=gt){var on=(dt=Vt[uO(Ve,gt)&lr])>>4;if((gt+=15&dt)>dr){Ot&&Qc(0);break}if(dt||Qc(2),on<256)Ye[ut++]=on;else{if(on==256){nn=gt,Vt=null;break}var tn=on-254;on>264&&(tn=Jc(Ve,gt,(1<<(en=J5[Gr=on-257]))-1)+r6[Gr],gt+=en);var Fn=jt[uO(Ve,gt)&Er],mi=Fn>>4;if(Fn||Qc(3),gt+=15&Fn,Kt=Cie[mi],mi>3){var en=Q5[mi];Kt+=uO(Ve,gt)&(1<<en)-1,gt+=en}if(gt>dr){Ot&&Qc(0);break}zt&&Et(ut+131072);var Jn=ut+tn;if(ut<Kt){var Bn=0-Kt,bn=Math.min(Kt,Jn);for(Bn+ut<0&&Qc(3);ut<bn;++ut)Ye[ut]=(void 0)[Bn+ut]}for(;ut<Jn;++ut)Ye[ut]=Ye[ut-Kt]}}Ze.l=Vt,Ze.p=nn,Ze.b=ut,Ze.f=Nt,Vt&&(Nt=1,Ze.m=br,Ze.d=jt,Ze.n=ir)}while(!Nt);return ut!=Ye.length&&kt?(Lt=Ye,(($t=ut)==null||$t>Lt.length)&&($t=Lt.length),new Dl(Lt.subarray(0,$t))):Ye.subarray(0,ut)}(ye.subarray(we,-8),{i:2},new Dl(((ae=ye)[(me=ae.length)-4]|ae[me-3]<<8|ae[me-2]<<16|ae[me-1]<<24)>>>0))));var ae,me,ye,we;const Be=Rie[ie];if(!Be)throw new Error(`Unhandled codec: ${ie}`);const ze=new globalThis.DecompressionStream(Be);return new Response(new Blob([ne]).stream().pipeThrough(ze)).arrayBuffer().then(Ve=>new Uint8Array(Ve))}(z,F).then(ne=>(function(ie,ae){ie.readFields(vie,ae)}(new hO(ne),H),new Fie[T](H.buffer))),q.then(ne=>{for(let ie=D.length-1;ie>=0;ie--)switch(D[ie]){case"delta_filter":wie(ne,A);break;case"zigzag_filter":bie(ne);break;case"bitshuffle_filter":Tie(ne,T);break;default:throw new hc(`Unhandled filter "${D[ie]}"`)}return{layerName:p,blockIndex:I,data:ne}}).catch(ne=>{throw ne})}))},sr(s6,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),sr(wS,"MapboxRasterTile"),sr(o6,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class l6{constructor(a){this._stringToNumber={},this._numberToString=[];for(let l=0;l<a.length;l++){const f=a[l];this._stringToNumber[f]=l,this._numberToString[l]=f}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const Lie=["id","tile","layer","source","sourceLayer","state"];class w_{constructor(a,l,f,p,_){this.type="Feature",this._vectorTileFeature=a,this._z=l,this._x=f,this._y=p,this.properties=a.properties,this.id=_}clone(){const a=new w_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(a.state=Object.assign({},this.state)),this.layer&&(a.layer=Object.assign({},this.layer)),this.source&&(a.source=this.source),this.sourceLayer&&(a.sourceLayer=this.sourceLayer),a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of Lie)this[l]!==void 0&&(a[l]=this[l]);return a}}class c6{constructor(a,l){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new qh(Zt,16,0),this.featureIndexArray=new bT,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(a,l,f,p,_,y=0,T=0){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,p,_,y);const I=this.grid;for(let D=0;D<l.length;D++){const F=l[D],z=[1/0,1/0,-1/0,-1/0];for(let H=0;H<F.length;H++){const q=F[H];z[0]=Math.min(z[0],q.x),z[1]=Math.min(z[1],q.y),z[2]=Math.max(z[2],q.x),z[3]=Math.max(z[3],q.y)}T!==0&&(z[0]-=T,z[1]-=T,z[2]+=T,z[3]+=T),z[0]<Zt&&z[1]<Zt&&z[2]>=0&&z[3]>=0&&I.insert(A,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new zr(new ZT(this.rawTileData)).layers,this.sourceLayerCoder=new l6(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,l){const{tilespaceGeometry:f,transform:p,tileTransform:_,pixelPosMatrix:y,availableImages:T,worldview:A}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const I=f.bufferedTilespaceBounds,D=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,(q,ne,ie,ae)=>qi(f.bufferedTilespaceGeometry,q,ne,ie,ae));D.sort(Nie);let F=null;p.elevation&&D.length>0&&(F=__.create(p.elevation,this.tileID));const z={};let H;for(let q=0;q<D.length;q++){const ne=D[q];if(ne===H)continue;H=ne;const ie=this.featureIndexArray.get(ne);let ae=null;this.is3DTile?this.loadMatchingModelFeature(z,ie,a,f,p,A):this.loadMatchingFeature(z,ie,a,T,A,(me,ye,we,Be=0)=>(ae||(ae=tr(me,this.tileID.canonical,_)),ye.queryIntersectsFeature(f,me,we,ae,this.z,p,y,F,Be)))}return z}loadMatchingFeature(a,l,f,p,_,y){const{featureIndex:T,bucketIndex:A,sourceLayerIndex:I,layoutVertexArrayOffset:D}=l,F=this.bucketLayerIDs[A],z=f.layers,H=Object.keys(z);if(H.length&&!Xt(H,F))return;const q=f.sourceCache,ne=this.sourceLayerCoder.decode(I),ie=this.vtLayers[ne].feature(T),ae=this.getId(ie,ne);for(let me=0;me<F.length;me++){const ye=F[me];if(!z[ye])continue;const{styleLayer:we,targets:Be}=z[ye];let ze={};ae!==void 0&&(ze=q.getFeatureState(we.sourceLayer,ae));const Ve=!y||y(ie,we,ze,D);if(!Ve)continue;const Ze=new w_(ie,this.z,this.x,this.y,ae);Ze.tile=this.tileID.canonical,Ze.state=ze;let Ye=this.serializedLayersCache.get(ye);Ye||(Ye=we.serialize(),Ye.id=ye,this.serializedLayersCache.set(ye,Ye)),Ze.source=Ye.source,Ze.sourceLayer=Ye["source-layer"],Ze.layer=Object.assign({},Ye),Ze.layer.paint=u6(Ye.paint,we.paint,ie,ze,p),Ze.layer.layout=u6(Ye.layout,we.layout,ie,ze,p);let Ct=!1;for(const nt of Be){this.updateFeatureProperties(Ze,nt);const{filter:kt}=nt;if(kt){if(ie.properties=Ze.properties,kt.needGeometry){const zt=Ut(ie,!0);if(!kt.filter(new Kn(this.tileID.overscaledZ,{worldview:_}),zt,this.tileID.canonical))continue}else if(!kt.filter(new Kn(this.tileID.overscaledZ,{worldview:_}),ie))continue}Ct=!0,nt.targetId&&this.addFeatureVariant(Ze,nt)}Ct&&this.appendToResult(a,ye,T,Ze,Ve)}}loadMatchingModelFeature(a,l,f,p,_,y){const{featureIndex:T,bucketIndex:A}=l,I=this.bucketLayerIDs[A],D=f.layers,F=Object.keys(D);if(!F.length||Xt(F,I))for(let z=0;z<I.length;z++){const H=I[z],{styleLayer:q,targets:ne}=D[H];if(q.type!=="model")continue;const ie=p.tile,ae=ie.getBucket(q);if(!(ae&&ae instanceof pS))continue;const me=$ne(ae,T,p,_);if(!me)continue;const{z:ye,x:we,y:Be}=ie.tileID.canonical,{feature:ze,intersectionZ:Ve,position:Ze}=me;let Ye={};ze.id!==void 0&&(Ye=f.sourceCache.getFeatureState(q.sourceLayer,ze.id));const Ct=new w_({},ye,we,Be,ze.id);Ct.tile=this.tileID.canonical,Ct.state=Ye,Ct.properties=ze.properties,Ct.geometry={type:"Point",coordinates:[Ze.lng,Ze.lat]};let nt=this.serializedLayersCache.get(H);nt||(nt=q.serialize(),nt.id=H,this.serializedLayersCache.set(H,nt)),Ct.source=nt.source,Ct.sourceLayer=nt["source-layer"],Ct.layer=Object.assign({},nt);let kt=!1;for(const zt of ne){this.updateFeatureProperties(Ct,zt);const{filter:Ot}=zt;if(Ot){if(ze.properties=Ct.properties,Ot.needGeometry){if(!Ot.filter(new Kn(this.tileID.overscaledZ,{worldview:y}),ze,this.tileID.canonical))continue}else if(!Ot.filter(new Kn(this.tileID.overscaledZ,{worldview:y}),ze))continue}kt=!0,zt.targetId&&this.addFeatureVariant(Ct,zt)}kt&&this.appendToResult(a,H,T,Ct,Ve)}}updateFeatureProperties(a,l,f){if(l.properties){const p={};for(const _ in l.properties){const y=l.properties[_].evaluate({zoom:this.z},a._vectorTileFeature,a.state,a.tile,f);y!=null&&(p[_]=y)}a.properties=p}}addFeatureVariant(a,l,f){const p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=a.properties),a.variants=a.variants||{},a.variants[l.targetId]=a.variants[l.targetId]||[],a.variants[l.targetId].push(p)}appendToResult(a,l,f,p,_){let y=a[l];y===void 0&&(y=a[l]=[]),y.push({featureIndex:f,feature:p,intersectionZ:_})}lookupSymbolFeatures(a,l,f,p,_,y){const T={};this.loadVTLayers();for(const A of a)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:f,featureIndex:A,layoutVertexArrayOffset:0},p,_,y);return T}loadFeature(a){const{featureIndex:l,sourceLayerIndex:f}=a;this.loadVTLayers();const p=this.sourceLayerCoder.decode(f),_=this.vtFeatures[p];if(_[l])return _[l];const y=this.vtLayers[p].feature(l);return _[l]=y,y}hasLayer(a){for(const l of this.bucketLayerIDs)for(const f of l)if(a===f)return!0;return!1}getId(a,l){let f=a.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const _=ic(p);if(_.result!=="success"){const y=_.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void nr(`Failed to create expression for promoteId: ${y}`)}this.promoteIdExpression=_.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new $c),f=this.promoteIdExpression.evaluate({zoom:0},a)}else f=a.properties[p];typeof f=="boolean"&&(f=Number(f))}return f}}function u6(c,a,l,f,p){return mt(c,(_,y)=>{const T=a instanceof Jh?a.get(y):null;return T&&T.evaluate?T.evaluate(l,f,void 0,p):T})}function Nie(c,a){return a-c}sr(c6,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const h6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class fO{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,f]=new Uint8Array(a,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=f>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const _=h6[15&f];if(!_)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(a,2,1),[T]=new Uint32Array(a,4,1);return new fO(T,y,_,a)}constructor(a,l=64,f=Float64Array,p){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const _=h6.indexOf(this.ArrayType),y=2*a*this.ArrayType.BYTES_PER_ELEMENT,T=a*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${f}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+T+A,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+y+T+A),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+T+A,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=a)}add(a,l){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=l,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return dO(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,l,f,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:y,nodeSize:T}=this,A=[0,_.length-1,0],I=[];for(;A.length;){const D=A.pop()||0,F=A.pop()||0,z=A.pop()||0;if(F-z<=T){for(let ie=z;ie<=F;ie++){const ae=y[2*ie],me=y[2*ie+1];ae>=a&&ae<=f&&me>=l&&me<=p&&I.push(_[ie])}continue}const H=z+F>>1,q=y[2*H],ne=y[2*H+1];q>=a&&q<=f&&ne>=l&&ne<=p&&I.push(_[H]),(D===0?a<=q:l<=ne)&&(A.push(z),A.push(H-1),A.push(1-D)),(D===0?f>=q:p>=ne)&&(A.push(H+1),A.push(F),A.push(1-D))}return I}within(a,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:y}=this,T=[0,p.length-1,0],A=[],I=f*f;for(;T.length;){const D=T.pop()||0,F=T.pop()||0,z=T.pop()||0;if(F-z<=y){for(let ie=z;ie<=F;ie++)d6(_[2*ie],_[2*ie+1],a,l)<=I&&A.push(p[ie]);continue}const H=z+F>>1,q=_[2*H],ne=_[2*H+1];d6(q,ne,a,l)<=I&&A.push(p[H]),(D===0?a-f<=q:l-f<=ne)&&(T.push(z),T.push(H-1),T.push(1-D)),(D===0?a+f>=q:l+f>=ne)&&(T.push(H+1),T.push(F),T.push(1-D))}return A}}function dO(c,a,l,f,p,_){if(p-f<=l)return;const y=f+p>>1;f6(c,a,y,f,p,_),dO(c,a,l,f,y-1,1-_),dO(c,a,l,y+1,p,1-_)}function f6(c,a,l,f,p,_){for(;p>f;){if(p-f>600){const I=p-f+1,D=l-f+1,F=Math.log(I),z=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*z*(I-z)/I)*(D-I/2<0?-1:1);f6(c,a,l,Math.max(f,Math.floor(l-D*z/I+H)),Math.min(p,Math.floor(l+(I-D)*z/I+H)),_)}const y=a[2*l+_];let T=f,A=p;for(E1(c,a,f,l),a[2*p+_]>y&&E1(c,a,f,p);T<A;){for(E1(c,a,T,A),T++,A--;a[2*T+_]<y;)T++;for(;a[2*A+_]>y;)A--}a[2*f+_]===y?E1(c,a,f,A):(A++,E1(c,a,A,p)),A<=l&&(f=A+1),l<=A&&(p=A-1)}}function E1(c,a,l,f){pO(c,l,f),pO(a,2*l,2*f),pO(a,2*l+1,2*f+1)}function pO(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}function d6(c,a,l,f){const p=c-l,_=a-f;return p*p+_*_}i.$=Gv,i.A=Cl,i.B=_d,i.C=2,i.D=s_,i.E=Lh,i.F=h1,i.G=Bz,i.H=Wv,i.I=zs,i.J=$g,i.K=Lr,i.L=nm,i.M=Og,i.N=kg,i.O=_x,i.P=Pt,i.Q=vx,i.R=Z0,i.S=Qh,i.T=Ck,i.U=ic,i.V=dS,i.W=xx,i.X=cd,i.Y=ld,i.Z=yg,i._=Uo,i.a=function(c){return Ao.API_CDN_URL_REGEX.test(c)},i.a$=Re,i.a0=rm,i.a1=jv,i.a2=Vg,i.a3=class extends dS{},i.a4=Mg,i.a5=gx,i.a6=rt,i.a7=function(c){const a=c.value;return a?rm(a)?tO(a,!0)?[]:[new dS(c.key,a,`invalid url "${a}"`)]:[new dS(c.key,a,`string expected, "${Lr(a)}" found`)]:[]},i.a8=oT,i.a9=Ii,i.aA=Q,i.aB=V,i.aC=Yn,i.aD=m,i.aE=Na,i.aF=Ee,i.aG=lt,i.aH=function(c,a){const l={};for(let f=0;f<a.length;f++){const p=a[f];p in c&&(l[p]=c[p])}return l},i.aI=ce,i.aJ=De,i.aK=class{constructor(c){this.entries={},this.scheduler=c}request(c,a,l,f){const p=this.entries[c]=this.entries[c]||{callbacks:[]};if(p.result){const[_,y]=p.result;return this.scheduler?this.scheduler.add(()=>{f(_,y)},a):f(_,y),()=>{}}return p.callbacks.push(f),p.cancel||(p.cancel=l((_,y)=>{p.result=[_,y];for(const T of p.callbacks)this.scheduler?this.scheduler.add(()=>{T(_,y)},a):T(_,y);setTimeout(()=>delete this.entries[c],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(_=>_!==f),p.callbacks.length||(p.cancel(),delete this.entries[c]))}}},i.aL=function(c,a,l){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},p=>{const _=Yf(c.request,(y,T,A,I)=>{y?p(y):T&&p(null,{vectorTile:l?void 0:new zr(new ZT(T)),rawData:T,cacheControl:A,expires:I})});return()=>{_.cancel(),p()}},a)},i.aM=function(c){Ou++,Ou>Uc&&(c.getActor().send("enforceCacheSizeLimit",Tl),Ou=0)},i.aN=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log2(c)))},i.aO=Wo,i.aP=d5,i.aQ=v5,i.aR=te,i.aS=f5,i.aT=function(c,a){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){a(null,l)};for(let f=0;f<c.length;f++){const p=document.createElement("source");k2(c[f])||(l.crossOrigin="Anonymous"),p.src=c[f],l.appendChild(p)}return{cancel:()=>{}}},i.aU=a1,i.aV=function(c){return fetch(c).then(a=>a.arrayBuffer()).then(a=>VB(a,0,c))},i.aW=KB,i.aX=class{constructor(c,a,l,f){this.id=c,this.position=a!=null?new te(a[0],a[1]):new te(0,0),this.orientation=l??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new Rr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,a){if(V(c.matrix,a,c.matrix),c.meshes)for(const l of c.meshes){const f=Rr.applyTransformFast(l.aabb,c.matrix);this.aabb.encapsulate(f)}if(c.children)for(const l of c.children)this._applyTransformations(l,c.matrix)}computeBoundsAndApplyParent(){const c=R([]);for(const a of this.nodes)this._applyTransformations(a,c)}computeModelMatrix(c,a,l,f,p,_,y=!1){ZB(this.matrix,this,c.transform,this.position,a,l,f,p,_,y)}upload(c){if(!this.uploaded){for(const a of this.nodes)kk(a,c);for(const a of this.nodes)XT(a);this.uploaded=!0}}destroy(){for(const c of this.nodes)Ok(c)}},i.aY=wt,i.aZ=p1,i.a_=Fe,i.aa=Wt,i.ab=class{constructor(c){this.specification=c}possiblyEvaluate(c,a){return Kr(c.expression.evaluate(a))}interpolate(c,a,l){return{x:Ir(c.x,a.x,l),y:Ir(c.y,a.y,l),z:Ir(c.z,a.z,l),azimuthal:Ir(c.azimuthal,a.azimuthal,l),polar:Ir(c.polar,a.polar,l)}}},i.ac=Kn,i.ad=Uu,i.ae=_t,i.af=Mt,i.ag=tt,i.ah=pe,i.ai=Jh,i.aj=Ad,i.ak=Ir,i.al=Zt,i.am=$v,i.an=Qe,i.ao=On,i.ap=class{constructor(c){this.specification=c}possiblyEvaluate(c,a){return function([l,f]){const p=Kr([1,l,f]);return{x:p.x,y:p.y,z:p.z}}(c.expression.evaluate(a))}interpolate(c,a,l){return{x:Ir(c.x,a.x,l),y:Ir(c.y,a.y,l),z:Ir(c.z,a.z,l)}}},i.aq=function(c,a,l=0,f=!0){const p=new Pt(l,l),_=c.sub(p),y=a.add(p),T=[_,new Pt(y.x,_.y),y,new Pt(_.x,y.y)];return f&&T.push(_.clone()),T},i.ar=function(c,a){const l=[];for(let f=0;f<c.length;f++){const p=le(f-1,-1,c.length-1),_=le(f+1,-1,c.length-1),y=c[f],T=c[_],A=c[p].sub(y).unit(),I=T.sub(y).unit(),D=I.angleWithSep(A.x,A.y),F=A.add(I).unit().mult(-1*a/Math.sin(D/2));l.push(y.add(F))}return l},i.as=Jz,i.at=qi,i.au=function(c,a,l=0){return Je(((a.x-l)*c.scale-c.x)*Zt,(a.y*c.scale-c.y)*Zt,Oe(a.z,a.y))},i.av=Br,i.aw=yt,i.ax=wn,i.ay=cz,i.az=function(c){let a=1/0,l=1/0,f=-1/0,p=-1/0;for(const _ of c)a=Math.min(a,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),p=Math.max(p,_.y);return{min:new Pt(a,l),max:new Pt(f,p)}},i.b=function(c){return Ao.API_FONTS_REGEX.test(c)},i.b$=mk,i.b0=tf,i.b1=Ta,i.b2=Te,i.b3=zx,i.b4=cS,i.b5=function(){ac.isLoading()||ac.isLoaded()||Ug()!=="deferred"||Xh()},i.b6=pm,i.b7=Ut,i.b8=w_,i.b9=Hr,i.bA=R,i.bB=K,i.bC=L,i.bD=function(c,a){const{x:l,y:f}=c.point,p=ON(l,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return V(p,p,rk(Ju(a)))},i.bE=S,i.bF=un,i.bG=function(c,a){var l=a[0]-c[0],f=a[1]-c[1],p=a[2]-c[2];return Math.sqrt(l*l+f*f+p*p)},i.bH=_e,i.bI=Yt,i.bJ=Dt,i.bK=u1,i.bL=qs,i.bM=$k,i.bN=function(c,a,l,f,p){const _=5*a+2;c.float32[_+0]=l,c.float32[_+1]=f,c.float32[_+2]=p},i.bO=lS,i.bP=Gi,i.bQ=uo,i.bR=ba,i.bS=To,i.bT=le,i.bU=function(c,a,l,f){var p=new w(4);return p[0]=c,p[1]=a,p[2]=l,p[3]=f,p},i.bV=UT,i.bW=Ws,i.bX=Xa,i.bY=lB,i.bZ=x5,i.b_=fB,i.ba=Fk,i.bb=fk,i.bc=tr,i.bd=Hu,i.be=Jg,i.bf=EN,i.bg=Ti,i.bh=a_,i.bi=Qk,i.bj=function(c,a){const l=Ad(a.zoom);if(l===0)return Ju(c);const f=kT(c),p=tk(f),_=Ee(f.getWest())*a.worldSize,y=Ee(f.getEast())*a.worldSize,T=De(f.getNorth())*a.worldSize,A=De(f.getSouth())*a.worldSize,I=[_,T,0],D=[y,T,0],F=[_,A,0],z=[y,A,0],H=N([],a.globeMatrix);return Mt(I,I,H),Mt(D,D,H),Mt(F,F,H),Mt(z,z,H),p[0]=of(p[0],F,l),p[1]=of(p[1],z,l),p[2]=of(p[2],D,l),p[3]=of(p[3],I,l),Rr.fromPoints(p)},i.bk=MT,i.bl=N,i.bm=Vx,i.bn=of,i.bo=ef,i.bp=hte,i.bq=re,i.br=G,i.bs=wS,i.bt=ZT,i.bu=Yf,i.bv=function(c,a){const l=[];for(const f in c)f in a||l.push(f);return l},i.bw=fe,i.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.by=si,i.bz=function(c){var a=new w(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},i.c=I2,i.c$=function(c){return c*c*c*c*c},i.c0=Uk,i.c1=Gz,i.c2=Hk,i.c3=fO,i.c4=Rt,i.c5=Tr,i.c6=Di,i.c7=function(c,a,l){l*=.5;var f=a[0],p=a[1],_=a[2],y=a[3],T=Math.sin(l),A=Math.cos(l);return c[0]=f*A+p*T,c[1]=p*A-f*T,c[2]=_*A+y*T,c[3]=y*A-_*T,c},i.c8=ra,i.c9=li,i.cA=Qr,i.cB=GB,i.cC=Zc,i.cD=PN,i.cE=function(c,a,l,f,p,_,y,T,A){if(A.name==="globe")return PN(c,a,new Zc(l,f,p),!1);const I=p1({z:l,x:f,y:p},A);return new Rr([(_+I.x/I.scale)*a,a*(I.y/I.scale),y],[(_+I.x2/I.scale)*a,a*(I.y2/I.scale),T])},i.cF=function(c,a,l){return c[0]=Math.min(a[0],l[0]),c[1]=Math.min(a[1],l[1]),c[2]=Math.min(a[2],l[2]),c[3]=Math.min(a[3],l[3]),c},i.cG=function(c,a,l){return c[0]=Math.max(a[0],l[0]),c[1]=Math.max(a[1],l[1]),c[2]=Math.max(a[2],l[2]),c[3]=Math.max(a[3],l[3]),c},i.cH=function(c){const a=Math.round((c+45+360)%360/90)%4;return he[a]},i.cI=Le,i.cJ=Un,i.cK=b,i.cL=function(c){const a=R(new Float64Array(16));V(a,c.pixelMatrix,c.globeMatrix);const l=[0,B,0],f=[0,j,0];return Mt(l,l,a),Mt(f,f,a),[l[0]>0&&l[0]<=c.width&&l[1]>0&&l[1]<=c.height&&!ik(c,new te(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!ik(c,new te(c.center.lat,-90))]},i.cM=function(c,a){const{scale:l}=c.tileTransform,f=l*Zt/(c.tileSize*Math.pow(2,a.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return function(p,_,y){var T=_[1],A=_[2],I=_[3],D=y[0],F=y[1];return p[0]=_[0]*D,p[1]=T*D,p[2]=A*F,p[3]=I*F,p}(new Float32Array(4),a.inverseAdjustmentMatrix,[f,f])},i.cN=HT,i.cO=$e,i.cP=WB,i.cQ=function(c){const a=WB(c,!0);return S([],[a[0],a[1],a[4],a[5]])},i.cR=U,i.cS=Cn,i.cT=J,i.cU=function(c){const{x:a,y:l}=c.point,{lng:f,lat:p}=c._center;return ON(a,l,c.worldSize,f,p)},i.cV=ft,i.cW=se,i.cX=i_,i.cY=ho,i.cZ=x,i.c_=function(c,a,l){let f=0;for(let p=0;p<2;++p)c[p]>0&&(f+=(c[p]-0)*(c[p]-0)),a[p]<0&&(f+=(0-a[p])*(0-a[p]));return f},i.ca=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},i.cb=ve,i.cc=function(c,a,l,f,p){var _=1/Math.tan(a/2);if(c[0]=_/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=_,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,p!=null&&p!==1/0){var y=1/(f-p);c[10]=(p+f)*y,c[14]=2*p*f*y}else c[10]=-1,c[14]=-2*f;return c},i.cd=function(c,a,l,f,p,_,y){var T=1/(a-l),A=1/(f-p),I=1/(_-y);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*A,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*I,c[11]=0,c[12]=(a+l)*T,c[13]=(p+f)*A,c[14]=(y+_)*I,c[15]=1,c},i.ce=Me,i.cf=function(c,a,l){c[4*a+0]=l[0],c[4*a+1]=l[1],c[4*a+2]=l[2],c[4*a+3]=l[3]},i.cg=bm,i.ch=Tm,i.ci=Hi,i.cj=sc,i.ck=Em,i.cl=n5,i.cm=function(){var c=new w(4);return w!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},i.cn=function(c,a,l){var f=a[0],p=a[1],_=a[2],y=a[3],T=Math.sin(l),A=Math.cos(l);return c[0]=f*A+_*T,c[1]=p*A+y*T,c[2]=f*-T+_*A,c[3]=p*-T+y*A,c},i.co=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},i.cp=kr,i.cq=function(c){var a=c[0],l=c[1],f=c[2],p=c[3];return Math.sqrt(a*a+l*l+f*f+p*p)},i.cr=Da,i.cs=Ne,i.ct=n_,i.cu=3,i.cv=2,i.cw=7,i.cx=6,i.cy=St,i.cz=Ie,i.d=function(c){return Ao.API_TILEJSON_REGEX.test(c)},i.d$=dz,i.d0=xe,i.d1=45,i.d2=Sm,i.d3=function(c,a,l){const f=Math.sqrt(c*c+a*a+l*l),p=f>0?Math.acos(l/f)*Ha:0;let _=c!==0||a!==0?Math.atan2(-a,-c)*Ha+90:0;return _<0&&(_+=360),[f,_,p]},i.d4=Je,i.d5=Kr,i.d6=st,i.d7=at,i.d8=Rr,i.d9=pt,i.dA=function(c,a,l){const f=Ad(l.zoom),p=c.style.map._antialias,_=c.terrain&&c.terrain.exaggeration()>0;return f===0&&!p&&!_},i.dB=function(c){const a=c.pixelsPerMeter,l=a/Me(1,c.center.lat),f=R(new Float64Array(16));return G(f,f,[c.point.x,c.point.y,0]),U(f,f,[l,l,a]),Float32Array.from(f)},i.dC=kT,i.dD=function(c){const a=Le-5;c=Q(c,-a,a)/a*90;const l=Math.pow(Math.abs(Math.sin(Qe(c))),3);return Math.round(l*(M.length-1))},i.dE=function(c,a,l,f){const p=a.getNorth(),_=a.getSouth(),y=a.getWest(),T=a.getEast(),A=1<<c.z,I=T-y,D=p-_,F=I/P,z=-D/M[l],H=[0,F,0,z,0,0,p,y,0];if(c.z>0){const q=180/f;O(H,H,[q/I+1,0,0,0,q/D+1,0,-.5*q/F,.5*q/z,1])}return H[2]=A,H[5]=c.x,H[8]=c.y,H},i.dF=Ju,i.dG=function(c,a,l){const f=R(new Float64Array(16)),p=(a/(1<<c)-.5)*Math.PI*2;return Z(f,l.globeMatrix,p),Float32Array.from(f)},i.dH=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const l=a.getSource().maxzoom,f=1<<l,p=Math.floor(c.x),_=Math.floor((c.x-p)*f),y=Math.floor(c.y*f),T=this.findDEMTileFor(new Wo(l,p,l,_,y));return!(!T||!T.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,l=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const f=this._source();if(!f||c.y<0||c.y>1)return a;const p=f.getSource().maxzoom,_=1<<p,y=Math.floor(c.x),T=c.x-y,A=new Wo(p,y,p,Math.floor(T*_),Math.floor(c.y*_)),I=this.findDEMTileFor(A);if(!I||!I.dem)return a;const D=I.dem,F=1<<I.tileID.canonical.z,z=(T*F-I.tileID.canonical.x)*D.dim,H=(c.y*F-I.tileID.canonical.y)*D.dim,q=Math.floor(z),ne=Math.floor(H);return(l?this.exaggeration():1)*Ir(Ir(D.get(q,ne),D.get(q,ne+1),H-ne),Ir(D.get(q+1,ne),D.get(q+1,ne+1),H-ne),z-q)}getAtTileOffset(c,a,l){const f=1<<c.canonical.z;return this.getAtPointOrZero(new _t(c.wrap+(c.canonical.x+a/Zt)/f,(c.canonical.y+l/Zt)/f))}getAtTileOffsetFunc(c,a,l,f){return p=>{const _=this.getAtTileOffset(c,p.x,p.y),y=f.upVector(c.canonical,p.x,p.y);return Rt(y,y,_*f.upVectorScale(c.canonical,a,l).metersToTile),y}}getForTilePoints(c,a,l,f){if(this.isUsingMockSource())return!1;const p=__.create(this,c,f);return!!p&&(a.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],l)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const l=a.dem.tree,f=a.tileID,p=1<<c.canonical.z-f.canonical.z;let _=c.canonical.x/p-f.canonical.x,y=c.canonical.y/p-f.canonical.y,T=0;for(let A=0;A<c.canonical.z-f.canonical.z&&!l.leaves[T];A++){_*=2,y*=2;const I=2*Math.floor(y)+Math.floor(_);T=l.childOffsets[T]+I,_%=1,y%=1}return{min:this.exaggeration()*l.minimums[T],max:this.exaggeration()*l.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,l){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let a=!1,l=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const p of c){const _=this.getMinMaxForTile(p.tileID);_&&(l=Math.min(l,_.min),f=Math.max(f,_.max),a=!0)}return a?{min:l,max:f}:null}},i.dI=WN,i.dJ=IT,i.dK=function(c,a){return[Math.pow(c[0],2.2)*a,Math.pow(c[1],2.2)*a,Math.pow(c[2],2.2)*a]},i.dL=C,i.dM=function(c,a){var l=Math.sin(a),f=Math.cos(a);return c[0]=f,c[1]=l,c[2]=0,c[3]=-l,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},i.dN=Sr,i.dO=kN,i.dP=da,i.dQ=Eo,i.dR=256,i.dS=function(c,a){const l=[0,0,0];return Mt(l,l,MT(Ju(a.canonical))),Mt(l,l,c),l},i.dT=c=>({u_matrix:new Em(c),u_texsize:new sc(c),u_pixels_to_tile_units:new r_(c),u_device_pixel_ratio:new Hi(c),u_width_scale:new Hi(c),u_floor_width_scale:new Hi(c),u_image:new bm(c),u_units_to_pixels:new sc(c),u_tile_units_to_pixels:new Hi(c),u_alpha_discard_threshold:new Hi(c),u_trim_offset:new sc(c),u_trim_fade_range:new sc(c),u_trim_color:new Sm(c),u_emissive_strength:new Hi(c),u_zbias_factor:new Hi(c),u_tile_to_meter:new Hi(c),u_ground_shadow_factor:new Tm(c),u_pattern_transition:new Hi(c)}),i.dU=c=>({u_matrix:new Em(c),u_pixels_to_tile_units:new r_(c),u_device_pixel_ratio:new Hi(c),u_width_scale:new Hi(c),u_floor_width_scale:new Hi(c),u_units_to_pixels:new sc(c),u_dash_image:new bm(c),u_gradient_image:new bm(c),u_image_height:new Hi(c),u_texsize:new sc(c),u_tile_units_to_pixels:new Hi(c),u_alpha_discard_threshold:new Hi(c),u_trim_offset:new sc(c),u_trim_fade_range:new sc(c),u_trim_color:new Sm(c),u_emissive_strength:new Hi(c),u_zbias_factor:new Hi(c),u_tile_to_meter:new Hi(c),u_ground_shadow_factor:new Tm(c)}),i.dV=c=>({u_camera_to_center_distance:new Hi(c),u_extrude_scale:new r_(c),u_device_pixel_ratio:new Hi(c),u_matrix:new Em(c),u_inv_rot_matrix:new Em(c),u_merc_center:new sc(c),u_tile_id:new Tm(c),u_zoom_transition:new Hi(c),u_up_dir:new Tm(c),u_emissive_strength:new Hi(c)}),i.dW=Dx,i.dX=Yre,i.dY=class{constructor(c,a,l,f){this.context=c,this.format=f,this.size=l,this.texture=c.gl.createTexture();const[p,_,y]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in a&&a.data&&T.texImage3D(T.TEXTURE_3D,0,this.format,p,_,y,0,Ek(this.format),Ak(this.format),a.data)}bind(c,a){const{context:l}=this,{gl:f}=l;f.bindTexture(f.TEXTURE_3D,this.texture),c!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,c),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,c),this.minFilter=c),a!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,a),this.wrapS=a)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},i.dZ=DN,i.d_=(c,a,l,f,p,_)=>{const y=c.transform,T=y.projection.name==="globe";let A;if(_.paint.get("circle-pitch-alignment")==="map")if(T){const D=kN(y.zoom,a.canonical)*y._pixelsPerMercatorPixel;A=Float32Array.from([D,0,0,D])}else A=y.calculatePixelsToTileUnitsMatrix(l);else A=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const I={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(y.projection),u_matrix:c.translatePosMatrix(a.projMatrix,l,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:tc.devicePixelRatio,u_extrude_scale:A,u_inv_rot_matrix:gte,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:_.paint.get("circle-emissive-strength")};if(T){I.u_inv_rot_matrix=f,I.u_merc_center=p,I.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],I.u_zoom_transition=Ad(y.zoom);const D=p[0]*Zt,F=p[1]*Zt;I.u_up_dir=y.projection.upVector(new Zc(0,0,0),D,F)}return I},i.da=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},i.db=tO,i.dc=function(c,a){return c.readFields(Gne,{icons:[]},a)},i.dd=$T,i.de=p_,i.df=Wk,i.dg=Y0,i.dh=aT,i.di=q0,i.dj=Q0,i.dk=xt,i.dl=function(c){const a=c.indexOf(mm);return a>=0?c.slice(0,a):c},i.dm=function(c){return c.indexOf(mm)>=0},i.dn=function(c){const a=c.lastIndexOf(mm);return a>=0?c.slice(a+1):""},i.dp=function(c){const a=[],l=c.id;return l===void 0&&a.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),a},i.dq=function(c,a,l,f){return c.type==="custom"?new zne(c,a):new Vne[c.type](c,a,l,f)},i.dr=bt,i.ds=function(c){const a=c.indexOf(mm);return a>=0?c.slice(a+1):""},i.dt=class extends w_{constructor(c,a){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=a.target,this.namespace=a.namespace,a.properties&&(this.properties=a.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},i.du=Ex,i.dv=mn,i.dw=function(c){return c({pluginStatus:$o,pluginURL:Wu}),Ex.on("pluginStateChange",c),c},i.dx=AT,i.dy=class extends oc{constructor(c){super(c),this.current=JI}set(c,a,l){if(this.fetchUniformLocation(c,a)){for(let f=0;f<9;f++)if(l[f]!==this.current[f]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},i.dz=Pe,i.e=Ao,i.e$=function(){const c=r1;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(xk),r1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.e0=ts,i.e1=(c,a,l,f,p,_,y,T,A,I)=>{const D=c.transform,F=D.pitch<15?uz(.07,.7,Q((14-D.zoom)/5,0,1)):.07,z=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:fz(c,a,l,f),u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:p,u_width_scale:_,u_floor_width_scale:y,u_image:0,u_tile_units_to_pixels:hz(a,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(z?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:st(a.tileID.canonical,0),u_ground_shadow_factor:A,u_pattern_transition:I}},i.e2=(c,a,l,f,p,_,y,T,A,I)=>{const D=c.transform,F=D.calculatePixelsToTileUnitsMatrix(a),z=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",H=D.pitch<15?uz(.07,.7,Q((14-D.zoom)/5,0,1)):.07;return{u_matrix:fz(c,a,l,f),u_pixels_to_tile_units:F,u_device_pixel_ratio:_,u_width_scale:y,u_floor_width_scale:T,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:pz(l)&&a.lineAtlasTexture?a.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:hz(a,c.transform),u_alpha_discard_threshold:0,u_trim_offset:A,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(z?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:H,u_tile_to_meter:st(a.tileID.canonical,0),u_ground_shadow_factor:I}},i.e3=ot,i.e4=Wx,i.e5=Oe,i.e6=cte,i.e7=jT,i.e8=SB,i.e9=Pd,i.eA=ma,i.eB=bd,i.eC=function(c,a,l,f,p,_,y,T,A,I,D,F,z,H,q,ne){var ie=new w(16);return ie[0]=c,ie[1]=a,ie[2]=l,ie[3]=f,ie[4]=p,ie[5]=_,ie[6]=y,ie[7]=T,ie[8]=A,ie[9]=I,ie[10]=D,ie[11]=F,ie[12]=z,ie[13]=H,ie[14]=q,ie[15]=ne,ie},i.eD=Y,i.eE=ym,i.eF=Yg,i.eG=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Pt(1/0,1/0),max:new Pt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,a=!1){const l=uB(new Pt(0,0),new Pt(Zt,Zt),c),f=[];if(a&&!dk(l,this._globalClipBounds))return f;for(const p of this._activeRegions){if(p.hiddenByOverlap||!dk(l,p))continue;const _=Wte(p.min,p.max,c);f.push({min:_.min,max:_.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return f}setSources(c){this._setSources(c.map(a=>({getSourceId:()=>a.cache.id,getFootprints:()=>{const l=[];for(const f of a.cache.getVisibleCoordinates()){const p=a.cache.getTile(f).buckets[a.layer];p&&p.updateFootprints(f.toUnwrapped(),l)}return l},getOrder:()=>a.order,getClipMask:()=>a.clipMask,getClipScope:()=>a.clipScope})))}_addSource(c){const a=c.getFootprints();if(a.length===0)return;const l=c.getOrder(),f=c.getClipMask(),p=c.getClipScope();for(const _ of a){if(!_.footprint)continue;const y=uB(_.footprint.min,_.footprint.max,_.id);this._activeRegions.push({min:y.min,max:y.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:_.id,footprint:_.footprint,order:l,clipMask:f,clipScope:p})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((a,l)=>a.priority-l.priority||NT(a.min,l.min)||NT(a.max,l.max)||a.order-l.order||a.clipMask-l.clipMask||function(f,p){const _=(y,T)=>y+T;return f.length-p.length||f.reduce(_,"").localeCompare(p.reduce(_,""))}(a.clipScope,l.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let a=0;for(;!c&&a!==this._activeRegions.length;){const l=this._activeRegions[a],f=this._prevRegions[a];c=l.priority!==f.priority||!cB(l,f)||l.order!==f.order||l.clipMask!==f.clipMask||!si(l.clipScope,f.clipScope),++a}}if(c){++this._updateTime;for(const l of this._activeRegions)l.order!==Yx&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const a=l=>{const f=this._activeRegions;if(l>=f.length)return l;const p=f[l].priority;for(;l<f.length&&f[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,f=a(l);for(;l!==f;){let p=l;const _=l;for(;p!==f;){const y=this._activeRegions[p];y.hiddenByOverlap=!1;for(let T=0;T<_;T++){const A=this._activeRegions[T];if(!A.hiddenByOverlap&&y.order===Yx&&dk(y,A)&&(y.hiddenByOverlap=hB(y.footprint,y.tileId,A.footprint,A.tileId),y.hiddenByOverlap))break}++p}l=f,f=a(l)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let a=c.length-1;a>=0;a--)this._addSource(c[a]);this._computeReplacement()}},i.eH=Yx,i.eI=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,a){const l=new Hu,f=new Ta,p=[],_=c+1+2,y=a[0]+1,T=a[0]+1+(1+a.length),A=(I,D,F)=>{let z=I===_-1?I-2:I===0?I:I-1;return z+=F?24575:0,[z,D]};for(let I=0;I<_;++I)l.emplaceBack(...A(I,0,!0));for(let I=0;I<y;++I)for(let D=0;D<_;++D)l.emplaceBack(...A(D,I,(D===0||D===_-1)&&!0));for(let I=0;I<a.length;++I){const D=a[I];for(let F=0;F<_;++F)l.emplaceBack(...A(F,D,!0))}for(let I=0;I<a.length;++I){const D=f.length,F=a[I]+1+2,z=new Ta;for(let ne=0;ne<F-1;ne++){const ie=ne===F-2,ae=ie?_*(T-a.length+I-ne):_;for(let me=0;me<_-1;me++){const ye=ne*_+me;ne===0||ie||me===0||me===_-2?(z.emplaceBack(ye+1,ye,ye+ae),z.emplaceBack(ye+ae,ye+ae+1,ye+1)):(f.emplaceBack(ye+1,ye,ye+ae),f.emplaceBack(ye+ae,ye+ae+1,ye+1))}}const H=Ti.simpleSegment(0,D,l.length,f.length-D);for(let ne=0;ne<z.uint16.length;ne+=3)f.emplaceBack(z.uint16[ne],z.uint16[ne+1],z.uint16[ne+2]);const q=Ti.simpleSegment(0,D,l.length,f.length-D);p.push({withoutSkirts:H,withSkirts:q})}return{vertices:l,indices:f,segments:p}}_createGrid(c){const a=this._fillGridMeshWithLods(P,M);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,EN.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new Ta;for(let y=0;y<=P;y++)a.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const l=new rf,f=new rf,p=new rf,_=new rf;this._poleSegments=[];for(let y=0,T=0;y<x;y++){const A=360/(1<<y);l.emplaceBack(0,-m,0,.5,0),f.emplaceBack(0,-m,0,.5,1),p.emplaceBack(0,-m,0,.5,.5),_.emplaceBack(0,-m,0,.5,.5);for(let I=0;I<=P;I++){let D=I/P,F=0;const z=Ir(0,A,D),[H,q,ne]=X(pte,mte,z,m);l.emplaceBack(H,q,ne,D,F),f.emplaceBack(H,q,ne,D,1-F);const ie=Qe(z);D=.5+.5*Math.sin(ie),F=.5+.5*Math.cos(ie),p.emplaceBack(H,q,ne,D,F),_.emplaceBack(H,q,ne,D,1-F)}this._poleSegments.push(Ti.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(l,PT,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,PT,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(p,PT,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(_,PT,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,a){return[a?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,a?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},i.eJ=sB,i.eK=We,i.eL=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.eM=je,i.eN=vt,i.eO=function(c,a,l){return c[0]=a[0]/l[0],c[1]=a[1]/l[1],c[2]=a[2]/l[2],c},i.eP=Yr,i.eQ=W,i.eR=qe,i.eS=et,i.eT=function([c,a,l]){const f=Math.hypot(c,a,l),p=Math.atan2(c,l),_=.5*Math.PI-Math.acos(-a/f);return new te(se(p),se(_))},i.eU=Wi,i.eV=Pk,i.eW=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!function(l){if(En==null){const f=l.navigator?l.navigator.userAgent:null;En=!!l.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return En}(c)&&!(!a||!(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eX=function(c,a){Tl=c,Uc=a},i.eY=ik,i.eZ=MN,i.e_=function(c){const a=[0,0,0],l=R(new Float64Array(16));return V(l,c.pixelMatrix,c.globeMatrix),Mt(a,a,l),new Pt(a[0],a[1])},i.ea=450,i.eb=7,i.ec=Ke,i.ed=function(c,a){if(c===a){var l=a[1],f=a[2],p=a[3],_=a[6],y=a[7],T=a[11];c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=l,c[6]=a[9],c[7]=a[13],c[8]=f,c[9]=_,c[11]=a[14],c[12]=p,c[13]=y,c[14]=T}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c},i.ee=Bne,i.ef=fn,i.eg=Sd,i.eh=256,i.ei=rk,i.ej=ns,i.ek=Z,i.el=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},i.em=rf,i.en=Nx,i.eo=fx,i.ep=function(c,a,l,f,p){return Q((c-a)/(l-a)*(p-f)+f,f,p)},i.eq=Ra,i.er=function(c,a){var l=a[0],f=a[1],p=a[2],_=a[3],y=a[4],T=a[5],A=a[6],I=a[7],D=a[8],F=D*y-T*I,z=-D*_+T*A,H=I*_-y*A,q=l*F+f*z+p*H;return q?(c[0]=F*(q=1/q),c[1]=(-D*f+p*I)*q,c[2]=(T*f-p*y)*q,c[3]=z*q,c[4]=(D*l-p*A)*q,c[5]=(-T*l+p*_)*q,c[6]=H*q,c[7]=(-I*l+f*A)*q,c[8]=(y*l-f*_)*q,c):null},i.es=2,i.et=Xe,i.eu=Ik,i.ev=[1,1,1],i.ew=__,i.ex=jn,i.ey=function(c,a,l,f){var p=a[0],_=a[1],y=a[2],T=a[3];return c[0]=p+f*(l[0]-p),c[1]=_+f*(l[1]-_),c[2]=y+f*(l[2]-y),c[3]=T+f*(l[3]-T),c},i.ez=h_,i.f=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(a,l)=>String.fromCharCode(+("0x"+l))))},i.f0=function(){$T().acquire(xk)},i.f1=Ug,i.f2=function(c,a,l=!1){if($o===ds.deferred||$o===ds.loading||$o===ds.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Wu=tc.resolveURL(c),$o=ds.deferred,Tx=a,Sx(),l||Xh()},i.f3=function(c){l_=tc.resolveURL(c),c_||(c_=new s_($T(),new Lh)),c_.broadcast("setMeshoptUrl",l_)},i.f4=NB,i.f5=function(c){bk=tc.resolveURL(c),c_||(c_=new s_($T(),new Lh)),c_.broadcast("setDracoUrl",bk)},i.f6=LB,i.f7=t1,i.f8=function(c){const a=Fv();if(!a)return;const l=a.delete(Ls);c&&l.then(()=>c()).catch(c)},i.f9=Im,i.fA=function(c){Hp(),zo!=null&&zo.then(a=>{a.keys().then(l=>{for(let f=0;f<l.length-c;f++)a.delete(l[f]).catch(p=>nr(p.message))}).catch(l=>nr(l.message))}).catch(a=>nr(a.message))},i.fa=sr,i.fb=Cd,i.fc=Kc,i.fd=l6,i.fe=c6,i.ff=oz,i.fg=Jr,i.fh="hd_road_elevation",i.fi=vi,i.fj=mt,i.fk=sf,i.fl=Vk,i.fm=Mm,i.fn=function(c,a,l,f,p,_,y,T=1,A,I,D){c.createArrays(),c.tilePixelRatio=Zt/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const F=c.layers[0].layout,z=c.layers[0]._unevaluatedLayout._values,H={};H.scaleFactor=T,H.textSizeScaleRange=F.get("text-size-scale-range"),H.iconSizeScaleRange=F.get("icon-size-scale-range");const[q,ne]=H.textSizeScaleRange,[ie,ae]=H.iconSizeScaleRange;H.textScaleFactor=Q(H.scaleFactor,q,ne),H.iconScaleFactor=Q(H.scaleFactor,ie,ae);const me=z["text-size"],ye=z["icon-size"];if(c.textSizeData.kind==="composite"){const{minZoom:Ye,maxZoom:Ct}=c.textSizeData;H.compositeTextSizes=[me.possiblyEvaluate(new Kn(Ye,{worldview:D}),_),me.possiblyEvaluate(new Kn(Ct,{worldview:D}),_)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Ye,maxZoom:Ct}=c.iconSizeData;H.compositeIconSizes=[ye.possiblyEvaluate(new Kn(Ye,{worldview:D}),_),ye.possiblyEvaluate(new Kn(Ct,{worldview:D}),_)]}H.layoutTextSize=me.possiblyEvaluate(new Kn(y+1,{worldview:D}),_),H.layoutIconSize=ye.possiblyEvaluate(new Kn(y+1,{worldview:D}),_),H.textMaxSize=me.possiblyEvaluate(new Kn(18,{worldview:D}),_);const we=F.get("symbol-placement"),Be=F.get("text-rotation-alignment")==="map"&&we!=="point",ze=F.get("text-size");let Ve=!1;const Ze=[];for(const Ye of c.features){const Ct=F.get("text-font").evaluate(Ye,{},_).join(","),nt=ze.evaluate(Ye,{},_)*H.textScaleFactor,kt=H.layoutTextSize.evaluate(Ye,{},_)*H.textScaleFactor,zt=H.layoutIconSize.evaluate(Ye,{},_)*H.iconScaleFactor,Ot={horizontal:{},vertical:void 0},Lt=Ye.text;let $t,Et=[0,0];if(Lt){const gr=Lt.toString(),Or=F.get("text-letter-spacing").evaluate(Ye,{},_)*Xa,Vr=F.get("text-line-height").evaluate(Ye,{},_)*Xa,rn=nT(gr)?Or:0,Gr=F.get("text-anchor").evaluate(Ye,{},_),hr=F.get("text-variable-anchor");if(!hr){const dt=F.get("text-radial-offset").evaluate(Ye,{},_);if(dt)Et=Gz(Gr,[dt*Xa,Gk]);else{const At=F.get("text-offset").evaluate(Ye,{},_);Et=[At[0]*Xa,At[1]*Xa]}}let Wr=Be?"center":F.get("text-justify").evaluate(Ye,{},_);const dn=we==="point",Ae=dn?F.get("text-max-width").evaluate(Ye,{},_)*Xa:1/0,Ce=dt=>{c.allowVerticalPlacement&&bx(gr)&&(Ot.vertical=jk(Lt,a,l,p,Ct,Ae,Vr,Gr,dt,rn,Et,qs.vertical,!0,kt,nt,A))};if(!Be&&hr){const dt=Wr==="auto"?hr.map(Jt=>Hk(Jt)):[Wr];let At=!1;for(let Jt=0;Jt<dt.length;Jt++){const Kt=dt[Jt];if(!Ot.horizontal[Kt])if(At)Ot.horizontal[Kt]=Ot.horizontal[0];else{const lr=jk(Lt,a,l,p,Ct,Ae,Vr,"center",Kt,rn,Et,qs.horizontal,!1,kt,nt,A);lr&&(Ot.horizontal[Kt]=lr,At=lr.positionedLines.length===1)}}Ce("left")}else{if(Wr==="auto"&&(Wr=Hk(Gr)),dn||F.get("text-writing-mode").indexOf("horizontal")>=0||!bx(gr)){const dt=jk(Lt,a,l,p,Ct,Ae,Vr,Gr,Wr,rn,Et,qs.horizontal,!1,kt,nt,A);dt&&(Ot.horizontal[Wr]=dt)}Ce(dn?"left":Wr)}}let Nt,gt,ut,Vt,jt,br,ir=!1;const dr=F.get("icon-text-fit").evaluate(Ye,{},_);if(Ye.icon&&Ye.icon.hasPrimary()){const gr=qz(Ye.icon,c.iconSizeData,z["icon-size"],_,c.zoom,Ye,A,H.iconScaleFactor,D);Nt=gr.iconPrimary,ut=gr.iconSecondary;const Or=Nt.toString();if(gt=f.get(Or),gt&&(jt=F.get("icon-offset").evaluate(Ye,{},_),br=F.get("icon-anchor").evaluate(Ye,{},_),$t=pne(p.get(Or),ut?p.get(ut.toString()):void 0,jt,br),ir=gt.sdf,c.sdfIcons===void 0?c.sdfIcons=gt.sdf:c.sdfIcons!==gt.sdf&&nr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(gt.pixelRatio!==c.pixelRatio||F.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0)),ut){const Vr=ut.toString();Vt=f.get(Vr)}}Ve=Ve||!(!Ye.icon||!Ye.icon.hasSecondary());const qt=qk(Ot.horizontal)||Ot.vertical;c.iconsInText||(c.iconsInText=!!qt&&qt.iconsInText);const xr=kt*H.textScaleFactor/Xa,{defaultShapedIcon:jr,verticallyShapedIcon:Qt}=Sne(c,$t,F,Ye,_,Ot,xr,jt,dr);dr!=="none"&&$t&&(Iz($t)||kz($t))&&(eS(0,gt,Nt,$t,jr,dr,I,f,p),eS(0,Vt,ut,$t,jr,dr,I,f,p),Qt&&(eS(0,gt,Nt,$t,Qt,dr,I,f,p),eS(0,Vt,ut,$t,Qt,dr,I,f,p))),$t=jr,Ze.push({feature:Ye,shapedTextOrientations:Ot,shapedText:qt,shapedIcon:$t,iconPrimary:Nt,iconSecondary:ut,iconOffset:jt,iconAnchor:br,verticallyShapedIcon:Qt,layoutTextSize:kt,layoutIconSize:zt,textOffset:Et,isSDFIcon:ir,iconTextFit:dr})}return{featureData:Ze,sizes:H,hasAnySecondaryIcon:Ve,textAlongLine:Be,symbolPlacement:we}},i.fo=zz,i.fp=function(c,a,l,f,p,_,y,T,A,I){const{featureData:D,hasAnySecondaryIcon:F,sizes:z,textAlongLine:H,symbolPlacement:q}=a;for(const ne of D){const{shapedIcon:ie,verticallyShapedIcon:ae,feature:me,shapedTextOrientations:ye,shapedText:we,layoutTextSize:Be,textOffset:ze,isSDFIcon:Ve,iconPrimary:Ze,iconSecondary:Ye,iconTextFit:Ct,iconOffset:nt}=ne;Xz(ie,I.iconPositions,Ze,Ye),Xz(ae,I.iconPositions,Ze,Ye),Tne(ye,I.iconPositions),bne(Ze,Ye,I.iconPositions),(we||ie)&&Ene(c,me,ye,ie,ae,A,z,Be,0,ze,Ve,f,p,y,T,F,Ct,nt,H,q)}l&&c.generateCollisionDebugBuffers(_,c.collisionBoxArray,z.textScaleFactor)},i.fq=zr,i.fr=xS,i.fs=Bt,i.ft=function(c){let a=0;if(new Uint32Array(c,0,1)[0]!==zB){const l=new Uint32Array(c,0,7),[,,f,p,_,y]=l;a=l.byteLength+p+_+y+_,(f!==c.byteLength||a>=c.byteLength)&&nr("Invalid b3dm header information.")}return VB(c,a)},i.fu=function(c,a){const l=KB(c);for(const f of l){for(const p of f.meshes)wre(p);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(bre(f.lights,a)))}return l},i.fv=pS,i.fw=an,i.fx=DB,i.fy=ac,i.fz=ds,i.g=function(c,a){return mn(Object.assign(c,{method:"GET"}),a)},i.h=function(c){return c.indexOf("mapbox:")===0},i.i=function(c){return Ao.API_STYLE_REGEX.test(c)&&!I2(c)},i.j=Hf,i.k=qp,i.l=function(c){return decodeURIComponent(atob(c).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.m=function(c,a){return mn(Object.assign(c,{type:"json"}),a)},i.n=Kf,i.o=tc,i.p=function(c,a){return mn(Object.assign(c,{method:"POST"}),a)},i.q=fo,i.r=Rv,i.s=function(c){try{const a=self[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=function(){return wk||(wk=new Im),wk},i.u=function(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},i.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},i.w=nr,i.x=lO,i.y=Yp,i.z=El}),u(["./shared"],function(i){function v(Qe){const se=Qe?Qe.url.toString():void 0;return se?performance.getEntriesByName(se):[]}function w(Qe){if(typeof Qe=="number"||typeof Qe=="boolean"||typeof Qe=="string"||Qe==null)return JSON.stringify(Qe);if(Array.isArray(Qe)){let he="[";for(const Pe of Qe)he+=`${w(Pe)},`;return`${he}]`}let se="{";for(const he of Object.keys(Qe).sort())se+=`${he}:${w(Qe[he])},`;return`${se}}`}function S(Qe){let se="";for(const he of i.bx)se+=`/${w(Qe[he])}`;return se}class C{constructor(se){this.keyCache={},this._layers={},this._layerConfigs={},se&&this.replace(se)}replace(se,he){this._layerConfigs={},this._layers={},this.update(se,[],he)}update(se,he,Pe){this._options=Pe;for(const je of se)this._layerConfigs[je.id]=je,(this._layers[je.id]=i.dq(je,this.scope,null,this._options)).compileFilter(Pe),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of he)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const We=function(je,Q){const pe={};for(let fe=0;fe<je.length;fe++){const Se=je[fe];let Te=Q&&Q[Se.id];Te||(Se.type==="symbol"?Te=Se.id:(Te=S(Se),Se.type==="line"&&Se.paint&&function wt(mt){return typeof mt=="string"&&mt==="line-progress"||(Array.isArray(mt)?mt.some(wt):!(!mt||typeof mt!="object")&&Object.values(mt).some(wt))}(Se.paint["line-width"])&&(Te+=`/${w(Se.paint["line-width"])}`))),Q&&(Q[Se.id]=Te);let ot=pe[Te];ot||(ot=pe[Te]=[]),ot.push(Se)}const le=[];for(const fe in pe)le.push(pe[fe]);return le}(Object.values(this._layerConfigs),this.keyCache);for(const je of We){const Q=je.map(ot=>this._layers[ot.id]),pe=Q[0];if(pe.visibility==="none")continue;const le=pe.source||"";let fe=this.familiesBySource[le];fe||(fe=this.familiesBySource[le]={});const Se=pe.sourceLayer||"_geojsonTileLayer";let Te=fe[Se];Te||(Te=fe[Se]=[]),Te.push(Q)}}}const k=1*i.fc;class O{constructor(se){const he={},Pe=[];for(const pe in se){const le=se[pe],fe=he[pe]={};for(const Se in le.glyphs){const Te=le.glyphs[+Se];if(!Te||Te.bitmap.width===0||Te.bitmap.height===0)continue;const ot=Te.metrics.localGlyph?k:1,wt={x:0,y:0,w:Te.bitmap.width+2*ot,h:Te.bitmap.height+2*ot};Pe.push(wt),fe[Se]=wt}}const{w:We,h:je}=i.G(Pe),Q=new i.fb({width:We||1,height:je||1});for(const pe in se){const le=se[pe];for(const fe in le.glyphs){const Se=le.glyphs[+fe];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const Te=he[pe][fe],ot=Se.metrics.localGlyph?k:1;i.fb.copy(Se.bitmap,Q,{x:0,y:0},{x:Te.x+ot,y:Te.y+ot},Se.bitmap)}}this.image=Q,this.positions=he}}i.fa(O,"GlyphAtlas");class L{constructor(se){this.tileID=new i.aO(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.tileZoom=se.tileZoom,this.uid=se.uid,this.zoom=se.zoom,this.lut=se.lut,this.canonical=se.tileID.canonical,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.scope=se.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.request&&se.request.collectResourceTiming,this.promoteId=se.promoteId,this.isSymbolTile=se.isSymbolTile,this.tileTransform=i.aZ(se.tileID.canonical,se.projection),this.projection=se.projection,this.worldview=se.worldview,this.localizableLayerIds=se.localizableLayerIds,this.brightness=se.brightness,this.extraShadowCaster=!!se.extraShadowCaster,this.tessellationStep=se.tessellationStep,this.scaleFactor=se.scaleFactor,this.worldview=se.worldview}parse(se,he,Pe,We,je,Q){this.status="parsing",this.data=se,this.collisionBoxArray=new i.b3;const pe=new i.fd(Object.keys(se.layers).sort()),le=new i.fe(this.tileID,this.promoteId);le.bucketLayerIDs=[];const fe={},Se=new i.ff(256,256),Te={featureIndex:le,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Se,availableImages:Pe,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ot=[],wt=he.familiesBySource[this.source];for(const bt in wt){const xt=se.layers[bt];if(!xt)continue;let Xt=!1,cr=!1,nr=!1;for(const an of wt[bt])an[0].type==="symbol"?Xt=!0:cr=!0,an[0].is3D()&&an[0].type!=="model"&&(nr=!0);if(this.extraShadowCaster&&!nr||this.isSymbolTile===!0&&!Xt||this.isSymbolTile===!1&&!cr)continue;xt.version===1&&i.w(`Vector tile source "${this.source}" layer "${bt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ur=pe.encode(bt),Ar=[];let Kr=!1;for(let an=0,Hr=0;an<xt.length;an++){const En=xt.feature(an),li=le.getId(En,bt);if(this.localizableLayerIds&&this.localizableLayerIds.has(bt)){const $n=En.properties?En.properties.worldview:null;if(this.worldview&&typeof $n=="string")if($n==="all")En.properties.$localized=!0;else{if(!$n.split(",").includes(this.worldview))continue;En.properties.$localized=!0,En.properties.worldview=this.worldview}}!Kr&&En.properties&&En.properties.hasOwnProperty(i.fg)&&(Kr=!0),Ar.push({feature:En,id:li,index:Hr,sourceLayerIndex:ur}),Hr++}Kr&&!Te.elevationFeatures&&se.layers.hasOwnProperty(i.fh)&&(Te.elevationFeatures=i.fi.parseFrom(se.layers[i.fh],this.canonical));for(const an of wt[bt]){const Hr=an[0];if(this.extraShadowCaster&&(!Hr.is3D()||Hr.type==="model")||this.isSymbolTile!==void 0&&Hr.type==="symbol"!==this.isSymbolTile||Hr.minzoom&&this.zoom<Math.floor(Hr.minzoom)||Hr.maxzoom&&this.zoom>=Hr.maxzoom||Hr.visibility==="none")continue;R(an,this.zoom,Te.brightness,Pe,this.worldview);const En=fe[Hr.id]=Hr.createBucket({index:le.bucketLayerIDs.length,layers:an,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ur,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:We,worldview:this.worldview});le.bucketLayerIDs.push(an.map($n=>i.B($n.id,$n.scope)));let li=En.prepare?En.prepare():null;li!=null?(li=li.then(()=>En.populate(Ar,Te,this.tileID.canonical,this.tileTransform)),ot.push(li)):En.populate(Ar,Te,this.tileID.canonical,this.tileTransform)}}const mt=()=>{let bt,xt,Xt,cr,nr,ur;Se.trim();const Ar={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Kr=()=>{if(bt)return this.status="done",Q(bt);if(this.extraShadowCaster)this.status="done",Q(null,{buckets:Object.values(fe).filter(Hr=>!Hr.isEmpty()),featureIndex:le,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Te.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(xt&&Xt&&cr){const Hr=new O(xt),En=new Map;for(const[ca,da]of Xt.entries()){const{imagePosition:Eo}=i.fl(ca,da,i.fm);En.set(ca,Eo)}const li={};for(const ca in fe){const da=fe[ca];da instanceof i.b4&&(R(da.layers,this.zoom,Te.brightness,Pe,this.worldview),li[ca]=i.fn(da,xt,Hr.positions,Xt,En,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,nr,this.worldview))}const $n={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(je,Xt,nr,()=>{$n.iconsPending=!1,an(li,Hr,$n)}),this.rasterizeIfNeeded(je,cr,ur,()=>{$n.patternsPending=!1,an(li,Hr,$n)})}},an=(Hr,En,li,$n)=>{if(li.iconsPending||li.patternsPending)return;const ca=new i.fo(Xt,cr,this.lut);for(const da in fe){const Eo=fe[da];if(da in Hr)i.fp(Eo,Hr[da],this.showCollisionBoxes,Pe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Xt,ca);else if(Eo.hasPattern&&(Eo instanceof i.ba||Eo instanceof i.bb||Eo instanceof i.e7)){R(Eo.layers,this.zoom,Te.brightness,Pe,this.worldview);const no=Object.fromEntries(ca.patternPositions);Eo.addFeatures(Te,this.tileID.canonical,no,Pe,this.tileTransform,this.brightness)}}this.status="done",Q(null,{buckets:Object.values(fe).filter(da=>!da.isEmpty()),featureIndex:le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:En.image,lineAtlas:Se,imageAtlas:ca,brightness:Te.brightness})};if(!this.extraShadowCaster){const Hr=i.fj(Te.glyphDependencies,$n=>Object.keys($n).map(Number));Object.keys(Hr).length?je.send("getGlyphs",{uid:this.uid,stacks:Hr},($n,ca)=>{bt||(bt=$n,xt=ca,Kr())},void 0,!1,Ar):xt={};const En=Array.from(Te.iconDependencies.keys()).map($n=>i.I.parse($n));En.length?je.send("getImages",{images:En,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},($n,ca)=>{bt||(bt=$n,Xt=new Map,nr=this.updateImageMapAndGetImageTaskQueue(Xt,ca,Te.iconDependencies),Kr())},void 0,!1,Ar):(Xt=new Map,nr=new Map);const li=Array.from(Te.patternDependencies.keys()).map($n=>i.I.parse($n));li.length?je.send("getImages",{images:li,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},($n,ca)=>{bt||(bt=$n,cr=new Map,ur=this.updateImageMapAndGetImageTaskQueue(cr,ca,Te.patternDependencies),Kr())},void 0,!1,Ar):(cr=new Map,ur=new Map)}if(Te.elevationFeatures&&Te.elevationFeatures.length>0){const Hr=[];for(const li of Object.values(fe))if(li instanceof i.bb){const $n=li.getUnevaluatedPortalGraph();$n&&Hr.push($n)}const En=i.fk.evaluate(Hr);for(const li of Object.values(fe))if(li instanceof i.bb){const $n=se.layers[pe.decode(li.sourceLayerIndex)];li.setEvaluatedPortalGraph(En,$n,this.tileID.canonical,Te.availableImages,Te.brightness)}}Kr()};ot.length>0?Promise.allSettled(ot).then(mt).catch(Q):mt()}rasterizeIfNeeded(se,he,Pe,We){Array.from(he.values()).some(je=>je.usvg)?this.rasterize(se,he,Pe,We):We()}updateImageMapAndGetImageTaskQueue(se,he,Pe){const We=new Map;for(const je of he.keys()){const Q=Pe.get(je)||[];for(const pe of Q){const le=pe.toString(),fe=he.get(pe.id.toString());fe.usvg?We.has(le)||(We.set(le,pe),se.set(le,Object.assign({},fe))):se.set(le,fe)}}return We}rasterize(se,he,Pe,We){this.rasterizeTask=se.send("rasterizeImages",{scope:this.scope,tasks:Pe},(je,Q)=>{if(!je)for(const[pe,le]of Q.entries()){const fe=Object.assign(he.get(pe),{data:le});he.set(pe,fe)}We()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function R(Qe,se,he,Pe,We){const je=new i.ac(se,{brightness:he,worldview:We});for(const Q of Qe)Q.recalculate(je,Pe)}class N extends i.E{constructor(se,he,Pe,We,je,Q,pe){super(),this.actor=se,this.layerIndex=he,this.availableImages=Pe,this.availableModels=We,this.loadVectorData=Q||i.aL,this.loading={},this.loaded={},this.deduped=new i.aK(se.scheduler),this.isSpriteLoaded=je,this.scheduler=se.scheduler,this.brightness=pe}loadTile(se,he){const Pe=se.uid,We=se&&se.request,je=We&&We.collectResourceTiming,Q=this.loading[Pe]=new L(se);Q.abort=this.loadVectorData(se,(pe,le)=>{const fe=!this.loading[Pe];if(delete this.loading[Pe],Q.cancelRasterize(),fe||pe||!le)return Q.status="done",fe||(this.loaded[Pe]=Q),he(pe);const Se=le.rawData,Te={};le.expires&&(Te.expires=le.expires),le.cacheControl&&(Te.cacheControl=le.cacheControl),Q.vectorTile=le.vectorTile||new i.fq(new i.bt(Se));const ot=()=>{Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(wt,mt)=>{if(wt||!mt)return he(wt);const bt={};if(je){const xt=v(We);xt.length>0&&(bt.resourceTiming=JSON.parse(JSON.stringify(xt)))}he(null,Object.assign({rawTileData:Se.slice(0)},mt,Te,bt))})};this.isSpriteLoaded?ot():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(ot,{type:"parseTile",isSymbolTile:se.isSymbolTile,zoom:se.tileZoom}):ot()}),this.loaded=this.loaded||{},this.loaded[Pe]=Q})}reloadTile(se,he){const Pe=this.loaded,We=se.uid;if(Pe&&Pe[We]){const je=Pe[We];je.scaleFactor=se.scaleFactor,je.showCollisionBoxes=se.showCollisionBoxes,je.projection=se.projection,je.brightness=se.brightness,je.tileTransform=i.aZ(se.tileID.canonical,se.projection),je.extraShadowCaster=se.extraShadowCaster,je.lut=se.lut,je.worldview=se.worldview;const Q=(pe,le)=>{const fe=je.reloadCallback;fe&&(delete je.reloadCallback,je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,fe)),he(pe,le)};je.status==="parsing"?je.reloadCallback=Q:je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Q):Q())}else he(null,void 0)}abortTile(se,he){const Pe=se.uid,We=this.loading[Pe];We&&(We.abort&&We.abort(),delete this.loading[Pe]),he()}removeTile(se,he){const Pe=this.loaded,We=se.uid;Pe&&Pe[We]&&delete Pe[We],he()}}class V{loadTile(se,he){const{uid:Pe,encoding:We,rawImageData:je,padding:Q}=se,pe=ImageBitmap&&je instanceof ImageBitmap?this.getImageData(je,Q):je;he(null,new i.fr(Pe,pe,We,Q<1))}reloadTile(se,he){he(null,null)}abortTile(se,he){he()}removeTile(se,he){he()}getImageData(se,he){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(se.width,se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=se.width,this.offscreenCanvas.height=se.height,this.offscreenCanvasContext.drawImage(se,0,0,se.width,se.height);const Pe=this.offscreenCanvasContext.getImageData(-he,-he,se.width+2*he,se.height+2*he);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Pe}}i.bs.setPbf(i.bt);class G{constructor(se){this._mrt=new i.bs(se.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=se.uid,this.tileID=se.tileID,this.source=se.source}parse(se,he){const Pe=this._mrt;this.status="parsing",this._entireBuffer=se;try{Pe.parseHeader(se),this._isHeaderLoaded=!0;const We=[];for(const je in Pe.layers){const Q=Pe.getLayer(je),pe=Q.getDataRange(Q.getBandList()),le=Pe.createDecodingTask(pe),fe=se.slice(pe.firstByte,pe.lastByte+1),Se=i.bs.performDecoding(fe,le).then(Te=>le.complete(null,Te)).catch(Te=>le.complete(Te,null));We.push(Se)}Promise.allSettled(We).then(()=>he(null,Pe)).catch(je=>he(je))}catch(We){he(We)}}}class U{constructor(se){this.actor=se,this.loading={},this.loaded={}}loadTile(se,he){const Pe=se.uid,We=se.request,je=this.loading[Pe]=new G(se),{cancel:Q}=i.bu(We,(pe,le,fe,Se)=>{const Te=!this.loading[Pe];if(delete this.loading[Pe],Te||pe||!le)return je.status="done",Te||(this.loaded[Pe]=je),he(pe);je.parse(le,(ot,wt)=>{if(ot||!wt)return he(ot);he(null,wt,fe,Se)}),this.loaded[Pe]=je});je.abort=Q}reloadTile(se,he){he(null,void 0)}abortTile(se,he){const Pe=se.uid,We=this.loading[Pe];We&&(We.abort&&We.abort(),delete this.loading[Pe]),he()}removeTile(se,he){const Pe=se.uid;this.loaded[Pe]&&delete this.loaded[Pe],he()}decodeRasterArray(se,he){i.bs.performDecoding(se.buffer,se.task).then(Pe=>he(null,Pe)).catch(Pe=>he(Pe))}}const J=i.fs.prototype.toGeoJSON;class Z{constructor(se){this._feature=se,this.extent=i.al,this.type=se.type,this.properties=se.tags,"id"in se&&!isNaN(se.id)&&(this.id=parseInt(se.id,10))}loadGeometry(){if(this._feature.type===1){const se=[];for(const he of this._feature.geometry)se.push([new i.P(he[0],he[1])]);return se}{const se=[];for(const he of this._feature.geometry){const Pe=[];for(const We of he)Pe.push(new i.P(We[0],We[1]));se.push(Pe)}return se}}toGeoJSON(se,he,Pe){return J.call(this,se,he,Pe)}}class K{constructor(se,he){this.name=se,this.extent=i.al,this.length=he.length,this._jsonFeatures=he}feature(se){return new Z(this._jsonFeatures[se])}}class re{constructor(se){this.layers={},this.extent=i.al;for(const he of Object.keys(se))this.layers[he]=new K(he,se[he])}}const ge=64/4096,ve=128;class $e{constructor(){this.features=new Map}clear(){this.features.clear()}load(se=[],he){for(const Pe of se){const We=Pe.id;if(We==null)continue;let je=this.features.get(We);je&&this.updateCache(je,he),Pe.geometry?(je=ke(Pe),this.updateCache(je,he),this.features.set(We,je)):this.features.delete(We),this.updateCache(je,he)}}updateCache(se,he){for(const{canonical:Pe,uid:We}of Object.values(he)){const{z:je,x:Q,y:pe}=Pe;Ie(se,Math.pow(2,je),Q,pe)&&delete he[We]}}getTile(se,he,Pe){const We=Math.pow(2,se),je=[];for(const Q of this.features.values())Ie(Q,We,he,Pe)&&je.push(at(Q,We,he,Pe));return{features:je}}getFeatures(){return[...this.features.values()]}}function Ie({minX:Qe,minY:se,maxX:he,maxY:Pe},We,je,Q){return Qe<(je+1+ge)/We&&se<(Q+1+ge)/We&&he>(je-ge)/We&&Pe>(Q-ge)/We}function ke(Qe){const{id:se,geometry:he,properties:Pe}=Qe;if(!he)return;if(he.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:We,coordinates:je}=he,Q={id:se,type:1,geometry:[],tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},pe=Q.geometry;if(We==="Point")tt(je,pe,Q);else if(We==="MultiPoint")for(const le of je)tt(le,pe,Q);else if(We==="LineString")Q.type=2,Je(je,pe,Q);else if(We==="MultiLineString")Q.type=2,et(je,pe,Q);else if(We==="Polygon")Q.type=3,et(je,pe,Q,!0);else{if(We!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Q.type=3;for(const le of je)et(le,pe,Q,!0)}return Q}function tt([Qe,se],he,Pe){const We=i.aF(Qe);let je=i.aJ(se);je=je<0?0:je>1?1:je,he.push(We,je),Pe.minX=Math.min(Pe.minX,We),Pe.minY=Math.min(Pe.minY,je),Pe.maxX=Math.max(Pe.maxX,We),Pe.maxY=Math.max(Pe.maxY,je)}function Je(Qe,se,he,Pe=!1,We=!1){const je=[];for(const Q of Qe)tt(Q,je,he);se.push(je),Pe&&function(Q,pe){let le=0;for(let fe=0,Se=Q.length,Te=Se-2;fe<Se;Te=fe,fe+=2)le+=(Q[fe]-Q[Te])*(Q[fe+1]+Q[Te+1]);if(le>0===pe)for(let fe=0,Se=Q.length;fe<Se/2;fe+=2){const Te=Q[fe],ot=Q[fe+1];Q[fe]=Q[Se-2-fe],Q[fe+1]=Q[Se-1-fe],Q[Se-2-fe]=Te,Q[Se-1-fe]=ot}}(je,We)}function et(Qe,se,he,Pe=!1){for(let We=0;We<Qe.length;We++)Je(Qe[We],se,he,Pe,We===0)}function at(Qe,se,he,Pe){const{id:We,type:je,geometry:Q,tags:pe}=Qe,le=[];if(je===1)(function(fe,Se,Te,ot,wt){for(let mt=0;mt<fe.length;mt+=2){const bt=Math.round(i.al*(fe[mt+0]*Se-Te)),xt=Math.round(i.al*(fe[mt+1]*Se-ot));wt.push([bt,xt])}})(Q,se,he,Pe,le);else for(const fe of Q)pt(fe,se,he,Pe,le);return{id:We,type:je,geometry:le,tags:pe}}function pt(Qe,se,he,Pe,We){const je=-ve,Q=i.al+ve;let pe;for(let le=0;le<Qe.length-2;le+=2){let fe=Math.round(i.al*(Qe[le+0]*se-he)),Se=Math.round(i.al*(Qe[le+1]*se-Pe)),Te=Math.round(i.al*(Qe[le+2]*se-he)),ot=Math.round(i.al*(Qe[le+3]*se-Pe));const wt=Te-fe,mt=ot-Se;fe<je&&Te<je||(fe<je?(Se+=Math.round(mt*((je-fe)/wt)),fe=je):Te<je&&(ot=Se+Math.round(mt*((je-fe)/wt)),Te=je),Se<je&&ot<je||(Se<je?(fe+=Math.round(wt*((je-Se)/mt)),Se=je):ot<je&&(Te=fe+Math.round(wt*((je-Se)/mt)),ot=je),fe>=Q&&Te>=Q||(fe>=Q?(Se+=Math.round(mt*((Q-fe)/wt)),fe=Q):Te>=Q&&(ot=Se+Math.round(mt*((Q-fe)/wt)),Te=Q),Se>=Q&&ot>=Q||(Se>=Q?(fe+=Math.round(wt*((Q-Se)/mt)),Se=Q):ot>=Q&&(Te=fe+Math.round(wt*((Q-Se)/mt)),ot=Q),pe&&fe===pe[pe.length-1][0]&&Se===pe[pe.length-1][1]||(pe=[[fe,Se]],We.push(pe)),pe.push([Te,ot])))))}}function ft({name:Qe,features:se},he){he.writeStringField(1,Qe),he.writeVarintField(5,i.al);const Pe=new Map,We=new Map,je={keys:Pe,values:We,feature:null};for(const Q of se)je.feature=Q,he.writeMessage(2,Ue,je);for(const Q of Pe.keys())he.writeStringField(3,Q);for(const Q of We.keys())he.writeMessage(4,qe,Q)}function Ue(Qe,se){const he=Qe.feature;he.id!==void 0&&Number.isSafeInteger(+he.id)&&se.writeVarintField(1,+he.id),he.tags&&se.writeMessage(2,It,Qe),se.writeVarintField(3,he.type),se.writeMessage(4,Ge,he)}function It({keys:Qe,values:se,feature:he},Pe){for(const We of Object.keys(he.tags)){let je=he.tags[We];if(je===null)continue;let Q=Qe.get(We);Q===void 0&&(Q=Qe.size,Qe.set(We,Q)),Pe.writeVarint(Q);const pe=typeof je;pe!=="string"&&pe!=="boolean"&&pe!=="number"&&(je=JSON.stringify(je));let le=se.get(je);le===void 0&&(le=se.size,se.set(je,le)),Pe.writeVarint(le)}}function Rt(Qe,se){return(se<<3)+(7&Qe)}function _e(Qe){return Qe<<1^Qe>>31}function Ge(Qe,se){const{geometry:he,type:Pe}=Qe;let We=0,je=0;if(Pe===1){se.writeVarint(Rt(1,he.length));for(const Q of he){const pe=Q[0]-We,le=Q[1]-je;se.writeVarint(_e(pe)),se.writeVarint(_e(le)),We+=pe,je+=le}}else for(const Q of he){se.writeVarint(Rt(1,1));const pe=Q.length-(Pe===3?1:0);for(let le=0;le<pe;le++){le===1&&se.writeVarint(Rt(2,pe-1));const fe=Q[le][0]-We,Se=Q[le][1]-je;se.writeVarint(_e(fe)),se.writeVarint(_e(Se)),We+=fe,je+=Se}Pe===3&&se.writeVarint(Rt(7,1))}}function qe(Qe,se){const he=typeof Qe;he==="string"?se.writeStringField(1,Qe):he==="boolean"?se.writeBooleanField(7,Qe):he==="number"&&(Qe%1!=0?se.writeDoubleField(3,Qe):Qe<0?se.writeSVarintField(6,Qe):se.writeVarintField(5,Qe))}const Xe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Qe=>Qe},yt=Math.fround||(Dt=new Float32Array(1),Qe=>(Dt[0]=+Qe,Dt[0]));var Dt;const Yt=3,St=5,Mt=6;class Sr{constructor(se){this.options=Object.assign(Object.create(Xe),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:he,minZoom:Pe,maxZoom:We}=this.options;he&&console.time("total time");const je=`prepare ${se.length} points`;he&&console.time(je),this.points=se;const Q=[];for(let le=0;le<se.length;le++){const fe=se[le];if(!fe.geometry)continue;const[Se,Te]=fe.geometry.coordinates,ot=yt(kr(Se)),wt=yt(Br(Te));Q.push(ot,wt,1/0,le,-1,1),this.options.reduce&&Q.push(0)}let pe=this.trees[We+1]=this._createTree(Q);he&&console.timeEnd(je);for(let le=We;le>=Pe;le--){const fe=+Date.now();pe=this.trees[le]=this._createTree(this._cluster(pe,le)),he&&console.log("z%d: %d clusters in %dms",le,pe.numItems,+Date.now()-fe)}return he&&console.timeEnd("total time"),this}getClusters(se,he){let Pe=((se[0]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,se[1]));let je=se[2]===180?180:((se[2]+180)%360+360)%360-180;const Q=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)Pe=-180,je=180;else if(Pe>je){const Te=this.getClusters([Pe,We,180,Q],he),ot=this.getClusters([-180,We,je,Q],he);return Te.concat(ot)}const pe=this.trees[this._limitZoom(he)],le=pe.range(kr(Pe),Br(Q),kr(je),Br(We)),fe=pe.data,Se=[];for(const Te of le){const ot=this.stride*Te;Se.push(fe[ot+St]>1?Ne(fe,ot,this.clusterProps):this.points[fe[ot+Yt]])}return Se}getChildren(se){const he=this._getOriginId(se),Pe=this._getOriginZoom(se),We="No cluster with the specified id.",je=this.trees[Pe];if(!je)throw new Error(We);const Q=je.data;if(he*this.stride>=Q.length)throw new Error(We);const pe=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),le=je.within(Q[he*this.stride],Q[he*this.stride+1],pe),fe=[];for(const Se of le){const Te=Se*this.stride;Q[Te+4]===se&&fe.push(Q[Te+St]>1?Ne(Q,Te,this.clusterProps):this.points[Q[Te+Yt]])}if(fe.length===0)throw new Error(We);return fe}getLeaves(se,he,Pe){const We=[];return this._appendLeaves(We,se,he=he||10,Pe=Pe||0,0),We}getTile(se,he,Pe){const We=this.trees[this._limitZoom(se)],je=Math.pow(2,se),{extent:Q,radius:pe}=this.options,le=pe/Q,fe=(Pe-le)/je,Se=(Pe+1+le)/je,Te={features:[]};return this._addTileFeatures(We.range((he-le)/je,fe,(he+1+le)/je,Se),We.data,he,Pe,je,Te),he===0&&this._addTileFeatures(We.range(1-le/je,fe,1,Se),We.data,je,Pe,je,Te),he===je-1&&this._addTileFeatures(We.range(0,fe,le/je,Se),We.data,-1,Pe,je,Te),Te.features.length?Te:null}getClusterExpansionZoom(se){let he=this._getOriginZoom(se)-1;for(;he<=this.options.maxZoom;){const Pe=this.getChildren(se);if(he++,Pe.length!==1)break;se=Pe[0].properties.cluster_id}return he}_appendLeaves(se,he,Pe,We,je){const Q=this.getChildren(he);for(const pe of Q){const le=pe.properties;if(le&&le.cluster?je+le.point_count<=We?je+=le.point_count:je=this._appendLeaves(se,le.cluster_id,Pe,We,je):je<We?je++:se.push(pe),se.length===Pe)break}return je}_createTree(se){const he=new i.c3(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Pe=0;Pe<se.length;Pe+=this.stride)he.add(se[Pe],se[Pe+1]);return he.finish(),he.data=se,he}_addTileFeatures(se,he,Pe,We,je,Q){for(const pe of se){const le=pe*this.stride,fe=he[le+St]>1;let Se,Te,ot;if(fe)Se=un(he,le,this.clusterProps),Te=he[le],ot=he[le+1];else{const bt=this.points[he[le+Yt]];Se=bt.properties;const[xt,Xt]=bt.geometry.coordinates;Te=kr(xt),ot=Br(Xt)}const wt={type:1,geometry:[[Math.round(this.options.extent*(Te*je-Pe)),Math.round(this.options.extent*(ot*je-We))]],tags:Se};let mt;mt=fe||this.options.generateId?he[le+Yt]:this.points[he[le+Yt]].id,mt!==void 0&&(wt.id=mt),Q.features.push(wt)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,he){const{radius:Pe,extent:We,reduce:je,minPoints:Q}=this.options,pe=Pe/(We*Math.pow(2,he)),le=se.data,fe=[],Se=this.stride;for(let Te=0;Te<le.length;Te+=Se){if(le[Te+2]<=he)continue;le[Te+2]=he;const ot=le[Te],wt=le[Te+1],mt=se.within(le[Te],le[Te+1],pe),bt=le[Te+St];let xt=bt;for(const Xt of mt){const cr=Xt*Se;le[cr+2]>he&&(xt+=le[cr+St])}if(xt>bt&&xt>=Q){let Xt,cr=ot*bt,nr=wt*bt,ur=-1;const Ar=(Te/Se<<5)+(he+1)+this.points.length;for(const Kr of mt){const an=Kr*Se;if(le[an+2]<=he)continue;le[an+2]=he;const Hr=le[an+St];cr+=le[an]*Hr,nr+=le[an+1]*Hr,le[an+4]=Ar,je&&(Xt||(Xt=this._map(le,Te,!0),ur=this.clusterProps.length,this.clusterProps.push(Xt)),je(Xt,this._map(le,an)))}le[Te+4]=Ar,fe.push(cr/xt,nr/xt,1/0,Ar,-1,xt),je&&fe.push(ur)}else{for(let Xt=0;Xt<Se;Xt++)fe.push(le[Te+Xt]);if(xt>1)for(const Xt of mt){const cr=Xt*Se;if(!(le[cr+2]<=he)){le[cr+2]=he;for(let nr=0;nr<Se;nr++)fe.push(le[cr+nr])}}}}return fe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,he,Pe){if(se[he+St]>1){const Q=this.clusterProps[se[he+Mt]];return Pe?Object.assign({},Q):Q}const We=this.points[se[he+Yt]].properties,je=this.options.map(We);return Pe&&je===We?Object.assign({},je):je}}function Ne(Qe,se,he){return{type:"Feature",id:Qe[se+Yt],properties:un(Qe,se,he),geometry:{type:"Point",coordinates:[(Pe=Qe[se],360*(Pe-.5)),Yr(Qe[se+1])]}};var Pe}function un(Qe,se,he){const Pe=Qe[se+St],We=Pe>=1e4?`${Math.round(Pe/1e3)}k`:Pe>=1e3?Math.round(Pe/100)/10+"k":Pe,je=Qe[se+Mt],Q=je===-1?{}:Object.assign({},he[je]);return Object.assign(Q,{cluster:!0,cluster_id:Qe[se+Yt],point_count:Pe,point_count_abbreviated:We})}function kr(Qe){return Qe/360+.5}function Br(Qe){const se=Math.sin(Qe*Math.PI/180),he=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return he<0?0:he>1?1:he}function Yr(Qe){const se=(180-360*Qe)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function Tr(Qe,se,he,Pe){let We=Pe;const je=se+(he-se>>1);let Q,pe=he-se;const le=Qe[se],fe=Qe[se+1],Se=Qe[he],Te=Qe[he+1];for(let ot=se+3;ot<he;ot+=3){const wt=jn(Qe[ot],Qe[ot+1],le,fe,Se,Te);if(wt>We)Q=ot,We=wt;else if(wt===We){const mt=Math.abs(ot-je);mt<pe&&(Q=ot,pe=mt)}}We>Pe&&(Q-se>3&&Tr(Qe,se,Q,Pe),Qe[Q+2]=We,he-Q>3&&Tr(Qe,Q,he,Pe))}function jn(Qe,se,he,Pe,We,je){let Q=We-he,pe=je-Pe;if(Q!==0||pe!==0){const le=((Qe-he)*Q+(se-Pe)*pe)/(Q*Q+pe*pe);le>1?(he=We,Pe=je):le>0&&(he+=Q*le,Pe+=pe*le)}return Q=Qe-he,pe=se-Pe,Q*Q+pe*pe}function Un(Qe,se,he,Pe){const We={id:Qe??null,type:se,geometry:he,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(se==="Point"||se==="MultiPoint"||se==="LineString")Wi(We,he);else if(se==="Polygon")Wi(We,he[0]);else if(se==="MultiLineString")for(const je of he)Wi(We,je);else if(se==="MultiPolygon")for(const je of he)Wi(We,je[0]);return We}function Wi(Qe,se){for(let he=0;he<se.length;he+=3)Qe.minX=Math.min(Qe.minX,se[he]),Qe.minY=Math.min(Qe.minY,se[he+1]),Qe.maxX=Math.max(Qe.maxX,se[he]),Qe.maxY=Math.max(Qe.maxY,se[he+1])}function Yn(Qe,se,he,Pe){if(!se.geometry)return;const We=se.geometry.coordinates;if(We&&We.length===0)return;const je=se.geometry.type,Q=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2);let pe=[],le=se.id;if(he.promoteId?le=se.properties[he.promoteId]:he.generateId&&(le=Pe||0),je==="Point")ta(We,pe);else if(je==="MultiPoint")for(const fe of We)ta(fe,pe);else if(je==="LineString")Di(We,pe,Q,!1);else if(je==="MultiLineString"){if(he.lineMetrics){for(const fe of We)pe=[],Di(fe,pe,Q,!1),Qe.push(Un(le,"LineString",pe,se.properties));return}ra(We,pe,Q,!1)}else if(je==="Polygon")ra(We,pe,Q,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const fe of se.geometry.geometries)Yn(Qe,{id:le,geometry:fe,properties:se.properties},he,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const fe of We){const Se=[];ra(fe,Se,Q,!0),pe.push(Se)}}Qe.push(Un(le,je,pe,se.properties))}function ta(Qe,se){se.push(Ra(Qe[0]),ei(Qe[1]),0)}function Di(Qe,se,he,Pe){let We,je,Q=0;for(let le=0;le<Qe.length;le++){const fe=Ra(Qe[le][0]),Se=ei(Qe[le][1]);se.push(fe,Se,0),le>0&&(Q+=Pe?(We*Se-fe*je)/2:Math.sqrt(Math.pow(fe-We,2)+Math.pow(Se-je,2))),We=fe,je=Se}const pe=se.length-3;se[2]=1,Tr(se,0,pe,he),se[pe+2]=1,se.size=Math.abs(Q),se.start=0,se.end=se.size}function ra(Qe,se,he,Pe){for(let We=0;We<Qe.length;We++){const je=[];Di(Qe[We],je,he,Pe),se.push(je)}}function Ra(Qe){return Qe/360+.5}function ei(Qe){const se=Math.sin(Qe*Math.PI/180),he=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return he<0?0:he>1?1:he}function na(Qe,se,he,Pe,We,je,Q,pe){if(Pe/=se,je>=(he/=se)&&Q<Pe)return Qe;if(Q<he||je>=Pe)return null;const le=[];for(const fe of Qe){const Se=fe.geometry;let Te=fe.type;const ot=We===0?fe.minX:fe.minY,wt=We===0?fe.maxX:fe.maxY;if(ot>=he&&wt<Pe){le.push(fe);continue}if(wt<he||ot>=Pe)continue;let mt=[];if(Te==="Point"||Te==="MultiPoint")wa(Se,mt,he,Pe,We);else if(Te==="LineString")Da(Se,mt,he,Pe,We,!1,pe.lineMetrics);else if(Te==="MultiLineString")Nn(Se,mt,he,Pe,We,!1);else if(Te==="Polygon")Nn(Se,mt,he,Pe,We,!0);else if(Te==="MultiPolygon")for(const bt of Se){const xt=[];Nn(bt,xt,he,Pe,We,!0),xt.length&&mt.push(xt)}if(mt.length){if(pe.lineMetrics&&Te==="LineString"){for(const bt of mt)le.push(Un(fe.id,Te,bt,fe.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(mt.length===1?(Te="LineString",mt=mt[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=mt.length===3?"Point":"MultiPoint"),le.push(Un(fe.id,Te,mt,fe.tags))}}return le.length?le:null}function wa(Qe,se,he,Pe,We){for(let je=0;je<Qe.length;je+=3){const Q=Qe[je+We];Q>=he&&Q<=Pe&&Gi(se,Qe[je],Qe[je+1],Qe[je+2])}}function Da(Qe,se,he,Pe,We,je,Q){let pe=_n(Qe);const le=We===0?ji:ba;let fe,Se,Te=Qe.start;for(let xt=0;xt<Qe.length-3;xt+=3){const Xt=Qe[xt],cr=Qe[xt+1],nr=Qe[xt+2],ur=Qe[xt+3],Ar=Qe[xt+4],Kr=We===0?Xt:cr,an=We===0?ur:Ar;let Hr=!1;Q&&(fe=Math.sqrt(Math.pow(Xt-ur,2)+Math.pow(cr-Ar,2))),Kr<he?an>he&&(Se=le(pe,Xt,cr,ur,Ar,he),Q&&(pe.start=Te+fe*Se)):Kr>Pe?an<Pe&&(Se=le(pe,Xt,cr,ur,Ar,Pe),Q&&(pe.start=Te+fe*Se)):Gi(pe,Xt,cr,nr),an<he&&Kr>=he&&(Se=le(pe,Xt,cr,ur,Ar,he),Hr=!0),an>Pe&&Kr<=Pe&&(Se=le(pe,Xt,cr,ur,Ar,Pe),Hr=!0),!je&&Hr&&(Q&&(pe.end=Te+fe*Se),se.push(pe),pe=_n(Qe)),Q&&(Te+=fe)}let ot=Qe.length-3;const wt=Qe[ot],mt=Qe[ot+1],bt=We===0?wt:mt;bt>=he&&bt<=Pe&&Gi(pe,wt,mt,Qe[ot+2]),ot=pe.length-3,je&&ot>=3&&(pe[ot]!==pe[0]||pe[ot+1]!==pe[1])&&Gi(pe,pe[0],pe[1],pe[2]),pe.length&&se.push(pe)}function _n(Qe){const se=[];return se.size=Qe.size,se.start=Qe.start,se.end=Qe.end,se}function Nn(Qe,se,he,Pe,We,je){for(const Q of Qe)Da(Q,se,he,Pe,We,je,!1)}function Gi(Qe,se,he,Pe){Qe.push(se,he,Pe)}function ji(Qe,se,he,Pe,We,je){const Q=(je-se)/(Pe-se);return Gi(Qe,je,he+(We-he)*Q,1),Q}function ba(Qe,se,he,Pe,We,je){const Q=(je-he)/(We-he);return Gi(Qe,se+(Pe-se)*Q,je,1),Q}function Bo(Qe,se){const he=[];for(let Pe=0;Pe<Qe.length;Pe++){const We=Qe[Pe],je=We.type;let Q;if(je==="Point"||je==="MultiPoint"||je==="LineString")Q=uo(We.geometry,se);else if(je==="MultiLineString"||je==="Polygon"){Q=[];for(const pe of We.geometry)Q.push(uo(pe,se))}else if(je==="MultiPolygon"){Q=[];for(const pe of We.geometry){const le=[];for(const fe of pe)le.push(uo(fe,se));Q.push(le)}}he.push(Un(We.id,je,Q,We.tags))}return he}function uo(Qe,se){const he=[];he.size=Qe.size,Qe.start!==void 0&&(he.start=Qe.start,he.end=Qe.end);for(let Pe=0;Pe<Qe.length;Pe+=3)he.push(Qe[Pe]+se,Qe[Pe+1],Qe[Pe+2]);return he}function xl(Qe,se){if(Qe.transformed)return Qe;const he=1<<Qe.z,Pe=Qe.x,We=Qe.y;for(const je of Qe.features){const Q=je.geometry,pe=je.type;if(je.geometry=[],pe===1)for(let le=0;le<Q.length;le+=2)je.geometry.push(ti(Q[le],Q[le+1],se,he,Pe,We));else for(let le=0;le<Q.length;le++){const fe=[];for(let Se=0;Se<Q[le].length;Se+=2)fe.push(ti(Q[le][Se],Q[le][Se+1],se,he,Pe,We));je.geometry.push(fe)}}return Qe.transformed=!0,Qe}function ti(Qe,se,he,Pe,We,je){return[Math.round(he*(Qe*Pe-We)),Math.round(he*(se*Pe-je))]}function ia(Qe,se,he,Pe,We){const je=se===We.maxZoom?0:We.tolerance/((1<<se)*We.extent),Q={features:[],numPoints:0,numSimplified:0,numFeatures:Qe.length,source:null,x:he,y:Pe,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const pe of Qe)wl(Q,pe,je,We);return Q}function wl(Qe,se,he,Pe){const We=se.geometry,je=se.type,Q=[];if(Qe.minX=Math.min(Qe.minX,se.minX),Qe.minY=Math.min(Qe.minY,se.minY),Qe.maxX=Math.max(Qe.maxX,se.maxX),Qe.maxY=Math.max(Qe.maxY,se.maxY),je==="Point"||je==="MultiPoint")for(let pe=0;pe<We.length;pe+=3)Q.push(We[pe],We[pe+1]),Qe.numPoints++,Qe.numSimplified++;else if(je==="LineString")bl(Q,We,Qe,he,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let pe=0;pe<We.length;pe++)bl(Q,We[pe],Qe,he,je==="Polygon",pe===0);else if(je==="MultiPolygon")for(let pe=0;pe<We.length;pe++){const le=We[pe];for(let fe=0;fe<le.length;fe++)bl(Q,le[fe],Qe,he,!0,fe===0)}if(Q.length){let pe=se.tags||null;if(je==="LineString"&&Pe.lineMetrics){pe={};for(const fe in se.tags)pe[fe]=se.tags[fe];pe.mapbox_clip_start=We.start/We.size,pe.mapbox_clip_end=We.end/We.size}const le={geometry:Q,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:pe};se.id!==null&&(le.id=se.id),Qe.features.push(le)}}function bl(Qe,se,he,Pe,We,je){const Q=Pe*Pe;if(Pe>0&&se.size<(We?Q:Pe))return void(he.numPoints+=se.length/3);const pe=[];for(let le=0;le<se.length;le+=3)(Pe===0||se[le+2]>Q)&&(he.numSimplified++,pe.push(se[le],se[le+1])),he.numPoints++;We&&function(le,fe){let Se=0;for(let Te=0,ot=le.length,wt=ot-2;Te<ot;wt=Te,Te+=2)Se+=(le[Te]-le[wt])*(le[Te+1]+le[wt+1]);if(Se>0===fe)for(let Te=0,ot=le.length;Te<ot/2;Te+=2){const wt=le[Te],mt=le[Te+1];le[Te]=le[ot-2-Te],le[Te+1]=le[ot-1-Te],le[ot-2-Te]=wt,le[ot-1-Te]=mt}}(pe,je),Qe.push(pe)}const To={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ro{constructor(se,he){const Pe=(he=this.options=function(je,Q){for(const pe in Q)je[pe]=Q[pe];return je}(Object.create(To),he)).debug;if(Pe&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");let We=function(je,Q){const pe=[];if(je.type==="FeatureCollection")for(let le=0;le<je.features.length;le++)Yn(pe,je.features[le],Q,le);else Yn(pe,je.type==="Feature"?je:{geometry:je},Q);return pe}(se,he);this.tiles={},this.tileCoords=[],Pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),We=function(je,Q){const pe=Q.buffer/Q.extent;let le=je;const fe=na(je,1,-1-pe,pe,0,-1,2,Q),Se=na(je,1,1-pe,2+pe,0,-1,2,Q);return(fe||Se)&&(le=na(je,1,-pe,1+pe,0,-1,2,Q)||[],fe&&(le=Bo(fe,1).concat(le)),Se&&(le=le.concat(Bo(Se,-1)))),le}(We,he),We.length&&this.splitTile(We,0,0,0),Pe&&(We.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(se,he,Pe,We,je,Q,pe){const le=[se,he,Pe,We],fe=this.options,Se=fe.debug;for(;le.length;){We=le.pop(),Pe=le.pop(),he=le.pop(),se=le.pop();const Te=1<<he,ot=jc(he,Pe,We);let wt=this.tiles[ot];if(!wt&&(Se>1&&console.time("creation"),wt=this.tiles[ot]=ia(se,he,Pe,We,fe),this.tileCoords.push({z:he,x:Pe,y:We}),Se)){Se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,Pe,We,wt.numFeatures,wt.numPoints,wt.numSimplified),console.timeEnd("creation"));const Hr=`z${he}`;this.stats[Hr]=(this.stats[Hr]||0)+1,this.total++}if(wt.source=se,je==null){if(he===fe.indexMaxZoom||wt.numPoints<=fe.indexMaxPoints)continue}else{if(he===fe.maxZoom||he===je)continue;if(je!=null){const Hr=je-he;if(Pe!==Q>>Hr||We!==pe>>Hr)continue}}if(wt.source=null,se.length===0)continue;Se>1&&console.time("clipping");const mt=.5*fe.buffer/fe.extent,bt=.5-mt,xt=.5+mt,Xt=1+mt;let cr=null,nr=null,ur=null,Ar=null,Kr=na(se,Te,Pe-mt,Pe+xt,0,wt.minX,wt.maxX,fe),an=na(se,Te,Pe+bt,Pe+Xt,0,wt.minX,wt.maxX,fe);se=null,Kr&&(cr=na(Kr,Te,We-mt,We+xt,1,wt.minY,wt.maxY,fe),nr=na(Kr,Te,We+bt,We+Xt,1,wt.minY,wt.maxY,fe),Kr=null),an&&(ur=na(an,Te,We-mt,We+xt,1,wt.minY,wt.maxY,fe),Ar=na(an,Te,We+bt,We+Xt,1,wt.minY,wt.maxY,fe),an=null),Se>1&&console.timeEnd("clipping"),le.push(cr||[],he+1,2*Pe,2*We),le.push(nr||[],he+1,2*Pe,2*We+1),le.push(ur||[],he+1,2*Pe+1,2*We),le.push(Ar||[],he+1,2*Pe+1,2*We+1)}}getTile(se,he,Pe){se=+se,he=+he,Pe=+Pe;const We=this.options,{extent:je,debug:Q}=We;if(se<0||se>24)return null;const pe=1<<se,le=jc(se,he=he+pe&pe-1,Pe);if(this.tiles[le])return xl(this.tiles[le],je);Q>1&&console.log("drilling down to z%d-%d-%d",se,he,Pe);let fe,Se=se,Te=he,ot=Pe;for(;!fe&&Se>0;)Se--,Te>>=1,ot>>=1,fe=this.tiles[jc(Se,Te,ot)];return fe&&fe.source?(Q>1&&(console.log("found parent tile z%d-%d-%d",Se,Te,ot),console.time("drilling down")),this.splitTile(fe.source,Se,Te,ot,se,he,Pe),Q>1&&console.timeEnd("drilling down"),this.tiles[le]?xl(this.tiles[le],je):null):null}}function jc(Qe,se,he){return 32*((1<<Qe)*he+se)+Qe}function yn(Qe,se){const he=Qe.tileID.canonical;if(!this._geoJSONIndex)return void se(null,null);const Pe=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!Pe)return void se(null,null);const We=fe=>fe.tags&&"3d_elevation_id"in fe.tags&&"source"in fe.tags&&fe.tags.source==="elevation",je=Pe.features.filter(fe=>We(fe));let Q={_geojsonTileLayer:Pe.features};je.length>0&&(Q={_geojsonTileLayer:Pe.features.filter(fe=>!We(fe)),hd_road_elevation:je});const pe=new re(Q),le=function(fe){const Se=new i.bt;for(const Te of Object.keys(fe))Se.writeMessage(3,ft,{name:Te,features:fe[Te]});return Se.finish()}(Q).buffer;se(null,{vectorTile:pe,rawData:le})}class Pt extends N{constructor(se,he,Pe,We,je,Q,pe){super(se,he,Pe,We,je,yn,pe),Q&&(this.loadGeoJSON=Q),this._dynamicIndex=new $e}loadData(se,he){const Pe=se&&se.request,We=Pe&&Pe.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(se,(je,Q)=>{if(je||!Q)return he(je);if(typeof Q!="object")return he(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));{try{if(se.filter){const le=i.U(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(fe=>`${fe.key}: ${fe.message}`).join(", "));Q.features=Q.features.filter(fe=>le.value.evaluate({zoom:0},fe))}se.dynamic?(Q.type==="Feature"&&(Q={type:"FeatureCollection",features:[Q]}),se.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Q.features,this.loaded),se.cluster&&(Q.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=se.cluster?new Sr(function({superclusterOptions:le,clusterProperties:fe}){if(!fe||!le)return le;const Se={},Te={},ot={accumulated:null,zoom:0},wt={properties:null},mt=Object.keys(fe);for(const bt of mt){const[xt,Xt]=fe[bt],cr=i.U(Xt),nr=i.U(typeof xt=="string"?[xt,["accumulated"],["get",bt]]:xt);Se[bt]=cr.value,Te[bt]=nr.value}return le.map=bt=>{wt.properties=bt;const xt={};for(const Xt of mt)xt[Xt]=Se[Xt].evaluate(ot,wt);return xt},le.reduce=(bt,xt)=>{wt.properties=xt;for(const Xt of mt)ot.accumulated=bt[Xt],bt[Xt]=Te[Xt].evaluate(ot,wt)},le}(se)).load(Q.features):se.dynamic?this._dynamicIndex:function(le,fe){return new ro(le,fe)}(Q,se.geojsonVtOptions)}catch(le){return he(le)}const pe={};if(We){const le=v(Pe);le&&(pe.resourceTiming={},pe.resourceTiming[se.source]=JSON.parse(JSON.stringify(le)))}he(null,pe)}})}reloadTile(se,he){const Pe=this.loaded;return Pe&&Pe[se.uid]?se.partial?he(null,void 0):super.reloadTile(se,he):this.loadTile(se,he)}loadGeoJSON(se,he){if(se.request)i.m(se.request,he);else{if(typeof se.data!="string")return he(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return he(null,JSON.parse(se.data))}catch{return he(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(se,he){try{he(null,this._geoJSONIndex.getClusterExpansionZoom(se.clusterId))}catch(Pe){he(Pe)}}getClusterChildren(se,he){try{he(null,this._geoJSONIndex.getChildren(se.clusterId))}catch(Pe){he(Pe)}}getClusterLeaves(se,he){try{he(null,this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset))}catch(Pe){he(Pe)}}}class si{constructor(se,he,Pe){this.tileID=new i.aO(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.tileZoom=se.tileZoom,this.uid=se.uid,this.zoom=se.zoom,this.canonical=se.tileID.canonical,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=se.projection,this.brightness=he,this.worldview=Pe}parse(se,he,Pe,We){this.status="parsing";const je=new i.aO(Pe.tileID.overscaledZ,Pe.tileID.wrap,Pe.tileID.canonical.z,Pe.tileID.canonical.x,Pe.tileID.canonical.y),Q=[],pe=he.familiesBySource[Pe.source],le=new i.fe(je,Pe.promoteId);le.bucketLayerIDs=[],le.is3DTile=!0,i.ft(se).then(fe=>{if(!fe)return We(new Error("Could not parse tile"));const Se=fe.json.extensionsUsed&&fe.json.extensionsUsed.includes("MAPBOX_mesh_features")||fe.json.asset.extras&&fe.json.asset.extras.MAPBOX_mesh_features,Te=fe.json.extensionsUsed&&fe.json.extensionsUsed.includes("EXT_meshopt_compression"),ot=new i.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const wt in pe)for(const mt of pe[wt]){const bt=mt[0];le.bucketLayerIDs.push(mt.map(cr=>i.B(cr.id,cr.scope))),bt.recalculate(ot,[]);const xt=i.fu(fe,1/i.d6(Pe.tileID.canonical)),Xt=new i.fv(mt,xt,je,Se,Te,this.brightness,le,this.worldview);Se||(Xt.needsUpload=!0),Q.push(Xt),Xt.evaluate(bt)}this.status="done",We(null,{buckets:Q,featureIndex:le,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(fe=>We(new Error(fe.message)))}}class So{constructor(se,he,Pe,We,je,Q,pe,le){this.actor=se,this.layerIndex=he,this.availableImages=Pe,this.availableModels=We,this.brightness=pe,this.loading={},this.loaded={},this.worldview=le}loadTile(se,he){const Pe=se.uid,We=this.loading[Pe]=new si(se,this.brightness,this.worldview);i.bu(se.request,(je,Q)=>{const pe=!this.loading[Pe];return delete this.loading[Pe],pe||je?(We.status="done",pe||(this.loaded[Pe]=We),he(je)):Q&&Q.byteLength!==0?void We.parse(Q,this.layerIndex,se,(le,fe)=>{We.status="done",this.loaded=this.loaded||{},this.loaded[Pe]=We,le||!fe?he(le):he(null,fe)}):(We.status="done",this.loaded[Pe]=We,he())})}reloadTile(se,he){const Pe=this.loaded,We=se.uid;if(Pe&&Pe[We]){const je=Pe[We];je.projection=se.projection,je.brightness=se.brightness;const Q=(pe,le)=>{je.reloadCallback&&(delete je.reloadCallback,this.loadTile(se,he)),he(pe,le)};je.status==="parsing"?je.reloadCallback=Q:je.status==="done"&&this.loadTile(se,he)}}abortTile(se,he){const Pe=se.uid;this.loading[Pe]&&delete this.loading[Pe],he()}removeTile(se,he){const Pe=this.loaded,We=se.uid;Pe&&Pe[We]&&delete Pe[We],he()}}class Ha{constructor(se){this.self=se,this.actor=new i.fx(se,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=i.cl({name:"mercator"}),this.workerSourceTypes={vector:N,geojson:Pt,"raster-dem":V,"raster-array":U,"batched-model":So},this.workerSources={},this.self.registerWorkerSource=(he,Pe)=>{if(this.workerSourceTypes[he])throw new Error(`Worker source with name "${he}" already registered.`);this.workerSourceTypes[he]=Pe},this.self.registerRTLTextPlugin=he=>{if(i.fy.isParsed())throw new Error("RTL text plugin already registered.");i.fy.setState({pluginStatus:i.fz.parsed,pluginURL:i.fy.getPluginURL()}),i.fy.applyArabicShaping=he.applyArabicShaping,i.fy.processBidirectionalText=he.processBidirectionalText,i.fy.processStyledBidirectionalText=he.processStyledBidirectionalText;for(const Pe of this.rtlPluginParsingListeners)Pe(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(se,he,Pe){delete this.layerIndexes[se],delete this.availableImages[se],delete this.availableModels[se],delete this.workerSources[se],Pe()}checkIfReady(se,he,Pe){Pe()}setReferrer(se,he){this.referrer=he}spriteLoaded(se,he){this.isSpriteLoaded[se]||(this.isSpriteLoaded[se]={});const{scope:Pe,isLoaded:We}=he;if(this.isSpriteLoaded[se][Pe]=We,this.workerSources[se]&&this.workerSources[se][Pe])for(const je in this.workerSources[se][Pe]){const Q=this.workerSources[se][Pe][je];for(const pe in Q){const le=Q[pe];le instanceof N&&(le.isSpriteLoaded=We,le.fire(new i.z("isSpriteLoaded")))}}}setImages(se,he,Pe){this.availableImages[se]||(this.availableImages[se]={});const{scope:We,images:je}=he;if(this.availableImages[se][We]=je,this.workerSources[se]&&this.workerSources[se][We]){for(const Q in this.workerSources[se][We]){const pe=this.workerSources[se][We][Q];for(const le in pe)pe[le].availableImages=je}Pe()}else Pe()}setModels(se,{scope:he,models:Pe},We){if(this.availableModels[se]||(this.availableModels[se]={}),this.availableModels[se][he]=Pe,this.workerSources[se]&&this.workerSources[se][he]){for(const je in this.workerSources[se][he]){const Q=this.workerSources[se][he][je];for(const pe in Q)Q[pe].availableModels=Pe}We()}else We()}setProjection(se,he){this.projections[se]=i.cl(he)}setBrightness(se,he,Pe){this.brightness=he,Pe()}setWorldview(se,he,Pe){this.worldview=he,Pe()}setLayers(se,he,Pe){this.getLayerIndex(se,he.scope).replace(he.layers,he.options),Pe()}updateLayers(se,he,Pe){this.getLayerIndex(se,he.scope).update(he.layers,he.removedIds,he.options),Pe()}loadTile(se,he,Pe){he.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,he.type,he.source,he.scope).loadTile(he,Pe)}decodeRasterArray(se,he,Pe){this.getWorkerSource(se,he.type,he.source,he.scope).decodeRasterArray(he,Pe)}reloadTile(se,he,Pe){he.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,he.type,he.source,he.scope).reloadTile(he,Pe)}abortTile(se,he,Pe){this.getWorkerSource(se,he.type,he.source,he.scope).abortTile(he,Pe)}removeTile(se,he,Pe){this.getWorkerSource(se,he.type,he.source,he.scope).removeTile(he,Pe)}removeSource(se,he,Pe){if(!(this.workerSources[se]&&this.workerSources[se][he.scope]&&this.workerSources[se][he.scope][he.type]&&this.workerSources[se][he.scope][he.type][he.source]))return;const We=this.workerSources[se][he.scope][he.type][he.source];delete this.workerSources[se][he.scope][he.type][he.source],We.removeSource!==void 0?We.removeSource(he,Pe):Pe()}loadWorkerSource(se,he,Pe){try{this.self.importScripts(he.url),Pe()}catch(We){Pe(We.toString())}}syncRTLPluginState(se,he,Pe){if(i.fy.isParsed())Pe(null,!0);else if(i.fy.isParsing())this.rtlPluginParsingListeners.push(Pe);else try{i.fy.setState(he);const We=i.fy.getPluginURL();!i.fy.isLoaded()||i.fy.isParsed()||i.fy.isParsing()||We==null||(i.fy.setState({pluginStatus:i.fz.parsing,pluginURL:i.fy.getPluginURL()}),this.self.importScripts(We),i.fy.isParsed()?Pe(null,!0):this.rtlPluginParsingListeners.push(Pe))}catch(We){Pe(We.toString())}}setDracoUrl(se,he){this.dracoUrl=he}getAvailableImages(se,he){this.availableImages[se]||(this.availableImages[se]={});let Pe=this.availableImages[se][he];return Pe||(Pe=[]),Pe}getAvailableModels(se,he){this.availableModels[se]||(this.availableModels[se]={});let Pe=this.availableModels[se][he];return Pe||(Pe={}),Pe}getLayerIndex(se,he){this.layerIndexes[se]||(this.layerIndexes[se]={});let Pe=this.layerIndexes[se][he];return Pe||(Pe=this.layerIndexes[se][he]=new C,Pe.scope=he),Pe}getWorkerSource(se,he,Pe,We){const je=this.workerSources;return je[se]||(je[se]={}),je[se][We]||(je[se][We]={}),je[se][We][he]||(je[se][We][he]={}),this.isSpriteLoaded[se]||(this.isSpriteLoaded[se]={}),je[se][We][he][Pe]||(je[se][We][he][Pe]=new this.workerSourceTypes[he]({send:(Q,pe,le,fe,Se,Te)=>this.actor.send(Q,pe,le,se,Se,Te),scheduler:this.actor.scheduler},this.getLayerIndex(se,We),this.getAvailableImages(se,We),this.getAvailableModels(se,We),this.isSpriteLoaded[se][We],void 0,this.brightness,this.worldview)),je[se][We][he][Pe]}rasterizeImagesWorker(se,he,Pe){const We=new Map;for(const[je,{image:Q,imageVariant:pe}]of he.tasks.entries()){const le=this.imageRasterizer.rasterize(pe,Q,he.scope,se);We.set(je,le)}Pe(void 0,We)}removeRasterizedImages(se,he,Pe){this.imageRasterizer.removeImagesFromCacheByIds(he.imageIds,he.scope,se),Pe()}enforceCacheSizeLimit(se,he){i.fA(he)}getWorkerPerformanceMetrics(se,he,Pe){Pe(void 0,void 0)}}return i.fw(self)&&(self.worker=new Ha(self)),Ha}),u(["./shared"],function(i){var v="3.15.0";const w={create:"create",load:"load",fullLoad:"fullLoad"},S={mark(g){performance.mark(g)},measure(g,s,h){performance.measure(g,s,h)}};function C(g){const s=g.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var k,O={},L=function(){if(k)return O;function g(m){return!s(m)}function s(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,E,P=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(P);try{E=new Worker(M),b=!0}catch{b=!1}return E&&E.terminate(),URL.revokeObjectURL(M),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var E=b.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===b.width}()?(h[x=m&&m.failIfMajorPerformanceCaveat]===void 0&&(h[x]=function(b){var E,P=function(M){var B=document.createElement("canvas"),j=Object.create(g.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=M,B.getContext("webgl2",j)}(b);if(!P)return!1;try{E=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!E||P.isContextLost())&&(P.shaderSource(E,"void main() {}"),P.compileShader(E),P.getShaderParameter(E,P.COMPILE_STATUS)===!0)}(x)),h[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}k=1,O.supported=g,O.notSupportedReason=s;var h={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},O}();function R(g,s,h){const m=document.createElement(g);return s!=null&&(m.className=s),h&&h.appendChild(m),m}function N(g,s,h){const m=document.createElementNS("http://www.w3.org/2000/svg",g);for(const x of Object.keys(s))m.setAttributeNS(null,x,String(s[x]));return h&&h.appendChild(m),m}const V=typeof document<"u"?document.documentElement&&document.documentElement.style:null,G=V&&V.userSelect!==void 0?"userSelect":"WebkitUserSelect";let U;function J(){V&&G&&(U=V[G],V[G]="none")}function Z(){V&&G&&(V[G]=U)}function K(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",K,!0)}function re(){window.addEventListener("click",K,!0),window.setTimeout(()=>{window.removeEventListener("click",K,!0)},0)}function ge(g,s){const h=g.getBoundingClientRect();return Ie(g,h,s)}function ve(g,s){const h=g.getBoundingClientRect(),m=[];for(let x=0;x<s.length;x++)m.push(Ie(g,h,s[x]));return m}function $e(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function Ie(g,s,h){const m=g.offsetWidth===s.width?1:g.offsetWidth/s.width;return new i.P((h.clientX-s.left)*m,(h.clientY-s.top)*m)}const ke="01",tt="NO_ACCESS_TOKEN";class Je{constructor(s,h,m){this._transformRequestFn=s,this._customAccessToken=h,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const s=function(){let h="";for(let m=0;m<10;m++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ke,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,h){return this._transformRequestFn&&this._transformRequestFn(s,h)||{url:s}}normalizeStyleURL(s,h){if(!i.h(s))return s;const m=at(s);return m.params.push(`sdk=js-${v}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeGlyphsURL(s,h){if(!i.h(s))return s;const m=at(s);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeModelURL(s,h){if(!i.h(s))return s;const m=at(s);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeSourceURL(s,h,m,x){if(!i.h(s))return s;const b=at(s);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),m&&b.params.push(`language=${m}`),x&&b.params.push(`worldview=${x}`),this._makeAPIURL(b,this._customAccessToken||h)}normalizeIconsetURL(s,h){const m=at(s);return i.h(s)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||h)):pt(m)}normalizeSpriteURL(s,h,m,x){const b=at(s);return i.h(s)?(b.path=`/styles/v1${b.path}/sprite${h}${m}`,this._makeAPIURL(b,this._customAccessToken||x)):(b.path+=`${h}${m}`,pt(b))}normalizeTileURL(s,h,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.h(s))return s;const x=at(s);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||m&&x.authority!=="raster"&&m===512?"@2x":""}${i.k.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const b=this._customAccessToken||function(E){for(const P of E){const M=P.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,b)}canonicalizeTileURL(s,h){const m=at(s);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return s;let x="mapbox://";m.path.match(/^\/raster\/v1\//)?x+=`raster/${m.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${m.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${m.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let b=m.params;return h&&(b=b.filter(E=>!E.match(/^access_token=/))),b.length&&(x+=`?${b.join("&")}`),x}canonicalizeTileset(s,h){const m=!!h&&i.h(h),x=[];for(const b of s.tiles||[])i.j(b)?x.push(this.canonicalizeTileURL(b,m)):x.push(b);return x}_makeAPIURL(s,h){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=at(i.e.API_URL);if(s.protocol=x.protocol,s.authority=x.authority,s.protocol==="http"){const b=s.params.indexOf("secure");b>=0&&s.params.splice(b,1)}if(x.path!=="/"&&(s.path=`${x.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return pt(s);if(h=h||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return s.params=s.params.filter(b=>b.indexOf("access_token")===-1),s.params.push(`access_token=${h||""}`),pt(s)}}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function at(g){const s=g.match(et);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function pt(g){const s=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${s}`}const ft="mapbox.eventData";function Ue(g){if(!g)return null;const s=g.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.l(s[1]))}catch{return null}}class It{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const h=Ue(i.e.ACCESS_TOKEN);let m="";return m=h&&h.u?i.f(h.u):i.e.ACCESS_TOKEN||"",s?`${ft}.${s}:${m}`:`${ft}:${m}`}fetchEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid");if(s)try{const x=localStorage.getItem(h);x&&(this.eventData=JSON.parse(x));const b=localStorage.getItem(m);b&&(this.anonId=b)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid"),x=this.anonId;if(s&&x)try{localStorage.setItem(m,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,h,m,x){if(!i.e.EVENTS_URL)return;const b=at(i.e.EVENTS_URL);b.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(s).toISOString()},P=h?Object.assign(E,h):E,M={url:pt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=i.p(M,B=>{this.pendingRequest=null,m(B),this.saveEventData(),this.processRequests(x)})}queueRequest(s,h){this.queue.push(s),this.processRequests(h)}}const Rt=new class extends It{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(h=>i.h(h)||i.j(h))&&this.queueRequest(Date.now(),s)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Ue(i.e.ACCESS_TOKEN),h=s?s.u:i.e.ACCESS_TOKEN;let m=h!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),m=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),E=new Date(x),P=(x-this.eventData.lastSuccess)/864e5;m=m||P>=1||P<-1||b.getDate()!==E.getDate()}else m=!0;m?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:ke,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=x,this.eventData.tokenU=h)},g):this.processRequests()}},_e=Rt.postTurnstileEvent.bind(Rt),Ge=new class extends It{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,s,h,m){this.skuToken=s,this.errorCb=m,i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},h):this.errorCb(new Error(tt)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:ke,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):s&&(this.success[s]=!0)},g))}remove(){this.errorCb=null}},qe=Ge.postMapLoadEvent.bind(Ge),Xe=new class extends It{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let s=this.mapInstanceIdMap.get(g);return s||(s=i.u(),this.mapInstanceIdMap.set(g,s)),s}getEventId(g){const s=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,s+1),s}postStyleLoadEvent(g,s){const{map:h,style:m,importedStyles:x}=s;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const b=this.getMapInstanceId(h),E={mapInstanceId:b,eventId:this.getEventId(b),style:m};x.length&&(E.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:E},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:h}=this.queue.shift();this.postEvent(s,h,()=>{},g)}},yt=Xe.postStyleLoadEvent.bind(Xe),Dt=new class extends It{constructor(){super("gljs.performance")}postPerformanceEvent(g,s){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:h}=this.queue.shift(),m=function(x){const b=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),P=function(Y){const ee={};if(Y){for(const te in Y)if(te!=="other")for(const ce of Y[te]){const oe=`${te}ResolveRangeMin`,de=`${te}ResolveRangeMax`,xe=`${te}RequestCount`,Ee=`${te}RequestCachedCount`;ee[oe]=Math.min(ee[oe]||1/0,ce.startTime),ee[de]=Math.max(ee[de]||-1/0,ce.responseEnd);const De=Me=>{ee[Me]===void 0&&(ee[Me]=0),++ee[Me]};ce.transferSize!==void 0&&ce.transferSize===0&&De(Ee),De(xe)}}return ee}(function(Y,ee){const te={};if(Y)for(const ce of Y){const oe=ee(ce);te[oe]===void 0&&(te[oe]=[]),te[oe].push(ce)}return te}(b,C)),M=window.devicePixelRatio,B=navigator.connection||navigator.mozConnection||navigator.webkitConnection,j=B?B.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},W=(Y,ee,te)=>{te!=null&&Y.push({name:ee,value:te.toString()})};for(const Y in P)W(X.counters,Y,P[Y]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(W(X.counters,"interactionRangeMin",x.interactionRange[0]),W(X.counters,"interactionRangeMax",x.interactionRange[1])),E)for(const Y of Object.keys(w)){const ee=w[Y],te=E.find(ce=>ce.name===ee);te&&W(X.counters,ee,te.startTime)}return W(X.counters,"visibilityHidden",x.visibilityHidden),W(X.attributes,"style",function(Y){if(Y)for(const ee of Y){const te=ee.name.split("?")[0];if(i.i(te)){const ce=te.split("/").slice(-2);if(ce.length===2)return`mapbox://styles/${ce[0]}/${ce[1]}`}}}(b)),W(X.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),W(X.attributes,"fogEnabled",x.fogEnabled?"true":"false"),W(X.attributes,"projection",x.projection),W(X.attributes,"zoom",x.zoom),W(X.metadata,"devicePixelRatio",M),W(X.metadata,"connectionEffectiveType",j),W(X.metadata,"navigatorUserAgent",navigator.userAgent),W(X.metadata,"screenWidth",window.screen.width),W(X.metadata,"screenHeight",window.screen.height),W(X.metadata,"windowWidth",window.innerWidth),W(X.metadata,"windowHeight",window.innerHeight),W(X.metadata,"mapWidth",x.width/M),W(X.metadata,"mapHeight",x.height/M),W(X.metadata,"webglRenderer",x.renderer),W(X.metadata,"webglVendor",x.vendor),W(X.metadata,"sdkVersion",v),W(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(h);for(const x of m.metadata);for(const x of m.counters);for(const x of m.attributes);this.postEvent(s,m,()=>{},g)}},Yt=Dt.postPerformanceEvent.bind(Dt),St=new class extends It{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,s,h,m){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=at(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${s||""}`),x.params.push(`access_token=${m||i.e.ACCESS_TOKEN||""}`);const b={url:pt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(b,E=>{this.pendingRequest=null,h(E),this.saveEventData(),this.processRequests(m)})}getSessionAPI(g,s,h,m){this.skuToken=s,this.errorCb=m,i.e.SESSION_PATH&&i.e.API_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},h):this.errorCb(new Error(tt)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||this.getSession(h,this.skuToken,m=>{m?this.errorCb(m):s&&(this.success[s]=!0)},g)}remove(){this.errorCb=null}},Mt=St.getSessionAPI.bind(St),Sr=new Set;function Ne(g,s){s?Sr.add(g):Sr.delete(g)}class un{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,h){this._updatedSourceCaches[s]=h,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const h=s.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(s.id),this.setDirty()}removeLayer(s){const h=s.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][s.id]=s,this._updatedLayers[h].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const h in this._updatedLayers)s[h]=s[h]||{},s[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)s[h]=s[h]||{},s[h].removedIds=Object.keys(this._removedLayers[h]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(s){return this._updatedImages[s]?Array.from(this._updatedImages[s].values()):[]}updateImage(s,h){this._updatedImages[h]=this._updatedImages[h]||new Set,this._updatedImages[h].add(i.I.toString(s)),this.setDirty()}resetUpdatedImages(s){this._updatedImages[s]&&this._updatedImages[s].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function kr(g){const{userImage:s}=g;return!!(s&&s.render&&s.render())&&(g.data.replace(new Uint8Array(s.data.buffer)),!0)}class Br extends i.E{constructor(s){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.r()&&(this.imageRasterizerDispatcher=new i.D(i.t(),this,"Image Rasterizer Worker",1))}addScope(s){this.loaded.set(s,!1),this.imageProviders.set(s,new Map),this.images.set(s,new Map),this.updatedImages.set(s,new Set),this.callbackDispatchedThisFrame.set(s,new Set),this.patterns.set(s,new Map),this.atlasImage.set(s,new i.q({width:1,height:1}))}removeScope(s){this.loaded.delete(s),this.imageProviders.delete(s),this.images.delete(s),this.updatedImages.delete(s),this.callbackDispatchedThisFrame.delete(s),this.patterns.delete(s),this.atlasImage.delete(s);const h=this.atlasTexture.get(s);h&&(h.destroy(),this.atlasTexture.delete(s))}addImageProvider(s,h){this.imageProviders.has(h)||this.imageProviders.set(h,new Map),this.imageProviders.get(h).set(s.id,s)}removeImageProvider(s,h){this.imageProviders.has(h)&&this.imageProviders.get(h).delete(s)}getPendingImageProviders(){const s=[];for(const h of this.imageProviders.values())for(const m of h.values())m.hasPendingRequests()&&s.push(m);return s}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.x),this._imageRasterizer}isLoaded(){for(const s of this.loaded.keys())if(!this.loaded.get(s))return!1;return!0}setLoaded(s,h){if(this.loaded.get(h)!==s&&(this.loaded.set(h,s),s)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,h,x);this.requestors=[]}}hasImage(s,h){return!!this.getImage(s,h)}getImage(s,h){return this.images.get(h).get(s.toString())}addImage(s,h,m){this._validate(s,m)&&this.images.get(h).set(s.toString(),m)}_validate(s,h){let m=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new i.y(new Error(`Image "${s.name}" has invalid "stretchX" value`))),m=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new i.y(new Error(`Image "${s.name}" has invalid "stretchY" value`))),m=!1),this._validateContent(h.content,h)||(this.fire(new i.y(new Error(`Image "${s.name}" has invalid "content" value`))),m=!1),m}_validateStretch(s,h){if(!s)return!0;let m=0;for(const x of s){if(x[0]<m||x[1]<x[0]||h<x[1])return!1;m=x[1]}return!0}_validateContent(s,h){return s?s.length!==4||!h.usvg&&(s[0]<0||h.data.width<s[0]||s[1]<0||h.data.height<s[1]||s[2]<0||h.data.width<s[2]||s[3]<0||h.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,h,m){const x=this.images.get(h).get(s.toString());m.version=x.version+1,this.images.get(h).set(s.toString(),m),this.updatedImages.get(h).add(s),this.removeFromImageRasterizerCache(s,h)}clearUpdatedImages(s){this.updatedImages.get(s).clear()}removeFromImageRasterizerCache(s,h){this.spriteFormat!=="raster"&&(i.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:h}):this.imageRasterizer.removeImagesFromCacheByIds([s],h))}removeImage(s,h){const m=this.images.get(h),x=m.get(s.toString());m.delete(s.toString()),this.patterns.get(h).delete(s.toString()),this.removeFromImageRasterizerCache(s,h),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(s){return Array.from(this.images.get(s).keys()).map(h=>i.I.from(h))}getImages(s,h,m){const x=[],b=[],E=this.imageProviders.get(h);for(const j of s){if(!j.iconsetId){x.push(j);continue}const X=E.get(j.iconsetId);X&&(this.getImage(j,h)?b.push(j):X.addPendingRequest(j))}if(x.length===0)return void this._notify(b,h,m);let P=!0;const M=!!this.loaded.get(h),B=this.images.get(h);if(!M)for(const j of x)B.has(j.toString())||(P=!1);M||P?this._notify(x,h,m):this.requestors.push({ids:x,scope:h,callback:m})}rasterizeImages(s,h){const m=new Map,{tasks:x,scope:b}=s;for(const[E,P]of x.entries()){const M=this.getImage(P.id,b);M&&m.set(E,{image:M,imageVariant:P})}this._rasterizeImages(b,m,h)}_rasterizeImages(s,h,m){if(i.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:h,scope:s},m);else{const x=new Map;for(const[b,{image:E,imageVariant:P}]of h.entries())x.set(b,this.imageRasterizer.rasterize(P,E,s,0));m(void 0,x)}}getUpdatedImages(s){return this.updatedImages.get(s)||new Set}_notify(s,h,m){const x=this.images.get(h),b=new Map;for(const E of s){if(!x.get(E.toString())){if(E.iconsetId)continue;this.fire(new i.z("styleimagemissing",{id:E.name}))}const P=x.get(E.toString());if(!P){i.w(`Image "${E.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const M={data:P.usvg?null:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,usvg:P.usvg,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)};P.usvg&&Object.assign(M,{width:P.icon.usvg_tree.width,height:P.icon.usvg_tree.height}),b.set(i.I.toString(E),M)}m(null,b)}getPixelSize(s){const{width:h,height:m}=this.atlasImage.get(s);return{width:h,height:m}}getPattern(s,h,m){const x=s.toString(),b=this.patterns.get(h),E=b.get(x),P=this.getImage(s,h);if(!P)return null;if(E){if(E.position.version===P.version)return E.position;E.position.version=P.version}else{if(P.usvg&&!P.data){const M=this.getPatternInFlightId(x,h);if(this.patternsInFlight.has(M))return null;this.patternsInFlight.add(M);const B=new i.A(s).scaleSelf(i.o.devicePixelRatio),j=new Map([[B.toString(),{image:P,imageVariant:B}]]);return this._rasterizeImages(h,j,(X,W)=>this.storePatternImage(B,h,P,m,W)),null}this.storePattern(s,h,P)}return this._updatePatternAtlas(h,m),b.get(x).position}getPatternInFlightId(s,h){return i.B(s,h)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,h,m,x,b){const E=s.toString(),P=b?b.get(E):void 0;P&&(m.data=P,this.storePattern(s.id,h,m),this._updatePatternAtlas(h,x),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),h)))}storePattern(s,h,m){const x={w:m.data.width+2*i.C,h:m.data.height+2*i.C,x:0,y:0},b=new i.F(x,m,i.C);this.patterns.get(h).set(s.toString(),{bin:x,position:b})}destroyAtlasTextures(){for(const s of this.atlasTexture.values())s&&s.destroy();this.atlasTexture.clear()}bind(s,h){const m=s.gl;let x=this.atlasTexture.get(h);x?this.dirty&&(x.update(this.atlasImage.get(h)),this.dirty=!1):(x=new i.T(s,this.atlasImage.get(h),m.RGBA8),this.atlasTexture.set(h,x)),x.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(s,h){const m=this.patterns.get(s),x=Array.from(m.values()).map(({bin:B})=>B),{w:b,h:E}=i.G(x),P=this.atlasImage.get(s);P.resize({width:b||1,height:E||1});const M=this.images.get(s);for(const[B,{bin:j,position:X}]of m.entries()){let W=X.padding;const Y=j.x+W,ee=j.y+W,te=M.get(B).data,ce=te.width,oe=te.height;W=W>1?W-1:W,i.q.copy(te,P,{x:0,y:0},{x:Y,y:ee},{width:ce,height:oe},h),i.q.copy(te,P,{x:0,y:oe-W},{x:Y,y:ee-W},{width:ce,height:W},h),i.q.copy(te,P,{x:0,y:0},{x:Y,y:ee+oe},{width:ce,height:W},h),i.q.copy(te,P,{x:ce-W,y:0},{x:Y-W,y:ee},{width:W,height:oe},h),i.q.copy(te,P,{x:0,y:0},{x:Y+ce,y:ee},{width:W,height:oe},h),i.q.copy(te,P,{x:ce-W,y:oe-W},{x:Y-W,y:ee-W},{width:W,height:W},h),i.q.copy(te,P,{x:0,y:oe-W},{x:Y+ce,y:ee-W},{width:W,height:W},h),i.q.copy(te,P,{x:0,y:0},{x:Y+ce,y:ee+oe},{width:W,height:W},h),i.q.copy(te,P,{x:ce-W,y:0},{x:Y-W,y:ee+oe},{width:W,height:W},h)}this.dirty=!0}beginFrame(){for(const s of this.images.keys())this.callbackDispatchedThisFrame.set(s,new Set)}dispatchRenderCallbacks(s,h){const m=this.images.get(h);for(const x of s){if(this.callbackDispatchedThisFrame.get(h).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(h).add(x.toString());const b=m.get(x.toString());kr(b)&&this.updateImage(x,h,b)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function Yr(g){const s=g.value,h=g.valueSpec,m=g.style,x=g.styleSpec,b=g.key,E=g.arrayElementValidator||ti;if(!Array.isArray(s))return[new i.V(b,s,`array expected, ${i.K(s)} found`)];if(h.length&&s.length!==h.length)return[new i.V(b,s,`array length ${h.length} expected, length ${s.length} found`)];if(h["min-length"]&&s.length<h["min-length"])return[new i.V(b,s,`array length at least ${h["min-length"]} expected, length ${s.length} found`)];let P={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};x.$version<7&&(P.function=h.function),i.H(h.value)&&(P=h.value);let M=[];for(let B=0;B<s.length;B++)M=M.concat(E({array:s,arrayIndex:B,value:s[B],valueSpec:P,style:m,styleSpec:x,key:`${b}[${B}]`},!0));return M}function Tr(g){const s=g.key,h=g.value,m=g.valueSpec;if(!i.L(h))return[new i.V(s,h,`number expected, ${i.K(h)} found`)];if(h!=h)return[new i.V(s,h,"number expected, NaN found")];if("minimum"in m){let x=m.minimum;if(Array.isArray(m.minimum)&&(x=m.minimum[g.arrayIndex]),h<x)return[new i.V(s,h,`${h} is less than the minimum value ${x}`)]}if("maximum"in m){let x=m.maximum;if(Array.isArray(m.maximum)&&(x=m.maximum[g.arrayIndex]),h>x)return[new i.V(s,h,`${h} is greater than the maximum value ${x}`)]}return[]}function jn(g){const s=g.key,h=g.value;if(!i.H(h))return[new i.V(s,h,`object expected, ${i.K(h)} found`)];const m=g.valueSpec,x=i.J(h.type);let b,E,P,M={};const B=x!=="categorical"&&h.property===void 0,j=!B,X=function(te){const ce=te.stops;return Array.isArray(ce)&&Array.isArray(ce[0])&&i.H(ce[0][0])}(h),W=ia({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(te){if(x==="identity")return[new i.V(te.key,te.value,'identity function may not have a "stops" property')];let ce=[];const oe=te.value;return ce=ce.concat(Yr({key:te.key,value:oe,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:Y})),Array.isArray(oe)&&oe.length===0&&ce.push(new i.V(te.key,oe,"array must have at least one stop")),ce},default:function(te){return ti({key:te.key,value:te.value,valueSpec:m,style:te.style,styleSpec:te.styleSpec})}}});return x==="identity"&&B&&W.push(new i.V(g.key,g.value,'missing required property "property"')),x==="identity"||h.stops||W.push(new i.V(g.key,g.value,'missing required property "stops"')),x==="exponential"&&m.expression&&!i.M(m)&&W.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(j&&!i.N(m)?W.push(new i.V(g.key,g.value,"property functions not supported")):B&&!i.O(m)&&W.push(new i.V(g.key,g.value,"zoom functions not supported"))),x!=="categorical"&&!X||h.property!==void 0||W.push(new i.V(g.key,g.value,'"property" property is required')),W;function Y(te){let ce=[];const oe=te.value,de=te.key;if(!Array.isArray(oe))return[new i.V(de,oe,`array expected, ${i.K(oe)} found`)];if(oe.length!==2)return[new i.V(de,oe,`array length 2 expected, length ${oe.length} found`)];if(X){if(!i.H(oe[0]))return[new i.V(de,oe,`object expected, ${i.K(oe[0])} found`)];const xe=oe[0];if(xe.zoom===void 0)return[new i.V(de,oe,"object stop key must have zoom")];if(xe.value===void 0)return[new i.V(de,oe,"object stop key must have value")];const Ee=i.J(xe.zoom);if(typeof Ee!="number")return[new i.V(de,xe.zoom,"stop zoom values must be numbers")];if(P&&P>Ee)return[new i.V(de,xe.zoom,"stop zoom values must appear in ascending order")];Ee!==P&&(P=Ee,E=void 0,M={}),ce=ce.concat(ia({key:`${de}[0]`,value:oe[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Tr,value:ee}}))}else ce=ce.concat(ee({key:`${de}[0]`,value:oe[0],style:te.style,styleSpec:te.styleSpec},oe));return i.Q(i.S(oe[1]))?ce.concat([new i.V(`${de}[1]`,oe[1],"expressions are not allowed in function stops.")]):ce.concat(ti({key:`${de}[1]`,value:oe[1],valueSpec:m,style:te.style,styleSpec:te.styleSpec}))}function ee(te,ce){const oe=i.K(te.value),de=i.J(te.value),xe=te.value!==null?te.value:ce;if(b){if(oe!==b)return[new i.V(te.key,xe,`${oe} stop domain type must match previous stop domain type ${b}`)]}else b=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new i.V(te.key,xe,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&x!=="categorical"){let Ee=`number expected, ${oe} found`;return i.N(m)&&x===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(te.key,xe,Ee)]}return x!=="categorical"||oe!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?x!=="categorical"&&oe==="number"&&typeof de=="number"&&typeof E=="number"&&E!==void 0&&de<E?[new i.V(te.key,xe,"stop domain values must appear in ascending order")]:(E=de,x==="categorical"&&de in M?[new i.V(te.key,xe,"stop domain values must be unique")]:(M[de]=!0,[])):[new i.V(te.key,xe,`integer expected, found ${String(de)}`)]}}function Un(g){const s=(g.expressionContext==="property"?i.W:i.U)(i.S(g.value),g.valueSpec);if(s.result==="error")return s.value.map(m=>new i.V(`${g.key}${m.key}`,g.value,m.message));const h=s.value.expression||s.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!h.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.Z(h))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return Wi(h,g);if(g.expressionContext==="appearance")return Yn(h,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(h,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(h))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wi(g,s){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const x of s.valueSpec.expression.parameters)h.delete(x);if(h.size===0)return[];const m=[];return g instanceof i._&&h.has(g.name)?[new i.V(s.key,s.value,`["${g.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(g.eachChild(x=>{m.push(...Wi(x,s))}),m)}function Yn(g,s){const h=new Set;if(s.valueSpec&&s.valueSpec.expression)for(const x of s.valueSpec.expression.parameters)h.add(x);if(h.size===0)return[];const m=[];return g instanceof i._&&!h.has(g.name)?[new i.V(s.key,s.value,`["${g.name}"] is not an allowed parameter`)]:(g.eachChild(x=>{m.push(...Yn(x,s))}),m)}function ta(g){const s=g.key,h=g.value,m=g.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(i.J(h))===-1&&x.push(new i.V(s,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(i.J(h))===-1&&x.push(new i.V(s,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),x}function Di(g){return i.a2(i.S(g.value))?Un(Object.assign({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):ra(g)}function ra(g){const s=g.value,h=g.key;if(!Array.isArray(s))return[new i.V(h,s,`array expected, ${i.K(s)} found`)];if(s.length<1)return[new i.V(h,s,"filter array must have at least 1 element")];const m=g.styleSpec;let x=ta({key:`${h}[0]`,value:s[0],valueSpec:m.filter_operator});switch(i.J(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.J(s[1])==="$type"&&x.push(new i.V(h,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new i.V(h,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(i.a0(s[1])||x.push(new i.V(`${h}[1]`,s[1],`string expected, ${i.K(s[1])} found`)));for(let b=2;b<s.length;b++)i.J(s[1])==="$type"?x=x.concat(ta({key:`${h}[${b}]`,value:s[b],valueSpec:m.geometry_type})):i.a0(s[b])||i.L(s[b])||i.$(s[b])||x.push(new i.V(`${h}[${b}]`,s[b],`string, number, or boolean expected, ${i.K(s[b])} found.`));break;case"any":case"all":case"none":for(let b=1;b<s.length;b++)x=x.concat(ra({key:`${h}[${b}]`,value:s[b],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":s.length!==2?x.push(new i.V(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):i.a0(s[1])||x.push(new i.V(`${h}[1]`,s[1],`string expected, ${i.K(s[1])} found`))}return x}function Ra(g,s){const h=g.key,m=g.style,x=g.layer,b=g.styleSpec,E=g.value,P=g.objectKey,M=b[`${s}_${g.layerType}`];if(!M)return[];const B=P.match(/^(.*)-use-theme$/);if(B&&M[B[1]])return i.Q(E)?[].concat(ti({key:g.key,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:P})):ti({key:h,value:E,valueSpec:{type:"string"},style:m,styleSpec:b});const j=P.match(/^(.*)-transition$/);if(s==="paint"&&j&&M[j[1]]&&M[j[1]].transition)return ti({key:h,value:E,valueSpec:b.transition,style:m,styleSpec:b});const X=g.valueSpec||M[P];if(!X)return[new i.a3(h,E,`unknown property "${P}"`)];let W;if(i.a0(E)&&i.N(X)&&!X.tokens&&(W=/^{([^}]+)}$/.exec(E))){const ee=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new i.V(h,E,`"${P}" does not support interpolation syntax
Use an identity property function instead: ${ee}.`)]}const Y=[];if(g.layerType==="symbol")P!=="text-field"||!m||m.glyphs||m.imports||Y.push(new i.V(h,E,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&i.a4(i.S(E))&&i.J(E.type)==="identity"&&Y.push(new i.V(h,E,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&s==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.N(X)&&(i.a5(X)||i.O(X))){const ee=i.W(i.S(E),X),te=ee.value.expression||ee.value._styleExpression.expression;te&&!i.X(te,["measure-light"])&&(P==="model-emissive-strength"&&i.Y(te)&&i.Z(te)||Y.push(new i.V(h,E,`${P} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Y.concat(ti({key:g.key,value:E,valueSpec:X,style:m,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:P}))}function ei(g){return Ra(g,"paint")}function na(g){return Ra(g,"layout")}function wa(g){let s=[];const h=g.value,m=g.key,x=g.style,b=g.styleSpec;if(!i.H(h))return[new i.V(m,h,"object expected")];h.type||h.ref||s.push(new i.V(m,h,'either "type" or "ref" is required'));let E=i.J(h.type);const P=i.J(h.ref);if(h.id){const M=i.J(h.id);for(let B=0;B<g.arrayIndex;B++){const j=x.layers[B];i.J(j.id)===M&&s.push(new i.V(m,h.id,`duplicate layer id "${M}", previously used at line ${j.id.__line__}`))}}if("ref"in h){let M;["type","source","source-layer","filter","layout"].forEach(B=>{B in h&&s.push(new i.V(m,h[B],`"${B}" is prohibited for ref layers`))}),x.layers.forEach(B=>{i.J(B.id)===P&&(M=B)}),M?M.ref?s.push(new i.V(m,h.ref,"ref cannot reference another ref layer")):E=i.J(M.type):typeof P=="string"&&s.push(new i.V(m,h.ref,`ref layer "${P}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(h.source)if(i.a0(h.source)){const M=x.sources&&x.sources[h.source],B=M&&i.J(M.type);M?B==="vector"&&E==="raster"?s.push(new i.V(m,h.source,`layer "${h.id}" requires a raster source`)):B==="raster"&&E!=="raster"?s.push(new i.V(m,h.source,`layer "${h.id}" requires a vector source`)):B!=="vector"||h["source-layer"]?B==="raster-dem"&&E!=="hillshade"?s.push(new i.V(m,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="raster-array"||["raster","raster-particle"].includes(E)?E==="line"&&h.paint&&(h.paint["line-gradient"]||h.paint["line-trim-offset"])&&B==="geojson"&&!M.lineMetrics?s.push(new i.V(m,h,`layer "${h.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):E==="raster-particle"&&B!=="raster-array"&&s.push(new i.V(m,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):s.push(new i.V(m,h.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(m,h,`layer "${h.id}" must specify a "source-layer"`)):s.push(new i.V(m,h.source,`source "${h.source}" not found`))}else s.push(new i.V(`${m}.source`,h.source,'"source" must be a string'));else s.push(new i.V(m,h,'missing required property "source"'));return s=s.concat(ia({key:m,value:h,valueSpec:b.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ti({key:`${m}.type`,value:h.type,valueSpec:b.layer.type,style:g.style,styleSpec:g.styleSpec,object:h,objectKey:"type"}),filter:M=>Di(Object.assign({layerType:E},M)),layout:M=>ia({layer:h,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":B=>na(Object.assign({layerType:E},B))}}),paint:M=>ia({layer:h,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":B=>ei(Object.assign({layerType:E,layer:h},B))}}),appearances(M){const B=Yr({key:M.key,value:M.value,valueSpec:M.valueSpec,style:M.style,styleSpec:M.styleSpec,arrayElementValidator:W=>function(Y){const{key:ee,layer:te,layerType:ce}=Y,oe=i.J(Y.value),de=i.J(oe.name),xe=i.J(oe.condition),Ee=ia({key:ee,value:oe,valueSpec:Y.styleSpec.appearance,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{condition:De=>function(Me){const Fe=[];return Fe.push(...Un({key:Me.key,value:Me.object.condition,valueSpec:i.a6.appearance.condition,expressionContext:"appearance"})),Fe}(Object.assign({layer:te,layerType:ce},De)),properties:De=>function(Me){const Fe=[],{styleSpec:Re,layer:Oe,layerType:Le}=Me,ct=Re[`paint_${Le}`],Ke=Re[`layout_${Le}`],vt=Me.object[Me.objectKey];for(const st in vt){const _t=st in ct?"paint":st in Ke?"layout":void 0;if(!_t){Fe.push(new i.V(Me.key,st,`unknown property "${st}" for layer type "${Le}"`));continue}const Ht=Object.assign({},Me,{key:`${Me.key}.${st}`,object:vt,objectKey:st,layer:Oe,layerType:Le,value:vt[st],valueSpec:_t==="paint"?ct[st]:Ke[st]});Fe.push(...Ra(Ht,_t))}return Fe}(Object.assign({layer:te,layerType:ce},De))}});return de==="hidden"||xe||Ee.push(new i.V(Y.key,"name",'Appearance with name different than "hidden" must have a condition')),Ee}(Object.assign({layerType:E,layer:h},W))}),j=Array.isArray(M.value)?M.value:[],X=new Set;return j.forEach((W,Y)=>{const ee=i.J(W.name);if(ee)if(X.has(ee)){const te=i.J(h.id);B.push(new i.V(M.key,ee,`Duplicated appearance name "${ee}" for layer "${te}"`))}else X.add(ee)}),B}}})),s}function Da({key:g,value:s}){return i.a0(s)?[]:[new i.V(g,s,`string expected, ${i.K(s)} found`)]}const _n={promoteId:function g({key:s,value:h}){if(i.a0(h))return Da({key:s,value:h});if(Array.isArray(h)){const x=[],b=i.S(h),E=i.U(b);return E.result==="error"&&E.value.forEach(P=>{x.push(new i.V(`${s}${P.key}`,null,`${P.message}`))}),i.X(E.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||x.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),x}if(!i.H(h))return[new i.V(s,h,`string, expression or object expected, "${i.K(h)}" found`)];const m=[];for(const x in h)m.push(...g({key:`${s}.${x}`,value:h[x]}));return m}};function Nn(g){const s=g.value,h=g.key,m=g.styleSpec,x=g.style;if(!i.H(s))return[new i.V(h,s,`object expected, ${i.K(s)} found`)];if(!("type"in s))return[new i.V(h,s,'"type" is required')];const b=i.J(s.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&("url"in s||"tiles"in s||E.push(new i.a3(h,s,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(ia({key:h,value:s,valueSpec:m[`source_${b.replace("-","_")}`],style:g.style,styleSpec:m,objectElementValidators:_n})),E;case"geojson":if(E=ia({key:h,value:s,valueSpec:m.source_geojson,style:x,styleSpec:m,objectElementValidators:_n}),"cluster"in s&&"clusterProperties"in s){if(!i.H(s.clusterProperties))return[new i.V(`${h}.clusterProperties`,s,`object expected, ${i.K(s)} found`)];for(const P in s.clusterProperties){const M=s.clusterProperties[P];if(!Array.isArray(M))return[new i.V(`${h}.clusterProperties.${P}`,M,"array expected")];const[B,j]=M,X=typeof B=="string"?[B,["accumulated"],["get",P]]:B;E.push(...Un({key:`${h}.${P}.map`,value:j,expressionContext:"cluster-map"})),E.push(...Un({key:`${h}.${P}.reduce`,value:X,expressionContext:"cluster-reduce"}))}}return E;case"video":return ia({key:h,value:s,valueSpec:m.source_video,style:x,styleSpec:m});case"image":return ia({key:h,value:s,valueSpec:m.source_image,style:x,styleSpec:m});case"canvas":return[new i.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ta({key:`${h}.type`,value:s.type,valueSpec:{values:Gi(m)}})}}function Gi(g){return g.source.reduce((s,h)=>{const m=g[h];return m.type.type==="enum"&&(s=s.concat(Object.keys(m.type.values))),s},[])}function ji(g){const s=g.value,h=g.styleSpec,m=h.light,x=g.style;if(s===void 0)return[];if(!i.H(s))return[new i.V("light",s,`object expected, ${i.K(s)} found`)];let b=[];for(const E in s){const P=E.match(/^(.*)-transition$/),M=E.match(/^(.*)-use-theme$/);b=b.concat(M&&m[M[1]]?ti({key:E,value:s[E],valueSpec:{type:"string"},style:x,styleSpec:h}):P&&m[P[1]]&&m[P[1]].transition?ti({key:E,value:s[E],valueSpec:h.transition,style:x,styleSpec:h}):m[E]?ti({key:E,value:s[E],valueSpec:m[E],style:x,styleSpec:h}):[new i.V(E,s[E],`unknown property "${E}"`)])}return b}function ba(g){const s=g.value;if(!s)return[];const h=g.key;if(!i.H(s))return[new i.V(h,s,`object expected, ${i.K(s)} found`)];let m=[];const x=g.styleSpec,b=x["light-3d"],E=g.style,P=g.style.lights;for(const j of["type","id"])if(!(j in s))return m=m.concat([new i.V(h,s,`missing property "${j}"`)]),m;if(!i.a0(s.type))return m=m.concat([new i.V(`${h}.type`,s.type,"string expected")]),m;if(P)for(let j=0;j<g.arrayIndex;j++){const X=i.J(s.type),W=P[j];i.J(W.type)===X&&m.push(new i.V(h,s.id,`duplicate light type "${s.type}", previously defined at line ${W.id.__line__}`))}const M=`properties_light_${s.type}`;if(!(M in x))return m=m.concat([new i.V(`${h}.type`,s,`Invalid light type ${s.type}`)]),m;const B=x[M];for(const j in s)if(j==="properties"){const X=s[j];if(!i.H(X))return m=m.concat([new i.V("properties",X,`object expected, ${i.K(X)} found`)]),m;for(const W in X){const Y=W.match(/^(.*)-transition$/),ee=W.match(/^(.*)-use-theme$/);m=m.concat(ee&&B[ee[1]]?ti({key:j,value:X[W],valueSpec:{type:"string"},style:E,styleSpec:x}):Y&&B[Y[1]]&&B[Y[1]].transition?ti({key:j,value:s[j],valueSpec:x.transition,style:E,styleSpec:x}):B[W]?ti({key:W,value:X[W],valueSpec:B[W],style:E,styleSpec:x}):[new i.a3(g.key,X[W],`unknown property "${W}"`)])}}else m=m.concat(b[j]?ti({key:j,value:s[j],valueSpec:b[j],style:E,styleSpec:x}):[new i.a3(j,s[j],`unknown property "${j}"`)]);return m}function Bo(g){const s=g.value,h=g.key,m=g.style,x=g.styleSpec,b=x.terrain;if(s==null)return[];if(!i.H(s))return[new i.V("terrain",s,`object expected, ${i.K(s)} found`)];let E=[];for(const P in s){const M=P.match(/^(.*)-transition$/),B=P.match(/^(.*)-use-theme$/);E=E.concat(B&&b[B[1]]?ti({key:P,value:s[P],valueSpec:{type:"string"},style:m,styleSpec:x}):M&&b[M[1]]&&b[M[1]].transition?ti({key:P,value:s[P],valueSpec:x.transition,style:m,styleSpec:x}):b[P]?ti({key:P,value:s[P],valueSpec:b[P],style:m,styleSpec:x}):[new i.a3(P,s[P],`unknown property "${P}"`)])}if(s.source)if(i.a0(s.source)){const P=m.sources&&m.sources[s.source],M=P&&i.J(P.type);P?M!=="raster-dem"&&E.push(new i.V(`${h}.source`,s.source,`terrain cannot be used with a source of type ${M}, it only be used with a "raster-dem" source type`)):E.push(new i.V(`${h}.source`,s.source,`source "${s.source}" not found`))}else E.push(new i.V(`${h}.source`,s.source,"source must be a string"));else E.push(new i.V(h,s,'terrain is missing required property "source"'));return E}function uo(g){const s=g.value,h=g.style,m=g.styleSpec,x=m.fog;if(s===void 0)return[];if(!i.H(s))return[new i.V("fog",s,`object expected, ${i.K(s)} found`)];let b=[];for(const E in s){const P=E.match(/^(.*)-transition$/),M=E.match(/^(.*)-use-theme$/);b=b.concat(M&&x[M[1]]?ti({key:E,value:s[E],valueSpec:{type:"string"},style:h,styleSpec:m}):P&&x[P[1]]&&x[P[1]].transition?ti({key:E,value:s[E],valueSpec:m.transition,style:h,styleSpec:m}):x[E]?ti({key:E,value:s[E],valueSpec:x[E],style:h,styleSpec:m}):[new i.a3(E,s[E],`unknown property "${E}"`)])}return b}const xl={"*":()=>[],array:Yr,boolean:function(g){const s=g.value,h=g.key;return i.$(s)?[]:[new i.V(h,s,`boolean expected, ${i.K(s)} found`)]},number:Tr,color:function({key:g,value:s}){return i.a0(s)?i.a1.parseCSSColor(s)===null?[new i.V(g,s,`color expected, "${s}" found`)]:[]:[new i.V(g,s,`color expected, ${i.K(s)} found`)]},enum:ta,filter:Di,function:jn,layer:wa,object:ia,source:Nn,model:i.a7,light:ji,"light-3d":ba,terrain:Bo,fog:uo,string:Da,formatted:function(g){return Da(g).length===0?[]:Un(g)},resolvedImage:function(g){return Da(g).length===0?[]:Un(g)},projection:function(g){const s=g.value,h=g.styleSpec,m=h.projection,x=g.style;if(i.H(s)){let b=[];for(const E in s)b=b.concat(ti({key:E,value:s[E],valueSpec:m[E],style:x,styleSpec:h}));return b}return i.a0(s)?[]:[new i.V("projection",s,`object or string expected, ${i.K(s)} found`)]},import:function(g){const s=g.key,{value:h,styleSpec:m}=g;if(!i.H(h))return[new i.V(s,h,"import must be an object")];const{data:x,...b}=h;Object.defineProperty(b,"__line__",{value:h.__line__,enumerable:!1});let E=ia(Object.assign({},g,{value:b,valueSpec:m.import}));return i.J(b.id)===""&&E.push(new i.V(`${g.key}.id`,b,"import id can't be an empty string")),x&&(E=E.concat(bl(x,m,{key:`${g.key}.data`}))),E},iconset:function(g){const s=g.value,h=g.key,m=g.styleSpec,x=g.style;if(!i.H(s))return[new i.V(h,s,"object expected")];if(!s.type)return[new i.V(h,s,'"type" is required')];const b=i.J(s.type);let E=[];if(E=E.concat(ia({key:h,value:s,valueSpec:m[`iconset_${b}`],style:x,styleSpec:m})),function(P,M){return!(P!=="source"||!M.source)}(b,s)){const P=x.sources&&x.sources[s.source],M=P&&i.J(P.type);P?M!=="raster-array"&&E.push(new i.V(h,s.source,`iconset cannot be used with a source of type ${String(M)}, it only be used with a "raster-array" source type`)):E.push(new i.V(h,s.source,`source "${s.source}" not found`))}return E}};function ti(g,s=!1){const h=g.value,m=g.valueSpec,x=g.styleSpec;if(m.expression){if(i.a4(i.J(h)))return jn(g);if(i.Q(i.S(h)))return Un(g)}if(m.type&&xl[m.type]){const b=xl[m.type](g);return s===!0&&b.length>0&&Array.isArray(g.value)?Un(g):b}return ia(Object.assign({},g,{valueSpec:m.type?x[m.type]:m}))}function ia(g){const s=g.key,h=g.value,m=g.valueSpec||{},x=g.objectElementValidators||{},b=g.style,E=g.styleSpec;if(!i.H(h))return[new i.V(s,h,`object expected, ${i.K(h)} found`)];let P=[];for(const M in h){const B=M.split(".")[0];let j;x[B]?j=x[B]:m[B]?j=ti:x["*"]?j=x["*"]:m["*"]&&(j=ti),j?P=P.concat(j({key:(s&&`${s}.`)+M,value:h[M],valueSpec:m[B]||m["*"],style:b,styleSpec:E,object:h,objectKey:M},h)):P.push(new i.a3(s,h[M],`unknown property "${M}"`))}for(const M in m)x[M]||m[M].required&&m[M].default===void 0&&h[M]===void 0&&P.push(new i.V(s,h,`missing required property "${M}"`));return P}function wl({key:g,value:s}){const h=Da({key:g,value:s});if(h.length)return h;const m=s;return m.indexOf("{fontstack}")===-1&&h.push(new i.V(g,s,'"glyphs" url must include a "{fontstack}" token')),m.indexOf("{range}")===-1&&h.push(new i.V(g,s,'"glyphs" url must include a "{range}" token')),h}function bl(g,s=i.a6,h={}){return ia({key:h.key||"",value:g,valueSpec:Object.assign(s.$root,{"*":{type:"*"}}),styleSpec:s,style:g,objectElementValidators:{glyphs:wl}})}function To(g,s=i.a6){return je(bl(g,s))}const ro=g=>je(Nn(g)),jc=g=>je(ji(g)),yn=g=>je(ba(g)),Pt=g=>je(Bo(g)),si=g=>je(uo(g)),So=g=>je(function(s){const h=s.value,m=s.style,x=s.styleSpec,b=x.snow;if(h===void 0)return[];if(!i.H(h))return[new i.V("snow",h,`object expected, ${i.K(h)} found`)];let E=[];for(const P in h){const M=P.match(/^(.*)-transition$/);E=E.concat(M&&b[M[1]]&&b[M[1]].transition?ti({key:P,value:h[P],valueSpec:x.transition,style:m,styleSpec:x}):b[P]?ti({key:P,value:h[P],valueSpec:b[P],style:m,styleSpec:x}):[new i.a3(P,h[P],`unknown property "${P}"`)])}return E}(g)),Ha=g=>je(function(s){const h=s.value,m=s.style,x=s.styleSpec,b=x.rain;if(h===void 0)return[];if(!i.H(h))return[new i.V("rain",h,`object expected, ${i.K(h)} found`)];let E=[];for(const P in h){const M=P.match(/^(.*)-transition$/);E=E.concat(M&&b[M[1]]&&b[M[1]].transition?ti({key:P,value:h[P],valueSpec:x.transition,style:m,styleSpec:x}):b[P]?ti({key:P,value:h[P],valueSpec:b[P],style:m,styleSpec:x}):[new i.a3(P,h[P],`unknown property "${P}"`)])}return E}(g)),Qe=g=>je(wa(g)),se=g=>je(Di(g)),he=g=>je(ei(g)),Pe=g=>je(na(g)),We=g=>je(i.a7(g));function je(g){return g.slice().sort((s,h)=>s.line&&h.line?s.line-h.line:0)}function Q(g,s){let h=!1;if(s&&s.length)for(const m of s)m instanceof i.a3?i.w(m.message):(g.fire(new i.y(new Error(m.message))),h=!0);return h}let pe;class le extends i.E{constructor(s,h="flat"){super(),this._transitionable=new i.a8(pe||(pe=new i.a9({anchor:new i.aa(i.a6.light.anchor),position:new i.ab(i.a6.light.position),color:new i.aa(i.a6.light.color),intensity:new i.aa(i.a6.light.intensity)}))),this.setLight(s,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,h,m={}){this._validate(jc,s,m)||(this._transitionable.setTransitionOrValue(s),this.id=h)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,m){return(!m||m.validate!==!1)&&Q(this,s.call(To,Object.assign({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let fe=class extends i.E{constructor(g,s,h,m,x){super(),this.scope=h,this._transitionable=new i.a8(new i.a9({source:new i.aa(i.a6.terrain.source),exaggeration:new i.aa(i.a6.terrain.exaggeration)}),h,m),this._transitionable.setTransitionOrValue(g,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s,this.worldview=x}get(){return this._transitionable.serialize()}set(g,s){this._transitionable.setTransitionOrValue(g,s)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.ac(g,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const s=g.value.expression;if(!s)return null;let h=-1,m=-1,x=1;for(const b of s.zoomStops)x=s.evaluate(new i.ac(b,{worldview:this.worldview})),x>.01?(h=b,m=-1):m=b;return x<.01&&h>0&&m>h?[h,m]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.ad}};const Se=45,Te=65,ot=.05;function wt(g,s,h,m){const x=i.ah(Se,Te,h),[b,E]=mt(g,m);let P=1-Math.min(1,Math.exp((s-b)/(E-b)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*x*g.alpha}function mt(g,s){const h=.5/Math.tan(.5*s);return[g.range[0]+h,g.range[1]+h]}function bt(g,s,h,m,x){const b=i.af([],[s,h,m],x.mercatorFogMatrix);return wt(g,i.ag(b),x.pitch,x._fov)}function xt(g,s,h,m,x,b,E){const P=[[h,m,0],[x,m,0],[x,b,0],[h,b,0]];let M=Number.MAX_VALUE,B=-Number.MAX_VALUE;for(const j of P){const X=i.af([],j,s),W=i.ag(X);M=Math.min(M,W),B=Math.max(B,W)}return[wt(g,M,E.pitch,E._fov),wt(g,B,E.pitch,E._fov)]}class Xt extends i.E{constructor(s,h,m,x){super();const b=new i.a9({range:new i.aa(i.a6.fog.range),color:new i.aa(i.a6.fog.color),"color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.aa(i.a6.fog["high-color"]),"high-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.aa(i.a6.fog["space-color"]),"space-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.aa(i.a6.fog["horizon-blend"]),"star-intensity":new i.aa(i.a6.fog["star-intensity"]),"vertical-range":new i.aa(i.a6.fog["vertical-range"])});this._transitionable=new i.a8(b,m,new Map(x)),this.set(s,x),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new i.ai(b),this.scope=m}get state(){const s=this._transform,h=s.projection.name==="globe",m=i.aj(s.zoom),x=this.properties.get("range"),b=[.5,3];return{range:h?[i.ak(b[0],x[0],m),i.ak(b[1],x[1],m)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,h,m={}){if(this._validate(si,s,m))return;const x=Object.assign({},s);for(const b of Object.keys(i.a6.fog))x[b]===void 0&&(x[b]=i.a6.fog[b].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ah(Se,Te,s))*h.a}getOpacityAtLatLng(s,h){return this._transform.projection.supportsFog?function(m,x,b){const E=i.ae.fromLngLat(x),P=b.elevation?b.elevation.getAtPointOrZero(E):0;return bt(m,E.x,E.y,P,b)}(this.state,s,h):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(s.toUnwrapped());return xt(this.state,h,0,0,i.al,i.al,this._transform)}getOpacityForBounds(s,h,m,x,b){return this._transform.projection.supportsFog?xt(this.state,s,h,m,x,b,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?mt(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const m of h){const x=s.points[m];let b;if(x[2]>=0)b=x;else{const E=s.points[m-4];b=i.am(E,x,E[2]/(E[2]-x[2]))}if(bt(this.state,b[0],b[1],0,this._transform)>=ot)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,m){return(!m||m.validate!==!1)&&Q(this,s.call(To,Object.assign({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let cr,nr,ur,Ar,Kr=class extends i.E{constructor(g,s,h,m){super();const x=cr||(cr=new i.a9({density:new i.aa(i.a6.snow.density),intensity:new i.aa(i.a6.snow.intensity),color:new i.aa(i.a6.snow.color),opacity:new i.aa(i.a6.snow.opacity),vignette:new i.aa(i.a6.snow.vignette),"vignette-color":new i.aa(i.a6.snow["vignette-color"]),"center-thinning":new i.aa(i.a6.snow["center-thinning"]),direction:new i.aa(i.a6.snow.direction),"flake-size":new i.aa(i.a6.snow["flake-size"])}));this._transitionable=new i.a8(x,h,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(x),this.scope=h}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),m=i.an(h[0]),x=-Math.max(i.an(h[1]),.01),b=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette"),P=this.properties.get("vignette-color");return P.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(s.r,s.g,s.b,s.a*g),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(g,s,h={}){if(this._validate(So,g,h))return;const m=Object.assign({},g);for(const x of Object.keys(i.a6.snow))m[x]===void 0&&(m[x]=i.a6.snow[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,h){return(!h||h.validate!==!1)&&Q(this,g.call(To,Object.assign({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}},an=class extends i.E{constructor(g,s,h,m){super();const x=nr||(nr=new i.a9({density:new i.aa(i.a6.rain.density),intensity:new i.aa(i.a6.rain.intensity),color:new i.aa(i.a6.rain.color),opacity:new i.aa(i.a6.rain.opacity),vignette:new i.aa(i.a6.rain.vignette),"vignette-color":new i.aa(i.a6.rain["vignette-color"]),"center-thinning":new i.aa(i.a6.rain["center-thinning"]),direction:new i.aa(i.a6.rain.direction),"droplet-size":new i.aa(i.a6.rain["droplet-size"]),"distortion-strength":new i.aa(i.a6.rain["distortion-strength"])}));this._transitionable=new i.a8(x,h,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(x),this.scope=h}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),m=i.an(h[0]),x=-Math.max(i.an(h[1]),.01),b=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(s.r,s.g,s.b,s.a*g),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(g,s,h={}){if(this._validate(Ha,g,h))return;const m=Object.assign({},g);for(const x of Object.keys(i.a6.rain))m[x]===void 0&&(m[x]=i.a6.rain[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,h){return(!h||h.validate!==!1)&&Q(this,g.call(To,Object.assign({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}};class Hr extends i.E{constructor(s,h,m,x){super(),this.scope=m,this._options=s,this.properties=new i.ai(h),this._transitionable=new i.a8(h,m,new Map(x)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,h){this._options=s,this._transitionable.setTransitionOrValue(s.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class En{constructor(s,h,m){this.screenBounds=s,this.cameraPoint=m.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,m)}static createFromScreenPoints(s,h){let m,x;if(s instanceof i.P||typeof s[0]=="number"){const b=i.P.convert(s);m=[b],x=h.isPointAboveHorizon(b)}else{const b=i.P.convert(s[0]),E=i.P.convert(s[1]),P=b.add(E)._div(2);m=[b,E],x=i.aq(b,E).every(M=>h.isPointAboveHorizon(M))&&h.isPointAboveHorizon(P)}return new En(m,x,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const h=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.aq(h,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<m.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),i.ar(x,s)}bufferedCameraGeometryGlobe(s){const h=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.aq(h,m,s),b=this.cameraPoint.clone();switch(3*((b.y>h.y)+(b.y>m.y))+((b.x>h.x)+(b.x>m.x))){case 0:x[0]=b,x[4]=b.clone();break;case 1:x.splice(1,0,b);break;case 2:x[1]=b;break;case 3:x.splice(4,0,b);break;case 5:x.splice(2,0,b);break;case 6:x[3]=b;break;case 7:x.splice(3,0,b);break;case 8:x[2]=b}return x}containsTile(s,h,m,x=0){const b=s.queryPadding/h._pixelsPerMercatorPixel+1,E=m?this._bufferedCameraMercator(b,h):this._bufferedScreenMercator(b,h);let P=s.tileID.wrap+(E.unwrapped?x:0);const M=E.polygon.map(ce=>i.as(s.tileTransform,ce,P));if(!i.at(M,0,0,i.al,i.al))return;P=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const B=this.screenGeometryMercator.polygon.map(ce=>i.au(s.tileTransform,ce,P)),j=B.map(ce=>new i.P(ce[0],ce[1])),X=h.getFreeCameraOptions().position||new i.ae(0,0,0),W=i.au(s.tileTransform,X,P),Y=B.map(ce=>{const oe=i.av(ce,ce,W);return i.aw(oe,oe),new i.ax(W,oe)}),ee=i.ay(s,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:Y,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(te=i.az(M),te.min.x=i.aA(te.min.x,0,i.al),te.min.y=i.aA(te.min.y,0,i.al),te.max.x=i.aA(te.max.x,0,i.al),te.max.y=i.aA(te.max.y,0,i.al),te),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ee};var te}_bufferedScreenMercator(s,h){const m=ca(s);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),h):{polygon:this.bufferedScreenGeometry(s).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=x,x}}_bufferedCameraMercator(s,h){const m=ca(s);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),h):{polygon:this.bufferedCameraGeometry(s).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=x,x}}_projectAndResample(s,h){const m=function(b,E){const P=i.aB([],E.pixelMatrix,E.globeMatrix),M=[0,-i.aD,0,1],B=[0,i.aD,0,1],j=[0,0,0,1];i.aC(M,M,P),i.aC(B,B,P),i.aC(j,j,P);const X=new i.P(M[0]/M[3],M[1]/M[3]),W=new i.P(B[0]/B[3],B[1]/B[3]),Y=i.aE(b,X)&&M[3]<j[3],ee=i.aE(b,W)&&B[3]<j[3];if(!Y&&!ee)return null;const te=function(Fe,Re,Oe){for(let Le=1;Le<Fe.length;Le++){const ct=$n(Re.pointCoordinate3D(Fe[Le-1]).x),Ke=$n(Re.pointCoordinate3D(Fe[Le]).x);if(Oe<0){if(ct<Ke)return{idx:Le,t:-ct/(Ke-1-ct)}}else if(Ke<ct)return{idx:Le,t:(1-ct)/(Ke+1-ct)}}return null}(b,E,Y?-1:1);if(!te)return null;const{idx:ce,t:oe}=te;let de=ce>1?li(b.slice(0,ce),E):[],xe=ce<b.length?li(b.slice(ce),E):[];de=de.map(Fe=>new i.P($n(Fe.x),Fe.y)),xe=xe.map(Fe=>new i.P($n(Fe.x),Fe.y));const Ee=[...de];Ee.length===0&&Ee.push(xe[xe.length-1]);const De=i.ak(Ee[Ee.length-1].y,(xe.length===0?de[0]:xe[0]).y,oe);let Me;return Me=Y?[new i.P(0,De),new i.P(0,0),new i.P(1,0),new i.P(1,De)]:[new i.P(1,De),new i.P(1,1),new i.P(0,1),new i.P(0,De)],Ee.push(...Me),xe.length===0?Ee.push(de[0]):Ee.push(...xe),{polygon:Ee.map(Fe=>new i.ae(Fe.x,Fe.y)),unwrapped:!1}}(s,h);if(m)return m;const x=function(b,E){let P=!1,M=-1/0,B=0;for(let X=0;X<b.length-1;X++)b[X].x>M&&(M=b[X].x,B=X);for(let X=0;X<b.length-1;X++){const W=(B+X)%(b.length-1),Y=b[W],ee=b[W+1];Math.abs(Y.x-ee.x)>.5&&(Y.x<ee.x?(Y.x+=1,W===0&&(b[b.length-1].x+=1)):(ee.x+=1,W+1===b.length-1&&(b[0].x+=1)),P=!0)}const j=i.aF(E.center.lng);return P&&j<Math.abs(j-1)&&b.forEach(X=>{X.x-=1}),{polygon:b,unwrapped:P}}(li(s,h).map(b=>new i.P($n(b.x),b.y)),h);return{polygon:x.polygon.map(b=>new i.ae(b.x,b.y)),unwrapped:x.unwrapped}}}function li(g,s){return i.aG(g,h=>{const m=s.pointCoordinate3D(h);h.x=m.x,h.y=m.y},1/256)}function $n(g){return g<0?1+g%1:g%1}function ca(g){return 100*g|0}function da(g,s,h,m,x){const b=function(P,M){if(P)return x(P);if(M){if(g.url&&M.tiles&&g.tiles&&delete g.tiles,M.variants){if(!Array.isArray(M.variants))return x(new Error("variants must be an array"));for(const j of M.variants){if(j==null||typeof j!="object"||j.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(j.capabilities))return x(new Error("capabilities must be an array"));if(j.capabilities.length===1&&j.capabilities[0]==="meshopt"){M=Object.assign(M,j);break}}}const B=i.aH(Object.assign({},M,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);B.tiles=s.canonicalizeTileset(B,g.url),x(null,B)}},E=function(P,M,B){if(!P)return null;if(!M&&!B)return P;B=B||P.worldview_default;const j=Object.values(P.language||{});if(j.length===0)return null;const X=Object.values(P.worldview||{});if(X.length===0)return null;const W=j.every(ee=>ee===M),Y=X.every(ee=>ee===B);return W&&Y?P:M in(P.language_options||{})||B in(P.worldview_options||{})?null:P.language_options&&P.worldview_options?P:null}(g.data,h,m);return E?i.o.frame(()=>b(null,E)):g.url?i.m(s.transformRequest(s.normalizeSourceURL(g.url,null,h,m),i.R.Source),b):i.o.frame(()=>{const{data:P,...M}=g;b(null,M)})}function Eo(g,s){const h=Math.pow(2,s.z),m=Math.floor(i.aF(g.getWest())*h),x=Math.floor(i.aJ(g.getNorth())*h),b=Math.ceil(i.aF(g.getEast())*h),E=Math.ceil(i.aJ(g.getSouth())*h);return s.x>=m&&s.x<b&&s.y>=x&&s.y<E}class no{constructor(s,h,m){this.bounds=s?i.aI.convert(this.validateBounds(s)):null,this.minzoom=h||0,this.maxzoom=m||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}addExtraBounds(s){if(s){this.extraBounds||(this.extraBounds=[]);for(const h of s)this.extraBounds.push(i.aI.convert(this.validateBounds(h)))}}contains(s){if(s.z>this.maxzoom||s.z<this.minzoom||this.bounds&&!Eo(this.bounds,s))return!1;if(!this.extraBounds)return!0;for(const h of this.extraBounds)if(Eo(h,s))return!0;return!1}static fromTileJSON(s){if(!s.bounds&&!s.extra_bounds)return null;const h=new no(s.bounds,s.minzoom,s.maxzoom);return h.addExtraBounds(s.extra_bounds),h}}class Ao extends i.E{constructor(s,h,m,x){if(super(),this.id=s,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,i.aH(h,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aK}load(s){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=da(this._options,this.map._requestManager,h,m,(x,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new i.y(x));else if(b){if(Object.assign(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of b.vector_layers)this.vectorLayerIds.push(E.id),b.worldview&&b.worldview[E.source]&&this.localizableLayerIds.add(E.id)}this.tileBounds=no.fromTileJSON(b),_e(b.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}s&&s(x)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(s,h){const m=s.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(m),b=this.map._requestManager.transformRequest(x,i.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,P=E?{image:E.image.clone()}:null,M={request:b,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:P,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&i.h(m)&&(M.localizableLayerIds=this.localizableLayerIds),M.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=h:s.request=s.actor.send("reloadTile",M,B.bind(this));else if(s.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",M,B.bind(this),void 0,!0);else{const j=i.aL.call({deduped:this._deduped},M,(X,W)=>{X||!W?B.call(this,X):(M.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},s.actor&&s.actor.send("loadTile",M,B.bind(this),void 0,!0))},!0);s.request={cancel:j}}function B(j,X){return delete s.request,s.aborted?h(null):j&&j.status!==404?h(j):(X&&X.resourceTiming&&(s.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&s.setExpiryData(X),s.loadVectorData(X,this.map.painter),i.aM(this.dispatcher),h(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Hf extends i.E{constructor(s,h,m,x){super(),this.id=s,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},h),Object.assign(this,i.aH(h,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const h=this.map.getWorldview();this._tileJSONRequest=da(this._options,this.map._requestManager,null,h,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new i.y(m)):x&&(Object.assign(this,x),x.raster_layers&&(this.rasterLayers=x.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),this.tileBounds=no.fromTileJSON(x),_e(x.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),s&&s(m)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,h){const m=i.o.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);s.request=i.n(this.map._requestManager.transformRequest(x,i.R.Tile),(b,E,P,M)=>(delete s.request,s.aborted?(s.state="unloaded",h(null)):b?(s.state="errored",h(b)):E?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:P,expires:M}),s.setTexture(E,this.map.painter),s.state="loaded",i.aM(this.dispatcher),void h(null)):h(null)))}abortTile(s,h){s.request&&(s.request.cancel(),delete s.request),h&&h()}unloadTile(s,h){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function I2([g,s],h,m,{scaled:x=!0}={}){const{tileSize:b,buffer:E}=m,{x:P,y:M,z:B}=h;if(!isFinite(P)||!isFinite(M)||!isFinite(B))throw new Error("Invalid MRT header");const j=2**B,X=j*i.aF(g),W=j*i.aJ(s);return function([Y,ee],te,{scaled:ce=!0}={}){if(!te)throw new Error("bandView is undefined");const{data:oe,tileSize:de,buffer:xe,offset:Ee,scale:De,dimension:Me}=te;if(Y<-xe||Y>de+xe||ee<-xe||ee>de+xe)throw new Error(`Point (${Y}, ${ee}) out of bounds for tileSize=${de}, buffer=${xe}`);const Fe=(ee+xe)*(de+2*xe)+(Y+xe);if(new Uint32Array(oe.buffer)[Fe]===4294967295)return null;let Re=[];Re=ce?[]:new te.data.constructor(Me);for(let Oe=0;Oe<Me;Oe++)Re[Oe]=Math.round(1e12*(oe[Me*Fe+Oe]*De+Ee))/1e12;return Re}([Math.min(Math.max(-E,Math.floor((X-P)*b)),b-1+E),Math.min(Math.max(-E,Math.floor((W-M)*b)),b-1+E)],m,{scaled:x})}class Iu extends Hf{constructor(s,h,m,x){super(s,h,m,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},h)}triggerRepaint(s){const h=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);h&&h.enabled&&m&&h._clearRenderCacheForTile(m.id,s.tileID),this.map.triggerRepaint()}loadTile(s,h){const m=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,i.R.Tile),b={request:x,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=x,s.actor||(s.actor=this.dispatcher.getActor());const E=(P,M,B,j)=>{if(delete s.request,s.aborted)return s.state="unloaded",h(null);if(P)return P.name==="AbortError"?void 0:(s.state="errored",h(P));if(this.map._refreshExpiredTiles&&M&&s.setExpiryData({cacheControl:B,expires:j}),this.partial&&s.state!=="expired")s.state="empty";else if(!this.partial){if(!M)return h(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=M}h(null)};s.request=this.partial?s.fetchHeader(void 0,E.bind(this)):s.actor.send("loadTile",b,E.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){const m=s.texturePerLayer;if(s.flushAllQueues(),m.size){s.destroy(!0);for(const x of m.values())this.map.painter.saveTileTexture(x)}else s.destroy()}prepareTile(s,h,m,x){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBandForRender(h,m,x,(b,E)=>{if(b)return s.state="errored",this.fire(new i.y(b)),void this.triggerRepaint(s);E&&(s._isHeaderLoaded=!0,s.setTexturePerLayer(m,E,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:b})=>b===s),m=h&&h.fields,x=m&&m.bands&&m.bands;return x?x[0]:0}getTextureDescriptor(s,h,m){if(!s)return;const x=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let b=null;h instanceof i.aP?b=h.paint.get("raster-array-band"):h instanceof i.aQ&&(b=h.paint.get("raster-particle-array-band"));const E=b||this.getInitialBand(x);if(E==null)return;if(!s.textureDescriptorPerLayer.get(h.id))return void this.prepareTile(s,x,h.id,E);if(s.updateNeeded(h.id,E)&&!m)return;const P=s.textureDescriptorPerLayer.get(h.id);return Object.assign({},P,{texture:s.texturePerLayer.get(h.id)})}getImages(s,h){const m=new Map;for(const x of s)for(const b of h){const[E,P]=b.split("/"),M=x.getLayer(E);if(!M||!M.hasBand(P)||!M.hasDataForBand(P))continue;const{bytes:B,tileSize:j,buffer:X}=M.getBandView(P),W=j+2*X,Y={data:new i.q({width:W,height:W},B),pixelRatio:2,sdf:!1,usvg:!1,version:0};m.set(b,Y)}return m}queryRasterArrayValueByBandId(s,h,m){const x=h._mrt;return new Promise(b=>{const E={},P=new Set;for(const[M,B]of Object.entries(x.layers)){if(m.layerName&&M!==m.layerName)continue;const j={};E[M]=j;for(const{bands:X}of B.dataIndex)for(const W of X)m.bands&&!m.bands.includes(W)||(P.add(i.B(M,W)),h.fetchBand(M,null,W,Y=>{i.o.frame(()=>{j[W]=Y?null:I2([s.lng,s.lat],x,B.getBandView(W)),P.delete(i.B(M,W)),P.size===0&&b(E)})},!1))}P.size===0&&b(E)})}_loadTileForQuery(s,h){if(this._loadTileLoaded[s.uid])return void h(null,s._mrt);if(this._loadTilePending[s.uid])return void this._loadTilePending[s.uid].push(h);this._loadTilePending[s.uid]=[h];const m=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,i.R.Tile);s.actor.send("loadTile",{request:x,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},(b,E,P,M)=>b?(this._loadTilePending[s.uid].forEach(B=>B(b,null)),void delete this._loadTilePending[s.uid]):E?(this.map._refreshExpiredTiles&&E&&s.setExpiryData({cacheControl:P,expires:M}),s._mrt=E,s._isHeaderLoaded=!0,s.state="loaded",this._loadTilePending[s.uid].forEach(B=>B(null,E)),this._loadTileLoaded[s.uid]=!0,void delete this._loadTilePending[s.uid]):(this._loadTilePending[s.uid].forEach(B=>B(null,null)),void delete this._loadTilePending[s.uid]),void 0,!0)}queryRasterArrayValueByAllBands(s,h,m){return new Promise((x,b)=>{this._loadTileForQuery(h,(E,P)=>{E?b(E):x(P?this.queryRasterArrayValueByBandId(s,h,m):null)})})}queryRasterArrayValue(s,h){const m=i.aR.convert(s),x=this.findLoadedParent(m);return x&&x._mrt?h.bands||!this.partial?this.queryRasterArrayValueByBandId(m,x,h):this.queryRasterArrayValueByAllBands(m,x,h):Promise.resolve(null)}findLoadedParent(s){const h=i.ae.fromLngLat(s,this.map.transform.tileSize),m=this.maxzoom+1,x=1<<m,b=Math.floor(h.x),E=Math.floor((h.x-b)*x),P=Math.floor(h.y*x),M=this.map.style.getSourceCache(this.id),B=new i.aO(m,b,m,E,P);return M.findLoadedParent(B,this.minzoom)}}const qf={vector:Ao,raster:Hf,"raster-dem":class extends Hf{constructor(g,s,h,m){super(g,s,h,m),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(g,s){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(x,b){x&&(g.state="errored",s(x)),b&&(g.dem=b,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",s(null))}g.request=i.n(this.map._requestManager.transformRequest(h,i.R.Tile),(function(x,b,E,P){if(delete g.request,g.aborted)g.state="unloaded",s(null);else if(x)g.state="errored",s(x);else if(b){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:E,expires:P});const M=ImageBitmap&&b instanceof ImageBitmap&&i.r(),B=1-(b.width-i.aN(b.width))/2;B<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const j=M?b:i.o.getImageData(b,B),X={uid:g.uid,tileID:g.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:B};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadTile",X,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const s=g.canonical,h=Math.pow(2,s.z),m=(s.x-1+h)%h,x=s.x===0?g.wrap-1:g.wrap,b=(s.x+1+h)%h,E=s.x+1===h?g.wrap+1:g.wrap,P={};return P[new i.aO(g.overscaledZ,x,s.z,m,s.y).key]={backfilled:!1},P[new i.aO(g.overscaledZ,E,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(P[new i.aO(g.overscaledZ,x,s.z,m,s.y-1).key]={backfilled:!1},P[new i.aO(g.overscaledZ,g.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},P[new i.aO(g.overscaledZ,E,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<h&&(P[new i.aO(g.overscaledZ,x,s.z,m,s.y+1).key]={backfilled:!1},P[new i.aO(g.overscaledZ,g.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},P[new i.aO(g.overscaledZ,E,s.z,b,s.y+1).key]={backfilled:!1}),P}},"raster-array":Iu,geojson:class extends i.E{constructor(g,s,h,m){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(m),this._data=s.data,this._options=Object.assign({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const x=i.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*x,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*x,extent:i.al,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.al,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*x,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const h of this._data.features)s.set(h.id,h);for(const h of g.features)s.set(h.id,h);this._data.features=[...s.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterChildren(g,s){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterLeaves(g,s,h,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:s,offset:h},m),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const s=Object.assign({append:g},this.workerOptions);s.scope=this.scope;const h=this._data;typeof h=="string"?(s.request=this.map._requestManager.transformRequest(i.o.resolveURL(h),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.y(m));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(b.resourceTiming=x.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.B(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,s){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,x=m?{image:m.image.clone()}:null,b=this._partialReload,E={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:g.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:b,worldview:this.map.getWorldview()};g.request=this.actor.send(h,E,(P,M)=>b&&!M?(g.state="loaded",s(null)):(delete g.request,g.destroy(),g.aborted?s(null):P?s(P):(g.loadVectorData(M,this.map.painter,h==="reloadTile"),s(null))),void 0,h==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,s){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aS{constructor(g,s,h,m){super(g,s,h,m),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const s of g.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aT(this.urls,(s,h)=>{this._loaded=!0,s?this.fire(new i.y(s)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const s=this.video.seekable;g<s.start(0)||g>s.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,s=g.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aS,model:class extends i.E{constructor(g,s,h,m){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const g=[];for(const s in this._options.models){const h=this._options.models[s],m=i.aV(this.map._requestManager.transformRequest(h.uri,i.R.Model).url).then(x=>{if(!x)return;const b=i.aW(x),E=new i.aX(s,h.position,h.orientation,b);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(x=>{this.fire(new i.y(new Error(`Could not load model ${s} from ${h.uri}: ${x.message}`)))});g.push(m)}Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this._loaded=!0,this.fire(new i.y(new Error(`Could not load models: ${s.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,s){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(g,s,h,m){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=da(this._options,this.map._requestManager,s,h,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new i.y(m))):x&&(Object.assign(this,x),x.bounds&&(this.tileBounds=new no(x.bounds,this.minzoom,this.maxzoom)),_e(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(m)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,s){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(h,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.o.devicePixelRatio,promoteId:this.promoteId};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=s;else{if(g.buckets){const b=Object.values(g.buckets);for(const E of b)E.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",m,x.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",m,x.bind(this),void 0,!0);function x(b,E){return g.aborted?s(null):b&&b.status!==404?s(b):(this.map._refreshExpiredTiles&&E&&g.setExpiryData(E),g.loadModelData(E,this.map.painter),g.state="loaded",void s(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends i.aS{constructor(g,s,h,m){super(g,s,h,m),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(b=>typeof b!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aU||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,s,h,m){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=s,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new no(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,i.aH(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:s,y:h,z:m}=g.canonical;return this._implementation.hasTile({x:s,y:h,z:m})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,s){const{x:h,y:m,z:x}=g.tileID.canonical,b=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y:m,z:x},{signal:b.signal})).then((function(E){return delete g.request,g.aborted?(g.state="unloaded",s(null)):E===void 0?(g.state="errored",s(null)):E===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",s(null)):function(P){return P instanceof ImageData||P instanceof HTMLCanvasElement||P instanceof ImageBitmap||P instanceof HTMLImageElement}(E)?(this.loadTileData(g,E),g.state="loaded",void s(null)):(g.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.name!=="AbortError"&&(g.state="errored",s(E))}),g.request.cancel=()=>b.abort()}loadTileData(g,s){g.setTexture(s,this.map.painter)}unloadTile(g,s){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:h,y:m,z:x}=g.tileID.canonical;this._implementation.unloadTile({x:h,y:m,z:x})}s&&s()}abortTile(g,s){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.B(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Vp=function(g,s,h,m){const x=new qf[s.type](g,s,h,m);if(x.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${x.id}`);return i.aY(["load","abort","unload","serialize","prepare"],x),x};function Wp(g,s,h=""){return`${h}:${s.id||""}:${s.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:x,importId:b}=m;return`featureset:${x}${b?`:import:${b}`:""}`}}(g.target)}`}function ku(g,s,h,m=""){if(g.uniqueFeatureID){const x=Wp(g,s,m);if(h.has(x))return!0;h.add(x)}return!1}function Gp(g,s,h,m,x=!1){const b=s.sourceCache.transform,E=s.sourceCache.tilesIn(g,s.has3DLayers,x);E.sort(Dv);const P=[];for(const M of E){const B=M.tile.queryRenderedFeatures(s,M,h,m,b,x);Object.keys(B).length&&P.push({wrappedTileID:M.tile.tileID.wrapped().key,queryResults:B})}return P.length===0?{}:function(M){const B={},j={};for(const X of M){const W=X.queryResults,Y=X.wrappedTileID,ee=j[Y]=j[Y]||{};for(const te in W){const ce=W[te],oe=ee[te]=ee[te]||{},de=B[te]=B[te]||[];for(const xe of ce)oe[xe.featureIndex]||(oe[xe.featureIndex]=!0,de.push(xe))}}return B}(P)}function Rv(g,s,h,m,x,b){const E={},P=m.queryRenderedSymbols(g),M=[];for(const B of Object.keys(P).map(Number))M.push(x[B]);M.sort(Dv);for(const B of M){const j=B.featureIndex.lookupSymbolFeatures(P[B.bucketInstanceId],B.bucketIndex,B.sourceLayerIndex,s,h,b);for(const X in j){const W=E[X]=E[X]||[],Y=j[X];Y.sort((ee,te)=>{const ce=B.featureSortOrder;if(ce){const oe=ce.indexOf(ee.featureIndex);return ce.indexOf(te.featureIndex)-oe}return te.featureIndex-ee.featureIndex});for(const ee of Y)W.push(ee)}}return E}function tc(g,s){const h=g.getRenderableIds().map(b=>g.getTileByID(b)),m=[],x={};for(let b=0;b<h.length;b++){const E=h[b],P=E.tileID.canonical.key;x[P]||(x[P]=!0,E.querySourceFeatures(m,s))}return m}function Dv(g,s){const h=g.tileID,m=s.tileID;return h.overscaledZ-m.overscaledZ||h.canonical.y-m.canonical.y||h.wrap-m.wrap||h.canonical.x-m.canonical.x}function q0(g,s){const h={};if(!s)return h;for(const m of g){const x=m.layerIds.map(b=>s.getLayer(b)).filter(Boolean);if(x.length!==0){m.layers=x,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(b=>x.filter(E=>E.id===b)[0]));for(const b of x)h[b.fqid]=m}}return h}const Ls=32,Tl=33,Uc=new Uint16Array(8184);for(let g=0;g<2046;g++){let s=g+2,h=0,m=0,x=0,b=0,E=0,P=0;for(1&s?x=b=E=Ls:h=m=P=Ls;(s>>=1)>1;){const B=h+x>>1,j=m+b>>1;1&s?(x=h,b=m,h=E,m=P):(h=x,m=b,x=E,b=P),E=B,P=j}const M=4*g;Uc[M+0]=h,Uc[M+1]=m,Uc[M+2]=x,Uc[M+3]=b}const Sl=new Uint16Array(2178),zo=new Uint8Array(1089),Dh=new Uint16Array(1089);function Fv(g){return g===0?-.03125:g===32?.03125:0}const Hp={type:2,extent:i.al,loadGeometry:()=>[[new i.P(0,0),new i.P(i.al+1,0),new i.P(i.al+1,i.al+1),new i.P(0,i.al+1),new i.P(0,0)]]};class Ou{constructor(s,h,m,x,b,E){this.tileID=s,this.uid=i.b2(),this.uses=0,this.tileSize=h,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection),this.worldview=E}registerFadeDuration(s){const h=s+this.timeAdded;h<i.o.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,h,m){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=q0(s.buckets,h.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const b=this.buckets[x];if(b instanceof i.b4){if(this.hasSymbolBuckets=!0,!m)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const b=this.buckets[x];if(b instanceof i.b4&&b.hasRTLText){this.hasRTLText=!0,i.b5();break}}this.queryPadding=0;for(const x in this.buckets){const b=this.buckets[x],E=h.style.getOwnLayer(x);if(!E)continue;const P=E.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,P)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.b3}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,h,m){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,q0(s.buckets,h.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const x in this.buckets){const b=this.buckets[x];b.uploadPending()&&b.upload(s)}const h=s.gl,m=this.imageAtlas;m&&!m.uploaded&&(this.imageAtlasTexture=new i.T(s,m.image,h.RGBA8,{useMipmap:!!m.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(s,h,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,m),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=h.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(h,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(s,h,m,x,b,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const P=function(M,B){const j=i.bq([],[.5*M.width,.5*-M.height,1]);return i.br(j,j,[1,-1,0]),i.aB(j,j,M.calculateProjMatrix(B.toUnwrapped())),Float32Array.from(j)}(b,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:h,pixelPosMatrix:P,transform:x,availableImages:m,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(s,h){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const x=m.loadVTLayers(),b=h?h.sourceLayer:"",E=x._geojsonTileLayer||x[b];if(!E)return;const P=i.b6(h&&h.filter),{z:M,x:B,y:j}=this.tileID.canonical,X={z:M,x:B,y:j};for(let W=0;W<E.length;W++){const Y=E.feature(W);if(P.needGeometry){const ce=i.b7(Y,!0);if(!P.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ce,this.tileID.canonical))continue}else if(!P.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),Y))continue;const ee=m.getId(Y,b),te=new i.b8(Y,M,B,j,ee);te.tile=X,s.push(te)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const h=this.expirationTime;if(s.cacheControl){const m=i.b9(s.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const m=Date.now();let x=!1;if(this.expirationTime>m)x=!1;else if(h)if(this.expirationTime<h)x=!0;else{const b=this.expirationTime-h;b?this.expirationTime=m+Math.max(b,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,h){if(!this.latestFeatureIndex||!s.style)return;const m=this.latestFeatureIndex.loadVTLayers(),x=s.style.listImages(),b=s.style.getBrightness();for(const E in this.buckets){if(!s.style.hasLayer(E))continue;const P=this.buckets[E],M=P.layers[0],B=M.sourceLayer||"_geojsonTileLayer",j=m[B],X=s.style.getLayerSourceCache(M);let W={};X&&(W=X._state.getState(B,void 0));const Y=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ee=Object.keys(W).length>0&&!h;(ee&&P.stateDependentLayers.length!==0||h)&&P.update(W,j,x,Y,ee?P.stateDependentLayers:P.layers,h,b),(P instanceof i.ba||P instanceof i.bb)&&s._terrain&&s._terrain.enabled&&X&&P.uploadPending()&&s._terrain._clearRenderCacheForTile(X.id,this.tileID);const te=s&&s.style&&s.style.getOwnLayer(E);te&&(this.queryPadding=Math.max(this.queryPadding,te.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.o.now()+s}setTexture(s,h){const m=h.context,x=m.gl;this.texture=this.texture||h.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(m,s,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(s,h){const m={};for(const x of h)m[x]=!0;this.dependencies[s]=m}hasDependency(s,h){for(const m of s){const x=this.dependencies[m];if(x){for(const b of h)if(x[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const m=i.bc(Hp,this.tileID.canonical,this.tileTransform)[0],x=new i.bd,b=new i.be;for(let E=0;E<m.length;E++){const{x:P,y:M}=m[E];x.emplaceBack(P,M),b.emplaceBack(E)}b.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(b),this._tileDebugBuffer=s.createVertexBuffer(x,i.bf.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,x.length,b.length)}_makeTileBoundsBuffers(s,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const m=i.bc(Hp,this.tileID.canonical,this.tileTransform)[0];let x,b;if(this.isRaster){const E=function(P,M){const B=i.aZ(P,M),j=Math.pow(2,P.z);for(let ce=0;ce<Tl;ce++)for(let oe=0;oe<Tl;oe++){const de=i.a_((P.x+(oe+Fv(oe))/Ls)/j),xe=i.a$((P.y+(ce+Fv(ce))/Ls)/j),Ee=M.project(de,xe),De=ce*Tl+oe;Sl[2*De+0]=Math.round((Ee.x*B.scale-B.x)*i.al),Sl[2*De+1]=Math.round((Ee.y*B.scale-B.y)*i.al)}zo.fill(0),Dh.fill(0);for(let ce=2045;ce>=0;ce--){const oe=4*ce,de=Uc[oe+0],xe=Uc[oe+1],Ee=Uc[oe+2],De=Uc[oe+3],Me=de+Ee>>1,Fe=xe+De>>1,Re=Me+Fe-xe,Oe=Fe+de-Me,Le=xe*Tl+de,ct=De*Tl+Ee,Ke=Fe*Tl+Me,vt=Math.hypot((Sl[2*Le+0]+Sl[2*ct+0])/2-Sl[2*Ke+0],(Sl[2*Le+1]+Sl[2*ct+1])/2-Sl[2*Ke+1])>=16;zo[Ke]=zo[Ke]||(vt?1:0),ce<1022&&(zo[Ke]=zo[Ke]||zo[(xe+Oe>>1)*Tl+(de+Re>>1)]||zo[(De+Oe>>1)*Tl+(Ee+Re>>1)])}const X=new i.b0,W=new i.b1;let Y=0;function ee(ce,oe){const de=oe*Tl+ce;return Dh[de]===0&&(X.emplaceBack(Sl[2*de+0],Sl[2*de+1],ce*i.al/Ls,oe*i.al/Ls),Dh[de]=++Y),Dh[de]-1}function te(ce,oe,de,xe,Ee,De){const Me=ce+de>>1,Fe=oe+xe>>1;if(Math.abs(ce-Ee)+Math.abs(oe-De)>1&&zo[Fe*Tl+Me])te(Ee,De,ce,oe,Me,Fe),te(de,xe,Ee,De,Me,Fe);else{const Re=ee(ce,oe),Oe=ee(de,xe),Le=ee(Ee,De);W.emplaceBack(Re,Oe,Le)}}return te(0,0,Ls,Ls,Ls,0),te(Ls,Ls,0,0,0,Ls),{vertices:X,indices:W}}(this.tileID.canonical,h);x=E.vertices,b=E.indices}else{x=new i.b0,b=new i.b1;for(const{x:P,y:M}of m)x.emplaceBack(P,M,0,0);const E=i.bh(x.int16.subarray(0,4*x.length),void 0,4);for(let P=0;P<E.length;P+=3)b.emplaceBack(E[P],E[P+1],E[P+2])}this._tileBoundsBuffer=s.createVertexBuffer(x,i.bi.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(b),this._tileBoundsSegments=i.bg.simpleSegment(0,0,x.length,b.length)}_makeGlobeTileDebugBuffers(s,h){const m=h.projection;if(!m||m.name!=="globe"||h.freezeTileCoverage)return;const x=this.tileID.canonical,b=i.bj(x,h),E=i.bk(b),P=i.aj(h.zoom);let M;P>0&&(M=i.bl(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,x,h,E,M,P),this._makeGlobeTileDebugTextBuffer(s,x,h,E,M,P)}_globePoint(s,h,m,x,b,E,P){let M=i.bm(s,h,m);if(E){const B=1<<m.z,j=i.aF(x.center.lng),X=i.aJ(x.center.lat),W=(m.x+.5)/B-j;let Y=0;W>.5?Y=-1:W<-.5&&(Y=1);let ee=(s/i.al+m.x)/B+Y,te=(h/i.al+m.y)/B;ee=(ee-j)*x._pixelsPerMercatorPixel+j,te=(te-X)*x._pixelsPerMercatorPixel+X;const ce=[ee*x.worldSize,te*x.worldSize,0];i.af(ce,ce,E),M=i.bn(M,ce,P)}return i.af(M,M,b)}_makeGlobeTileDebugBorderBuffer(s,h,m,x,b,E){const P=new i.bd,M=new i.be,B=new i.bo,j=(W,Y,ee,te,ce)=>{const oe=(ee-W)/(ce-1),de=(te-Y)/(ce-1),xe=P.length;for(let Ee=0;Ee<ce;Ee++){const De=W+Ee*oe,Me=Y+Ee*de;P.emplaceBack(De,Me);const Fe=this._globePoint(De,Me,h,m,x,b,E);B.emplaceBack(Fe[0],Fe[1],Fe[2]),M.emplaceBack(xe+Ee)}},X=i.al;j(0,0,X,0,16),j(X,0,X,X,16),j(X,X,0,X,16),j(0,X,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(M),this._tileDebugBuffer=s.createVertexBuffer(P,i.bf.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(B,i.bp.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,P.length,M.length)}_makeGlobeTileDebugTextBuffer(s,h,m,x,b,E){const P=i.al/4,M=new i.bd,B=new i.b1,j=new i.bo,X=25;B.reserve(32),M.reserve(X),j.reserve(X);const W=(Y,ee)=>X*Y+ee;for(let Y=0;Y<X;Y++){const ee=Y*P;for(let te=0;te<X;te++){const ce=te*P;M.emplaceBack(ce,ee);const oe=this._globePoint(ce,ee,h,m,x,b,E);j.emplaceBack(oe[0],oe[1],oe[2])}}for(let Y=0;Y<4;Y++)for(let ee=0;ee<4;ee++){const te=W(Y,ee),ce=W(Y,ee+1),oe=W(Y+1,ee),de=W(Y+1,ee+1);B.emplaceBack(te,ce,oe),B.emplaceBack(oe,ce,de)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(B),this._tileDebugTextBuffer=s.createVertexBuffer(M,i.bf.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(j,i.bp.members),this._tileDebugTextSegments=i.bg.simpleSegment(0,0,X,32)}destroy(s=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bs.setPbf(i.bt);class qp extends Ou{constructor(s,h,m,x,b){super(s,h,m,x,b),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexturePerLayer(s,h,m){const x=m.context,b=x.gl;let E=this.texturePerLayer.get(s)||m.getTileTexture(h.width);E&&E instanceof i.T?E.update(h,{premultiply:!1}):E=new i.T(x,h,b.RGBA8,{premultiply:!1}),this.texturePerLayer.has(s)||this.texturePerLayer.set(s,E)}flushQueues(s){const h=this._workQueuePerLayer.get(s)||[],m=this._fetchQueuePerLayer.get(s)||[];for(;h.length;)h.pop()();for(;m.length;)m.pop()()}flushAllQueues(){for(const s of this._workQueuePerLayer.keys()){const h=this._workQueuePerLayer.get(s)||[];for(;h.length;)h.pop()()}for(const s of this._fetchQueuePerLayer.keys()){const h=this._fetchQueuePerLayer.get(s)||[];for(;h.length;)h.pop()()}}fetchHeader(s=16384,h){const m=this._mrt=new i.bs(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.bu(x,(b,E,P,M)=>{if(b)h(b);else try{const B=m.getHeaderLength(E);if(B>s)return void(this.request=this.fetchHeader(B,h));m.parseHeader(E),this._isHeaderLoaded=!0;let j=0;for(const X of Object.values(m.layers))j=Math.max(j,X.dataIndex[X.dataIndex.length-1].lastByte);E.byteLength>=j&&(this.entireBuffer=E),h(null,this.entireBuffer||E,P,M)}catch(B){h(B)}}),this.request}fetchBandForRender(s,h,m,x){this.fetchBand(s,h,m,b=>{if(b)return void x(b);this.updateTextureDescriptor(s,h,m);const E=this.textureDescriptorPerLayer.get(h);x(null,E?E.img:null)})}fetchBand(s,h,m,x,b=!0){const E=this._mrt;if(!this._isHeaderLoaded||!E)return void x(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void x(new Error("Can't fetch tile band without an actor"));let M;const B=i.B(String(m),i.B(this.tileID.key,s));let j=this._taskQueue.get(B);j?j.add(x):(j=new Set,j.add(x),this._taskQueue.set(B,j));const X=(te,ce)=>{M.complete(te,ce),te?x(te):(j.values().forEach(oe=>oe(null,ce)),this._taskQueue.delete(B))},W=(te,ce)=>{if(te)return x(te);const oe=P.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ce,task:M},X,void 0,!0);if(h!==null){const de=this._workQueuePerLayer.get(h)||[];de.push(()=>{oe&&oe.cancel(),M.cancel()}),this._workQueuePerLayer.has(h)||this._workQueuePerLayer.set(h,de)}};let Y;try{Y=E.getLayer(s)}catch(te){if(this.state==="reloading")return;throw te}if(!Y)return void x(new Error(`Unknown sourceLayer "${s}"`));if(Y.hasDataForBand(m))return j.values().forEach(te=>te(null,null)),void this._taskQueue.delete(B);const ee=Y.getDataRange([m]);if(M=E.createDecodingTask(ee),!M||M.tasks.length)if(h!==null&&this.flushQueues(h),this.entireBuffer)W(null,this.entireBuffer.slice(ee.firstByte,ee.lastByte+1));else{const te=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ee.firstByte}-${ee.lastByte}`}}),ce=i.bu(te,W);if(h!==null){const oe=this._fetchQueuePerLayer.get(h)||[];oe.push(()=>{ce.cancel(),M.cancel()}),this._fetchQueuePerLayer.has(h)||this._fetchQueuePerLayer.set(h,oe)}}}updateNeeded(s,h){return(!this.textureDescriptorPerLayer.get(s)||this.textureDescriptorPerLayer.get(s).band!==h||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(s,h,m){if(!this._mrt)return;const x=this._mrt.getLayer(s);if(!x||!x.hasBand(m)||!x.hasDataForBand(m))return;const{bytes:b,tileSize:E,buffer:P,offset:M,scale:B}=x.getBandView(m),j=E+2*P,X=new i.q({width:j,height:j},b),W=this.texturePerLayer.get(h);W&&W instanceof i.T&&W.update(X,{premultiply:!1}),this.textureDescriptorPerLayer.set(h,{layer:s,band:m,img:X,buffer:P,offset:M,tileSize:E,format:x.pixelFormat,mix:[B,256*B,65536*B,16777216*B]})}destroy(s=!1){if(super.destroy(s),delete this._mrt,!s)for(const h of this.texturePerLayer.values())h&&h instanceof i.T&&h.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class Xp{constructor(s,h){this.max=s,this.onRemove=h,this.reset()}reset(){for(const s in this.data)for(const h of this.data[s])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(s,h,m){const x=s.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const b={value:h,timeout:void 0};if(m!==void 0&&(b.timeout=setTimeout(()=>{this.remove(s,b)},m)),this.data[x].push(b),this.order.push(x),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const h=this.data[s].shift();return h.timeout&&clearTimeout(h.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),h.value}getByKey(s){const h=this.data[s];return h?h[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,h){if(!this.has(s))return this;const m=s.wrapped().key,x=h===void 0?0:this.data[m].indexOf(h),b=this.data[m][x];return this.data[m].splice(x,1),b.timeout&&clearTimeout(b.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(b.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(s){const h=[];for(const m in this.data)for(const x of this.data[m])s(x.value)||h.push(x);for(const m of h)this.remove(m.value.tileID,m)}}class Xf{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,h,m){const x=String(h);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][x]=this.stateChanges[s][x]||{},Object.assign(this.stateChanges[s][x],m),this.deletedStates[s]===null){this.deletedStates[s]={};for(const b in this.state[s])b!==x&&(this.deletedStates[s][b]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][x]===null){this.deletedStates[s][x]={};for(const b in this.state[s][x])m[b]||(this.deletedStates[s][x][b]=null)}else for(const b in m)this.deletedStates[s]&&this.deletedStates[s][x]&&this.deletedStates[s][x][b]===null&&delete this.deletedStates[s][x][b]}removeFeatureState(s,h,m){if(this.deletedStates[s]===null)return;const x=String(h);if(this.deletedStates[s]=this.deletedStates[s]||{},m&&h!==void 0)this.deletedStates[s][x]!==null&&(this.deletedStates[s][x]=this.deletedStates[s][x]||{},this.deletedStates[s][x][m]=null);else if(h!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][x])for(m in this.deletedStates[s][x]={},this.stateChanges[s][x])this.deletedStates[s][x][m]=null;else this.deletedStates[s][x]=null;else this.deletedStates[s]=null}getState(s,h){const m=this.state[s]||{},x=this.stateChanges[s]||{},b=this.deletedStates[s];if(b===null)return{};if(h!==void 0){const P=String(h),M=Object.assign({},m[P],x[P]);if(b){const B=b[h];if(B===null)return{};for(const j in B)delete M[j]}return M}const E=Object.assign({},m,x);if(b)for(const P in b)delete E[P];return E}initializeTileState(s,h){s.refreshFeatureState(h)}coalesceChanges(s,h){const m={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const b={};for(const E in this.stateChanges[x])this.state[x][E]||(this.state[x][E]={}),Object.assign(this.state[x][E],this.stateChanges[x][E]),b[E]=this.state[x][E];m[x]=b}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const b={};if(this.deletedStates[x]===null)for(const E in this.state[x])b[E]={},this.state[x][E]={};else for(const E in this.deletedStates[x]){if(this.deletedStates[x][E]===null)this.state[x][E]={};else if(this.state[x][E])for(const P of Object.keys(this.deletedStates[x][E]))delete this.state[x][E][P];b[E]=this.state[x][E]}m[x]=m[x]||{},Object.assign(m[x],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const x in s)s[x].refreshFeatureState(h)}}class Ns extends i.E{constructor(s,h,m){super(),this.id=s,this._onlySymbols=m,h.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new Xp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Xf,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,h){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,h)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const m=this._tiles[h];m.upload(s),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Lv).map(s=>s.key)}getRenderableIds(s,h){const m=[];for(const x in this._tiles)this._isIdRenderable(+x,s,h)&&m.push(this._tiles[x]);return s?m.sort((x,b)=>{const E=x.tileID,P=b.tileID,M=new i.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),B=new i.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-P.overscaledZ||B.y-M.y||B.x-M.x}).map(x=>x.tileID.key):m.map(x=>x.tileID).sort(Lv).map(x=>x.key)}hasRenderableParent(s){const h=this.findLoadedParent(s,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(s,h,m){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(h||!this._tiles[s].holdingForFade())&&(m||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,h){const m=this._tiles[s];m&&(m.state!=="loading"&&(m.state=h),this._loadTile(m,this._tileLoaded.bind(this,m,s,h)))}_tileLoaded(s,h,m,x){if(x)if(s.state="errored",x.status!==404)this._source.fire(new i.y(x,{tile:s}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.o.now(),m==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(h,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const h=this.getRenderableIds();for(let x=0;x<h.length;x++){const b=h[x];if(s.neighboringTiles&&s.neighboringTiles[b]){const E=this.getTileByID(b);m(s,E),m(E,s)}}function m(x,b){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let E=b.tileID.canonical.x-x.tileID.canonical.x;const P=b.tileID.canonical.y-x.tileID.canonical.y,M=Math.pow(2,x.tileID.canonical.z),B=b.tileID.key;E===0&&P===0||Math.abs(P)>1||(Math.abs(E)>1&&(Math.abs(E+M)===1?E+=M:Math.abs(E-M)===1&&(E-=M)),b.dem&&x.dem&&(x.dem.backfillBorder(b.dem,E,P),x.neighboringTiles&&x.neighboringTiles[B]&&(x.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,h,m,x){for(const b in this._tiles){let E=this._tiles[b];if(x[b]||!E.hasData()||E.tileID.overscaledZ<=h||E.tileID.overscaledZ>m)continue;let P=E.tileID;for(;E&&E.tileID.overscaledZ>h+1;){const B=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[B.key],E&&E.hasData()&&(P=B)}let M=P;for(;M.overscaledZ>h;)if(M=M.scaledTo(M.overscaledZ-1),s[M.key]){x[P.key]=P;break}}}findLoadedParent(s,h){if(s.key in this._loadedParentTiles){const m=this._loadedParentTiles[s.key];return m&&m.tileID.overscaledZ>=h?m:null}for(let m=s.overscaledZ-1;m>=h;m--){const x=s.scaledTo(m),b=this._getLoadedTile(x);if(b)return b}}_getLoadedTile(s){const h=this._tiles[s.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,h){h=h||this._source.tileSize;const m=Math.ceil(s.width/h)+1,x=Math.ceil(s.height/h)+1,b=Math.floor(m*x*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(P)}handleWrapJump(s){const h=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,h){const m={};for(const x in this._tiles){const b=this._tiles[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+h),m[b.tileID.key]=b}this._tiles=m;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(s,h,m,x,b){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(s,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const E=this._source.type==="batched-model";let P,M=this._source.maxzoom;const B=this.map&&this.map.painter?this.map.painter._terrain:null;if(B&&B.sourceCache===this&&B.attenuationRange()){const W=B.attenuationRange()[0],Y=Math.floor(W)-Math.log2(B.getDemUpscale());M>Y&&(M=Y)}if(this.used||this.usedForTerrain){if(this._source.tileID)P=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new i.aO(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y));else if(this.tileCoverLift!==0){const W=s.clone();W.tileCoverLift=this.tileCoverLift,P=W.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:M,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.minzoom<=1&&s.projection.name==="globe"&&(P.push(new i.aO(1,0,1,0,0)),P.push(new i.aO(1,0,1,1,0)),P.push(new i.aO(1,0,1,0,1)),P.push(new i.aO(1,0,1,1,1)))}else if(P=s.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:M,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);P=P.filter(Y=>W(Y))}}else P=[];if(P.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!X0(this._source.type)){const W=s.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),Y=Math.min(W,this._source.maxzoom);if(E){const ee=s.extendTileCover(P,Y);for(const te of ee)P.push(te)}else if(b){const ee=s.extendTileCoverToNearPlane(P,this.transform.getFrustum(Y),Y);for(const te of ee)P.push(te)}else if(this.castsShadows&&x){const ee=s.extendTileCover(P,Y,x);for(const te of ee)this._shadowCasterTiles[te.key]=!0,P.push(te)}}const j=this._updateRetainedTiles(P);if(X0(this._source.type)&&P.length!==0){const W={},Y={},ee=Object.keys(j);for(const ce of ee){const oe=j[ce],de=this._tiles[ce];if(!de||de.fadeEndTime&&de.fadeEndTime<=i.o.now())continue;const xe=this.findLoadedParent(oe,Math.max(oe.overscaledZ-Ns.maxOverzooming,this._source.minzoom));xe&&(this._addTile(xe.tileID),W[xe.tileID.key]=xe.tileID),Y[ce]=oe}const te=P[P.length-1].overscaledZ;for(const ce in this._tiles){const oe=this._tiles[ce];if(j[ce]||!oe.hasData())continue;let de=oe.tileID;for(;de.overscaledZ>te;){de=de.scaledTo(de.overscaledZ-1);const xe=this._tiles[de.key];if(xe&&xe.hasData()&&Y[de.key]){j[ce]=oe.tileID;break}}}for(const ce in W)j[ce]||(this._coveredTiles[ce]=!0,j[ce]=W[ce])}for(const W in j)this._tiles[W].clearFadeHold();const X=i.bv(this._tiles,j);for(const W of X){const Y=this._tiles[W];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const h={};if(s.length===0)return h;const m={},x=s.reduce((B,j)=>Math.min(B,j.overscaledZ),1/0),b=s[0].overscaledZ,E=Math.max(b-Ns.maxOverzooming,this._source.minzoom),P=Math.max(b+Ns.maxUnderzooming,this._source.minzoom),M={};for(const B of s){const j=this._addTile(B);h[B.key]=B,j.hasData()||x<this._source.maxzoom&&(M[B.key]=B)}this._retainLoadedChildren(M,x,P,h);for(const B of s){let j=this._tiles[B.key];if(j.hasData())continue;if(B.canonical.z>=this._source.maxzoom){const W=B.children(this._source.maxzoom)[0],Y=this.getTile(W);if(Y&&Y.hasData()){h[W.key]=W;continue}}else{const W=B.children(this._source.maxzoom);if(h[W[0].key]&&h[W[1].key]&&h[W[2].key]&&h[W[3].key])continue}let X=j.wasRequested();for(let W=B.overscaledZ-1;W>=E;--W){const Y=B.scaledTo(W);if(m[Y.key]||(m[Y.key]=!0,j=this.getTile(Y),!j&&X&&(j=this._addTile(Y)),j&&(h[Y.key]=Y,X=j.wasRequested(),j.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const h=[];let m,x=this._tiles[s].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}h.push(x.key);const b=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(b),m)break;x=b}for(const b of h)this._loadedParentTiles[b]=m}}_addTile(s){let h=this._tiles[s.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),h;h=this._cache.getAndRemove(s),h&&(this._setTileReloadTimer(s.key,h),h.tileID=s,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,h)));const m=!!h;if(!m){const x=this.map?this.map.painter:null,b=this._source.tileSize*s.overscaleFactor();h=this._source.type==="raster-array"?new qp(s,b,this.transform.tileZoom,x,this._isRaster):new Ou(s,b,this.transform.tileZoom,x,this._isRaster,this._source.worldview),this._loadTile(h,this._tileLoaded.bind(this,h,s.key,h.state))}return h.uses++,this._tiles[s.key]=h,m||this._source.fire(new i.z("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(s,h){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const m=h.getExpiryTimeout();m&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},m))}_removeTile(s){const h=this._tiles[s];h&&(h.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,h,m){const x=[],b=this.transform;if(!b)return x;const E=b.projection.name==="globe",P=i.aF(b.center.lng);for(const M in this._tiles){const B=this._tiles[M];if(m&&B.clearQueryDebugViz(),B.holdingForFade())continue;let j;if(E){const X=B.tileID.canonical;if(X.z===0){const W=[Math.abs(i.aA(P,...Zf(X,-1))-P),Math.abs(i.aA(P,...Zf(X,1))-P)];j=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(i.aA(P,...Zf(X,-1))-P),Math.abs(i.aA(P,...Zf(X,0))-P),Math.abs(i.aA(P,...Zf(X,1))-P)];j=[W.indexOf(Math.min(...W))-1]}}else j=[0];for(const X of j){const W=s.containsTile(B,b,h,X);W&&x.push(W)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,h){const m=this.getRenderableIds(s,h).map(b=>this._tiles[b].tileID),x=this.transform.projection.name==="globe";for(const b of m)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=x?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return m}sortCoordinatesByDistance(s){const h=s.slice(),m=this.transform._camera.position,x=this.transform._camera.forward(),b={};for(const E of h){const P=1/(1<<E.canonical.z);b[E.key]=((E.canonical.x+.5)*P+E.wrap-m[0])*x[0]+((E.canonical.y+.5)*P-m[1])*x[1]-m[2]*x[2]}return h.sort((E,P)=>b[E.key]-b[P.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(X0(this._source.type))for(const s in this._tiles){const h=this._tiles[s];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=i.o.now())return!0}return!1}setFeatureState(s,h,m){this._state.updateState(s=s||"_geojsonTileLayer",h,m)}removeFeatureState(s,h,m){this._state.removeFeatureState(s=s||"_geojsonTileLayer",h,m)}getFeatureState(s,h){return this._state.getState(s=s||"_geojsonTileLayer",h)}setDependencies(s,h,m){const x=this._tiles[s];x&&x.setDependencies(h,m)}reloadTilesForDependencies(s,h){for(const m in this._tiles)this._tiles[m].hasDependency(s,h)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(s,h))}_preloadTiles(s,h){if(!this._sourceLoaded){const M=()=>{this._sourceLoaded&&(this._source.off("data",M),this._preloadTiles(s,h))};return void this._source.on("data",M)}const m=new Map,x=Array.isArray(s)?s:[s],b=this.map.painter.terrain,E=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const M of x){const B=M.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of B)m.set(j.key,j);this.usedForTerrain&&M.updateElevation(!1)}const P=Array.from(m.values());i.bw(P,(M,B)=>{const j=new Ou(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(j,X=>{this._source.type==="raster-dem"&&j.dem&&this._backfillDEM(j),B(X,j)})},h)}}function Lv(g,s){const h=Math.abs(2*g.wrap)-+(g.wrap<0),m=Math.abs(2*s.wrap)-+(s.wrap<0);return g.overscaledZ-s.overscaledZ||m-h||s.canonical.y-g.canonical.y||s.canonical.x-g.canonical.x}function X0(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Zf(g,s){const h=1<<g.z;return[g.x/h+s,(g.x+1)/h+s]}Ns.maxOverzooming=10,Ns.maxUnderzooming=3;class Z0{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,h=!1;for(const m in this.style._mergedLayers){const x=this.style._mergedLayers[m];if(x.type==="fill-extrusion"||x.type==="building")this.layers.push({layer:x,visible:s,visibilityChanged:h});else if(x.type==="model"){const b=this.style.getLayerSource(x);b&&b.type==="batched-model"&&this.layers.push({layer:x,visible:s,visibilityChanged:h})}}}onNewFrame(s){this.layersGotHidden=!1;for(const h of this.layers){const m=h.layer;let x=!1;m.type==="fill-extrusion"?x=!m.isHidden(s)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="building"?x=!m.isHidden(s)&&m.paint.get("building-opacity")>0:m.type==="model"&&(x=!m.isHidden(s)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&h.visible,h.visible=x}}updateZOffset(s,h){this.currentBuildingBuckets=[];for(const x of this.layers){const b=x.layer,E=this.style.getLayerSourceCache(b);let P=1;b.type==="fill-extrusion"?P=x.visible?b.paint.get("fill-extrusion-vertical-scale"):0:b.type==="building"&&(P=x.visible?b.paint.get("building-vertical-scale"):0);let M=E?E.getTile(h):null;if(!M&&E)for(const B in E._tiles){const j=E._tiles[B];if(h.canonical.isChildOf(j.tileID.canonical)){M=j;break}}this.currentBuildingBuckets.push({bucket:M?M.getBucket(b):null,tileID:M?M.tileID:h,verticalScale:P})}s.hasAnyZOffset=!1;let m=!1;for(let x=0;x<s.symbolInstances.length;x++){const b=s.symbolInstances.get(x),E=b.zOffset,P=this._getHeightAtTileOffset(h,b.tileAnchorX,b.tileAnchorY);b.zOffset=P!==Number.NEGATIVE_INFINITY?P:E,m||E===b.zOffset||(m=!0),s.hasAnyZOffset||b.zOffset===0||(s.hasAnyZOffset=!0)}m&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,h,m,x){let b=h,E=m;if(s.canonical.z!==x.canonical.z){const P=x.canonical,M=1/(1<<s.canonical.z-P.z);b=(h+s.canonical.x*i.al)*M-P.x*i.al|0,E=(m+s.canonical.y*i.al)*M-P.y*i.al|0}return{tileX:b,tileY:E}}_getHeightAtTileOffset(s,h,m){let x,b;for(let E=0;E<this.layers.length;++E){const P=this.layers[E].layer;if(P.type!=="fill-extrusion"&&P.type!=="building")continue;const{bucket:M,tileID:B,verticalScale:j}=this.currentBuildingBuckets[E];if(!M)continue;const{tileX:X,tileY:W}=this._mapCoordToOverlappingTile(s,h,m,B),Y=M.getHeightAtTileCoord(X,W);Y&&Y.height!==void 0&&(Y.hidden?x=Y.height:b=Math.max(Y.height*j,b||0))}if(b!==void 0)return b;for(let E=0;E<this.layers.length;++E){const P=this.layers[E];if(P.layer.type!=="model"||!P.visible)continue;const{bucket:M,tileID:B}=this.currentBuildingBuckets[E];if(!M)continue;const{tileX:j,tileY:X}=this._mapCoordToOverlappingTile(s,h,m,B),W=M.getHeightAtTileCoord(j,X);if(W&&!W.hidden)return W.height===void 0&&x!==void 0?Math.min(W.maxHeight,x)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Nv(g,s){const h={};for(const m in g)m!=="ref"&&(h[m]=g[m]);return i.bx.forEach(m=>{m in s&&(h[m]=s[m])}),h}function Y0(g){g=g.slice();const s=Object.create(null);for(let h=0;h<g.length;h++)s[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=Nv(g[h],s[g[h].ref]));return g}const mn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Yf(g,s,h){h.push({command:mn.addSource,args:[g,s[g]]})}function k2(g,s,h){s.push({command:mn.removeSource,args:[g]}),h[g]=!0}function O2(g,s,h,m){k2(g,h,m),Yf(g,s,h)}function K0(g,s,h){let m;for(m in g[h])if(g[h].hasOwnProperty(m)&&m!=="data"&&!i.by(g[h][m],s[h][m]))return!1;for(m in s[h])if(s[h].hasOwnProperty(m)&&m!=="data"&&!i.by(g[h][m],s[h][m]))return!1;return!0}function Mu(g,s,h,m,x,b){let E;for(E in s=s||{},g=g||{})g.hasOwnProperty(E)&&(i.by(g[E],s[E])||h.push({command:b,args:[m,E,s[E],x]}));for(E in s)s.hasOwnProperty(E)&&!g.hasOwnProperty(E)&&(i.by(g[E],s[E])||h.push({command:b,args:[m,E,s[E],x]}))}function Kf(g){return g.id}function Zp(g,s){return g[s.id]=s,g}function J0(g,s,h){const m=s.createTileMatrix(g,g.worldSize,h.toUnwrapped());return i.aB(new Float32Array(16),g.projMatrix,m)}function M2(g,s,h){if(s.projection.name===h.projection.name)return g.projMatrix;const m=h.clone();return m.setProjection(s.projection),J0(m,s.getProjection(),g)}function Fh(g,s,h){return s.name===h.projection.name?g.projMatrix:J0(h,s,g)}class R2{constructor(s,h){this.reset(s,h)}reset(s,h){this.points=s||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.aA(s,0,1);let h=1,m=this._distances[h];const x=s*this.paddedLength+this.padding;for(;m<x&&h<this._distances.length;)m=this._distances[++h];const b=h-1,E=this._distances[b],P=m-E,M=P>0?(x-E)/P:0;return this.points[b].mult(1-M).add(this.points[h].mult(M))}}class Bv{constructor(s,h,m){const x=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(s/m),this.yCellCount=Math.ceil(h/m);for(let E=0;E<this.xCellCount*this.yCellCount;E++)x.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=h,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,h,m,x,b){this._forEachCell(h,m,x,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(b)}insertCircle(s,h,m,x){this._forEachCell(h-x,m-x,h+x,m+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(h),this.circles.push(m),this.circles.push(x)}_insertBoxCell(s,h,m,x,b,E){this.boxCells[b].push(E)}_insertCircleCell(s,h,m,x,b,E){this.circleCells[b].push(E)}_query(s,h,m,x,b,E){if(m<0||s>this.width||x<0||h>this.height)return!b&&[];const P=[];if(s<=0&&h<=0&&this.width<=m&&this.height<=x){if(b)return!0;for(let M=0;M<this.boxKeys.length;M++)P.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],j=this.circles[3*M+1],X=this.circles[3*M+2];P.push({key:this.circleKeys[M],x1:B-X,y1:j-X,x2:B+X,y2:j+X})}return E?P.filter(E):P}return this._forEachCell(s,h,m,x,this._queryCell,P,{hitTest:b,seenUids:{box:{},circle:{}}},E),b?P.length>0:P}_queryCircle(s,h,m,x,b){const E=s-m,P=s+m,M=h-m,B=h+m;if(P<0||E>this.width||B<0||M>this.height)return!x&&[];const j=[];return this._forEachCell(E,M,P,B,this._queryCellCircle,j,{hitTest:x,circle:{x:s,y:h,radius:m},seenUids:{box:{},circle:{}}},b),x?j.length>0:j}query(s,h,m,x,b){return this._query(s,h,m,x,!1,b)}hitTest(s,h,m,x,b){return this._query(s,h,m,x,!0,b)}hitTestCircle(s,h,m,x){return this._queryCircle(s,h,m,!0,x)}_queryCell(s,h,m,x,b,E,P,M){const B=P.seenUids,j=this.boxCells[b];if(j!==null){const W=this.bboxes;for(const Y of j)if(!B.box[Y]){B.box[Y]=!0;const ee=4*Y;if(s<=W[ee+2]&&h<=W[ee+3]&&m>=W[ee+0]&&x>=W[ee+1]&&(!M||M(this.boxKeys[Y]))){if(P.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[Y],x1:W[ee],y1:W[ee+1],x2:W[ee+2],y2:W[ee+3]})}}}const X=this.circleCells[b];if(X!==null){const W=this.circles;for(const Y of X)if(!B.circle[Y]){B.circle[Y]=!0;const ee=3*Y;if(this._circleAndRectCollide(W[ee],W[ee+1],W[ee+2],s,h,m,x)&&(!M||M(this.circleKeys[Y]))){if(P.hitTest)return E.push(!0),!0;{const te=W[ee],ce=W[ee+1],oe=W[ee+2];E.push({key:this.circleKeys[Y],x1:te-oe,y1:ce-oe,x2:te+oe,y2:ce+oe})}}}}}_queryCellCircle(s,h,m,x,b,E,P,M){const B=P.circle,j=P.seenUids,X=this.boxCells[b];if(X!==null){const Y=this.bboxes;for(const ee of X)if(!j.box[ee]){j.box[ee]=!0;const te=4*ee;if(this._circleAndRectCollide(B.x,B.y,B.radius,Y[te+0],Y[te+1],Y[te+2],Y[te+3])&&(!M||M(this.boxKeys[ee])))return E.push(!0),!0}}const W=this.circleCells[b];if(W!==null){const Y=this.circles;for(const ee of W)if(!j.circle[ee]){j.circle[ee]=!0;const te=3*ee;if(this._circlesCollide(Y[te],Y[te+1],Y[te+2],B.x,B.y,B.radius)&&(!M||M(this.circleKeys[ee])))return E.push(!0),!0}}}_forEachCell(s,h,m,x,b,E,P,M){const B=this._convertToXCellCoord(s),j=this._convertToYCellCoord(h),X=this._convertToXCellCoord(m),W=this._convertToYCellCoord(x);for(let Y=B;Y<=X;Y++)for(let ee=j;ee<=W;ee++)if(b.call(this,s,h,m,x,this.xCellCount*ee+Y,E,P,M))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,h,m,x,b,E){const P=x-s,M=b-h,B=m+E;return B*B>P*P+M*M}_circleAndRectCollide(s,h,m,x,b,E,P){const M=(E-x)/2,B=Math.abs(s-(x+M));if(B>M+m)return!1;const j=(P-b)/2,X=Math.abs(h-(b+j));if(X>j+m)return!1;if(B<=M||X<=j)return!0;const W=B-M,Y=X-j;return W*W+Y*Y<=m*m}}const Jf={unknown:0,flipRequired:1,flipNotRequired:2},Q0=Math.tan(85*Math.PI/180);function El(g,s,h,m,x,b,E){const P=i.bC();if(h)if(b.name==="globe"){const M=i.bD(x,s);i.aB(P,P,M)}else{const M=i.bE([],E);P[0]=M[0],P[1]=M[1],P[4]=M[2],P[5]=M[3],m||i.bB(P,P,x.angle)}else i.aB(P,x.labelPlaneMatrix,g);return P}function Yp(g,s,h,m,x,b,E){const P=El(g,s,h,m,x,b,E);return b.name==="globe"&&h||(P[2]=P[6]=P[10]=P[14]=0),P}function eg(g,s,h,m,x,b,E){if(h){if(b.name==="globe"){const P=El(g,s,h,m,x,b,E);return i.bl(P,P),i.aB(P,g,P),P}{const P=i.bz(g),M=i.bA([]);return M[0]=E[0],M[1]=E[1],M[4]=E[2],M[5]=E[3],i.aB(P,P,M),m||i.bB(P,P,-x.angle),P}}return x.glCoordMatrix}function Bs(g,s,h,m){const x=[g,s,h,1];h?i.aC(x,x,m):$v(x,x,m);const b=x[3];return x[0]/=b,x[1]/=b,x[2]/=b,x}function Lh(g,s){return Math.min(.5+g/s*.5,1.5)}function zs(g,s){const h=g[0]/g[3],m=g[1]/g[3];return h>=-s[0]&&h<=s[0]&&m>=-s[1]&&m<=s[1]}function zv(g,s,h,m,x,b,E,P,M,B){const j=h.transform,X=m?g.textSizeData:g.iconSizeData,W=i.bK(X,h.transform.zoom),Y=j.projection.name==="globe",ee=[256/h.width*2+1,256/h.height*2+1],te=m?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;te.clear();let ce=null;Y&&(ce=m?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const oe=g.lineVertexArray,de=m?g.text.placedSymbolArray:g.icon.placedSymbolArray,xe=h.transform.width/h.transform.height;let Ee,De=!1;for(let Me=0;Me<de.length;Me++){const Fe=de.get(Me),{numGlyphs:Re,writingMode:Oe}=Fe;if(Oe!==i.bL.vertical||De||Ee===i.bL.horizontal||(De=!0),Ee=Oe,(Fe.hidden||Oe===i.bL.vertical)&&!De){Ir(Re,te);continue}De=!1;const Le=new i.P(Fe.tileAnchorX,Fe.tileAnchorY);let{x:ct,y:Ke,z:vt}=j.projection.projectTilePoint(Le.x,Le.y,B.canonical);if(M){const[Bt,vr,mr]=M(Le);ct+=Bt,Ke+=vr,vt+=mr}const st=[ct,Ke,vt,1];if(i.aC(st,st,s),!zs(st,ee)){Ir(Re,te);continue}const _t=st[3],Ht=Lh(h.transform.getCameraToCenterDistance(j.projection),_t),lt=i.bM(X,W,Fe),He=E?lt/Ht:lt*Ht,Tt=Bs(ct,Ke,vt,x);if(Tt[3]<=0){Ir(Re,te);continue}let ht={};const Ft=i.an(g.layers[0].layout.get("text-max-angle")),Gt=Math.cos(Ft),tr=E?null:M,Ut=On(Fe,He,!1,P,s,x,b,g.glyphOffsetArray,oe,te,ce,Tt,Le,ht,xe,tr,j.projection,B,E,Gt);De=Ut.useVertical,tr&&Ut.needsFlipping&&(ht={}),(Ut.notEnoughRoom||De||Ut.needsFlipping&&On(Fe,He,!0,P,s,x,b,g.glyphOffsetArray,oe,te,ce,Tt,Le,ht,xe,tr,j.projection,B,E,Gt).notEnoughRoom)&&Ir(Re,te)}m?(g.text.dynamicLayoutVertexBuffer.updateData(te),ce&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(ce)):(g.icon.dynamicLayoutVertexBuffer.updateData(te),ce&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(ce))}function tg(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce){const{lineStartIndex:oe,glyphStartIndex:de,segment:xe}=P,Ee=de+P.numGlyphs,De=oe+P.lineLength,Me=s.getoffsetX(de),Fe=s.getoffsetX(Ee-1),Re=rg(g*Me,h,m,x,b,E,xe,oe,De,M,B,j,X,W,!0,Y,ee,te,ce);if(!Re)return null;const Oe=rg(g*Fe,h,m,x,b,E,xe,oe,De,M,B,j,X,W,!0,Y,ee,te,ce);return Oe?{first:Re,last:Oe}:null}function jv(g,s,h,m){return g===i.bL.horizontal&&Math.abs(m)>Math.abs(h)?{useVertical:!0}:g===i.bL.vertical?m>0?{needsFlipping:!0}:null:s!==Jf.unknown&&function(x,b){return x===0||Math.abs(b/x)>Q0}(h,m)?s===Jf.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function On(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de,xe){const Ee=s/24,De=g.lineOffsetX*Ee,Me=g.lineOffsetY*Ee,{lineStartIndex:Fe,glyphStartIndex:Re,numGlyphs:Oe,segment:Le,writingMode:ct,flipState:Ke}=g,vt=Fe+g.lineLength,st=_t=>{if(j){const[Tt,ht,Ft]=_t.up,Gt=B.length;i.bN(j,Gt+0,Tt,ht,Ft),i.bN(j,Gt+1,Tt,ht,Ft),i.bN(j,Gt+2,Tt,ht,Ft),i.bN(j,Gt+3,Tt,ht,Ft)}const[Ht,lt,He]=_t.point;i.bO(B,Ht,lt,He,_t.angle)};if(Oe>1){const _t=tg(Ee,P,De,Me,h,X,W,g,M,b,Y,te,!1,ce,oe,de,xe);if(!_t)return{notEnoughRoom:!0};if(m&&!h){let[Ht,lt,He]=_t.first.point,[Tt,ht,Ft]=_t.last.point;[Ht,lt]=Bs(Ht,lt,He,E),[Tt,ht]=Bs(Tt,ht,Ft,E);const Gt=jv(ct,Ke,(Tt-Ht)*ee,ht-lt);if(g.flipState=Gt&&Gt.needsFlipping?Jf.flipRequired:Jf.flipNotRequired,Gt)return Gt}st(_t.first);for(let Ht=Re+1;Ht<Re+Oe-1;Ht++){const lt=rg(Ee*P.getoffsetX(Ht),De,Me,h,X,W,Le,Fe,vt,M,b,Y,te,!1,!1,ce,oe,de,xe);if(!lt)return B.length-=4*(Ht-Re),{notEnoughRoom:!0};st(lt)}st(_t.last)}else{if(m&&!h){const Ht=Bs(W.x,W.y,0,x),lt=Fe+Le+1,He=new i.P(M.getx(lt),M.gety(lt)),Tt=Bs(He.x,He.y,0,x),ht=Tt[3]>0?Tt:D2(W,He,Ht,1,x,void 0,ce,oe.canonical),Ft=jv(ct,Ke,(ht[0]-Ht[0])*ee,ht[1]-Ht[1]);if(g.flipState=Ft&&Ft.needsFlipping?Jf.flipRequired:Jf.flipNotRequired,Ft)return Ft}const _t=rg(Ee*P.getoffsetX(Re),De,Me,h,X,W,Le,Fe,vt,M,b,Y,te,!1,!1,ce,oe,de,xe);if(!_t)return{notEnoughRoom:!0};st(_t)}return{}}function Uv(g,s,h,m,x){const{x:b,y:E,z:P}=m.projectTilePoint(g.x,g.y,s);if(!x)return Bs(b,E,P,h);const[M,B,j]=x(g);return Bs(b+M,E+B,P+j,h)}function D2(g,s,h,m,x,b,E,P){const M=Uv(g.sub(s)._unit()._add(g),P,x,E,b);return i.av(M,h,M),i.aw(M,M),i.bH(M,h,M,m)}function rg(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de){const xe=m?g-s:g+s;let Ee=xe>0?1:-1,De=0;m&&(Ee*=-1,De=Math.PI),Ee<0&&(De+=Math.PI);let Me=P+E+(Ee>0?0:1)|0,Fe=x,Re=x,Oe=0,Le=0;const ct=Math.abs(xe),Ke=[],vt=[];let st=b,_t=st,Ht=i.bF([]);const lt=()=>D2(_t,st,Re,ct-Oe+1,j,W,te,ce.canonical);for(;Oe+Le<=ct;){if(Me+=Ee,Me<P||Me>=M)return null;if(Re=Fe,_t=st,Ke.push(Re),Y&&vt.push(_t),st=new i.P(B.getx(Me),B.gety(Me)),Fe=X[Me],!Fe){const mr=Uv(st,ce.canonical,j,te,W);Fe=mr[3]>0?X[Me]=mr:lt()}Oe+=Le;const Bt=i.av([],Fe,Re),vr=i.bG(Re,Fe);if(h&&vr>0&&Le>0&&i.bJ(Ht,Bt)/(Le*vr)<de)return null;Le=vr,Ht=Bt}ee&&W&&(X[Me]&&(Fe=lt(),Le=i.bG(Re,Fe),Ht=i.av([],Fe,Re)),X[Me]=Fe);const He=(ct-Oe)/Le,Tt=st.sub(_t)._mult(He)._add(_t),ht=i.bH([],Re,Ht,He);let Ft=[0,0,1],Gt=Ht[0],tr=Ht[1];if(oe&&(Ft=te.upVector(ce.canonical,Tt.x,Tt.y),Ft[0]!==0||Ft[1]!==0||Ft[2]!==1)){const Bt=[Ft[2],0,-Ft[0]],vr=i.bI([],Ft,Bt);i.aw(Bt,Bt),i.aw(vr,vr),Gt=i.bJ(Ht,Bt),tr=i.bJ(Ht,vr)}if(h){const Bt=i.bI([],Ft,Ht);i.aw(Bt,Bt),i.bH(ht,ht,Bt,h*Ee)}const Ut=De+Math.atan2(tr,Gt);return Ke.push(ht),Y&&vt.push(Tt),{point:ht,angle:Ut,path:Ke,tilePath:vt,up:Ft}}function Ir(g,s){const h=s.length,m=h+4*g;s.resize(m),s.float32.fill(-1/0,4*h,4*m)}function $v(g,s,h){const m=s[0],x=s[1];return g[0]=h[0]*m+h[4]*x+h[12],g[1]=h[1]*m+h[5]*x+h[13],g[3]=h[3]*m+h[7]*x+h[15],g}const js=100;class Al{constructor(s,h,m=new Bv(s.width+200,s.height+200,25),x=new Bv(s.width+200,s.height+200,25)){this.transform=s,this.grid=m,this.ignoredGrid=x,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+js,this.screenBottomBoundary=s.height+js,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=h}placeCollisionBox(s,h,m,x,b,E,P,M,B,j,X){let W=m.projectedAnchorX,Y=m.projectedAnchorY,ee=m.projectedAnchorZ;const te=m.tileAnchorX,ce=m.tileAnchorY,oe=m.elevation,de=m.tileID,xe=s.getProjection();if(oe&&de){const[vt,st,_t]=xe.upVector(de.canonical,m.tileAnchorX,m.tileAnchorY),Ht=xe.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=vt*oe*Ht,Y+=st*oe*Ht,ee+=_t*oe*Ht}const Ee=s.projection.name==="globe",De=s.projection.name==="globe"?i.aj(this.transform.zoom):0;if(de&&Ee&&De<1&&!E){const vt=1<<de.canonical.z,st=i.bP(te,ce);i.bQ(st,st,1/i.al),i.bR(st,st,i.bP(de.canonical.x,de.canonical.y)),i.bQ(st,st,1/vt),i.bS(st,st,i.bP(x[0],x[1])),st[0]=i.bT(st[0],-.5,.5),i.bQ(st,st,i.al);const _t=i.bU(st[0],st[1],i.al/(2*Math.PI),1);i.aC(_t,_t,b),W=i.ak(W,_t[0],De),Y=i.ak(Y,_t[1],De),ee=i.ak(ee,_t[2],De)}const Me=this.projectAndGetPerspectiveRatio(j,W,Y,ee,m.tileID,xe.name==="globe"||!!oe||this.transform.pitch>0,xe),Fe=B*Me.perspectiveRatio,Re=(m.x1*h+P.x-m.padding)*Fe+Me.point.x,Oe=(m.y1*h+P.y-m.padding)*Fe+Me.point.y,Le=(m.x2*h+P.x+m.padding)*Fe+Me.point.x,ct=(m.y2*h+P.y+m.padding)*Fe+Me.point.y,Ke=Me.perspectiveRatio<=.55||Me.occluded;return!this.isInsideGrid(Re,Oe,Le,ct)||!M&&this.grid.hitTest(Re,Oe,Le,ct,X)||Ke?{box:[],offscreen:!1,occluded:Me.occluded}:{box:[Re,Oe,Le,ct],offscreen:this.isOffscreen(Re,Oe,Le,ct),occluded:!1}}placeCollisionCircles(s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te){const ce=[],oe=this.transform.elevation,de=s.getProjection(),xe=oe?oe.getAtTileOffsetFunc(te,this.transform.center.lat,this.transform.worldSize,de):null,Ee=new i.P(m.tileAnchorX,m.tileAnchorY);let{x:De,y:Me,z:Fe}=de.projectTilePoint(Ee.x,Ee.y,te.canonical);if(xe){const[Ft,Gt,tr]=xe(Ee);De+=Ft,Me+=Gt,Fe+=tr}const Re=de.name==="globe",Oe=this.projectAndGetPerspectiveRatio(P,De,Me,Fe,te,Re||!!oe||this.transform.pitch>0,de),{perspectiveRatio:Le}=Oe,ct=(X?E/Le:E*Le)/i.bX,Ke=Bs(De,Me,Fe,M),vt=m.lineOffsetX*ct,st=m.lineOffsetY*ct,_t=i.an(s.layers[0].layout.get("text-max-angle")),Ht=Math.cos(_t),lt=Oe.signedDistanceFromCamera>0?tg(ct,b,vt,st,!1,Ke,Ee,m,x,M,{},oe&&!X?xe:null,X&&!!oe,de,te,X,Ht):null;let He=!1,Tt=!1,ht=!0;if(lt&&!Oe.occluded){const Ft=.5*Y*Le+ee,Gt=new i.P(-100,-100),tr=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Ut=new R2,{first:Bt,last:vr}=lt,mr=Bt.path.length;let _r=[];for(let qr=mr-1;qr>=1;qr--)_r.push(Bt.path[qr]);for(let qr=1;qr<vr.path.length;qr++)_r.push(vr.path[qr]);const pr=2.5*Ft;B&&(_r=_r.map(([qr,Jr,Rn],$r)=>(xe&&!Re&&(Rn=xe($r<mr-1?Bt.tilePath[mr-1-$r]:vr.tilePath[$r-mr+2])[2]),Bs(qr,Jr,Rn,B))),_r.some(qr=>qr[3]<=0)&&(_r=[]));let zr=[];if(_r.length>0){let qr=1/0,Jr=-1/0,Rn=1/0,$r=-1/0;for(const vn of _r)qr=Math.min(qr,vn[0]),Rn=Math.min(Rn,vn[1]),Jr=Math.max(Jr,vn[0]),$r=Math.max($r,vn[1]);Jr>=Gt.x&&qr<=tr.x&&$r>=Gt.y&&Rn<=tr.y&&(zr=[_r.map(vn=>new i.P(vn[0],vn[1]))],(qr<Gt.x||Jr>tr.x||Rn<Gt.y||$r>tr.y)&&(zr=i.bV(zr,Gt.x,Gt.y,tr.x,tr.y)))}for(const qr of zr){Ut.reset(qr,.25*Ft);let Jr=0;Jr=Ut.length<=.5*Ft?1:Math.ceil(Ut.paddedLength/pr)+1;for(let Rn=0;Rn<Jr;Rn++){const $r=Rn/Math.max(Jr-1,1),vn=Ut.lerp($r),In=vn.x+js,ui=vn.y+js;ce.push(In,ui,Ft,0);const Xr=In-Ft,Tn=ui-Ft,wn=In+Ft,Cn=ui+Ft;if(ht=ht&&this.isOffscreen(Xr,Tn,wn,Cn),Tt=Tt||this.isInsideGrid(Xr,Tn,wn,Cn),!h&&this.grid.hitTestCircle(In,ui,Ft,W)&&(He=!0,!j))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!j&&He||!Tt?[]:ce,offscreen:ht,collisionDetected:He,occluded:Oe.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let m=1/0,x=1/0,b=-1/0,E=-1/0;for(const j of s){const X=new i.P(j.x+js,j.y+js);m=Math.min(m,X.x),x=Math.min(x,X.y),b=Math.max(b,X.x),E=Math.max(E,X.y),h.push(X)}const P=this.grid.query(m,x,b,E).concat(this.ignoredGrid.query(m,x,b,E)),M={},B={};for(const j of P){const X=j.key;if(M[X.bucketInstanceId]===void 0&&(M[X.bucketInstanceId]={}),M[X.bucketInstanceId][X.featureIndex])continue;const W=[new i.P(j.x1,j.y1),new i.P(j.x2,j.y1),new i.P(j.x2,j.y2),new i.P(j.x1,j.y2)];i.bW(h,W)&&(M[X.bucketInstanceId][X.featureIndex]=!0,B[X.bucketInstanceId]===void 0&&(B[X.bucketInstanceId]=[]),B[X.bucketInstanceId].push(X.featureIndex))}return B}insertCollisionBox(s,h,m,x,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:b},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,h,m,x,b){const E=h?this.ignoredGrid:this.grid,P={bucketInstanceId:m,featureIndex:x,collisionGroupID:b};for(let M=0;M<s.length;M+=4)E.insertCircle(P,s[M],s[M+1],s[M+2])}projectAndGetPerspectiveRatio(s,h,m,x,b,E,P){const M=[h,m,x,1];let B=!1;x||this.transform.pitch>0?(i.aC(M,M,s),this.fogState&&b&&P.name!=="globe"&&(B=function(W,Y,ee,te,ce,oe){const de=oe.calculateFogTileMatrix(ce),xe=[Y,ee,te];return i.af(xe,xe,de),wt(W,i.ag(xe),oe.pitch,oe._fov)}(this.fogState,h,m,x,b.toUnwrapped(),this.transform)>.9)):$v(M,M,s);const j=M[3];return{point:new i.P((M[0]/j+1)/2*this.transform.width+js,(-M[1]/j+1)/2*this.transform.height+js),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/j*.5,1.5),signedDistanceFromCamera:j,occluded:E&&M[2]>j||B}}isOffscreen(s,h,m,x){return m<js||s>=this.screenRightBoundary||x<js||h>this.screenBottomBoundary}isInsideGrid(s,h,m,x){return m>=0&&s<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const s=i.bA([]);return i.br(s,s,[-100,-100,0]),s}}class ng{constructor(s,h,m,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?h:-h))):x&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class rc{constructor(s,h,m,x,b,E=!1){this.text=new ng(s?s.text:null,h,m,b),this.icon=new ng(s?s.icon:null,h,x,b),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wr{constructor(s,h,m,x=!1){this.text=s,this.icon=h,this.skipFade=m,this.clipped=x}}class Mn{constructor(){this.invProjMatrix=i.bC(),this.viewportMatrix=i.bC(),this.circles=[]}}class Ln{constructor(s,h,m,x,b){this.bucketInstanceId=s,this.featureIndex=h,this.sourceLayerIndex=m,this.bucketIndex=x,this.tileID=b}}class fs{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const h=++this.maxGroupID;this.collisionGroups[s]={ID:h,predicate:m=>m.collisionGroupID===h}}return this.collisionGroups[s]}}function Nh(g,s,h,m,x){const{horizontalAlign:b,verticalAlign:E}=i.c0(g),P=-(b-.5)*s,M=-(E-.5)*h,B=i.c1(g,m);return new i.P(P+B[0]*x,M+B[1]*x)}function An(g,s,h,m,x){const b=new i.P(g,s);return h&&b._rotate(m?x:-x),b}class ig{constructor(s,h,m,x,b,E){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Al(this.transform,b),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new fs(m),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,h,m,x,b=1){const E=m.getBucket(h),P=m.latestFeatureIndex;if(!E||!P||h.fqid!==E.layerIds[0])return;const M=E.layers[0].layout,B=E.layers[0].paint,j=m.collisionBoxArray,X=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),W=m.tileSize/i.al,Y=m.tileID.toUnwrapped();this.transform.setProjection(E.projection);const ee=(te=m.tileID,ce=E.getProjection(),oe=this.transform,ce.name===this.projection?oe.calculateProjMatrix(te.toUnwrapped()):J0(oe,ce,te));var te,ce,oe;const de=M.get("text-pitch-alignment")==="map",xe=M.get("text-rotation-alignment")==="map";h.compileFilter(h.options);const Ee=h.dynamicFilter(),De=h.dynamicFilterNeedsFeature(),Me=this.transform.calculatePixelsToTileUnitsMatrix(m),Fe=Yp(ee,m.tileID.canonical,de,xe,this.transform,E.getProjection(),Me);let Re=null;const Oe=E.getProjection().createInversionMatrix(this.transform,m.tileID.canonical);if(de){const He=eg(ee,m.tileID.canonical,de,xe,this.transform,E.getProjection(),Me);Re=i.aB([],this.transform.labelPlaneMatrix,He)}let Le=null;Ee&&m.latestFeatureIndex&&(Le={unwrappedTileID:Y,dynamicFilter:Ee,dynamicFilterNeedsFeature:De}),this.retainedQueryData[E.bucketInstanceId]=new Ln(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,m.tileID);const[ct,Ke]=E.layers[0].layout.get("text-size-scale-range"),vt=i.aA(b,ct,Ke),[st,_t]=M.get("icon-size-scale-range"),Ht=i.aA(b,st,_t),lt={bucket:E,layout:M,paint:B,posMatrix:ee,invMatrix:Oe,mercatorCenter:[i.aF(this.transform.center.lng),i.aJ(this.transform.center.lat)],textLabelPlaneMatrix:Fe,labelToScreenMatrix:Re,clippingData:Le,scale:X,textPixelRatio:W,holdingForFade:m.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:i.bK(E.textSizeData,this.transform.zoom,vt),partiallyEvaluatedIconSize:i.bK(E.iconSizeData,this.transform.zoom,Ht),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(x)for(const He of E.sortKeyRanges){const{sortKey:Tt,symbolInstanceStart:ht,symbolInstanceEnd:Ft}=He;s.push({sortKey:Tt,symbolInstanceStart:ht,symbolInstanceEnd:Ft,parameters:lt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:lt})}attemptAnchorPlacement(s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de,xe,Ee,De){const{textOffset0:Me,textOffset1:Fe,crossTileID:Re}=te,Oe=[Me,Fe],Le=Nh(s,E,P,Oe,M),ct=this.collisionIndex.placeCollisionBox(oe,M,h,m,x,b,An(Le.x,Le.y,B,j,this.transform.angle),ee,X,W,Y.predicate);if(xe){const Ke=oe.getSymbolInstanceIconSize(De,this.transform.zoom,te.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(oe,Ke,xe,m,x,b,An(Le.x,Le.y,B,j,this.transform.angle),ee,X,W,Y.predicate).box.length===0)return}if(ct.box.length>0){let Ke;return this.prevPlacement&&this.prevPlacement.variableOffsets[Re]&&this.prevPlacement.placements[Re]&&this.prevPlacement.placements[Re].text&&(Ke=this.prevPlacement.variableOffsets[Re].anchor),this.variableOffsets[Re]={textOffset:Oe,width:E,height:P,anchor:s,textScale:M,prevAnchor:Ke},this.markUsedJustification(oe,s,te,de),oe.allowVerticalPlacement&&(this.markUsedOrientation(oe,de,te),this.placedOrientations[Re]=de),{shift:Le,placedGlyphBoxes:ct}}}placeLayerBucketPart(s,h,m,x,b=1){const{bucket:E,layout:P,paint:M,posMatrix:B,textLabelPlaneMatrix:j,labelToScreenMatrix:X,clippingData:W,textPixelRatio:Y,mercatorCenter:ee,invMatrix:te,holdingForFade:ce,collisionBoxArray:oe,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:xe,collisionGroup:Ee,latestFeatureIndex:De}=s.parameters,Me=P.get("text-optional"),Fe=P.get("icon-optional"),Re=P.get("text-allow-overlap"),Oe=P.get("icon-allow-overlap"),Le=P.get("text-rotation-alignment")==="map",ct=P.get("icon-rotation-alignment")==="map",Ke=P.get("text-pitch-alignment")==="map",vt=M.get("symbol-z-offset"),st=P.get("symbol-elevation-reference")==="sea",_t=P.get("symbol-placement"),[Ht,lt]=P.get("text-size-scale-range"),[He,Tt]=P.get("icon-size-scale-range"),ht=i.aA(b,Ht,lt),Ft=i.aA(b,He,Tt),Gt=P.get("text-variable-anchor"),tr=Le&&_t!=="point",Ut=ct&&_t!=="point",Bt=Gt&&E.hasTextData(),vr=E.hasIconTextFit()&&Bt&&E.hasIconData();this.transform.setProjection(E.projection);const mr=Bt||tr,_r=Ut||vr;let pr=Re&&(Oe||!E.hasIconData()||Fe),zr=Oe&&(Re||!E.hasTextData()||Me);const qr=!vt.isConstant();!E.collisionArrays&&oe&&E.deserializeCollisionBoxes(oe),m&&x&&E.updateCollisionDebugBuffers(this.transform.zoom,oe,ht,Ft);const Jr=($r,vn,In)=>{const{crossTileID:ui,numVerticalGlyphVertices:Xr}=$r;let Tn=null;if(W&&W.dynamicFilterNeedsFeature||qr){const Fi=this.retainedQueryData[E.bucketInstanceId];Tn=De.loadFeature({featureIndex:$r.featureIndex,bucketIndex:Fi.bucketIndex,sourceLayerIndex:Fi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Tn,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new i.P($r.tileAnchorX,$r.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[ui]=new wr(!1,!1,!1,!0),void h.add(ui);const wn=vt.evaluate(Tn,{});if(h.has(ui))return;if(ce)return void(this.placements[ui]=new wr(!1,!1,!1));let Cn=!1,di=!1,Ui=!0,La=!1,pi=!1,Qr=null,Rr={box:null,offscreen:null,occluded:null},Dn={box:null},ki=null,vi=null,oa=null,qa=0,Ws=0,Gs=0;In.textFeatureIndex?qa=In.textFeatureIndex:$r.useRuntimeCollisionCircles&&(qa=$r.featureIndex),In.verticalTextFeatureIndex&&(Ws=In.verticalTextFeatureIndex);const ps=Fi=>{Fi.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const $i=this.transform.elevation;Fi.elevation=st?wn:wn+($i?$i.getAtTileOffset(Fi.tileID,Fi.tileAnchorX,Fi.tileAnchorY):0),Fi.elevation+=$r.zOffset},ms=In.textBox;if(ms){ps(ms);const Fi=xi=>{let ga=i.bL.horizontal;if(E.allowVerticalPlacement&&!xi&&this.prevPlacement){const Na=this.prevPlacement.placedOrientations[ui];Na&&(this.placedOrientations[ui]=Na,ga=Na,this.markUsedOrientation(E,ga,$r))}return ga},$i=(xi,ga)=>{if(E.allowVerticalPlacement&&Xr>0&&In.verticalTextBox){for(const Na of E.writingModes)if(Na===i.bL.vertical?(Rr=ga(),Dn=Rr):Rr=xi(),Rr&&Rr.box&&Rr.box.length)break}else Rr=xi()};if(Gt){let xi=Gt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ui]){const qi=this.prevPlacement.variableOffsets[ui];xi.indexOf(qi.anchor)>0&&(xi=xi.filter(ho=>ho!==qi.anchor),xi.unshift(qi.anchor))}const ga=(qi,ho,lc)=>{const qc=E.getSymbolInstanceTextSize(de,$r,this.transform.zoom,vn),Rl=(qi.x2-qi.x1)*qc+2*qi.padding,Yu=(qi.y2-qi.y1)*qc+2*qi.padding,Ku=$r.hasIconTextFit&&!Oe?ho:null;Ku&&ps(Ku);let cc={box:[],offscreen:!1,occluded:!1};const Ed=Re?2*xi.length:xi.length;for(let Xc=0;Xc<Ed;++Xc){const uc=this.attemptAnchorPlacement(xi[Xc%xi.length],qi,ee,te,mr,Rl,Yu,qc,Le,Ke,Y,B,Ee,Xc>=xi.length,$r,vn,E,lc,Ku,de,xe);if(uc&&(cc=uc.placedGlyphBoxes,cc&&cc.box&&cc.box.length)){Cn=!0,Qr=uc.shift;break}}return cc};$i(()=>ga(ms,In.iconBox,i.bL.horizontal),()=>{const qi=In.verticalTextBox;return qi&&ps(qi),E.allowVerticalPlacement&&!(Rr&&Rr.box&&Rr.box.length)&&Xr>0&&qi?ga(qi,In.verticalIconBox,i.bL.vertical):{box:null,offscreen:null,occluded:null}}),Rr&&(Cn=Rr.box,Ui=Rr.offscreen,La=Rr.occluded);const Na=Fi(!(!Rr||!Rr.box));if(!Cn&&this.prevPlacement){const qi=this.prevPlacement.variableOffsets[ui];qi&&(this.variableOffsets[ui]=qi,this.markUsedJustification(E,qi.anchor,$r,Na))}}else{const xi=(ga,Na)=>{const qi=E.getSymbolInstanceTextSize(de,$r,this.transform.zoom,vn),ho=this.collisionIndex.placeCollisionBox(E,qi,ga,ee,te,mr,new i.P(0,0),Re,Y,B,Ee.predicate);return ho&&ho.box&&ho.box.length&&(this.markUsedOrientation(E,Na,$r),this.placedOrientations[ui]=Na),ho};$i(()=>xi(ms,i.bL.horizontal),()=>{const ga=In.verticalTextBox;return E.allowVerticalPlacement&&Xr>0&&ga?(ps(ga),xi(ga,i.bL.vertical)):{box:null,offscreen:null,occluded:null}}),Fi(!!(Rr&&Rr.box&&Rr.box.length))}}if(ki=Rr,Cn=ki&&ki.box&&ki.box.length>0,Ui=ki&&ki.offscreen,La=ki&&ki.occluded,$r.useRuntimeCollisionCircles){const Fi=E.text.placedSymbolArray.get($r.centerJustifiedTextSymbolIndex>=0?$r.centerJustifiedTextSymbolIndex:$r.verticalPlacedTextSymbolIndex),$i=i.bM(E.textSizeData,de,Fi),xi=P.get("text-padding");vi=this.collisionIndex.placeCollisionCircles(E,Re,Fi,E.lineVertexArray,E.glyphOffsetArray,$i,B,j,X,m,Ke,Ee.predicate,$r.collisionCircleDiameter*$i/i.bX,xi,this.retainedQueryData[E.bucketInstanceId].tileID),Cn=Re||vi.circles.length>0&&!vi.collisionDetected,Ui=Ui&&vi.offscreen,La=vi.occluded}if(In.iconFeatureIndex&&(Gs=In.iconFeatureIndex),In.iconBox){const Fi=$i=>{ps($i);const xi=$r.hasIconTextFit&&Qr?An(Qr.x,Qr.y,Le,Ke,this.transform.angle):new i.P(0,0),ga=E.getSymbolInstanceIconSize(xe,this.transform.zoom,$r.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,ga,$i,ee,te,_r,xi,Oe,Y,B,Ee.predicate)};Dn&&Dn.box&&Dn.box.length&&In.verticalIconBox?(oa=Fi(In.verticalIconBox),di=oa.box.length>0):(oa=Fi(In.iconBox),di=oa.box.length>0),Ui=Ui&&oa.offscreen,pi=oa.occluded}const Vo=Me||$r.numHorizontalGlyphVertices===0&&Xr===0,ol=Fe||$r.numIconVertices===0;if(Vo||ol?ol?Vo||(di=di&&Cn):Cn=di&&Cn:di=Cn=di&&Cn,Cn&&ki&&ki.box&&this.collisionIndex.insertCollisionBox(ki.box,P.get("text-ignore-placement"),E.bucketInstanceId,Dn&&Dn.box&&Ws?Ws:qa,Ee.ID),di&&oa&&this.collisionIndex.insertCollisionBox(oa.box,P.get("icon-ignore-placement"),E.bucketInstanceId,Gs,Ee.ID),vi&&(Cn&&this.collisionIndex.insertCollisionCircles(vi.circles,P.get("text-ignore-placement"),E.bucketInstanceId,qa,Ee.ID),m)){const Fi=E.bucketInstanceId;let $i=this.collisionCircleArrays[Fi];$i===void 0&&($i=this.collisionCircleArrays[Fi]=new Mn);for(let xi=0;xi<vi.circles.length;xi+=4)$i.circles.push(vi.circles[xi+0]),$i.circles.push(vi.circles[xi+1]),$i.circles.push(vi.circles[xi+2]),$i.circles.push(vi.collisionDetected?1:0)}const Ml=E.projection.name!=="globe";pr=pr&&(Ml||!La),zr=zr&&(Ml||!pi),this.placements[ui]=new wr(Cn||pr,di||zr,Ui||E.justReloaded),h.add(ui)},Rn=this.retainedQueryData[E.bucketInstanceId].tileID;if(E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,Rn),E.elevationType==="road"&&E.updateRoadElevation(Rn.canonical),E.updateZOffset(),E.sortFeaturesByY){const $r=E.getSortedSymbolIndexes(this.transform.angle);for(let vn=$r.length-1;vn>=0;--vn){const In=$r[vn];Jr(E.symbolInstances.get(In),In,E.collisionArrays[In])}E.hasAnyZOffset&&i.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const $r=E.getSortedIndexesByZOffset();for(let vn=0;vn<$r.length;++vn){const In=$r[vn];Jr(E.symbolInstances.get(In),In,E.collisionArrays[In])}}else for(let $r=s.symbolInstanceStart;$r<s.symbolInstanceEnd;$r++)Jr(E.symbolInstances.get($r),$r,E.collisionArrays[$r]);if(m&&E.bucketInstanceId in this.collisionCircleArrays){const $r=this.collisionCircleArrays[E.bucketInstanceId];i.bl($r.invProjMatrix,B),$r.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(s,h,m,x){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:M,crossTileID:B}=m,j=i.c2(h),X=x===i.bL.vertical?M:j==="left"?b:j==="center"?E:j==="right"?P:-1;b>=0&&(s.text.placedSymbolArray.get(b).crossTileID=X>=0&&b!==X?0:B),E>=0&&(s.text.placedSymbolArray.get(E).crossTileID=X>=0&&E!==X?0:B),P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=X>=0&&P!==X?0:B),M>=0&&(s.text.placedSymbolArray.get(M).crossTileID=X>=0&&M!==X?0:B)}markUsedOrientation(s,h,m){const x=h===i.bL.horizontal||h===i.bL.horizontalOnly?h:0,b=h===i.bL.vertical?h:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:B}=m,j=s.text.placedSymbolArray;E>=0&&(j.get(E).placedOrientation=x),P>=0&&(j.get(P).placedOrientation=x),M>=0&&(j.get(M).placedOrientation=x),B>=0&&(j.get(B).placedOrientation=b)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let m=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(s):1,b=h?h.opacities:{},E=h?h.variableOffsets:{},P=h?h.placedOrientations:{};for(const M in this.placements){const B=this.placements[M],j=b[M];j?(this.opacities[M]=new rc(j,x,B.text,B.icon,null,B.clipped),m=m||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[M]=new rc(null,x,B.text,B.icon,B.skipFade,B.clipped),m=m||B.text||B.icon)}for(const M in b){const B=b[M];if(!this.opacities[M]){const j=new rc(B,x,!1,!1);j.isHidden()||(this.opacities[M]=j,m=m||B.text.placed||B.icon.placed)}}for(const M in E)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=E[M]);for(const M in P)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=P[M]);m?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:s)}updateLayerOpacities(s,h,m,x){const b=new Set;for(const E of h){const P=E.getBucket(s);P&&E.latestFeatureIndex&&s.fqid===P.layerIds[0]&&(this.updateBucketOpacities(P,b,E,E.collisionBoxArray,m,x,E.tileID,s.scope),P.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(P,E.tileID),P.elevationType==="road"&&P.updateRoadElevation(E.tileID.canonical),P.updateZOffset())}}updateBucketOpacities(s,h,m,x,b,E,P,M){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const B=s.layers[0].layout,j=s.layers[0].paint,X=!!s.layers[0].dynamicFilter(),W=new rc(null,0,!1,!1,!0),Y=B.get("text-allow-overlap"),ee=B.get("icon-allow-overlap"),te=B.get("text-variable-anchor"),ce=B.get("text-rotation-alignment")==="map",oe=B.get("text-pitch-alignment")==="map",de=j.get("symbol-z-offset"),xe=B.get("symbol-elevation-reference")==="sea",Ee=!de.isConstant(),De=new rc(null,0,Y&&(ee||!s.hasIconData()||B.get("icon-optional")),ee&&(Y||!s.hasTextData()||B.get("text-optional")),!0);!s.collisionArrays&&x&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(x);const Me=(Re,Oe,Le)=>{for(let ct=0;ct<Oe/4;ct++)Re.opacityVertexArray.emplaceBack(Le)};let Fe=0;E&&s.updateReplacement(P,E);for(let Re=0;Re<s.symbolInstances.length;Re++){const Oe=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:ct,crossTileID:Ke,numIconVertices:vt,tileAnchorX:st,tileAnchorY:_t}=Oe;let Ht=null;const lt=this.retainedQueryData[s.bucketInstanceId];Ee&&Oe&&lt&&(Ht=m.latestFeatureIndex.loadFeature({featureIndex:Oe.featureIndex,bucketIndex:lt.bucketIndex,sourceLayerIndex:lt.sourceLayerIndex,layoutVertexArrayOffset:0}));const He=de.evaluate(Ht,{}),Tt=h.has(Ke);let ht=this.opacities[Ke];Tt?ht=W:ht||(ht=De,this.opacities[Ke]=ht),h.add(Ke);const Ft=Le>0||ct>0,Gt=vt>0,tr=this.placedOrientations[Ke],Ut=tr===i.bL.vertical,Bt=tr===i.bL.horizontal||tr===i.bL.horizontalOnly;!Ft&&!Gt||ht.isHidden()||Fe++;let vr=!1;if((Ft||Gt)&&E)for(const mr of s.activeReplacements){if(i.bY(mr,b,i.bZ.Symbol,M)||mr.min.x>st||st>mr.max.x||mr.min.y>_t||_t>mr.max.y)continue;const _r=i.b_(st,_t,P.canonical,mr.footprintTileId.canonical);if(vr=i.b$(_r,mr.footprint),vr)break}if(Ft){const mr=vr?Du:em(ht.text);Me(s.text,Le,Ut?Du:mr),Me(s.text,ct,Bt?Du:mr);const _r=ht.text.isHidden(),{leftJustifiedTextSymbolIndex:pr,centerJustifiedTextSymbolIndex:zr,rightJustifiedTextSymbolIndex:qr,verticalPlacedTextSymbolIndex:Jr}=Oe,Rn=s.text.placedSymbolArray,$r=_r||Ut?1:0;pr>=0&&(Rn.get(pr).hidden=$r),zr>=0&&(Rn.get(zr).hidden=$r),qr>=0&&(Rn.get(qr).hidden=$r),Jr>=0&&(Rn.get(Jr).hidden=_r||Bt?1:0);const vn=this.variableOffsets[Ke];vn&&this.markUsedJustification(s,vn.anchor,Oe,tr);const In=this.placedOrientations[Ke];In&&(this.markUsedJustification(s,"left",Oe,In),this.markUsedOrientation(s,In,Oe))}if(Gt){const mr=vr?Du:em(ht.icon),{placedIconSymbolIndex:_r,verticalPlacedIconSymbolIndex:pr}=Oe,zr=s.icon.placedSymbolArray,qr=ht.icon.isHidden()?1:0;_r>=0&&(Me(s.icon,vt,Ut?Du:mr),zr.get(_r).hidden=qr),pr>=0&&(Me(s.icon,Oe.numVerticalIconVertices,Bt?Du:mr),zr.get(pr).hidden=qr)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const mr=s.collisionArrays[Re];if(mr){let _r=new i.P(0,0),pr=!0;if(mr.textBox||mr.verticalTextBox){if(te){const qr=this.variableOffsets[Ke];qr?(_r=Nh(qr.anchor,qr.width,qr.height,qr.textOffset,qr.textScale),ce&&_r._rotate(oe?this.transform.angle:-this.transform.angle)):pr=!1}X&&(pr=!ht.clipped),mr.textBox&&Ru(s.textCollisionBox.collisionVertexArray,ht.text.placed,!pr||Ut,He,xe,_r.x,_r.y),mr.verticalTextBox&&Ru(s.textCollisionBox.collisionVertexArray,ht.text.placed,!pr||Bt,He,xe,_r.x,_r.y)}const zr=pr&&!!(!Bt&&mr.verticalIconBox);mr.iconBox&&Ru(s.iconCollisionBox.collisionVertexArray,ht.icon.placed,zr,He,xe,Oe.hasIconTextFit?_r.x:0,Oe.hasIconTextFit?_r.y:0),mr.verticalIconBox&&Ru(s.iconCollisionBox.collisionVertexArray,ht.icon.placed,!zr,He,xe,Oe.hasIconTextFit?_r.x:0,Oe.hasIconTextFit?_r.y:0)}}}if(s.fullyClipped=Fe===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,h){const m=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*m>s}setStale(){this.stale=!0}}function Ru(g,s,h,m,x,b,E){g.emplaceBack(s?1:0,h?1:0,b||0,E||0,m,x?1:0),g.emplaceBack(s?1:0,h?1:0,b||0,E||0,m,x?1:0),g.emplaceBack(s?1:0,h?1:0,b||0,E||0,m,x?1:0),g.emplaceBack(s?1:0,h?1:0,b||0,E||0,m,x?1:0)}const Kp=Math.pow(2,25),Co=Math.pow(2,24),pa=Math.pow(2,17),_I=Math.pow(2,16),Jp=Math.pow(2,9),Vv=Math.pow(2,8),Qp=Math.pow(2,1);function em(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const s=g.placed?1:0,h=Math.floor(127*g.opacity);return h*Kp+s*Co+h*pa+s*_I+h*Jp+s*Vv+h*Qp+s}const Du=0;class ag{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,h,m,x,b,E){const P=this._bucketParts;for(;this._currentTileIndex<s.length;)if(h.getBucketParts(P,x,s[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((M,B)=>M.sortKey-B.sortKey));this._currentPartIndex<P.length;){const M=P[this._currentPartIndex];if(h.placeLayerBucketPart(M,this._seenCrossTileIDs,m,M.symbolInstanceStart===0,E),this._currentPartIndex++,b())return!0}return!1}}class jo{constructor(s,h,m,x,b,E,P,M,B){this.placement=new ig(s,b,E,P,M,B),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(s,h,m,x,b){const E=i.o.now(),P=()=>{const M=i.o.now()-E;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=h[s[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=B)&&(!M.maxzoom||M.maxzoom>B)){const j=M,X=j.layout.get("symbol-z-elevate"),W=j.layout.get("symbol-sort-key").constantOr(1)!==void 0,Y=j.layout.get("symbol-z-order"),ee=Y==="viewport-y"||Y==="auto"&&!(Y!=="viewport-y"&&W),te=j.layout.get("text-allow-overlap")||j.layout.get("icon-allow-overlap")||j.layout.get("text-ignore-placement")||j.layout.get("icon-ignore-placement"),ce=ee&&te,oe=this._inProgressLayer=this._inProgressLayer||new ag(j),de=i.B(M.source,M.scope);if(oe.continuePlacement(X||ce?x[de]:m[de],this.placement,this._showCollisionBoxes,M,P,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Cl=512/i.al/2;class ts{constructor(s,h,m){this.tileID=s,this.bucketInstanceId=m,this.index=new i.c3(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=s.canonical.x*i.al,b=s.canonical.y*i.al;for(let E=0;E<h.length;E++){const{key:P,crossTileID:M,tileAnchorX:B,tileAnchorY:j}=h.get(E),X=Math.floor((x+B)*Cl),W=Math.floor((b+j)*Cl);this.index.add(X,W),this.keys.push(P),this.crossTileIDs.push(M)}this.index.finish()}findMatches(s,h,m){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),b=Cl/Math.pow(2,h.canonical.z-this.tileID.canonical.z),E=h.canonical.x*i.al,P=h.canonical.y*i.al;for(let M=0;M<s.length;M++){const B=s.get(M);if(B.crossTileID)continue;const{key:j,tileAnchorX:X,tileAnchorY:W}=B,Y=Math.floor((E+X)*b),ee=Math.floor((P+W)*b),te=this.index.range(Y-x,ee-x,Y+x,ee+x).sort((ce,oe)=>ce-oe);for(const ce of te){const oe=this.crossTileIDs[ce];if(this.keys[ce]===j&&!m.has(oe)){m.add(oe),B.crossTileID=oe;break}}}}}class F2{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const h=Math.round((s-this.lng)/360);if(h!==0)for(const m in this.indexes){const x=this.indexes[m],b={};for(const E in x){const P=x[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+h),b[P.tileID.key]=P}this.indexes[m]=b}this.lng=s}addBucket(s,h,m){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let b=0;b<h.symbolInstances.length;b++)h.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const x=this.usedCrossTileIDs[s.overscaledZ];for(const b in this.indexes){const E=this.indexes[b];if(Number(b)>s.overscaledZ)for(const P in E){const M=E[P];M.tileID.isChildOf(s)&&M.findMatches(h.symbolInstances,s,x)}else{const P=E[s.scaledTo(Number(b)).key];P&&P.findMatches(h.symbolInstances,s,x)}}for(let b=0;b<h.symbolInstances.length;b++){const E=h.symbolInstances.get(b);E.crossTileID||(E.crossTileID=m.generate(),x.add(E.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new ts(s,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(s,h){for(const m of h.crossTileIDs)this.usedCrossTileIDs[s].delete(m)}removeStaleBuckets(s){let h=!1;for(const m in this.indexes){const x=this.indexes[m];for(const b in x)s[x[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,x[b]),delete x[b],h=!0)}return h}}class Fa{constructor(){this.layerIndexes={},this.crossTileIDs=new F2,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,h,m,x){let b=this.layerIndexes[s.fqid];b===void 0&&(b=this.layerIndexes[s.fqid]=new Qf);let E=!1;const P={};x.name!=="globe"&&b.handleWrapJump(m);for(const M of h){const B=M.getBucket(s);B&&s.fqid===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(M.tileID,B,this.crossTileIDs)&&(E=!0),P[B.bucketInstanceId]=!0)}return b.removeStaleBuckets(P)&&(E=!0),E}pruneUnusedLayers(s){const h={};s.forEach(m=>{h[m]=!0});for(const m in this.layerIndexes)h[m]||delete this.layerIndexes[m]}}const rs=771;class Zr{constructor(s,h,m,x){this.blendFunction=s,this.blendColor=h.toNonPremultipliedRenderColor(null),this.mask=m,this.blendEquation=x}}Zr.Replace=[1,0,1,0],Zr.disabled=new Zr(Zr.Replace,i.ao.transparent,[!1,!1,!1,!1]),Zr.unblended=new Zr(Zr.Replace,i.ao.transparent,[!0,!0,!0,!0]),Zr.alphaBlended=new Zr([1,rs,1,rs],i.ao.transparent,[!0,!0,!0,!0]),Zr.alphaBlendedNonPremultiplied=new Zr([770,rs,770,rs],i.ao.transparent,[!0,!0,!0,!0]),Zr.multiply=new Zr([774,0,774,0],i.ao.transparent,[!0,!0,!0,!0]);class or{constructor(s,h,m){this.func=s,this.mask=h,this.range=m}}or.ReadOnly=!1,or.ReadWrite=!0,or.disabled=new or(519,or.ReadOnly,[0,1]);const tm=7680;class Mr{constructor(s,h,m,x,b,E){this.test=s,this.ref=h,this.mask=m,this.fail=x,this.depthFail=b,this.pass=E}}Mr.disabled=new Mr({func:519,mask:0},0,0,tm,tm,tm);const Bh=1029,ed=2305;class Lr{constructor(s,h,m){this.enable=s,this.mode=h,this.frontFace=m}}function Wv(g,s){const h=i.c9(g,3);i.cb(g,s),i.cf(g,3,h)}function rm(g,s){const h=i.c6([]);return i.c7(h,h,-s),i.c8(h,h,-g),h}function nm(g,s){const h=[g[0],g[1],0],m=[s[0],s[1],0];if(i.ag(h)>=1e-15){const E=i.aw([],h);i.c4(m,E,i.bJ(m,E)),s[0]=m[0],s[1]=m[1]}const x=i.bI([],s,g);if(i.c5(x)<1e-15)return null;const b=Math.atan2(-x[1],x[0]);return rm(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),b)}Lr.disabled=new Lr(!1,Bh,ed),Lr.backCCW=new Lr(!0,Bh,ed),Lr.backCW=new Lr(!0,Bh,2304),Lr.frontCW=new Lr(!0,1028,2304),Lr.frontCCW=new Lr(!0,1028,ed);class Gv{constructor(s,h){this.position=s,this.orientation=h}get position(){return this._position}set position(s){if(s){const h=s instanceof i.ae?s:new i.ae(s[0],s[1],s[2]);this._renderWorldCopies&&(h.x=i.bT(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(s,h){if(this.orientation=null,!this.position)return;const m=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.ae.fromLngLat(s)):0,b=i.ae.fromLngLat(s,x),E=[b.x-m.x,b.y-m.y,b.z-m.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=nm(E,h)}setPitchBearing(s,h){this.orientation=rm(i.an(s),i.an(-h))}}class og{constructor(s,h){this._transform=i.bA([]),this.orientation=h,this.position=s}get mercatorPosition(){const s=this.position;return new i.ae(s[0],s[1],s[2])}get position(){const s=i.c9(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var h;s&&i.cf(this._transform,3,[(h=s)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.c6([]),s&&Wv(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,h){this._orientation=rm(s,h),Wv(this._transform,this._orientation)}forward(){const s=i.c9(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.c9(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.c9(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,h){const m=new Float64Array(16);return i.bl(m,this.getWorldToCamera(s,h)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,h,m){const x=this.position;i.c4(x,x,-s);const b=new Float64Array(16);return i.bq(b,[m,m,m]),i.br(b,b,x),b[10]*=h,b}getWorldToCamera(s,h){const m=new Float64Array(16),x=new Float64Array(4),b=this.position;return i.ca(x,this._orientation),i.c4(b,b,-s),i.cb(m,x),i.br(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=h,m[9]*=h,m[10]*=h,m[11]*=h,m}getCameraToClipPerspective(s,h,m,x){const b=new Float64Array(16);return i.cc(b,s,h,m,x),b}getCameraToClipOrthographic(s,h,m,x,b,E){const P=new Float64Array(16);return i.cd(P,s,h,m,x,b,E),P}getDistanceToElevation(s,h=!1){const m=s===0?0:i.ce(s,h?i.a$(this.position[1]):this.position[1]),x=this.forward();return(m-this.position[2])/x[2]}clone(){return new og([...this.position],[...this.orientation])}}const aa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Hv{constructor(s=0,h=0,m=0,x=0){if(isNaN(s)||s<0||isNaN(h)||h<0||isNaN(m)||m<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=h,this.left=m,this.right=x}interpolate(s,h,m){return h.top!=null&&s.top!=null&&(this.top=i.ak(s.top,h.top,m)),h.bottom!=null&&s.bottom!=null&&(this.bottom=i.ak(s.bottom,h.bottom,m)),h.left!=null&&s.left!=null&&(this.left=i.ak(s.left,h.left,m)),h.right!=null&&s.right!=null&&(this.right=i.ak(s.right,h.right,m)),this}getCenter(s,h){const m=i.aA((this.left+s-this.right)/2,0,s),x=i.aA((this.top+h-this.bottom)/2,0,h);return new i.P(m,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Hv(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const $c=15;class Uo{constructor(s,h,m,x,b,E,P){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=m??0,this._maxPitch=x??60,this.setProjection(E),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new i.aR(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Hv,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new og,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new Uo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<$c}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,h=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(s||m)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return i.aH(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=i.cl(this.projectionOptions);const m=this.getProjection(),x=!i.by(h,m);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.cl({name:"mercator"});const h=s!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bT(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const h=-s*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=i.cm(),i.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const h=i.aA(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.an(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const h=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const s=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(s)}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let x=0,b=0;for(let E=0;E<h.length;E++){const P=new i.P(h[E][0]*this.width,m+h[E][1]*(this.height-m)),M=s.pointCoordinate(P);if(!M)continue;const B=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);x+=M[3]*B,b+=B}return b===0?NaN:x/b}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(s),b=this._mercatorZfromZoom(this._maxZoom),E=Math.max(x-m,b);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let m;m=s.z<this._camera.position[2]?[h.x,h.y,h.z]:[s.x,s.y,s.z];const x=i.ag(i.av([],this._camera.position,m));return i.aA(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let h=!1;if(s.orientation&&!i.co(s.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(s.orientation)),s.position){const m=[s.position.x,s.position.y,s.position.z];i.cp(m,this._camera.position)||(this._setCameraPosition(m),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,h=new Gv;return h.position=new i.ae(s[0],s[1],s[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(s){if(!i.cq(s))return!1;i.cr(s,s);const h=i.cs([],[0,0,-1],s),m=i.cs([],[0,-1,0],s);if(m[2]<0)return!1;const x=nm(h,m);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(s){const h=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;s[2]=i.aA(s[2],x/m,x/h),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,h,m){this._unmodified=!1,this._edgeInsets.interpolate(s,h,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const h=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(s){const h=[new i.ct(0,s)];if(this.renderWorldCopies){const m=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),b=this.pointCoordinate(new i.P(this.width,this.height)),E=this.pointCoordinate(new i.P(0,this.height)),P=Math.floor(Math.min(m.x,x.x,b.x,E.x)),M=Math.floor(Math.max(m.x,x.x,b.x,E.x)),B=1;for(let j=P-B;j<=M+B;j++)j!==0&&h.push(new i.ct(j,s))}return h}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,h,m){let x=[];const b=m!=null,E=!b;if(E&&this.zoom<h||b&&m[0]===0&&m[1]===0)return x;const P=new Set,M=(j,X,W,Y,ee)=>{const te=i.cX(X,j,W,Y,ee);P.has(te)||(x.push(new i.aO(j,X,W,Y,ee)),P.add(te))};for(let j=0;j<s.length;j++){const X=s[j];if(E&&X.canonical.z!==h)continue;const W=X.canonical,Y=X.overscaledZ,ee=X.wrap,te=1<<W.z,ce=W.x+1<te,oe=W.x>0,de=W.y+1<te,xe=W.y>0,Ee=X.wrap-(oe?0:1),De=X.wrap+(ce?0:1),Me=oe?W.x-1:te-1,Fe=ce?W.x+1:0;if(b)m[0]<0?(M(Y,De,W.z,Fe,W.y),m[1]<0&&de&&(M(Y,ee,W.z,W.x,W.y+1),M(Y,De,W.z,Fe,W.y+1)),m[1]>0&&xe&&(M(Y,ee,W.z,W.x,W.y-1),M(Y,De,W.z,Fe,W.y-1))):m[0]>0?(M(Y,Ee,W.z,Me,W.y),m[1]<0&&de&&(M(Y,ee,W.z,W.x,W.y+1),M(Y,Ee,W.z,Me,W.y+1)),m[1]>0&&xe&&(M(Y,ee,W.z,W.x,W.y-1),M(Y,Ee,W.z,Me,W.y-1))):m[1]<0&&de?M(Y,ee,W.z,W.x,W.y+1):xe&&M(Y,ee,W.z,W.x,W.y-1);else{const Re=X.visibleQuadrants;1&Re&&(M(Y,Ee,W.z,Me,W.y),xe&&(M(Y,ee,W.z,W.x,W.y-1),M(Y,Ee,W.z,Me,W.y-1))),2&Re&&(M(Y,De,W.z,Fe,W.y),xe&&(M(Y,ee,W.z,W.x,W.y-1),M(Y,De,W.z,Fe,W.y-1))),4&Re&&(M(Y,Ee,W.z,Me,W.y),de&&(M(Y,ee,W.z,W.x,W.y+1),M(Y,Ee,W.z,Me,W.y+1))),8&Re&&(M(Y,De,W.z,Fe,W.y),de&&(M(Y,ee,W.z,W.x,W.y+1),M(Y,De,W.z,Fe,W.y+1)))}}const B=[];for(const j of x)x.some(X=>j.isChildOf(X))||B.push(j);if(x=B.filter(j=>!s.some(X=>!!(j.overscaledZ<h&&X.isChildOf(j))||j.equals(X)||j.isChildOf(X))),E){const j=1<<h,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[j*X.x,j*X.y],Y=4,ee=Y*Y;x=x.filter(te=>{const ce=te.canonical.x+.5-W[0],oe=te.canonical.y+.5-W[1];return ce*ce+oe*oe<ee})}return x}extendTileCoverToNearPlane(s,h,m){const x=[],b=new Set;for(const de of s)b.add(de.key);const E=(de,xe,Ee,De,Me)=>{const Fe=i.cX(xe,de,Ee,De,Me);b.has(Fe)||(x.push(new i.aO(de,xe,Ee,De,Me)),b.add(Fe))},P=s.reduce((de,xe)=>Math.max(de,xe.overscaledZ),m),M=1<<m,B=[new i.P(0,0),new i.P(i.al,0),new i.P(i.al,i.al),new i.P(0,i.al)],j=new i.P(0,0),X=new i.P(0,0),W=(de,xe)=>{const Ee=Math.floor(de[0]),De=Math.floor(de[1]),Me=(de[0]-Ee)*i.al,Fe=(de[1]-De)*i.al,Re=Math.floor(xe[0]),Oe=Math.floor(xe[1]),Le=(xe[0]-Re)*i.al,ct=(xe[1]-Oe)*i.al;for(let Ke=-1;Ke<=1;Ke++){const vt=Ee+Ke;if(!(vt<0||vt>=M)){j.x=Me-Ke*i.al,X.x=Le-(vt-Re)*i.al;for(let st=-1;st<=1;st++){const _t=De+st;j.y=Fe-st*i.al,X.y=ct-(_t-Oe)*i.al,i.cY(j,X,B)&&E(P,0,m,vt,_t)}}}},Y=h.points,ee=Y[i.cu],te=Y[i.cv],ce=this._projectToGround(ee,Y[i.cw]),oe=this._projectToGround(te,Y[i.cx]);return W(ee,ce),W(te,oe),x}_projectToGround(s,h){return i.cy(i.cz(),s,h,s[2]/(s[2]-h[2]))}coveringTiles(s){let h=this.coveringZoomLevel(s);const m=h,x=this.elevation&&this.elevation.exaggeration(),b=x&&!s.isTerrainDEM,E=this.projection.name==="mercator";if(s.minzoom!==void 0&&h<s.minzoom)return[];s.maxzoom!==void 0&&h>s.maxzoom&&(h=s.maxzoom);const P=this.locationCoordinate(this.center),M=this.center.lat,B=1<<h,j=[B*P.x,B*P.y,0],X=this.projection.name==="globe",W=!X,Y=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,W),ee=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),te=B*i.ce(1,this.center.lat),ce=this._camera.position[2]/i.ce(1,this.center.lat),oe=[B*ee.x,B*ee.y,ce*(W?1:te)],de=X||x,xe=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Ee=this.isLODDisabled(!0)?h:0;let De;if(this._elevation&&s.isTerrainDEM)De=1e4*this._elevation.exaggeration();else if(this._elevation){const He=this._elevation.getMinMaxForVisibleTiles();De=He?He.max:this._centerAltitude}else De=this._centerAltitude;const Me=s.isTerrainDEM?-De:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?i.cB(this):1,Re=He=>{const ht=new i.ae(He.x+25e-6,He.y,He.z),Ft=new i.ae(He.x,He.y+25e-6,He.z),Gt=He.toLngLat(),tr=ht.toLngLat(),Ut=Ft.toLngLat(),Bt=this.locationCoordinate(Gt),vr=this.locationCoordinate(tr),mr=this.locationCoordinate(Ut),_r=Math.hypot(vr.x-Bt.x,vr.y-Bt.y),pr=Math.hypot(mr.x-Bt.x,mr.y-Bt.y);return Math.sqrt(_r*pr)*Fe/25e-6},Oe=He=>{const Tt=De,ht=Me;return{aabb:i.cE(this,B,0,0,0,He,ht,Tt,this.projection),zoom:0,x:0,y:0,minZ:ht,maxZ:Tt,wrap:He,fullyVisible:!1}},Le=[];let ct=[];const Ke=h,vt=s.reparseOverscaled?m:h,st=(ce-this._centerAltitude)*te,_t=He=>{if(!this._elevation||!He.tileID||!E)return;const Tt=this._elevation.getMinMaxForTile(He.tileID),ht=He.aabb;Tt?(ht.min[2]=Tt.min,ht.max[2]=Tt.max,ht.center[2]=(ht.min[2]+ht.max[2])/2):(He.shouldSplit=lt(He),He.shouldSplit||(ht.min[2]=ht.max[2]=ht.center[2]=this._centerAltitude))},Ht=(He,Tt)=>{if(.707*Tt<He)return 1;const ht=Tt/He;return ht/(1.4144271570014144+(Math.pow(1.1,ht-1.4144271570014144+1)-1)/(1.1-1)-1)},lt=He=>{if(He.zoom<Ee)return!0;if(He.zoom===Ke)return!1;if(He.shouldSplit!=null)return He.shouldSplit;const Tt=He.aabb.distanceX(oe),ht=He.aabb.distanceY(oe);let Ft=st,Gt=1;if(X){Ft=He.aabb.distanceZ(oe);const pr=Math.pow(2,He.zoom),zr=i.a$((He.y+1)/pr),qr=i.a$(He.y/pr),Jr=Math.min(Math.max(M,zr),qr),Rn=i.d0(Jr)/i.d0(M);if(Gt=Jr===M?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Rn/this._mercatorScaleRatio),this.zoom<=i.cZ&&He.zoom===Ke-1&&Rn>=.9)return!0}else if(b&&(Ft=He.aabb.distanceZ(oe)*te),this.projection.isReprojectedInTileSpace&&m<=5){const pr=Math.pow(2,He.zoom),zr=Re(new i.ae((He.x+.5)/pr,(He.y+.5)/pr));Gt=zr>.85?1:zr}if(!E){const pr=Math.sqrt(Tt*Tt+ht*ht+Ft*Ft);let zr=(1<<Ke-He.zoom)*xe*Gt;return zr*=Ht(Math.max(Ft,st),pr),pr<zr}let tr=Number.MAX_VALUE,Ut=0;const Bt=He.aabb.getCorners(),vr=[];for(const pr of Bt){i.av(vr,pr,oe),X||(b?vr[2]*=te:vr[2]=st);const zr=i.bJ(vr,this._camera.forward());zr<tr&&(tr=zr,Ut=Math.abs(vr[2]))}let mr=(1<<Ke-He.zoom)*xe*Gt;if(mr*=Ht(Math.max(Ut,st),tr),tr<mr)return!0;const _r=He.aabb.closestPoint(j);return _r[0]===j[0]&&_r[1]===j[1]};if(this.renderWorldCopies)for(let He=1;He<=3;He++)Le.push(Oe(-He)),Le.push(Oe(He));for(Le.push(Oe(0));Le.length>0;){const He=Le.pop(),Tt=He.x,ht=He.y;let Ft=He.fullyVisible;const Gt=()=>this.projection.name==="globe"&&(He.y===0||He.y===(1<<He.zoom)-1);if(!Ft){let tr=de?He.aabb.intersects(Y):He.aabb.intersectsFlat(Y);if(tr===0&&Gt()){const Ut=new i.cC(He.zoom,Tt,ht);tr=i.cD(this,B,Ut,!0).intersects(Y)}if(tr===0)continue;Ft=tr===2}if(He.zoom!==Ke&&lt(He))for(let tr=0;tr<4;tr++){const Ut=(Tt<<1)+tr%2,Bt=(ht<<1)+(tr>>1),vr={aabb:E?He.aabb.quadrant(tr):i.cE(this,B,He.zoom+1,Ut,Bt,He.wrap,He.minZ,He.maxZ,this.projection),zoom:He.zoom+1,x:Ut,y:Bt,wrap:He.wrap,fullyVisible:Ft,tileID:void 0,shouldSplit:void 0,minZ:He.minZ,maxZ:He.maxZ};b&&!X&&(vr.tileID=new i.aO(He.zoom+1===Ke?vt:He.zoom+1,He.wrap,He.zoom+1,Ut,Bt),_t(vr)),Le.push(vr)}else{const tr=He.zoom===Ke?vt:He.zoom;if(s.minzoom&&s.minzoom>tr)continue;let Ut=0;if(!Ft){let _r=de?He.aabb.intersectsPrecise(Y):He.aabb.intersectsPreciseFlat(Y);if(_r===0&&Gt()){const pr=new i.cC(He.zoom,Tt,ht);_r=i.cD(this,B,pr,!0).intersectsPrecise(Y)}if(_r===0)continue;if(s.calculateQuadrantVisibility)if(Y.containsPoint(He.aabb.center))Ut=15;else for(let pr=0;pr<4;pr++)He.aabb.quadrant(pr).intersects(Y)!==0&&(Ut|=1<<pr)}const Bt=j[0]-(.5+Tt+(He.wrap<<He.zoom))*(1<<h-He.zoom),vr=j[1]-.5-ht,mr=He.tileID?He.tileID:new i.aO(tr,He.wrap,He.zoom,Tt,ht);s.calculateQuadrantVisibility&&(mr.visibleQuadrants=Ut),ct.push({tileID:mr,distanceSq:Bt*Bt+vr*vr})}}if(this.fogCullDistSq){const He=this.fogCullDistSq,Tt=this.horizonLineFromTop();ct=ct.filter(ht=>{const Ft=[0,0,0,1],Gt=[i.al,i.al,0,1],tr=this.calculateFogTileMatrix(ht.tileID.toUnwrapped());i.aC(Ft,Ft,tr),i.aC(Gt,Gt,tr);const Ut=i.cF([],Ft,Gt),Bt=i.cG([],Ft,Gt),vr=i.c_(Ut,Bt);if(vr===0)return!0;let mr=!1;const _r=this._elevation;if(_r&&vr>He&&Tt!==0){const pr=this.calculateProjMatrix(ht.tileID.toUnwrapped());let zr;s.isTerrainDEM||(zr=_r.getMinMaxForTile(ht.tileID)),zr||(zr={min:Me,max:De});const qr=i.cH(this.rotation),Jr=[qr[0]*i.al,qr[1]*i.al,zr.max];i.af(Jr,Jr,pr),mr=(1-Jr[1])*this.height*.5<Tt}return vr<He||mr})}return ct.sort((He,Tt)=>He.distanceSq-Tt.distanceSq).map(He=>He.tileID)}resize(s,h){this.width=s,this.height=h,this.pixelsToGLUnits=[2/s,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log2(s)}project(s){const h=i.aA(s.lat,-i.cI,i.cI),m=this.projection.project(s.lng,h);return new i.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,h){let m,x;const b=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;m=(h.x-b.x)/P,x=(h.y-b.y)/P}else{const P=this.pointCoordinate(h),M=this.pointCoordinate(b);m=P.x-M.x,x=P.y-M.y}const E=this.locationCoordinate(s);this.setLocation(new i.ae(E.x-m,E.y-x))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,h){return this.projection.locationPoint(this,s,h)}locationPoint3D(s,h){return this.projection.locationPoint(this,s,h,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,h){return this.coordinateLocation(this.pointCoordinate3D(s,h))}locationCoordinate(s,h){const m=h?i.ce(h,s.lat):void 0,x=this.projection.project(s.lng,s.lat);return new i.ae(x.x,x.y,m)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,h){const m=h??this._centerAltitude,x=[s.x,s.y,0,1],b=[s.x,s.y,1,1];i.aC(x,x,this.pixelMatrixInverse),i.aC(b,b,this.pixelMatrixInverse);const E=b[3];i.cJ(x,x,1/x[3]),i.cJ(b,b,1/E);const P=x[2],M=b[2];return{p0:x,p1:b,t:P===M?0:(m-P)/(M-P)}}screenPointToMercatorRay(s){const h=[s.x,s.y,0,1],m=[s.x,s.y,1,1];return i.aC(h,h,this.pixelMatrixInverse),i.aC(m,m,this.pixelMatrixInverse),i.cJ(h,h,1/h[3]),i.cJ(m,m,1/m[3]),h[2]=i.ce(h[2],this._center.lat)*this.worldSize,m[2]=i.ce(m[2],this._center.lat)*this.worldSize,i.cJ(h,h,1/this.worldSize),i.cJ(m,m,1/this.worldSize),new i.ax([h[0],h[1],h[2]],i.aw([],i.av([],m,h)))}rayIntersectionCoordinate(s){const{p0:h,p1:m,t:x}=s,b=i.ce(h[2],this._center.lat),E=i.ce(m[2],this._center.lat);return new i.ae(i.ak(h[0],m[0],x)/this.worldSize,i.ak(h[1],m[1],x)/this.worldSize,i.ak(b,E,x))}pointCoordinate(s,h=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,h)}pointCoordinate3D(s,h){if(!this.elevation)return this.pointCoordinate(s,h);let m=this.projection.pointCoordinate3D(this,s.x,s.y);if(m)return new i.ae(m[0],m[1],m[2]);let x=0,b=this.horizonLineFromTop();if(s.y>b)return this.pointCoordinate(s,h);const E=.02*b,P=s.clone();for(let M=0;M<10&&b-x>E;M++){P.y=i.ak(x,b,.66);const B=this.projection.pointCoordinate3D(this,P.x,P.y);B?(b=P.y,m=B):x=P.y}return m?new i.ae(m[0],m[1],m[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.cK)return!this.isPointAboveHorizon(s);const h=this.pointCoordinate(s);return h.y>=0&&h.y<=1}_coordinatePoint(s,h){const m=h&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,x=[s.x*this.worldSize,s.y*this.worldSize,m+s.toAltitude(),1];return i.aC(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:h}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,b=this.pointLocation3D(new i.P(h,s)),E=this.pointLocation3D(new i.P(x,s)),P=this.pointLocation3D(new i.P(x,m)),M=this.pointLocation3D(new i.P(h,m));let B=Math.min(b.lng,E.lng,P.lng,M.lng),j=Math.max(b.lng,E.lng,P.lng,M.lng),X=Math.min(b.lat,E.lat,P.lat,M.lat),W=Math.max(b.lat,E.lat,P.lat,M.lat);const Y=Math.pow(2,-this.zoom)/16*270,ee=this.projection.name==="globe"?1:4,te=(ce,oe,de,xe,Ee)=>{const De=(ce+de)/2,Me=(oe+xe)/2,Fe=new i.P(De,Me),{lng:Re,lat:Oe}=this.pointLocation3D(Fe),Le=Math.max(0,B-Re,X-Oe,Re-j,Oe-W);B=Math.min(B,Re),j=Math.max(j,Re),X=Math.min(X,Oe),W=Math.max(W,Oe),(Ee<ee||Le>Y)&&(te(ce,oe,De,Me,Ee+1),te(De,Me,de,xe,Ee+1))};if(te(h,s,x,s,1),te(x,s,x,m,1),te(x,m,h,m,1),te(h,m,h,s,1),this.projection.name==="globe"){const[ce,oe]=i.cL(this);ce?(W=90,j=180,B=-180):oe&&(X=-90,j=180,B=-180)}return new i.aI(new i.aR(B,X),new i.aR(j,W))}_getBoundsRectangular(s,h){const{top:m,left:x}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,P=new i.P(x,m),M=new i.P(E,m),B=new i.P(E,b),j=new i.P(x,b);let X=this.pointCoordinate(P,s),W=this.pointCoordinate(M,s);const Y=this.pointCoordinate(B,h),ee=this.pointCoordinate(j,h),te=(ce,oe)=>(oe.y-ce.y)/(oe.x-ce.x);return X.y>1&&W.y>=0?X=new i.ae((1-ee.y)/te(ee,X)+ee.x,1):X.y<0&&W.y<=1&&(X=new i.ae(-ee.y/te(ee,X)+ee.x,0)),W.y>1&&X.y>=0?W=new i.ae((1-Y.y)/te(Y,W)+Y.x,1):W.y<0&&X.y<=1&&(W=new i.ae(-Y.y/te(Y,W)+Y.x,0)),new i.aI().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Y))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=s.visibleDemTiles.reduce((m,x)=>{if(x.dem){const b=x.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*s.exaggeration(),h.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-h*(1-this._horizonShift);return s?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.cI,this.maxLat=i.cI,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.aF(this.minLng)*this.tileSize,this.worldMaxX=i.aF(this.maxLng)*this.tileSize,this.worldMinY=i.aJ(this.maxLat)*this.tileSize,this.worldMaxY=i.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,h){return this.projection.createTileMatrix(this,h,s)}calculateDistanceTileData(s){const h=s.key,m=this._distanceTileDataCache;if(m[h])return m[h];const x=s.canonical,b=1/this.height,E=this.cameraWorldSize,P=E/this.zoomScale(x.z),M=(x.x+Math.pow(2,x.z)*s.wrap)*P,B=x.y*P,j=this.point;j.x*=E/this.worldSize,j.y*=E/this.worldSize;const X=this.angle,W=Math.sin(-X),Y=-Math.cos(-X);return m[h]={bearing:[W,Y],center:[(j.x-M)*b,(j.y-B)*b],scale:P/i.al*b},m[h]}calculateFogTileMatrix(s){const h=s.key,m=this._fogTileMatrixCache;if(m[h])return m[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.aB(x,this.worldToFogMatrix,x),m[h]=new Float32Array(x),m[h]}calculateProjMatrix(s,h=!1,m=!1){const x=s.key;let b;if(b=m?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,b[x])return b[x];const E=this.calculatePosMatrix(s,this.worldSize);let P;return P=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,i.aB(E,P,E),b[x]=new Float32Array(E),b[x]}calculatePixelsToTileUnitsMatrix(s){const h=s.tileID.key,m=this._pixelsToTileUnitsCache;if(m[h])return m[h];const x=i.cM(s,this);return m[h]=x,m[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,h=i.bq([],[s,s,s]);return i.aB(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const h=i.ce(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(h),x=this._camera.forward(),b=i.ce(1,this._center.lat);m[2]/=b,x[2]/=b,i.aw(x,x);const E=s.raycast(m,x,s.exaggeration());if(E){const P=i.bH([],m,x,E),M=new i.ae(P[0],P[1],i.ce(P[2],i.a$(P[1]))),B=(M.z+i.ag([M.x-m[0],M.y-m[1],M.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const h=this._elevation,m=i.ce(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),b=h.getAtPointOrZero(new i.ae(...x)),E=this.pixelsPerMeter/this.worldSize*b,P=this._minimumHeightOverTerrain(),M=x[2]-E;if(M<=P)if(M<0||s){const B=this.locationCoordinate(this._center,this._centerAltitude),j=[x[0],x[1],B.z-x[2]],X=i.ag(j);j[2]-=(P-M)/this._pixelsPerMercatorPixel;const W=i.ag(j);if(W===0)return;i.c4(j,j,X/W*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],B.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const W=this.center;return W.lat=i.aA(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(W.lng=i.aA(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const h=this._unmodified,{x:m,y:x}=this.point;let b=0,E=m,P=x;const M=this.width/2,B=this.height/2,j=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-B<j&&(P=j+B),x+B>X&&(P=X-B),X-j<this.height&&(b=Math.max(b,this.height/(X-j)),P=(X+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,Y=this.worldMaxX*this.scale,ee=this.worldSize/2-(W+Y)/2;E=(m+ee+this.worldSize)%this.worldSize-ee,E-M<W&&(E=W+M),E+M>Y&&(E=Y-M),Y-W<this.width&&(b=Math.max(b,this.width/(Y-W)),E=(Y+W)/2)}E===m&&P===x||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(E,P))),b&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,h=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.ce(1,this.center.lat)/i.ce(1,i.d1));const x=i.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?m:1,E=this._camera.getWorldToCamera(this.worldSize,b);let P;const M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(M[8]=2*-s.x/this.width,M[9]=2*s.y/this.height,this.isOrthographic){let Oe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Le=Oe*this.aspect,ct=-Le,Ke=-Oe;Le-=s.x,ct-=s.x,Oe+=s.y,Ke+=s.y,P=this._camera.getCameraToClipOrthographic(ct,Le,Ke,Oe,this._nearZ,this._farZ),((vt,st,_t,Ht)=>{for(let lt=0;lt<16;lt++)vt[lt]=i.ak(st[lt],_t[lt],Ht)})(P,P,M,i.c$(this.pitch>=$c?1:this.pitch/$c))}else P=M;const B=i.cO([],M,E);let j=i.cO([],P,E);if(this.projection.isReprojectedInTileSpace){const Oe=this.locationCoordinate(this.center),Le=i.bA([]);i.br(Le,Le,[Oe.x*this.worldSize,Oe.y*this.worldSize,0]),i.aB(Le,Le,i.cP(this)),i.br(Le,Le,[-Oe.x*this.worldSize,-Oe.y*this.worldSize,0]),i.aB(j,j,Le),i.aB(B,B,Le),this.inverseAdjustmentMatrix=i.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cR([],j,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=j,this.invProjMatrix=i.bl(new Float64Array(16),this.projMatrix),h){const Oe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Oe[8]=2*-s.x/this.width,Oe[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.cO([],Oe,E)}else this.expandedFarZProjMatrix=this.projMatrix;const X=i.bl([],P);this.frustumCorners=i.cS.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const W=new Float32Array(16);i.bA(W),i.cR(W,W,[1,-1,1]),i.cT(W,W,this._pitch),i.bB(W,W,this.angle);const Y=i.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bz(Y);const ee=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-s.x/this.width,Y[9]=2*(s.y+ee)/this.height,this.skyboxMatrix=i.aB(W,Y,W);const te=this.point,ce=te.x,oe=te.y,de=this.width%2/2,xe=this.height%2/2,Ee=Math.cos(this.angle),De=Math.sin(this.angle),Me=ce-Math.round(ce)+Ee*de+De*xe,Fe=oe-Math.round(oe)+Ee*xe+De*de,Re=new Float64Array(j);if(i.br(Re,Re,[Me>.5?Me-1:Me,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Re,j=i.bC(),i.cR(j,j,[this.width/2,-this.height/2,1]),i.br(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=i.bC(),i.cR(j,j,[1,-1,1]),i.br(j,j,[-1,-1,0]),i.cR(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=i.aB(new Float64Array(16),this.labelPlaneMatrix,B),this._calcFogMatrices(),this._distanceTileDataCache={},j=i.bl(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cU(this);const Oe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.af(Oe,Oe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,m=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,b=[s,s,h];i.c4(b,b,x),i.c4(m,m,-1),i.cV(m,m,b);const E=i.bC();i.br(E,E,m),i.cR(E,E,b),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,h,x)}_computeCameraPosition(s){const h=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),x=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-s/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-m[0]*b,x.y/this.worldSize-m[1]*b,s/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],x=s[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(b=Math.min((h-m)/x,1)),this._camera.position=i.bH([],this._camera.position,s,b),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,h=this._camera.forward(),{pitch:m,bearing:x}=this._camera.getPitchBearing(),b=i.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.an(this._maxPitch)),P=Math.max((s[2]-b)/Math.cos(m),E),M=this._zoomFromMercatorZ(P);i.bH(s,s,h,P),this._pitch=i.aA(m,i.an(this.minPitch),i.an(this.maxPitch)),this.angle=i.bT(x,-Math.PI,Math.PI),this._setZoom(i.aA(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ae(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,s)*this.tileSize))}zoomFromMercatorZAdjusted(s){let h=0,m=i.cK,x=0,b=1/0;for(;m-h>1e-6&&m>h;){const E=h+.5*(m-h),P=this.tileSize*Math.pow(2,E),M=this.getCameraToCenterDistance(this.projection,E,P),B=this.scaleZoom(M/(Math.max(0,s)*this.tileSize)),j=Math.abs(E-B);j<b&&(b=j,x=E),E<B?h=E:m=E}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,h){const m=Math.min(s.x,h.x),x=Math.max(s.x,h.x),b=Math.min(s.y,h.y),E=Math.max(s.y,h.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new i.P(m,b),new i.P(x,E),new i.P(m,E),new i.P(x,b)],M=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const j of P){const X=this.pointRayIntersection(j);if(X.t<0)return!0;const W=this.rayIntersectionCoordinate(X);if(W.x<M||W.y<0||W.x>B||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,h){const m=i.ag(i.av([],this._camera.position,s)),x=this._zoomFromMercatorZ(m)+h;return m-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([h,m,x],b){const E=[h,m,x,1];i.aC(E,E,b);const P=E[3]=Math.max(E[3],1e-6);return E[0]/=P,E[1]/=P,E[2]/=P,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,h=this.zoom,m=this.worldSize){const x=i.cN(s,h,this.width,this.height,1024),b=s.pixelSpaceConversion(this.center.lat,m,x);let E=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(E=i.ak(1,E,i.c$(this.pitch>=$c?1:this.pitch/$c))),E}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.aB(s,s,this.globeMatrix),s}getFrustum(s){return i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Fu=(g,s)=>{if(s>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=g.transform,m=Math.max(Math.abs(h._zoom-(g.minCutoffZoom-1)),1),x=h.isLODDisabled(!1)?i.ah(60,45,h.pitch):i.ah(30,15,h.pitch),b=h._farZ-h._nearZ,E=s*h.height,P=((1-(M=x))*h.cameraToCenterDistance+M*(h._farZ+E))*m;var M;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(P-h._nearZ)/b,(P-E-h._nearZ)/b]}}},io={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class L2{constructor(s,h){this.aabb=s,this.lastCascade=h}}class im{add(s,h){const m=this.receivers[s.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],h.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],h.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],h.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],h.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],h.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],h.max[2])):this.receivers[s.key]=new L2(h,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,h,m){const x=i.d8.fromPoints(s.points);let b=0;for(const E in this.receivers){const P=this.receivers[E];if(!P||!x.intersectsAabb(P.aabb))continue;P.aabb.min=x.closestPoint(P.aabb.min),P.aabb.max=x.closestPoint(P.aabb.max);const M=P.aabb.getCorners();for(let B=0;B<m.length;B++){let j=!0;for(const X of M){const W=[X[0]*h,X[1]*h,X[2]];if(i.af(W,W,m[B].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){j=!1;break}}if(P.lastCascade=B,b=Math.max(b,B),j)break}}return b+1}}class yI{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new im,this._depthMode=new or(s.context.gl.LEQUAL,or.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(io,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(io,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(io,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,h){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const x=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||x<=0||(this._shadowLayerCount=m.style.order.reduce((ee,te)=>{const ce=m.style._mergedLayers[te];return ee+(ce.hasShadowPass()&&!ce.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const b=m.context,E=io.shadowMapResolution,P=io.shadowMapResolution;if(this._cascades.length===0||io.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ee=0;ee<io.cascadeCount;++ee){const te=m._shadowMapDebug,ce=b.gl,oe=b.createFramebuffer(E,P,te,"texture"),de=new i.T(b,{width:E,height:P,data:null},ce.DEPTH_COMPONENT16);if(oe.depthAttachment.set(de.texture),te){const xe=new i.T(b,{width:E,height:P,data:null},ce.RGBA8);oe.colorAttachment.set(xe.texture)}this._cascades.push({framebuffer:oe,texture:de,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cA,scale:0})}}this.shadowDirection=td(h);let M=0;if(s.elevation){const ee=s.elevation,te=[1e4,-1e4];ee.visibleDemTiles.filter(ce=>ce.dem).forEach(ce=>{const oe=ce.dem.tree;te[0]=Math.min(te[0],oe.minimums[0]),te[1]=Math.max(te[1],oe.maximums[0])}),te[0]!==1e4&&(M=(te[1]-te[0])*ee.exaggeration())}const B=1.5*s.cameraToCenterDistance,j=3*B,X=new Float64Array(16);for(let ee=0;ee<this._cascades.length;++ee){const te=this._cascades[ee];let ce=s.height/50,oe=1;io.cascadeCount===1?oe=j:ee===0?oe=B:(ce=B,oe=j);const[de,xe]=vI(s,this.shadowDirection,ce,oe,io.shadowMapResolution,M);te.scale=s.scale,te.matrix=de,te.boundingSphereRadius=xe,i.bl(X,te.matrix),te.frustum=i.cA.fromInvProjectionMatrix(X,1,0,!0),te.far=oe}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/io.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=io.shadowMapResolution,this._uniformValues.u_shadowmap_0=aa.ShadowMap0,this._uniformValues.u_shadowmap_1=aa.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Y=m.transform.elevation;for(const ee of this._groundShadowTiles){let te={min:0,max:0};if(Y){const ce=Y.getMinMaxForTile(ee);ce&&(te=ce)}this.addShadowReceiver(ee.toUnwrapped(),te.min,te.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,h){if(!this.enabled)return;const m=this.painter,x=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),x.viewport.set([0,0,io.shadowMapResolution,io.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){m.currentShadowCascade=b,x.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),x.clear({color:i.ao.white,depth:1});for(const E of s.order){const P=s._mergedLayers[E];if(!P.hasShadowPass()||P.isHidden(m.transform.zoom))continue;const M=s.getLayerSourceCache(P),B=M?h[M.id]:void 0;(P.type==="model"||B&&B.length)&&m.renderLayer(m,M,P,B)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,h=s.style,m=s.context,x=m.gl,b=h.directionalLight,E=h.ambientLight;if(!b||!E)return;const P=[],M=Fu(s,s.longestCutoffRange);M.shouldRenderCutoff&&P.push("RENDER_CUTOFF"),P.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&P.push("NORMAL_OFFSET");const B=Pl(h,b,E),j=new or(x.LEQUAL,or.ReadOnly,s.depthRangeFor3D),X=new Mr({func:x.EQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.KEEP);for(const W of this._groundShadowTiles){const Y=W.toUnwrapped(),ee=s.isTileAffectedByFog(W),te=s.getOrCreateProgram("groundShadow",{defines:P,overrideFog:ee});this.setupShadows(Y,te),s.uploadCommonUniforms(m,te,Y,null,M);const ce={u_matrix:s.transform.calculateProjMatrix(Y),u_ground_shadow_factor:B};te.draw(s,x.TRIANGLES,j,X,Zr.multiply,Lr.disabled,ce,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Zr.unblended:Zr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const h=this.painter.transform,m=h.calculatePosMatrix(s,h.worldSize);return i.aB(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(s){return i.aB(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,h,m){if(!this.enabled)return;const x=this.painter.transform,b=this.painter.context,E=b.gl,P=this._uniformValues,M=new Float64Array(16),B=x.calculatePosMatrix(s,x.worldSize);for(let j=0;j<this._cascades.length;j++)i.aB(M,this._cascades[j].matrix,B),P[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),b.activeTexture.set(E.TEXTURE0+aa.ShadowMap0+j),this._cascades[j].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=!!m,this.useNormalOffset){const j=i.d6(s.canonical),X=2/x.tileSize*i.al/io.shadowMapResolution,W=X*this._cascades[0].boundingSphereRadius,Y=X*this._cascades[this._cascades.length-1].boundingSphereRadius,ee=(m==="vector-tile"?1:3)*function(te,ce,oe,de,xe){const Ee=i.aA((te-22)/-22,0,1);return .125*(1-Ee)+4*Ee}(x.zoom);P.u_shadow_normal_offset=[j,W*ee,Y*ee],P.u_shadow_bias=[1e-4,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(b,P)}setupShadowsFromMatrix(s,h,m=!1){if(!this.enabled)return;const x=this.painter.context,b=x.gl,E=this._uniformValues,P=new Float64Array(16);for(let M=0;M<io.cascadeCount;M++)i.aB(P,this._cascades[M].matrix,s),E[M===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(P),x.activeTexture.set(b.TEXTURE0+aa.ShadowMap0+M),this._cascades[M].texture.bindExtraParam(b.LINEAR,b.LINEAR,b.CLAMP_TO_EDGE,b.CLAMP_TO_EDGE,b.GREATER);if(this.useNormalOffset=m,m){const M=io.normalOffset;E.u_shadow_normal_offset=[1,M,M],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(x,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,h,m,x){if(x[2]>=0)return{};const b=function(M,B,j){const X=j/(1<<M.canonical.z);return new i.d8([M.canonical.x*X+M.wrap*j,M.canonical.y*X+M.wrap*j,0],[(M.canonical.x+1)*X+M.wrap*j,(M.canonical.y+1)*X+M.wrap*j,B])}(s,h,m).getCorners(),E=h/-x[2];x[0]<0?(i.d7(b[0],b[0],[x[0]*E,0,0]),i.d7(b[3],b[3],[x[0]*E,0,0])):x[0]>0&&(i.d7(b[1],b[1],[x[0]*E,0,0]),i.d7(b[2],b[2],[x[0]*E,0,0])),x[1]<0?(i.d7(b[0],b[0],[0,x[1]*E,0]),i.d7(b[1],b[1],[0,x[1]*E,0])):x[1]>0&&(i.d7(b[2],b[2],[0,x[1]*E,0]),i.d7(b[3],b[3],[0,x[1]*E,0]));const P={};return P.vertices=b,P.planes=[sg(b[1],b[0],b[4]),sg(b[2],b[1],b[5]),sg(b[3],b[2],b[6]),sg(b[0],b[3],b[7])],P}addShadowReceiver(s,h,m){this._receivers.add(s,i.d8.fromTileIdAndHeight(s,h,m))}getMaxCascadeForTile(s){const h=this._receivers.get(s);return h&&h.lastCascade?h.lastCascade:0}}function sg(g,s,h){const m=i.av([],h,s),x=i.av([],g,s),b=i.bI([],m,x),E=i.ag(b);return E===0?[0,0,1,0]:(i.c4(b,b,1/E),[b[0],b[1],b[2],-i.bJ(b,s)])}function td(g){const s=g.properties.get("direction"),h=i.d3(s.x,s.y,s.z);h[2]=i.aA(h[2],0,75);const m=i.d5([h[0],h[1],h[2]]);return i.d4(m.x,m.y,m.z)}function Pl(g,s,h){const m=s.properties.get("color-use-theme")==="none",x=s.properties.get("color"),b=s.properties.get("intensity"),E=s.properties.get("direction"),P=[E.x,E.y,E.z],M=h.properties.get("color-use-theme")==="none",B=h.properties.get("color"),j=h.properties.get("intensity"),X=Math.max(i.bJ([0,0,1],P),0),W=[0,0,0];i.c4(W,B.toPremultipliedRenderColor(M?null:g.getLut(s.scope)).toArray01Linear().slice(0,3),j);const Y=[0,0,0];return i.c4(Y,x.toPremultipliedRenderColor(m?null:g.getLut(h.scope)).toArray01Linear().slice(0,3),X*b),i.da([W[0]>0?W[0]/(W[0]+Y[0]):0,W[1]>0?W[1]/(W[1]+Y[1]):0,W[2]>0?W[2]/(W[2]+Y[2]):0])}function vI(g,s,h,m,x,b){const E=g.zoom,P=g.scale,M=g.worldSize,B=1/M,j=g.aspect,X=Math.sqrt(1+j*j)*Math.tan(.5*g.fovX),W=X*X,Y=m-h,ee=m+h;let te,ce;W>Y/ee?(te=m,ce=m*X):(te=.5*ee*(1+W),ce=.5*Math.sqrt(Y*Y+2*(m*m+h*h)*W+ee*ee*W*W));const oe=g.projection.pixelsPerMeter(g.center.lat,M),de=g._camera.getCameraToWorldMercator(),xe=[0,0,-te*B];i.af(xe,xe,de);let Ee=ce*B;const De=g._edgeInsets;if(!(De.left===0&&De.top===0&&De.right===0&&De.bottom===0||De.left===De.right&&De.top===De.bottom)){const Ft=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?oe:1),Gt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,h,m);Gt[8]=2*-g.centerOffset.x/g.width,Gt[9]=2*g.centerOffset.y/g.height;const tr=new Float64Array(16);i.cO(tr,Gt,Ft);const Ut=new Float64Array(16);i.bl(Ut,tr);const Bt=i.cA.fromInvProjectionMatrix(Ut,M,E,!0);for(const vr of Bt.points){const mr=((Me=vr)[0]/=P,Me[1]/=P,Me[2]=i.ce(Me[2],g._center.lat),Me);Ee=Math.max(Ee,i.c5(i.d9([],xe,mr)))}}var Me;Ee*=x/(x-1);const Fe=Math.acos(s[2]),Re=Math.atan2(-s[0],-s[1]),Oe=new og;Oe.position=xe,Oe.setPitchBearing(Fe,Re);const Le=Oe.getWorldToCamera(M,oe),ct=Ee*M,Ke=Math.min(g._mercatorZfromZoom(17)*M*-2,-2*ct),vt=Oe.getCameraToClipOrthographic(-ct,ct,-ct,ct,Ke,(ct+b*oe)/s[2]),st=new Float64Array(16);i.aB(st,vt,Le);const _t=i.d4(Math.floor(1e6*xe[0])/1e6*M,Math.floor(1e6*xe[1])/1e6*M,0),Ht=.5*x,lt=[0,0,0];i.af(lt,_t,st),i.c4(lt,lt,Ht);const He=[Math.floor(lt[0]),Math.floor(lt[1]),Math.floor(lt[2])],Tt=[0,0,0];i.av(Tt,lt,He),i.c4(Tt,Tt,-1/Ht);const ht=new Float64Array(16);return i.bA(ht),i.br(ht,ht,Tt),i.aB(st,ht,st),[st,ct]}class rd extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(s,h){return i.aV(this.requestManager.transformRequest(h,i.R.Model).url).then(m=>{if(!m)return;const x=i.aW(m),b=new i.aX(s,void 0,void 0,x);return b.computeBoundsAndApplyParent(),b}).catch(m=>{if(m&&m.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${s} from ${h}: ${m.message}`)))})}load(s,h,m={forceReload:!1}){this.models[h]||(this.models[h]={});const x=Object.keys(s),b=[],E=[];for(const P of x){const M=s[P];this.hasURLBeenRequested(M)&&!m.forceReload||(this.modelByURL[M]={modelId:P,scope:h},b.push(this.loadModel(P,M)),E.push(P)),this.models[h][P]||(this.models[h][P]={model:null,numReferences:1})}this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+E.length,Promise.allSettled(b).then(P=>{for(let M=0;M<P.length;M++){const{status:B}=P[M];if(B==="rejected")continue;const{value:j}=P[M];this.models[h][E[M]]||(this.models[h][E[M]]={model:null,numReferences:1}),this.models[h][E[M]].model=j}this.numModelsLoading[h]-=E.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(P=>{this.fire(new i.y(new Error(`Could not load models: ${P.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,h,m={exactIdMatch:!1}){return!!(m.exactIdMatch?this.getModel(s,h):this.getModelByURL(this.modelUris[h][s]))}getModel(s,h){return this.models[h]||(this.models[h]={}),this.models[h][s]?this.models[h][s].model:void 0}getModelByURL(s){if(!s)return null;const h=this.modelByURL[s];return h?this.models[h.scope][h.modelId].model:null}hasModelBeenAdded(s,h){return this.models[h]&&this.models[h][s]!==void 0}getModelURIs(s){return this.modelUris[s]||{}}addModel(s,h,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={});const x=this.requestManager.normalizeModelURL(h);if((this.hasModel(s,m,{exactIdMatch:!0})||this.hasModelBeenAdded(s,m))&&this.modelUris[m][s]===x)this.models[m][s].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:b,modelId:E}=this.modelByURL[x];this.models[b][E].numReferences++}else this.modelUris[m][s]=x,this.load({[s]:this.modelUris[m][s]},m)}addModelURLs(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const m=this.modelUris[h];for(const x in s)m[x]=this.requestManager.normalizeModelURL(s[x])}reloadModels(s){this.load(this.modelUris[s],s,{forceReload:!0})}addModelsFromBucket(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const m={};for(const x of s)this.hasModel(x,h,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[h][x].numReferences++:this.modelUris[h][x]&&!this.hasURLBeenRequested(x)?m[x]=this.modelUris[h][x]:!this.hasURLBeenRequested(x)&&i.db(x,!1)&&(this.modelUris[h][x]=this.requestManager.normalizeModelURL(x),m[x]=this.modelUris[h][x]);this.load(m,h)}hasURLBeenRequested(s){return this.modelByURL[s]!==void 0}removeModel(s,h,m=!1,x=!1){if(this.models[h]&&this.models[h][s]&&(this.models[h][s].numReferences--,this.models[h][s].numReferences===0||x)){const b=this.modelUris[h][s];m||delete this.modelUris[h][s],delete this.modelByURL[b];const E=this.models[h][s].model;if(!E)return;delete this.models[h][s],E.destroy()}}destroy(){for(const s of Object.keys(this.models))for(const h of Object.keys(this.models[s])){const m=this.models[s][h].model;delete this.models[s][h],m&&m.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,h){this.models[h]||(this.models[h]={});for(const m in this.models[h])this.models[h][m].model&&this.models[h][m].model.upload(s.context)}}const N2=new i.a9({data:new i.aa(i.a6.colorTheme.data)});function lg(g){if(!g.metadata||!g.metadata.content_area)return;const s=i.o.devicePixelRatio,{left:h,top:m,width:x,height:b}=g.metadata.content_area,E=h*s,P=m*s;return[E,P,E+x*s,P+b*s]}function cg(g){if(g)return g.map(([s,h])=>[s*i.o.devicePixelRatio,h*i.o.devicePixelRatio])}class Lu{constructor(s,h,m){this.id=s,this.scope=h,this.sourceCache=m,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(s){this.missingRequests.has(s.name)||this.pendingRequests.has(s.name)||this.pendingRequests.add(s.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const s=new Map;if(!this.sourceCache.loaded())return s;const h=this.sourceCache.getVisibleCoordinates();if(h.length===0)return s;const m=this.sourceCache.getSource();if(!(m instanceof Iu))return s;const x=h.map(E=>this.sourceCache.getTile(E)),b=m.getImages(x,Array.from(this.pendingRequests));for(const[E,P]of b)s.set(i.I.from({name:E,iconsetId:this.id}),P),this.pendingRequests.delete(E);for(const E of this.pendingRequests)this.missingRequests.add(E);return this.pendingRequests.clear(),s}}const zh=(g,s)=>Q(g,s&&s.filter(h=>h.identifier!=="source.canvas")),xI=i.aH(mn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),wI=i.aH(mn,["setCenter","setZoom","setBearing","setPitch"]),ug=new Set(["background","sky","slot","custom"]),B2={version:8,layers:[],sources:{}},hg={duration:300,delay:0};class il extends i.E{constructor(s,h={}){super(),this.map=s,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=Object.assign({},hg),this._buildingIndex=new Z0(this),this.crossTileSymbolIndex=new Fa,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new un,this.dispatcher=h.dispatcher?h.dispatcher:new i.D(i.dd(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new Br(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new i.de(s._requestManager,h.localFontFamily?i.df.all:h.localIdeographFontFamily?i.df.ideographs:i.df.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new rd(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:h.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",i.dg());const m=this;this._rtlTextPluginCallback=il.registerForPluginStateChange(x=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(b,E)=>{if(i.dh(b),E&&E.every(P=>P))for(const P in m._sourceCaches){const M=m._sourceCaches[P],B=M.getSource().type;B!=="vector"&&B!=="geojson"||M.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const b=this.getOwnSource(x.sourceId);if(b&&b.vectorLayerIds)for(const E in this._layers){const P=this._layers[E];P.source===b.id&&this._validateLayer(P)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.h(s))return s;const h=i.di(s);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${i.dj(JSON.stringify(s))}`}_diffStyle(s,h,m){this.globalId=this._getGlobalId(s);const x=(b,E)=>{try{E(null,this.setState(b,m))}catch(P){E(P,!1)}};if(typeof s=="string"){const b=this.map._requestManager.normalizeStyleURL(s),E=this.map._requestManager.transformRequest(b,i.R.Style);i.m(E,(P,M)=>{P?this.fire(new i.y(P)):M&&x(M,h)})}else typeof s=="object"&&x(s,h)}loadURL(s,h={}){this.fire(new i.z("dataloading",{dataType:"style"}));const m=typeof h.validate=="boolean"?h.validate:!i.h(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,h.accessToken),this.resolvedImports.add(s);const x=this.importsCache.get(s);if(x)return this._load(x,m);const b=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.m(b,(E,P)=>{if(this._request=null,E)this.fire(new i.y(E));else if(P)return this.importsCache.set(s,P),this._load(P,m)})}loadJSON(s,h={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.o.frame(()=>{this._request=null,this._load(s,h.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(B2,!1)}_loadImports(s,h,m){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const b of s){const E=this._createFragmentStyle(b),P=new Promise(j=>{E.once("style.import.load",j),E.once("error",j)}).then(()=>this.mergeAll());if(x.push(P),this.resolvedImports.has(b.url)){E.loadEmpty();continue}const M=b.data||this.importsCache.get(b.url);M?(E.loadJSON(M,{validate:h}),this._isInternalStyle(M)&&(E.globalId=null)):b.url?E.loadURL(b.url,{validate:h}):E.loadEmpty();const B={style:E,id:b.id,config:b.config};if(m){const j=this.fragments.findIndex(({id:X})=>X===m);this.fragments=this.fragments.slice(0,j).concat(B).concat(this.fragments.slice(j))}else this.fragments.push(B)}return Promise.allSettled(x)}getImportGlobalIds(s=this,h=new Set){for(const m of s.fragments)m.style.globalId&&h.add(m.style.globalId),this.getImportGlobalIds(m.style,h);return[...h.values()]}_createFragmentStyle(s){const h=this.scope?i.B(s.id,this.scope):s.id;let m;const x=this._initialConfig&&this._initialConfig[h];(s.config||x)&&(m=Object.assign({},s.config,x));const b=new il(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,h){if(this._isInternalStyle(s)){const b=Object.assign({},B2,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(b,h)}if(this.updateConfig(this._config,s.schema),h&&zh(this,To(s)))return;this._loaded=!0,this.stylesheet=i.dk(s);const m=()=>{for(const M in s.sources)this.addSource(M,s.sources[M],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const M in s.iconsets)this.addIconset(M,s.iconsets[M]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&s.glyphs&&this.glyphManager.setURL(s.glyphs);const b=Y0(this.stylesheet.layers);if(this._order=b.map(M=>M.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const M=this.stylesheet.lights[0];this.light=new le(M.properties,M.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new le(this.stylesheet.light)),this._layers={};for(const M of b){const B=i.dq(M,this.scope,this._styleColorTheme.lut,this.options);B.configDependencies.size!==0&&this._configDependentLayers.add(B.fqid),B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B;const j=this.getOwnLayerSourceCache(B),X=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&B.canCastShadows()&&X&&(j.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const E=this.stylesheet.terrain;E&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const P=this.isRootStyle();s.imports?this._loadImports(s.imports,h).then(()=>{this._reloadImports(),this.fire(new i.z(P?"style.load":"style.import.load"))}).catch(M=>{this.fire(new i.y(new Error("Failed to load imports",M))),this.fire(new i.z(P?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(P?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const b=this._evaluateColorThemeData(x);this._loadColorTheme(b).then(()=>{m()}).catch(E=>{i.w(`Couldn't load color theme from the stylesheet: ${E}`),m()})}else this._styleColorTheme.lut=null,m()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,h,m,x,b,E,P,M,B,j;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(s=W.light),W.stylesheet.lights)for(const Y of W.stylesheet.lights)Y.type==="ambient"&&W.ambientLight!=null&&(h=W.ambientLight),Y.type==="directional"&&W.directionalLight!=null&&(m=W.directionalLight);x=this._prioritizeTerrain(x,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(b=W.fog),W.stylesheet.snow&&W.snow!=null&&(E=W.snow),W.stylesheet.rain&&W.rain!=null&&(P=W.rain),W.stylesheet.camera!=null&&(j=W.stylesheet.camera),W.stylesheet.projection!=null&&(M=W.stylesheet.projection),W.stylesheet.transition!=null&&(B=W.stylesheet.transition),X[W.scope]=W._styleColorTheme}}),this.light=s,this.ambientLight=h,this.directionalLight=m,this.fog=b,this.snow=E,this.rain=P,this._styleColorThemeForScope=X,x===null?delete this.terrain:this.terrain=x,this.camera=j||{"camera-projection":"perspective"},this.projection=M||{name:"mercator"},this.transition=Object.assign({},hg,B),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const h=m=>{for(const x of m.fragments)h(x.style);s(m)};h(this)}_prioritizeTerrain(s,h,m){const x=s&&s.drapeRenderMode===0;return m===null?h&&h.drapeRenderMode===0?h:x?s:null:h!=null&&(!s||x||h&&h.drapeRenderMode===1)?h:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{s=this._prioritizeTerrain(s,h.terrain,h.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(s=h.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},h={},m={};this.forEachFragmentStyle(x=>{for(const b in x._sourceCaches){const E=i.B(b,x.scope);s[E]=x._sourceCaches[b]}for(const b in x._otherSourceCaches){const E=i.B(b,x.scope);h[E]=x._otherSourceCaches[b]}for(const b in x._symbolSourceCaches){const E=i.B(b,x.scope);m[E]=x._symbolSourceCaches[b]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=m}mergeLayers(){const s={},h=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const P of E._order){const M=E._layers[P];if(M.type==="slot"){const B=i.dl(P);if(s[B])continue;s[B]=[]}M.slot&&s[M.slot]?s[M.slot].push(M):h.push(M)}}),this._mergedOrder=[];let x=-1;const b=(E=[])=>{for(const P of E)if(P.type==="slot"){const M=i.dl(P.id);s[M]&&b(s[M]),this._mergedSlots.push(M)}else{const M=i.B(P.id,P.scope);this._mergedOrder.push(M),m[M]=P,P.is3D(!!this.terrain)&&(this._has3DLayers=!0,x=this._mergedOrder.length-1),P.type==="circle"&&(this._hasCircleLayers=!0),P.type==="symbol"&&(this._hasSymbolLayers=!0),P.type==="clip"&&(this._clipLayerPresent=!0)}};if(b(h),this._has3DLayers){const E={};for(let P=0;P<this._mergedOrder.length;++P){const M=this._mergedOrder[P];E[M]=P===x?1:P<x?m[M].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort((P,M)=>E[P]-E[M])}this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(h,m,x,b){const E=Object.assign({},m);for(const M of Object.keys(i.a6.colorTheme))E[M]===void 0&&(E[M]=i.a6.colorTheme[M].default);const P=new i.a8(N2,h,new Map(x));return P.setTransitionOrValue(E,x),P.untransitioned().possiblyEvaluate(new i.ac(0,{worldview:void 0}))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const h=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,x)=>{const b="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let E=s;E.startsWith(b)||(E=b+E);const P=i.I.from("mapbox-reserved-lut"),M=new Image;M.src=E,M.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},M.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==h)return void m();this._styleColorTheme.lutLoading=!1;const{width:B,height:j,data:X}=i.o.getImageData(M);if(j>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(B!==j*j)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(P)&&this.removeImage(P),this.addImage(P,{data:new i.q({width:B,height:j},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(P,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:s},m()):x(new Error("Missing LUT image."))}})}getLut(s){const h=this._styleColorThemeForScope[s];return h?h.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(h,m,x){let b,E,P;const M=i.o.devicePixelRatio>1?"@2x":"";let B=i.m(m.transformRequest(m.normalizeSpriteURL(h,M,".json"),i.R.SpriteJSON),(W,Y)=>{B=null,P||(P=W,b=Y,X())}),j=i.n(m.transformRequest(m.normalizeSpriteURL(h,M,".png"),i.R.SpriteImage),(W,Y)=>{j=null,P||(P=W,E=Y,X())});function X(){if(P)x(P);else if(b&&E){const W=i.o.getImageData(E),Y={};for(const ee in b){const{width:te,height:ce,x:oe,y:de,sdf:xe,pixelRatio:Ee,stretchX:De,stretchY:Me,content:Fe}=b[ee],Re=new i.q({width:te,height:ce});i.q.copy(W,Re,{x:oe,y:de},{x:0,y:0},{width:te,height:ce},null),Y[ee]={data:Re,pixelRatio:Ee!==void 0?Ee:1,sdf:xe!==void 0&&xe,stretchX:De,stretchY:Me,content:Fe,usvg:!1,version:0}}x(null,Y)}}return{cancel(){B&&(B.cancel(),B=null),j&&(j.cancel(),j=null)}}}(s,this.map._requestManager,(h,m)=>{if(this._spriteRequest=null,h)this.fire(new i.y(h));else if(m){const x=new Map;for(const b in m)x.set(i.I.from(b),m[b]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}addIconset(s,h){if(h.type==="sprite")return void this._loadSprite(h.url);const m=this.getOwnSourceCache(h.source);if(!m)return void this.fire(new i.y(new Error(`Source "${h.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));const x=m.getSource();if(x.type!=="raster-array")return void this.fire(new i.y(new Error(`Source "${h.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const b=new Lu(s,this.scope,m);this.imageManager.addImageProvider(b,this.scope)}removeIconset(s){this.imageManager.removeImageProvider(s,this.scope)}_loadIconset(s){if(!i.h(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const h=this.map._spriteFormat==="auto";var m,x;this._spriteRequest=(x=(b,E)=>{if(this._spriteRequest=null,b)h?this._loadSprite(s):this.fire(new i.y(b));else if(E){const P=new Map;for(const M in E)P.set(i.I.from(M),E[M]);this.addImages(P)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bu((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(s),i.R.Iconset),(b,E)=>{if(b)return void x(b);const P={},M=i.dc(new i.bt(E));for(const B of M.icons){const j={version:1,pixelRatio:i.o.devicePixelRatio,content:lg(B),stretchX:B.metadata?cg(B.metadata.stretch_x_areas):void 0,stretchY:B.metadata?cg(B.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:B};P[B.name]=j}x(null,P)}))}_validateLayer(s){const h=this.getOwnSource(s.source);if(!h)return;const m=s.sourceLayer;m&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(m)===-1)&&this.fire(new i.y(new Error(`Source layer "${m}" does not exist on source "${h.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,h)=>{const m=this.fragments[h];return m&&m.style&&(s.data=m.style.serialize()),s})}_serializeSources(){const s={};for(const h in this._sourceCaches){const m=this._sourceCaches[h].getSource();s[m.id]||(s[m.id]=m.serialize())}return s}_serializeLayers(s){const h=[];for(const m of s){const x=this._layers[m];x&&x.type!=="custom"&&h.push(x.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const h=this.getOwnLayer(s);if(h)return h;this.fire(new i.y(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const h=this.getOwnSource(s);if(h)return h;this.fire(new i.y(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,h){const m=this.map.painter;if(m)for(let x=s.minzoom||0;x<(s.maxzoom||25.5);x++){const b=s.getProgramIds();if(b)for(const E of b){const P=s.getDefaultProgramParams(E,h.zoom,this._styleColorTheme.lut);P&&(m.style=this,this.fog&&(m._fogVisible=!0,P.overrideFog=!0,m.getOrCreateProgram(E,P)),m._fogVisible=!1,P.overrideFog=!1,m.getOrCreateProgram(E,P),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(P.overrideRtt=!0,m.getOrCreateProgram(E,P)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const h=this.calculateLightsBrightness();s.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h)),s.worldview!==this._worldview&&(this._worldview=s.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const m=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const P=this._changes.getLayerUpdatesByScope();for(const M in P){const{updatedIds:B,removedIds:j}=P[M];(B||j)&&(this._updateWorkerLayers(M,B,j),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const b={};for(const P in this._mergedSourceCaches){const M=this._mergedSourceCaches[P];b[P]=M.used,M.used=!1,M.tileCoverLift=0}for(const P of this._mergedOrder){const M=this._mergedLayers[P];if(M.recalculate(s,this._availableImages),!M.isHidden(s.zoom)){const B=this.getLayerSourceCache(M);B&&(B.used=!0,B.tileCoverLift=Math.max(B.tileCoverLift,M.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(M,s)}):this.precompilePrograms(M,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const E=this.imageManager.getPendingImageProviders();for(const P of E)P.sourceCache.used=!0;for(const P in b){const M=this._mergedSourceCaches[P];b[P]!==M.used&&M.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:M.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),m&&this.fire(new i.z("data",{dataType:"style"}))}updateImageProviders(){const s=this.imageManager.getPendingImageProviders();for(const h of s){const m=h.resolvePendingRequests(),x=this.getFragmentStyle(h.scope);x&&x.addImages(m)}}_updateTilesForChangedImages(){const s={};for(const h in this._mergedSourceCaches){const m=this._mergedSourceCaches[h].getSource().scope;s[m]=s[m]||this._changes.getUpdatedImages(m),s[m].length!==0&&this._mergedSourceCaches[h].reloadTilesForDependencies(["icons","patterns"],s[m])}for(const h in s)this._changes.resetUpdatedImages(h)}_updateWorkerLayers(s,h,m){const x=this.getFragmentStyle(s);x&&this.dispatcher.broadcast("updateLayers",{layers:h?x._serializeLayers(h):[],scope:s,removedIds:m||[],options:x.options})}setState(s,h){if(this._checkLoaded(),zh(this,To(s)))return!1;(s=i.dk(s)).layers=Y0(s.layers);const m=function(E,P){if(!E)return[{command:mn.setStyle,args:[P]}];let M=[];try{if(!i.by(E.version,P.version))return[{command:mn.setStyle,args:[P]}];if(i.by(E.center,P.center)||M.push({command:mn.setCenter,args:[P.center]}),i.by(E.zoom,P.zoom)||M.push({command:mn.setZoom,args:[P.zoom]}),i.by(E.bearing,P.bearing)||M.push({command:mn.setBearing,args:[P.bearing]}),i.by(E.pitch,P.pitch)||M.push({command:mn.setPitch,args:[P.pitch]}),i.by(E.sprite,P.sprite)||M.push({command:mn.setSprite,args:[P.sprite]}),i.by(E.glyphs,P.glyphs)||M.push({command:mn.setGlyphs,args:[P.glyphs]}),i.by(E.imports,P.imports)||function(Y=[],ee=[],te){ee=ee||[];const ce=(Y=Y||[]).map(Kf),oe=ee.map(Kf),de=Y.reduce(Zp,{}),xe=ee.reduce(Zp,{}),Ee=ce.slice();let De,Me,Fe,Re;for(De=0,Me=0;De<ce.length;De++)Fe=ce[De],xe.hasOwnProperty(Fe)?Me++:(te.push({command:mn.removeImport,args:[Fe]}),Ee.splice(Ee.indexOf(Fe,Me),1));for(De=0,Me=0;De<oe.length;De++)Fe=oe[oe.length-1-De],Ee[Ee.length-1-De]!==Fe&&(de.hasOwnProperty(Fe)?(te.push({command:mn.removeImport,args:[Fe]}),Ee.splice(Ee.lastIndexOf(Fe,Ee.length-Me),1)):Me++,Re=Ee[Ee.length-De],te.push({command:mn.addImport,args:[xe[Fe],Re]}),Ee.splice(Ee.length-De,0,Fe));for(const Oe of ee){const Le=de[Oe.id];Le&&(delete Le.data,i.by(Le,Oe)||te.push({command:mn.updateImport,args:[Oe.id,Oe]}))}}(E.imports,P.imports,M),i.by(E.transition,P.transition)||M.push({command:mn.setTransition,args:[P.transition]}),i.by(E.light,P.light)||M.push({command:mn.setLight,args:[P.light]}),i.by(E.fog,P.fog)||M.push({command:mn.setFog,args:[P.fog]}),i.by(E.snow,P.snow)||M.push({command:mn.setSnow,args:[P.snow]}),i.by(E.rain,P.rain)||M.push({command:mn.setRain,args:[P.rain]}),i.by(E.projection,P.projection)||M.push({command:mn.setProjection,args:[P.projection]}),i.by(E.lights,P.lights)||M.push({command:mn.setLights,args:[P.lights]}),i.by(E.camera,P.camera)||M.push({command:mn.setCamera,args:[P.camera]}),i.by(E.iconsets,P.iconsets)||function(Y,ee,te){let ce;for(ce in ee=ee||{},Y=Y||{})Y.hasOwnProperty(ce)&&(ee.hasOwnProperty(ce)||te.push({command:mn.removeIconset,args:[ce]}));for(ce in ee){if(!ee.hasOwnProperty(ce))continue;const oe=ee[ce];Y.hasOwnProperty(ce)?i.by(Y[ce],oe)||(te.push({command:mn.removeIconset,args:[ce]}),te.push({command:mn.addIconset,args:[ce,oe]})):te.push({command:mn.addIconset,args:[ce,oe]})}}(E.iconsets,P.iconsets,M),!i.by(E["color-theme"],P["color-theme"]))return[{command:mn.setStyle,args:[P]}];const B={},j=[];(function(Y,ee,te,ce){let oe;for(oe in ee=ee||{},Y=Y||{})Y.hasOwnProperty(oe)&&(ee.hasOwnProperty(oe)||k2(oe,te,ce));for(oe in ee){if(!ee.hasOwnProperty(oe))continue;const de=ee[oe];Y.hasOwnProperty(oe)?i.by(Y[oe],de)||(Y[oe].type==="geojson"&&de.type==="geojson"&&K0(Y,ee,oe)?te.push({command:mn.setGeoJSONSourceData,args:[oe,de.data]}):O2(oe,ee,te,ce)):Yf(oe,ee,te)}})(E.sources,P.sources,j,B);const X=[];E.layers&&E.layers.forEach(Y=>{Y.source&&B[Y.source]?M.push({command:mn.removeLayer,args:[Y.id]}):X.push(Y)});let W=E.terrain;W&&B[W.source]&&(M.push({command:mn.setTerrain,args:[void 0]}),W=void 0),M=M.concat(j),i.by(W,P.terrain)||M.push({command:mn.setTerrain,args:[P.terrain]}),function(Y,ee,te){ee=ee||[];const ce=(Y=Y||[]).map(Kf),oe=ee.map(Kf),de=Y.reduce(Zp,{}),xe=ee.reduce(Zp,{}),Ee=ce.slice(),De=Object.create(null);let Me,Fe,Re,Oe,Le,ct,Ke;for(Me=0,Fe=0;Me<ce.length;Me++)Re=ce[Me],xe.hasOwnProperty(Re)?Fe++:(te.push({command:mn.removeLayer,args:[Re]}),Ee.splice(Ee.indexOf(Re,Fe),1));for(Me=0,Fe=0;Me<oe.length;Me++)Re=oe[oe.length-1-Me],Ee[Ee.length-1-Me]!==Re&&(de.hasOwnProperty(Re)?(te.push({command:mn.removeLayer,args:[Re]}),Ee.splice(Ee.lastIndexOf(Re,Ee.length-Fe),1)):Fe++,ct=Ee[Ee.length-Me],te.push({command:mn.addLayer,args:[xe[Re],ct]}),Ee.splice(Ee.length-Me,0,Re),De[Re]=!0);for(Me=0;Me<oe.length;Me++)if(Re=oe[Me],Oe=de[Re],Le=xe[Re],!De[Re]&&!i.by(Oe,Le))if(i.by(Oe.source,Le.source)&&i.by(Oe["source-layer"],Le["source-layer"])&&i.by(Oe.type,Le.type)){for(Ke in Mu(Oe.layout,Le.layout,te,Re,null,mn.setLayoutProperty),Mu(Oe.paint,Le.paint,te,Re,null,mn.setPaintProperty),i.by(Oe.slot,Le.slot)||te.push({command:mn.setSlot,args:[Re,Le.slot]}),i.by(Oe.filter,Le.filter)||te.push({command:mn.setFilter,args:[Re,Le.filter]}),i.by(Oe.minzoom,Le.minzoom)&&i.by(Oe.maxzoom,Le.maxzoom)||te.push({command:mn.setLayerZoomRange,args:[Re,Le.minzoom,Le.maxzoom]}),Oe)Oe.hasOwnProperty(Ke)&&Ke!=="layout"&&Ke!=="paint"&&Ke!=="filter"&&Ke!=="metadata"&&Ke!=="minzoom"&&Ke!=="maxzoom"&&Ke!=="slot"&&(Ke.indexOf("paint.")===0?Mu(Oe[Ke],Le[Ke],te,Re,Ke.slice(6),mn.setPaintProperty):i.by(Oe[Ke],Le[Ke])||te.push({command:mn.setLayerProperty,args:[Re,Ke,Le[Ke]]}));for(Ke in Le)Le.hasOwnProperty(Ke)&&!Oe.hasOwnProperty(Ke)&&Ke!=="layout"&&Ke!=="paint"&&Ke!=="filter"&&Ke!=="metadata"&&Ke!=="minzoom"&&Ke!=="maxzoom"&&Ke!=="slot"&&(Ke.indexOf("paint.")===0?Mu(Oe[Ke],Le[Ke],te,Re,Ke.slice(6),mn.setPaintProperty):i.by(Oe[Ke],Le[Ke])||te.push({command:mn.setLayerProperty,args:[Re,Ke,Le[Ke]]}))}else te.push({command:mn.removeLayer,args:[Re]}),ct=Ee[Ee.lastIndexOf(Re)+1],te.push({command:mn.addLayer,args:[Le,ct]})}(X,P.layers,M)}catch(B){console.warn("Unable to compute style diff:",B),M=[{command:mn.setStyle,args:[P]}]}return M}(this.serialize(),s).filter(E=>!(E.command in wI));if(m.length===0)return!1;const x=m.filter(E=>!(E.command in xI));if(x.length>0)throw new Error(`Unimplemented: ${x.map(E=>E.command).join(", ")}.`);const b=[];return m.forEach(E=>{b.push(this[E.command](...E.args))}),h&&Promise.all(b).then(h).catch(h),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(s){if(s.size===0)return this;for(const[h,m]of s.entries()){if(this.getImage(h))return this.fire(new i.y(new Error(`An image with the name "${h.name}" already exists.`)));this.imageManager.addImage(h,this.scope,m),this._changes.updateImage(h,this.scope)}return this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this}addImage(s,h){return this.getImage(s)?this.fire(new i.y(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,h),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this)}updateImage(s,h,m=!1){this.imageManager.updateImage(s,this.scope,h),m&&(this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(s){return this.modelManager.addModelURLs(s,this.scope),this._updateWorkerModels(),this.fire(new i.z("data",{dataType:"style"})),this}addModel(s,h,m={}){return this._checkLoaded(),this._validate(We,`models.${s}`,h,null,m)||(this.modelManager.addModel(s,h,this.scope),this.fire(new i.z("data",{dataType:"style"}))),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope,!1,!0),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,h,m={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(ro,`sources.${s}`,h,null,m))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=Vp(s,h,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const b=E=>{const P=(E?"symbol:":"other:")+x.id,M=i.B(P,this.scope),B=this._sourceCaches[P]=new Ns(M,x,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=B,B.onAdd(this.map)};b(!1),h.type!=="vector"&&h.type!=="geojson"||b(!0),x.onAdd&&x.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const h=this.getOwnSource(s);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===s)return this.fire(new i.y(new Error(`Source "${s}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.y(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find(([b,E])=>E.type==="source"&&E.source===s);if(x)return this.fire(new i.y(new Error(`Source "${s}" cannot be removed while iconset "${x[0]}" is using it.`)))}const m=this.getOwnSourceCaches(s);for(const x of m){const b=i.dl(x.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,h){this._checkLoaded(),this.getOwnSource(s).setData(h),this._changes.setDirty()}getOwnSource(s){const h=this.getOwnSourceCache(s);return h&&h.getSource()}getOwnSources(){const s=[];for(const h in this._otherSourceCaches){const m=this.getOwnSourceCache(h);m&&s.push(m.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const h in s){const m=s[h]._tiles;for(const x in m){const b=m[x];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const b of s){if(this._validate(yn,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(b),E.updateTransitions(h)}else this.ambientLight=new Hr(b,ur||(ur=new i.a9({color:new i.aa(i.a6.properties_light_ambient.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(b),E.updateTransitions(h)}else this.directionalLight=new Hr(b,Ar||(Ar=new i.a9({direction:new i.ap(i.a6.properties_light_directional.direction),color:new i.aa(i.a6.properties_light_directional.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_directional.intensity),"cast-shadows":new i.aa(i.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new i.aa(i.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.aa(i.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=Object.assign(h,{worldview:this.map.getWorldview()}),x=new i.ac(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,h=this.ambientLight;if(!s||!h)return;const m=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),x=s.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),b=s.properties.get("intensity"),E=s.properties.get("direction"),P=1-i.d3(E.x,E.y,E.z)[2]/90,M=m(x)*b*P,B=h.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),j=h.properties.get("intensity"),X=m(B)*j;return Number(((M+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(s==null||s===""&&this.isRootStyle())return this;if(i.dm(s)){const h=i.dn(s),m=this.fragments.find(({id:b})=>b===h);if(!m)return;const x=i.dl(s);return m.style.getFragmentStyle(x)}{const h=this.fragments.find(({id:m})=>m===s);return h?h.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const h={},m=(x,b="")=>`${x}::${b}`;this._featuresetSelectors={};for(const x in s){const b=this._featuresetSelectors[x]=[];for(const E of s[x].selectors){if(E.featureNamespace){const M=this.getOwnLayer(E.layer);if(!M){i.w(`Layer is undefined for selector: ${E.layer}`);continue}const B=m(M.source,M.sourceLayer);if(B in h&&h[B]!==E.featureNamespace){i.w(`"featureNamespace ${E.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}h[B]=E.featureNamespace}let P;if(E.properties)for(const M in E.properties){const B=i.U(E.properties[M]);B.result==="success"&&(P=P||{},P[M]=B.value)}b.push({layerId:E.layer,namespace:E.featureNamespace,properties:P,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const h=this.getFragmentStyle(s);if(!h||!h.stylesheet.featuresets)return[];const m=[];for(const x in h.stylesheet.featuresets)m.push({featuresetId:x,importId:h.scope?h.scope:void 0});return m}getFeaturesetLayers(s,h){const m=this.getFragmentStyle(h),x=m.stylesheet.featuresets;if(!x||!x[s])return this.fire(new i.y(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const b=[];for(const E of x[s].selectors){const P=m.getOwnLayer(E.layer);P&&b.push(P)}return b}getConfigProperty(s,h){const m=this.getFragmentStyle(s);if(!m)return null;const x=i.B(h,m.scope),b=m.options.get(x),E=b?b.value||b.default:null;return E?E.serialize():null}setConfigProperty(s,h,m){const x=this.getFragmentStyle(s);if(!x)return;const b=x.stylesheet.schema;if(!b||!b[h])return;const E=i.U(m);if(E.result!=="success")return void zh(this,E.value);const P=E.value.expression,M=i.B(h,x.scope),B=x.options.get(M);if(!B)return;let j;const{minValue:X,maxValue:W,stepValue:Y,type:ee,values:te}=b[h],ce=i.U(b[h].default);ce.result==="success"&&(j=ce.value.expression),j?(this.options.set(M,Object.assign({},B,{value:P,default:j,minValue:X,maxValue:W,stepValue:Y,type:ee,values:te})),this.updateConfigDependencies(h)):this.fire(new i.y(new Error(`No schema defined for the config option "${h}" in the "${s}" fragment.`)))}getConfig(s){const h=this.getFragmentStyle(s);if(!h)return null;const m=h.stylesheet.schema;if(!m)return null;const x={};for(const b in m){const E=i.B(b,h.scope),P=h.options.get(E),M=P?P.value||P.default:null;x[b]=M?M.serialize():null}return x}setConfig(s,h){const m=this.getFragmentStyle(s);m&&(m.updateConfig(h,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const h=this.getFragmentStyle(s);return h?h.stylesheet.schema:null}setSchema(s,h){const m=this.getFragmentStyle(s);m&&(m.stylesheet.schema=h,m.updateConfig(m._config,h),this.updateConfigDependencies())}updateConfig(s,h){if(this._config=s,s||h)if(h)for(const m in h){let x,b;const E=i.U(h[m].default);if(E.result==="success"&&(x=E.value.expression),s&&s[m]!==void 0){const W=i.U(s[m]);W.result==="success"&&(b=W.value.expression)}const{minValue:P,maxValue:M,stepValue:B,type:j,values:X}=h[m];if(x){const W=i.B(m,this.scope);this.options.set(W,{default:x,value:b,minValue:P,maxValue:M,stepValue:B,type:j,values:X})}else this.fire(new i.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const h of this._configDependentLayers){const m=this.getLayer(h);if(m){if(s&&!m.configDependencies.has(s))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(h=>{const m=h._styleColorTheme.colorThemeOverride?h._styleColorTheme.colorThemeOverride:h._styleColorTheme.colorTheme;if(m){const x=h._evaluateColorThemeData(m);(!h._styleColorTheme.lut&&x!==""||h._styleColorTheme.lut&&x!==h._styleColorTheme.lut.data)&&h.setColorTheme(m)}}),this._changes.setDirty()}addLayer(s,h,m={}){this._checkLoaded();const x=s.id;if(this._layers[x])return void this.fire(new i.y(new Error(`Layer with id "${x}" already exists on this map`)));let b;if(s.type==="custom"){if(zh(this,i.dp(s)))return;b=i.dq(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(x,s.source),s=i.dk(s),s=Object.assign(s,{source:x})),this._validate(Qe,`layers.${x}`,s,{arrayIndex:-1},m))return;b=i.dq(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:x}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let E=this._order.length;if(h){const j=this._order.indexOf(h);if(j===-1)return void this.fire(new i.y(new Error(`Layer with id "${h}" does not exist on this map.`)));b.slot===this._layers[h].slot?E=j:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,x),this._layerOrderChanged=!0,this._layers[x]=b;const P=this.getOwnLayerSourceCache(b),M=!!this.directionalLight&&this.directionalLight.shadowsEnabled();P&&b.canCastShadows()&&M&&(P.castsShadows=!0);const B=this._changes.getRemovedLayer(b);if(B&&b.source&&P&&b.type!=="custom"){this._changes.discardLayerRemoval(b);const j=i.B(b.source,b.scope);B.type!==b.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),P.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(s,h){this._checkLoaded();const m=this._checkLayer(s);if(!m||s===h)return;const x=this._order.indexOf(s);this._order.splice(x,1);let b=this._order.length;if(h){const E=this._order.indexOf(h);if(E===-1)return void this.fire(new i.y(new Error(`Layer with id "${h}" does not exist on this map.`)));m.slot===this._layers[h].slot?b=E:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const h=this._checkLayer(s);if(!h)return;h.setEventedParent(null);const m=this._order.indexOf(s);this._order.splice(m,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const x=this.getOwnLayerSourceCache(h);if(x&&x.castsShadows){let b=!1;for(const E in this._layers)if(this._layers[E].source===h.source&&this._layers[E].canCastShadows()){b=!0;break}x.castsShadows=b}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const h in this._layers)if(this._layers[h].type===s)return!0;return!1}setLayerZoomRange(s,h,m){this._checkLoaded();const x=this._checkLayer(s);x&&(x.minzoom===h&&x.maxzoom===m||(h!=null&&(x.minzoom=h),m!=null&&(x.maxzoom=m),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,h){this._checkLoaded();const m=this._checkLayer(s);m&&m.slot!==h&&(m.slot=h,this._updateLayer(m))}setFilter(s,h,m={}){this._checkLoaded();const x=this._checkLayer(s);if(x&&!i.by(x.filter,h))return h==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(se,`layers.${x.id}.filter`,h,{layerType:x.type},m)||(x.filter=i.dk(h),this._updateLayer(x)))}getFilter(s){const h=this._checkLayer(s);if(h)return i.dk(h.filter)}setLayoutProperty(s,h,m,x={}){this._checkLoaded();const b=this._checkLayer(s);if(b&&!i.by(b.getLayoutProperty(h),m)){if(m!=null&&(!x||x.validate!==!1)&&zh(b,Pe.call(To,{key:`layers.${s}.layout.${h}`,layerType:b.type,objectKey:h,value:m,styleSpec:i.a6,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(h,m),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(s,h){const m=this._checkLayer(s);if(m)return m.getLayoutProperty(h)}setPaintProperty(s,h,m,x={}){this._checkLoaded();const b=this._checkLayer(s);if(!b||i.by(b.getPaintProperty(h),m)||m!=null&&(!x||x.validate!==!1)&&zh(b,he.call(To,{key:`layers.${s}.paint.${h}`,layerType:b.type,objectKey:h,value:m,styleSpec:i.a6})))return;const E=b.setPaintProperty(h,m);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),E&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(s,h){const m=this._checkLayer(s);if(m)return m.getPaintProperty(h)}setFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:M,importId:B}=s.target,j=this.getFragmentStyle(B),X=j.getFeaturesetLayers(M);for(const{source:W,sourceLayer:Y}of X)j.setFeatureState({id:s.id,source:W,sourceLayer:Y},h)}else if("layerId"in s.target){const{layerId:M}=s.target,B=this.getLayer(M);this.setFeatureState({id:s.id,source:B.source,sourceLayer:B.sourceLayer},h)}return}const m=s.source,x=s.sourceLayer,b=this._checkSource(m);if(!b)return;const E=b.type;if(E==="geojson"&&x)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!x)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const P=this.getOwnSourceCaches(m);for(const M of P)M.setFeatureState(x,s.id,h)}removeFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:M,importId:B}=s.target,j=this.getFragmentStyle(B),X=j.getFeaturesetLayers(M);for(const{source:W,sourceLayer:Y}of X)j.removeFeatureState({id:s.id,source:W,sourceLayer:Y},h)}else if("layerId"in s.target){const{layerId:M}=s.target,B=this.getLayer(M);this.removeFeatureState({id:s.id,source:B.source,sourceLayer:B.sourceLayer},h)}return}const m=s.source,x=this._checkSource(m);if(!x)return;const b=x.type,E=b==="vector"?s.sourceLayer:void 0;if(b==="vector"&&!E)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const P=this.getOwnSourceCaches(m);for(const M of P)M.removeFeatureState(E,s.id,h)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let b;if("featuresetId"in s.target){const{featuresetId:E,importId:P}=s.target,M=this.getFragmentStyle(P),B=M.getFeaturesetLayers(E);for(const{source:j,sourceLayer:X}of B){const W=M.getFeatureState({id:s.id,source:j,sourceLayer:X});if(W&&!b)b=W;else if(!i.by(b,W))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:E}=s.target,P=this.getLayer(E);b=this.getFeatureState({id:s.id,source:P.source,sourceLayer:P.sourceLayer})}return b}const h=s.source,m=s.sourceLayer,x=this._checkSource(h);if(x){if(x.type!=="vector"||m)return s.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(m,s.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),h=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.dr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(s){for(const h of Object.values(this._mergedLayers))s(h)&&this._updateLayer(h)}_updateLayer(s){this._changes.updateLayer(s);const h=this.getLayerSourceCache(s),m=i.B(s.source,s.scope),x=this._changes.getUpdatedSourceCaches();s.source&&!x[m]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),h.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const h=P=>this._mergedLayers[P].is3D(!!this.terrain),m=this.order,x={},b=[];for(let P=m.length-1;P>=0;P--){const M=m[P];if(h(M)){x[M]=P;for(const B of s){const j=B[M];if(j)for(const X of j)b.push(X)}}}b.sort((P,M)=>M.intersectionZ-P.intersectionZ);const E=[];for(let P=m.length-1;P>=0;P--){const M=m[P];if(h(M))for(let B=b.length-1;B>=0;B--){const j=b[B].feature;if(j.layer&&x[j.layer.id]<P)break;E.push(j),b.pop()}else for(const B of s){const j=B[M];if(j)for(const X of j)E.push(X.feature)}}return E}queryRasterValue(s,h,m){const x=this.getOwnSource(s);return x?x.type!=="raster-array"?(this.fire(new i.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):x.queryRasterArrayValue(h,m):(this.fire(new i.y(new Error(`Source with id "${s}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(s,h,m){let x;h&&!Array.isArray(h)&&h.filter&&(this._validate(se,"queryRenderedFeatures.filter",h.filter,null,h),x=i.b6(h.filter));const b={},E=j=>{if(ug.has(j.type))return;const X=this.getOwnLayerSourceCache(j),W=b[X.id]=b[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};j.is3D(!!this.terrain)&&(W.has3DLayers=!0),W.layers[j.fqid]=W.layers[j.fqid]||{styleLayer:j,targets:[]},W.layers[j.fqid].targets.push({filter:x})};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const j of h.layers){const X=this._layers[j];if(!X)return this.fire(new i.y(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];E(X)}}else for(const j in this._layers)E(this._layers[j]);const P=this._queryRenderedFeatures(s,b,m),M=this._flattenAndSortRenderedFeatures(P),B=[];for(const j of M)i.ds(j.layer.id)===this.scope&&B.push(j);return B}queryRenderedFeatureset(s,h,m){let x;h&&!Array.isArray(h)&&h.filter&&(this._validate(se,"queryRenderedFeatures.filter",h.filter,null,h),x=i.b6(h.filter));const b="mock",E=[];if(h&&h.target)E.push(Object.assign({},h,{targetId:b,filter:x}));else{const j=this.getFeaturesetDescriptors();for(const X of j)E.push({targetId:b,filter:x,target:X});for(const{style:X}of this.fragments){const W=X.getFeaturesetDescriptors();for(const Y of W)E.push({targetId:b,filter:x,target:Y})}}const P=this.queryRenderedTargets(s,E,m),M=[],B=new Set;for(const j of P)for(const X of j.variants[b])ku(X,j,B)||M.push(new i.dt(j,X));return M}queryRenderedTargets(s,h,m){const x={},b=(P,M,B,j)=>{const X=x[M.id]=x[M.id]||{sourceCache:M,layers:{},has3DLayers:!1};if(X.layers[P.fqid]=X.layers[P.fqid]||{styleLayer:P,targets:[]},P.is3D(!!this.terrain)&&(X.has3DLayers=!0),!j)return B.uniqueFeatureID=!1,void X.layers[P.fqid].targets.push(B);X.layers[P.fqid].targets.push(Object.assign({},B,{namespace:j.namespace,properties:j.properties,uniqueFeatureID:j.uniqueFeatureID}))};for(const P of h)if("featuresetId"in P.target){const{featuresetId:M,importId:B}=P.target,j=this.getFragmentStyle(B);if(!j||!j._featuresetSelectors)continue;const X=j._featuresetSelectors[M];if(!X){this.fire(new i.y(new Error(`The featureset '${M}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of X){const Y=j.getOwnLayer(W.layerId);Y&&!ug.has(Y.type)&&b(Y,j.getOwnLayerSourceCache(Y),P,W)}}else if("layerId"in P.target){const{layerId:M}=P.target,B=this.getLayer(M);if(!B||ug.has(B.type))continue;b(B,this.getLayerSourceCache(B),P)}const E=this._queryRenderedFeatures(s,x,m);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(s,h,m){const x=[],b=!!this.map._showQueryGeometry,E=En.createFromScreenPoints(s,m);for(const P in h){const M=Gp(E,h[P],this._availableImages,m,b);Object.keys(M).length&&x.push(M)}if(this.placement)for(const P in h){if(!h[P].sourceCache._onlySymbols)continue;const M=Rv(E.screenGeometry,h[P],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(M).length&&x.push(M)}return x}querySourceFeatures(s,h){const m=h&&h.filter;m&&this._validate(se,"querySourceFeatures.filter",m,null,h);let x=[];const b=this.getOwnSourceCaches(s);for(const E of b)x=x.concat(tc(E,h));return x}addSourceType(s,h,m){return il.getSourceType(s)?m(new Error(`A source type called "${s}" already exists.`)):(il.setSourceType(s,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:h.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,h,m={}){this._checkLoaded();const x=this.light.getLight();let b=!1;for(const P in s)if(!i.by(s[P],x[P])){b=!0;break}if(!b)return;const E=this._getTransitionParameters();this.light.setLight(s,h,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,h=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),h===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=s;const x=s.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const P="terrain-dem-src";this.addSource(P,m.source),m=i.dk(m),m=Object.assign(m,{source:P})}const b=Object.assign({},m),E={};if(this.terrain&&x){b.source=this.terrain.get().source;const P=this.terrain?this.getFragmentStyle(this.terrain.scope):null;P&&(E.style=P.serialize())}if(this._validate(Pt,"terrain",b,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&h!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,h),this.fire(new i.z("data",{dataType:"style"}))}else{const b=this.terrain,E=b.get();for(const P of Object.keys(i.a6.terrain))!m.hasOwnProperty(P)&&i.a6.terrain[P].default&&(m[P]=i.a6.terrain[P].default);for(const P in s)if(!i.by(s[P],E[P])){b.set(s,this.options),this.stylesheet.terrain=s;const M=this._getTransitionParameters({duration:0});b.updateTransitions(M),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const h=this.fog=new Xt(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_createSnow(s){const h=this.snow=new Kr(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_createRain(s){const h=this.rain=new an(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!i.by(h.get(),s)){h.set(s,this.options),this.stylesheet.fog=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const h=this.snow;if(!i.by(h.get(),s)){h.set(s,this.options),this.stylesheet.snow=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const h=this.rain;if(!i.by(h.get(),s)){h.set(s,this.options),this.stylesheet.rain=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},h=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!h)return this._styleColorTheme.lut=null,void s();const m=this._evaluateColorThemeData(h);this._loadColorTheme(m).then(()=>{this.fire(new i.z("colorthemeset")),s()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,h){const m=this.getFragmentStyle(s);m&&(m._styleColorTheme.colorThemeOverride=h,m._reloadColorTheme())}_getTransitionParameters(s){return{now:i.o.now(),transition:Object.assign(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],h=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?s.push(m):h.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...h)}_createTerrain(s,h){const m=this.terrain=new fe(s,h,this.scope,this.options,this.map.getWorldview());h===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});m.updateTransitions(x)}_force3DLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="symbol"&&this._updateLayer(h)}}_validate(s,h,m,x,b={}){if(b&&b.validate===!1)return!1;const E=Object.assign({},this.serialize());return zh(this,s.call(To,Object.assign({key:h,style:E,value:m,styleSpec:i.a6},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.du.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(s){const h=this.getSourceCaches(s);for(const m of h)m.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}clearLayers(){for(const s in this._mergedLayers){const h=this._mergedLayers[s];h._clear&&h._clear()}}reloadSource(s){const h=this.getSourceCaches(s);for(const m of h)m.resume(),m.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let h;this.directionalLight&&(h=td(this.directionalLight));const m=new Set;for(const x in this._mergedLayers){const b=this._mergedLayers[x];b.hasElevation()&&!m.has(b.source)&&m.add(b.source)}for(const x in this._mergedSourceCaches){const b=this._mergedSourceCaches[x],E=m.has(b._source.id);b.update(s,void 0,void 0,h,E)}}_generateCollisionBoxes(){for(const s in this._sourceCaches){const h=this._sourceCaches[s];h.resume(),h.reload()}}_updatePlacement(s,h,m,x,b,E,P=!1){let M=!1,B=!1;const j={},X={};for(const W of this._mergedOrder){const Y=this._mergedLayers[W];if(Y.type!=="symbol")continue;const ee=i.B(Y.source,Y.scope);let te=j[ee];if(!te){const oe=this.getLayerSourceCache(Y);if(!oe)continue;const de=oe.getRenderableIds(!0).map(xe=>oe.getTileByID(xe));X[ee]=de.slice(),te=j[ee]=de.sort((xe,Ee)=>Ee.tileID.overscaledZ-xe.tileID.overscaledZ||(xe.tileID.isLessThan(Ee.tileID)?-1:1))}const ce=this.crossTileSymbolIndex.addLayer(Y,te,h.center.lng,h.projection);M=M||ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),P=P||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.o.now(),h.zoom))&&(this.pauseablePlacement=new jo(h,this._mergedOrder,P,m,x,b,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.o.now()),B=!0),M&&this.pauseablePlacement.placement.setStale()),B||M){this._buildingIndex.onNewFrame(h.zoom);for(let W=0;W<this._mergedOrder.length;W++){const Y=this._mergedLayers[this._mergedOrder[W]];if(Y.type!=="symbol")continue;const ee=this.isLayerClipped(Y);this.placement.updateLayerOpacities(Y,j[i.B(Y.source,Y.scope)],W,ee?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.o.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,h){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:b})=>b===s.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!h)return m.push(s),this._loadImports([s],!0);const x=m.findIndex(({id:b})=>b===h);return x===-1&&this.fire(new i.y(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,x).concat(s).concat(m.slice(x)),this._loadImports([s],!0,h)}updateImport(s,h){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(s);return x===-1?this:typeof h=="string"?(this.setImportUrl(s,h),this):(h.url&&h.url!==m[x].url&&this.setImportUrl(s,h.url),i.by(h.config,m[x].config)||this.setImportConfig(s,h.config,h.data.schema),i.by(h.data,m[x].data)||this.setImportData(s,h.data),this)}moveImport(s,h){this._checkLoaded();let m=this.stylesheet.imports||[];const x=this.getImportIndex(s);if(x===-1)return this;const b=this.getImportIndex(h);if(b===-1)return this;const E=m[x],P=this.fragments[x];return m=m.filter(({id:M})=>M!==s),this.fragments=this.fragments.filter(({id:M})=>M!==s),this.stylesheet.imports=m.slice(0,b).concat(E).concat(m.slice(b)),this.fragments=this.fragments.slice(0,b).concat(P).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(s,h){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;m[x].url=h;const b=this.fragments[x];return b.style=this._createFragmentStyle(m[x]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(h),this}setImportData(s,h){this._checkLoaded();const m=this.getImportIndex(s),x=this.stylesheet.imports||[];return m===-1?this:h?(this.fragments[m].style.setState(h),this._reloadImports(),this):(delete x[m].data,this.setImportUrl(s,x[m].url))}setImportConfig(s,h,m){this._checkLoaded();const x=this.getImportIndex(s),b=this.stylesheet.imports||[];if(x===-1)return this;h?b[x].config=h:delete b[x].config;const E=this.fragments[x];m&&E.style.stylesheet&&(E.style.stylesheet.schema=m);const P=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=h,E.style.updateConfig(h,P),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const h=this.stylesheet.imports||[],m=this.getImportIndex(s);m!==-1&&(h.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(s){const h=(this.stylesheet.imports||[]).findIndex(m=>m.id===s);return h===-1&&this.fire(new i.y(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),h}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const h in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[h];m&&s.push(m.getSource())}return s}getSource(s,h){const m=this.getSourceCache(s,h);return m&&m.getSource()}getLayerSource(s){const h=this.getLayerSourceCache(s);return h&&h.getSource()}getSourceCache(s,h){const m=i.B(s,h);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(s){const h=i.B(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const h=[];return this._mergedOtherSourceCaches[s]&&h.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&h.push(this._mergedSymbolSourceCaches[s]),h}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const h in s){const m=s[h];m==="reload"?this.reloadSource(h):m==="clear"&&this.clearSource(h)}}updateLayers(s){const h=this._changes.getUpdatedPaintProperties();for(const m of h){const x=this.getLayer(m);x&&x.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s)}getImages(s,h,m){this.imageManager.getImages(h.images,h.scope,m),this._updateTilesForChangedImages();const x=E=>{if(E){const P=h.images.map(M=>i.I.toString(M));E.setDependencies(h.tileID.key,h.type,P)}},b=i.B(h.source,h.scope);x(this._mergedOtherSourceCaches[b]),x(this._mergedSymbolSourceCaches[b]),h.images.some(E=>E.iconsetId)&&this.fire(new i.z("data",{dataType:"style"}))}rasterizeImages(s,h,m){this.imageManager.rasterizeImages(h,m)}getGlyphs(s,h,m){this.glyphManager.getGlyphs(h.stacks,m)}getResource(s,h,m){return i.dv(h,m)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const h=[];return this._otherSourceCaches[s]&&h.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&h.push(this._symbolSourceCaches[s]),h}_isSourceCacheLoaded(s){const h=this.getOwnSourceCaches(s);return h.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${s}'`))),!1):h.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,h){if(!this._clipLayerPresent&&s.type!=="fill-extrusion"&&s.type!=="building")return!1;const m=s.type==="fill-extrusion"&&(s.sourceLayer==="building"||s.sourceLayer==="procedural_buildings"),x=s.type==="building";if(s.is3D(!!this.terrain)){if(m||x||h&&h.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}il.getSourceType=function(g){return qf[g]},il.setSourceType=function(g,s){qf[g]=s},il.registerForPluginStateChange=i.dw;class z2{execute(s){const h=this._makeBuildingsQueryArea(s),m=this._makeFloorsQueryArea(s),x=s.queryRenderedFeatures(h).reduce((B,j)=>{const X=j.properties.id;return j.properties.type!=="building"||B.some(W=>W.properties.id===X)||B.push(j),B},[]),b=s.queryRenderedFeatures(m).reduce((B,j)=>{const X=j.properties.id;return j.properties.type!=="floor"||B.some(W=>W.properties.id===X)||B.push(j),B},[]),E=[s.getCenter().lng,s.getCenter().lat],P=this._findBuildingAtCenter(E,x),M=x.length>0?x[0]:null;return{floors:b.map(B=>({id:B.properties.id,name:B.properties.name,isDefault:B.properties.is_default,zIndex:B.properties.z_index,connectedFloorIds:B.properties.connected_floor_ids,conflictedFloorIds:B.properties.conflicted_floor_ids,buildingIds:B.properties.building_ids})),building:P?{id:P.properties.id,name:P.properties.name}:{id:M.properties.id,name:M.properties.name}}}_makeBuildingsQueryArea(s){const h=s.transform.width,m=s.transform.height,x=Math.min(h,m)*(1/8),b=.5*(h-x),E=.5*(m-x);return[new i.P(b,E),new i.P(b+x,E+x)]}_makeFloorsQueryArea(s){const h=s.transform.width,m=s.transform.height;return[new i.P(0,0),new i.P(h,m)]}_findBuildingAtCenter(s,h){for(const m of h)if(m.geometry.type==="Polygon"&&this._pointInPolygon(s,m.geometry.coordinates[0]))return m;return null}_pointInPolygon(s,h){let m=!1;for(let x=0,b=h.length-1;x<h.length;b=x++){const E=h[x][0],P=h[x][1],M=h[b][1];P>s[1]!=M>s[1]&&s[0]<(h[b][0]-E)*(s[1]-P)/(M-P)+E&&(m=!m)}return m}}class j2{constructor(){this._floors=new Map,this._buildings=new Map}append(s){const h=s.building;let m=!1;if(h){const x=h.id;x&&(this._buildings.set(x,h),m||this._buildings.has(x)||(m=!0))}return s.floors.forEach(x=>{const b=x.id;m||this._floors.has(b)||(m=!0),this._floors.set(b,x)}),m}clear(){this._floors.clear(),this._buildings.clear()}getFloors(s=null){const h=Array.from(this._floors.values());return s?h.filter(m=>{const x=m.buildingIds;return!!x&&x.split(";").includes(s)}):h}}class U2{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage=new j2}setIndoorData(s){const h=this._featuresStorage.append(s);return this._selectedBuildingId=s.building?s.building.id:null,h}setFloorId(s){const h=this._selectedFloorId!==s;return h&&(this._selectedFloorId=s),h}getCurrentBuildingSelection(){if(!this._selectedBuildingId)return{selectedFloorId:null,floors:[]};const s=this._featuresStorage.getFloors(this._selectedBuildingId),h=this.getActiveFloors().find(m=>{const x=m.buildingIds;if(!x)return!1;const b=x.split(";");return!!this._selectedBuildingId&&b.includes(this._selectedBuildingId)});return{selectedFloorId:h?h.id:null,floors:s}}getActiveFloors(s=!1){const h=this._featuresStorage.getFloors(),m=h.find(M=>M.id===this._selectedFloorId),x=h.filter(M=>M.isDefault===!0);let b=[];if(m)return b=this._calculateCurrentActiveFloors(h,m,x,s),b;if(x.length===0){const M=this._featuresStorage.getFloors(this._selectedBuildingId);b=M.length>0?[M[0]]:[]}else b=x;const E=this._getNonConflictingLastActiveFloors(b),P=[...b,...E];return this._lastActiveFloors=P,P}hasBuildingChanged(s){return this._selectedBuildingId!==(s.building?s.building.id:null)}hasActiveBuilding(){return this._selectedBuildingId!==null}isEmpty(){return this._selectedFloorId===null&&this._selectedBuildingId===null&&this._lastActiveFloors.length===0}_calculateCurrentActiveFloors(s,h,m,x){if(!h)return this._getNonConflictingDefaultFloors(this._lastActiveFloors,m);const b=this._getConnectedFloors(h,s);return x?this._buildExplicitSelectionFloors(h,b,m):this._buildImplicitSelectionFloors(b,m)}_getConnectedFloors(s,h){const m=s.connectedFloorIds;if(!m)return[];const x=new Set(m.split(";"));return h.filter(b=>x.has(b.id))}_buildExplicitSelectionFloors(s,h,m){const x=[s,...h],b=this._getNonConflictingLastActiveFloors(x),E=[...x,...b],P=this._deduplicateFloors(E),M=this._getConflictingFloorIdsFrom(P),B=m.filter(X=>!M.has(X.id)),j=[...P,...B];return this._lastActiveFloors=j,j}_buildImplicitSelectionFloors(s,h){const m=this._getConflictingFloorIdsFrom(this._lastActiveFloors),x=h.filter(E=>!m.has(E.id)),b=this._deduplicateFloors([...this._lastActiveFloors,...x]);return this._lastActiveFloors=b,b}_getNonConflictingDefaultFloors(s,h){const m=this._getConflictingFloorIdsFrom(s),x=h.filter(E=>!m.has(E.id)),b=this._deduplicateFloors([...s,...x]);return this._lastActiveFloors=b,b}_deduplicateFloors(s){const h=new Set;return s.filter(m=>{const x=m.id;return!h.has(x)&&(h.add(x),!0)})}_getConflictingFloorIdsFrom(s){const h=new Set;return s.forEach(m=>{const x=m.conflictedFloorIds;x&&x.split(";").forEach(b=>h.add(b))}),h}_getNonConflictingLastActiveFloors(s){if(!this._lastActiveFloors||this._lastActiveFloors.length===0)return[];const h=new Set(s.map(x=>x.id)),m=this._getConflictingFloorIdsFrom(s);return this._lastActiveFloors.filter(x=>{const b=x.id;return!h.has(b)&&!m.has(b)})}_isFloorConflicted(s,h){const m=s.id;return h.some(x=>{const b=x.conflictedFloorIds;return!!b&&b.split(";").includes(m)})}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage.clear()}}class jh extends i.E{constructor(s){super(),i.aY(["_onLoad","_onMove"],this),this._map=s,this._floorSelectionState=new U2,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.off("load",this._onLoad),this._map.off("move",this._onMove),this._map=null,this._floorSelectionState=null}selectFloor(s){this._floorSelectionState.setFloorId(s)&&this._updateIndoorConfig(!0)}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=s.scope,this._indoorDataQuery=new z2))}),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<15)return void this._clearIndoorData();const s=this._indoorDataQuery.execute(this._map);if(!s||s.floors.length===0||this._map.transform.zoom<16)this._clearIndoorData();else if(this._floorSelectionState.hasBuildingChanged(s)){if(!s.building&&this._floorSelectionState.getActiveFloors().length<=0)return void this._clearIndoorData();this._setIndoorData(s),s.building&&this._updateIndoorSelector()}else this._setIndoorData(s)}_setIndoorData(s){this._floorSelectionState.setIndoorData(s)&&this._updateIndoorConfig()}_clearIndoorData(){this._floorSelectionState.isEmpty()||(this._floorSelectionState.reset(),this._updateIndoorSelector(),this._map.setConfigProperty(this._scope,"activeFloors",["literal",[]]))}_updateIndoorSelector(){const s=this._floorSelectionState.getCurrentBuildingSelection(),h=s.floors.map(m=>({id:m.id,name:m.name,shortName:m.zIndex.toString(),levelOrder:m.zIndex}));this.fire(new i.z("indoorupdate",{selectedFloorId:s.selectedFloorId,floors:h}))}_updateIndoorConfig(s=!1){const h=this._floorSelectionState.getActiveFloors(s).map(m=>m.id)||[];this._map.setConfigProperty(this._scope,"activeFloors",["literal",h])}}var am=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,qv=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Xv=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,nd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",id=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Zv=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,fg=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Us=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,dg=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Zt=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Yv=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ad=[];al(am,ad),al(Xv,ad),al(qv,ad);const od={"_prelude_fog.vertex.glsl":Zv,"_prelude_terrain.vertex.glsl":id,"_prelude_shadow.vertex.glsl":Zt,"_prelude_fog.fragment.glsl":fg,"_prelude_shadow.fragment.glsl":Yv,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Us,"_prelude_raster_particle.glsl":dg},om={};hn("",id),hn(fg,Zv),hn(Yv,Zt),hn(Us,""),hn(dg,"");const sm=hn(qv,Xv),nc=am;var pg={background:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:hn(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:hn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:hn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:hn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:hn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:hn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:hn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:hn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:hn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:hn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:hn(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:hn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:hn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:hn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:hn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:hn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:hn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,nd),skyboxGradient:hn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,nd),skyboxCapture:hn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:hn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:hn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:hn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:hn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:hn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:hn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:hn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:hn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function al(g,s){const h=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of h)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=m.split(" ");for(const b of x)s.includes(b)||s.push(b)}}function hn(g,s){const h=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,x={},b=[],E=[];if(g=g.replace(h,(M,B)=>(E.push(B),"")),(s=s.replace(h,(M,B)=>(b.push(B),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let P=[...ad];al(g,P),al(s,P);for(const M of[...b,...E])od[M]||console.error(`Undefined include: ${M}`),om[M]||(om[M]=[],al(od[M],om[M])),P=[...P,...om[M]];return{fragmentSource:g=g.replace(m,(M,B,j,X,W)=>(x[W]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${j} ${X} ${W};
#else
uniform ${j} ${X} u_${W};
#endif
`:B==="initialize"?`
#ifdef HAS_UNIFORM_u_${W}
    ${j} ${X} ${W} = u_${W};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${j} ${X} ${W};
#endif
`:B==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(m,(M,B,j,X,W)=>{const Y=X==="float"?"vec2":X,ee=W.match(/color/)?"color":Y;return B==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${W}
in ${j} ${X} a_${W};
#endif
`:x[W]?B==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${j} ${Y} a_${W};
out ${j} ${X} ${W};
#else
uniform ${j} ${X} u_${W};
#endif
`:B==="initialize"?ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${j} ${X} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${ee}(a_${W}, u_${W}_t);
#else
    ${j} ${X} ${W} = u_${W};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${j} ${X} a_${W};
    out ${j} ${X} ${W};
#endif
`:B==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${W} = a_${W};
#endif
`:void 0:B==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${j} ${Y} a_${W};
#else
uniform ${j} ${X} u_${W};
#endif
`:B==="define-instanced"?ee==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${W}0;
in vec4 a_${W}1;
in vec4 a_${W}2;
in vec4 a_${W}3;
#else
uniform ${j} ${X} u_${W};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${j} ${Y} a_${W};
#else
uniform ${j} ${X} u_${W};
#endif
`:B==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${j} ${X} ${W} = a_${W};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${j} ${X} ${W} = a_${W};
#else
    ${j} ${X} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${j} ${X} ${W} = unpack_mix_${ee}(a_${W}, u_${W}_t);
#else
    ${j} ${X} ${W} = u_${W};
#endif
`}),usedDefines:P,vertexIncludes:b,fragmentIncludes:E}}class sd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,h,m,x,b,E,P,M){this.context=s;let B=this.boundPaintVertexBuffers.length!==x.length;for(let X=0;!B&&X<x.length;X++)this.boundPaintVertexBuffers[X]!==x[X]&&(B=!0);let j=this.boundDynamicVertexBuffers.length!==P.length;for(let X=0;!j&&X<P.length;X++)this.boundDynamicVertexBuffers[X]!==P[X]&&(j=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==m||B||j||this.boundIndexBuffer!==b||this.boundVertexOffset!==E)this.freshBind(h,m,x,b,E,P,M);else{s.bindVertexArrayOES.set(this.vao);for(const X of P)X&&(X.bind(),M&&X.instanceCount&&X.setVertexAttribDivisor(s.gl,h,M));b&&b.dynamicDraw&&b.bind()}}freshBind(s,h,m,x,b,E,P){const M=this.context,B=M.gl;this.vao&&this.destroy(),this.vao=M.gl.createVertexArray(),M.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=x,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=E,h.enableAttributes(B,s),h.bind(),h.setVertexAttribPointers(B,s,b);for(const j of m)j.enableAttributes(B,s),j.bind(),j.setVertexAttribPointers(B,s,b);for(const j of E)j&&(j.enableAttributes(B,s),j.bind(),j.setVertexAttribPointers(B,s,b),P&&j.instanceCount&&j.setVertexAttribDivisor(B,s,P));x&&x.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function bI(g,s){const h=Math.pow(2,s.canonical.z),m=s.canonical.y;return[new i.ae(0,m/h).toLngLat().lat,new i.ae(0,(m+1)/h).toLngLat().lat]}function TI(g,s,h,m,x,b,E){const P=g.context,M=P.gl,B=h.hillshadeFBO;if(!B)return;g.prepareDrawTile();const j=g.isTileAffectedByFog(s),X=g.getOrCreateProgram("hillshade",{overrideFog:j});P.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,B.colorAttachment.get());const W=((ce,oe,de,xe)=>{const Ee=de.paint.get("hillshade-shadow-color"),De=de.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Me=de.paint.get("hillshade-highlight-color"),Fe=de.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Re=de.paint.get("hillshade-accent-color"),Oe=de.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Le=de.paint.get("hillshade-emissive-strength");let ct=i.an(de.paint.get("hillshade-illumination-direction"));if(de.paint.get("hillshade-illumination-anchor")==="viewport")ct-=ce.transform.angle;else if(ce.style&&ce.style.enable3dLights()&&ce.style.directionalLight){const vt=ce.style.directionalLight.properties.get("direction"),st=i.d3(vt.x,vt.y,vt.z);ct=i.an(st[1])}const Ke=!ce.options.moving;return{u_matrix:xe||ce.transform.calculateProjMatrix(oe.tileID.toUnwrapped(),Ke),u_image:0,u_latrange:bI(0,oe.tileID),u_light:[de.paint.get("hillshade-exaggeration"),ct],u_shadow:Ee.toPremultipliedRenderColor(De?null:de.lut),u_highlight:Me.toPremultipliedRenderColor(Fe?null:de.lut),u_emissive_strength:Le,u_accent:Re.toPremultipliedRenderColor(Oe?null:de.lut)}})(g,h,m,g.terrain?s.projMatrix:null);g.uploadCommonUniforms(P,X,s.toUnwrapped());const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:te}=g.getTileBoundsBuffers(h);X.draw(g,M.TRIANGLES,x,b,E,Lr.disabled,W,m.id,Y,ee,te)}function mg(g,s,h){if(!s.needsDEMTextureUpload)return;const m=g.context,x=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||g.getTileTexture(h.stride);const b=h.getPixels();s.demTexture?s.demTexture.update(b,{premultiply:!1}):s.demTexture=new i.T(m,b,x.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function SI(g,s,h){const m=g.context,x=m.gl;if(!s.dem)return;const b=s.dem;if(m.activeTexture.set(x.TEXTURE1),mg(g,s,b),!s.demTexture)return;s.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const E=b.dim;m.activeTexture.set(x.TEXTURE0);let P=s.hillshadeFBO;if(!P){const W=new i.T(m,{width:E,height:E,data:null},x.RGBA8);W.bind(x.LINEAR,x.CLAMP_TO_EDGE),P=s.hillshadeFBO=m.createFramebuffer(E,E,!0,"renderbuffer"),P.colorAttachment.set(W.texture)}m.bindFramebuffer.set(P.framebuffer),m.viewport.set([0,0,E,E]);const{tileBoundsBuffer:M,tileBoundsIndexBuffer:B,tileBoundsSegments:j}=g.getMercatorTileBoundsBuffers(),X=[];g.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(g,x.TRIANGLES,or.disabled,Mr.disabled,Zr.unblended,Lr.disabled,((W,Y)=>{const ee=Y.stride,te=i.bC();return i.cd(te,0,i.al,-i.al,0,0,1),i.br(te,te,[0,-i.al,0]),{u_matrix:te,u_image:1,u_dimension:[ee,ee],u_zoom:W.overscaledZ}})(s.tileID,b),h.id,M,B,j),s.needsHillshadePrepare=!1}class bi{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $2 extends bi{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Kv extends bi{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class EI extends bi{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class AI extends bi{getDefault(){return[!0,!0,!0,!0]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class CI extends bi{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class PI extends bi{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class V2 extends bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const h=this.current;(s.func!==h.func||s.ref!==h.ref||s.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class II extends bi{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class gg extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=s,this.dirty=!1}}class kI extends bi{getDefault(){return[0,1]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class W2 extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=s,this.dirty=!1}}class Jv extends bi{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class _g extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.BLEND):h.disable(h.BLEND),this.current=s,this.dirty=!1}}class Qv extends bi{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Uh extends bi{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class ld extends bi{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class yg extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=s,this.dirty=!1}}class vg extends bi{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class cd extends bi{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let G2=class extends bi{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class ex extends bi{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class H2 extends bi{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ud extends bi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class xg extends bi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class wg extends bi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class tx extends bi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class bg extends bi{getDefault(){return null}set(s){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class lm extends bi{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class q2 extends bi{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class X2 extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Z2 extends bi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Nu extends bi{constructor(s,h){super(s),this.context=s,this.parent=h}getDefault(){return null}}class Y2 extends Nu{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class K2 extends Nu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class OI extends Nu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class MI extends K2{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const rx=(g,s,h)=>({u_matrix:g,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:h}),Tg=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:b,u_image0:0,u_frustum_tl:E,u_frustum_tr:P,u_frustum_br:M,u_frustum_bl:B,u_globe_pos:j,u_globe_radius:X,u_viewport:W,u_grid_matrix:te?Float32Array.from(te):new Float32Array(9),u_skirt_height:Y,u_far_z_cutoff:ee});function Sg(g,s){return g!=null&&s!=null&&!(!g.hasData()||!s.hasData())&&g.demTexture!=null&&s.demTexture!=null&&g.tileID.key!==s.tileID.key}const Bu=new class{constructor(){this.operations={}}newMorphing(g,s,h,m,x){if(g in this.operations){const b=this.operations[g];b.to.tileID.key!==h.tileID.key&&(b.queued=h)}else this.operations[g]={startTime:m,phase:0,duration:x,from:s,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const s=this.operations[g];return{from:s.from,to:s.to,phase:s.phase}}update(g){for(const s in this.operations){const h=this.operations[s];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[s];break}}}_nextOp(g,s){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=s,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},nx={0:null,1:"TERRAIN_VERTEX_MORPHING"};function ix(g,s,h){if(s===0)return 0;const m=s<1&&h===514?.25/s:1;return 6*Math.pow(1.5,22-g)*Math.max(s,1)*m}function RI(g,s){const h=1<<g.z;return!s&&(g.x===0||g.x===h-1)||g.y===0||g.y===h-1}const $h=g=>({u_matrix:g});function Vh(g,s,h,m,x){if(x>0){const b=i.o.now(),E=(b-g.timeAdded)/x,P=s?(b-s.timeAdded)/x:-1,M=h.getSource(),B=m.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),j=!s||Math.abs(s.tileID.overscaledZ-B)>Math.abs(g.tileID.overscaledZ-B),X=j&&g.refreshedUponExpiration?1:i.aA(j?E:1-P,0,1);return s?{opacity:1,mix:1-X,isFading:E<1}:{opacity:X,mix:0,isFading:E<1}}return{opacity:1,mix:0,isFading:!1}}class J2 extends Ns{constructor(s){const h=Vp("mock-dem",{type:"raster-dem",maxzoom:s.transform.maxZoom},s.style.dispatcher,s.style);super("mock-dem",h,!1),h.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,h){s.state="loaded",h(null)}}class $s extends Ns{constructor(s){const h=Vp("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},s.style.dispatcher,s.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,h,m){if(s.freezeTileCoverage)return;this.transform=s;const x=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,E)=>{if(b[E.key]="",!this._tiles[E.key]){const P=new Ou(E,this._source.tileSize*E.overscaleFactor(),s.tileZoom,void 0,void 0,this._source.worldview);P.state="loaded",this._tiles[E.key]=P}return b},{});for(const b in this._tiles)b in x||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(s){const h=this.proxyCachedFBO[s];if(h!==void 0){const m=Object.values(h);this.renderCachePool.push(...m),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Eg extends i.aO{constructor(s,h,m){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=h,this.projMatrix=m}}class cm extends i.dH{constructor(s,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,x,b]=function(M){const B=new i.bd,j=new i.b1,X=131;B.reserve(17161),j.reserve(33800);const W=i.al/128,Y=i.al+W/2,ee=Y+W;for(let ce=-W;ce<ee;ce+=W)for(let oe=-W;oe<ee;oe+=W){const de=oe<0||oe>Y||ce<0||ce>Y?24575:0,xe=i.aA(Math.round(oe),0,i.al),Ee=i.aA(Math.round(ce),0,i.al);B.emplaceBack(xe+de,Ee)}const te=(ce,oe)=>{const de=oe*X+ce;j.emplaceBack(de+1,de,de+X),j.emplaceBack(de+X,de+X+1,de+1)};for(let ce=1;ce<129;ce++)for(let oe=1;oe<129;oe++)te(oe,ce);return[0,129].forEach(ce=>{for(let oe=0;oe<130;oe++)te(oe,ce),te(ce,oe)}),[B,j,32768]}(),E=s.context;this.gridBuffer=E.createVertexBuffer(m,i.bf.members),this.gridIndexBuffer=E.createIndexBuffer(x),this.gridSegments=i.bg.simpleSegment(0,0,m.length,x.length),this.gridNoSkirtSegments=i.bg.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $s(h.map),this.orthoMatrix=i.bC(),i.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.al,0,i.al,0,1);const P=E.gl;this._overlapStencilMode=new Mr({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new J2(h.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,h,m){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const x=s.terrain.properties,b=s.terrain.drapeRenderMode===0,E=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.o.now();const P=s.terrain&&s.terrain.scope,M=x.get("source"),B=b?this._mockSourceCache:s.getSourceCache(M,P);if(!B)return void i.w(`Couldn't find terrain source "${M}".`);if(this.sourceCache=B,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(h):x.get("exaggeration"),!h.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(h,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),h.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const h=this._previousCameraAltitude,m=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=m;const x=h!=null?m-h:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const b=s.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(b);let P=b-this._previousZoom;const M=this._previousUpdateTimestamp;let B=b;this._evaluationZoom!=null&&(B=this._evaluationZoom,Math.abs(b-B)>.5&&(P=.5*(b-B+P)),P*x<0&&(B+=P)),this._evaluationZoom=B;const j=E.getExaggeration(B),X=j===E.getExaggeration(Math.max(0,B-.1));if(X&&Math.abs(j-this._exaggeration)<.01)return j;let W=Math.min(.1,.00375*(this._updateTimestamp-M));return(X||j<.1||Math.abs(P)<1e-4)&&(W=Math.min(.2,4*W)),i.ak(this._exaggeration,j,W)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.dataType==="source"&&s.coord?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(i.ae.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(M=>{const B=h.getTileByID(M).tileID;return B.projMatrix=m.calculateProjMatrix(B.toUnwrapped()),B});(function(M,B){const j=B.transform.pointCoordinate(B.transform.getCameraPoint()),X=new i.P(j.x,j.y);M.sort((W,Y)=>{if(Y.overscaledZ-W.overscaledZ)return Y.overscaledZ-W.overscaledZ;const ee=new i.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),te=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),ce=X.mult(1<<W.canonical.z);return ce.x-=.5,ce.y-=.5,ce.distSqr(ee)-ce.distSqr(te)})})(x,this.painter);const b=this.proxyToSource||{};this.proxyToSource={},x.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const M in E){const B=E[M];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,s[M],b),B.usedForTerrain))continue;const j=s[M];B.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[h.id]=x.map(M=>new Eg(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;const P={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const B=this.terrainTileForTile[M.key];if(!B)continue;const j=B.tileID.key;j in P||(this._visibleDemTiles.push(B),P[j]=j)}}_assignTerrainTiles(s){this._initializing||s.forEach(h=>{if(this.terrainTileForTile[h.key])return;const m=this._findTileCoveringTileID(h,this.sourceCache);m&&(this.terrainTileForTile[h.key]=m)})}_prepareDEMTextures(){const s=this.painter.context,h=s.gl;for(const m in this.terrainTileForTile){const x=this.terrainTileForTile[m],b=x.dem;!b||x.demTexture&&!x.needsDEMTextureUpload||(s.activeTexture.set(h.TEXTURE1),mg(this.painter,x,b))}}_prepareDemTileUniforms(s,h,m,x){if(!h||h.demTexture==null)return!1;const b=s.tileID.canonical,E=Math.pow(2,h.tileID.canonical.z-b.z),P=x||"";return m[`u_dem_tl${P}`]=[b.x*E%1,b.y*E%1],m[`u_dem_scale${P}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const h=this._visibleDemTiles.reduce((m,x)=>{if(!x.dem)return m;const b=x.dem.tree.minimums[0];return b>0&&s++,m+b},0);return s?h/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,h=s.gl;s.activeTexture.set(h.TEXTURE2);const m=this._getLoadedAreaMinimum(),x=new i.dI({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(x,{premultiply:!1}):b=this._emptyDEMTexture=new i.T(s,x,h.R32F,{premultiply:!1}),b}setupElevationDraw(s,h,m){const x=this.painter.context,b=x.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let P=null,M=null,B=1;if(m&&m.morphing&&this._useVertexMorphing){const Y=m.morphing.srcDemTile,ee=m.morphing.dstDemTile;B=m.morphing.phase,Y&&ee&&(this._prepareDemTileUniforms(s,Y,E,"_prev")&&(M=Y),this._prepareDemTileUniforms(s,ee,E)&&(P=ee))}const j=Y=>Y&&Y.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST;let X=null;var W;if(this.enabled?M&&P?(X=P.demTexture,x.activeTexture.set(b.TEXTURE4),M.demTexture.bind(j(M),b.CLAMP_TO_EDGE),E.u_dem_lerp=B):(P=this.terrainTileForTile[s.tileID.key],X=this._prepareDemTileUniforms(s,P,E)?P.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,x.activeTexture.set(b.TEXTURE2),X&&(E.u_dem_size=(W=X).size[0]===1?1:W.size[0]-2,X.bind(j(P),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,h,E),m&&m.useMeterToDem&&P){const Y=(1<<P.tileID.canonical.z)*i.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=Y}if(m&&m.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),h.setTerrainUniformValues(x,E),this.painter.transform.projection.name==="globe"){const Y=this.globeUniformValues(this.painter.transform,s.tileID.canonical,m&&m.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,Y)}}globeUniformValues(s,h,m){const x=s.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,i.al,0),u_tile_br_up:x.upVector(h,i.al,i.al),u_tile_bl_up:x.upVector(h,0,i.al),u_tile_up_scale:m?i.dJ(1):x.upVectorScale(h,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const h=this.painter,m=this.painter.context;s.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,b,E,P,M){if(x.transform.projection.name==="globe")(function(B,j,X,W,Y){const ee=B.context,te=ee.gl;let ce,oe;const de=B.transform,xe=i.dA(B,ee,de),Ee=(vt,st)=>{if(oe===st)return;const _t=[nx[st],"PROJECTION_GLOBE_VIEW"];xe&&_t.push("CUSTOM_ANTIALIASING");const Ht=B.isTileAffectedByFog(vt);ce=B.getOrCreateProgram("globeRaster",{defines:_t,overrideFog:Ht}),oe=st},De=B.colorModeForRenderPass(),Me=new or(te.LEQUAL,or.ReadWrite,B.depthRangeFor3D);Bu.update(Y);const Fe=i.dB(de),Re=[i.aF(de.center.lng),i.aJ(de.center.lat)],Oe=B.globeSharedBuffers,Le=[de.width*i.o.devicePixelRatio,de.height*i.o.devicePixelRatio],ct=Float32Array.from(de.globeMatrix),Ke={useDenormalizedUpVectorScale:!0};{const vt=B.transform,st=ix(vt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);oe=-1;const _t=te.TRIANGLES;for(const Ht of W){const lt=X.getTile(Ht),He=Mr.disabled,Tt=j.prevTerrainTileForTile[Ht.key],ht=j.terrainTileForTile[Ht.key];Sg(Tt,ht)&&Bu.newMorphing(Ht.key,Tt,ht,Y,250),ee.activeTexture.set(te.TEXTURE0),lt.texture&&lt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ft=Bu.getMorphValuesForProxy(Ht.key),Gt=Ft?1:0;Ft&&Object.assign(Ke,{morphing:{srcDemTile:Ft.from,dstDemTile:Ft.to,phase:i.dz(Ft.phase)}});const tr=i.dC(Ht.canonical),Ut=i.dD(tr.getCenter().lat),Bt=i.dE(Ht.canonical,tr,Ut,vt.worldSize/vt._pixelsPerMercatorPixel),vr=i.bk(i.dF(Ht.canonical)),mr=Tg(vt.expandedFarZProjMatrix,ct,Fe,vr,i.aj(vt.zoom),Re,vt.frustumCorners.TL,vt.frustumCorners.TR,vt.frustumCorners.BR,vt.frustumCorners.BL,vt.globeCenterInViewSpace,vt.globeRadius,Le,st,vt._farZ,Bt);if(Ee(Ht,Gt),ce&&(j.setupElevationDraw(lt,ce,Ke),B.uploadCommonUniforms(ee,ce,Ht.toUnwrapped()),Oe)){const[_r,pr,zr]=Oe.getGridBuffers(Ut,st!==0);ce.draw(B,_t,Me,He,De,Lr.backCCW,mr,"globe_raster",_r,pr,zr)}}}if(Oe&&(B.renderDefaultNorthPole||B.renderDefaultSouthPole)){const vt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];xe&&vt.push("CUSTOM_ANTIALIASING"),ce=B.getOrCreateProgram("globeRaster",{defines:vt});for(const st of W){const{x:_t,y:Ht,z:lt}=st.canonical,He=Ht===0,Tt=Ht===(1<<lt)-1,[ht,Ft,Gt,tr]=Oe.getPoleBuffers(lt,!1);if(tr&&(He||Tt)){const Ut=X.getTile(st);ee.activeTexture.set(te.TEXTURE0),Ut.texture&&Ut.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);let Bt=i.dG(lt,_t,de);const vr=i.bk(i.dF(st.canonical)),mr=(_r,pr)=>_r.draw(B,te.TRIANGLES,Me,Mr.disabled,De,Lr.disabled,Tg(de.expandedFarZProjMatrix,Bt,Bt,vr,0,Re,de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.globeCenterInViewSpace,de.globeRadius,Le,0,de._farZ),"globe_pole_raster",pr,Gt,tr);j.setupElevationDraw(Ut,ce,Ke),B.uploadCommonUniforms(ee,ce,st.toUnwrapped()),He&&B.renderDefaultNorthPole&&mr(ce,ht),Tt&&B.renderDefaultSouthPole&&(Bt=i.cR(i.bC(),Bt,[1,-1,1]),mr(ce,Ft))}}}})(x,b,E,P,M);else{const B=x.context,j=B.gl;let X,W;const Y=x.shadowRenderer,ee=Fu(x,x.longestCutoffRange),te=De=>{if(W===De)return;const Me=[];Me.push(nx[De]),ee.shouldRenderCutoff&&Me.push("RENDER_CUTOFF"),Y&&(Me.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&Me.push("NORMAL_OFFSET")),X=x.getOrCreateProgram("terrainRaster",{defines:Me}),W=De},ce=x.colorModeForRenderPass(),oe=new or(j.LEQUAL,or.ReadWrite,x.depthRangeFor3D);Bu.update(M);const de=x.transform,xe=ix(de.zoom,b.exaggeration(),b.sourceCache._source.tileSize);let Ee=[0,0,0];if(Y){const De=x.style.directionalLight,Me=x.style.ambientLight;De&&Me&&(Ee=Pl(x.style,De,Me))}{W=-1;const De=j.TRIANGLES,[Me,Fe]=[b.gridIndexBuffer,b.gridSegments];for(const Re of P){const Oe=E.getTile(Re),Le=Mr.disabled,ct=b.prevTerrainTileForTile[Re.key],Ke=b.terrainTileForTile[Re.key];Sg(ct,Ke)&&Bu.newMorphing(Re.key,ct,Ke,M,250),B.activeTexture.set(j.TEXTURE0),Oe.texture&&Oe.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const vt=Bu.getMorphValuesForProxy(Re.key),st=vt?1:0;let _t;vt&&(_t={morphing:{srcDemTile:vt.from,dstDemTile:vt.to,phase:i.dz(vt.phase)}});const Ht=rx(Re.projMatrix,RI(Re.canonical,de.renderWorldCopies)?xe/10:xe,Ee);if(te(st),!X)continue;b.setupElevationDraw(Oe,X,_t);const lt=Re.toUnwrapped();Y&&Y.setupShadows(lt,X),x.uploadCommonUniforms(B,X,lt,null,ee),X.draw(x,De,oe,Le,ce,Lr.backCCW,Ht,"terrain_raster",b.gridBuffer,Me,Fe)}}}}(h,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const h=this.painter,m=this.painter.context,x=this.proxySourceCache,b=this.proxiedCoords[x.id],E=this._drapedRenderBatches.shift(),P=h.style.order,M=[];let B=0;for(const j of b){const X=x.getTileByID(j.proxyTileKey),W=x.proxyCachedFBO[j.key]?x.proxyCachedFBO[j.key][s]:void 0,Y=W!==void 0?x.renderCache[W]:this.pool[B++],ee=W!==void 0;if(X.texture=Y.tex,ee&&!Y.dirty){M.push(X.tileID);continue}let te;m.bindFramebuffer.set(Y.fb.framebuffer),this.renderedToTile=!1,Y.dirty&&(m.clear({color:i.ao.transparent,stencil:0}),Y.dirty=!1);for(let ce=E.start;ce<=E.end;++ce){const oe=h.style._mergedLayers[P[ce]];if(oe.isHidden(h.transform.zoom))continue;const de=h.style.getLayerSourceCache(oe),xe=de?this.proxyToSource[j.key][de.id]:[j];if(!xe)continue;const Ee=xe;m.viewport.set([0,0,Y.fb.width,Y.fb.height]),te!==(de?de.id:null)&&(this._setupStencil(Y,xe,oe,de),te=de?de.id:null),h.renderLayer(h,de,oe,Ee)}if(this._drapedRenderBatches.length===0)for(const ce of this._pendingGroundEffectLayers){const oe=h.style._mergedLayers[P[ce]];if(oe.isHidden(h.transform.zoom))continue;const de=h.style.getLayerSourceCache(oe),xe=de?this.proxyToSource[j.key][de.id]:[j];if(!xe)continue;const Ee=xe;m.viewport.set([0,0,Y.fb.width,Y.fb.height]),te!==(de?de.id:null)&&(this._setupStencil(Y,xe,oe,de),te=de?de.id:null),h.renderLayer(h,de,oe,Ee)}this.renderedToTile?(Y.dirty=!0,M.push(X.tileID)):ee||--B,B===5&&(B=0,this.renderToBackBuffer(M))}return this.renderToBackBuffer(M),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,h.width,h.height]),E.end+1}postRender(){}isLayerOrderingCorrect(s){const h=s.order.length;let m=-1,x=h;for(let b=0;b<h;++b)this._style.isLayerDraped(s._mergedLayers[s.order[b]])?m=Math.max(m,b):x=Math.min(x,b);return x>m}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{s=Math.min(s,h.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,h,m){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const E=b.tileID,P=1<<E.overscaledZ,{x:M,y:B}=E.canonical,j=M/P,X=(M+1)/P,W=B/P,Y=(B+1)/P;return{minx:j,miny:W,maxx:X,maxy:Y,t:b.dem.tree.raycastRoot(j,W,X,Y,s,h,m),tile:b}});x.sort((b,E)=>(b.t!==null?b.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const b of x){if(b.t==null)return null;const E=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,s,h,m);if(E!=null)return E}return null}_createFBO(){const s=this.painter.context,h=s.gl,m=this.drapeBufferSize;s.activeTexture.set(h.TEXTURE0);const x=new i.T(s,{width:m[0],height:m[1],data:null},h.RGBA8);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const b=s.createFramebuffer(m[0],m[1],!0,null);return b.colorAttachment.set(x.texture),b.depthAttachment=new MI(s,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:b,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const h=this._style._mergedLayers[s],m=h.isHidden(this.painter.transform.zoom);return h.type==="hillshade"||h.type==="custom"?!m&&h.shouldRedrape():!m&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const m of this._style.getSources())if(m instanceof Ao){s=!0;break}if(!s)return;const h={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(x);if(b&&!h[b.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ad){h[b.id]=!0;for(const E of this.proxyCoords){const P=this.proxyToSource[E.key][b.id];if(P)for(const M of P)this._clearRenderCacheForTile(b.id,M)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Hf){s=!0;break}if(!s)return;const h={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(x);if(!b||h[b.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const E=x.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const M=this.proxyToSource[P.key][b.id];if(M)for(const B of M){const j=Vh(b.getTile(B),b.findLoadedParent(B,0),b,this.painter.transform,E);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(b.id,B)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,h=s.length;if(h===0)return;const m=[];this._pendingGroundEffectLayers=[];let x,b=0,E=this._style._mergedLayers[s[b]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++b<h;)E=this._style._mergedLayers[s[b]];for(;b<h;++b){const P=this._style._mergedLayers[s[b]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?x===void 0&&(x=b):(P.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),x!==void 0&&(m.push({start:x,end:b-1}),x=void 0)))}if(x!==void 0&&m.push({start:x,end:b-1}),m.length!==0){const P=m[m.length-1];this._pendingGroundEffectLayers.every(M=>M>P.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(s){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const E=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let P=0;P<E.length;++P){const M=Object.values(E[P]);h.renderCachePool.push(...M)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,x=this._tilesDirty;for(let E=m.length-1;E>=0;E--){const P=m[E];if(h.getTileByID(P.key),h.proxyCachedFBO[P.key]!==void 0){const M=s[P.key],B=this.proxyToSource[P.key];let j=0;for(const X in B){const W=B[X],Y=M[X];if(!Y||Y.length!==W.length||W.some((ee,te)=>ee!==Y[te]||x[X]&&x[X].hasOwnProperty(ee.key))){j=-1;break}++j}for(const X in h.proxyCachedFBO[P.key])h.renderCache[h.proxyCachedFBO[P.key][X]].dirty=j<0||j!==Object.values(M).length}}const b=[...this._drapedRenderBatches];b.sort((E,P)=>P.end-P.start-(E.end-E.start));for(const E of b)for(const P of m){if(h.proxyCachedFBO[P.key])continue;let M=h.renderCachePool.pop();M===void 0&&h.renderCache.length<50&&(M=h.renderCache.length,h.renderCache.push(this._createFBO())),M!==void 0&&(h.proxyCachedFBO[P.key]={},h.proxyCachedFBO[P.key][E.start]=M,h.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(s,h,m,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,E=b.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let P;if(m.isTileClipped())P=h.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Mr.disabled}_renderTileClippingMasks(s,h){const m=this.painter,x=this.painter.context,b=x.gl;m._tileClippingMaskIDs={},x.setColorMode(Zr.disabled),x.setDepthMode(or.disabled);const E=m.getOrCreateProgram("clippingMask");for(const P of s){const M=m._tileClippingMaskIDs[P.key]=--h;E.draw(m,b.TRIANGLES,or.disabled,new Mr({func:b.ALWAYS,mask:0},M,255,b.KEEP,b.KEEP,b.REPLACE),Zr.disabled,Lr.disabled,$h(P.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(s){const h=this.painter.transform;if(s.x<0||s.x>h.width||s.y<0||s.y>h.height)return null;const m=[s.x,s.y,1,1];i.aC(m,m,h.pixelMatrixInverse),i.cJ(m,m,1/m[3]),m[0]/=h.worldSize,m[1]/=h.worldSize;const x=h._camera.position,b=i.ce(1,h.center.lat),E=[x[0],x[1],x[2]/b,0],P=i.d9([],m.slice(0,3),E);i.aw(P,P);const M=this.raycast(E,P,this._exaggeration);return M!==null&&M?(i.bH(E,E,P,M),E[3]=E[2],E[2]*=b,E):null}_setupProxiedCoordsForOrtho(s,h,m){if(s.getSource()instanceof i.aS)return this._setupProxiedCoordsForImageSource(s,h,m);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const x=this.proxiedCoords[s.id]=[],b=this.proxyCoords;for(let M=0;M<b.length;M++){const B=b[M],j=this._findTileCoveringTileID(B,s);if(j){const X=this._createProxiedId(B,j,m[B.key]&&m[B.key][s.id]);x.push(X),this.proxyToSource[B.key][s.id]=[X]}}let E=!1;const P=new Set;for(let M=0;M<h.length;M++){const B=s.getTile(h[M]);if(!B||!B.hasData())continue;const j=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==B.tileID.canonical.z){const X=this.proxyToSource[j.tileID.key][s.id],W=this._createProxiedId(j.tileID,B,m[j.tileID.key]&&m[j.tileID.key][s.id]);X?X.splice(X.length-1,0,W):this.proxyToSource[j.tileID.key][s.id]=[W];const Y=this.proxyToSource[j.tileID.key][s.id];P.has(Y)||P.add(Y),x.push(W),E=!0}}if(this._sourceTilesOverlap[s.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const M of P)M.sort((B,j)=>j.overscaledZ-B.overscaledZ)}_setupProxiedCoordsForImageSource(s,h,m){if(!s.getSource().loaded())return;const x=this.proxiedCoords[s.id]=[],b=this.proxyCoords,E=s.getSource(),P=E.tileID;if(!P)return;const M=new i.P(P.x,P.y)._div(1<<P.z),B=E.coordinates.map(i.ae.fromLngLat).reduce((X,W)=>(X.min.x=Math.min(X.min.x,W.x-M.x),X.min.y=Math.min(X.min.y,W.y-M.y),X.max.x=Math.max(X.max.x,W.x-M.x),X.max.y=Math.max(X.max.y,W.y-M.y),X),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(X,W)=>{const Y=X.wrap+X.canonical.x/(1<<X.canonical.z),ee=X.canonical.y/(1<<X.canonical.z),te=i.al/(1<<X.canonical.z),ce=W.wrap+W.canonical.x/(1<<W.canonical.z),oe=W.canonical.y/(1<<W.canonical.z);return Y+te<ce+B.min.x||Y>ce+B.max.x||ee+te<oe+B.min.y||ee>oe+B.max.y};for(let X=0;X<b.length;X++){const W=b[X];for(let Y=0;Y<h.length;Y++){const ee=s.getTile(h[Y]);if(!ee||!ee.hasData()||j(W,ee.tileID))continue;const te=this._createProxiedId(W,ee,m[W.key]&&m[W.key][s.id]),ce=this.proxyToSource[W.key][s.id];ce?ce.push(te):this.proxyToSource[W.key][s.id]=[te],x.push(te)}}}_createProxiedId(s,h,m){let x=this.orthoMatrix;if(m){const b=m.find(E=>E.key===h.tileID.key);if(b)return b}if(h.tileID.key!==s.key){const b=s.canonical.z-h.tileID.canonical.z;let E,P,M;x=i.bC();const B=h.tileID.wrap-s.wrap<<s.overscaledZ;b>0?(E=i.al>>b,P=E*((h.tileID.canonical.x<<b)-s.canonical.x+B),M=E*((h.tileID.canonical.y<<b)-s.canonical.y)):(E=i.al<<-b,P=i.al*(h.tileID.canonical.x-(s.canonical.x+B<<-b)),M=i.al*(h.tileID.canonical.y-(s.canonical.y<<-b))),i.cd(x,0,E,0,E,0,1),i.br(x,x,[P,M,0])}return new Eg(h.tileID,s.key,x)}_findTileCoveringTileID(s,h){let m=h.getTile(s);if(m&&m.hasData())return m;const x=this._findCoveringTileCache[h.id],b=x[s.key];if(m=b?h.getTileByID(b):null,m&&m.hasData()||b===null)return m;let E=m?m.tileID:s,P=E.overscaledZ;const M=h.getSource().minzoom,B=[];if(!b){const X=h.getSource().maxzoom;if(s.canonical.z>=X){const W=s.canonical.z-X;h.getSource().reparseOverscaled?(P=Math.max(s.canonical.z+2,h.transform.tileZoom),E=new i.aO(P,s.wrap,X,s.canonical.x>>W,s.canonical.y>>W)):W!==0&&(P=X,E=new i.aO(P,s.wrap,X,s.canonical.x>>W,s.canonical.y>>W))}E.key!==s.key&&(B.push(E.key),m=h.getTile(E))}const j=X=>{B.forEach(W=>{x[W]=X}),B.length=0};for(P-=1;P>=M&&(!m||!m.hasData());P--){m&&j(m.tileID.key);const X=E.calculateScaledKey(P);if(m=h.getTileByID(X),m&&m.hasData())break;const W=x[X];if(W===null)break;W===void 0?B.push(X):m=h.getTileByID(W)}return j(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,h){let m=this._tilesDirty[s];m||(m=this._tilesDirty[s]={}),m[h.key]=!0}}function Ag(g,s,h){const m=function(P,M,B){const j=i.bJ(M,P),X=i.bJ(B,[.2126,.7152,.0722]),W=(ee,te,ce)=>(1-ce)*ee+ce*te,Y=W(1-.3*Math.min(X,1),1,Math.min(j+1,1));return W(.92,1,Math.asin(i.aA(M[2],-1,1))/Math.PI+.5)*Y}(g,[0,0,1],s),x=[0,0,0];i.c4(x,h.slice(0,3),m);const b=[0,0,0];i.c4(b,s.slice(0,3),g[2]);const E=[0,0,0];return i.d7(E,x,b),i.da(E)}const ax=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],ox=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Cg{static cacheKey(s,h,m,x){let b=`${h}${x?x.cacheKey:""}`;for(const E of m)s.usedDefines.includes(E)&&(b+=`/${E}`);return b}constructor(s,h,m,x,b,E){const P=s.gl;this.program=P.createProgram(),this.configuration=x,this.name=h,this.fixedDefines=[...E];let M=x?x.defines():[];M=M.concat(E.map(ee=>`#define ${ee}`));const B=`#version 300 es
`;let j=B+M.concat("precision mediump float;",nc,sm.fragmentSource).join(`
`);for(const ee of m.fragmentIncludes)j+=`
${od[ee]}`;j+=`
${m.fragmentSource}`;let X=B+M.concat("precision highp float;",nc,sm.vertexSource).join(`
`);for(const ee of m.vertexIncludes)X+=`
${od[ee]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(X+=`
uniform int u_instanceID;
`),X+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(X=X.replaceAll("gl_InstanceID","u_instanceID"));const W=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(W,j),P.compileShader(W),P.attachShader(this.program,W);const Y=P.createShader(P.VERTEX_SHADER);P.isContextLost()?this.failedToCreate=!0:(P.shaderSource(Y,X),P.compileShader(Y),P.attachShader(this.program,Y),this.attributes={},P.linkProgram(this.program),P.deleteShader(Y),P.deleteShader(W),this.fixedUniforms=b(s),this.binderUniforms=x?x.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ee=>({u_instanceID:new i.cg(ee)}))(s)),(E.includes("TERRAIN")||h.indexOf("symbol")!==-1||h.indexOf("circle")!==-1)&&(this.terrainUniforms=(ee=>({u_dem:new i.cg(ee),u_dem_prev:new i.cg(ee),u_dem_tl:new i.cj(ee),u_dem_scale:new i.ci(ee),u_dem_tl_prev:new i.cj(ee),u_dem_scale_prev:new i.ci(ee),u_dem_size:new i.ci(ee),u_dem_lerp:new i.ci(ee),u_exaggeration:new i.ci(ee),u_depth:new i.cg(ee),u_depth_size_inv:new i.cj(ee),u_depth_range_unpack:new i.cj(ee),u_occluder_half_size:new i.ci(ee),u_occlusion_depth_offset:new i.ci(ee),u_meter_to_dem:new i.ci(ee),u_label_plane_matrix_inv:new i.ck(ee)}))(s)),E.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new i.ch(ee),u_tile_tr_up:new i.ch(ee),u_tile_br_up:new i.ch(ee),u_tile_bl_up:new i.ch(ee),u_tile_up_scale:new i.ci(ee)}))(s)),E.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new i.ck(ee),u_fog_range:new i.cj(ee),u_fog_color:new i.d2(ee),u_fog_horizon_blend:new i.ci(ee),u_fog_vertical_limit:new i.cj(ee),u_fog_temporal_offset:new i.ci(ee),u_frustum_tl:new i.ch(ee),u_frustum_tr:new i.ch(ee),u_frustum_br:new i.ch(ee),u_frustum_bl:new i.ch(ee),u_globe_pos:new i.ch(ee),u_globe_radius:new i.ci(ee),u_globe_transition:new i.ci(ee),u_is_globe:new i.cg(ee),u_viewport:new i.cj(ee)}))(s)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ee=>({u_cutoff_params:new i.d2(ee)}))(s)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ee=>({u_lighting_ambient_color:new i.ch(ee),u_lighting_directional_dir:new i.ch(ee),u_lighting_directional_color:new i.ch(ee),u_ground_radiance:new i.ch(ee)}))(s)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ee=>({u_light_matrix_0:new i.ck(ee),u_light_matrix_1:new i.ck(ee),u_fade_range:new i.cj(ee),u_shadow_normal_offset:new i.ch(ee),u_shadow_intensity:new i.ci(ee),u_shadow_texel_size:new i.ci(ee),u_shadow_map_resolution:new i.ci(ee),u_shadow_direction:new i.ch(ee),u_shadow_bias:new i.ch(ee),u_shadowmap_0:new i.cg(ee),u_shadowmap_1:new i.cg(ee)}))(s)))}getAttributeLocation(s,h){let m=this.attributes[h];return m===void 0&&(m=this.attributes[h]=s.getAttribLocation(this.program,h)),m}setTerrainUniformValues(s,h){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)m[x]&&m[x].set(this.program,x,h[x])}}setGlobeUniformValues(s,h){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)m[x]&&m[x].set(this.program,x,h[x])}}setFogUniformValues(s,h){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)m[x].set(this.program,x,h[x])}}setCutoffUniformValues(s,h){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)m[x].set(this.program,x,h[x])}}setLightsUniformValues(s,h){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)m[x].set(this.program,x,h[x])}}setShadowUniformValues(s,h){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;s.program.set(this.program);for(const x in h)m[x].set(this.program,x,h[x])}_drawDebugWireframe(s,h,m,x,b,E,P,M,B,j){const X=s.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const W=s.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||s._terrain&&s._terrain.renderingToTexture||!ax.includes(this.name))||!(!X.layers3D||!ox.includes(this.name))))return;const Y=W.gl,ee=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,b,W);if(!ee)return;const te=[...this.fixedDefines];te.push("DEBUG_WIREFRAME");const ce=s.getOrCreateProgram(this.name,{config:this.configuration,defines:te});W.program.set(ce.program);const oe=(Ee,De,Me)=>{if(De[Ee]&&Me[Ee])for(const Fe in De[Ee])Me[Ee][Fe]&&Me[Ee][Fe].set(Me.program,Fe,De[Ee][Fe].current)};B&&B.setUniforms(ce.program,W,ce.binderUniforms,P,{zoom:M}),oe("fixedUniforms",this,ce),oe("terrainUniforms",this,ce),oe("globeUniforms",this,ce),oe("fogUniforms",this,ce),oe("lightsUniforms",this,ce),oe("shadowUniforms",this,ce),ee.bind(),W.setColorMode(new Zr([Y.ONE,Y.ONE_MINUS_SRC_ALPHA,Y.ZERO,Y.ONE],i.ao.transparent,[!0,!0,!0,!1])),W.setDepthMode(new or(h.func===Y.LESS?Y.LEQUAL:h.func,or.ReadOnly,h.range)),W.setStencilMode(Mr.disabled);const de=3*E.primitiveLength*2,xe=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Ee=j||1;for(let De=0;De<Ee;++De)ce.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",De),Y.drawElements(Y.LINES,de,Y.UNSIGNED_SHORT,xe)}else j&&j>1?Y.drawElementsInstanced(Y.LINES,de,Y.UNSIGNED_SHORT,xe,j):Y.drawElements(Y.LINES,de,Y.UNSIGNED_SHORT,xe);b.bind(),W.program.set(this.program),W.setDepthMode(h),W.setStencilMode(m),W.setColorMode(x)}checkUniforms(s,h,m){if(this.fixedDefines.includes(h)){for(const x of Object.keys(m))if(!m[x].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${x} not set but required by ${h} being defined`)}}draw(s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce){const oe=s.context,de=oe.gl;if(this.failedToCreate)return;oe.program.set(this.program),oe.setDepthMode(m),oe.setStencilMode(x),oe.setColorMode(b),oe.setCullFace(E);for(const De of Object.keys(this.fixedUniforms))this.fixedUniforms[De].set(this.program,De,P[De]);ee&&ee.setUniforms(this.program,oe,this.binderUniforms,W,{zoom:Y});const xe={[de.POINTS]:1,[de.LINES]:2,[de.TRIANGLES]:3,[de.LINE_STRIP]:1}[h];this.checkUniforms(M,"RENDER_SHADOWS",this.shadowUniforms);const Ee=ce&&ce>0?1:void 0;for(const De of X.get()){const Me=De.vaos||(De.vaos={});if((Me[M]||(Me[M]=new sd)).bind(oe,this,B,ee?ee.getPaintVertexBuffers():[],j,De.vertexOffset,te||[],Ee),this.forceManualRenderingForInstanceIDShaders){const Fe=ce||1;for(let Re=0;Re<Fe;++Re)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Re),j?de.drawElements(h,De.primitiveLength*xe,de.UNSIGNED_SHORT,De.primitiveOffset*xe*2):de.drawArrays(h,De.vertexOffset,De.vertexLength)}else ce&&ce>1?de.drawElementsInstanced(h,De.primitiveLength*xe,de.UNSIGNED_SHORT,De.primitiveOffset*xe*2,ce):j?de.drawElements(h,De.primitiveLength*xe,de.UNSIGNED_SHORT,De.primitiveOffset*xe*2):de.drawArrays(h,De.vertexOffset,De.vertexLength);h===de.TRIANGLES&&j&&this._drawDebugWireframe(s,m,x,b,j,De,W,Y,ee,ce)}}}function um(g,s,h=0){const m=Math.pow(2,s.tileID.overscaledZ),x=s.tileSize*Math.pow(2,g.transform.tileZoom)/m,b=x*(s.tileID.canonical.x+s.tileID.wrap*m),E=x*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ay(s,1,g.transform.tileZoom),u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E],u_pattern_transition:h}}const hd={terrain:0,flat:1},sx=i.bC(),hm=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe)=>{const de=s.style.light,xe=de.properties.get("position"),Ee=[xe.x,xe.y,xe.z],De=i.dL();de.properties.get("anchor")==="viewport"&&(i.dM(De,-s.transform.angle),i.dN(Ee,Ee,De));const Me=de.properties.get("color").toPremultipliedRenderColor(null),Fe=s.transform,Re={u_matrix:g,u_lightpos:Ee,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_vertical_gradient:+h,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:sx,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:hd[B],u_base_type:hd[j],u_ao:x,u_edge_radius:b,u_width_scale:E,u_flood_light_color:ee,u_vertical_scale:te,u_flood_light_intensity:ce,u_ground_shadow_factor:oe};return Fe.projection.name==="globe"&&(Re.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],Re.u_zoom_transition=X,Re.u_inv_rot_matrix=Y,Re.u_merc_center=W,Re.u_up_dir=Fe.projection.upVector(new i.cC(0,0,0),W[0]*i.al,W[1]*i.al),Re.u_height_lift=M),Re},lx=(g,s,h,m,x,b)=>({u_matrix:g,u_edge_radius:s,u_width_scale:h,u_vertical_scale:m,u_height_type:hd[x],u_base_type:hd[b]}),Q2=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe)=>{const de=hm(g,s,h,m,x,b,E,P,B,j,X,W,Y,ee,te,ce,1,[0,0,0]),xe={u_height_factor:-Math.pow(2,P.overscaledZ)/M.tileSize/8};return Object.assign(de,um(s,M,oe),xe)},cx=(g,s,h)=>({u_matrix:g,u_emissive_strength:s,u_ground_shadow_factor:h}),Wh=(g,s,h,m,x,b=0)=>Object.assign(cx(g,s,x),um(h,m,b)),DI=(g,s,h,m)=>({u_matrix:g,u_world:h,u_emissive_strength:s,u_ground_shadow_factor:m}),FI=(g,s,h,m,x,b,E=0)=>Object.assign(Wh(g,s,h,m,b,E),{u_world:x}),LI=(g,s)=>({u_matrix:g,u_ground_shadow_factor:s}),Pg=(g,s,h,m,x)=>({u_matrix:g,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:h,u_height_scale:m,u_reset_depth:x}),NI=(g,s,h,m,x,b,E)=>({u_matrix:g,u_normal_matrix:s,u_opacity:h,u_faux_facade_ao_intensity:m,u_camera_pos:x,u_tile_to_meter:b,u_facade_emissive_chance:E}),BI=g=>({u_matrix:g}),ux=g=>({u_matrix:g}),hx=(g,s,h,m,x,b,E,P)=>{const M=i.al/b.tileSize;return{u_matrix:g,u_inv_rot_matrix:s,u_camera_to_center_distance:h.getCameraToCenterDistance(P),u_extrude_scale:[h.pixelsToGLUnits[0]/M,h.pixelsToGLUnits[1]/M],u_zoom_transition:m,u_tile_id:E,u_merc_center:x}},fx=(g,s,h=1)=>({u_matrix:g,u_color:s,u_overlay:0,u_overlay_scale:h}),fd=i.bC(),eT=(g,s,h,m,x,b,E)=>{const P=g.transform,M=P.projection.name==="globe",B=M?i.dO(P.zoom,s.canonical)*P._pixelsPerMercatorPixel:i.ay(h,1,b),j={u_matrix:s.projMatrix,u_extrude_scale:B,u_intensity:E,u_inv_rot_matrix:fd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){j.u_inv_rot_matrix=m,j.u_merc_center=x,j.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],j.u_zoom_transition=i.aj(P.zoom);const X=x[0]*i.al,W=x[1]*i.al;j.u_up_dir=P.projection.upVector(new i.cC(0,0,0),X,W)}return j};function dx(g,[s,h,m,x],[b,E]){if(b===E)return[0,0,0,0];const P=255*(g-1)/(g*(E-b));return[s*P,h*P,m*P,x*P]}function px(g,s,[h,m]){return h===m?0:.5/g+(s-h)*(g-1)/(g*(m-h))}const Ig=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de,xe,Ee)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:B,u_fade_t:j.mix,u_opacity:j.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:i.dQ(X.paint.get("raster-saturation")),u_contrast_factor:i.dP(X.paint.get("raster-contrast")),u_spin_weights:Gh(X.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:Y,u_zoom_transition:E,u_merc_center:P,u_cutoff_params:M,u_colorization_mix:dx(i.dR,te,oe),u_colorization_offset:px(i.dR,ce,oe),u_color_ramp:ee,u_texture_offset:[xe/(de+2*xe),de/(de+2*xe)],u_texture_res:[de+2*xe,de+2*xe],u_emissive_strength:Ee});function Gh(g){g*=Math.PI/180;const s=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*s-h+1)/3,(Math.sqrt(3)*s-h+1)/3]}const Hh=.05,zu=(g,s,h,m,x,b,E,P,M,B,j,X)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:B,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:E,u_merc_center:P,u_cutoff_params:M}),mx=(g,s,h,m,x,b,E,P,M,B)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_tile_offset:h,u_velocity:m,u_color_ramp:b,u_velocity_res:x,u_max_speed:E,u_uv_offset:P,u_data_scale:[255*M[0],255*M[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[Hh,Hh]}),kg=(g,s,h,m,x,b,E,P,M,B)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_velocity:h,u_velocity_res:m,u_max_speed:x,u_speed_factor:b,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:P,u_data_scale:[255*M[0],255*M[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[Hh,Hh]}),gx=i.bC(),_x=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de,xe,Ee,De,Me,Fe)=>{const Re=x.transform,Oe={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Re.getCameraToCenterDistance(de),u_rotate_symbol:+h,u_aspect_ratio:Re.width/Re.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:P,u_is_text:+B,u_elevation_from_sea:M?1:0,u_pitch_with_map:+m,u_texsize:j,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gx,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:gx,u_up_vector:[0,-1,0],u_color_adj_mat:De,u_icon_transition:Me||0,u_gamma_scale:m?x.transform.getCameraToCenterDistance(de)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.o.devicePixelRatio,u_is_halo:1,u_scale_factor:Fe||1,u_ground_shadow_factor:xe,u_inv_matrix:i.bl(i.bC(),E),u_normal_scale:Ee,u_lutTexture:aa.LUT};return de.name==="globe"&&(Oe.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],Oe.u_zoom_transition=ee,Oe.u_inv_rot_matrix=ce,Oe.u_merc_center=te,Oe.u_camera_forward=Re._camera.forward(),Oe.u_ecef_origin=i.dS(Re.globeMatrix,Y.toUnwrapped()),Oe.u_tile_matrix=Float32Array.from(Re.globeMatrix),Oe.u_up_vector=oe),Oe},Og=(g,s,h,m)=>({u_matrix:g,u_emissive_strength:s,u_opacity:h,u_color:m}),Mg=(g,s,h,m,x,b,E,P,M)=>Object.assign(function(B,j,X,W,Y,ee){const{width:te,height:ce}=W.imageManager.getPixelSize(j),oe=Math.pow(2,ee.tileID.overscaledZ),de=ee.tileSize*Math.pow(2,W.transform.tileZoom)/oe,xe=de*(ee.tileID.canonical.x+ee.tileID.wrap*oe),Ee=de*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[te,ce],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:Y?[W.transform.width,-1*W.transform.height]:[1/i.ay(ee,1,W.transform.tileZoom),1/i.ay(ee,1,W.transform.tileZoom)],u_pixel_coord_upper:[xe>>16,Ee>>16],u_pixel_coord_lower:[65535&xe,65535&Ee]}}(0,b,E,m,P,M),{u_matrix:g,u_emissive_strength:s,u_opacity:h}),yx=new Float32Array(i.bA([])),Rg=(g,s,h,m,x,b,E,P,M,B,j,X,W,Y=[0,0,0],ee)=>{const te=x.style.light,ce=te.properties.get("position"),oe=[-ce.x,-ce.y,ce.z],de=i.dL();te.properties.get("anchor")==="viewport"&&(i.dM(de,-x.transform.angle),i.dN(oe,oe,de));const xe=j.alphaMode==="MASK",Ee=te.properties.get("color").toNonPremultipliedRenderColor(null),De=W.paint.get("model-ambient-occlusion-intensity"),Me=W.paint.get("model-color").constantOr(i.ao.white).toNonPremultipliedRenderColor(null);return Me.a=W.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:g,u_lighting_matrix:s,u_normal_matrix:h,u_node_matrix:m||yx,u_lightpos:oe,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_camera_pos:Y,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+xe,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:E.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:P.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:M,u_roughnessFactor:B,u_baseColorTexture:aa.BaseColor,u_metallicRoughnessTexture:aa.MetallicRoughness,u_normalTexture:aa.Normal,u_occlusionTexture:aa.Occlusion,u_emissionTexture:aa.Emission,u_lutTexture:aa.LUT,u_color_mix:Me.toArray01(),u_aoIntensity:De,u_emissive_strength:X,u_occlusionTextureTransform:ee||[0,0,0,0]}},dd=(g,s=yx,h=yx)=>({u_matrix:g,u_instance:s,u_node_matrix:h}),zI={fillExtrusion:g=>({u_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_vertical_gradient:new i.ci(g),u_opacity:new i.ci(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_ao:new i.cj(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_up_dir:new i.ch(g),u_height_lift:new i.ci(g),u_flood_light_color:new i.ch(g),u_vertical_scale:new i.ci(g),u_flood_light_intensity:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),fillExtrusionDepth:g=>({u_matrix:new i.ck(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_vertical_scale:new i.ci(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g)}),fillExtrusionPattern:g=>({u_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_vertical_gradient:new i.ci(g),u_height_factor:new i.ci(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_ao:new i.cj(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_up_dir:new i.ch(g),u_height_lift:new i.ci(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_opacity:new i.ci(g),u_pattern_transition:new i.ci(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.ck(g),u_opacity:new i.ci(g),u_ao_pass:new i.ci(g),u_meter_to_tile:new i.ci(g),u_ao:new i.cj(g),u_flood_light_intensity:new i.ci(g),u_flood_light_color:new i.ch(g),u_attenuation:new i.ci(g),u_edge_radius:new i.ci(g),u_fb:new i.cg(g),u_fb_size:new i.ci(g),u_dynamic_offset:new i.ci(g)}),fill:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),fillPattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_pattern_transition:new i.ci(g)}),fillOutline:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_world:new i.cj(g),u_ground_shadow_factor:new i.ch(g)}),fillOutlinePattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_world:new i.cj(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_pattern_transition:new i.ci(g)}),building:g=>({u_matrix:new i.ck(g),u_normal_matrix:new i.ck(g),u_opacity:new i.ci(g),u_faux_facade_ao_intensity:new i.ci(g),u_camera_pos:new i.ch(g),u_tile_to_meter:new i.ci(g),u_facade_emissive_chance:new i.ci(g)}),buildingBloom:g=>({u_matrix:new i.ck(g)}),buildingDepth:g=>({u_matrix:new i.ck(g)}),elevatedStructuresDepth:g=>({u_matrix:new i.ck(g),u_depth_bias:new i.ci(g)}),elevatedStructures:g=>({u_matrix:new i.ck(g),u_ground_shadow_factor:new i.ch(g)}),elevatedStructuresDepthReconstruct:g=>({u_matrix:new i.ck(g),u_camera_pos:new i.ch(g),u_depth_bias:new i.ci(g),u_height_scale:new i.ci(g),u_reset_depth:new i.ci(g)}),circle:i.dV,collisionBox:g=>({u_matrix:new i.ck(g),u_inv_rot_matrix:new i.ck(g),u_camera_to_center_distance:new i.ci(g),u_extrude_scale:new i.cj(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_tile_id:new i.ch(g)}),collisionCircle:g=>({u_matrix:new i.ck(g),u_inv_matrix:new i.ck(g),u_camera_to_center_distance:new i.ci(g),u_viewport_size:new i.cj(g)}),debug:g=>({u_color:new i.dx(g),u_matrix:new i.ck(g),u_overlay:new i.cg(g),u_overlay_scale:new i.ci(g)}),clippingMask:g=>({u_matrix:new i.ck(g)}),heatmap:g=>({u_extrude_scale:new i.ci(g),u_intensity:new i.ci(g),u_matrix:new i.ck(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_up_dir:new i.ch(g)}),heatmapTexture:g=>({u_image:new i.cg(g),u_color_ramp:new i.cg(g),u_opacity:new i.ci(g)}),hillshade:g=>({u_matrix:new i.ck(g),u_image:new i.cg(g),u_latrange:new i.cj(g),u_light:new i.cj(g),u_shadow:new i.dx(g),u_highlight:new i.dx(g),u_emissive_strength:new i.ci(g),u_accent:new i.dx(g)}),hillshadePrepare:g=>({u_matrix:new i.ck(g),u_image:new i.cg(g),u_dimension:new i.cj(g),u_zoom:new i.ci(g)}),line:i.dU,linePattern:i.dT,raster:g=>({u_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_grid_matrix:new i.dy(g),u_tl_parent:new i.cj(g),u_scale_parent:new i.ci(g),u_fade_t:new i.ci(g),u_opacity:new i.ci(g),u_image0:new i.cg(g),u_image1:new i.cg(g),u_brightness_low:new i.ci(g),u_brightness_high:new i.ci(g),u_saturation_factor:new i.ci(g),u_contrast_factor:new i.ci(g),u_spin_weights:new i.ch(g),u_perspective_transform:new i.cj(g),u_raster_elevation:new i.ci(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_cutoff_params:new i.d2(g),u_colorization_mix:new i.d2(g),u_colorization_offset:new i.ci(g),u_color_ramp:new i.cg(g),u_texture_offset:new i.cj(g),u_texture_res:new i.cj(g),u_emissive_strength:new i.ci(g)}),rasterParticle:g=>({u_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_grid_matrix:new i.dy(g),u_tl_parent:new i.cj(g),u_scale_parent:new i.ci(g),u_fade_t:new i.ci(g),u_opacity:new i.ci(g),u_image0:new i.cg(g),u_image1:new i.cg(g),u_raster_elevation:new i.ci(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_cutoff_params:new i.d2(g)}),rasterParticleTexture:g=>({u_texture:new i.cg(g),u_opacity:new i.ci(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.cg(g),u_particle_texture_side_len:new i.ci(g),u_tile_offset:new i.cj(g),u_velocity:new i.cg(g),u_color_ramp:new i.cg(g),u_velocity_res:new i.cj(g),u_max_speed:new i.ci(g),u_uv_offset:new i.cj(g),u_data_scale:new i.cj(g),u_data_offset:new i.ci(g),u_particle_pos_scale:new i.ci(g),u_particle_pos_offset:new i.cj(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.cg(g),u_particle_texture_side_len:new i.ci(g),u_velocity:new i.cg(g),u_velocity_res:new i.cj(g),u_max_speed:new i.ci(g),u_speed_factor:new i.ci(g),u_reset_rate:new i.ci(g),u_rand_seed:new i.ci(g),u_uv_offset:new i.cj(g),u_data_scale:new i.cj(g),u_data_offset:new i.ci(g),u_particle_pos_scale:new i.ci(g),u_particle_pos_offset:new i.cj(g)}),symbol:g=>({u_is_size_zoom_constant:new i.cg(g),u_is_size_feature_constant:new i.cg(g),u_size_t:new i.ci(g),u_size:new i.ci(g),u_camera_to_center_distance:new i.ci(g),u_rotate_symbol:new i.cg(g),u_aspect_ratio:new i.ci(g),u_fade_change:new i.ci(g),u_matrix:new i.ck(g),u_label_plane_matrix:new i.ck(g),u_coord_matrix:new i.ck(g),u_is_text:new i.cg(g),u_elevation_from_sea:new i.cg(g),u_pitch_with_map:new i.cg(g),u_texsize:new i.cj(g),u_texsize_icon:new i.cj(g),u_texture:new i.cg(g),u_texture_icon:new i.cg(g),u_gamma_scale:new i.ci(g),u_device_pixel_ratio:new i.ci(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_camera_forward:new i.ch(g),u_tile_matrix:new i.ck(g),u_up_vector:new i.ch(g),u_ecef_origin:new i.ch(g),u_is_halo:new i.cg(g),u_icon_transition:new i.ci(g),u_color_adj_mat:new i.ck(g),u_scale_factor:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_inv_matrix:new i.ck(g),u_normal_scale:new i.ci(g),u_lutTexture:new i.cg(g)}),background:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_opacity:new i.ci(g),u_color:new i.dx(g)}),backgroundPattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_opacity:new i.ci(g),u_image:new i.cg(g),u_pattern_tl:new i.cj(g),u_pattern_br:new i.cj(g),u_texsize:new i.cj(g),u_pattern_size:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_pattern_units_to_pixels:new i.cj(g)}),terrainRaster:g=>({u_matrix:new i.ck(g),u_image0:new i.cg(g),u_skirt_height:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),skybox:g=>({u_matrix:new i.ck(g),u_sun_direction:new i.ch(g),u_cubemap:new i.cg(g),u_opacity:new i.ci(g),u_temporal_offset:new i.ci(g)}),skyboxGradient:g=>({u_matrix:new i.ck(g),u_color_ramp:new i.cg(g),u_center_direction:new i.ch(g),u_radius:new i.ci(g),u_opacity:new i.ci(g),u_temporal_offset:new i.ci(g)}),skyboxCapture:g=>({u_matrix_3f:new i.dy(g),u_sun_direction:new i.ch(g),u_sun_intensity:new i.ci(g),u_color_tint_r:new i.d2(g),u_color_tint_m:new i.d2(g),u_luminance:new i.ci(g)}),globeRaster:g=>({u_proj_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_image0:new i.cg(g),u_grid_matrix:new i.dy(g),u_skirt_height:new i.ci(g),u_far_z_cutoff:new i.ci(g),u_frustum_tl:new i.ch(g),u_frustum_tr:new i.ch(g),u_frustum_br:new i.ch(g),u_frustum_bl:new i.ch(g),u_globe_pos:new i.ch(g),u_globe_radius:new i.ci(g),u_viewport:new i.cj(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.ch(g),u_frustum_tr:new i.ch(g),u_frustum_br:new i.ch(g),u_frustum_bl:new i.ch(g),u_horizon:new i.ci(g),u_transition:new i.ci(g),u_fadeout_range:new i.ci(g),u_atmosphere_fog_color:new i.d2(g),u_high_color:new i.d2(g),u_space_color:new i.d2(g),u_temporal_offset:new i.ci(g),u_horizon_angle:new i.ci(g)}),model:g=>({u_matrix:new i.ck(g),u_lighting_matrix:new i.ck(g),u_normal_matrix:new i.ck(g),u_node_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_camera_pos:new i.ch(g),u_opacity:new i.ci(g),u_baseColorFactor:new i.d2(g),u_emissiveFactor:new i.d2(g),u_metallicFactor:new i.ci(g),u_roughnessFactor:new i.ci(g),u_baseTextureIsAlpha:new i.cg(g),u_alphaMask:new i.cg(g),u_alphaCutoff:new i.ci(g),u_baseColorTexture:new i.cg(g),u_metallicRoughnessTexture:new i.cg(g),u_normalTexture:new i.cg(g),u_occlusionTexture:new i.cg(g),u_emissionTexture:new i.cg(g),u_lutTexture:new i.cg(g),u_color_mix:new i.d2(g),u_aoIntensity:new i.ci(g),u_emissive_strength:new i.ci(g),u_occlusionTextureTransform:new i.d2(g)}),modelDepth:g=>({u_matrix:new i.ck(g),u_instance:new i.ck(g),u_node_matrix:new i.ck(g)}),groundShadow:g=>({u_matrix:new i.ck(g),u_ground_shadow_factor:new i.ch(g)}),stars:g=>({u_matrix:new i.ck(g),u_up:new i.ch(g),u_right:new i.ch(g),u_intensity_multiplier:new i.ci(g)}),snowParticle:g=>({u_modelview:new i.ck(g),u_projection:new i.ck(g),u_time:new i.ci(g),u_cam_pos:new i.ch(g),u_velocityConeAperture:new i.ci(g),u_velocity:new i.ci(g),u_horizontalOscillationRadius:new i.ci(g),u_horizontalOscillationRate:new i.ci(g),u_boxSize:new i.ci(g),u_billboardSize:new i.ci(g),u_simpleShapeParameters:new i.cj(g),u_screenSize:new i.cj(g),u_thinningCenterPos:new i.cj(g),u_thinningShape:new i.ch(g),u_thinningAffectedRatio:new i.ci(g),u_thinningParticleOffset:new i.ci(g),u_particleColor:new i.d2(g),u_direction:new i.ch(g)}),rainParticle:g=>({u_modelview:new i.ck(g),u_projection:new i.ck(g),u_time:new i.ci(g),u_cam_pos:new i.ch(g),u_texScreen:new i.cg(g),u_velocityConeAperture:new i.ci(g),u_velocity:new i.ci(g),u_boxSize:new i.ci(g),u_rainDropletSize:new i.cj(g),u_distortionStrength:new i.ci(g),u_rainDirection:new i.ch(g),u_color:new i.d2(g),u_screenSize:new i.cj(g),u_thinningCenterPos:new i.cj(g),u_thinningShape:new i.ch(g),u_thinningAffectedRatio:new i.ci(g),u_thinningParticleOffset:new i.ci(g),u_shapeDirectionalPower:new i.ci(g),u_shapeNormalPower:new i.ci(g),u_mode:new i.ci(g)}),vignette:g=>({u_vignetteShape:new i.ch(g),u_vignetteColor:new i.d2(g)}),occlusion:g=>({u_matrix:new i.ck(g),u_anchorPos:new i.ch(g),u_screenSizePx:new i.cj(g),u_occluderSizePx:new i.cj(g),u_color:new i.d2(g)})};class ju{constructor(s,h,m,x){this.id=ju.uniqueIdxCounter,ju.uniqueIdxCounter++,this.context=s;const b=s.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||x||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=ju.uniqueIdxCounter,ju.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ju.uniqueIdxCounter=0;const tT={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class jI{constructor(s,h,m,x,b,E){this.length=h.length,this.attributes=m,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.instanceCount=E,this.context=s;const P=s.gl;this.buffer=P.createBuffer(),s.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||b||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,h){for(let m=0;m<this.attributes.length;m++){const x=h.getAttributeLocation(s,this.attributes[m].name);x!==-1&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,h,m){for(let x=0;x<this.attributes.length;x++){const b=this.attributes[x],E=h.getAttributeLocation(s,b.name);E!==-1&&s.vertexAttribPointer(E,b.components,s[tT[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(s,h,m){for(let x=0;x<this.attributes.length;x++){const b=h.getAttributeLocation(s,this.attributes[x].name);b!==-1&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(b,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Dg{constructor(s,h,m,x,b){this.context=s,this.width=h,this.height=m;const E=this.framebuffer=s.gl.createFramebuffer();x&&(this.colorAttachment=new Y2(s,E)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new K2(s,E):new OI(s,E))}destroy(){const s=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&s.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&s.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&s.deleteTexture(h)}s.deleteFramebuffer(this.framebuffer)}}class vx{constructor(s,h){this.gl=s,this.clearColor=new $2(this),this.clearDepth=new Kv(this),this.clearStencil=new EI(this),this.colorMask=new AI(this),this.depthMask=new CI(this),this.stencilMask=new PI(this),this.stencilFunc=new V2(this),this.stencilOp=new II(this),this.stencilTest=new gg(this),this.depthRange=new kI(this),this.depthTest=new W2(this),this.depthFunc=new Jv(this),this.blend=new _g(this),this.blendFunc=new Qv(this),this.blendColor=new Uh(this),this.blendEquation=new ld(this),this.cullFace=new yg(this),this.cullFaceSide=new vg(this),this.frontFace=new cd(this),this.program=new G2(this),this.activeTexture=new ex(this),this.viewport=new H2(this),this.bindFramebuffer=new ud(this),this.bindRenderbuffer=new xg(this),this.bindTexture=new wg(this),this.bindVertexBuffer=new tx(this),this.bindElementBuffer=new bg(this),this.bindVertexArrayOES=new lm(this),this.pixelStoreUnpack=new q2(this),this.pixelStoreUnpackPremultiplyAlpha=new X2(this),this.pixelStoreUnpackFlipY=new Z2(this),this.options=h?Object.assign({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=h&&!!h.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,h,m){return new ju(this,s,h,m)}createVertexBuffer(s,h,m,x,b){return new jI(this,s,h,m,x,b)}createRenderbuffer(s,h,m){const x=this.gl,b=x.createRenderbuffer();return this.bindRenderbuffer.set(b),x.renderbufferStorage(x.RENDERBUFFER,s,h,m),this.bindRenderbuffer.set(null),b}createFramebuffer(s,h,m,x){return new Dg(this,s,h,m,x)}clear({color:s,depth:h,stencil:m,colorMask:x}){const b=this.gl;let E=0;s&&(E|=b.COLOR_BUFFER_BIT,this.clearColor.set(s.toNonPremultipliedRenderColor(null)),this.colorMask.set(x||[!0,!0,!0,!0])),h!==void 0&&(E|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),m!==void 0&&(E|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),b.clear(E)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.by(s.blendFunction,Zr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ic;function fm(g,s,h,m,x,b,E){const P=g.context,M=P.gl,B=g.transform,j=[i.aF(B.center.lng),i.aJ(B.center.lat)],X=h.layout.get("symbol-placement"),W=h.layout.get("text-variable-anchor"),Y=h.layout.get("icon-rotation-alignment")==="map",ee=h.layout.get("text-rotation-alignment")==="map",te=X!=="point",ce=[];let oe=0,de=0;for(let Oe=0;Oe<m.length;Oe++){const Le=m[Oe],ct=s.getTile(Le),Ke=ct.getBucket(h);if(!Ke)continue;const vt=Ke.getProjection().createInversionMatrix(B,Le.canonical),st=[],_t=M2(Le,Ke,B),Ht=!E&&Y&&te,lt=E&&ee&&te,He=W&&Ke.hasTextData(),Tt=Ke.hasIconTextFit()&&He&&Ke.hasIconData(),ht=Ht||lt||E&&He||Tt,Ft=Ke.projection.name==="globe",Gt=Ft?i.aj(B.zoom):0;Ft&&(st.push("PROJECTION_GLOBE_VIEW"),ht&&st.push("PROJECTED_POS_ON_VIEWPORT"));const tr=g.getOrCreateProgram("collisionBox",{defines:st});let Ut=_t;x[0]===0&&x[1]===0||(Ut=g.translatePosMatrix(_t,ct,x,b));const Bt=E?Ke.textCollisionBox:Ke.iconCollisionBox,vr=Ke.collisionCircleArray;if(vr.length>0){const _r=i.bC(),pr=Ut;i.cO(_r,Ke.placementInvProjMatrix,B.glCoordMatrix),i.cO(_r,_r,Ke.placementViewportMatrix),ce.push({circleArray:vr,circleOffset:de,transform:pr,invTransform:_r,projection:Ke.getProjection()}),oe+=vr.length/4,de=oe}if(!Bt)continue;g.terrain&&g.terrain.setupElevationDraw(ct,tr);const mr=Ft?[Le.canonical.x,Le.canonical.y,1<<Le.canonical.z]:[0,0,0];tr.draw(g,M.LINES,or.disabled,Mr.disabled,g.colorModeForRenderPass(),Lr.disabled,hx(Ut,vt,B,Gt,j,ct,mr,Ke.getProjection()),h.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,null,B.zoom,null,[Bt.collisionVertexBuffer,Bt.collisionVertexBufferExt])}if(!E||!ce.length)return;const xe=g.getOrCreateProgram("collisionCircle"),Ee=new i.dW;Ee.resize(4*oe),Ee._trim();let De=0;for(const Oe of ce)for(let Le=0;Le<Oe.circleArray.length/4;Le++){const ct=4*Le,Ke=Oe.circleArray[ct+0],vt=Oe.circleArray[ct+1],st=Oe.circleArray[ct+2],_t=Oe.circleArray[ct+3];Ee.emplace(De++,Ke,vt,st,_t,0),Ee.emplace(De++,Ke,vt,st,_t,1),Ee.emplace(De++,Ke,vt,st,_t,2),Ee.emplace(De++,Ke,vt,st,_t,3)}(!ic||ic.length<2*oe)&&(ic=function(Oe){const Le=2*Oe,ct=new i.b1;ct.resize(Le),ct._trim();for(let Ke=0;Ke<Le;Ke++){const vt=6*Ke;ct.uint16[vt+0]=4*Ke+0,ct.uint16[vt+1]=4*Ke+1,ct.uint16[vt+2]=4*Ke+2,ct.uint16[vt+3]=4*Ke+2,ct.uint16[vt+4]=4*Ke+3,ct.uint16[vt+5]=4*Ke+0}return ct}(oe));const Me=P.createIndexBuffer(ic,!0),Fe=P.createVertexBuffer(Ee,i.dX.members,!0);for(const Oe of ce){const Le={u_matrix:Oe.transform,u_inv_matrix:Oe.invTransform,u_camera_to_center_distance:(Re=B).getCameraToCenterDistance(Oe.projection),u_viewport_size:[Re.width,Re.height]};xe.draw(g,M.TRIANGLES,or.disabled,Mr.disabled,g.colorModeForRenderPass(),Lr.disabled,Le,h.id,Fe,Me,i.bg.simpleSegment(0,2*Oe.circleOffset,Oe.circleArray.length,Oe.circleArray.length/2),null,B.zoom)}var Re;Fe.destroy(),Me.destroy()}const Uu=i.bC();function xx(g){const s=g._camera.getWorldToCamera(g.worldSize,1),h=i.aB([],s,g.globeMatrix);i.bl(h,h);const m=[0,0,0],x=[0,1,0,0];return i.aC(x,x,h),m[0]=x[0],m[1]=x[1],m[2]=x[2],i.aw(m,m),m}function Fg({width:g,height:s,anchor:h,textOffset:m,textScale:x},b){const{horizontalAlign:E,verticalAlign:P}=i.c0(h),M=-(E-.5)*g,B=-(P-.5)*s,j=i.c1(h,m);return new i.P((M/x+j[0])*b,(B/x+j[1])*b)}function Lg(g,s,h,m,x,b,E,P,M,B){const j=g.text.placedSymbolArray,X=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,Y={},ee=g.getProjection(),te=Fh(E,ee,x),ce=x.elevation,oe=ee.upVectorScale(E.canonical,x.center.lat,x.worldSize).metersToTile;X.clear();for(let de=0;de<j.length;de++){const xe=j.get(de),{tileAnchorX:Ee,tileAnchorY:De,numGlyphs:Me}=xe,Fe=xe.hidden||!xe.crossTileID||g.allowVerticalPlacement&&!xe.placedOrientation?null:m[xe.crossTileID];if(Fe){let Re=0,Oe=0,Le=0;if(ce){const Tt=ce?ce.getAtTileOffset(E,Ee,De):0,[ht,Ft,Gt]=ee.upVector(E.canonical,Ee,De);Re=Tt*ht*oe,Oe=Tt*Ft*oe,Le=Tt*Gt*oe}let[ct,Ke,vt,st]=Bs(xe.projectedAnchorX+Re,xe.projectedAnchorY+Oe,xe.projectedAnchorZ+Le,h?te:b);const _t=Lh(x.getCameraToCenterDistance(ee),st);let Ht=i.bM(g.textSizeData,M,xe)*_t/i.bX;h&&(Ht*=g.tilePixelRatio/P);const lt=Fg(Fe,Ht);h?({x:ct,y:Ke,z:vt}=ee.projectTilePoint(Ee+lt.x,De+lt.y,E.canonical),[ct,Ke,vt]=Bs(ct+Re,Ke+Oe,vt+Le,b)):(s&&lt._rotate(-x.angle),ct+=lt.x,Ke+=lt.y,vt=0);const He=g.allowVerticalPlacement&&xe.placedOrientation===i.bL.vertical?Math.PI/2:0;for(let Tt=0;Tt<Me;Tt++)i.bO(X,ct,Ke,vt,He);B&&xe.associatedIconIndex>=0&&(Y[xe.associatedIconIndex]={x:ct,y:Ke,z:vt,angle:He})}else Ir(Me,X)}if(B){W.clear();const de=g.icon.placedSymbolArray;for(let xe=0;xe<de.length;xe++){const Ee=de.get(xe),{numGlyphs:De}=Ee,Me=Y[xe];if(Ee.hidden||!Me)Ir(De,W);else{const{x:Fe,y:Re,z:Oe,angle:Le}=Me;for(let ct=0;ct<De;ct++)i.bO(W,Fe,Re,Oe,Le)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData(X)}function dm(g,s,h,m,x,b,E={}){const P=h.paint.get("icon-translate"),M=h.paint.get("text-translate"),B=h.paint.get("icon-translate-anchor"),j=h.paint.get("text-translate-anchor"),X=h.layout.get("icon-rotation-alignment"),W=h.layout.get("text-rotation-alignment"),Y=h.layout.get("icon-pitch-alignment"),ee=h.layout.get("text-pitch-alignment"),te=h.layout.get("icon-keep-upright"),ce=h.layout.get("text-keep-upright"),oe=h.paint.get("icon-color-saturation"),de=h.paint.get("icon-color-contrast"),xe=h.paint.get("icon-color-brightness-min"),Ee=h.paint.get("icon-color-brightness-max"),De=h.layout.get("symbol-elevation-reference")==="sea",Me=h.layout.get("icon-image-use-theme")==="none",Fe=g.context,Re=Fe.gl,Oe=g.transform,Le=X==="map",ct=W==="map",Ke=Y==="map",vt=ee==="map",st=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let _t=!1;const Ht=g.depthModeForSublayer(0,or.ReadOnly),lt=new or(g.context.gl.LEQUAL,or.ReadOnly,g.depthRangeFor3D),He=[i.aF(Oe.center.lng),i.aJ(Oe.center.lat)],Tt=h.layout.get("text-variable-anchor"),ht=Oe.projection.name==="globe",Ft=[],Gt=[0,-1,0];for(const tr of m){const Ut=s.getTile(tr),Bt=Ut.getBucket(h);if(!Bt||Bt.projection.name==="mercator"&&ht||Bt.fullyClipped)continue;const vr=Bt.projection.name==="globe",mr=vr?i.aj(Oe.zoom):0,_r=Fh(tr,Bt.getProjection(),Oe),pr=Oe.calculatePixelsToTileUnitsMatrix(Ut),zr=Tt&&Bt.hasTextData(),qr=Bt.hasIconTextFit()&&zr&&Bt.hasIconData(),Jr=Bt.getProjection().createInversionMatrix(Oe,tr.canonical),Rn=(1<<Ut.tileID.canonical.z)*i.al/g.transform.worldSize,$r=pi=>{let Qr=[0,0,0];if(pi){const Rr=g.style.directionalLight,Dn=g.style.ambientLight;Rr&&Dn&&(Qr=Pl(g.style,Rr,Dn))}return Qr},vn=pi=>{Oe.depthOcclusionForSymbolsAndCircles&&(h.hasOcclusionOpacityProperties||g.terrain)&&(pi.push("DEPTH_D24"),pi.push("DEPTH_OCCLUSION"))},In=pi=>{h.lut&&!Me&&(h.lut.texture||(h.lut.texture=new i.dY(g.context,h.lut.image,[h.lut.image.height,h.lut.image.height,h.lut.image.height],Fe.gl.RGBA8)),Fe.activeTexture.set(Fe.gl.TEXTURE0+aa.LUT),h.lut.texture&&h.lut.texture.bind(Fe.gl.LINEAR,Fe.gl.CLAMP_TO_EDGE),pi.push("APPLY_LUT_ON_GPU"))},ui=()=>{const pi=Le&&h.layout.get("symbol-placement")!=="point",Qr=[];vn(Qr),In(Qr);const Rr=pi||qr,Dn=Bt.elevationType==="road",ki=g.shadowRenderer,vi=Dn&&Ke&&!!ki&&ki.enabled,oa=$r(vi),qa=Dn&&Ke&&!g.terrain?lt:Ht,Ws=h.paint.get("icon-image-cross-fade");g.terrainRenderModeElevated()&&Ke&&Qr.push("PITCH_WITH_MAP_TERRAIN"),vr&&(Qr.push("PROJECTION_GLOBE_VIEW"),Rr&&Qr.push("PROJECTED_POS_ON_VIEWPORT")),Ws>0&&Bt.hasAnySecondaryIcon&&Qr.push("ICON_TRANSITION"),!Bt.icon.zOffsetVertexBuffer||Dn&&g.terrain||Qr.push("Z_OFFSET"),oe===0&&de===0&&xe===0&&Ee===1||Qr.push("COLOR_ADJUSTMENT"),Bt.sdfIcons&&Qr.push("RENDER_SDF"),vi&&Qr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Dn&&Ke&&!g.terrain&&Bt.icon.orientationVertexBuffer&&Qr.push("ELEVATED_ROADS");const Gs=Bt.icon.programConfigurations.get(h.id),ps=g.getOrCreateProgram("symbol",{config:Gs,defines:Qr}),ms=Ut.imageAtlasTexture?Ut.imageAtlasTexture.size:[0,0],Vo=Bt.iconSizeData,ol=i.bK(Vo,Oe.zoom),Ml=Ke||!Oe.isOrthographic,Fi=El(_r,Ut.tileID.canonical,Ke,Le,Oe,Bt.getProjection(),pr),$i=eg(_r,Ut.tileID.canonical,Ke,Le,Oe,Bt.getProjection(),pr),xi=g.translatePosMatrix($i,Ut,P,B,!0),ga=g.translatePosMatrix(_r,Ut,P,B),Na=Rr?Uu:Fi,qi=Le&&!Ke&&!pi;let ho=Gt;!ht&&!Oe.mercatorFromTransition||Le||(ho=xx(Oe));const lc=vr?ho:Gt,qc=h.getColorAdjustmentMatrix(oe,de,xe,Ee),Rl=_x(Vo.kind,ol,qi,Ke,g,ga,Na,xi,De,!1,ms,[0,0],0,tr,mr,He,Jr,lc,Bt.getProjection(),oa,Rn,qc,Ws,null),Yu=Ut.imageAtlasTexture?Ut.imageAtlasTexture:null,Ku=h.layout.get("icon-size").constantOr(0)!==1||Bt.iconsNeedLinear,cc=Bt.sdfIcons||g.options.rotating||g.options.zooming||Ku||Ml?Re.LINEAR:Re.NEAREST,Ed=Bt.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,Xc=g.terrain&&Ke&&pi?i.bl(i.bC(),Fi):Uu;if(pi&&Bt.icon){const uc=Oe.elevation,Zc=uc?uc.getAtTileOffsetFunc(tr,Oe.center.lat,Oe.worldSize,Bt.getProjection()):null,n_=Yp(_r,Ut.tileID.canonical,Ke,Le,Oe,Bt.getProjection(),pr);zv(Bt,_r,g,!1,n_,$i,Ke,te,Zc,tr)}return{program:ps,buffers:Bt.icon,uniformValues:Rl,atlasTexture:Yu,atlasTextureIcon:null,atlasInterpolation:cc,atlasInterpolationIcon:null,isSDF:Bt.sdfIcons,hasHalo:Ed,depthMode:qa,tile:Ut,renderWithShadows:vi,labelPlaneMatrixInv:Xc}},Xr=()=>{const pi=ct&&h.layout.get("symbol-placement")!=="point",Qr=[],Rr=pi||Tt||qr,Dn=Bt.elevationType==="road",ki=g.shadowRenderer,vi=Dn&&vt&&!!ki&&ki.enabled,oa=$r(vi),qa=Dn&&vt&&!g.terrain?lt:Ht;g.terrainRenderModeElevated()&&vt&&Qr.push("PITCH_WITH_MAP_TERRAIN"),vr&&(Qr.push("PROJECTION_GLOBE_VIEW"),Rr&&Qr.push("PROJECTED_POS_ON_VIEWPORT")),!Bt.text.zOffsetVertexBuffer||Dn&&g.terrain||Qr.push("Z_OFFSET"),Bt.iconsInText&&Qr.push("RENDER_TEXT_AND_SYMBOL"),Qr.push("RENDER_SDF"),vi&&Qr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Dn&&vt&&!g.terrain&&Bt.text.orientationVertexBuffer&&Qr.push("ELEVATED_ROADS"),vn(Qr);const Ws=Bt.text.programConfigurations.get(h.id),Gs=g.getOrCreateProgram("symbol",{config:Ws,defines:Qr});let ps,ms=[0,0],Vo=null;const ol=Bt.textSizeData;Bt.iconsInText&&(ms=Ut.imageAtlasTexture?Ut.imageAtlasTexture.size:[0,0],Vo=Ut.imageAtlasTexture?Ut.imageAtlasTexture:null,ps=vt||!Oe.isOrthographic||g.options.rotating||g.options.zooming||ol.kind==="composite"||ol.kind==="camera"?Re.LINEAR:Re.NEAREST);const Ml=Ut.glyphAtlasTexture?Ut.glyphAtlasTexture.size:[0,0],Fi=h.layout.get("text-size-scale-range"),$i=i.aA(g.scaleFactor,Fi[0],Fi[1]),xi=i.bK(ol,Oe.zoom,$i),ga=El(_r,Ut.tileID.canonical,vt,ct,Oe,Bt.getProjection(),pr),Na=eg(_r,Ut.tileID.canonical,vt,ct,Oe,Bt.getProjection(),pr),qi=g.translatePosMatrix(Na,Ut,M,j,!0),ho=g.translatePosMatrix(_r,Ut,M,j),lc=Rr?Uu:ga,qc=ct&&!vt&&!pi;let Rl=Gt;!ht&&!Oe.mercatorFromTransition||ct||(Rl=xx(Oe));const Yu=_x(ol.kind,xi,qc,vt,g,ho,lc,qi,De,!0,Ml,ms,0,tr,mr,He,Jr,vr?Rl:Gt,Bt.getProjection(),oa,Rn,null,null,$i),Ku=Ut.glyphAtlasTexture?Ut.glyphAtlasTexture:null,cc=Re.LINEAR,Ed=h.paint.get("text-halo-width").constantOr(1)!==0,Xc=g.terrain&&vt&&pi?i.bl(i.bC(),ga):Uu;if(pi&&Bt.text){const uc=Oe.elevation,Zc=uc?uc.getAtTileOffsetFunc(tr,Oe.center.lat,Oe.worldSize,Bt.getProjection()):null,n_=Yp(_r,Ut.tileID.canonical,vt,ct,Oe,Bt.getProjection(),pr);zv(Bt,_r,g,!0,n_,Na,vt,ce,Zc,tr)}return{program:Gs,buffers:Bt.text,uniformValues:Yu,atlasTexture:Ku,atlasTextureIcon:Vo,atlasInterpolation:cc,atlasInterpolationIcon:ps,isSDF:!0,hasHalo:Ed,depthMode:qa,tile:Ut,renderWithShadows:vi,labelPlaneMatrixInv:Xc}},Tn=Bt.icon.segments.get().length,wn=Bt.text.segments.get().length,Cn=Tn&&!E.onlyText?ui():null,di=wn&&!E.onlyIcons?Xr():null,Ui=h.paint.get("icon-opacity").constantOr(1),La=h.paint.get("text-opacity").constantOr(1);if(st&&Bt.canOverlap){_t=!0;const pi=Ui&&!E.onlyText?Bt.icon.segments.get():[],Qr=La&&!E.onlyIcons?Bt.text.segments.get():[];for(const Rr of pi)Ft.push({segments:new i.bg([Rr]),sortKey:Rr.sortKey,state:Cn});for(const Rr of Qr)Ft.push({segments:new i.bg([Rr]),sortKey:Rr.sortKey,state:di})}else E.onlyText||Ft.push({segments:Ui?Bt.icon.segments:new i.bg([]),sortKey:0,state:Cn}),E.onlyIcons||Ft.push({segments:La?Bt.text.segments:new i.bg([]),sortKey:0,state:di})}_t&&Ft.sort((tr,Ut)=>tr.sortKey-Ut.sortKey);for(const tr of Ft){const Ut=tr.state;if(Ut)if(g.terrain?g.terrain.setupElevationDraw(Ut.tile,Ut.program,{useDepthForOcclusion:Oe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ut.labelPlaneMatrixInv}):g.setupDepthForOcclusion(Oe.depthOcclusionForSymbolsAndCircles,Ut.program),Fe.activeTexture.set(Re.TEXTURE0),Ut.atlasTexture&&Ut.atlasTexture.bind(Ut.atlasInterpolation,Re.CLAMP_TO_EDGE,!0),Ut.atlasTextureIcon&&(Fe.activeTexture.set(Re.TEXTURE1),Ut.atlasTextureIcon&&Ut.atlasTextureIcon.bind(Ut.atlasInterpolationIcon,Re.CLAMP_TO_EDGE,!0)),Ut.renderWithShadows&&g.shadowRenderer.setupShadows(Ut.tile.tileID.toUnwrapped(),Ut.program,"vector-tile"),g.uploadCommonLightUniforms(g.context,Ut.program),Ut.hasHalo){const Bt=Ut.uniformValues;Bt.u_is_halo=1,Ng(Ut.buffers,tr.segments,h,g,Ut.program,Ut.depthMode,x,b,Bt,2),Bt.u_is_halo=0}else{if(Ut.isSDF){const Bt=Ut.uniformValues;Ut.hasHalo&&(Bt.u_is_halo=1,Ng(Ut.buffers,tr.segments,h,g,Ut.program,Ut.depthMode,x,b,Bt,1)),Bt.u_is_halo=0}Ng(Ut.buffers,tr.segments,h,g,Ut.program,Ut.depthMode,x,b,Ut.uniformValues,1)}}}function Ng(g,s,h,m,x,b,E,P,M,B){const j=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer,g.orientationVertexBuffer];x.draw(m,m.context.gl.TRIANGLES,b,E,P,Lr.disabled,M,h.id,g.layoutVertexBuffer,g.indexBuffer,s,h.paint,m.transform.zoom,g.programConfigurations.get(h.id),j,B)}function rT(g,s){const h=1<<g.canonical.z,m=(s.x*h-g.canonical.x-g.wrap*h)*i.al,x=(s.y*h-g.canonical.y)*i.al,b=i.e5(s.z,s.y);return i.d4(m,x,b)}function qh(g,s,h,m,x){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const b=g.context.gl,E=new or(g.context.gl.LEQUAL,or.ReadWrite,g.depthRangeFor3D),P=new or(g.context.gl.GREATER,or.ReadWrite,g.depthRangeFor3D),M=function(Y){let ee=.01;return Y.isOrthographic&&(ee=i.ak(1e-4,ee,i.c$(Y.pitch>=$c?1:Y.pitch/$c))),2*ee}(g.transform),B=g.transform.getFreeCameraOptions().position,j="elevatedStructuresDepthReconstruct",X=g.getOrCreateProgram(j,{defines:["DEPTH_RECONSTRUCTION"]}),W=g.getOrCreateProgram(j);for(const Y of m){const ee=s.getTile(Y),te=ee.getBucket(h);if(!te)continue;const ce=te.elevatedStructures;if(!ce)continue;const oe=te.elevationBufferData.heightRange,de=rT(Y.toUnwrapped(),B),xe=g.translatePosMatrix(Y.projMatrix,ee,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));let Ee,De,Me,Fe;if(x==="initialize"){if(!oe||oe.min>=1||ce.depthSegments.segments[0].primitiveLength===0)continue;Ee=Pg(xe,de,M,1,0),De=E,Me=ce.depthSegments,Fe=X}else if(x==="reset"){if(!oe||oe.min>=0||ce.maskSegments.segments[0].primitiveLength===0)continue;Ee=Pg(xe,de,0,0,1),De=P,Me=ce.maskSegments,Fe=X}else if(x==="geometry"){if(ce.depthSegments.segments[0].primitiveLength===0)continue;Ee=Pg(xe,de,M,1,0),De=E,Me=ce.depthSegments,Fe=W}Fe.draw(g,b.TRIANGLES,De,Mr.disabled,Zr.disabled,Lr.disabled,Ee,h.id,ce.vertexBuffer,ce.indexBuffer,Me,h.paint,g.transform.zoom)}}function pd(g,s,h){const{painter:m,sourceCache:x,layer:b,coords:E,colorMode:P,elevationType:M,terrainEnabled:B,pass:j}=g,X=m.context.gl,W=b.paint.get("fill-pattern"),Y=b.paint.get("fill-pattern-cross-fade"),ee=W.constantOr(null);let te=M;M!=="road"||s&&!B||(te="none");const ce=te==="road",oe=g.painter.shadowRenderer,de=ce&&!!oe&&oe.enabled,xe=new or(m.context.gl.LEQUAL,or.ReadOnly,m.depthRangeFor3D);let Ee=[0,0,0];if(de){const Fe=m.style.directionalLight,Re=m.style.ambientLight;Fe&&Re&&(Ee=Pl(m.style,Fe,Re))}const De=W&&W.constantOr(1),Me=(Fe,Re)=>{let Oe,Le,ct,Ke,vt;Re?(Oe=De&&!b.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ct=X.LINES):(Oe=De?"fillPattern":"fill",ct=X.TRIANGLES);for(const st of E){const _t=x.getTile(st);if(De&&!_t.patternsLoaded())continue;const Ht=_t.getBucket(b);if(!Ht)continue;const lt=s?Ht.elevationBufferData:Ht.bufferData;if(lt.isEmpty())continue;m.prepareDrawTile();const He=lt.programConfigurations.get(b.id),Tt=m.isTileAffectedByFog(st),ht=[],Ft=[];ce&&(ht.push("ELEVATED_ROADS"),Ft.push(lt.elevatedLayoutVertexBuffer)),de&&ht.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),De&&(m.context.activeTexture.set(X.TEXTURE0),_t.imageAtlasTexture&&_t.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),He.updatePaintBuffers());let Gt=!1;if(ee&&_t.imageAtlas){const mr=_t.imageAtlas,_r=i.e0.from(ee),pr=_r.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),zr=_r.getSecondary(),qr=mr.patternPositions.get(pr),Jr=zr?mr.patternPositions.get(zr.scaleSelf(i.o.devicePixelRatio).toString()):null;Gt=!!qr&&!!Jr,qr&&He.setConstantPatternPositions(qr,Jr)}Y>0&&(Gt||He.getPatternTransitionVertexBuffer("fill-pattern"))&&ht.push("FILL_PATTERN_TRANSITION");const tr=m.getOrCreateProgram(Oe,{config:He,overrideFog:Tt,defines:ht}),Ut=m.translatePosMatrix(st.projMatrix,_t,b.paint.get("fill-translate"),b.paint.get("fill-translate-anchor"));de&&oe.setupShadows(_t.tileID.toUnwrapped(),tr,"vector-tile");const Bt=b.paint.get("fill-emissive-strength");if(Re){Ke=lt.lineIndexBuffer,vt=lt.lineSegments;const mr=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[X.drawingBufferWidth,X.drawingBufferHeight];Le=Oe==="fillOutlinePattern"&&De?FI(Ut,Bt,m,_t,mr,Ee,Y):DI(Ut,Bt,mr,Ee)}else Ke=lt.indexBuffer,vt=lt.triangleSegments,Le=De?Wh(Ut,Bt,m,_t,Ee,Y):cx(Ut,Bt,Ee);m.uploadCommonUniforms(m.context,tr,st.toUnwrapped());let vr=Fe;(M==="road"&&!B||M==="offset")&&(vr=xe),tr.draw(m,ct,vr,h||m.stencilModeForClipping(st),P,Lr.disabled,Le,b.id,lt.layoutVertexBuffer,Ke,vt,b.paint,m.transform.zoom,He,Ft)}};m.renderPass===j&&Me(m.depthModeForSublayer(1,m.renderPass==="opaque"?or.ReadWrite:or.ReadOnly),!1),te==="none"&&m.renderPass==="translucent"&&b.paint.get("fill-antialias")&&Me(m.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,or.ReadOnly),!0)}function sr(g,s,h,m,x,b,E,P){h.resetLayerRenderingStats(g);const M=g.context,B=M.gl,j=g.transform,X=h.paint.get("fill-extrusion-pattern"),W=h.paint.get("fill-extrusion-pattern-cross-fade"),Y=X.constantOr(null),ee=X.constantOr(1),te=h.paint.get("fill-extrusion-opacity"),ce=g.style.enable3dLights(),oe=h.paint.get(ce&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),de=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe],xe=h.layout.get("fill-extrusion-edge-radius"),Ee=xe>0&&!h.paint.get("fill-extrusion-rounded-roof"),De=Ee?0:xe,Me=j.projection.name==="globe"?i.e8():0,Fe=j.projection.name==="globe",Re=Fe?i.aj(j.zoom):0,Oe=[i.aF(j.center.lng),i.aJ(j.center.lat)],Le=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ct=h.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Le?null:h.lut).toArray01().slice(0,3),Ke=h.paint.get("fill-extrusion-flood-light-intensity"),vt=h.paint.get("fill-extrusion-vertical-scale"),st=h.paint.get("fill-extrusion-line-width").constantOr(1)!==0,_t=h.paint.get("fill-extrusion-height-alignment"),Ht=h.paint.get("fill-extrusion-base-alignment"),lt=Fu(g,h.paint.get("fill-extrusion-cutoff-fade-range")),He=[];let Tt;Fe&&He.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&He.push("FAUX_AO"),Ee&&He.push("ZERO_ROOF_RADIUS"),P&&He.push("HAS_CENTROID"),Ke>0&&He.push("FLOOD_LIGHT"),lt.shouldRenderCutoff&&He.push("RENDER_CUTOFF"),st&&He.push("RENDER_WALL_MODE");const ht=g.renderPass==="shadow",Ft=g.shadowRenderer,Gt=ht&&!!Ft,tr=ht?Lr.disabled:Lr.backCCW;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Ut=[0,0,0];if(Ft){const mr=g.style.directionalLight,_r=g.style.ambientLight;mr&&_r&&(Ut=Pl(g.style,mr,_r)),ht||(He.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Ft.useNormalOffset&&He.push("NORMAL_OFFSET")),Tt=He.concat(["SHADOWS_SINGLE_CASCADE"])}const Bt=Gt?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",vr=h.getLayerRenderingStats();for(const mr of m){const _r=s.getTile(mr),pr=_r.getBucket(h);if(!pr||pr.projection.name!==j.projection.name)continue;let zr=!1;Ft&&(zr=Ft.getMaxCascadeForTile(mr.toUnwrapped())===0);const qr=g.isTileAffectedByFog(mr),Jr=pr.programConfigurations.get(h.id);let Rn=!1;if(Y&&_r.imageAtlas){const wn=_r.imageAtlas,Cn=i.e0.from(Y),di=Cn.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),Ui=Cn.getSecondary(),La=wn.patternPositions.get(di),pi=Ui?wn.patternPositions.get(Ui.scaleSelf(i.o.devicePixelRatio).toString()):null;Rn=!!La&&!!pi,La&&Jr.setConstantPatternPositions(La,pi)}W>0&&(Rn||Jr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&He.push("FILL_EXTRUSION_PATTERN_TRANSITION");const $r=g.getOrCreateProgram(Bt,{config:Jr,defines:zr?Tt:He,overrideFog:qr});if(g.terrain&&g.terrain.setupElevationDraw(_r,$r,{useMeterToDem:!0}),!pr.centroidVertexBuffer){const wn=$r.getAttributeLocation(B,"a_centroid_pos");wn!==-1&&B.vertexAttrib2f(wn,0,0)}!ht&&Ft&&Ft.setupShadows(_r.tileID.toUnwrapped(),$r,"vector-tile"),ee&&(g.context.activeTexture.set(B.TEXTURE0),_r.imageAtlasTexture&&_r.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Jr.updatePaintBuffers());const vn=h.paint.get("fill-extrusion-vertical-gradient"),In=1/pr.tileToMeter;let ui;if(ht&&Ft){if(nT(_r.tileID,pr.maxHeight,g))continue;const wn=Ft.calculateShadowPassMatrixFromTile(_r.tileID.toUnwrapped());ui=lx(wn,De,In,vt,_t,Ht)}else{const wn=g.translatePosMatrix(mr.expandedProjMatrix,_r,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Cn=j.projection.createInversionMatrix(j,mr.canonical);ui=ee?Q2(wn,g,vn,te,de,De,In,mr,_r,Me,_t,Ht,Re,Oe,Cn,ct,vt,W):hm(wn,g,vn,te,de,De,In,mr,Me,_t,Ht,Re,Oe,Cn,ct,vt,Ke,Ut)}g.uploadCommonUniforms(M,$r,mr.toUnwrapped(),null,lt);let Xr=pr.segments;if(j.projection.name==="mercator"&&!ht&&(Xr=pr.getVisibleSegments(_r.tileID,g.terrain,g.transform.getFrustum(0)),!Xr.get().length))continue;if(vr)if(ht)for(const wn of Xr.get())vr.numRenderedVerticesInShadowPass+=wn.primitiveLength;else for(const wn of Xr.get())vr.numRenderedVerticesInTransparentPass+=wn.primitiveLength;const Tn=[];(g.terrain||P)&&Tn.push(pr.centroidVertexBuffer),Fe&&Tn.push(pr.layoutVertexExtBuffer),st&&Tn.push(pr.wallVertexBuffer),$r.draw(g,M.gl.TRIANGLES,x,b,E,tr,ui,h.id,pr.layoutVertexBuffer,pr.indexBuffer,Xr,h.paint,g.transform.zoom,Jr,Tn)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}class wx{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function Vc(g,s,h,m,x,b,E,P,M,B,j,X,W,Y,ee,te,ce,oe,de,xe){const Ee=s.context,De=Ee.gl,Me=s.transform,Fe=s.transform.zoom,Re=[],Oe=g.translate,Le=g.translateAnchor,ct=g.edgeRadius,Ke=Fu(s,g.cutoffFadeRange);j==="clear"?(Re.push("CLEAR_SUBPASS"),xe&&(Re.push("CLEAR_FROM_TEXTURE"),Ee.activeTexture.set(De.TEXTURE0),xe.bind(De.LINEAR,De.CLAMP_TO_EDGE))):j==="sdf"&&Re.push("SDF_SUBPASS"),oe&&Re.push("HAS_CENTROID"),Ke.shouldRenderCutoff&&Re.push("RENDER_CUTOFF");const vt=(st,_t,Ht,lt,He)=>{const Tt=_t.programConfigurations.get(m.id),ht=s.isTileAffectedByFog(st),Ft=s.getOrCreateProgram("fillExtrusionGroundEffect",{config:Tt,defines:Re,overrideFog:ht}),Gt=((Ut,Bt,vr,mr,_r,pr,zr,qr,Jr,Rn,$r)=>({u_matrix:Bt,u_opacity:vr,u_ao_pass:mr?1:0,u_meter_to_tile:_r,u_ao:pr,u_flood_light_intensity:zr,u_flood_light_color:qr,u_attenuation:Jr,u_edge_radius:Rn,u_fb:0,u_fb_size:$r,u_dynamic_offset:1}))(0,lt,X,B,He,[W,Y*He],ee,te,ce,Fe>=17?0:ct*He,xe?xe.size[0]:0),tr=[];oe&&tr.push(_t.hiddenByLandmarkVertexBuffer),s.uploadCommonUniforms(Ee,Ft,st.toUnwrapped(),null,Ke),Ft.draw(s,Ee.gl.TRIANGLES,b,E,P,M,Gt,m.id,_t.vertexBuffer,_t.indexBuffer,Ht,m.paint,Fe,Tt,tr)};for(const st of x){const _t=h.getTile(st),Ht=_t.getBucket(m);if(!Ht||Ht.projection.name!==Me.projection.name||!Ht.groundEffect||Ht.groundEffect&&!Ht.groundEffect.hasData())continue;const lt=Ht.groundEffect,He=1/Ht.tileToMeter;{const Tt=s.translatePosMatrix(st.projMatrix,_t,Oe,Le),ht=lt.getDefaultSegment();vt(st,lt,ht,Tt,He)}if(de)for(let Tt=0;Tt<4;Tt++){const ht=i.e6[Tt](st),Ft=h.getTile(ht);if(!Ft)continue;const Gt=Ft.getBucket(m);if(!Gt||Gt.projection.name!==Me.projection.name||!Gt.groundEffect||Gt.groundEffect&&!Gt.groundEffect.hasData())continue;const tr=Gt.groundEffect;let Ut,Bt;Tt===0?(Ut=[-i.al,0,0],Bt=1):Tt===1?(Ut=[i.al,0,0],Bt=0):Tt===2?(Ut=[0,-i.al,0],Bt=3):(Ut=[0,i.al,0],Bt=2);const vr=tr.regionSegments[Bt];if(!vr)continue;const mr=new Float32Array(16);i.br(mr,st.projMatrix,Ut),vt(st,tr,vr,s.translatePosMatrix(mr,_t,Oe,Le),He)}}}function $u(g,s,h,m,x,b,E){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const P=b?b.findDEMTileFor(h):null;if(!(P&&P.dem||E))return;b&&P&&P.dem&&m.selfDEMTileTimestamp!==P.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=P.dem._timestamp);const M=oe=>new i.P(Math.ceil((oe+i.ea)*i.eb),0),B=oe=>{const de=s.getSource().minzoom,xe=De=>{const Me=s.getTileByID(De);if(Me&&Me.hasData())return Me.getBucket(x)},Ee=[0,-1,1];for(const De of Ee){if(oe.overscaledZ+De<de)continue;const Me=xe(oe.calculateScaledKey(oe.overscaledZ+De));if(Me)return Me}},j=[0,0,0],X=(oe,de)=>(j[0]=Math.min(oe.min.y,de.min.y),j[1]=Math.max(oe.max.y,de.max.y),j[2]=i.al-de.min.x>oe.max.x?de.min.x-i.al:oe.max.x,j),W=(oe,de)=>(j[0]=Math.min(oe.min.x,de.min.x),j[1]=Math.max(oe.max.x,de.max.x),j[2]=i.al-de.min.y>oe.max.y?de.min.y-i.al:oe.max.y,j),Y=[(oe,de)=>X(oe,de),(oe,de)=>X(de,oe),(oe,de)=>W(oe,de),(oe,de)=>W(de,oe)],ee=(oe,de,xe,Ee,De,Me,Fe)=>{if(!b)return 0;const Re=[[Me?xe:oe,Me?oe:xe,0],[Me?xe:de,Me?de:xe,0]],Oe=Fe<0?i.al+Fe:Fe,Le=[Me?Oe:(oe+de)/2,Me?(oe+de)/2:Oe,0];return xe===0&&Fe<0||xe!==0&&Fe>0?b.getForTilePoints(De,[Le],!0,Ee):Re.push(Le),b.getForTilePoints(h,Re,!0,P),Math.max(Re[0][2],Re[1][2],Le[2])/b.exaggeration()};for(let oe=0;oe<4;oe++){const de=m.borderFeatureIndices[oe];if(de.length===0)continue;const xe=i.e6[oe](h),Ee=B(xe);if(!(Ee&&Ee instanceof i.e7))continue;const De=b?b.findDEMTileFor(xe):null;if(!(De&&De.dem||E)||(b&&De&&De.dem&&m.borderDEMTileTimestamp[oe]!==De.dem._timestamp&&(m.borderDoneWithNeighborZ[oe]=-1,m.borderDEMTileTimestamp[oe]=De.dem._timestamp),m.borderDoneWithNeighborZ[oe]===Ee.canonical.z))continue;Ee.centroidVertexArray.length===0&&Ee.createCentroidsBuffer();const Me=(oe<2?1:5)-oe,Fe=Ee.borderDoneWithNeighborZ[Me]!==m.canonical.z,Re=Ee.borderFeatureIndices[Me];let Oe=0;if(m.canonical.z!==Ee.canonical.z){for(const Le of de)m.showCentroid(m.featuresOnBorder[Le]);if(Fe)for(const Le of Re)Ee.showCentroid(Ee.featuresOnBorder[Le]);m.borderDoneWithNeighborZ[oe]=Ee.canonical.z,Ee.borderDoneWithNeighborZ[Me]=m.canonical.z}for(const Le of de){const ct=m.featuresOnBorder[Le],Ke=m.centroidData[ct.centroidDataIndex],vt=ct.borders[oe];let st;for(;Oe<Re.length;){st=Ee.featuresOnBorder[Re[Oe]];const _t=st.borders[Me];if(_t[1]>vt[0]+3||_t[0]>vt[0]-3)break;Ee.showCentroid(st),Oe++}if(st&&Oe<Re.length){const _t=Oe;let Ht=0;for(;!(st.borders[Me][0]>vt[1]-3)&&(Ht++,++Oe!==Re.length);)st=Ee.featuresOnBorder[Re[Oe]];st=Ee.featuresOnBorder[Re[_t]];let lt=!1;if(Ht>=1){const ht=st.borders[Me];Math.abs(vt[0]-ht[0])<3&&Math.abs(vt[1]-ht[1])<3&&(Ht=1,lt=!0,Oe=_t+1)}else if(Ht===0){m.showCentroid(ct);continue}const He=Ee.centroidData[st.centroidDataIndex];E&&lt&&(((te=Ke).flags|(ce=He).flags)&i.e9?(te.flags|=i.e9,ce.flags|=i.e9):(te.flags&=~i.e9,ce.flags&=~i.e9));const Tt=ct.intersectsCount()>1||st.intersectsCount()>1;if(Ht>1)Oe=_t,Ke.centroidXY=He.centroidXY=new i.P(0,0);else if(De&&De.dem&&!Tt){const ht=Y[oe](Ke,He),Ft=oe%2?i.al-1:0,Gt=ee(ht[0],Math.min(i.al-1,ht[1]),Ft,De,xe,oe<2,ht[2]);Ke.centroidXY=He.centroidXY=M(Gt)}else Tt?Ke.centroidXY=He.centroidXY=new i.P(0,0):(Ke.centroidXY=m.encodeBorderCentroid(ct),He.centroidXY=Ee.encodeBorderCentroid(st));m.writeCentroidToBuffer(Ke),Ee.writeCentroidToBuffer(He)}else m.showCentroid(ct)}m.borderDoneWithNeighborZ[oe]=Ee.canonical.z,Ee.borderDoneWithNeighborZ[Me]=m.canonical.z}var te,ce;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(g)}const Vu=[1,0,0],Pr=[0,1,0],bx=[0,0,1];function nT(g,s,h){const m=h.transform,x=h.shadowRenderer;if(!x)return!0;const b=g.toUnwrapped(),E=m.tileSize*x._cascades[h.currentShadowCascade].scale;let P=s;if(m.elevation){const te=m.elevation.getMinMaxForTile(g);te&&(P+=te.max)}const M=[...x.shadowDirection];M[2]=-M[2];const B=x.computeSimplifiedTileShadowVolume(b,P,E,M);if(!B)return!1;const j=[Vu,Pr,bx,M,[M[0],0,M[2]],[0,M[1],M[2]]],X=m.projection.name==="globe",W=m.scaleZoom(E),Y=i.cA.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,W,!X),ee=x.getCurrentCascadeFrustum();return Y.intersectsPrecise(B.vertices,B.planes,j)===0||ee.intersectsPrecise(B.vertices,B.planes,j)===0}function Bg(g){const{painter:s,source:h,layer:m,coords:x}=g;let b=g.defines;const E=s.context,P=s.renderPass==="shadow",M=s.renderPass==="light-beam",B=s.shadowRenderer,j=i.ec(s.transform.center.lat,s.transform.zoom),X=Fu(s,m.paint.get("building-cutoff-fade-range"));X.shouldRenderCutoff&&(b=b.concat("RENDER_CUTOFF"));for(const W of x){const Y=h.getTile(W),ee=Y.getBucket(m);if(!ee)continue;B&&B.getMaxCascadeForTile(W.toUnwrapped())===0&&(b=b.concat("SHADOWS_SINGLE_CASCADE"));const te=ee.programConfigurations.get(m.id);let ce,oe,de,xe=s.translatePosMatrix(W.expandedProjMatrix,Y,[0,0],"map");if(xe=i.cR(i.bC(),xe,[1,1,g.verticalScale]),P&&B){if(nT(Y.tileID,ee.maxHeight*j,s))continue;let De=B.calculateShadowPassMatrixFromTile(Y.tileID.toUnwrapped());De=i.cR(i.bC(),De,[1,1,g.verticalScale]),de=ux(De),ce=oe=s.getOrCreateProgram("buildingDepth",{config:te,defines:b,overrideFog:!1})}else if(M)ce=oe=s.getOrCreateProgram("buildingBloom",{config:te,defines:b,overrideFog:!1}),de=BI(xe);else{const De=s.transform.calculatePosMatrix(W.toUnwrapped(),s.transform.worldSize);i.cR(De,De,[1,1,g.verticalScale]);const Me=i.bC();i.cR(Me,De,[1,-1,1/j]),i.bl(Me,Me),i.ed(Me,Me);const Fe=s.transform.getFreeCameraOptions().position,Re=1<<W.canonical.z;de=NI(xe,Me,g.opacity,g.facadeAOIntensity,[((Fe.x-W.wrap)*Re-W.canonical.x)*i.al,(Fe.y*Re-W.canonical.y)*i.al,Fe.z*Re*i.al],ee.tileToMeter,g.facadeEmissiveChance),oe=s.getOrCreateProgram("building",{config:te,defines:b,overrideFog:!1});const Oe=b.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ce=s.getOrCreateProgram("building",{config:te,defines:Oe,overrideFog:!1}),B&&(B.setupShadowsFromMatrix(De,oe,!0),B.setupShadowsFromMatrix(De,ce,!0))}const Ee=(De,Me)=>{if(M){const Fe=De.entranceBloom;Me.draw(s,E.gl.TRIANGLES,g.depthMode,Mr.disabled,g.blendMode,Lr.disabled,de,m.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segmentsBucket,m.paint,s.transform.zoom,te,[Fe.layoutAttenuationBuffer,Fe.layoutColorBuffer])}else{const Fe=De.segmentsBucket;let Re=[De.layoutNormalBuffer,De.layoutCentroidBuffer,De.layoutColorBuffer];De.layoutFacadePaintBuffer&&(Re=Re.concat([De.layoutFacadeDataBuffer,De.layoutFacadeVerticalRangeBuffer,De.layoutFacadePaintBuffer])),Me.draw(s,E.gl.TRIANGLES,g.depthMode,Mr.disabled,g.blendMode,P?Lr.disabled:Lr.backCW,de,m.id,De.layoutVertexBuffer,De.indexBuffer,Fe,m.paint,s.transform.zoom,te,Re)}};s.uploadCommonUniforms(E,oe,W.toUnwrapped(),null,X),ee.buildingWithoutFacade&&Ee(ee.buildingWithoutFacade,oe),ce!==oe&&s.uploadCommonUniforms(E,ce,W.toUnwrapped(),null,X),ee.buildingWithFacade&&Ee(ee.buildingWithFacade,ce)}}function zg(g){return[g[0]*i.ee,g[1]*i.ee,g[2]*i.ee,0]}function jg(g,s,h,m,x,b,E,P,M){const B=m.getSource(),j=h.globeSharedBuffers;if(!j)return;let X,W,Y;if(s&&(X=m.getTile(s)),B instanceof i.aS?(W=B.texture,Y=i.dG(0,0,h.transform)):X&&s&&(W=X.texture,Y=i.dG(s.canonical.z,s.canonical.x,h.transform)),!W||!Y)return;g||(Y=i.cR(i.bC(),Y,[1,-1,1]));const ee=h.context,te=ee.gl,ce=x.paint.get("raster-resampling")==="nearest"?te.NEAREST:te.LINEAR,oe=h.colorModeForDrapableLayerRenderPass(b),de=E.defines;de.push("GLOBE_POLES");const xe=new or(te.LEQUAL,or.ReadWrite,h.depthRangeFor3D),Ee=Float32Array.from(h.transform.expandedFarZProjMatrix),De=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),ee.activeTexture.set(te.TEXTURE0),W.bind(ce,te.CLAMP_TO_EDGE),ee.activeTexture.set(te.TEXTURE1),W.bind(ce,te.CLAMP_TO_EDGE),"useMipmap"in W&&ee.extTextureFilterAnisotropic&&h.transform.pitch>20&&te.texParameterf(te.TEXTURE_2D,ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ee.extTextureFilterAnisotropicMax);const[Me,Fe,Re,Oe]=s?j.getPoleBuffers(s.canonical.z,!1):j.getPoleBuffers(0,!0),Le=x.paint.get("raster-elevation");let ct;g?(ct=Me,h.renderDefaultNorthPole=Le!==0):(ct=Fe,h.renderDefaultSouthPole=Le!==0);const Ke=zg(E.mix),vt=((_t,Ht,lt,He,Tt,ht,Ft,Gt,tr,Ut,Bt,vr,mr)=>Ig(_t,Ht,lt,new Float32Array(16),new Float32Array(9),[0,0],He,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ht,[0,0],Gt,2,Ut,Bt,vr,1,0,mr))(Ee,De,Y,i.aj(h.transform.zoom),0,x,0,Le,0,Ke,E.offset,E.range,b),st=h.getOrCreateProgram("raster",{defines:de});h.uploadCommonUniforms(ee,st,null),st.draw(h,te.TRIANGLES,xe,M,oe,P,vt,x.id,ct,Re,Oe)}function UI(g){const s=g._nearZ,h=g.projection.farthestPixelDistance(g),m=h-s,x=.2*g.height,b=s+x;return[s,h,(b-x-s)/m,(b-s)/m]}function iT(g,s,h,m){if(g)return s instanceof Iu&&g instanceof qp?s.getTextureDescriptor(g,h,!0):{texture:g.texture,mix:zg(m.mix),offset:m.offset,buffer:0,tileSize:1}}var $I=i.ef([{name:"a_index",type:"Int16",components:1}]);class VI{constructor(s,h,m,x){const b={width:m[0],height:m[1],data:null},E=s.gl;this.targetColorTexture=new i.T(s,b,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,b,E.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(h,x),this.lastInvalidatedAt=0}updateParticleTexture(s,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,x=h.width*h.height;this.particleTexture0=new i.T(this.context,h,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,h,m.RGBA8,{premultiply:!1,useMipmap:!1});const b=new i.eg;b.reserve(x);for(let E=0;E<x;E++)b.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(b,$I.members,!0),this.particleSegment=i.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function ds(g,s,h){if(!g)return null;const m=s.getTextureDescriptor(g,h,!0);if(!m)return null;let{texture:x,mix:b,offset:E,tileSize:P,buffer:M,format:B}=m;if(!x||!B)return null;let j=!1;return B==="uint32"&&(j=!0,b[3]=0,b=dx(i.eh,b,[0,h.paint.get("raster-particle-max-speed")]),E=px(i.eh,E,[0,h.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[M/(P+2*M),P/(P+2*M)],tileSize:P,scalarData:j,scale:b,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[B]]}}function Tx(g){const s=g._nearZ,h=g.projection.farthestPixelDistance(g),m=h-s,x=.2*g.height,b=s+x;return[s,h,(b-x-s)/m,(b-s)/m]}const $o=new i.ao(1,0,0,1),Wu=new i.ao(0,1,0,1),aT=new i.ao(0,0,1,1),Sx=new i.ao(1,0,1,1),Ex=new i.ao(0,1,1,1);function Ug(g,s,h,m,x,b){for(let E=0;E<h.length;E++)if(x){const B=new i.ao(m.r*.8,m.g*.8,m.b*.8,1);Xh(g,s,h[E],m,-1,-1,b),Xh(g,s,h[E],m,-1,1,b),Xh(g,s,h[E],m,1,1,b),Xh(g,s,h[E],m,1,-1,b),Xh(g,s,h[E],B,0,0,b)}else Xh(g,s,h[E],m,0,0,b)}function Xh(g,s,h,m,x,b,E){const P=g.context,M=g.transform,B=P.gl,j=M.projection.name==="globe",X=j?["PROJECTION_GLOBE_VIEW"]:[];let W=i.bz(h.projMatrix);if(j&&i.aj(M.zoom)>0){const Ke=i.bj(h.canonical,M),vt=i.ei(Ke);W=i.aB(new Float32Array(16),M.globeMatrix,vt),i.aB(W,M.projMatrix,W)}const Y=i.bC();Y[12]+=2*x/(i.o.devicePixelRatio*M.width),Y[13]+=2*b/(i.o.devicePixelRatio*M.height),i.aB(W,Y,W);const ee=g.getOrCreateProgram("debug",{defines:X}),te=s.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw(te,ee);const ce=or.disabled,oe=Mr.disabled,de=g.colorModeForRenderPass(),xe="$debug";P.activeTexture.set(B.TEXTURE0),g.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),j?te._makeGlobeTileDebugBuffers(g.context,M):te._makeDebugTileBoundsBuffers(g.context,M.projection);const Ee=te._tileDebugBuffer||g.debugBuffer,De=te._tileDebugIndexBuffer||g.debugIndexBuffer,Me=te._tileDebugSegments||g.debugSegments;if(ee.draw(g,B.LINE_STRIP,ce,oe,de,Lr.disabled,fx(W,m.toPremultipliedRenderColor(null)),xe,Ee,De,Me,null,null,null,[te._globeTileDebugBorderBuffer]),E){const Ke=te.latestRawTileData,vt=Math.floor((Ke&&Ke.byteLength||0)/1024);let st=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(st+=` => ${h.overscaledZ}`),st+=` ${te.state}`,st+=` ${vt}kb`,function(_t,Ht){_t.initDebugOverlayCanvas();const lt=_t.debugOverlayCanvas,He=_t.context.gl,Tt=_t.debugOverlayCanvas.getContext("2d");Tt.clearRect(0,0,lt.width,lt.height),Tt.shadowColor="white",Tt.shadowBlur=2,Tt.lineWidth=1.5,Tt.strokeStyle="white",Tt.textBaseline="top",Tt.font="bold 36px Open Sans, sans-serif",Tt.fillText(Ht,5,5),Tt.strokeText(Ht,5,5),_t.debugOverlayTexture.update(lt),_t.debugOverlayTexture.bind(He.LINEAR,He.CLAMP_TO_EDGE)}(g,st)}const Fe=s.getTile(h).tileSize,Re=512/Math.min(Fe,512)*(h.overscaledZ/M.zoom)*.5,Oe=te._tileDebugTextBuffer||g.debugBuffer,Le=te._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,ct=te._tileDebugTextSegments||g.debugSegments;ee.draw(g,B.TRIANGLES,ce,oe,Zr.alphaBlended,Lr.disabled,fx(W,i.ao.transparent.toPremultipliedRenderColor(null),Re),xe,Oe,Le,ct,null,null,null,[te._globeTileDebugTextBuffer])}function ac(g,s,h,m){Zh(g,0,s+h/2,g.transform.width,h,m)}function Kn(g,s,h,m){Zh(g,s-h/2,0,h,g.transform.height,m)}function Zh(g,s,h,m,x,b){const E=g.context,P=E.gl;P.enable(P.SCISSOR_TEST),P.scissor(s*i.o.devicePixelRatio,h*i.o.devicePixelRatio,m*i.o.devicePixelRatio,x*i.o.devicePixelRatio),E.clear({color:b}),P.disable(P.SCISSOR_TEST)}const Ax=i.ef([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:oT}=Ax;function Wc(g,s,h,m){g.emplaceBack(s,h,m)}class Cx{constructor(s){this.vertexArray=new i.ej,this.indices=new i.b1,Wc(this.vertexArray,-1,-1,1),Wc(this.vertexArray,1,-1,1),Wc(this.vertexArray,-1,1,1),Wc(this.vertexArray,1,1,1),Wc(this.vertexArray,-1,-1,-1),Wc(this.vertexArray,1,-1,-1),Wc(this.vertexArray,-1,1,-1),Wc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,oT),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.bg.simpleSegment(0,0,36,12)}}function Yh(g,s,h,m,x,b){const E=g.context.gl,P=s.paint.get("sky-atmosphere-color"),M=s.paint.get("sky-atmosphere-halo-color"),B=s.paint.get("sky-atmosphere-sun-intensity"),j=((X,W,Y,ee,te)=>({u_matrix_3f:X,u_sun_direction:W,u_sun_intensity:Y,u_color_tint_r:[ee.r,ee.g,ee.b,ee.a],u_color_tint_m:[te.r,te.g,te.b,te.a],u_luminance:5e-5}))(i.el(i.dL(),m),x,B,P.toPremultipliedRenderColor(null),M.toPremultipliedRenderColor(null));E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+b,s.skyboxTexture,0),h.draw(g,E.TRIANGLES,or.disabled,Mr.disabled,Zr.unblended,Lr.frontCW,j,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const Kh=i.ef([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Jh{constructor(s){const h=new i.em;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const m=new i.b1;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(h,Kh.members),this.indexBuffer=s.createIndexBuffer(m),this.segments=i.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Wt=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class er{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class md{constructor(s){this.colorModeAlphaBlendedWriteRGB=new Zr([1,rs,1,rs],i.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Zr([1,0,1,0],i.ao.transparent,[!1,!1,!1,!0]),this.params=new er,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const h=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Jh(h);const m=this.params.sizeRange,x=this.params.intensityRange,b=function(j){const X=i.eo(30),W=[];for(let Y=0;Y<j;++Y){const ee=2*Math.PI*X(),te=Math.acos(1-2*X())-.5*Math.PI;W.push(i.d4(Math.cos(te)*Math.cos(ee),Math.cos(te)*Math.sin(ee),Math.sin(te)))}return W}(this.params.starsCount),E=i.eo(300),P=new i.en,M=new i.b1;let B=0;for(let j=0;j<b.length;++j){const X=i.c4([],b[j],200),W=Math.max(0,1+.01*m*(1*E()-.5)),Y=Math.max(0,1+.01*x*(1*E()-.5));P.emplaceBack(X[0],X[1],X[2],-1,-1,W,Y),P.emplaceBack(X[0],X[1],X[2],1,-1,W,Y),P.emplaceBack(X[0],X[1],X[2],1,1,W,Y),P.emplaceBack(X[0],X[1],X[2],-1,1,W,Y),M.emplaceBack(B+0,B+1,B+2),M.emplaceBack(B+0,B+2,B+3),B+=4}this.starsVx=h.createVertexBuffer(P,Wt.members),this.starsIdx=h.createIndexBuffer(M),this.starsSegments=i.bg.simpleSegment(0,0,P.length,M.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,h){const m=s.context,x=m.gl,b=s.transform,E=new or(x.LEQUAL,or.ReadOnly,[0,1]),P=i.aj(b.zoom),M=s.style.getLut(h.scope),B=h.properties.get("color-use-theme")==="none",j=h.properties.get("color").toNonPremultipliedRenderColor(B?null:M),X=h.properties.get("high-color-use-theme")==="none",W=h.properties.get("high-color").toNonPremultipliedRenderColor(X?null:M),Y=h.properties.get("space-color-use-theme")==="none",ee=h.properties.get("space-color").toNonPremultipliedRenderColor(Y?null:M),te=5e-4,ce=i.ep(h.properties.get("horizon-blend"),0,1,te,.25),oe=i.dA(s,m,b)&&ce===te?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,de=s.frameCounter/1e3%1,xe=i.ag(b.globeCenterInViewSpace),Ee=Math.sqrt(Math.pow(xe,2)-Math.pow(oe,2)),De=Math.acos(Ee/xe),Me=Fe=>{const Re=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Fe&&Re.push("ALPHA_PASS");const Oe=s.getOrCreateProgram("globeAtmosphere",{defines:Re}),Le=((Ke,vt,st,_t,Ht,lt,He,Tt,ht,Ft,Gt,tr)=>({u_frustum_tl:Ke,u_frustum_tr:vt,u_frustum_br:st,u_frustum_bl:_t,u_horizon:Ht,u_transition:lt,u_fadeout_range:He,u_atmosphere_fog_color:Tt.toArray01(),u_high_color:ht.toArray01(),u_space_color:Ft.toArray01(),u_temporal_offset:Gt,u_horizon_angle:tr}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,P,ce,j,W,ee,de,De);s.uploadCommonUniforms(m,Oe);const ct=this.atmosphereBuffer;ct&&Oe.draw(s,x.TRIANGLES,E,Mr.disabled,Fe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Lr.backCW,Le,Fe?"atmosphere_glow_alpha":"atmosphere_glow",ct.vertexBuffer,ct.indexBuffer,ct.segments)};Me(!1),Me(!0)}drawStars(s,h){const m=i.aA(h.properties.get("star-intensity"),0,1);if(m===0)return;const x=s.context,b=x.gl,E=s.transform,P=s.getOrCreateProgram("stars"),M=i.c6([]);i.c8(M,M,-E._pitch),i.c7(M,M,-E.angle),i.c8(M,M,i.an(E._center.lat)),i.eq(M,M,-i.an(E._center.lng));const B=i.cb(new Float32Array(16),M),j=i.aB([],E.starsProjMatrix,B),X=i.el([],B),W=i.er([],X),Y=[0,1,0];i.dN(Y,Y,W),i.c4(Y,Y,this.params.sizeMultiplier);const ee=[1,0,0];i.dN(ee,ee,W),i.c4(ee,ee,this.params.sizeMultiplier);const te=(ce=Y,oe=ee,de=m,{u_matrix:Float32Array.from(j),u_up:ce,u_right:oe,u_intensity_multiplier:de});var ce,oe,de;s.uploadCommonUniforms(x,P),this.starsVx&&this.starsIdx&&P.draw(s,b.TRIANGLES,or.disabled,Mr.disabled,this.colorModeAlphaBlendedWriteRGB,Lr.disabled,te,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Ii{constructor(){this.visibleTiles=[]}updateBorders(s,h){const m=[],x=[],b=s._getRenderableCoordinates(!1,!0);for(const M of b){const B=s.getTile(M);if(!B.hasData())continue;const j=B.getBucket(h);j&&(j.isEmpty()||(m.push(M.key),x.push({bucket:j,tileID:M.canonical})))}let E=m.length!==this.visibleTiles.length;if(!E){m.sort();for(let M=0;M<m.length;M++)if(m[M]!==this.visibleTiles[M]){E=!0;break}}if(!E)return;const P=new Set;this.visibleTiles=m,x.sort((M,B)=>M.tileID.z-B.tileID.z||M.tileID.x-B.tileID.x||M.tileID.y-B.tileID.y);for(const M of x){const B=new Array,j=new Array,X=M.bucket;for(const W of X.featuresOnBorder)P.has(W.featureId)?j.push(W.footprintIndex):(P.add(W.featureId),B.push(W.footprintIndex));X.updateFootprintHiddenFlags(B,i.es,!1),X.updateFootprintHiddenFlags(j,i.es,!0)}}}function rt(g,s){const h=[...g],m=s.cameraWorldSizeForFog/s.worldSize,x=i.bA([]);return i.cR(x,x,[m,m,1]),i.aB(h,x,h),i.aB(h,s.worldToFogMatrix,h),h}function $g(g,s,h,m,x){const b=h.material,E=m.context,{baseColorTexture:P,metallicRoughnessTexture:M}=b.pbrMetallicRoughness,{normalTexture:B,occlusionTexture:j,emissionTexture:X}=b;function W(ee,te,ce){if(ee&&(g.push(te),E.activeTexture.set(E.gl.TEXTURE0+ce),ee.gfxTexture)){const{minFilter:oe,magFilter:de,wrapS:xe,wrapT:Ee}=ee.sampler;ee.gfxTexture.bindExtraParam(oe,de,xe,Ee)}}W(P,"HAS_TEXTURE_u_baseColorTexture",aa.BaseColor),W(M,"HAS_TEXTURE_u_metallicRoughnessTexture",aa.MetallicRoughness),W(B,"HAS_TEXTURE_u_normalTexture",aa.Normal),W(j,"HAS_TEXTURE_u_occlusionTexture",aa.Occlusion),W(X,"HAS_TEXTURE_u_emissionTexture",aa.Emission),x&&(x.texture||(x.texture=new i.dY(m.context,x.image,[x.image.height,x.image.height,x.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+aa.LUT),x.texture&&x.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(h.texcoordBuffer)),h.colorBuffer&&(g.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(h.colorBuffer)),h.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(h.normalBuffer)),h.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(h.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||g.push("DIFFUSE_SHADED");const Y=m.shadowRenderer;Y&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&g.push("NORMAL_OFFSET"))}function Qh(g,s,h,m,x,b){const E=h.paint.get("model-opacity").constantOr(1),P=s.context,M=new or(s.context.gl.LEQUAL,or.ReadWrite,s.depthRangeFor3D),B=s.transform,j=g.mesh,X=j.material,W=X.pbrMetallicRoughness,Y=s.style.fog;let ee;ee=s.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.aB([],m.zScaleMatrix,g.nodeModelMatrix),i.aB(ee,m.negCameraPosMatrix,ee);const te=i.bl([],ee);i.ed(te,te);const ce=h.paint.get("model-color-use-theme").constantOr("default")==="none",oe=h.paint.get("model-emissive-strength").constantOr(0),de=Rg(new Float32Array(g.worldViewProjection),new Float32Array(ee),new Float32Array(te),null,s,E,W.baseColorFactor,X.emissiveFactor,W.metallicFactor,W.roughnessFactor,X,oe,h),xe={defines:[]},Ee=[],De=s.shadowRenderer;De&&(De.useNormalOffset=!1),$g(xe.defines,Ee,j,s,ce?null:h.lut);let Me=null;if(Y){const Oe=rt(g.nodeModelMatrix,s.transform);if(Me=new Float32Array(Oe),B.projection.name!=="globe"){const Le=j.aabb.min,ct=j.aabb.max,[Ke,vt]=Y.getOpacityForBounds(Oe,Le[0],Le[1],ct[0],ct[1]);xe.overrideFog=Ke>=ot||vt>=ot}}const Fe=Fu(s,h.paint.get("model-cutoff-fade-range"));Fe.shouldRenderCutoff&&xe.defines.push("RENDER_CUTOFF");const Re=s.getOrCreateProgram("model",xe);s.uploadCommonUniforms(P,Re,null,Me,Fe),s.renderPass!=="shadow"&&De&&De.setupShadowsFromMatrix(g.nodeModelMatrix,Re),Re.draw(s,P.gl.TRIANGLES,M,x,b,j.material.doubleSided?Lr.disabled:Lr.backCCW,de,h.id,j.vertexBuffer,j.indexBuffer,j.segments,h.paint,s.transform.zoom,void 0,Ee)}function Vg(g,s,h,m,x,b,E){let P;P=g.projection.name==="globe"?i.eu(h,g):[...h],i.aB(P,P,s.matrix);const M=i.aB([],m,P);if(s.meshes)for(const B of s.meshes){if(B.material.alphaMode!=="BLEND"){E.push({mesh:B,depth:0,modelIndex:x,worldViewProjection:M,nodeModelMatrix:P});continue}const j=i.af([],B.centroid,M);!g.isOrthographic&&j[2]<=0||b.push({mesh:B,depth:j[2],modelIndex:x,worldViewProjection:M,nodeModelMatrix:P})}if(s.children)for(const B of s.children)Vg(g,B,h,m,x,b,E)}function pm(g,s,h,m){const x=h.shadowRenderer;if(!x)return;const b=x.getShadowPassDepthMode(),E=x.getShadowPassColorMode(),P=x.calculateShadowPassMatrixFromMatrix(s),M=dd(P);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,b,Mr.disabled,E,Lr.backCCW,M,m.id,g.vertexBuffer,g.indexBuffer,g.segments,m.paint,h.transform.zoom,void 0,void 0)}function sT(g,s,h){const m=s.updateZoomBasedPaintProperties(),x=function(b,E,P){let M,B,j,X=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&X>0){const W=b.terrain,Y=W.findDEMTileFor(P);Y&&Y.dem?M=i.ew.create(W,P,Y):X=0}if(X===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),X===E.validForExaggeration&&(X===0||M&&M._demTile&&M._demTile.tileID===E.validForDEMTile.id&&M._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const W in E.instancesPerModel){const Y=E.instancesPerModel[W];for(let ee=0;ee<Y.instancedDataArray.length;++ee){const te=(M?X*M.getElevationAt(0|Y.instancedDataArray.float32[16*ee],0|Y.instancedDataArray.float32[16*ee+1],!0,!0):0)+Y.instancesEvaluatedElevation[ee];Y.instancedDataArray.float32[16*ee+6]=te,B=B?Math.min(E.terrainElevationMin,te):te,j=j?Math.max(E.terrainElevationMax,te):te}}return E.terrainElevationMin=B||0,E.terrainElevationMax=j||0,E.validForExaggeration=X,E.validForDEMTile=M&&M._demTile?{id:M._demTile.tileID,timestamp:M._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,s,h);(m||x)&&(s.uploaded=!1,s.upload(g.context))}const Il={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.d8([0,0,0],[i.al,i.al,0])};function gd(g,s){const h=1<<g.canonical.z,m=s.getFreeCameraOptions().position,x=s.elevation,b=g.canonical.x/h,E=(g.canonical.x+1)/h,P=g.canonical.y/h,M=(g.canonical.y+1)/h;let B=s._centerAltitude;if(x){const Y=x.getMinMaxForTile(g);Y&&Y.max>B&&(B=Y.max)}const j=i.aA(m.x,b,E)-m.x,X=i.aA(m.y,P,M)-m.y,W=i.ce(B,s.center.lat)-m.z;return s._zoomFromMercatorZ(Math.sqrt(j*j+X*X+W*W))}function lT(g,s,h,m,x,b,E){const P=g.context,M=g.renderPass==="shadow",B=g.shadowRenderer,j=M&&B?B.getShadowPassDepthMode():new or(P.gl.LEQUAL,or.ReadWrite,g.depthRangeFor3D),X=g.isTileAffectedByFog(b);if(h.meshes)for(const W of h.meshes){const Y=["MODEL_POSITION_ON_GPU"],ee=[];let te,ce,oe;m.instancedDataArray.length>20&&Y.push("INSTANCED_ARRAYS");const de=Fu(g,s.paint.get("model-cutoff-fade-range"));if(de.shouldRenderCutoff&&Y.push("RENDER_CUTOFF"),M&&B)te=g.getOrCreateProgram("modelDepth",{defines:Y}),ce=dd(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(h.matrix)),oe=B.getShadowPassColorMode();else{$g(Y,ee,W,g,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),te=g.getOrCreateProgram("model",{defines:Y,overrideFog:X});const Ee=W.material,De=Ee.pbrMetallicRoughness,Me=s.paint.get("model-opacity").constantOr(1),Fe=s.paint.get("model-emissive-strength").constantOr(0);ce=Rg(b.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,g,Me,De.baseColorFactor,Ee.emissiveFactor,De.metallicFactor,De.roughnessFactor,Ee,Fe,s,x),B&&(E.shadowUniformsInitialized?te.setShadowUniformValues(P,B.getShadowUniformValues()):(B.setupShadows(b.toUnwrapped(),te,"model-tile"),E.shadowUniformsInitialized=!0)),oe=de.shouldRenderCutoff||Me<1||Ee.alphaMode!=="OPAQUE"?Zr.alphaBlended:Zr.unblended}g.uploadCommonUniforms(P,te,b.toUnwrapped(),null,de);const xe=W.material.doubleSided?Lr.disabled:Lr.backCCW;if(m.instancedDataArray.length>20)ee.push(m.instancedDataBuffer),te.draw(g,P.gl.TRIANGLES,j,Mr.disabled,oe,xe,ce,s.id,W.vertexBuffer,W.indexBuffer,W.segments,s.paint,g.transform.zoom,void 0,ee,m.instancedDataArray.length);else{const Ee=M?"u_instance":"u_normal_matrix";for(let De=0;De<m.instancedDataArray.length;++De)ce[Ee]=new Float32Array(m.instancedDataArray.arrayBuffer,64*De,16),te.draw(g,P.gl.TRIANGLES,j,Mr.disabled,oe,xe,ce,s.id,W.vertexBuffer,W.indexBuffer,W.segments,s.paint,g.transform.zoom,void 0,ee)}}if(h.children)for(const W of h.children)lT(g,s,W,m,x,b,E)}const WI=[1,-1,1];function cT(g,s,h,m){if(!h.modelManager)return!0;const x=h.modelManager;if(!h.shadowRenderer)return!0;const b=h.shadowRenderer,E=s.aabb;let P=!0,M=g.maxHeight;if(M===0){let j=0;for(const X in g.instancesPerModel){const W=x.getModel(X,m);W?j=Math.max(j,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):P=!1}M=g.maxScale*j*1.41+g.maxVerticalOffset,P&&(g.maxHeight=M)}E.max[2]=M,E.min[2]+=g.terrainElevationMin,E.max[2]+=g.terrainElevationMax,i.af(E.min,E.min,s.tileMatrix),i.af(E.max,E.max,s.tileMatrix);const B=E.intersects(b.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=B===2),B===0}function Wg(g,s){const h=g.uniformValues.u_cutoff_params[0],m=g.uniformValues.u_cutoff_params[1],x=g.uniformValues.u_cutoff_params[2],b=g.uniformValues.u_cutoff_params[3];return m===h||b===x?1:i.aA(((s-h)/(m-h)-x)/(b-x),0,1)}function Px(g,s,h,m){if(s.pitch<20)return 1;const x=s.getWorldToCameraMatrix();i.aB(x,x,g);const b=i.bU(h.min[0],h.min[1],h.min[2],1);let E=i.aC(i.ex(),b,x),P=E,M=E;b[1]=h.max[1],E=i.aC(i.ex(),b,x),P=E[1]<P[1]?E:P,M=E[1]>M[1]?E:M,b[0]=h.max[0],E=i.aC(i.ex(),b,x),P=E[1]<P[1]?E:P,M=E[1]>M[1]?E:M,b[1]=h.min[1],E=i.aC(i.ex(),b,x),P=E[1]<P[1]?E:P,M=E[1]>M[1]?E:M;const B=i.aA(m[0],0,1),j=100*s.pixelsPerMeter*i.aA(m[1],0,1),X=i.aA(m[2],0,1),W=i.ey(i.ex(),P,M,B),Y=Math.tan(.5*s.fovX),ee=-W[2]*Y;if(j===0)return W[1]<-Math.abs(ee)?X:1;const te=(-Math.abs(ee)-W[1])/j,ce=(de,xe,Ee)=>(1-Ee)*de+Ee*xe,oe=i.aA(ce(1,X,te),X,1);return ce(1,oe,i.aA((s.pitch-20)/20,0,1))}class uT{}class hT{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,h,m){{const X=this._storage.get(h.id);if(X)return X.lastUsedFrameIdx=s,X.buf}const x=m.gl,b=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),E=new ArrayBuffer(b),P=new Int16Array(E);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const M=new i.eA;for(let X=0;X<b/2;X+=3){const W=P[X],Y=P[X+1],ee=P[X+2];M.emplaceBack(W,Y),M.emplaceBack(Y,ee),M.emplaceBack(ee,W)}const B=m.bindVertexArrayOES.current,j=new uT;return j.buf=new ju(m,M),j.lastUsedFrameIdx=s,this._storage.set(h.id,j),m.bindVertexArrayOES.set(B),j.buf}update(s){for(const[h,m]of this._storage)s-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(h))}destroy(){for(const[s,h]of this._storage)h.buf.destroy(),this._storage.delete(s)}}class Gg{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const mm=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class _d{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Ix{constructor(s,h){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...h,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...h,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const fT=i.ef([{type:"Float32",name:"a_pos_2f",components:2}]);class GI{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,h){const m=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new i.eB,P=new i.b1;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),P.emplaceBack(0,1,2),P.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(E,fT.members),this.vignetteIdx=s.context.createIndexBuffer(P)}const x=i.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,m);const E={u_vignetteShape:(b={vignetteShape:[h.start,h.range,Math.pow(10,h.fadePower)],vignetteColor:[h.color.r,h.color.g,h.color.b,h.color.a*h.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};m.draw(s,s.context.gl.TRIANGLES,or.disabled,Mr.disabled,Zr.alphaBlended,Lr.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,x)}var b}}class dT{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,h){const m=s.getFreeCameraOptions().position,x=m.toAltitude(),b=m.toLngLat(),E=i.an(b.lng),P=i.an(b.lat),M=s.pixelsPerMeter/h,B=E*i.eD,j=i.eD*Math.log(Math.tan(Math.PI/4+P/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+j,W=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+B)*M,this._accumulatedOffsetY+=X*M,this._accumulatedElevation+=W*M,this._offsetXPrev=B,this._offsetYPrev=j,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function pT(g,s){return[-(g[0]-Math.floor(g[0]/s)*s),-(g[1]-Math.floor(g[1]/s)*s),-(g[2]-Math.floor(g[2]/s)*s)]}function Po(g){const s=i.eo(1323123451230),h=[];for(let m=0;m<g;++m){const x=2*s()-1,b=2*s()-1,E=2*s()-1;h.push(i.d4(x,b,E))}return h}function Gu(g,s,h,m,x){const b=i.aA((x-h)/(m-h),0,1);return(1-b)*g+b*s}class yd{constructor(s){this._movement=new dT,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new GI,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,h){const m=s.transform;this._movement.update(m,this._ppmScaleFactor);const x=m.starsProjMatrix,b=i.c6([]);i.c8(b,b,i.an(90)-m._pitch),i.c7(b,b,-m.angle);const E=i.cb(new Float32Array(16),b),P=i.eC(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),M=i.ed([],P),B=i.aB([],M,E),j=Date.now()/1e3;return this._accumulatedTimeFromStart+=(j-this._prevTime)*h,this._prevTime=j,{projectionMatrix:x,modelviewMatrix:B}}}class ci extends yd{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Ix(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const m=Po(this.particlesCount),x=new i.eE,b=new i.b1;let E=0;const P=i.eo(1323123451230);for(let M=0;M<m.length;++M){const B=m[M],j=[2*P()-1,P(),P(),P()];x.emplaceBack(B[0],B[1],B[2],-1,-1,...j),x.emplaceBack(B[0],B[1],B[2],1,-1,...j),x.emplaceBack(B[0],B[1],B[2],1,1,...j),x.emplaceBack(B[0],B[1],B[2],-1,1,...j),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=h.createVertexBuffer(x,mm.members),this.particlesIdx=h.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const h=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=s.transform.zoom;if(h.revealStart>m)return;const x=Gu(0,1,h.revealStart,h.revealStart+h.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const b=structuredClone(this._params);let E=[-b.direction.x,b.direction.y,-100];i.aw(E,E);const P=structuredClone(this._vignetteParams);P.strength*=x,b.overrideStyleParameters||(b.intensity=s.style.rain.state.density,b.timeFactor=s.style.rain.state.intensity,b.color=structuredClone(s.style.rain.state.color),E=structuredClone(s.style.rain.state.direction),b.screenThinning.intensity=s.style.rain.state.centerThinning,b.dropletSizeX=s.style.rain.state.dropletSize[0],b.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],b.distortionStrength=100*s.style.rain.state.distortionStrength,P.strength=1,P.color=structuredClone(s.style.rain.state.vignetteColor));const M=this.updateOnRender(s,b.timeFactor),B=s.context,j=B.gl,X=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(B,{width:s.width,height:s.height,data:null},j.RGBA8)),b.distortionStrength>0&&(B.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),j.copyTexSubImage2D(j.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const W=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(B,W),B.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Y=[b.color.r,b.color.g,b.color.b,b.color.a],ee=(te,ce)=>{const oe=pT(this._movement.getPosition(),te),de=b.dropletSizeX,xe=b.dropletSizeX*b.dropletSizeYScale,Ee=s.width/2,De=s.height/2,Me=Gu(0,b.screenThinning.start,0,1,b.screenThinning.intensity),Fe=Gu(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),Re=Gu(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),Oe=(Le={modelview:M.modelviewMatrix,projection:M.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:oe,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:te,rainDropletSize:[de,xe],distortionStrength:b.distortionStrength,rainDirection:E,color:Y,screenSize:[X.width,X.height],thinningCenterPos:[Ee,De],thinningShape:[Me,Fe,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:Re,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:ce?0:1},{u_modelview:Float32Array.from(Le.modelview),u_projection:Float32Array.from(Le.projection),u_time:Le.time,u_cam_pos:Le.camPos,u_texScreen:0,u_velocityConeAperture:Le.velocityConeAperture,u_velocity:Le.velocity,u_boxSize:Le.boxSize,u_rainDropletSize:Le.rainDropletSize,u_distortionStrength:Le.distortionStrength,u_rainDirection:Le.rainDirection,u_color:Le.color,u_screenSize:Le.screenSize,u_thinningCenterPos:Le.thinningCenterPos,u_thinningShape:Le.thinningShape,u_thinningAffectedRatio:Le.thinningAffectedRatio,u_thinningParticleOffset:Le.thinningParticleOffset,u_shapeDirectionalPower:Le.shapeDirectionalPower,u_shapeNormalPower:Le.shapeNormalPower,u_mode:Le.mode});var Le;const ct=Math.round(b.intensity*this.particlesCount),Ke=i.bg.simpleSegment(0,0,4*ct,2*ct);W.draw(s,j.TRIANGLES,or.disabled,Mr.disabled,Zr.alphaBlended,Lr.disabled,Oe,"rain_particles",this.particlesVx,this.particlesIdx,Ke)};b.distortionStrength>0&&ee(b.boxSize,!0),ee(b.boxSize,!1),this._vignette.draw(s,P)}}const fn=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class mT extends yd{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Ix(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const m=Po(this.particlesCount),x=new i.eF,b=new i.b1;let E=0;const P=i.eo(1323123451230);for(let M=0;M<m.length;++M){const B=m[M],j=P(),X=P(),W=P(),Y=[M/m.length,j,X,W],ee=[P(),P()];x.emplaceBack(B[0],B[1],B[2],-1,-1,...Y,...ee),x.emplaceBack(B[0],B[1],B[2],1,-1,...Y,...ee),x.emplaceBack(B[0],B[1],B[2],1,1,...Y,...ee),x.emplaceBack(B[0],B[1],B[2],-1,1,...Y,...ee),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=h.createVertexBuffer(x,fn.members),this.particlesIdx=h.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const h=structuredClone(this._params);let m=[-h.direction.x,h.direction.y,-100];i.aw(m,m);const x=structuredClone(this._vignetteParams),b=h.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=s.transform.zoom;if(b.revealStart>E)return;const P=Gu(0,1,b.revealStart,b.revealStart+b.revealRange,E);x.strength*=P,h.overrideStyleParameters||(h.intensity=s.style.snow.state.density,h.timeFactor=s.style.snow.state.intensity,h.color=structuredClone(s.style.snow.state.color),m=structuredClone(s.style.snow.state.direction),h.screenThinning.intensity=s.style.snow.state.centerThinning,h.billboardSize=2.79*s.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(s.style.snow.state.vignetteColor));const M=this.updateOnRender(s,h.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const B=s.context,j=B.gl,X=s.transform,W=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(B,W),((Y,ee,te)=>{const ce=pT(this._movement.getPosition(),Y),oe=X.width/2,de=X.height/2,xe=Gu(0,te.screenThinning.start,0,1,te.screenThinning.intensity),Ee=Gu(.001,te.screenThinning.range,0,1,te.screenThinning.intensity),De=Gu(0,te.screenThinning.particleOffset,0,1,te.screenThinning.intensity),Me=(Fe={modelview:M.modelviewMatrix,projection:M.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ce,velocityConeAperture:te.velocityConeAperture,velocity:te.velocity,horizontalOscillationRadius:te.horizontalOscillationRadius,horizontalOscillationRate:te.horizontalOscillationRate,boxSize:Y,billboardSize:1*te.billboardSize,simpleShapeParameters:[te.shapeFadeStart,te.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[oe,de],thinningShape:[xe,Ee,Math.pow(10,te.screenThinning.fadePower)],thinningAffectedRatio:te.screenThinning.affectedRatio,thinningParticleOffset:De,color:[te.color.r,te.color.g,te.color.b,te.color.a],direction:m},{u_modelview:Float32Array.from(Fe.modelview),u_projection:Float32Array.from(Fe.projection),u_time:Fe.time,u_cam_pos:Fe.camPos,u_velocityConeAperture:Fe.velocityConeAperture,u_velocity:Fe.velocity,u_horizontalOscillationRadius:Fe.horizontalOscillationRadius,u_horizontalOscillationRate:Fe.horizontalOscillationRate,u_boxSize:Fe.boxSize,u_billboardSize:Fe.billboardSize,u_simpleShapeParameters:Fe.simpleShapeParameters,u_screenSize:Fe.screenSize,u_thinningCenterPos:Fe.thinningCenterPos,u_thinningShape:Fe.thinningShape,u_thinningAffectedRatio:Fe.thinningAffectedRatio,u_thinningParticleOffset:Fe.thinningParticleOffset,u_particleColor:Fe.color,u_direction:Fe.direction});var Fe;const Re=Math.round(te.intensity*this.particlesCount),Oe=i.bg.simpleSegment(0,0,4*Re,2*Re);this.particlesVx&&this.particlesIdx&&W.draw(s,j.TRIANGLES,or.disabled,Mr.disabled,Zr.alphaBlended,Lr.disabled,Me,"snow_particles",this.particlesVx,this.particlesIdx,Oe)})(h.boxSize,0,h),this._vignette.draw(s,x)}}const Hu={symbol:function(g,s,h,m,x){if(g.renderPass!=="translucent")return;const b=Mr.disabled,E=g.colorModeForRenderPass(),P=h.layout.get("text-variable-anchor"),M=h.layout.get("text-size-scale-range"),B=i.aA(g.scaleFactor,M[0],M[1]);P&&function(W,Y,ee,te,ce,oe,de,xe){const Ee=Y.transform,De=ce==="map",Me=oe==="map";for(const Fe of W){const Re=te.getTile(Fe),Oe=Re.getBucket(ee);if(!Oe||!Oe.text||!Oe.text.segments.get().length)continue;const Le=i.bK(Oe.textSizeData,Ee.zoom,xe),ct=Fh(Fe,Oe.getProjection(),Ee),Ke=Ee.calculatePixelsToTileUnitsMatrix(Re),vt=El(ct,Re.tileID.canonical,Me,De,Ee,Oe.getProjection(),Ke),st=Oe.hasIconTextFit()&&Oe.hasIconData();Le&&Lg(Oe,De,Me,de,Ee,vt,Fe,Math.pow(2,Ee.zoom-Re.tileID.overscaledZ),Le,st)}}(m,g,h,s,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x,B);const j=h.paint.get("icon-opacity").constantOr(1)!==0,X=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(j||X)?dm(g,s,h,m,b,E):(j&&dm(g,s,h,m,b,E,{onlyIcons:!0}),X&&dm(g,s,h,m,b,E,{onlyText:!0})),s.map.showCollisionBoxes&&(fm(g,s,h,m,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),fm(g,s,h,m,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,s,h,m){if(g.renderPass!=="translucent")return;const x=h.paint.get("circle-opacity"),b=h.paint.get("circle-stroke-width"),E=h.paint.get("circle-stroke-opacity"),P=h.layout.get("circle-sort-key").constantOr(1)!==void 0,M=h.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(b.constantOr(1)===0||E.constantOr(1)===0))return;const B=g.context,j=B.gl,X=g.transform,W=!(!g.terrain||!g.terrain.enabled),Y=h.layout.get("circle-elevation-reference"),ee=g.depthModeForSublayer(0,or.ReadOnly),te=new or(g.context.gl.LEQUAL,or.ReadOnly,g.depthRangeFor3D),ce=Y==="none"||W?ee:te,oe=Mr.disabled,de=g.colorModeForDrapableLayerRenderPass(M),xe=X.projection.name==="globe",Ee=[i.aF(X.center.lng),i.aJ(X.center.lat)],De=[];for(let Fe=0;Fe<m.length;Fe++){const Re=m[Fe],Oe=s.getTile(Re),Le=Oe.getBucket(h);if(!Le||Le.projection.name!==X.projection.name)continue;const ct=Le.programConfigurations.get(h.id),Ke=Le.layoutVertexBuffer,vt=Le.globeExtVertexBuffer,st=Le.indexBuffer,_t=i.dZ(h),Ht=[vt],lt=g.isTileAffectedByFog(Re);xe&&_t.push("PROJECTION_GLOBE_VIEW"),_t.push("DEPTH_D24"),g.terrain&&X.depthOcclusionForSymbolsAndCircles&&_t.push("DEPTH_OCCLUSION"),Le.hasElevation&&!g.terrain&&(_t.push("ELEVATED_ROADS"),Ht.push(Le.elevatedLayoutVertexBuffer));const He=g.getOrCreateProgram("circle",{config:ct,defines:_t,overrideFog:lt}),Tt=X.projection.createInversionMatrix(X,Re.canonical),ht={programConfiguration:ct,program:He,layoutVertexBuffer:Ke,dynamicBuffers:Ht,indexBuffer:st,uniformValues:i.d_(g,Re,Oe,Tt,Ee,h),tile:Oe};if(P){const Ft=Le.segments.get();for(const Gt of Ft)De.push({segments:new i.bg([Gt]),sortKey:Gt.sortKey,state:ht})}else De.push({segments:Le.segments,sortKey:0,state:ht})}P&&De.sort((Fe,Re)=>Fe.sortKey-Re.sortKey);const Me={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Fe of De){const{programConfiguration:Re,program:Oe,layoutVertexBuffer:Le,dynamicBuffers:ct,indexBuffer:Ke,uniformValues:vt,tile:st}=Fe.state,_t=Fe.segments;g.terrain&&g.terrain.setupElevationDraw(st,Oe,Me),g.uploadCommonUniforms(B,Oe,st.tileID.toUnwrapped()),Oe.draw(g,j.TRIANGLES,ce,oe,de,Lr.disabled,vt,h.id,Le,Ke,_t,h.paint,X.zoom,Re,ct)}},heatmap:function(g,s,h,m){if(h.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const x=g.context,b=x.gl,E=Mr.disabled,P=new Zr([b.ONE,b.ONE,b.ONE,b.ONE],i.ao.transparent,[!0,!0,!0,!0]);(function(Y,ee,te,ce){const oe=Y.gl,de=ee.width*ce,xe=ee.height*ce;Y.activeTexture.set(oe.TEXTURE1),Y.viewport.set([0,0,de,xe]);let Ee=te.heatmapFbo;if(!Ee||Ee&&(Ee.width!==de||Ee.height!==xe)){Ee&&Ee.destroy();const De=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,De),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Ee=te.heatmapFbo=Y.createFramebuffer(de,xe,!0,null),function(Me,Fe,Re,Oe,Le,ct){const Ke=Me.gl;Ke.texImage2D(Ke.TEXTURE_2D,0,Me.extRenderToTextureHalfFloat?Ke.RGBA16F:Ke.RGBA,Le,ct,0,Ke.RGBA,Me.extRenderToTextureHalfFloat?Ke.HALF_FLOAT:Ke.UNSIGNED_BYTE,null),Oe.colorAttachment.set(Re)}(Y,0,De,Ee,de,xe)}else oe.bindTexture(oe.TEXTURE_2D,Ee.colorAttachment.get()),Y.bindFramebuffer.set(Ee.framebuffer)})(x,g,h,g.transform.projection.name==="globe"?.5:.25),x.clear({color:i.ao.transparent});const M=g.transform,B=M.projection.name==="globe",j=B?["PROJECTION_GLOBE_VIEW"]:[],X=B?Lr.frontCCW:Lr.disabled,W=[i.aF(M.center.lng),i.aJ(M.center.lat)];for(let Y=0;Y<m.length;Y++){const ee=m[Y];if(s.hasRenderableParent(ee))continue;const te=s.getTile(ee),ce=te.getBucket(h);if(!ce||ce.projection.name!==M.projection.name)continue;const oe=g.isTileAffectedByFog(ee),de=ce.programConfigurations.get(h.id),xe=g.getOrCreateProgram("heatmap",{config:de,defines:j,overrideFog:oe}),{zoom:Ee}=g.transform;g.terrain&&g.terrain.setupElevationDraw(te,xe),g.uploadCommonUniforms(x,xe,ee.toUnwrapped());const De=M.projection.createInversionMatrix(M,ee.canonical);xe.draw(g,b.TRIANGLES,or.disabled,E,P,X,eT(g,ee,te,De,W,Ee,h.paint.get("heatmap-intensity")),h.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,h.paint,g.transform.zoom,de,B?[ce.globeExtVertexBuffer]:null)}x.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(x,b){const E=x.context,P=E.gl,M=b.heatmapFbo;if(!M)return;E.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,M.colorAttachment.get()),E.activeTexture.set(P.TEXTURE1);let B=b.colorRampTexture;B||(B=b.colorRampTexture=new i.T(E,b.colorRamp,P.RGBA8)),B.bind(P.LINEAR,P.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,P.TRIANGLES,or.disabled,Mr.disabled,x.colorModeForRenderPass(),Lr.disabled,((j,X,W,Y)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,b),b.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,b.paint,x.transform.zoom)}(g,h))},line:function(g,s,h,m){if(g.renderPass!=="translucent")return;const x=h.paint.get("line-opacity"),b=h.paint.get("line-width");if(x.constantOr(1)===0||b.constantOr(1)===0)return;const E=h.paint.get("line-emissive-strength"),P=h.paint.get("line-occlusion-opacity"),M=h.layout.get("line-elevation-reference"),B=h.layout.get("line-width-unit")==="meters",j=M==="sea",X=!(!g.terrain||!g.terrain.enabled),W=g.context,Y=W.gl;if(h.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const ee=h.layout.get("line-cross-slope"),te=ee!==void 0,ce=ee<1,oe=g.colorModeForDrapableLayerRenderPass(E),de=g.terrain&&g.terrain.renderingToTexture,xe=de?1:i.o.devicePixelRatio,Ee=h.paint.get("line-dasharray"),De=Ee.constantOr(1),Me=h.layout.get("line-cap"),Fe=Ee.constantOr(null),Re=Me.constantOr(null),Oe=h.paint.get("line-pattern"),Le=Oe.constantOr(1),ct=h.paint.get("line-pattern-cross-fade"),Ke=Oe.constantOr(null),vt=h.paint.get("line-opacity").constantOr(1);let st=!Le&&vt!==1||g.depthOcclusion&&P>0&&P<1;const _t=h.paint.get("line-gradient"),Ht=Le?"linePattern":"line",lt=i.d$(h);let He;if(de&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(st=!1),P!==0&&g.depthOcclusion){const Gt=h.paint._values["line-opacity"];Gt&&Gt.value&&Gt.value.kind==="constant"?He=Gt.value:i.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&lt.push("VARIABLE_LINE_WIDTH");const Tt=(Gt,tr,Ut,Bt,vr,mr)=>{for(const _r of Gt){const pr=s.getTile(_r);if(Le&&!pr.patternsLoaded())continue;const zr=pr.getBucket(h);if(!zr||zr.elevationType!=="none"&&!vr||zr.elevationType==="none"&&vr)continue;g.prepareDrawTile();const qr=[...tr],Jr=g.shadowRenderer,Rn=zr.elevationType==="road"&&!!Jr&&Jr.enabled;let $r=[0,0,0];if(Rn){const Qr=g.style.directionalLight,Rr=g.style.ambientLight;Qr&&Rr&&($r=Pl(g.style,Qr,Rr)),qr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const vn=zr.programConfigurations.get(h.id);let In=!1;if(Ke&&pr.imageAtlas){const Qr=i.e0.from(Ke),Rr=Qr.getPrimary().scaleSelf(xe).toString(),Dn=pr.imageAtlas.patternPositions.get(Rr),ki=Qr.getSecondary(),vi=ki?pr.imageAtlas.patternPositions.get(ki.scaleSelf(xe).toString()):null;In=!!Dn&&!!vi,Dn&&vn.setConstantPatternPositions(Dn,vi)}ct>0&&(In||vn.getPatternTransitionVertexBuffer("line-pattern"))&&qr.push("LINE_PATTERN_TRANSITION");const ui=g.isTileAffectedByFog(_r),Xr=g.getOrCreateProgram(Ht,{config:vn,defines:qr,overrideFog:ui});if(!Le&&Fe&&Re&&pr.lineAtlas){const Qr=pr.lineAtlas.getDash(Fe,Re);Qr&&vn.setConstantPatternPositions(Qr)}Rn&&Jr.setupShadows(pr.tileID.toUnwrapped(),Xr,"vector-tile");let[Tn,wn]=h.paint.get("line-trim-offset");(Re==="round"||Re==="square")&&Tn!==wn&&(Tn===0&&(Tn-=1),wn===1&&(wn+=1));const Cn=de?_r.projMatrix:null,di=B?1/zr.tileToMeter/i.ay(pr,1,g.transform.zoom):1,Ui=B?1/zr.tileToMeter/i.ay(pr,1,Math.floor(g.transform.zoom)):1,La=Le?i.e1(g,pr,h,Cn,xe,di,Ui,[Tn,wn],$r,ct):i.e2(g,pr,h,Cn,zr.lineClipsArray.length,xe,di,Ui,[Tn,wn],$r);if(_t){const Qr=zr.gradients[h.id];let Rr=Qr.texture;if(h.gradientVersion!==Qr.version){let Dn=256;if(h.stepInterpolant){const ki=s.getSource().maxzoom,vi=_r.canonical.z===ki?Math.ceil(1<<g.transform.maxZoom-_r.canonical.z):1;Dn=i.aA(i.e3(zr.maxLineLength/i.al*1024*vi),256,W.maxTextureSize)}Qr.gradient=i.e4({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Dn,image:Qr.gradient||void 0,clips:zr.lineClipsArray}),Qr.texture?Qr.texture.update(Qr.gradient):Qr.texture=new i.T(W,Qr.gradient,Y.RGBA8),Qr.version=h.gradientVersion,Rr=Qr.texture}W.activeTexture.set(Y.TEXTURE1),Rr.bind(h.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}De&&(W.activeTexture.set(Y.TEXTURE0),pr.lineAtlasTexture&&pr.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),vn.updatePaintBuffers()),Le&&(W.activeTexture.set(Y.TEXTURE0),pr.imageAtlasTexture&&pr.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),vn.updatePaintBuffers()),vr&&!j&&g.terrain.setupElevationDraw(pr,Xr),g.uploadCommonUniforms(W,Xr,_r.toUnwrapped());const pi=Qr=>{He!=null&&(He.value=vt*P),Xr.draw(g,Y.TRIANGLES,Ut,Qr,oe,Lr.disabled,La,h.id,zr.layoutVertexBuffer,zr.indexBuffer,zr.segments,h.paint,g.transform.zoom,vn,[zr.layoutVertexBuffer2,zr.patternVertexBuffer,zr.zOffsetVertexBuffer]),He!=null&&(He.value=vt)};if(st&&!vr){const Qr=g.stencilModeForClipping(_r).ref;Qr===0&&de&&W.clear({stencil:0});const Rr={func:Y.EQUAL,mask:255};La.u_alpha_discard_threshold=.8,pi(new Mr(Rr,Qr,255,Y.KEEP,Y.KEEP,Y.INVERT)),La.u_alpha_discard_threshold=0,pi(new Mr(Rr,Qr,255,Y.KEEP,Y.KEEP,Y.KEEP))}else La.u_alpha_discard_threshold=st&&vr&&mr?.8:0,pi(vr?Bt:g.stencilModeForClipping(_r))}};let ht=g.depthModeForSublayer(0,or.ReadOnly);const Ft=new or(g.depthOcclusion?Y.GREATER:Y.LEQUAL,or.ReadOnly,g.depthRangeFor3D);if(h.hasNonElevatedBuckets){const Gt=!de&&g.terrain;P!==0&&Gt?i.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has line-z-offset enabled.`):Gt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${h.id}.`):Tt(m,lt,ht,Mr.disabled,!1,!0)}if(h.hasElevatedBuckets){M==="hd-road-markup"?X||(ht=Ft,lt.push("ELEVATED_ROADS")):(lt.push("ELEVATED"),ht=Ft,te&&lt.push(ce?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),j&&lt.push("ELEVATION_REFERENCE_SEA"));const Gt=st?g.stencilModeFor3D():Mr.disabled;g.forceTerrainMode=!0,Tt(m,lt,ht,Gt,!0,!0),st&&Tt(m,lt,ht,Gt,!0,!1),g.forceTerrainMode=!1}st&&(g.resetStencilClippingMasks(),de&&W.clear({stencil:0})),P===0||g.depthOcclusion||de||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,s,h,m){const x=h.paint.get("fill-color"),b=h.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const E=h.paint.get("fill-emissive-strength"),P=g.colorModeForDrapableLayerRenderPass(E),M=h.paint.get("fill-pattern"),B=g.opaquePassEnabledForLayer()&&!M.constantOr(1)&&x.constantOr(i.ao.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";let j="none";h.layout.get("fill-elevation-reference")!=="none"?j="road":h.paint.get("fill-z-offset").constantOr(1)!==0&&(j="offset");const X=!(!g.terrain||!g.terrain.enabled),W={painter:g,sourceCache:s,layer:h,coords:m,colorMode:P,elevationType:j,terrainEnabled:X,pass:B};if(g.renderPass!=="shadow")if(j!=="offset"){if(pd(W,!1),j==="road"){const Y=!X&&g.renderPass==="translucent";Y&&qh(g,s,h,m,"geometry"),pd(W,!0,Mr.disabled),Y&&function(ee){const{painter:te,sourceCache:ce,layer:oe,coords:de,colorMode:xe}=ee,Ee=te.context.gl,De=ee.painter.shadowRenderer,Me=!!De&&De.enabled,Fe=new or(te.context.gl.LEQUAL,or.ReadOnly,te.depthRangeFor3D);let Re=[0,0,0];if(Me){const Le=te.style.directionalLight,ct=te.style.ambientLight;Le&&ct&&(Re=Pl(te.style,Le,ct))}const Oe=Le=>{for(const ct of de){const Ke=ce.getTile(ct),vt=Ke.getBucket(oe);if(!vt)continue;const st=vt.elevatedStructures;if(!st)continue;let _t,Ht;if(Le?(_t=st.renderableBridgeSegments,Ht=st.bridgeProgramConfigurations.get(oe.id)):(_t=st.renderableTunnelSegments,Ht=st.tunnelProgramConfigurations.get(oe.id)),!_t||_t.segments[0].primitiveLength===0)continue;Ht.updatePaintBuffers(),te.prepareDrawTile();const lt=te.isTileAffectedByFog(ct),He=[];Me&&He.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Tt=te.getOrCreateProgram("elevatedStructures",{config:Ht,overrideFog:lt,defines:He}),ht=te.translatePosMatrix(ct.projMatrix,Ke,oe.paint.get("fill-translate"),oe.paint.get("fill-translate-anchor"));Me&&De.setupShadows(Ke.tileID.toUnwrapped(),Tt,"vector-tile");const Ft=LI(ht,Re);te.uploadCommonUniforms(te.context,Tt,ct.toUnwrapped()),Tt.draw(te,Ee.TRIANGLES,Fe,Mr.disabled,xe,Lr.backCCW,Ft,oe.id,st.vertexBuffer,st.indexBuffer,_t,oe.paint,te.transform.zoom,Ht,[st.vertexBufferNormal])}};Oe(!0),Oe(!1)}(W)}}else pd(W,!1,g.stencilModeFor3D());else g.shadowRenderer&&j==="road"&&!X&&function(Y){const{painter:ee,sourceCache:te,layer:ce,coords:oe}=Y,de=ee.context.gl,xe=Y.painter.shadowRenderer;for(const Ee of oe){const De=te.getTile(Ee),Me=De.getBucket(ce);if(!Me)continue;const Fe=Me.elevatedStructures;if(!Fe||!Fe.shadowCasterSegments||Fe.shadowCasterSegments.segments[0].primitiveLength===0)continue;ee.prepareDrawTile();const Re=Me.bufferData.programConfigurations.get(ce.id),Oe=ee.isTileAffectedByFog(Ee),Le=ee.getOrCreateProgram("elevatedStructuresDepth",{config:Re,overrideFog:Oe}),ct=xe.calculateShadowPassMatrixFromTile(De.tileID.toUnwrapped());ee.uploadCommonUniforms(ee.context,Le,Ee.toUnwrapped());const Ke={u_matrix:ct,u_depth_bias:0};Le.draw(ee,de.TRIANGLES,xe.getShadowPassDepthMode(),Mr.disabled,xe.getShadowPassColorMode(),Lr.disabled,Ke,ce.id,Fe.vertexBuffer,Fe.indexBuffer,Fe.shadowCasterSegments,ce.paint,ee.transform.zoom,Re)}}(W)},"fill-extrusion":function(g,s,h,m){const x=h.paint.get("fill-extrusion-opacity"),b=g.context,E=b.gl,P=g.terrain,M=P&&P.renderingToTexture;if(x===0)return;const B=g.conflationActive&&g.style.isLayerClipped(h,s.getSource()),j=g.style.order.indexOf(h.fqid);if(B&&function(X,W,Y,ee,te){for(const ce of ee){const oe=W.getTile(ce).getBucket(Y);oe&&(oe.updateReplacement(ce,X.replacementSource,te),oe.uploadCentroid(X.context))}}(g,s,h,m,j),P||B)for(const X of m){const W=s.getTile(X).getBucket(h);W&&$u(g.context,s,X,W,h,P,B)}if(g.renderPass==="shadow"&&g.shadowRenderer){const X=g.shadowRenderer;if(P&&x<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ad)return;const W=X.getShadowPassDepthMode(),Y=X.getShadowPassColorMode();sr(g,s,h,m,W,Mr.disabled,Y,B)}else if(g.renderPass==="translucent"){const X=!h.paint.get("fill-extrusion-pattern").constantOr(1),W=h.paint.get("fill-extrusion-color").constantOr(i.ao.white);if(!M&&W.a!==0){const Y=new or(g.context.gl.LEQUAL,or.ReadWrite,g.depthRangeFor3D);x===1&&X?sr(g,s,h,m,Y,Mr.disabled,Zr.unblended,B):(sr(g,s,h,m,Y,Mr.disabled,Zr.disabled,B),sr(g,s,h,m,Y,g.stencilModeFor3D(),g.colorModeForRenderPass(),B),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&X&&(!P&&g.transform.projection.name!=="globe"||M)){const Y=h.paint.get("fill-extrusion-opacity"),ee=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),te=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ce=h.paint.get("fill-extrusion-flood-light-intensity"),oe=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",de=h.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(oe?null:h.lut).toArray01().slice(0,3),xe=ee>0&&te>0,Ee=ce>0,De=(Re,Oe,Le)=>(1-Le)*Re+Le*Oe,Me=new wx;Me.translate=h.paint.get("fill-extrusion-translate"),Me.translateAnchor=h.paint.get("fill-extrusion-translate-anchor"),Me.edgeRadius=h.layout.get("fill-extrusion-edge-radius"),Me.cutoffFadeRange=h.paint.get("fill-extrusion-cutoff-fade-range");const Fe=Re=>{const Oe=g.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!0),Le=h.paint.get(Re?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ct=De(.1,3,Le),Ke=g._showOverdrawInspector;if(!Ke){const vt=new Mr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),st=new Zr([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0],E.MIN);Vc(Me,g,s,h,m,Oe,vt,st,Lr.disabled,Re,"sdf",Y,ee,te,ce,de,ct,B,!1)}{const vt=Ke?Mr.disabled:new Mr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),st=Ke?g.colorModeForRenderPass():new Zr([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],i.ao.transparent,[!0,!0,!0,!0]);Vc(Me,g,s,h,m,Oe,vt,st,Lr.disabled,Re,"color",Y,ee,te,ce,de,ct,B,!1)}};if(M){const Re=(Oe,Le,ct)=>{const Ke=g.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!1),vt=h.paint.get(Oe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),st=De(.1,3,vt);{const _t=new Zr([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0]);Vc(Me,g,s,h,m,Ke,Mr.disabled,_t,Lr.disabled,Oe,"clear",Y,ee,te,ce,de,st,B,Le)}{const _t=new Mr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Ht=new Zr([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0],E.MIN);Vc(Me,g,s,h,m,Ke,_t,Ht,Lr.disabled,Oe,"sdf",Y,ee,te,ce,de,st,B,Le)}{const _t=Oe?E.ZERO:E.ONE_MINUS_DST_ALPHA,Ht=new Mr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),lt=new Zr([_t,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],i.ao.transparent,[!0,!0,!0,!0]);Vc(Me,g,s,h,m,Ke,Ht,lt,Lr.disabled,Oe,"color",Y,ee,te,ce,de,st,B,Le)}{const _t=new Zr([E.ONE,E.ONE,E.ONE,Oe?E.ZERO:E.ONE],i.ao.transparent,[!1,!1,!1,!0],Oe?E.FUNC_ADD:E.MAX);Vc(Me,g,s,h,m,Ke,Mr.disabled,_t,Lr.disabled,Oe,"clear",Y,ee,te,ce,de,st,B,Le,ct)}};if(xe||Ee){let Oe;if(g.prepareDrawTile(),P){const Le=P.drapeBufferSize[0],ct=P.drapeBufferSize[1];Oe=P.framebufferCopyTexture,Oe&&(!Oe||Oe.size[0]===Le&&Oe.size[1]===ct)||(Oe&&Oe.destroy(),Oe=P.framebufferCopyTexture=new i.T(b,new i.q({width:Le,height:ct}),E.RGBA8)),Oe.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,Le,ct)}xe&&Re(!0,!1,Oe),Ee&&Re(!1,!0,Oe)}}else xe&&Fe(!0),Ee&&Fe(!1),(xe||Ee)&&g.resetStencilClippingMasks()}}},building:function(g,s,h,m){g.currentLayer<g.firstLightBeamLayer&&(g.firstLightBeamLayer=g.currentLayer);const x=h.paint.get("building-ambient-occlusion-ground-intensity"),b=h.paint.get("building-ambient-occlusion-ground-radius"),E=h.paint.get("building-ambient-occlusion-ground-attenuation"),P=h.paint.get("building-opacity");if(P<=0)return;let M=x>0&&b>0,B=!0;const j=h.paint.get("building-vertical-scale");(!g.shadowRenderer||j<1)&&(B=!1);const X=g.conflationActive&&g.style.isLayerClipped(h,s.getSource()),W=g.style.order.indexOf(h.fqid);if(function(Y,ee,te,ce,oe,de){for(const xe of de){const Ee=ee.getTile(xe).getBucket(te);Ee&&(oe&&Ee.updateReplacement(xe,Y.replacementSource,ce),Ee.uploadUpdatedIndexBuffer(Y.context))}}(g,s,h,W,X,m),function(Y,ee,te,ce){for(const oe of ce){const de=ee.getTile(oe).getBucket(te);de&&de.needsEvaluation()&&de.uploadUpdatedColorBuffer(Y.context)}}(g,s,h,m),h.resetLayerRenderingStats(g),g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0),g.renderPass==="shadow"&&g.shadowRenderer){const Y=g.shadowRenderer,ee=[],te=Y.getShadowPassDepthMode();Bg({painter:g,source:s,layer:h,coords:m,defines:ee,blendMode:Y.getShadowPassColorMode(),depthMode:te,opacity:P,verticalScale:j,facadeEmissiveChance:0,facadeAOIntensity:0})}else if(g.renderPass==="translucent"){let Y=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];B&&(Y=Y.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),g.shadowRenderer&&g.shadowRenderer.useNormalOffset&&(Y=Y.concat("NORMAL_OFFSET"));const ee=h.paint.get("building-facade-emissive-chance"),te=h.paint.get("building-ambient-occlusion-intensity"),ce=new or(g.context.gl.LEQUAL,or.ReadWrite,g.depthRangeFor3D);P<1&&Bg({painter:g,source:s,layer:h,coords:m,defines:Y,blendMode:Zr.disabled,depthMode:ce,opacity:P,verticalScale:j,facadeEmissiveChance:ee,facadeAOIntensity:te});const oe=g.colorModeForRenderPass();Bg({painter:g,source:s,layer:h,coords:m,defines:Y,blendMode:oe,depthMode:ce,opacity:P,verticalScale:j,facadeEmissiveChance:ee,facadeAOIntensity:te}),M&&function(de,xe,Ee,De,Me,Fe,Re,Oe,Le,ct,Ke,vt,st){const _t=de.context.gl,Ht=de.depthModeForSublayer(1,or.ReadOnly,_t.LEQUAL,!0),lt=.1*(1-(He=Ke))+3*He;var He;const Tt=de._showOverdrawInspector,ht=vt,Ft=new wx;Tt||Vc(Ft,de,xe,Ee,De,Ht,new Mr({func:_t.ALWAYS,mask:255},255,255,_t.KEEP,_t.KEEP,_t.REPLACE),new Zr([_t.ONE,_t.ONE,_t.ONE,_t.ONE],i.ao.transparent,[!1,!1,!1,!0],_t.MIN),Lr.disabled,Me,"sdf",Fe,Re,Oe,0,ct,lt,ht,!1);{const Gt=Tt?Mr.disabled:new Mr({func:_t.EQUAL,mask:255},255,255,_t.KEEP,_t.DECR,_t.DECR),tr=Tt?de.colorModeForRenderPass():new Zr([_t.ONE_MINUS_DST_ALPHA,_t.DST_ALPHA,_t.ONE,_t.ONE],i.ao.transparent,[!0,!0,!0,!0]);Vc(Ft,de,xe,Ee,De,Ht,Gt,tr,Lr.disabled,Me,"color",Fe,Re,Oe,0,ct,lt,ht,!1)}}(g,s,h,m,!0,P,x,b,0,[0,0,0],E,X)}else if(g.renderPass==="light-beam"){const Y=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],ee=new or(g.context.gl.LEQUAL,or.ReadOnly,g.depthRangeFor3D);Bg({painter:g,source:s,layer:h,coords:m,defines:Y,blendMode:Zr.alphaBlended,depthMode:ee,opacity:P,verticalScale:j,facadeEmissiveChance:0,facadeAOIntensity:0})}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1),g.resetStencilClippingMasks()},hillshade:function(g,s,h,m){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const x=g.context,b=g.terrain&&g.terrain.renderingToTexture,[E,P]=g.renderPass!=="translucent"||b?[{},m]:g.stencilConfigForOverlap(m);for(const M of P){const B=s.getTile(M);if(B.needsHillshadePrepare&&g.renderPass==="offscreen")SI(g,B,h);else if(g.renderPass==="translucent"){const j=g.depthModeForSublayer(0,or.ReadOnly),X=h.paint.get("hillshade-emissive-strength"),W=g.colorModeForDrapableLayerRenderPass(X),Y=b&&g.terrain?g.terrain.stencilModeForRTTOverlap(M):E[M.overscaledZ];TI(g,M,B,h,j,Y,W)}}x.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,s,h,m,x,b){if(g.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const E=g.transform.projection.name==="globe",P=h.paint.get("raster-elevation")!==0,M=P&&E;if(g.renderElevatedRasterBackface&&!M)return;const B=g.context,j=B.gl,X=s.getSource(),W=function(Me,Fe,Re,Oe){const Le=Fe.paint.get("raster-color"),ct=Me.type==="raster-array",Ke=[],vt=Fe.paint.get("raster-resampling"),st=Fe.paint.get("raster-color-mix");let _t=Fe.paint.get("raster-color-range");const Ht=[st[0],st[1],st[2],0],lt=st[3];let He=vt==="nearest"?Oe.NEAREST:Oe.LINEAR;if(ct&&(Ke.push("RASTER_ARRAY"),Le||Ke.push("RASTER_COLOR"),vt==="linear"&&Ke.push("RASTER_ARRAY_LINEAR"),He=Oe.NEAREST,!_t&&Me.rasterLayers)){const Tt=Me.rasterLayers.find(({id:ht})=>ht===Fe.sourceLayer);Tt&&Tt.fields&&Tt.fields.range&&(_t=Tt.fields.range)}if(_t=_t||[0,1],Le){Ke.push("RASTER_COLOR"),Re.activeTexture.set(Oe.TEXTURE2),Fe.updateColorRamp(_t);let Tt=Fe.colorRampTexture;Tt||(Tt=Fe.colorRampTexture=new i.T(Re,Fe.colorRamp,Oe.RGBA8)),Tt.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE)}return{mix:Ht,range:_t,offset:lt,defines:Ke,resampling:He}}(X,h,B,j);if(X instanceof i.aS&&!m.length&&!E)return;const Y=h.paint.get("raster-emissive-strength"),ee=g.colorModeForDrapableLayerRenderPass(Y),te=g.terrain&&g.terrain.renderingToTexture,ce=!g.options.moving,oe=h.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(X instanceof i.aS&&!m.length&&(X.onNorthPole||X.onSouthPole)){const Me=P?g.stencilModeFor3D():Mr.disabled;return void jg(!!X.onNorthPole,null,g,s,h,Y,W,Lr.disabled,Me)}if(!m.length)return;const[de,xe]=X instanceof i.aS||te?[{},m]:g.stencilConfigForOverlap(m),Ee=xe[xe.length-1].overscaledZ;M&&W.defines.push("PROJECTION_GLOBE_VIEW"),P&&W.defines.push("RENDER_CUTOFF");const De=(Me,Fe,Re)=>{for(const Oe of Me){const Le=Oe.toUnwrapped(),ct=s.getTile(Oe);if(te&&(!ct||!ct.hasData()))continue;B.activeTexture.set(j.TEXTURE0);const Ke=iT(ct,X,h,W);if(!Ke||!Ke.texture)continue;const{texture:vt,mix:st,offset:_t,tileSize:Ht,buffer:lt}=Ke;let He,Tt;te?(He=or.disabled,Tt=Oe.projMatrix):P?(He=new or(j.LEQUAL,or.ReadWrite,g.depthRangeFor3D),Tt=E?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(Le,ce)):(He=g.depthModeForSublayer(Oe.overscaledZ-Ee,h.paint.get("raster-opacity")===1?or.ReadWrite:or.ReadOnly,j.LESS),Tt=g.transform.calculateProjMatrix(Le,ce));const ht=g.terrain&&te?g.terrain.stencilModeForRTTOverlap(Oe):de[Oe.overscaledZ],Ft=b?0:h.paint.get("raster-fade-duration");ct.registerFadeDuration(Ft);const Gt=s.findLoadedParent(Oe,0),tr=Vh(ct,Gt,s,g.transform,Ft);let Ut,Bt;!tr.isFading&&ct.refreshedUponExpiration&&(ct.refreshedUponExpiration=!1),g.terrain&&g.terrain.prepareDrawTile(),B.activeTexture.set(j.TEXTURE0),vt.bind(oe,j.CLAMP_TO_EDGE),B.activeTexture.set(j.TEXTURE1),Gt?(Gt.texture&&Gt.texture.bind(oe,j.CLAMP_TO_EDGE),Ut=Math.pow(2,Gt.tileID.overscaledZ-ct.tileID.overscaledZ),Bt=[ct.tileID.canonical.x*Ut%1,ct.tileID.canonical.y*Ut%1]):vt.bind(oe,j.CLAMP_TO_EDGE),"useMipmap"in vt&&B.extTextureFilterAnisotropic&&g.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const vr=g.transform;let mr;const _r=P?UI(vr):[0,0,0,0];let pr,zr,qr,Jr,Rn,$r=0;if(M&&X instanceof i.aS&&X.coordinates.length>3)pr=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0)))),zr=Float32Array.from(vr.globeMatrix),qr=Float32Array.from(i.dB(vr)),Jr=[i.aF(vr.center.lng),i.aJ(vr.center.lat)],mr=X.elevatedGlobePerspectiveTransform,Rn=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(M){const Xr=i.dC(Oe.canonical);$r=i.dD(Xr.getCenter().lat),pr=Float32Array.from(i.bk(i.dF(Oe.canonical))),zr=Float32Array.from(vr.globeMatrix),qr=Float32Array.from(i.dB(vr)),Jr=[i.aF(vr.center.lng),i.aJ(vr.center.lat)],mr=[0,0],Rn=Float32Array.from(i.dE(Oe.canonical,Xr,$r,vr.worldSize/vr._pixelsPerMercatorPixel))}else mr=X instanceof i.aS?X.perspectiveTransform:[0,0],pr=new Float32Array(16),zr=new Float32Array(9),qr=new Float32Array(16),Jr=[0,0],Rn=new Float32Array(9);const vn=Ig(Tt,pr,zr,qr,Rn,Bt||[0,0],i.aj(g.transform.zoom),Jr,_r,Ut||1,tr,h,mr,P?h.paint.get("raster-elevation"):0,2,st,_t,W.range,Ht,lt,Y),In=g.isTileAffectedByFog(Oe),ui=g.getOrCreateProgram("raster",{defines:W.defines,overrideFog:In});if(g.uploadCommonUniforms(B,ui,Le),X instanceof i.aS){const Xr=X.elevatedGlobeVertexBuffer,Tn=X.elevatedGlobeIndexBuffer;if(te||!E)X.boundsBuffer&&X.boundsSegments&&ui.draw(g,j.TRIANGLES,He,Mr.disabled,ee,Lr.disabled,vn,h.id,X.boundsBuffer,g.quadTriangleIndexBuffer,X.boundsSegments);else if(Xr&&Tn){const wn=vr.zoom<=i.cZ?X.elevatedGlobeSegments:X.getSegmentsForLongitude(vr.center.lng);wn&&ui.draw(g,j.TRIANGLES,He,Mr.disabled,ee,Fe,vn,h.id,Xr,Tn,wn)}}else if(M){He=new or(j.LEQUAL,or.ReadOnly,g.depthRangeFor3D);const Xr=g.globeSharedBuffers;if(Xr){const[Tn,wn,Cn]=Xr.getGridBuffers($r,!1);ui.draw(g,j.TRIANGLES,He,Re||ht,g.colorModeForRenderPass(),Fe,vn,h.id,Tn,wn,Cn)}}else{const{tileBoundsBuffer:Xr,tileBoundsIndexBuffer:Tn,tileBoundsSegments:wn}=g.getTileBoundsBuffers(ct);ui.draw(g,j.TRIANGLES,He,ht,ee,Lr.disabled,vn,h.id,Xr,Tn,wn)}}if(!(X instanceof i.aS)&&M)for(const Oe of Me){const Le=Oe.canonical.y===(1<<Oe.canonical.z)-1;Oe.canonical.y===0&&jg(!0,Oe,g,s,h,Y,W,Fe,Re||Mr.disabled),Le&&jg(!1,Oe,g,s,h,Y,W,Fe===Lr.frontCW?Lr.backCW:Lr.frontCW,Re||Mr.disabled)}};M?De(xe,g.renderElevatedRasterBackface?Lr.backCW:Lr.frontCW,g.stencilModeFor3D()):De(xe,Lr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,s,h,m,x,b){g.renderPass==="offscreen"&&function(E,P,M,B){if(!B.length)return;const j=E.context,X=j.gl,W=P.getSource();if(!(W instanceof Iu))return;const Y=Math.ceil(Math.sqrt(M.paint.get("raster-particle-count")));let ee=M.particlePositionRGBAImage;if(!ee||ee.width!==Y){const xe=function(Ee){const De=Ee*Ee,Me=new Uint8Array(4*De),Fe=function(Oe){return Oe|=0,Oe=Math.imul(2747636419^Oe,2654435769),Oe=Math.imul(Oe^Oe>>>16,2654435769),((Oe=Math.imul(Oe^Oe>>>16,2654435769))>>>0)/4294967296},Re=1/1.1;for(let Oe=0;Oe<De;Oe++){const Le=Re*(Fe(2*Oe+0)+Hh),ct=Re*(Fe(2*Oe+1)+Hh),Ke=255*Le%1,vt=255*ct%1,st=Ke,_t=ct-vt/255,Ht=vt;Me[4*Oe+0]=255*(Le-Ke/255),Me[4*Oe+1]=255*st,Me[4*Oe+2]=255*_t,Me[4*Oe+3]=255*Ht}return Me}(Y);ee=M.particlePositionRGBAImage=new i.q({width:Y,height:Y},xe)}let te=M.particleFramebuffer;te?te.width!==Y&&(te.destroy(),te=M.particleFramebuffer=j.createFramebuffer(Y,Y,!0,null)):te=M.particleFramebuffer=j.createFramebuffer(Y,Y,!0,null);const ce=[];for(const xe of B){const Ee=P.getTile(xe);if(!(Ee instanceof qp))continue;const De=ds(Ee,W,M);if(!De)continue;const Me=[Ee.tileSize,Ee.tileSize];let Fe=M.tileFramebuffer;Fe||(Fe=M.tileFramebuffer=j.createFramebuffer(Me[0],Me[1],!0,null));let Re=Ee.rasterParticleState;Re||(Re=Ee.rasterParticleState=new VI(j,xe,Me,ee));const Oe=Re.update(M.lastInvalidatedAt);Re.particleTextureDimension!==Y&&Re.updateParticleTexture(xe,ee);const Le=Re.targetColorTexture;Re.targetColorTexture=Re.backgroundColorTexture,Re.backgroundColorTexture=Le;const ct=Re.particleTexture0;Re.particleTexture0=Re.particleTexture1,Re.particleTexture1=ct,ce.push([xe,De,Re,Oe])}if(ce.length===0)return;const oe=i.o.now(),de=M.previousDrawTimestamp?.001*(oe-M.previousDrawTimestamp):.0167;if(M.previousDrawTimestamp=oe,M.hasColorMap()){j.activeTexture.set(X.TEXTURE0+2);let xe=M.colorRampTexture;xe||(xe=M.colorRampTexture=new i.T(j,M.colorRamp,X.RGBA8)),xe.bind(X.LINEAR,X.CLAMP_TO_EDGE)}j.bindFramebuffer.set(M.tileFramebuffer.framebuffer),function(xe,Ee,De){const Me=xe.context,Fe=Me.gl,Re=Ee.tileFramebuffer;Me.activeTexture.set(Fe.TEXTURE0);const Oe={u_texture:0,u_opacity:1.05*(ct=Ee.paint.get("raster-particle-fade-opacity-factor"))/(ct+.05)},Le=xe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ct;for(const Ke of De){const[,,vt,st]=Ke;Re.colorAttachment.set(vt.targetColorTexture.texture),Me.viewport.set([0,0,Re.width,Re.height]),Me.clear({color:i.ao.transparent}),st&&(vt.backgroundColorTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),Le.draw(xe,Fe.TRIANGLES,or.disabled,Mr.disabled,Zr.alphaBlended,Lr.disabled,Oe,Ee.id,xe.viewportBuffer,xe.quadTriangleIndexBuffer,xe.viewportSegments))}}(E,M,ce),function(xe,Ee,De,Me){const Fe=xe.context,Re=Fe.gl,Oe=De.tileFramebuffer,Le=xe.transform.projection.name==="globe",ct=De.paint.get("raster-particle-max-speed");for(const Ke of Me){const[vt,st,_t]=Ke;Fe.activeTexture.set(Re.TEXTURE0+0),st.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Oe.colorAttachment.set(_t.targetColorTexture.texture);const Ht=xe.getOrCreateProgram("rasterParticleDraw",{defines:st.defines,overrideFog:!1});Fe.activeTexture.set(Re.TEXTURE0+1);const lt=st.scalarData?[]:[0,1,2,3].map(ht=>i.e6[ht](vt));lt.push(vt);const He=vt.canonical.x,Tt=vt.canonical.y;for(const ht of lt){const Ft=Ee.getTile(Le?ht.wrapped():ht);if(!Ft)continue;const Gt=Ft.rasterParticleState;if(!Gt)continue;const tr=ht.canonical.x+(1<<ht.canonical.z)*(ht.wrap-vt.wrap),Ut=ht.canonical.y;Gt.particleTexture0.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);const Bt=mx(1,Gt.particleTexture0.size[0],[tr-He,Ut-Tt],0,st.texture.size,2,ct,st.textureOffset,st.scale,st.offset);Ht.draw(xe,Re.POINTS,or.disabled,Mr.disabled,Zr.alphaBlended,Lr.disabled,Bt,De.id,Gt.particleIndexBuffer,void 0,Gt.particleSegment)}}}(E,P,M,ce),j.bindFramebuffer.set(M.particleFramebuffer.framebuffer),function(xe,Ee,De,Me){const Fe=xe.context,Re=Fe.gl,Oe=Ee.paint.get("raster-particle-max-speed"),Le=Me*Ee.paint.get("raster-particle-speed-factor")*.15,ct=function(vt){return Math.pow(vt,6)}(.01+1*Ee.paint.get("raster-particle-reset-rate-factor")),Ke=Ee.particleFramebuffer;Fe.viewport.set([0,0,Ke.width,Ke.height]);for(const vt of De){const[,st,_t]=vt;Fe.activeTexture.set(Re.TEXTURE0+0),st.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Fe.activeTexture.set(Re.TEXTURE0+1);const Ht=_t.particleTexture0;Ht.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);const lt=kg(1,Ht.size[0],0,st.texture.size,Oe,Le,ct,st.textureOffset,st.scale,st.offset);Ke.colorAttachment.set(_t.particleTexture1.texture),Fe.clear({color:i.ao.transparent}),xe.getOrCreateProgram("rasterParticleUpdate",{defines:st.defines}).draw(xe,Re.TRIANGLES,or.disabled,Mr.disabled,Zr.unblended,Lr.disabled,lt,Ee.id,xe.viewportBuffer,xe.quadTriangleIndexBuffer,xe.viewportSegments)}}(E,M,ce,de)}(g,s,h,m),g.renderPass==="translucent"&&(function(E,P,M,B,j){const X=E.context,W=X.gl,Y=P.getSource().tileSize,ee=5*(1-i.ah(i.cK,i.cK+1,E.transform.zoom))*Y+M.paint.get("raster-particle-elevation"),te=!E.options.moving,ce=E.transform.projection.name==="globe";if(!B.length)return;const[oe,de]=E.stencilConfigForOverlap(B),xe=[];ce&&xe.push("PROJECTION_GLOBE_VIEW");const Ee=E.stencilModeFor3D();for(const De of de){const Me=De.toUnwrapped(),Fe=P.getTile(De);if(!Fe.rasterParticleState)continue;const Re=Fe.rasterParticleState,Oe=100;Fe.registerFadeDuration(Oe);const Le=P.findLoadedParent(De,0),ct=Vh(Fe,Le,P,E.transform,Oe);let Ke,vt;E.terrain&&E.terrain.prepareDrawTile(),X.activeTexture.set(W.TEXTURE0),Re.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),X.activeTexture.set(W.TEXTURE1),Le&&Le.rasterParticleState?(Le.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Ke=Math.pow(2,Le.tileID.overscaledZ-Fe.tileID.overscaledZ),vt=[Fe.tileID.canonical.x*Ke%1,Fe.tileID.canonical.y*Ke%1]):Re.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const st=ce?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Me,te),_t=E.transform,Ht=Tx(_t),lt=i.dC(De.canonical),He=i.dD(lt.getCenter().lat);let Tt,ht,Ft,Gt,tr;ce?(Tt=Float32Array.from(i.bk(i.dF(De.canonical))),ht=Float32Array.from(_t.globeMatrix),Ft=Float32Array.from(i.dB(_t)),Gt=[i.aF(_t.center.lng),i.aJ(_t.center.lat)],tr=Float32Array.from(i.dE(De.canonical,lt,He,_t.worldSize/_t._pixelsPerMercatorPixel))):(Tt=new Float32Array(16),ht=new Float32Array(9),Ft=new Float32Array(16),Gt=[0,0],tr=new Float32Array(9));const Ut=zu(st,Tt,ht,Ft,tr,vt||[0,0],i.aj(E.transform.zoom),Gt,Ht,Ke||1,ct,ee),Bt=E.isTileAffectedByFog(De),vr=E.getOrCreateProgram("rasterParticle",{defines:xe,overrideFog:Bt});if(E.uploadCommonUniforms(X,vr,Me),ce){const mr=new or(W.LEQUAL,or.ReadOnly,E.depthRangeFor3D),_r=0,pr=E.globeSharedBuffers;if(pr){const[zr,qr,Jr]=pr.getGridBuffers(He,_r!==0);vr.draw(E,W.TRIANGLES,mr,Ee,Zr.alphaBlended,E.renderElevatedRasterBackface?Lr.frontCCW:Lr.backCCW,Ut,M.id,zr,qr,Jr)}}else{const mr=E.depthModeForSublayer(0,or.ReadOnly),_r=oe[De.overscaledZ],{tileBoundsBuffer:pr,tileBoundsIndexBuffer:zr,tileBoundsSegments:qr}=E.getTileBoundsBuffers(Fe);vr.draw(E,W.TRIANGLES,mr,_r,Zr.alphaBlended,Lr.disabled,Ut,M.id,pr,zr,qr)}}E.resetStencilClippingMasks()}(g,s,h,m),g.style.map.triggerRepaint())},background:function(g,s,h,m){const x=h.paint.get("background-color"),b=h.paint.get("background-color-use-theme").constantOr("default")==="none",E=h.paint.get("background-opacity"),P=h.paint.get("background-emissive-strength"),M=h.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const B=g.context,j=B.gl,X=g.transform,W=X.tileSize,Y=h.paint.get("background-pattern");let ee;if(Y!==void 0&&(Y===null||(ee=g.imageManager.getPattern(i.I.from(Y.toString()),h.scope,g.style.getLut(h.scope)),!ee)))return;const te=!Y&&x.a===1&&E===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==te)return;const ce=Mr.disabled,oe=g.depthModeForSublayer(0,te==="opaque"?or.ReadWrite:or.ReadOnly),de=g.colorModeForDrapableLayerRenderPass(P),xe=Y?"backgroundPattern":"background";let Ee,De=m;if(De||(Ee=g.getBackgroundTiles(),De=Object.values(Ee).map(Me=>Me.tileID)),Y&&(B.activeTexture.set(j.TEXTURE0),g.imageManager.bind(g.context,h.scope)),M){const Me=g.getOrCreateProgram(xe,{overrideFog:!1,overrideRtt:!0}),Fe=new Float32Array(i.bA([])),Re=new i.aO(0,0,0,0,0),Oe=Y?Mg(Fe,P,E,g,0,h.scope,ee,M,{tileID:Re,tileSize:W}):Og(Fe,P,E,x.toPremultipliedRenderColor(b?null:h.lut));Me.draw(g,j.TRIANGLES,oe,ce,de,Lr.disabled,Oe,h.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Me of De){const Fe=g.isTileAffectedByFog(Me),Re=g.getOrCreateProgram(xe,{overrideFog:Fe}),Oe=Me.toUnwrapped(),Le=m?Me.projMatrix:g.transform.calculateProjMatrix(Oe);g.prepareDrawTile();const ct=s?s.getTile(Me):Ee?Ee[Me.key]:new Ou(Me,W,X.zoom,g),Ke=Y?Mg(Le,P,E,g,0,h.scope,ee,M,{tileID:Me,tileSize:W}):Og(Le,P,E,x.toPremultipliedRenderColor(b?null:h.lut));g.uploadCommonUniforms(B,Re,Oe);const{tileBoundsBuffer:vt,tileBoundsIndexBuffer:st,tileBoundsSegments:_t}=g.getTileBoundsBuffers(ct);Re.draw(g,j.TRIANGLES,oe,ce,de,Lr.disabled,Ke,h.id,vt,st,_t)}},sky:function(g,s,h){const m=g._atmosphere?i.aj(g.transform.zoom):1,x=h.paint.get("sky-opacity")*m;if(x===0)return;const b=g.context,E=h.paint.get("sky-type"),P=new or(b.gl.LEQUAL,or.ReadOnly,[0,1]),M=g.frameCounter/1e3%1;E==="atmosphere"?g.renderPass==="offscreen"?h.needsSkyboxCapture(g)&&(function(B,j,X,W){const Y=B.context,ee=Y.gl;let te=j.skyboxFbo;if(!te){te=j.skyboxFbo=Y.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new Cx(Y),j.skyboxTexture=Y.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,j.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let xe=0;xe<6;++xe)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+xe,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}Y.bindFramebuffer.set(te.framebuffer),Y.viewport.set([0,0,32,32]);const ce=j.getCenter(B,!0),oe=B.getOrCreateProgram("skyboxCapture"),de=new Float64Array(16);i.bA(de),i.ek(de,de,.5*-Math.PI),Yh(B,j,oe,de,ce,0),i.bA(de),i.ek(de,de,.5*Math.PI),Yh(B,j,oe,de,ce,1),i.bA(de),i.cT(de,de,.5*-Math.PI),Yh(B,j,oe,de,ce,2),i.bA(de),i.cT(de,de,.5*Math.PI),Yh(B,j,oe,de,ce,3),i.bA(de),Yh(B,j,oe,de,ce,4),i.bA(de),i.ek(de,de,Math.PI),Yh(B,j,oe,de,ce,5),Y.viewport.set([0,0,B.width,B.height])}(g,h),h.markSkyboxValid(g)):g.renderPass==="sky"&&function(B,j,X,W,Y){const ee=B.context,te=ee.gl,ce=B.transform,oe=B.getOrCreateProgram("skybox");ee.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,j.skyboxTexture);const de=((xe,Ee,De,Me,Fe)=>({u_matrix:xe,u_sun_direction:Ee,u_cubemap:0,u_opacity:Me,u_temporal_offset:Fe}))(ce.skyboxMatrix,j.getCenter(B,!1),0,W,Y);B.uploadCommonUniforms(ee,oe),oe.draw(B,te.TRIANGLES,X,Mr.disabled,B.colorModeForRenderPass(),Lr.backCW,de,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(g,h,P,x,M):E==="gradient"&&g.renderPass==="sky"&&function(B,j,X,W,Y){const ee=B.context,te=ee.gl,ce=B.transform,oe=B.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new Cx(ee)),ee.activeTexture.set(te.TEXTURE0);let de=j.colorRampTexture;de||(de=j.colorRampTexture=new i.T(ee,j.colorRamp,te.RGBA8)),de.bind(te.LINEAR,te.CLAMP_TO_EDGE);const xe=((Ee,De,Me,Fe,Re)=>({u_matrix:Ee,u_color_ramp:0,u_center_direction:De,u_radius:i.an(Me),u_opacity:Fe,u_temporal_offset:Re}))(ce.skyboxMatrix,j.getCenter(B,!1),j.paint.get("sky-gradient-radius"),W,Y);B.uploadCommonUniforms(ee,oe),oe.draw(B,te.TRIANGLES,X,Mr.disabled,B.colorModeForRenderPass(),Lr.backCW,xe,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(g,h,P,x,M)},custom:function(g,s,h,m){const x=g.context,b=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&h.isDraped(s)){if(g.renderPass==="offscreen"){const E=b.prerender;if(E){if(g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const P=g.transform.pointMerc;E.call(b,x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.aj(g.transform.zoom),[P.x,P.y],g.transform.pixelsPerMeterRatio)}else E.call(b,x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const P=b.renderToTile;if(P){const M=m[0].canonical,B={x:M.x+m[0].wrap*(b.wrapTileId?0:1<<M.z),y:M.y,z:M.z};x.setDepthMode(or.disabled),x.setStencilMode(Mr.disabled),x.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),P.call(b,x.gl,B),x.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),x.setStencilMode(Mr.disabled);const E=b.renderingMode==="3d"?new or(g.context.gl.LEQUAL,or.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,or.ReadOnly);if(x.setDepthMode(E),g.transform.projection.name==="globe"){const P=g.transform.pointMerc;b.render(x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.aj(g.transform.zoom),[P.x,P.y],g.transform.pixelsPerMeterRatio)}else b.render(x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,s,h,m){if(g.renderPass==="opaque")return;const x=h.paint.get("model-opacity").constantOr(1);if(x===0)return;const b=h.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!b||g.terrain&&x<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof i.ad))return;const E=g.shadowRenderer,P=h.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,P||(E.enabled=!1));const M=()=>{E&&(E.useNormalOffset=!0,P||(E.enabled=!0))},B=s.getSource();if(g.renderPass==="light-beam"&&B.type!=="batched-model")return;if(B.type==="vector"||B.type==="geojson")return function(oe,de,xe,Ee,De){const Me=oe.transform;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Me.projection.name} projection is not yet implemented`);const Fe=Me.getFreeCameraOptions().position;if(!oe.modelManager)return;const Re=oe.modelManager;xe.modelManager=Re;const Oe=oe.shadowRenderer;if(!xe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Le=xe._unevaluatedLayout._values["model-id"],ct=Object.assign({},xe.layout.get("model-id").parameters),Ke=oe.style.order.indexOf(xe.fqid);for(const vt of Ee){const st=de.getTile(vt).getBucket(xe);if(!st||st.projection.name!==Me.projection.name)continue;const _t=st.getModelUris();_t&&!st.modelsRequested&&(Re.addModelsFromBucket(_t,De),st.modelsRequested=!0);const Ht=gd(vt,Me);ct.zoom=Ht;const lt=Le.possiblyEvaluate(ct);if(sT(oe,st,vt),Il.shadowUniformsInitialized=!1,Il.useSingleShadowCascade=!!Oe&&Oe.getMaxCascadeForTile(vt.toUnwrapped())===0,oe.renderPass==="shadow"&&Oe){if(oe.currentShadowCascade===1&&st.isInsideFirstShadowMapFrustum)continue;const ht=Me.calculatePosMatrix(vt.toUnwrapped(),Me.worldSize);if(Il.tileMatrix.set(ht),Il.shadowTileMatrix=Float32Array.from(Oe.calculateShadowPassMatrixFromMatrix(ht)),Il.aabb.min=[0,0,0],Il.aabb.max[0]=Il.aabb.max[1]=i.al,Il.aabb.max[2]=0,cT(st,Il,oe,xe.scope))continue}const He=1<<vt.canonical.z,Tt=[((Fe.x-vt.wrap)*He-vt.canonical.x)*i.al,(Fe.y*He-vt.canonical.y)*i.al,Fe.z*He*i.al];oe.conflationActive&&Object.keys(st.instancesPerModel).length>0&&oe.style.isLayerClipped(xe,de.getSource())&&st.updateReplacement(vt,oe.replacementSource,Ke,De)&&(st.uploaded=!1,st.upload(oe.context));for(let ht in st.instancesPerModel){const Ft=st.instancesPerModel[ht];Ft.features.length>0&&(ht=lt.evaluate(Ft.features[0].feature,{}));const Gt=Re.getModel(ht,De);if(Gt||Re.hasURLBeenRequested(ht)||st.modelUris.includes(ht)||(st.modelUris.push(ht),st.modelsRequested=!1),Gt&&Gt.uploaded)for(const tr of Gt.nodes)lT(oe,xe,tr,Ft,Tt,vt,Il)}}}(g,s,h,m,B.type==="vector"?h.scope:""),void M();if(!B.loaded())return;if(B.type==="batched-model")return function(oe,de,xe,Ee){xe.resetLayerRenderingStats(oe);const De=oe.context,Me=oe.transform,Fe=oe.style.fog,Re=oe.shadowRenderer;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Me.projection.name} projection is not yet implemented`);const Oe=oe.transform.getFreeCameraOptions().position,Le=i.c4([],[Oe.x,Oe.y,Oe.z],oe.transform.worldSize),ct=i.et([],Le),Ke=i.bA([]),vt=i.ec(Me.center.lat,Me.zoom),st=i.bq([],[1,1,1/vt]);i.br(Ke,Ke,ct);const _t=xe.paint.get("model-opacity").constantOr(1),Ht=new or(De.gl.LEQUAL,or.ReadWrite,oe.depthRangeFor3D),lt=new or(De.gl.LEQUAL,or.ReadOnly,oe.depthRangeFor3D),He=new i.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Tt=oe.renderPass==="shadow",ht=Tt&&Re?Re.getCurrentCascadeFrustum():Me.getFrustum(Me.scaleZoom(Me.worldSize)),Ft=xe.paint.get("model-front-cutoff"),Gt=Ft[2]<1,tr=Fu(oe,xe.paint.get("model-cutoff-fade-range")),Ut=xe.getLayerRenderingStats();(function(Bt,vr,mr,_r){const pr=Bt.terrain?Bt.terrain.exaggeration():0,zr=Bt.transform.zoom;for(const qr of _r){const Jr=vr.getTile(qr).getBucket(mr);Jr&&(Jr.setFilter(mr.filter),Bt.conflationActive&&Jr.updateReplacement(qr,Bt.replacementSource),Jr.evaluateTransform(Bt,mr),Bt.terrain&&pr>0&&Jr.elevationUpdate(Bt.terrain,pr,qr,mr.source),Jr.needsReEvaluation(Bt,zr,mr)&&Jr.evaluate(mr))}})(oe,de,xe,Ee),function(){let Bt,vr,mr;Gt?(Bt=Ee.length-1,vr=-1,mr=-1):(Bt=0,vr=Ee.length,mr=1);const _r=new Float64Array(16),pr=i.cz(),zr=new i.P(0,0);for(let qr=Bt;qr!==vr;qr+=mr){const Jr=Ee[qr],Rn=de.getTile(Jr).getBucket(xe);if(!Rn||!Rn.uploaded)continue;let $r=!1;Re&&($r=Re.getMaxCascadeForTile(Jr.toUnwrapped())===0);const vn=Me.calculatePosMatrix(Jr.toUnwrapped(),Me.worldSize),In=Rn.modelTraits;!Tt&&Gt&&(i.bl(_r,vn),i.af(pr,Le,_r),zr.x=pr[0],zr.y=pr[1]);const ui=[];Rn.setFilter(xe.filter);for(const Xr of Rn.getNodesInfo()){if(Xr.hiddenByReplacement||!Xr.node.meshes)continue;const Tn=Xr.node;let wn=0;oe.terrain&&Tn.elevation&&(wn=Tn.elevation*oe.terrain.exaggeration());const Cn=(()=>{const qa=Xr.aabb;return He.min=[...qa.min],He.max=[...qa.max],He.min[2]+=wn,He.max[2]+=wn,i.af(He.min,He.min,vn),i.af(He.max,He.max,vn),He})(),di=Xr.evaluatedScale;if(di[0]<=1&&di[1]<=1&&di[2]<=1&&Cn.intersects(ht)===0)continue;if(!Tt&&Gt){const qa=.16666666666666666;Xr.cameraCollisionOpacity=Le[0]>Cn.min[0]&&Le[0]<Cn.max[0]&&Le[1]>Cn.min[1]&&Le[1]<Cn.max[1]&&Le[2]*vt<Cn.max[2]&&Tn.footprint&&i.b$(zr,Tn.footprint)?Math.max(Xr.cameraCollisionOpacity-qa,0):Math.min(1,Xr.cameraCollisionOpacity+qa)}const Ui=[...vn],La=1/i.d6(Jr.canonical),pi=Tn.anchor?Tn.anchor[0]:0,Qr=Tn.anchor?Tn.anchor[1]:0;i.br(Ui,Ui,[pi*(di[0]-1)+Xr.evaluatedTranslation[0]*La,Qr*(di[1]-1)+Xr.evaluatedTranslation[1]*La,wn+Xr.evaluatedTranslation[2]]),i.cp(di,i.ev)||i.cR(Ui,Ui,di);const Rr=i.aB([],Ui,Tn.matrix),Dn=i.aB([],Me.expandedFarZProjMatrix,Rr),ki=i.aB([],Me.expandedFarZProjMatrix,Ui),vi=i.aC([],[pi,Qr,wn,1],Dn)[2];Tn.hidden=!1;let oa=_t;Tt||(Gt&&(oa*=Xr.cameraCollisionOpacity,oa*=Px(Ui,Me,Xr.aabb,Ft)),oa*=Wg(tr,vi)),oa!==0?ui.push({nodeInfo:Xr,depth:vi,opacity:oa,wvpForNode:Dn,wvpForTile:ki,nodeModelMatrix:Rr,tileModelMatrix:Ui}):Tn.hidden=!0}Tt||ui.sort((Xr,Tn)=>!Gt||Xr.opacity===1&&Tn.opacity===1?Xr.depth<Tn.depth?-1:1:Xr.opacity===1?-1:Tn.opacity===1?1:Xr.depth>Tn.depth?-1:1);for(const Xr of ui){const Tn=Xr.nodeInfo,wn=Tn.node;let Cn=i.aB([],st,Xr.tileModelMatrix);i.aB(Cn,Ke,Cn);const di=i.bl([],Cn);i.ed(di,di),i.cR(di,di,WI),Cn=i.aB(Cn,Cn,wn.matrix);const Ui=oe.renderPass==="light-beam",La=xe.paint.get("model-color-use-theme").constantOr("default")==="none",pi=In&i.ez.HasMapboxMeshFeatures,Qr=pi?0:Tn.evaluatedRMEA[0][2];for(let Rr=0;Rr<wn.meshes.length;++Rr){const Dn=wn.meshes[Rr],ki=Rr===wn.lightMeshIndex;let vi=Xr.wvpForNode;if(ki){if(!Ui&&!oe.terrain&&oe.shadowRenderer){oe.currentLayer<oe.firstLightBeamLayer&&(oe.firstLightBeamLayer=oe.currentLayer);continue}vi=Xr.wvpForTile}else if(Ui)continue;const oa={defines:[]},qa=[];if(!Tt&&Re&&(Re.useNormalOffset=!!Dn.normalBuffer),$g(oa.defines,qa,Dn,oe,La?null:xe.lut),pi||oa.defines.push("DIFFUSE_SHADED"),$r&&oa.defines.push("SHADOWS_SINGLE_CASCADE"),Ut&&(Tt?Ut.numRenderedVerticesInShadowPass+=Dn.vertexArray.length:Ut.numRenderedVerticesInTransparentPass+=Dn.vertexArray.length),Tt){pm(Dn,Xr.nodeModelMatrix,oe,xe);continue}let Ws=null;if(Fe){const Ml=rt(Xr.nodeModelMatrix,oe.transform);if(Ws=new Float32Array(Ml),Me.projection.name!=="globe"){const Fi=Dn.aabb.min,$i=Dn.aabb.max,[xi,ga]=Fe.getOpacityForBounds(Ml,Fi[0],Fi[1],$i[0],$i[1]);oa.overrideFog=xi>=ot||ga>=ot}}const Gs=Dn.material;let ps;Gs.occlusionTexture&&Gs.occlusionTexture.offsetScale&&(ps=Gs.occlusionTexture.offsetScale,oa.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ms=oe.getOrCreateProgram("model",oa);!Tt&&Re&&Re.setupShadowsFromMatrix(Xr.tileModelMatrix,ms,Re.useNormalOffset),oe.uploadCommonUniforms(De,ms,null,Ws);const Vo=Gs.pbrMetallicRoughness;Vo.metallicFactor=.9,Vo.roughnessFactor=.5;const ol=Rg(new Float32Array(vi),new Float32Array(Cn),new Float32Array(di),new Float32Array(wn.matrix),oe,Xr.opacity,Vo.baseColorFactor,Gs.emissiveFactor,Vo.metallicFactor,Vo.roughnessFactor,Gs,Qr,xe,[0,0,0],ps);!ki&&(Tn.hasTranslucentParts||Xr.opacity<1)&&ms.draw(oe,De.gl.TRIANGLES,Ht,Mr.disabled,Zr.disabled,Lr.backCCW,ol,xe.id,Dn.vertexBuffer,Dn.indexBuffer,Dn.segments,xe.paint,oe.transform.zoom,void 0,qa),ms.draw(oe,De.gl.TRIANGLES,ki?lt:Ht,Mr.disabled,ki||Xr.opacity<1||Tn.hasTranslucentParts?Zr.alphaBlended:Zr.unblended,Lr.backCCW,ol,xe.id,Dn.vertexBuffer,Dn.indexBuffer,Dn.segments,xe.paint,oe.transform.zoom,void 0,qa)}}}}()}(g,s,h,m),void M();if(B.type!=="model")return;const j=B.getModels(),X=[],W=g.transform.getFreeCameraOptions().position,Y=i.c4([],[W.x,W.y,W.z],g.transform.worldSize);i.et(Y,Y);const ee=[],te=[];let ce=0;for(const oe of j){const de=h.paint.get("model-rotation").constantOr(null),xe=h.paint.get("model-scale").constantOr(null),Ee=h.paint.get("model-translation").constantOr(null);oe.computeModelMatrix(g,de,xe,Ee,!0,!0,!1);const De=i.bA([]),Me=i.ec(oe.position.lat,g.transform.zoom),Fe=i.bq([],[1,1,1/Me]);i.br(De,De,Y),X.push({zScaleMatrix:Fe,negCameraPosMatrix:De});for(const Re of oe.nodes)Vg(g.transform,Re,oe.matrix,g.transform.expandedFarZProjMatrix,ce,ee,te);ce++}if(ee.sort((oe,de)=>de.depth-oe.depth),g.renderPass!=="shadow"){if(x===1)for(const oe of te)Qh(oe,g,h,X[oe.modelIndex],Mr.disabled,g.colorModeForRenderPass());else{for(const oe of te)Qh(oe,g,h,X[oe.modelIndex],Mr.disabled,Zr.disabled);for(const oe of te)Qh(oe,g,h,X[oe.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const oe of ee)Qh(oe,g,h,X[oe.modelIndex],Mr.disabled,g.colorModeForRenderPass());M()}else{for(const oe of te)pm(oe.mesh,oe.nodeModelMatrix,g,h);for(const oe of ee)pm(oe.mesh,oe.nodeModelMatrix,g,h);M()}}},ef={line:function(g,s,h){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const m=s.getVisibleCoordinates();for(const x of m){const b=s.getTile(x).getBucket(g);if(b&&(b.elevationType!=="none"?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,s,h){const m=s.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,m.type==="vector"?g.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const x=m.getModels();for(const b of x)b.upload(h.context)},raster:function(g,s,h){const m=s.getSource();if(!(m instanceof Iu&&m.loaded()))return;const x=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const b=g.paint.get("raster-array-band")||m.getInitialBand(x);if(b==null)return;const E=s.getIds().map(P=>s.getTileByID(P));for(const P of E)P.updateNeeded(g.id,b)&&m.prepareTile(P,x,g.id,b)},"raster-particle":function(g,s,h){const m=s.getSource();if(!(m instanceof Iu&&m.loaded()))return;const x=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const b=g.paint.get("raster-particle-array-band")||m.getInitialBand(x);if(b==null)return;const E=s.getIds().map(P=>s.getTileByID(P));for(const P of E)P.updateNeeded(g.id,b)&&m.prepareTile(P,x,g.id,b)}},tf={fill:qh},qu={fill:function(g,s,h,m){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const x=g.context.gl,b=new or(x.LEQUAL,or.ReadOnly,g.depthRangeFor3D),E=new Mr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),P=g.transform.getFreeCameraOptions().position,M=g.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const B of m){const j=s.getTile(B),X=j.getBucket(h);if(!X)continue;const W=X.elevatedStructures;if(!W||W.depthSegments.segments[0].primitiveLength===0)continue;const Y=rT(B.toUnwrapped(),P),ee=g.translatePosMatrix(B.projMatrix,j,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor")),te=Pg(ee,Y,0,1,0);M.draw(g,x.TRIANGLES,b,E,Zr.disabled,Lr.disabled,te,h.id,W.vertexBuffer,W.indexBuffer,W.depthSegments,h.paint,g.transform.zoom)}}};class kx{constructor(s,h,m,x,b,E){this.context=new vx(s,h),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=i.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const P=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const B of P)this._debugParams.enabledLayers[B]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const B of P)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],B);this.occlusionParams=new Gg(b),this.setup(),this.numSublayers=Ns.maxUnderzooming+Ns.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.eG,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new yI(this),this._wireframeDebugCache=new hT,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const M=new i.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,M,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x,this.worldview=E}updateTerrain(s,h){const m=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new cm(this,s));const x=this._terrain;this.transform.elevation=m?x:null,x.update(s,this.transform,h),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(s){const h=s.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,x]=h.getFovAdjustedRange(this.transform._fov);if(m>x)return void(this.transform.fogCullDistSq=null);const b=m+.78*(x-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new cm(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,h){if(this.width=s*i.o.devicePixelRatio,this.height=h*i.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const s=this.context,h=new i.bd;h.emplaceBack(0,0),h.emplaceBack(i.al,0),h.emplaceBack(0,i.al),h.emplaceBack(i.al,i.al),this.tileExtentBuffer=s.createVertexBuffer(h,i.bf.members),this.tileExtentSegments=i.bg.simpleSegment(0,0,4,2);const m=new i.bd;m.emplaceBack(0,0),m.emplaceBack(i.al,0),m.emplaceBack(0,i.al),m.emplaceBack(i.al,i.al),this.debugBuffer=s.createVertexBuffer(m,i.bf.members),this.debugSegments=i.bg.simpleSegment(0,0,4,5);const x=new i.bd;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(x,i.bf.members),this.viewportSegments=i.bg.simpleSegment(0,0,4,2);const b=new i.b0;b.emplaceBack(0,0,0,0),b.emplaceBack(i.al,0,i.al,0),b.emplaceBack(0,i.al,0,i.al),b.emplaceBack(i.al,i.al,i.al,i.al),this.mercatorBoundsBuffer=s.createVertexBuffer(b,i.bi.members),this.mercatorBoundsSegments=i.bg.simpleSegment(0,0,4,2);const E=new i.b1;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(E);const P=new i.be;for(const B of[0,1,3,2,0])P.emplaceBack(B);this.debugIndexBuffer=s.createIndexBuffer(P),this.emptyTexture=new i.T(s,new i.q({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.bC();const M=this.context.gl;this.stencilClearMode=new Mr({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,or.disabled,this.stencilClearMode,Zr.disabled,Lr.disabled,$h(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,h,m){if(!h||this.currentStencilSource===h.id||!s.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const M of m)if(this._tileClippingMaskIDs[M.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=h.id;const x=this.context,b=x.gl;this.nextStencilID+m.length>256&&this.clearStencil(),x.setColorMode(Zr.disabled),x.setDepthMode(or.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of m){const M=h.getTile(P),B=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:X,tileBoundsSegments:W}=this.getTileBoundsBuffers(M);E.draw(this,b.TRIANGLES,or.disabled,new Mr({func:b.ALWAYS,mask:0},B,255,b.KEEP,b.KEEP,b.REPLACE),Zr.disabled,Lr.disabled,$h(P.projMatrix),"$clipping",j,X,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,h=this.context.gl;return new Mr({func:h.NOTEQUAL,mask:255},s,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const h=this.context.gl;return new Mr({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(s){const h=this.context.gl,m=s.sort((E,P)=>P.overscaledZ-E.overscaledZ),x=m[m.length-1].overscaledZ,b=m[0].overscaledZ-x+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const E={};for(let P=0;P<b;P++)E[P+x]=new Mr({func:h.GEQUAL,mask:255},P+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=b,[E,m]}return[{[x]:Mr.disabled},m]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Zr([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Zr.unblended:Zr.alphaBlended}colorModeForDrapableLayerRenderPass(s){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Zr([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new i.ao(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,h,m,x=!1){if(this.depthOcclusion)return new or(this.context.gl.GREATER,or.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return or.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new or(m||this.context.gl.LEQUAL,h,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,h=Math.ceil(this.width),m=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),b=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===h&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),h!==0&&m!==0&&(this.depthFBO=new Dg(this.context,h,m,!1,"texture"),this.depthTexture=new i.T(this.context,{width:h,height:m,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),s.bindTexture(s.TEXTURE_2D,b),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,h,m,0,0,h,m,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,h)=>s+h/this._fpsHistory.length,0))}render(s,h){const m=i.o.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=h;const x=this.style._mergedLayers,b=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(b).filter(lt=>{const He=x[lt];return!(He.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[He.type]});let P=E(),M=!1,B=!1,j=null;for(const lt of P){const He=x[lt];He.type==="circle"?M=!0:He.type==="building"?j=He:He.type==="symbol"&&(He.hasOcclusionOpacityProperties?B=!0:M=!0)}let X=P.map(lt=>x[lt]);const W=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.o.now()),this.imageManager.beginFrame();let Y=0,ee=!1;for(const lt in W){const He=W[lt];He.used&&(He.prepare(this.context),He.getSource().usedInConflation&&++Y)}let te=!1;for(const lt of X)lt.isHidden(this.transform.zoom)||(lt.type==="clip"&&(te=!0),this.prepareLayer(lt));const ce={},oe={},de={},xe={},Ee={};for(const lt in W){const He=W[lt];ce[lt]=He.getVisibleCoordinates(),oe[lt]=ce[lt].slice().reverse(),de[lt]=He.getVisibleCoordinates(!0).reverse(),xe[lt]=He.getShadowCasterCoordinates(),Ee[lt]=He.sortCoordinatesByDistance(ce[lt])}const De=lt=>{const He=this.style.getLayerSourceCache(lt);return He&&He.used?He.getSource():null};if(Y||te||this._clippingActiveLastFrame){const lt=[],He=[];let Tt=0;for(const ht of X)this.isSourceForClippingOrConflation(ht,De(ht))&&(lt.push(ht),He.push(Tt)),Tt++;if(lt&&(te||lt.length>1)||this._clippingActiveLastFrame){te=!1;const ht=[];for(let Ft=0;Ft<lt.length;Ft++){const Gt=lt[Ft],tr=He[Ft],Ut=this.style.getLayerSourceCache(Gt);if(!Ut||!Ut.used||!Ut.getSource().usedInConflation&&Gt.type!=="clip"&&Gt.type!=="building")continue;let Bt=i.eH,vr=i.bZ.None;const mr=[];let _r=!0;if(Gt.type==="building")Bt=i.eJ;else if(Gt.type==="clip"){Bt=tr;for(const pr of Gt.layout.get("clip-layer-types"))vr|=pr==="model"?i.bZ.Model:pr==="symbol"?i.bZ.Symbol:i.bZ.FillExtrusion;for(const pr of Gt.layout.get("clip-layer-scope"))mr.push(pr);Gt.isHidden(this.transform.zoom)?_r=!1:te=!0}_r&&ht.push({layer:Gt.fqid,cache:Ut,order:Bt,clipMask:vr,clipScope:mr})}this.replacementSource.setSources(ht),ee=!0}}this._clippingActiveLastFrame=te,ee||this.replacementSource.clear(),this.conflationActive=ee,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let lt=0;lt<X.length;lt++){const He=X[lt],Tt=He.cutoffRange();if(this.longestCutoffRange=Math.max(Tt,this.longestCutoffRange),Tt>0){const ht=De(He);ht&&(this.minCutoffZoom=Math.max(ht.minzoom,this.minCutoffZoom)),He.minzoom&&(this.minCutoffZoom=Math.max(He.minzoom,this.minCutoffZoom))}He.is3D(b)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=lt),this._lastOcclusionLayer=lt)}const Me=this.style&&this.style.fog;Me?(this._fogVisible=Me.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Me.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(de),this.opaquePassCutoff=0,P=E(),X=P.map(lt=>x[lt]));const Fe=this._shadowRenderer;if(Fe){Fe.updateShadowParameters(this.transform,this.style.directionalLight);for(const lt in W)for(const He of ce[lt]){let Tt={min:0,max:0};this.terrain&&(Tt=this.terrain.getMinMaxForTile(He)||Tt),Fe.addShadowReceiver(He.toUnwrapped(),Tt.min,Tt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eI(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new md(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Re=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Oe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Re&&!this._snow&&(this._snow=new mT(this)),!Re&&this._snow&&(this._snow.destroy(),delete this._snow),Oe&&!this._rain&&(this._rain=new ci(this)),!Oe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),j){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Ii);const lt=this.style.getLayerSourceCache(j);this.buildingTileBorderManager.updateBorders(lt,j)}if(!Sr.has(this.context.gl))return;this.renderPass="offscreen";for(const lt of X){const He=s.getLayerSourceCache(lt);if(!lt.hasOffscreenPass()||lt.isHidden(this.transform.zoom))continue;const Tt=He?oe[He.id]:void 0;(lt.type==="custom"||lt.type==="raster"||lt.type==="raster-particle"||lt.isSky()||Tt&&Tt.length)&&this.renderLayer(this,He,lt,Tt)}this.depthRangeFor3D=[0,1-(X.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,xe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Le=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),ct=(()=>{if(h.showOverdrawInspector)return i.ao.black;const lt=this.style.fog;if(lt&&this.transform.projection.supportsFog){const He=this.style.getLut(lt.scope);if(!Le){const Tt=lt.properties.get("color-use-theme")==="none",ht=lt.properties.get("color").toNonPremultipliedRenderColor(Tt?null:He).toArray01();return new i.ao(...ht)}if(Le){const Tt=lt.properties.get("space-color-use-theme")==="none",ht=lt.properties.get("space-color").toNonPremultipliedRenderColor(Tt?null:He).toArray01();return new i.ao(...ht)}}return i.ao.transparent})();if(this.context.clear({color:ct,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Le&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const lt=X[this.currentLayer],He=s.getLayerSourceCache(lt);if(lt.isSky())continue;const Tt=He?(lt.is3D(b)?Ee:oe)[He.id]:void 0;this._renderTileClippingMasks(lt,He,Tt),this.renderLayer(this,He,lt,Tt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Le&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const lt=X[this.currentLayer],He=s.getLayerSourceCache(lt);lt.isSky()&&this.renderLayer(this,He,lt,He?oe[He.id]:void 0)}function Ke(lt,He){let Tt;return He&&(Tt=(lt.type==="symbol"?de:lt.is3D(b)?Ee:oe)[He.id]),Tt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<P.length;){const lt=X[this.currentLayer];if(lt.type==="raster"||lt.type==="raster-particle"){const He=s.getLayerSourceCache(lt);this.renderLayer(this,He,lt,Ke(lt,He))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let vt=0;Fe&&(vt=Fe.getShadowCastingLayerCount());let st=!1,_t=-1;for(let lt=0;lt<P.length;++lt){const He=X[lt];He.isHidden(this.transform.zoom)||He.is3D(b)&&(_t=lt)}B&&_t===-1&&(M=!0);let Ht=!1;for(;this.currentLayer<P.length;){const lt=X[this.currentLayer],He=s.getLayerSourceCache(lt);if(lt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(lt)){if(lt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Ht&&lt.is3D(b)&&!b){const Tt=this.currentLayer,ht=Ft=>{for(this.currentLayer=0;this.currentLayer<X.length;this.currentLayer++){const Gt=X[this.currentLayer];if(tf[Gt.type]){const tr=this.style.getLayerSourceCache(Gt);tf[Gt.type](this,tr,Gt,Ke(Gt,tr),Ft)}}};ht("initialize"),ht("reset"),this.currentLayer=Tt,Ht=!0}if(M&&!st&&this.terrain&&!this.transform.isOrthographic&&(st=!0,this.blitDepth()),B&&_t!==-1&&this.currentLayer===_t+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(lt,He,He?ce[He.id]:void 0),this.renderLayer(this,He,lt,Ke(lt,He)),!this.terrain&&Fe&&vt>0&&lt.hasShadowPass()&&--vt==0){{this.clearStencil(),this.resetStencilClippingMasks();const Tt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<X.length;this.currentLayer++){const ht=X[this.currentLayer];if(qu[ht.type]){const Ft=this.style.getLayerSourceCache(ht);qu[ht.type](this,Ft,ht,Ke(ht,Ft))}}this.currentLayer=Tt}if(Fe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Tt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Tt;this.currentLayer++){const ht=X[this.currentLayer];if(!ht.hasLightBeamPass())continue;const Ft=s.getLayerSourceCache(ht);this.renderLayer(this,Ft,ht,Ft?oe[Ft.id]:void 0)}this.currentLayer=Tt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Tt=this.currentLayer;this.depthOcclusion=!0;for(const ht of this.layersWithOcclusionOpacity){this.currentLayer=ht;const Ft=X[this.currentLayer],Gt=s.getLayerSourceCache(Ft),tr=Gt?oe[Gt.id]:void 0;this.terrain||this._renderTileClippingMasks(Ft,Gt,Gt?ce[Gt.id]:void 0),this.renderLayer(this,Gt,Ft,tr)}this.depthOcclusion=!1,this.currentLayer=Tt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let lt=null;X.forEach(He=>{const Tt=s.getLayerSourceCache(He);Tt&&!He.isHidden(this.transform.zoom)&&Tt.getVisibleCoordinates().length&&(!lt||lt.getSource().maxzoom<Tt.getSource().maxzoom)&&(lt=Tt)}),lt&&this.options.showTileBoundaries&&Ug(this,lt,lt.getVisibleCoordinates(),i.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Ug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(lt){const He=lt.transform.padding;ac(lt,lt.transform.height-(He.top||0),3,$o),ac(lt,He.bottom||0,3,Wu),Kn(lt,He.left||0,3,aT),Kn(lt,lt.transform.width-(He.right||0),3,Sx);const Tt=lt.transform.centerPoint;(function(ht,Ft,Gt,tr){Zh(ht,Ft-1,Gt-10,2,20,tr),Zh(ht,Ft-10,Gt-1,20,2,tr)})(lt,Tt.x,lt.transform.height-Tt.y,Ex)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ee||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:h}=this.transform.projection,m=!h||!h.includes(s.type);if(ef[s.type]&&(m||this.terrain&&s.type==="custom")){const x=this.style.getLayerSourceCache(s);ef[s.type](s,x,this)}this.gpuTimingEnd()}renderLayer(s,h,m,x){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||x&&x.length)&&(this.id=m.id,this.gpuTimingStart(m),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(m.type)&&(!s.terrain||m.type!=="custom")||m.type==="clip"||Hu[m.type](s,h,m,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,m=this.context.gl;let x=this.gpuTimers[s.id];x||(x=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:m.createQuery()}),x.calls++,m.beginQuery(h.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,h=this.context.gl,m=h.createQuery();this.deferredRenderGpuTimeQueries.push(m),h.beginQuery(s.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const h={};for(const m in s){const x=s[m],b=this.context.extTimerQuery,E=b.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(x.query),h[m]=E}return h}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.gl;let m=0;for(const x of s)m+=h.getQueryParameter(x,h.QUERY_RESULT)/1e6,h.deleteQuery(x);return m}translatePosMatrix(s,h,m,x,b){if(!m[0]&&!m[1])return s;const E=b?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(E){const B=Math.sin(E),j=Math.cos(E);m=[m[0]*j-m[1]*B,m[0]*B+m[1]*j]}const P=[b?m[0]:i.ay(h,m[0],this.transform.zoom),b?m[1]:i.ay(h,m[1],this.transform.zoom),0],M=new Float32Array(16);return i.br(M,s,P),M}saveTileTexture(s){if(s.context!==this.context)return;const h=s.size[0],m=this._tileTextures[h];m?m.push(s):this._tileTextures[h]=[s]}getTileTexture(s){const h=this._tileTextures[s];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,h,m){const x=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,b=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||x||h!==void 0&&!h||b.push("FOG","FOG_DITHERING"),x&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(s,h){this.cache=this.cache||{};const m=h&&h.defines||[],x=h&&h.config,b=this.currentGlobalDefines(s,h&&h.overrideFog,h&&h.overrideRtt).concat(m),E=Cg.cacheKey(pg[s],s,b,x);return this.cache[E]||(this.cache[E]=new Cg(this.context,s,pg[s],x,zI[s],b)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,h){if(this.style.enable3dLights()){const m=this.style.directionalLight,x=this.style.ambientLight;if(m&&x){const b=((E,P,M)=>{const B=E.properties.get("direction"),j=E.properties.get("color-use-theme")==="none",X=E.properties.get("color").toNonPremultipliedRenderColor(j?null:M.getLut(E.scope)).toArray01(),W=E.properties.get("intensity"),Y=P.properties.get("color-use-theme")==="none",ee=P.properties.get("color").toNonPremultipliedRenderColor(Y?null:M.getLut(P.scope)).toArray01(),te=P.properties.get("intensity"),ce=[B.x,B.y,B.z],oe=i.dK(ee,te),de=i.dK(X,W);return{u_lighting_ambient_color:oe,u_lighting_directional_dir:ce,u_lighting_directional_color:de,u_ground_radiance:Ag(ce,de,oe)}})(m,x,this.style);h.setLightsUniformValues(s,b)}}}uploadCommonUniforms(s,h,m,x,b){if(this.uploadCommonLightUniforms(s,h),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const P=E.getOpacity(this.transform.pitch),M=((B,j,X,W,Y,ee,te,ce,oe,de,xe,Ee)=>{const De=B.transform,Me=j.properties.get("color-use-theme")==="none",Fe=j.properties.get("color").toNonPremultipliedRenderColor(Me?null:B.style.getLut(j.scope)).toArray01();Fe[3]=W;const Re=B.frameCounter/1e3%1,[Oe,Le]=j.properties.get("vertical-range");return{u_fog_matrix:X?De.calculateFogTileMatrix(X):Ee||B.identityMat,u_fog_range:j.getFovAdjustedRange(De._fov),u_fog_color:Fe,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Oe,Le),Le],u_fog_temporal_offset:Re,u_frustum_tl:Y,u_frustum_tr:ee,u_frustum_br:te,u_frustum_bl:ce,u_globe_pos:oe,u_globe_radius:de,u_viewport:xe,u_globe_transition:i.aj(De.zoom),u_is_globe:+(De.projection.name==="globe")}})(this,E,m,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.o.devicePixelRatio,this.transform.height*i.o.devicePixelRatio],x);h.setFogUniformValues(s,M)}b&&h.setCutoffUniformValues(s,b.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,h=s.createTexture();return s.bindTexture(s.TEXTURE_2D,h),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,h=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const x of m)h[x.key]=s[x.key]||new Ou(x,512,this.transform.tileZoom,this,void 0,this.worldview);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,h){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&s.type!=="building"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building"&&s.sourceLayer!=="procedural_buildings")&&(!h||h.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[s.key];return h||(this._cachedTileFogOpacities[s.key]=h=this.style.fog.getOpacityForTile(s)),h[0]>=ot||h[1]>=ot}setupDepthForOcclusion(s,h,m){const x=this.context,b=x.gl,E=!!m;var P;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(b.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((P=this.depthRangeFor3D)[1]-P[0]),-1-2*P[0]/(P[1]-P[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),x.activeTexture.set(b.TEXTURE0),E||h.setTerrainUniformValues(x,m)}}function Hg(g,s){let h=!1,m=null;const x=()=>{m=null,h&&(g(),m=setTimeout(x,s),h=!1)};return()=>(h=!0,m||x(),m)}class Ox{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Hg(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const h=qg(s);if(this._hashName){const m=this._hashName;let x=!1;const b=location.hash.slice(1).split("&").map(E=>{const P=E.split("=")[0];return P===m?(x=!0,`${P}=${h}`):E}).filter(E=>E);return x||b.push(`${m}=${h}`),`#${b.join("&")}`}return`#${h}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(h=m)}),(h&&h[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(m=>isNaN(Number(m)))){const m=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(h[3]||0):s.getBearing();return s.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:m,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function qg(g,s){const h=g.getCenter(),m=Math.round(100*g.getZoom())/100,x=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,x),E=Math.round(h.lng*b)/b,P=Math.round(h.lat*b)/b,M=g.getBearing(),B=g.getPitch();let j=s?`/${E}/${P}/${m}`:`${m}/${P}/${E}`;return(M||B)&&(j+="/"+Math.round(10*M)/10),B&&(j+=`/${Math.round(B)}`),j}const ns={linearity:.3,easing:i.eK(0,0,.3,1)},Xu=Object.assign({deceleration:2500,maxSpeed:1400},ns),vd=Object.assign({deceleration:20,maxSpeed:1400},ns),Xg=Object.assign({deceleration:1e3,maxSpeed:360},ns),Mx=Object.assign({deceleration:1e3,maxSpeed:90},ns);class Rx{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.o.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,h=i.o.now();for(;s.length>0&&h-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)h.zoom+=b.zoomDelta||0,h.bearing+=b.bearingDelta||0,h.pitch+=b.pitchDelta||0,b.panDelta&&h.pan._add(b.panDelta),b.around&&(h.around=b.around),b.pinchAround&&(h.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const b=xd(h.pan.mag(),m,Object.assign({},Xu,s||{}));x.offset=h.pan.mult(b.amount/h.pan.mag()),x.center=this._map.transform.center,kl(x,b)}if(h.zoom){const b=xd(h.zoom,m,vd);x.zoom=this._map.transform.zoom+b.amount,kl(x,b)}if(h.bearing){const b=xd(h.bearing,m,Xg);x.bearing=this._map.transform.bearing+i.aA(b.amount,-179,179),kl(x,b)}if(h.pitch){const b=xd(h.pitch,m,Mx);x.pitch=this._map.transform.pitch+b.amount,kl(x,b)}if(x.zoom||x.bearing){const b=h.pinchAround===void 0?h.around:h.pinchAround;x.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function kl(g,s){(!g.duration||g.duration<s.duration)&&(g.duration=s.duration,g.easing=s.easing)}function xd(g,s,h){const{maxSpeed:m,linearity:x,deceleration:b}=h,E=i.aA(g*x/(s/1e3),-m,m),P=Math.abs(E)/(b*x);return{easing:h.easing,duration:1e3*P,amount:E*(P/2)}}class ma extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,m,x={}){const b=ge(h.getCanvasContainer(),m),E=h.unproject(b);super(s,Object.assign({point:b,lngLat:E,originalEvent:m},x)),this._defaultPrevented=!1,this.target=h}}class wd extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,m){const x=s==="touchend"?m.changedTouches:m.touches,b=ve(h.getCanvasContainer(),x),E=b.map(M=>h.unproject(M)),P=b.reduce((M,B,j,X)=>M.add(B.div(X.length)),new i.P(0,0));super(s,{points:b,point:P,lngLats:E,lngLat:h.unproject(P),originalEvent:m}),this._defaultPrevented=!1}}class Zg extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h){super("wheel",{originalEvent:h}),this._defaultPrevented=!1}}class Dx{constructor(s,h){this._map=s,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new Zg(this._map,s))}mousedown(s,h){return this._mousedownPos=h,this._firePreventable(new ma(s.type,this._map,s))}mouseup(s){this._map.fire(new ma(s.type,this._map,s))}preclick(s){const h=new MouseEvent("preclick",s);this._map.fire(new ma(h.type,this._map,h))}click(s,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(s),this._map.fire(new ma(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new ma(s.type,this._map,s))}mouseover(s){this._map.fire(new ma(s.type,this._map,s))}mouseout(s){this._map.fire(new ma(s.type,this._map,s))}touchstart(s){return this._firePreventable(new wd(s.type,this._map,s))}touchmove(s){this._map.fire(new wd(s.type,this._map,s))}touchend(s){this._map.fire(new wd(s.type,this._map,s))}touchcancel(s){this._map.fire(new wd(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fx{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new ma(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ma("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new ma(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ta{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,h){this.isEnabled()&&s.shiftKey&&s.button===0&&(J(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(s,h){if(!this._active)return;const m=h,x=this._startPos,b=this._lastPos;if(!x||!b||b.equals(m)||!this._box&&m.dist(x)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=R("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const E=Math.min(x.x,m.x),P=Math.max(x.x,m.x),M=Math.min(x.y,m.y),B=Math.max(x.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${M}px)`,this._box.style.width=P-E+"px",this._box.style.height=B-M+"px")})}mouseupWindow(s,h){if(!this._active)return;const m=this._startPos,x=h;if(m&&s.button===0){if(this.reset(),re(),m.x!==x.x||m.y!==x.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:s})),{cameraAnimation:b=>b.fitScreenCoordinates(m,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(s,h){return this._map.fire(new i.z(s,{originalEvent:h}))}}function gm(g,s){const h={};for(let m=0;m<g.length;m++)h[g[m].identifier]=s[m];return h}class Lx{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,h,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),m.length===this.numTouches&&(this.centroid=function(x){const b=new i.P(0,0);for(const E of x)b._add(E);return b.div(x.length)}(h),this.touches=gm(m,h)))}touchmove(s,h,m){if(this.aborted||!this.centroid)return;const x=gm(m,h);for(const b in this.touches){const E=x[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(s,h,m){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class _m{constructor(s){this.singleTap=new Lx(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,h,m){this.singleTap.touchstart(s,h,m)}touchmove(s,h,m){this.singleTap.touchmove(s,h,m)}touchend(s,h,m){const x=this.singleTap.touchend(s,h,m);if(x){const b=s.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(x)<30;if(b&&E||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class rf{constructor(){this._zoomIn=new _m({numTouches:1,numTaps:2}),this._zoomOut=new _m({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,h,m){this._zoomIn.touchstart(s,h,m),this._zoomOut.touchstart(s,h,m)}touchmove(s,h,m){this._zoomIn.touchmove(s,h,m),this._zoomOut.touchmove(s,h,m)}touchend(s,h,m){const x=this._zoomIn.touchend(s,h,m),b=this._zoomOut.touchend(s,h,m);return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(x)},{originalEvent:s})}):b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(b)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Nx={0:1,2:2},Yg={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class ym{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,h){return!1}_move(s,h){return{}}mousedown(s,h){if(this._lastPoint)return;const m=$e(s);this._correctButton(s,m)&&(this._lastPoint=h,this._eventButton=m)}mousemoveWindow(s,h){const m=this._lastPoint;if(m){if(s.preventDefault(),this._eventButton!=null&&function(x,b){const E=Nx[b];return x.buttons===void 0||(x.buttons&E)!==E}(s,this._eventButton))this.reset();else if(this._moved||!(h.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(m,h)}}mouseupWindow(s){this._lastPoint&&$e(s)===this._eventButton&&(this._moved&&re(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bd extends ym{mousedown(s,h){super.mousedown(s,h),this._lastPoint&&(this._active=!0)}_correctButton(s,h){return h===0&&!s.ctrlKey}_move(s,h){return{around:h,panDelta:h.sub(s)}}}class Kg extends ym{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Yg[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const m=.8*(h.x-s.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Jg extends ym{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Yg[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const m=-.5*(h.y-s.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Bx{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),i.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,h,m){return this._calculateTransform(s,h,m)}touchmove(s,h,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!i.eL())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,h,m)}}touchend(s,h,m){this._calculateTransform(s,h,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,h,m){m.length>0&&(this._active=!0);const x=gm(m,h),b=new i.P(0,0),E=new i.P(0,0);let P=0;for(const B in x){const j=x[B],X=this._touches[B];X&&(b._add(j),E._add(j.sub(X)),P++,x[B]=j)}if(this._touches=x,P<this._minTouches||!E.mag())return;const M=E.div(P);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(P),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Td{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,h,m){return{}}touchstart(s,h,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([h[0],h[1]]))}touchmove(s,h,m){const x=this._firstTwoTouches;if(!x)return;s.preventDefault();const[b,E]=x,P=Sd(m,h,b),M=Sd(m,h,E);if(!P||!M)return;const B=this._aroundCenter?null:P.add(M).div(2);return this._move([P,M],B,s)}touchend(s,h,m){if(!this._firstTwoTouches)return;const[x,b]=this._firstTwoTouches,E=Sd(m,h,x),P=Sd(m,h,b);E&&P||(this._active&&re(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sd(g,s,h){for(let m=0;m<g.length;m++)if(g[m].identifier===h)return s[m]}function Qg(g,s){return Math.log2(g/s)}class gT extends Td{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,h){const m=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Qg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qg(this._distance,m),pinchAround:h}}}function zx(g,s){return 180*g.angleWith(s)/Math.PI}class _T extends Td{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,h){const m=this._vector;if(this._vector=s[0].sub(s[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:zx(this._vector,m),pinchAround:h}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const h=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const x=zx(s,m);return Math.abs(x)<h}}function e_(g){return Math.abs(g.y)>Math.abs(g.x)}class yT extends Td{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,e_(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,h,m){const x=this._lastPoints;if(!x)return;const b=s[0].sub(x[0]),E=s[1].sub(x[1]);return this._map._cooperativeGestures&&!i.eL()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,E,m.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(b.y+E.y)/2*-.5})}gestureBeginsVertically(s,h,m){if(this._valid!==void 0)return this._valid;const x=s.mag()>=2,b=h.mag()>=2;if(!x&&!b)return;if(!x||!b)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const E=s.y>0==h.y>0;return e_(s)&&e_(h)&&E}}const vT={panStep:100,bearingStep:15,pitchStep:10};class xT{constructor(){const s=vT;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let h=0,m=0,x=0,b=0,E=0;switch(s.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:s.shiftKey?m=-1:(s.preventDefault(),b=-1);break;case 39:s.shiftKey?m=1:(s.preventDefault(),b=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),E=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(m=0,x=0),{cameraAnimation:P=>{const M=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:wT,zoom:h?Math.round(M)+h*(s.shiftKey?2:1):M,bearing:P.getBearing()+m*this._bearingStep,pitch:P.getPitch()+x*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:P.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wT(g){return g*(2-g)}const jx=4.000244140625,bT=1/450;class TT{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=bT,i.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.eL()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const m=i.o.now(),x=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,h!==0&&h%jx==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),s.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=s,this._delta-=h,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ge(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>jx?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&j!==0&&(j=1/j);const X=h(),W=Math.pow(2,X),Y=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(Y*j))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:h(),x=this._startZoom,b=this._easing;let E,P=!1;if(this._type==="wheel"&&x&&b){const B=Math.min((i.o.now()-this._lastWheelEventTime)/200,1),j=b(B);E=i.ak(x,m,j),B<1?this._frameId||(this._frameId=!0):P=!0}else E=m,P=!0;this._active=!0,P&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let M=E-h();return M*this._lastDelta<0&&(M=0),{noInertia:!0,needsRenderFrame:!P,zoomDelta:M,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let h=i.eM;if(this._prevEase){const m=this._prevEase,x=(i.o.now()-m.start)/m.duration,b=m.easing(x+.01)-m.easing(x),E=.27/Math.sqrt(b*b+1e-4)*.01,P=Math.sqrt(.0729-E*E);h=i.eK(E,P,.25,1)}return this._prevEase={start:i.o.now(),duration:s,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ST{constructor(s,h){this._clickZoom=s,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ET{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,h){return s.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(s.shiftKey?-1:1),around:m.unproject(h)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class HI{constructor(){this._tap=new _m({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,h,m){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=h[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(s,h,m))}touchmove(s,h,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const x=h[0],b=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,h,m)}touchend(s,h,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(s,h,m)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qI{constructor(s,h,m){this._el=s,this._mousePan=h,this._touchPan=m}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class XI{constructor(s,h,m){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=h,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ti{constructor(s,h,m,x){this._el=s,this._touchZoom=h,this._touchRotate=m,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vm=g=>g.zoom||g.drag||g.pitch||g.rotate;class ZI extends i.z{}class YI{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,h){const m=i.av([],h,s);this.radius=i.ag(m[2]<0?i.eO([],m,this.constants):[m[0],m[1],0])}projectRay(s){i.eO(s,s,this.constants),i.aw(s,s),i.eP(s,s,this.constants);const h=i.c4([],s,this.radius);if(h[2]>0){const m=i.c4([],[0,0,1],i.bJ(h,[0,0,1])),x=i.c4([],i.aw([],[h[0],h[1],0]),this.radius),b=i.d7([],h,i.c4([],i.av([],i.d7([],x,m),h),2));h[0]=b[0],h[1]=b[1]}return h}}function t_(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class xm{constructor(s,h){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rx(s),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new YI,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),i.aY(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,b,E]of this._listeners){const P=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(b,P,E)}}destroy(){for(const[s,h,m]of this._listeners){const x=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(h,x,m)}}_addDefaultHandlers(s){const h=this._map,m=h.getCanvasContainer();this._add("mapEvent",new Dx(h,s));const x=h.boxZoom=new Ta(h,s);this._add("boxZoom",x);const b=new rf,E=new ET;h.doubleClickZoom=new ST(E,b),this._add("tapZoom",b),this._add("clickZoom",E);const P=new HI;this._add("tapDragZoom",P);const M=h.touchPitch=new yT(h);this._add("touchPitch",M);const B=new Kg(s),j=new Jg(s);h.dragRotate=new XI(s,B,j),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const X=new bd(s),W=new Bx(h,s);h.dragPan=new qI(m,X,W),this._add("mousePan",X),this._add("touchPan",W,["touchZoom","touchRotate"]);const Y=new _T,ee=new gT;h.touchZoomRotate=new Ti(m,ee,Y,P),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fx(h));const te=h.scrollZoom=new TT(h,this);this._add("scrollZoom",te,["mousePan"]);const ce=h.keyboard=new xT;this._add("keyboard",ce);for(const oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[oe]&&h[oe].enable(s[oe])}_add(s,h,m){this._handlers.push({handlerName:s,handler:h,allowed:m}),this._handlersById[s]=h}stop(s){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vm(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,h,m){for(const x in s)if(x!==m&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const h=[];for(const m of s)this._el.contains(m.target)&&h.push(m);return h}handleEvent(s,h){this._updatingCamera=!0;const m=s.type==="renderFrame",x=m?void 0:s,b={needsRenderFrame:!1},E={},P={},M=s.touches?this._getMapTouches(s.touches):void 0,B=M?ve(this._el,M):m?void 0:ge(this._el,s);for(const{handlerName:W,handler:Y,allowed:ee}of this._handlers){if(!Y.isEnabled())continue;let te;this._blockedByActive(P,ee,W)?Y.reset():Y[h||s.type]&&(te=Y[h||s.type](s,B,M),this.mergeHandlerResult(b,E,te,W,x),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||Y.isActive())&&(P[W]=Y)}const j={};for(const W in this._previousActiveHandlers)P[W]||(j[W]=x);this._previousActiveHandlers=P,(Object.keys(j).length||t_(b))&&(this._changes.push([b,E,j]),this._triggerRenderFrame()),(Object.keys(P).length||t_(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=b;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(s,h,m,x,b){if(!m)return;Object.assign(s,m);const E={handlerName:x,originalEvent:m.originalEvent||b};m.zoomDelta!==void 0&&(h.zoom=E),m.panDelta!==void 0&&(h.drag=E),m.pitchDelta!==void 0&&(h.pitch=E),m.bearingDelta!==void 0&&(h.rotate=E)}_applyChanges(){const s={},h={},m={};for(const[x,b,E]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(s.around=x.around),x.aroundCoord!==void 0&&(s.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),Object.assign(h,b),Object.assign(m,E);this._updateMapTransform(s,h,m),this._changes=[]}_updateMapTransform(s,h,m){const x=this._map,b=x.transform,E=de=>[de.x,de.y,de.z];if((de=>{const xe=this._eventsInProgress.drag;return xe&&!this._handlersById[xe.handlerName].isActive()})()&&!t_(s)){const de=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),de!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&x._stop(!0),!t_(s))return void this._fireEvents(h,m,!0);let{panDelta:P,zoomDelta:M,bearingDelta:B,pitchDelta:j,around:X,aroundCoord:W,pinchAround:Y}=s;b._isCameraConstrained&&(M>0&&(M=0),b._isCameraConstrained=!1),Y!==void 0&&(X=Y),(M||(de=>h[de]&&!this._eventsInProgress[de])("drag"))&&X&&(this._dragOrigin=E(b.pointCoordinate3D(X)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,B&&(b.bearing+=B),j&&(b.pitch+=j),b._updateCameraState();const ee=[0,0,0];if(P)if(b.projection.name==="mercator"){const de=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X).dir),xe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X.sub(P)).dir);ee[0]=xe[0]-de[0],ee[1]=xe[1]-de[1]}else{const de=b.pointCoordinate(X);if(b.projection.name==="globe"){P=P.rotate(-b.angle);const xe=b._pixelsPerMercatorPixel/b.worldSize;ee[0]=-P.x*i.eN(i.a$(de.y))*xe,ee[1]=-P.y*i.eN(b.center.lat)*xe}else{const xe=b.pointCoordinate(X.sub(P));de&&xe&&(ee[0]=xe.x-de.x,ee[1]=xe.y-de.y)}}const te=b.zoom,ce=[0,0,0];if(M){const de=E(W||b.pointCoordinate3D(X)),xe={dir:i.aw([],i.av([],de,b._camera.position))};if(xe.dir[2]<0){const Ee=b.zoomDeltaToMovement(de,M);i.c4(ce,xe.dir,Ee)}}const oe=i.d7(ee,ee,ce);b._translateCameraConstrained(oe),M&&Math.abs(b.zoom-te)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(h,m,!0)}_fireEvents(s,h,m){const x=vm(this._eventsInProgress),b=vm(s),E={};for(const j in s){const{originalEvent:X}=s[j];this._eventsInProgress[j]||(E[`${j}start`]=X),this._eventsInProgress[j]=s[j]}!x&&b&&this._fireEvent("movestart",b.originalEvent);for(const j in E)this._fireEvent(j,E[j]);b&&this._fireEvent("move",b.originalEvent);for(const j in s){const{originalEvent:X}=s[j];this._fireEvent(j,X)}const P={};let M;for(const j in this._eventsInProgress){const{handlerName:X,originalEvent:W}=this._eventsInProgress[j];this._handlersById[X].isActive()||(delete this._eventsInProgress[j],M=h[X]||W,P[`${j}end`]=M)}for(const j in P)this._fireEvent(j,P[j]);const B=vm(this._eventsInProgress);if(m&&(x||b)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;j?(X(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:M})):(this._map.fire(new i.z("moveend",{originalEvent:M})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,h){this._map.fire(new i.z(s,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new ZI("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ux="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class $x extends i.E{constructor(s,h){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,i.aY(["_renderFrameCallback"],this)}getCenter(){return new i.aR(this.transform.center.lng,this.transform.center.lat)}setCenter(s,h){return this.jumpTo({center:s},h)}panBy(s,h,m){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,Object.assign({offset:s},h),m)}panTo(s,h,m){return this.easeTo(Object.assign({center:s},h),m)}getZoom(){return this.transform.zoom}setZoom(s,h){return this.jumpTo({zoom:s},h),this}zoomTo(s,h,m){return this.easeTo(Object.assign({zoom:s},h),m)}zoomIn(s,h){return this.zoomTo(this.getZoom()+1,s,h),this}zoomOut(s,h){return this.zoomTo(this.getZoom()-1,s,h),this}getBearing(){return this.transform.bearing}setBearing(s,h){return this.jumpTo({bearing:s},h),this}getPadding(){return this.transform.padding}setPadding(s,h){return this.jumpTo({padding:s},h),this}rotateTo(s,h,m){return this.easeTo(Object.assign({bearing:s},h),m)}resetNorth(s,h){return this.rotateTo(0,Object.assign({duration:1e3},s),h),this}resetNorthPitch(s,h){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},s),h),this}snapToNorth(s,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,h):this}getPitch(){return this.transform.pitch}setPitch(s,h){return this.jumpTo({pitch:s},h),this}cameraForBounds(s,h){s=i.aI.convert(s);const m=h&&h.bearing||0,x=h&&h.pitch||0,b=s.getNorthWest(),E=s.getSouthEast();return this._cameraForBounds(this.transform,b,E,m,x,h)}_extendPadding(s){const h={top:0,right:0,bottom:0,left:0};return s==null?Object.assign({},h,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:Object.assign({},h,s)}_extendCameraOptions(s){return(s=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,h){const m=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return m/x>s.aspect?m/(2*Math.tan(.5*s.fovX)*s.aspect):x/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,h,m,x,b,E){const P=s.clone(),M=this._extendCameraOptions(E);P.bearing=x,P.pitch=b;const B=i.aR.convert(h),j=i.aR.convert(m),X=.5*(B.lat+j.lat),W=.5*(B.lng+j.lng),Y=i.eQ(X,W),ee=i.aw([],Y),te=i.aw([],i.bI([],ee,[0,1,0])),ce=i.bI([],te,ee),oe=[te[0],te[1],te[2],0,ce[0],ce[1],ce[2],0,ee[0],ee[1],ee[2],0,0,0,0,1],de=[Y,i.eQ(B.lat,B.lng),i.eQ(j.lat,B.lng),i.eQ(j.lat,j.lng),i.eQ(B.lat,j.lng),i.eQ(X,B.lng),i.eQ(X,j.lng),i.eQ(B.lat,W),i.eQ(j.lat,W)];let xe=i.d8.fromPoints(de.map(ht=>[i.bJ(te,ht),i.bJ(ce,ht),i.bJ(ee,ht)]));const Ee=i.af([],xe.center,oe);i.eR(Ee)===0&&i.eS(Ee,0,0,1),i.aw(Ee,Ee),i.c4(Ee,Ee,i.aD),P.center=i.eT(Ee);const De=P.getWorldToCameraMatrix(),Me=i.bl(new Float64Array(16),De);xe=i.d8.applyTransform(xe,i.aB([],De,oe));const Fe=this._extendAABB(xe,P,M,x);if(!Fe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");xe=Fe,i.af(Ee,Ee,De);const Re=.5*(xe.max[2]-xe.min[2]),Oe=this._minimumAABBFrustumDistance(P,xe),Le=i.c4([],[0,0,1],Re),ct=i.d7(Le,Ee,Le),Ke=Oe+(P.pitch===0?0:i.bG(Ee,ct)),vt=P.globeCenterInViewSpace,st=i.av([],Ee,[vt[0],vt[1],vt[2]]);i.aw(st,st),i.c4(st,st,Ke);const _t=i.d7([],Ee,st);i.af(_t,_t,Me);const Ht=i.eD/i.aD,lt=i.ag(_t),He=i.ce(Math.max(lt*Ht-i.eD,Number.EPSILON),0),Tt=Math.min(P.zoomFromMercatorZAdjusted(He),M.maxZoom);return Tt>.5*(i.cZ+i.cK)?(P.setProjection({name:"mercator"}),P.zoom=Tt,this._cameraForBounds(P,h,m,x,b,E)):{center:P.center,zoom:Tt,bearing:x,pitch:b}}_extendAABB(s,h,m,x){const b=.5*((m.padding.left||0)+(m.padding.right||0)),E=.5*((m.padding.top||0)+(m.padding.bottom||0)),P=E,M=b,B=b,j=E,X=h.width-(M+B),W=h.height-(P+j),Y=i.av([],s.max,s.min),ee=Math.min(X/Y[0],W/Y[1]),te=Math.min(h.scaleZoom(h.scale*ee),m.maxZoom);if(isNaN(te))return null;const ce=h.scale/h.zoomScale(te),oe=new i.d8([s.min[0]-M*ce,s.min[1]-j*ce,s.min[2]],[s.max[0]+B*ce,s.max[1]+P*ce,s.max[2]]),de=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new i.P(m.offset.x,m.offset.y):i.P.convert(m.offset)).rotate(-i.an(x));return oe.center[0]-=de.x*ce,oe.center[1]+=de.y*ce,oe}queryTerrainElevation(s,h){const m=this.transform.elevation;return m?(h=Object.assign({},{exaggerated:!0},h),m.getAtPoint(i.ae.fromLngLat(s),null,h.exaggerated)):null}_cameraForBounds(s,h,m,x,b,E){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,h,m,x,b,E);const P=s.clone(),M=this._extendCameraOptions(E);P.bearing=x,P.pitch=b;const B=i.aR.convert(h),j=i.aR.convert(m),X=new i.aR(B.lng,j.lat),W=new i.aR(j.lng,B.lat),Y=P.project(B),ee=P.project(j),te=this.queryTerrainElevation(B),ce=this.queryTerrainElevation(j),oe=this.queryTerrainElevation(X),de=this.queryTerrainElevation(W),xe=[[Y.x,Y.y,Math.min(te||0,ce||0,oe||0,de||0)],[ee.x,ee.y,Math.max(te||0,ce||0,oe||0,de||0)]];let Ee=i.d8.fromPoints(xe);const De=P.getWorldToCameraMatrix(),Me=i.bl(new Float64Array(16),De);Ee=i.d8.applyTransform(Ee,De);const Fe=this._extendAABB(Ee,P,M,x);if(!Fe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ee=Fe;const Re=.5*i.av([],Ee.max,Ee.min)[2],Oe=this._minimumAABBFrustumDistance(P,Ee),Le=[0,0,1,0];i.aC(Le,Le,De),i.eU(Le,Le);const ct=i.c4([],Le,Oe+Re),Ke=i.d7([],Ee.center,ct);i.af(Ee.center,Ee.center,Me),i.af(Ke,Ke,Me);const vt=P.unproject(new i.P(Ee.center[0],Ee.center[1])),st=i.eV(P.projection,vt),_t=Math.pow(2,st),Ht=Math.min(P._zoomFromMercatorZ(Ke[2]*P.pixelsPerMeter*_t/P.worldSize),M.maxZoom);return P.mercatorFromTransition&&Ht<.5*(i.cZ+i.cK)?(P.setProjection({name:"globe"}),P.zoom=Ht,this._cameraForBounds(P,h,m,x,b,E)):{center:vt,zoom:Ht,bearing:x,pitch:b}}fitBounds(s,h,m){const x=this.cameraForBounds(s,h);return this._fitInternal(x,h,m)}fitScreenCoordinates(s,h,m,x,b){const E=i.P.convert(s),P=i.P.convert(h),M=new i.P(Math.min(E.x,P.x),Math.min(E.y,P.y)),B=new i.P(Math.max(E.x,P.x),Math.max(E.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,P))return this;const j=this.transform.pointLocation3D(M),X=this.transform.pointLocation3D(B),W=this.transform.pointLocation3D(new i.P(M.x,B.y)),Y=this.transform.pointLocation3D(new i.P(B.x,M.y)),ee=[Math.min(j.lng,X.lng,W.lng,Y.lng),Math.min(j.lat,X.lat,W.lat,Y.lat)],te=[Math.max(j.lng,X.lng,W.lng,Y.lng),Math.max(j.lat,X.lat,W.lat,Y.lat)],ce=x&&x.pitch?x.pitch:this.getPitch(),oe=this._cameraForBounds(this.transform,ee,te,m,ce,x);return this._fitInternal(oe,x,b)}_fitInternal(s,h,m){return s?(h=Object.assign(s,h)).linear?this.easeTo(h,m):this.flyTo(h,m):this}jumpTo(s,h){this.stop();const m=s.preloadOnly?this.transform.clone():this.transform;let x=!1,b=!1,E=!1;"zoom"in s&&m.zoom!==+s.zoom&&(x=!0,m.zoom=+s.zoom),s.center!==void 0&&(m.center=i.aR.convert(s.center)),"bearing"in s&&m.bearing!==+s.bearing&&(b=!0,m.bearing=+s.bearing),"pitch"in s&&m.pitch!==+s.pitch&&(E=!0,m.pitch=+s.pitch);const P=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!m.isPaddingEqual(P))if(s.retainPadding===!1){const M=m.clone();M.padding=P,m.setLocationAtPoint(m.center,M.centerPoint)}else m.padding=P;return s.preloadOnly?(this._preloadTiles(m),this):(this.fire(new i.z("movestart",h)).fire(new i.z("move",h)),x&&this.fire(new i.z("zoomstart",h)).fire(new i.z("zoom",h)).fire(new i.z("zoomend",h)),b&&this.fire(new i.z("rotatestart",h)).fire(new i.z("rotate",h)).fire(new i.z("rotateend",h)),E&&this.fire(new i.z("pitchstart",h)).fire(new i.z("pitch",h)).fire(new i.z("pitchend",h)),this.fire(new i.z("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Ux),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,h){const m=this.transform;if(!m.projection.supportsFreeCamera)return i.w(Ux),this;this.stop();const x=m.zoom,b=m.pitch,E=m.bearing;m.setFreeCameraOptions(s);const P=x!==m.zoom,M=b!==m.pitch,B=E!==m.bearing;return this.fire(new i.z("movestart",h)).fire(new i.z("move",h)),P&&this.fire(new i.z("zoomstart",h)).fire(new i.z("zoom",h)).fire(new i.z("zoomend",h)),B&&this.fire(new i.z("rotatestart",h)).fire(new i.z("rotate",h)).fire(new i.z("rotateend",h)),M&&this.fire(new i.z("pitchstart",h)).fire(new i.z("pitch",h)).fire(new i.z("pitchend",h)),this.fire(new i.z("moveend",h)),this}easeTo(s,h){this._stop(!1,s.easeId),((s=Object.assign({offset:[0,0],duration:500,easing:i.eM},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const m=this.transform,x=this.getZoom(),b=this.getBearing(),E=this.getPitch(),P=this.getPadding(),M="zoom"in s?+s.zoom:x,B="bearing"in s?this._normalizeBearing(s.bearing,b):b,j="pitch"in s?+s.pitch:E,X=this._extendPadding(s.padding),W=i.P.convert(s.offset);let Y,ee,te;if(m.projection.name==="globe"){const Le=i.ae.fromLngLat(m.center),ct=W.rotate(-m.angle);Le.x+=ct.x/m.worldSize,Le.y+=ct.y/m.worldSize;const Ke=Le.toLngLat(),vt=i.aR.convert(s.center||Ke);this._normalizeCenter(vt),Y=m.centerPoint.add(ct),ee=new i.P(Le.x,Le.y).mult(m.worldSize),te=new i.P(i.aF(vt.lng),i.aJ(vt.lat)).mult(m.worldSize).sub(ee)}else{Y=m.centerPoint.add(W);const Le=m.pointLocation(Y),ct=i.aR.convert(s.center||Le);this._normalizeCenter(ct),ee=m.project(Le),te=m.project(ct).sub(ee)}const ce=m.zoomScale(M-x);let oe,de;s.around&&(oe=i.aR.convert(s.around),de=m.locationPoint(oe));const xe=this._zooming||M!==x,Ee=this._rotating||b!==B,De=this._pitching||j!==E,Me=!m.isPaddingEqual(X),Fe=s.retainPadding===!1?m.clone():m,Re=Le=>ct=>{if(xe&&(Le.zoom=i.ak(x,M,ct)),Ee&&(Le.bearing=i.ak(b,B,ct)),De&&(Le.pitch=i.ak(E,j,ct)),Me&&(Fe.interpolatePadding(P,X,ct),Y=Fe.centerPoint.add(W)),oe)Le.setLocationAtPoint(oe,de);else{const Ke=Le.zoomScale(Le.zoom-x),vt=M>x?Math.min(2,ce):Math.max(.5,ce),st=Math.pow(vt,1-ct),_t=Le.unproject(ee.add(te.mult(ct*st)).mult(Ke));Le.setLocationAtPoint(Le.renderWorldCopies?_t.wrap():_t,Y)}return s.preloadOnly||this._fireMoveEvents(h),Le};if(s.preloadOnly){const Le=this._emulate(Re,s.duration,m);return this._preloadTiles(Le),this}const Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=xe,this._rotating=Ee,this._pitching=De,this._padding=Me,this._easeId=s.easeId,this._prepareEase(h,s.noMoveStart,Oe),this._ease(Re(m),Le=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(h,Le)},s),this}_prepareEase(s,h,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||m.moving||this.fire(new i.z("movestart",s)),this._zooming&&!m.zooming&&this.fire(new i.z("zoomstart",s)),this._rotating&&!m.rotating&&this.fire(new i.z("rotatestart",s)),this._pitching&&!m.pitching&&this.fire(new i.z("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.z("move",s)),this._zooming&&this.fire(new i.z("zoom",s)),this._rotating&&this.fire(new i.z("rotate",s)),this._pitching&&this.fire(new i.z("pitch",s))}_afterEase(s,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,x=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new i.z("zoomend",s)),x&&this.fire(new i.z("rotateend",s)),b&&this.fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s))}flyTo(s,h){if(this._prefersReducedMotion(s)){const ht=i.aH(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(ht,h)}this.stop(),s=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:i.eM},s);const m=this.transform,x=this.getZoom(),b=this.getBearing(),E=this.getPitch(),P=this.getPadding(),M="zoom"in s?i.aA(+s.zoom,m.minZoom,m.maxZoom):x,B="bearing"in s?this._normalizeBearing(s.bearing,b):b,j="pitch"in s?+s.pitch:E,X=this._extendPadding(s.padding),W=m.zoomScale(M-x),Y=i.P.convert(s.offset);let ee=m.centerPoint.add(Y);const te=m.pointLocation(ee),ce=i.aR.convert(s.center||te);this._normalizeCenter(ce);const oe=m.project(te),de=m.project(ce).sub(oe);let xe=s.curve;const Ee=Math.max(m.width,m.height),De=Ee/W,Me=de.mag();if("minZoom"in s){const ht=i.aA(Math.min(s.minZoom,x,M),m.minZoom,m.maxZoom),Ft=Ee/m.zoomScale(ht-x);xe=Math.sqrt(Ft/Me*2)}const Fe=xe*xe;function Re(ht){const Ft=(De*De-Ee*Ee+(ht?-1:1)*Fe*Fe*Me*Me)/(2*(ht?De:Ee)*Fe*Me);return Math.log(Math.sqrt(Ft*Ft+1)-Ft)}function Oe(ht){return(Math.exp(ht)-Math.exp(-ht))/2}function Le(ht){return(Math.exp(ht)+Math.exp(-ht))/2}const ct=Re(0);let Ke=function(ht){return Le(ct)/Le(ct+xe*ht)},vt=function(ht){return Ee*((Le(ct)*(Oe(Ft=ct+xe*ht)/Le(Ft))-Oe(ct))/Fe)/Me;var Ft},st=(Re(1)-ct)/xe;if(Math.abs(Me)<1e-6||!isFinite(st)){if(Math.abs(Ee-De)<1e-6)return this.easeTo(s,h);const ht=De<Ee?-1:1;st=Math.abs(Math.log(De/Ee))/xe,vt=function(){return 0},Ke=function(Ft){return Math.exp(ht*xe*Ft)}}s.duration="duration"in s?+s.duration:1e3*st/("screenSpeed"in s?+s.screenSpeed/xe:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const _t=b!==B,Ht=j!==E,lt=!m.isPaddingEqual(X),He=s.retainPadding===!1?m.clone():m,Tt=ht=>Ft=>{const Gt=Ft*st,tr=1/Ke(Gt);ht.zoom=Ft===1?M:x+ht.scaleZoom(tr),_t&&(ht.bearing=i.ak(b,B,Ft)),Ht&&(ht.pitch=i.ak(E,j,Ft)),lt&&(He.interpolatePadding(P,X,Ft),ee=He.centerPoint.add(Y));const Ut=Ft===1?ce:ht.unproject(oe.add(de.mult(vt(Gt))).mult(tr));return ht.setLocationAtPoint(ht.renderWorldCopies?Ut.wrap():Ut,ee),ht._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(h),ht};if(s.preloadOnly){const ht=this._emulate(Tt,s.duration,m);return this._preloadTiles(ht),this}return this._zooming=!0,this._rotating=_t,this._pitching=Ht,this._padding=lt,this._prepareEase(h,!1),this._ease(Tt(m),()=>this._afterEase(h),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,h)}if(!s){const m=this.handlers;m&&m.stop(!1)}return this}_ease(s,h,m){m.animate===!1||m.duration===0?(s(1),h()):(this._easeStart=i.o.now(),this._easeOptions=m,this._onEaseFrame=s,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.o.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,h){s=i.bT(s,-180,180);const m=Math.abs(s-h);return Math.abs(s-360-h)<m&&(s-=360),Math.abs(s+360-h)<m&&(s+=360),s}_normalizeCenter(s){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const m=s.lng-h.center.lng;s.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.o.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,h,m){const x=Math.ceil(15*h/1e3),b=[],E=s(m.clone());for(let P=0;P<=x;P++){const M=E(P/x);b.push(M.clone())}return b}_preloadTiles(s,h){}}class wm{constructor(s={}){this.options=s,i.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const h=this.options&&this.options.compact,m=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=R("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const x=R("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",m),this._innerContainer=R("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const m=h.reduce((x,b,E)=>(b.value&&(x+=`${b.key}=${b.value}${E<h.length-1?"&":""}`),x),"?");s.href=`${i.e.FEEDBACK_URL}/${m}#${qg(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||(s.dataType!=="source"||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility")&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._mergedSourceCaches;for(const x in h){const b=h[x];if(b.used){const E=b.getSource();E.attribution&&s.indexOf(E.attribution)<0&&s.push(E.attribution)}}s.sort((x,b)=>x.length-b.length),s=s.filter((x,b)=>{for(let E=b+1;E<s.length;E++)if(s[E].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const m=s.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,s.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class oc{constructor(){i.aY(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=R("div","mapboxgl-ctrl");const h=R("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const h in s){const m=s[h].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class bm{constructor(){i.aY(["_onIndoorUpdate"],this)}onAdd(s){return this._map=s,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",h=>this._onIndoorUpdate({selectedFloorId:h.selectedFloorId,floors:h.floors})),this._container}_createButton(s,h){const m=R("button",s,this._container);return m.type="button",m.addEventListener("click",h),m}_createSeparator(){return R("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(s,h){this._map&&(s.setAttribute("aria-label",h),s.textContent=h)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(s){if(!s||!s.floors)return void(this._container.style.display="none");const h=this._model;this._model=s,this._container.style.display="inline-block",this._container.style.borderRadius="8px";const m=s.floors.sort((x,b)=>b.levelOrder-x.levelOrder);h?(Array.from(this._container.children).forEach(x=>x.remove()),this.addCurrentFloors(m)):this.addCurrentFloors(m)}addCurrentFloors(s){for(let h=0;h<s.length;h++){const m=s[h],x=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(m.id),this._model&&(this._model.selectedFloorId=m.id),Array.from(this._container.children).forEach(b=>{b.classList.contains("mapboxgl-ctrl-level-button")&&b.classList.remove("mapboxgl-ctrl-level-button-selected")}),x.classList.add("mapboxgl-ctrl-level-button-selected")});this._setButtonTitle(x,m.shortName),this._model&&m.id===this._model.selectedFloorId&&x.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(x),h<s.length-1&&this._createSeparator()}}}class Hi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const h=++this._id;return this._queue.push({callback:s,id:h,cancelled:!1}),h}remove(s){const h=this._currentlyRunning,m=h?this._queue.concat(h):this._queue;for(const x of m)if(x.id===s)return void(x.cancelled=!0)}run(s=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const m of h)if(!m.cancelled&&(m.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class sc{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const h=i.dz((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,h,m){this._start=this.getValue(h),this._end=s,this._startTime=h,this._endTime=h+m}}const Tm={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Sm extends i.z{constructor(s,h,m,x){const{point:b,lngLat:E,originalEvent:P,target:M}=s;super(s.type,{point:b,lngLat:E,originalEvent:P,target:M}),this.preventDefault=()=>{s.preventDefault()},this.id=h,this.interaction=m,this.feature=x}}class AT{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,h){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const m=h.filter;let x=h.type;m&&this.filters.set(s,i.b6(m)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const b=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,h)):b.size===0&&this.map.on(x,this.handleType),b.size===0&&this.interactionsByType.set(x,b),b.set(s,h),this.typeById.set(s,x)}get(s){const h=this.typeById.get(s);if(!h)return;const m=this.interactionsByType.get(h);return m?m.get(s):void 0}remove(s){const h=this.typeById.get(s);if(!h)return;this.typeById.delete(s),this.filters.delete(s);const m=this.interactionsByType.get(h);m&&(m.delete(s),h==="mouseenter"||h==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(h,this.handleType))}queryTargets(s,h){const m=[];for(const[x,b]of h)b.target&&m.push({targetId:x,target:b.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(s,m,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const h=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());h.length&&(s.type="mouseenter",this.handleType(s,h));const m=new Map;for(const[x,{feature:b}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||m.set(b.id,b);m.size&&(s.type="mouseleave",this.handleType(s,Array.from(m.values())))}handleOut(s){const h=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);h.length&&(s.type="mouseleave",this.handleType(s,h)),this.hoveredFeatures.clear()}handleType(s,h){const m=s.type==="mouseenter";if(m&&!this.interactionsByType.has(s.type))return void i.w("mouseenter interaction required for mouseleave to work.");const x=Array.from(this.interactionsByType.get(s.type)).reverse(),b=!!h;h=h||this.queryTargets(s.point,x);let E=!1;const P=new Set;for(const M of h){for(const[B,j]of x){if(!j.target)continue;const X=M.variants?M.variants[B]:null;if(X){for(const W of X){if(ku(W,M,P,B))continue;const Y=new i.dt(M,W),ee=Wp(W,M,B);b&&(Y.state=this.map.getFeatureState(Y));const te=m?this.prevHoveredFeatures.get(ee):null,ce=new Sm(s,B,j,Y),oe=te?te.stop:j.handler(ce);if(m&&this.hoveredFeatures.set(ee,{feature:M,stop:oe}),oe!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(const[M,B]of x){const{handler:j,target:X}=B;if(!X&&j(new Sm(s,M,B,null))!==!1)break}}}function KI(g,s){if(Array.isArray(g)&&Array.isArray(s)){const h=new Set(g),m=new Set(s);return h.size===m.size&&g.every(x=>m.has(x))}return i.by(g,s)}const Em={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},JI={showCompass:!0,showZoom:!0,visualizePitch:!1};class QI{constructor(s,h,m=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Kg({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,m&&(this.mousePitch=new Jg({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(s,h){this.mouseRotate.mousedown(s,h),this.mousePitch&&this.mousePitch.mousedown(s,h),J()}move(s,h){const m=this.map,x=this.mouseRotate.mousemoveWindow(s,h),b=x&&x.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const E=this.mousePitch.mousemoveWindow(s,h),P=E&&E.pitchDelta;P&&m.setPitch(m.getPitch()+P)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(Object.assign({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ge(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ge(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ve(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=ve(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function r_(g,s,h){if(g=new i.aR(g.lng,g.lat),s){const m=new i.aR(g.lng-360,g.lat),x=new i.aR(g.lng+360,g.lat),b=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),E=h.locationPoint3D(g).distSqr(s),P=s.x<0||s.y<0||s.x>h.width||s.y>h.height;h.locationPoint3D(m).distSqr(s)<E&&(P||Math.abs(m.lng-h.center.lng)<b)?g=m:h.locationPoint3D(x).distSqr(s)<E&&(P||Math.abs(x.lng-h.center.lng)<b)&&(g=x)}for(;Math.abs(g.lng-h.center.lng)>180;){const m=h.locationPoint3D(g);if(m.x>=0&&m.y>=0&&m.x<=h.width&&m.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const Am={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Vs={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class nf extends i.E{constructor(s,h){super(),(s instanceof HTMLElement||h)&&(s=Object.assign({element:s},h)),i.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:m="center",color:x="#3FB1CE",scale:b=1,draggable:E=!1,clickTolerance:P=0,rotation:M=Vs.rotation,rotationAlignment:B=Vs.rotationAlignment,pitchAlignment:j=Vs.pitchAlignment,occludedOpacity:X=Vs.occludedOpacity,altitude:W=Vs.altitude}=s||{};this._anchor=m,this._color=x,this._scale=b,this._draggable=E,this._clickTolerance=P,this._rotation=M,this._rotationAlignment=B,this._pitchAlignment=j,this._occludedOpacity=X,this._altitude=W,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",te=>{te.preventDefault()}),this._element.addEventListener("mousedown",te=>{te.preventDefault()});const Y=this._element.classList;for(const te in Am)Y.remove(`mapboxgl-marker-anchor-${te}`);Y.add(`mapboxgl-marker-anchor-${this._anchor}`);const ee=s&&s.className?s.className.trim().split(/\s+/):[];Y.add(...ee),this._popup=null}_createDefaultMarker(){const s=R("div"),h=N("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const m=N("radialGradient",{id:"shadowGradient"},N("defs",{},h));N("stop",{offset:"10%","stop-opacity":.4},m),N("stop",{offset:"100%","stop-opacity":.05},m),N("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h)}return N("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),N("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),N("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.aR.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||Vs.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const h=s.code,m=s.charCode||s.keyCode;h!=="Space"&&h!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(s){const h=s.originalEvent.target,m=this._element;this._popup&&(h===m||m.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,h=this._pos;if(!s||!h)return!1;const m=s.unproject(h,this._altitude),x=s.getFreeCameraOptions();if(!x.position)return!1;const b=x.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const h=this._pos;if(!h||h.x<0||h.x>s.transform.width||h.y<0||h.y>s.transform.height)return void this._clearFadeTimer();const m=s.unproject(h,this._altitude);let x;s._showingGlobe()&&i.eY(s.transform,this._lngLat)?x=0:(x=1-s._queryFogOpacity(m),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Am[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const s=this._pos,h=this._map,m=this.getPitchAlignment();if(!h||!s||m!=="map")return"";if(!h._showingGlobe()){const M=h.getPitch();return M?`rotateX(${M}deg)`:""}const x=i.cW(i.eZ(h.transform,this._lngLat)),b=s.sub(i.e_(h.transform)),E=Math.abs(b.x)+Math.abs(b.y);if(E===0)return"";const P=x/E;return`rotateX(${-b.y*P}deg) rotateY(${b.x*P}deg)`}_calculateZTransform(){const s=this._pos,h=this._map;if(!h||!s)return"";let m=0;const x=this.getRotationAlignment();if(x==="map")if(h._showingGlobe()){const b=h.project(new i.aR(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),E=h.project(new i.aR(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(b);m=i.cW(Math.atan2(E.y,E.x))-90}else m=-h.getBearing();else if(x==="horizon"){const b=i.ah(4,6,h.getZoom()),E=i.e_(h.transform);E.y+=b*h.transform.height;const P=s.sub(E),M=i.cW(Math.atan2(P.y,P.x));m=(M>90?M-270:M+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=r_(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const h=this._map;if(!h)return;const m=this._pointerdownPos,x=this._positionDelta;if(m&&x){if(!this._isDragging){const b=this._clickTolerance||h._clickTolerance;if(s.point.dist(m)<b)return;this._isDragging=!0}this._pos=s.point.sub(x),this._lngLat=h.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(s){const h=this._map,m=this._pos;h&&m&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(m),this._pointerdownPos=s.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const h=this._map;return h&&(s?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||Vs.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||Vs.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||Vs.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||Vs.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Zu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Gc={maxWidth:100,unit:"metric"},Hc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},af={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Ol=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function CT(g=new i.P(0,0),s="bottom"){if(typeof g=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(s){case"top":return new i.P(0,g);case"top-left":return new i.P(h,h);case"top-right":return new i.P(-h,h);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(h,-h);case"bottom-right":return new i.P(-h,-h);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[s]||[0,0])}return{version:v,supported:L.supported,setRTLTextPlugin:i.f2,getRTLTextPluginStatus:i.f1,Map:class extends $x{constructor(g){S.mark(w.create);const s=g;if((g=Object.assign({},Em,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.eW(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Uo(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies,null,null),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Hi,this._domRenderTaskQueue=new Hi,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.b2(),this._locale=Object.assign({},Tm,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new sc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new Je(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const h=document.getElementById(g.container);if(!h)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=h}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new _d),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new xm(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new jh(this),g.hash&&(this._hash=new Ox(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const h=g.bounds;h&&(this.resize(),this.fitBounds(h,Object.assign({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new wm({customAttribution:g.customAttribution})),this._logoControl=new oc,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new i.z(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new i.z(`${h.dataType}dataloading`,h))}),this._interactions=new AT(this)}_getMapId(){return this._mapId}addControl(g,s){if(s===void 0&&(s=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const m=this._controlPositions[s];return s.indexOf("bottom")!==-1?m.insertBefore(h,m.firstChild):m.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(g);return s>-1&&this._controls.splice(s,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),s&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.aI.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(s=>s==="auto"?navigator.language:s):g}setLanguage(g){const s=this._parseLanguage(g);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,s=g.projection.name;let h;s==="globe"&&g.zoom>=i.cK?(g.setMercatorFromTransition(),h=!0):s==="mercator"&&g.zoom<i.cK&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(g,s){return this._updateProjection(g||s||{name:"mercator"})}_updateProjection(g){let s;return s=g.name==="globe"&&this.transform.zoom>=i.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g,s){return this.transform.locationPoint3D(i.aR.convert(g),s)}unproject(g,s){return this.transform.pointLocation3D(i.P.convert(g),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,s,h){const m=x=>{let b=[];if(Array.isArray(s)){const E=s.filter(P=>this.getLayer(P));b=E.length?this.queryRenderedFeatures(x,{layers:E}):[]}else b=this.queryRenderedFeatures(x,{target:s});return b};if(g==="mouseenter"||g==="mouseover"){let x=!1;return{listener:h,targets:s,delegates:{mousemove:E=>{const P=m(E.point);P.length?x||(x=!0,h.call(this,new ma(g,this,E.originalEvent,{features:P}))):x=!1},mouseout:()=>{x=!1}}}}if(g==="mouseleave"||g==="mouseout"){let x=!1;return{listener:h,targets:s,delegates:{mousemove:P=>{m(P.point).length?x=!0:x&&(x=!1,h.call(this,new ma(g,this,P.originalEvent)))},mouseout:P=>{x&&(x=!1,h.call(this,new ma(g,this,P.originalEvent)))}}}}{const x=b=>{const E=m(b.point);E.length&&(b.features=E,h.call(this,b),delete b.features)};return{listener:h,targets:s,delegates:{[g]:x}}}}on(g,s,h){if(typeof s=="function"||h===void 0)return super.on(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._createDelegatedListener(g,s,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(m);for(const x in m.delegates)this.on(x,m.delegates[x]);return this}once(g,s,h){if(typeof s=="function"||h===void 0)return super.once(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._createDelegatedListener(g,s,h);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(g,s,h){if(typeof s=="function"||h===void 0)return super.off(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._delegatedListeners?this._delegatedListeners[g]:void 0;return m&&(x=>{for(let b=0;b<x.length;b++){const E=x[b];if(E.listener===h&&KI(E.targets,s)){for(const P in E.delegates)this.off(P,E.delegates[P]);return x.splice(b,1),this}}})(m),this}queryRenderedFeatures(g,s){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||s!==void 0||(s=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!s){const b=this.style.queryRenderedFeatures(g,void 0,this.transform),E=this.style.queryRenderedFeatureset(g,void 0,this.transform);return b.concat(E)}let h=!0;if(s.target&&(h=this._isTargetValid(s.target),h&&!s.layers))return this.style.queryRenderedFeatureset(g,s,this.transform);let m=!0;if(s.layers&&Array.isArray(s.layers)){for(const b of s.layers)if(!this._isValidId(b)){m=!1;break}if(m&&!s.target)return this.style.queryRenderedFeatures(g,s,this.transform)}let x=[];return m&&(x=x.concat(this.style.queryRenderedFeatures(g,s,this.transform))),h&&(x=x.concat(this.style.queryRenderedFeatureset(g,s,this.transform))),x}querySourceFeatures(g,s){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,s)}queryRasterValue(g,s,h){return this._isValidId(g)?this.style.queryRasterValue(g,s,h):Promise.resolve(null)}isPointOnSurface(g){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,s){return this._interactions.add(g,s),this}removeInteraction(g){return this._interactions.remove(g),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(g){return this._cooperativeGestures=g,this}setStyle(g,s){return s=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&g&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(g,(h,m)=>{if(h){const x=typeof h=="string"?h:h instanceof Error?h.message:h.error;i.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(g,s)}else m&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(g,s))}_getUIString(g){const s=this._locale[g];if(s==null)throw new Error(`Missing UI string '${g}'`);return s}_updateStyle(g,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const h=Object.assign({},s);s&&s.config&&(h.initialConfig=s.config,delete h.config),this.style=new il(this,h).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new il(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.dm(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const s of g)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(g)}addSource(g,s){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,s),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,s,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,s,h)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,s,{pixelRatio:h=1,sdf:m=!1,stretchX:x,stretchY:b,content:E}={}){this._lazyInitEmptyStyle();const P=i.I.from(g);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:M,height:B,data:j}=i.o.getImageData(s);this.style.addImage(P,{data:new i.q({width:M,height:B},j),pixelRatio:h,stretchX:x,stretchY:b,content:E,sdf:m,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:B}=s,j=s;this.style.addImage(P,{data:new i.q({width:M,height:B},new Uint8Array(j.data)),pixelRatio:h,stretchX:x,stretchY:b,content:E,sdf:m,usvg:!1,version:0,userImage:j}),j.onAdd&&j.onAdd(this,g)}}updateImage(g,s){this._lazyInitEmptyStyle();const h=i.I.from(g),m=this.style.getImage(h);if(!m)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.o.getImageData(s):s,{width:b,height:E,data:P}=x;if(b===void 0||E===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==(m.usvg?m.icon.usvg_tree.width:m.data.width)||E!==(m.usvg?m.icon.usvg_tree.height:m.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${b}, ${E})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const M=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let B=!1;m.usvg?(m.data=new i.q({width:b,height:E},new Uint8Array(P)),m.usvg=!1,m.icon=void 0,B=!0):m.data.replace(P,M),this.style.updateImage(h,m,B)}hasImage(g){return g?!!this.style&&!!this.style.getImage(i.I.from(g)):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(i.I.from(g))}loadImage(g,s){i.n(this._requestManager.transformRequest(g,i.R.Image),(h,m)=>{s(h,m instanceof HTMLImageElement?i.o.getImageData(m):m)})}listImages(){return this.style.listImages().map(g=>g.name)}addModel(g,s){this._lazyInitEmptyStyle(),this.style.addModel(g,s)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,s){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,s),this._update(!0)):this}getSlot(g){const s=this.getLayer(g);return s&&s.slot||null}setSlot(g,s){return this.style.setSlot(g,s),this.style.mergeLayers(),this._update(!0)}addImport(g,s){return this.style.addImport(g,s).catch(h=>this.fire(new i.y(new Error("Failed to add import",h)))),this}updateImport(g,s){return typeof s!="string"&&s.id!==g?(this.removeImport(g),this.addImport(s)):(this.style.updateImport(g,s),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,s){return this.style.moveImport(g,s),this._update(!0)}moveLayer(g,s){return this._isValidId(g)?(this.style.moveLayer(g,s),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const s=this.style.getOwnLayer(g);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,s,h){return this._isValidId(g)?(this.style.setLayerZoomRange(g,s,h),this._update(!0)):this}setFilter(g,s,h={}){return this._isValidId(g)?(this.style.setFilter(g,s,h),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,s,h,m={}){return this._isValidId(g)?(this.style.setPaintProperty(g,s,h,m),this._update(!0)):this}getPaintProperty(g,s){return this._isValidId(g)?this.style.getPaintProperty(g,s):null}setLayoutProperty(g,s,h,m={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,s,h,m),this._update(!0)):this}getLayoutProperty(g,s){return this._isValidId(g)?this.style.getLayoutProperty(g,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(g){return this.style.setGlyphsUrl(g),this._update(!0)}getSchema(g){return this.style.getSchema(g)}setSchema(g,s){return this.style.setSchema(g,s),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,s){return this.style.setConfig(g,s),this._update(!0)}getConfigProperty(g,s){return this.style.getConfigProperty(g,s)}setConfigProperty(g,s,h){return this.style.setConfigProperty(g,s,h),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const s=g[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,s),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.aR.convert(g),this.transform):0}setFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,s),this._update())}removeFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,s),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_selectIndoorFloor(g){this.indoor.selectFloor(g)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new bm),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let h,m,x,b=this._container;for(;b&&(!m||!x);){const E=window.getComputedStyle(b).transform;E&&E!=="none"&&(h=E.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(m=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(x=h[3])),b=b.parentElement}this._containerWidth=m?Math.abs(g/m):g,this._containerHeight=x?Math.abs(s/x):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=R("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=R("div","mapboxgl-canvas-container",g);this._canvas=R("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=R("div","mapboxgl-control-container",g),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{m[x]=R("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,s){const h=i.o.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(s),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${s}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const s=this._markers.indexOf(g);s!==-1&&this._markers.splice(s,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const s=this._popups.indexOf(g);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const g=Object.assign({},L.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",g);s?(Ne(s,!0),this.painter=new kx(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.k.testSupport(s)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let s;this.fire(new i.z("renderstart")),++this._frameId;const h=this.painter.context.extTimerQuery,m=i.o.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=x.createQuery(),x.beginQuery(h.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,j=this.transform.pitch,X=i.o.now(),W=new i.ac(B,{now:X,fadeDuration:b,pitch:j,transition:this.style.transition,worldview:this._worldview});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(m),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(m);const P=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),P&&(this._placementDirty=P.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,S.mark(w.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const B=i.o.now()-m;x.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const j=x.getQueryParameter(s,x.QUERY_RESULT)/1e6;x.deleteQuery(s),this.fire(new i.z("gpu-timing-frame",{cpuTime:B,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(B);this.fire(new i.z("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(B);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:j}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(M||this._repaint)this.triggerRepaint();else{const B=this.idle();if(B&&(E=this._updateAverageElevation(m,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,S.mark(w.fullLoad),this._performanceMetricsCollection&&Yt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const s of this._markers)g&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!g||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(g,s=!1){const h=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(s||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const x=this.transform.averageElevation;let b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=g;const E=Math.abs(x-b);if(E>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(b),h(b);this._averageElevation.easeTo(b,g,300)}else if(E>1e-4)return this._averageElevation.jumpTo(b),h(b)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){Mt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===tt||g.status===401)){const s=this.painter.context.gl;Ne(s,!1),this._logoControl instanceof oc&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),qe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&yt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const h=this.painter.context.gl,m=h.createFramebuffer();function x(b){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,b,0);const E=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,E),E}return h.bindFramebuffer(h.FRAMEBUFFER,m),this._canvasPixelComparison(x(g),s.canvasCopies.map(x),s.timeStamps)}_canvasPixelComparison(g,s,h){let m=h[1]-h[0];const x=g.length/4;for(let b=0;b<s.length;b++){const E=s[b];let P=0;for(let M=0;M<E.length;M+=4)E[M]===g[M]&&E[M+1]===g[M+1]&&E[M+2]===g[M+2]&&E[M+3]===g[M+3]&&(P+=1);m+=(h[b+2]-h[b+1])*(1-P/x)}return m}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Sr.delete(this.painter.context.gl),St.remove(),Ge.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.o.frame(s=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(s)}))}_preloadTiles(g){const s=this.style?this.style.getSourceCaches():[];return i.bw(s,(h,m)=>h._preloadTiles(g,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,s){i.eX(g,s)}get version(){return v}},NavigationControl:class{constructor(g={}){this.options=Object.assign({},JI,g),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),R("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),R("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:s}):h.resetNorth({},{originalEvent:s}))}),this._compassIcon=R("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const s=g.getZoom(),h=s===g.getMaxZoom(),m=s===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new QI(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,s){const h=R("button",g,this._container);return h.type="button",h.addEventListener("click",s),h}_setButtonTitle(g,s){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${s}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends i.E{constructor(g={}){super();const s=navigator.geolocation;this.options=Object.assign({geolocation:s},Zu,g),i.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Hg(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const s=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>s(h.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(g){const s=this._map.getMaxBounds(),h=g.coords;return!!s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const s=new i.aR(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,m=this._map.getBearing(),x=Object.assign({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),x,{geolocateSource:!0})}_updateMarker(g){if(g){const s=new i.aR(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,s=i.ce(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=R("button","mapboxgl-ctrl-geolocate",this._container),R("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R("div","mapboxgl-user-location"),this._dotElement.appendChild(R("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(R("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new nf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=R("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wm,ScaleControl:class{constructor(g={}){this.options=Object.assign({},Gc,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,s=this._map,h=s._containerHeight/2,m=s._containerWidth/2-g/2,x=s.unproject([m,h]),b=s.unproject([m+g,h]),E=x.distanceTo(b);if(this.options.unit==="imperial"){const P=3.2808*E;P>5280?this._setScale(g,P/5280,"mile"):this._setScale(g,P,"foot")}else this.options.unit==="nautical"?this._setScale(g,E/1852,"nautical-mile"):E>=1e3?this._setScale(g,E/1e3,"kilometer"):this._setScale(g,E,"meter")}_setScale(g,s,h){this._map._requestDomTask(()=>{const m=function(b){const E=Math.pow(10,`${Math.floor(b)}`.length-1);let P=b/E;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(M){const B=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*B)/B}(P),E*P}(s),x=m/s;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(m):`${m}&nbsp;${Hc[h]}`,this._container.style.width=g*x+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=R("button","mapboxgl-ctrl-fullscreen",this._controlContainer);R("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:bm,Popup:class extends i.E{constructor(g){super(),this.options=Object.assign(Object.create(af),g),this._altitude=this.options.altitude,i.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.aR.convert(g),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(g){return this._altitude=g,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const s=document.createDocumentFragment(),h=document.createElement("body");let m;for(h.innerHTML=g;m=h.firstChild,m;)s.appendChild(m);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=R("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(g),this.options.closeButton){const h=this._closeButton=R("button","mapboxgl-popup-close-button",s);h.type="button",h.setAttribute("aria-label","Close popup"),h.innerHTML='<span aria-hidden="true">&#215;</span>',h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let s;return this._classList.delete(g)?s=!1:(this._classList.add(g),s=!0),this._updateClassList(),s}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const s=this._map,h=this._container,m=this._pos;if(!s||!h||!m)return"bottom";const x=h.offsetWidth,b=h.offsetHeight,E=m.x<x/2,P=m.x>s.transform.width-x/2;if(m.y+g<b)return E?"top-left":P?"top-right":"top";if(m.y>s.transform.height-b){if(E)return"bottom-left";if(P)return"bottom-right"}return E?"left":P?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),g.className=s.join(" ")}_update(g){const s=this._map,h=this._content;if(!s||!this._lngLat&&!this._trackPointer||!h)return;let m=this._container;if(m||(m=this._container=R("div","mapboxgl-popup",s.getContainer()),this._tip=R("div","mapboxgl-popup-tip",m),m.appendChild(h)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=r_(this._lngLat,this._pos,s.transform)),!this._trackPointer||g){const x=this._pos=this._trackPointer&&g instanceof i.P?g:s.project(this._lngLat,this._altitude),b=CT(this.options.offset),E=this._anchor=this._getAnchor(b.y),P=CT(this.options.offset,E),M=x.add(P).round();s._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Am[E]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&s._showingGlobe()){const x=i.eY(s.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Ol);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:nf,Style:il,LngLat:i.aR,LngLatBounds:i.aI,Point:i.P,MercatorCoordinate:i.ae,FreeCameraOptions:Gv,Evented:i.E,config:i.e,prewarm:i.f0,clearPrewarmedResources:i.e$,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.f9.workerCount},set workerCount(g){i.f9.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.f8(g)},get workerUrl(){return i.f7.workerUrl},set workerUrl(g){i.f7.workerUrl=g},get workerClass(){return i.f7.workerClass},set workerClass(g){i.f7.workerClass=g},get workerParams(){return i.f7.workerParams},set workerParams(g){i.f7.workerParams=g},get dracoUrl(){return i.f6()},set dracoUrl(g){i.f5(g)},get meshoptUrl(){return i.f4()},set meshoptUrl(g){i.f3(g)},setNow:i.o.setNow,restoreNow:i.o.restoreNow}});var d=o;return d})})(tte);var lqe=tte.exports;const Y1=Qi(lqe),cqe=({data:e})=>{const t=ue.useRef(null),r=ue.useRef(null),n="pk.eyJ1Ijoicm9nZXJpb2JhcnJvc28iLCJhIjoiY21mb3IyMmowMDh0ajJtbXYwbnJudDRyNyJ9.GGrp1UtOhWI06CUvDX9lgA",{toast:o}=r2(),u=v=>{if(!(!t.current||r.current)){Y1.accessToken=v;try{r.current=new Y1.Map({container:t.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[e.location.longitude,e.location.latitude],zoom:10}),r.current.addControl(new Y1.NavigationControl,"top-right");const w=new Y1.Marker({color:"#ff6b35",scale:1.2}).setLngLat([e.location.longitude,e.location.latitude]).addTo(r.current),S=d(),C=new Y1.Popup({offset:25,closeOnClick:!1}).setHTML(S);w.setPopup(C),C.addTo(r.current),r.current.on("load",()=>{i()}),o({title:"Mapa carregado!",description:"Visualizao climtica est disponvel"})}catch(w){console.error("Erro ao inicializar mapa:",w),o({title:"Erro no mapa",description:"Token do Mapbox invlido ou erro de conexo",variant:"destructive"})}}},d=()=>{const v=e.parameters.T2M?(e.parameters.T2M.reduce((S,C)=>S+C,0)/e.parameters.T2M.length).toFixed(1):"N/A",w=e.parameters.PRECTOTCORR?(e.parameters.PRECTOTCORR.reduce((S,C)=>S+C,0)/e.parameters.PRECTOTCORR.length).toFixed(1):"N/A";return`
      <div class="p-3">
        <h3 class="font-bold text-lg mb-2">Dados Climticos</h3>
        <p class="text-sm mb-1"><strong>Coordenadas:</strong> ${e.location.latitude.toFixed(4)}, ${e.location.longitude.toFixed(4)}</p>
        <p class="text-sm mb-1"><strong>Perodo:</strong> ${e.dateRange.start} - ${e.dateRange.end}</p>
        <p class="text-sm mb-1"><strong>Temp. Mdia:</strong> ${v}C</p>
        <p class="text-sm"><strong>Precip. Mdia:</strong> ${w} mm/dia</p>
      </div>
    `},i=()=>{if(!r.current||!e.parameters.T2M)return;const v=e.parameters.T2M.reduce((C,k)=>C+k,0)/e.parameters.T2M.length,w=v>25?50:v>20?40:30,S=v>30?"#ff4444":v>25?"#ff8800":v>20?"#ffcc00":"#0088ff";r.current.addSource("temperature-zone",{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[e.location.longitude,e.location.latitude]},properties:{temperature:v}}}),r.current.addLayer({id:"temperature-circle",type:"circle",source:"temperature-zone",paint:{"circle-radius":w,"circle-color":S,"circle-opacity":.3,"circle-stroke-width":2,"circle-stroke-color":S,"circle-stroke-opacity":.8}})};return ue.useEffect(()=>(u(n),()=>{r.current&&(r.current.remove(),r.current=null)}),[]),be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center gap-2",children:[be.jsx(qF,{className:"h-5 w-5"}),"Mapa Climtico"]})}),be.jsxs(mu,{children:[be.jsx("div",{ref:t,className:"w-full h-96 rounded-lg shadow-lg"}),be.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[be.jsx("p",{children:" Marcador vermelho: Localizao dos dados climticos"}),be.jsx("p",{children:" Crculo colorido: Zona de temperatura (azul=frio, amarelo=morno, vermelho=quente)"}),be.jsx("p",{children:" Clique no marcador para ver detalhes dos dados"})]})]})]})},uqe=o2("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),nte=ue.forwardRef(({className:e,variant:t,...r},n)=>be.jsx("div",{ref:n,role:"alert",className:Ci(uqe({variant:t}),e),...r}));nte.displayName="Alert";const hqe=ue.forwardRef(({className:e,...t},r)=>be.jsx("h5",{ref:r,className:Ci("mb-1 font-medium leading-none tracking-tight",e),...t}));hqe.displayName="AlertTitle";const ite=ue.forwardRef(({className:e,...t},r)=>be.jsx("div",{ref:r,className:Ci("text-sm [&_p]:leading-relaxed",e),...t}));ite.displayName="AlertDescription";const fqe=({data:e})=>{const t={extreme_heat:35,extreme_cold:5,heavy_rain:50,drought_days:30,frost_risk:2},r=()=>{var w,S;const i=[];if(!((S=(w=e.rawData)==null?void 0:w.properties)!=null&&S.parameter))return i;const v=e.rawData.properties.parameter;if(v.T2M){const C=v.T2M,k=Object.keys(C).sort(),O=[],L=[],R=[];k.forEach(N=>{const V=C[N],G=n(N);V>t.extreme_heat&&O.push(G),V<t.extreme_cold&&L.push(G),V<=t.frost_risk&&R.push(G)}),O.length>0&&i.push({type:"extreme_heat",severity:O.length>10?"critical":O.length>5?"high":"medium",title:"Ondas de Calor Detectadas",description:`Temperaturas acima de ${t.extreme_heat}C detectadas em ${O.length} dias. Risco de estresse trmico nas culturas.`,icon:DE,color:"text-red-600",dates:O.slice(0,5)}),L.length>0&&i.push({type:"extreme_cold",severity:L.length>5?"high":"medium",title:"Temperaturas Extremamente Baixas",description:`Temperaturas abaixo de ${t.extreme_cold}C detectadas em ${L.length} dias.`,icon:D8,color:"text-blue-600",dates:L.slice(0,5)}),R.length>0&&i.push({type:"frost_risk",severity:R.length>10?"high":"medium",title:"Risco de Geada",description:`Temperaturas  ${t.frost_risk}C detectadas em ${R.length} dias. Alto risco de geada para culturas sensveis.`,icon:D8,color:"text-cyan-600",dates:R.slice(0,5)})}if(v.PRECTOTCORR){const C=v.PRECTOTCORR,k=Object.keys(C).sort(),O=[];let L=0,R=0;k.forEach(N=>{const V=C[N],G=n(N);V>t.heavy_rain&&O.push(G),V<1?(L++,R=Math.max(R,L)):L=0}),O.length>0&&i.push({type:"heavy_rain",severity:O.length>10?"high":"medium",title:"Chuvas Intensas Detectadas",description:`Precipitao acima de ${t.heavy_rain}mm/dia detectada em ${O.length} dias. Risco de encharcamento e eroso.`,icon:uA,color:"text-blue-700",dates:O.slice(0,5)}),R>=t.drought_days&&i.push({type:"drought",severity:R>60?"critical":R>45?"high":"medium",title:"Perodo de Seca Prolongado",description:`Detectado perodo de at ${R} dias consecutivos com precipitao < 1mm. Risco de estresse hdrico nas culturas.`,icon:tp,color:"text-orange-600",dates:[]})}return i},n=i=>{const v=i.substring(0,4),w=i.substring(4,6);return`${i.substring(6,8)}/${w}/${v}`},o=i=>{switch(i){case"critical":return"bg-red-100 border-red-500 dark:bg-red-950";case"high":return"bg-orange-100 border-orange-500 dark:bg-orange-950";case"medium":return"bg-yellow-100 border-yellow-500 dark:bg-yellow-950";case"low":return"bg-blue-100 border-blue-500 dark:bg-blue-950";default:return"bg-gray-100 border-gray-500 dark:bg-gray-950"}},u=i=>{switch(i){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-gray-500"}},d=r();return d.length===0?be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center gap-2 text-green-700",children:[be.jsx(tp,{className:"h-5 w-5"}),"Anlise de Eventos Climticos"]})}),be.jsx(mu,{children:be.jsxs("div",{className:"text-center py-6",children:[be.jsx(tp,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),be.jsx("p",{className:"text-green-700 font-medium",children:"Nenhum evento climtico extremo detectado"}),be.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"As condies climticas esto dentro dos parmetros normais para a agricultura"})]})})]}):be.jsxs(Cc,{children:[be.jsx(pu,{children:be.jsxs(mh,{className:"flex items-center gap-2",children:[be.jsx(ble,{className:"h-5 w-5 text-orange-600"}),"Alertas Climticos Detectados"]})}),be.jsxs(mu,{className:"space-y-4",children:[be.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Anlise automtica baseada nos dados climticos do perodo selecionado:"}),d.map((i,v)=>{var S,C;const w=i.icon;return be.jsxs(nte,{className:o(i.severity),children:[be.jsx(w,{className:`h-4 w-4 ${i.color}`}),be.jsxs(ite,{children:[be.jsxs("div",{className:"flex items-start justify-between mb-2",children:[be.jsx("h4",{className:"font-semibold text-sm",children:i.title}),be.jsx(_w,{variant:"secondary",className:`${u(i.severity)} text-white text-xs`,children:i.severity.toUpperCase()})]}),be.jsx("p",{className:"text-sm mb-3",children:i.description}),i.dates.length>0&&be.jsxs("div",{className:"text-xs text-muted-foreground",children:[be.jsx("p",{className:"font-medium mb-1",children:"Primeiras ocorrncias:"}),be.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.dates.map((k,O)=>be.jsx(_w,{variant:"outline",className:"text-xs",children:k},O)),((S=d.find(k=>k.type===i.type))==null?void 0:S.dates.length)>5&&be.jsxs(_w,{variant:"outline",className:"text-xs",children:["+",((C=d.find(k=>k.type===i.type))==null?void 0:C.dates.length)-5," mais"]})]})]})]})]},v)}),be.jsxs("div",{className:"mt-6 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[be.jsx("h4",{className:"font-semibold text-sm text-blue-800 dark:text-blue-200 mb-2",children:"Recomendaes para Cafeicultura:"}),be.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[be.jsx("li",{children:" Monitore sistemas de irrigao durante perodos secos"}),be.jsx("li",{children:" Implemente proteo contra geadas quando necessrio"}),be.jsx("li",{children:" Ajuste prticas de manejo conforme condies extremas"}),be.jsx("li",{children:" Considere variedades mais resistentes para reas de risco"})]})]})]})]})};var gI="Collapsible",[dqe,Bqe]=Rp(gI),[pqe,wN]=dqe(gI),ate=ue.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:o,disabled:u,onOpenChange:d,...i}=e,[v,w]=i2({prop:n,defaultProp:o??!1,onChange:d,caller:gI});return be.jsx(pqe,{scope:r,disabled:u,contentId:xu(),open:v,onOpenToggle:ue.useCallback(()=>w(S=>!S),[w]),children:be.jsx(yi.div,{"data-state":TN(v),"data-disabled":u?"":void 0,...i,ref:t})})});ate.displayName=gI;var ote="CollapsibleTrigger",ste=ue.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,o=wN(ote,r);return be.jsx(yi.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":TN(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...n,ref:t,onClick:Bi(e.onClick,o.onOpenToggle)})});ste.displayName=ote;var bN="CollapsibleContent",lte=ue.forwardRef((e,t)=>{const{forceMount:r,...n}=e,o=wN(bN,e.__scopeCollapsible);return be.jsx(Ih,{present:r||o.open,children:({present:u})=>be.jsx(mqe,{...n,ref:t,present:u})})});lte.displayName=bN;var mqe=ue.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:o,...u}=e,d=wN(bN,r),[i,v]=ue.useState(n),w=ue.useRef(null),S=bo(t,w),C=ue.useRef(0),k=C.current,O=ue.useRef(0),L=O.current,R=d.open||i,N=ue.useRef(R),V=ue.useRef(void 0);return ue.useEffect(()=>{const G=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(G)},[]),Eh(()=>{const G=w.current;if(G){V.current=V.current||{transitionDuration:G.style.transitionDuration,animationName:G.style.animationName},G.style.transitionDuration="0s",G.style.animationName="none";const U=G.getBoundingClientRect();C.current=U.height,O.current=U.width,N.current||(G.style.transitionDuration=V.current.transitionDuration,G.style.animationName=V.current.animationName),v(n)}},[d.open,n]),be.jsx(yi.div,{"data-state":TN(d.open),"data-disabled":d.disabled?"":void 0,id:d.contentId,hidden:!R,...u,ref:S,style:{"--radix-collapsible-content-height":k?`${k}px`:void 0,"--radix-collapsible-content-width":L?`${L}px`:void 0,...e.style},children:R&&o})});function TN(e){return e?"open":"closed"}var gqe=ate;const _qe=gqe,yqe=ste,vqe=lte,xqe=()=>{const[e,t]=ue.useState(!1);return be.jsx(Cc,{children:be.jsxs(_qe,{open:e,onOpenChange:t,children:[be.jsx(pu,{children:be.jsx(yqe,{asChild:!0,children:be.jsxs(Ec,{variant:"ghost",className:"flex items-center justify-between p-0 h-auto",children:[be.jsxs(mh,{className:"flex items-center gap-2",children:[be.jsx(Tle,{className:"h-5 w-5 text-blue-600"}),"Clima Produtivo"]}),be.jsx(_le,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]})})}),be.jsx(vqe,{children:be.jsxs(mu,{className:"space-y-6",children:[be.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg",children:be.jsxs("div",{className:"flex items-start gap-3",children:[be.jsx(wle,{className:"h-5 w-5 text-blue-600 mt-1"}),be.jsxs("div",{children:[be.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Introduo"}),be.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Este sistema foi projetado para auxiliar na tomada de decises no manejo do caf. Testes com usurios reais em condies de campo so essenciais para validar se as funcionalidades realmente atendem s necessidades prticas da cafeicultura."})]})]})}),be.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950 p-4 rounded-lg",children:[be.jsx("h4",{className:"font-semibold text-amber-800 dark:text-amber-200 mb-2",children:"Cenrios de uso na cafeicultura:"}),be.jsxs("div",{className:"text-sm text-amber-700 dark:text-amber-300 space-y-2",children:[be.jsxs("p",{children:[be.jsx("strong",{children:"Planejamento da safra:"})," Usar dados histricos para planejar prticas de manejo, pocas de plantio e colheita."]}),be.jsxs("p",{children:[be.jsx("strong",{children:"Manejo preventivo:"})," Identificar perodos de risco (geadas, secas) para implementar medidas preventivas."]}),be.jsxs("p",{children:[be.jsx("strong",{children:"Tomada de deciso rpida:"})," No campo, consultar alertas e mapas para decises imediatas sobre irrigao, proteo, etc."]})]})]})]})})]})})},wqe=e=>({T2M:{name:"Temperatura",unit:"C",icon:DE,color:"text-orange-600"},T2M_MAX:{name:"Temp. Mxima",unit:"C",icon:DE,color:"text-red-600"},T2M_MIN:{name:"Temp. Mnima",unit:"C",icon:DE,color:"text-blue-600"},RH2M:{name:"Umidade",unit:"%",icon:uA,color:"text-blue-500"},PRECTOTCORR:{name:"Precipitao",unit:"mm/dia",icon:uA,color:"text-blue-700"},PS:{name:"Presso Atmosfrica",unit:"kPa",icon:tp,color:"text-purple-600"},WS10M:{name:"Velocidade do Vento",unit:"m/s",icon:tp,color:"text-green-600"},ALLSKY_SFC_SW_DWN:{name:"Radiao Solar",unit:"kWh/m/dia",icon:tp,color:"text-yellow-600"}})[e]||{name:e,unit:"",icon:tp,color:"text-gray-600"},bqe=({data:e,loading:t})=>{const{toast:r}=r2(),n=()=>{const o=GTe(e);r(o?{title:"Exportado com sucesso!",description:"Os dados foram exportados para Excel"}:{title:"Erro na exportao",description:"Falha ao exportar dados para Excel",variant:"destructive"})};return t?be.jsxs("div",{className:"space-y-6",children:[be.jsxs("div",{className:"text-center",children:[be.jsx(ZS,{className:"h-8 w-64 mx-auto mb-4"}),be.jsx(ZS,{className:"h-4 w-48 mx-auto"})]}),be.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(o=>be.jsxs(Cc,{className:"border-primary/20",children:[be.jsx(pu,{children:be.jsx(ZS,{className:"h-6 w-32"})}),be.jsx(mu,{children:be.jsx(ZS,{className:"h-16 w-full"})})]},o))})]}):be.jsxs("div",{className:"space-y-8",children:[be.jsxs("div",{className:"text-center space-y-4",children:[be.jsx("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Resultados dos Dados Climticos"}),be.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[be.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[be.jsx(qF,{className:"h-4 w-4"}),be.jsxs("span",{children:["Localizao: ",e.location.latitude.toFixed(4),", ",e.location.longitude.toFixed(4),""]})]}),be.jsxs(_w,{variant:"outline",children:[e.dateRange.start," at ",e.dateRange.end]})]}),be.jsxs(Ec,{onClick:n,className:"bg-gradient-ocean hover:opacity-90 shadow-glow",children:[be.jsx(xle,{className:"mr-2 h-4 w-4"}),"Exportar para Excel"]})]}),be.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.selectedParameters.map(o=>{const u=wqe(o),d=e.parameters[o]||[],i=d.length>0?d.reduce((C,k)=>C+k,0)/d.length:0,v=d.length>0?Math.max(...d):0,w=d.length>0?Math.min(...d):0,S=u.icon;return be.jsxs(Cc,{className:"border-primary/20 hover:shadow-lg transition-shadow",children:[be.jsxs(pu,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[be.jsx(mh,{className:"text-sm font-medium",children:u.name}),be.jsx(S,{className:`h-4 w-4 ${u.color}`})]}),be.jsxs(mu,{className:"space-y-3",children:[be.jsxs("div",{className:"space-y-1",children:[be.jsxs("div",{className:"text-2xl font-bold",children:[i>0?i.toFixed(2):"N/A"," ",u.unit]}),be.jsx("p",{className:"text-xs text-muted-foreground",children:"Mdia do perodo"})]}),d.length>0&&be.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[be.jsxs("div",{children:[be.jsx("span",{className:"text-muted-foreground",children:"Mx: "}),be.jsx("span",{className:"font-semibold",children:v.toFixed(2)})]}),be.jsxs("div",{children:[be.jsx("span",{className:"text-muted-foreground",children:"Mn: "}),be.jsx("span",{className:"font-semibold",children:w.toFixed(2)})]})]}),be.jsxs(_w,{variant:"secondary",className:"w-fit",children:[d.length," pontos de dados"]})]})]},o)})}),be.jsx(sqe,{data:e,rawData:e.rawData}),be.jsx(fqe,{data:e}),be.jsx(cqe,{data:e}),be.jsx(xqe,{})]})},Tqe="/agroclima/assets/climate-hero-13w5UMgn.jpg",Sqe=()=>{const[e,t]=ue.useState(null),[r,n]=ue.useState(!1);return be.jsxs("div",{className:"min-h-screen bg-background",children:[be.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[be.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${Tqe})`}}),be.jsx("div",{className:"absolute inset-0 bg-gradient-weather opacity-80"}),be.jsx("div",{className:"relative z-10 container mx-auto px-4 text-center",children:be.jsxs("div",{className:"max-w-4xl mx-auto",children:[be.jsxs("div",{className:"flex justify-center items-center gap-4 mb-6",children:[be.jsx(tp,{className:"h-12 w-12 text-primary animate-pulse"}),be.jsx(vle,{className:"h-16 w-16 text-accent"}),be.jsx(uA,{className:"h-10 w-10 text-secondary animate-pulse"})]}),be.jsx("h1",{className:"text-6xl md:text-7xl font-bold text-white mb-6 drop-shadow-lg",children:"Clima Produtivo"}),be.jsx("p",{className:"text-xl md:text-2xl text-white/90 mb-12 drop-shadow-sm",children:"Explore informaes climticas mundiais usando a NASA POWER API"}),be.jsx($pe,{onDataReceived:t,onLoadingChange:n})]})})]}),e&&be.jsx("section",{className:"py-20 bg-gradient-to-b from-background to-secondary/20",children:be.jsx("div",{className:"container mx-auto px-4",children:be.jsx(bqe,{data:e,loading:r})})}),be.jsx("footer",{className:"bg-gradient-ocean text-white py-8 text-center",children:be.jsx("p",{className:"text-lg",children:"Powered by NASA POWER API  Dados climticos para todos"})})]})},Eqe=()=>{const e=zq();return be.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:be.jsxs("div",{className:"text-center",children:[be.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),be.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Pgina no encontrada."}),be.jsxs("p",{className:"mb-4 text-red-500",children:["Tentativa de acessar: ",be.jsx("strong",{children:e.pathname})]}),be.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Retornar para Home"})]})})},Aqe=new Hhe,Cqe=()=>be.jsx(Xhe,{client:Aqe,children:be.jsxs(bhe,{children:[be.jsx(ace,{}),be.jsx(Nce,{}),be.jsx(Rfe,{basename:"/agroclima/",children:be.jsxs(kfe,{children:[be.jsx(a3,{path:"/",element:be.jsx(Sqe,{})}),be.jsx(a3,{path:"*",element:be.jsx(Eqe,{})})]})})]})});sH(document.getElementById("root")).render(be.jsx(Cqe,{}));
